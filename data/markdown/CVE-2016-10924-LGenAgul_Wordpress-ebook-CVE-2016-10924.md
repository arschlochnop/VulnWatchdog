## CVE-2016-10924 - WordPress ebook-download插件目录遍历漏洞

**漏洞编号:** CVE-2016-10924

**漏洞类型:** 目录遍历

**影响应用:** WordPress ebook-download插件

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** < 1.2

**利用条件:** 需要目标WordPress网站安装了受影响版本的ebook-download插件，且攻击者能够发起HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10924是WordPress ebook-download插件1.2之前版本中存在的目录遍历漏洞。攻击者可以通过`ebookdownloadurl`参数，利用`filedownload.php`文件中的漏洞读取服务器上的任意文件。提供的PoC代码`pidbrute.py`通过构造包含`/proc/[PID]/cmdline`的URL来尝试读取系统中运行的进程的命令行参数。虽然尝试读取进程信息，但核心漏洞依旧是目录遍历。 

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞真实存在且PoC代码可用。从代码分析来看，该脚本针对`/proc/[PID]/cmdline`进行读取，在Linux系统上，该文件包含进程启动的命令。成功利用该漏洞可以获取服务器上运行的进程信息，可能泄露敏感信息，例如数据库连接字符串等。

**投毒风险分析：**
PoC代码本身的功能是利用目录遍历漏洞尝试读取进程信息，未发现恶意代码或后门。脚本的主要功能是从指定的IP地址上的WordPress插件中下载文件，并没有尝试写入或修改服务器上的文件。因此，投毒风险较低，接近0%。

**利用方式：**
1.  确定目标WordPress网站安装了受影响版本的ebook-download插件。
2.  使用PoC脚本`pidbrute.py`，指定目标网站的IP地址。
3.  脚本会遍历一系列PID，并尝试读取`/proc/[PID]/cmdline`文件。
4.  如果成功，脚本会输出进程ID及其对应的命令行参数。

**缓解措施：**
1.  将ebook-download插件升级到1.2或更高版本。
2.  限制对WordPress网站的访问权限。

**项目地址:** [LGenAgul/Wordpress-ebook-CVE-2016-10924](https://github.com/LGenAgul/Wordpress-ebook-CVE-2016-10924)

**漏洞详情:** [CVE-2016-10924](https://nvd.nist.gov/vuln/detail/CVE-2016-10924)