## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)