## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)