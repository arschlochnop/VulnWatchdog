## CVE-2025-31324-SAP NetWeaver Visual Composer Metadata Uploader 未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver (Visual Composer development server)

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统开放Visual Composer相关的端口（例如50000, 50001等），且未安装安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31324 漏洞存在于 SAP NetWeaver Visual Composer Metadata Uploader 中。由于缺乏适当的授权检查，未经身份验证的攻击者可以上传恶意可执行文件，从而严重损害主机系统。POC代码首先扫描目标IP的开放端口，然后尝试在发现的端口上使用Metadata Uploader接口上传JSP webshell。上传成功后，POC会尝试访问webshell并执行`whoami`命令来验证漏洞是否成功利用。漏洞利用方式为：

1.  **端口扫描：** 扫描目标IP的常见SAP Visual Composer端口 (50000, 50001, 50013, 50004, 50006, 50060, 50100, 50200, 80, 443)。
2.  **文件上传：** 使用`metadatauploader`接口上传一个JSP webshell，文件名为`shell.jsp`。
3.  **webshell 验证：** 尝试通过多个常见的webshell路径访问上传的webshell，并执行`whoami`命令。
4.  **结果确认：** 如果成功访问webshell并执行命令，则漏洞利用成功。

**投毒风险分析：**

尽管POC代码主体部分实现了漏洞利用的功能，但存在轻微的投毒风险。具体体现在以下几个方面：

*   **作者签名:** 代码中包含一个“黑客签名”，虽然表面上是版权信息，但可能暗示作者的真实意图和倾向。
*   **license:** 代码中包含 `GNU GENERAL PUBLIC LICENSE`,作者可能通过法律免责条款,来规避一些风险. 
*   **潜在后门:** 作者可能通过服务器log,或者脚本中的一些命令来获取用户ip,但是考虑到代码的复杂程度较低，以及漏洞利用的直接性，可以将投毒风险评估为较低水平。

总体评估，投毒风险较低，约为5%。

**项目地址:** [NULLTRACE0X/CVE-2025-31324](https://github.com/NULLTRACE0X/CVE-2025-31324)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)