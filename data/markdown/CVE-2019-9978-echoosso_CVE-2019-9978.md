## CVE-2019-9978-Social Warfare-Stored XSS / RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS / RCE

**影响应用:** Social Warfare (WordPress plugin)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了受影响版本的Social Warfare插件，且攻击者能访问admin-post.php接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前版本中的一个存储型XSS漏洞。此外，该漏洞还允许远程代码执行 (RCE)。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞在野外已被利用。搜索结果中也包含多个关于该漏洞的利用细节和分析报告，包括Unit 42的报告，以及Wordfence关于RCE的描述。Exploit-DB中也存在相应的利用代码。

**投毒风险：**
提供的Python漏洞利用代码看起来比较直接，主要功能是发送包含payload URI的请求到目标服务器。代码本身的功能是利用RFI进行RCE，没有明显的投毒代码。其中通过`requests.get(uri)`方法发送恶意构造的URL，如果服务器返回500状态码，则尝试提取服务器返回的响应内容，判断是否包含payload。尽管没有明显的投毒代码，但仍存在极小的风险，例如攻击者可能通过恶意构造`payload.txt`文件进行投毒。因为payload本身是由攻击者控制，所以不能算作仓库的投毒风险。

**利用方式：**
1.  **确定目标：** 找到安装了Social Warfare插件，且版本低于或等于3.5.2的WordPress网站。
2.  **构造Payload：** 创建一个包含恶意代码的payload文件（例如，PHP代码），并将其托管在攻击者可访问的服务器上。
3.  **执行Exploit：** 运行提供的Python脚本，指定目标URL和payload文件的URI。该脚本会向`wp-admin/admin-post.php`发送一个GET请求，其中`swp_debug=load_options`和`swp_url`参数用于触发漏洞。
4.  **利用RCE：** 受害者服务器会尝试加载并执行payload文件中的恶意代码，从而导致RCE。

综上所述，此漏洞利用非常有效，但存在极小的投毒风险(例如利用RFI引入恶意的payload)，漏洞的根本原因是由于输入验证不足，导致可以执行远程文件。

**项目地址:** [echoosso/CVE-2019-9978](https://github.com/echoosso/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)