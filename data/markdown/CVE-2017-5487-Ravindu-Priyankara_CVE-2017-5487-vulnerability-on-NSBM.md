## CVE-2017-5487-WordPress用户枚举漏洞

**漏洞编号:** CVE-2017-5487

**漏洞类型:** 信息泄露

**影响应用:** WordPress

**危害等级:** 中危，可能导致用户账户信息泄露

**影响版本:** 4.7之前（不包括4.7.1）

**利用条件:** 目标网站使用WordPress 4.7之前的版本，且启用了REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5487 漏洞存在于WordPress 4.7版本之前的REST API实现中，具体位于 `wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php` 文件。该漏洞允许未经身份验证的远程攻击者通过访问 `wp-json/wp/v2/users` 端点来获取网站用户的敏感信息，例如用户名、ID和别名等。

**有效性分析：**

根据漏洞描述，该漏洞允许未经授权的用户访问用户列表。提供的POC代码通过发送一个GET请求到 `https://www.nsbm.ac.lk/wp-json/wp/v2/users/`，然后解析返回的JSON数据，提取并显示用户的ID、名称和别名。如果网站存在该漏洞，且没有进行修复或者使用防火墙拦截，则POC代码可以成功获取用户信息，因此，POC代码有效。

**投毒风险分析：**

审查提供的 `payload.php` 脚本以及相关文件，发现其主要功能是发送HTTP请求到 WordPress REST API 的用户端点，并解析返回的JSON数据以提取用户信息。该脚本本身的功能与漏洞描述相符，旨在利用 CVE-2017-5487 漏洞进行用户枚举。但是，因为该脚本可以被修改，并且部署在不受信任的源上，存在一定的投毒风险，比如作者可以修改脚本，加入恶意链接，或者搜集用户信息。 该风险很小，但是依旧存在，因此风险评估为5%。

**利用方式：**

1.  **漏洞发现：** 通过扫描或者其他方式，确定目标网站使用的WordPress版本低于4.7.1，并且启用了REST API。
2.  **发送请求：** 使用POC代码或类似工具，构造并发送一个GET请求到目标网站的 `wp-json/wp/v2/users` 端点。
3.  **解析响应：** 解析服务器返回的JSON数据，提取用户ID、用户名和别名等信息。
4.  **信息利用：** 将获取的用户信息用于进一步的攻击，例如密码破解或者社会工程学攻击。

**缓解措施：**

*   升级WordPress到4.7.1或更高版本。
*   使用Web应用防火墙(WAF)阻止对 `wp-json/wp/v2/users` 端点的未经授权访问。
*   限制REST API的访问权限。

**项目地址:** [Ravindu-Priyankara/CVE-2017-5487-vulnerability-on-NSBM](https://github.com/Ravindu-Priyankara/CVE-2017-5487-vulnerability-on-NSBM)

**漏洞详情:** [CVE-2017-5487](https://nvd.nist.gov/vuln/detail/CVE-2017-5487)