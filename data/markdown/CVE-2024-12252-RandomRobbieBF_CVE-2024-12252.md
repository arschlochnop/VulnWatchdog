## CVE-2024-12252-SEO LAT Auto Post-文件覆盖RCE

**漏洞编号:** CVE-2024-12252

**漏洞类型:** 文件覆盖/远程代码执行

**影响应用:** SEO LAT Auto Post

**危害等级:** 高危，未经身份验证的攻击者可以覆盖插件文件并执行任意代码

**影响版本:** <= 2.2.1

**利用条件:** WordPress网站需要安装存在漏洞的SEO LAT Auto Post插件，且允许未经身份验证的AJAX请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-12252 存在于 SEO LAT Auto Post WordPress 插件中，版本 <= 2.2.1。该漏洞是由于 `remote_update` AJAX 操作缺少权限验证，允许未经身份验证的攻击者覆盖 `seo-beginner-auto-post.php` 文件，从而实现远程代码执行。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，POC代码有效。POC通过发送包含指向恶意shell脚本URL的`remote_update` AJAX请求，覆盖`seo-beginner-auto-post.php`文件。一旦该文件被恶意代码覆盖，攻击者可以通过访问该文件来执行任意代码。

**投毒风险：**
提供的漏洞利用代码仓库 (`/tmp/d1b9d545bccd7b93e50ef5104e2a0b07/README.md`) 主要包含漏洞描述和PoC利用方法，并没有发现直接的投毒代码。尽管如此，使用任何未经审核的漏洞利用代码都存在风险。由于当前提供的仓库内容是公开的PoC，主要目的是展示漏洞利用方式，因此投毒风险较低。投毒风险评估为0%。

**利用方式：**
1.  确定目标WordPress网站正在运行受影响版本的 SEO LAT Auto Post 插件。
2.  使用提供的PoC代码，构造一个POST请求到 `/wp-admin/admin-ajax.php`，包含以下参数：
    *   `action=remote_update`
    *   `url=[恶意shell脚本的URL]`
3.  发送构造的POST请求，目标服务器上的 `seo-beginner-auto-post.php` 文件将被恶意shell脚本覆盖。
4.  通过访问被覆盖的文件，执行恶意代码。例如，如果恶意脚本包含一个Webshell，攻击者可以通过Web浏览器与服务器交互，执行任意命令。
5.  或者，攻击者可以按照PoC仓库中建议的方式，修改当前插件并添加一个 rce 的 nopriv action。

**缓解措施：**
*   将 SEO LAT Auto Post 插件更新到高于 2.2.1 的版本。
*   如果无法更新，禁用或删除该插件。
*   实施Web应用防火墙(WAF)规则，阻止未经授权的`remote_update`请求。

**项目地址:** [RandomRobbieBF/CVE-2024-12252](https://github.com/RandomRobbieBF/CVE-2024-12252)

**漏洞详情:** [CVE-2024-12252](https://nvd.nist.gov/vuln/detail/CVE-2024-12252)