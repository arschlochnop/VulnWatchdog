## CVE-2024-47575: FortiManager Missing Authentication

**漏洞编号:** CVE-2024-47575

**漏洞类型:** 未授权访问/代码执行

**影响应用:** FortiManager

**危害等级:** 高危，可远程执行任意代码或命令

**影响版本:** FortiManager 7.6.0, 7.4.0-7.4.4, 7.2.0-7.2.7, 7.0.0-7.0.12, 6.4.0-6.4.14, 6.2.0-6.2.12, FortiManager Cloud 7.4.1-7.4.4, 7.2.1-7.2.7, 7.0.1-7.0.13, 6.4.1-6.4.7

**利用条件:** FortiManager实例暴露在公网上，端口541开放

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2024-47575是一个存在于FortiManager中的严重漏洞，由于`fgfmsd`守护进程中缺少身份验证，未经身份验证的远程攻击者可以通过构造特制的请求，绕过访问控制，并在FortiManager系统上执行任意代码或命令，从而完全控制系统。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞已被证实为真实存在，并且已被积极利用。CISA已将其添加到已知被利用的漏洞目录中。漏洞利用代码提供了一个Python脚本示例，可以执行任意命令。

**投毒风险：**
提供的漏洞利用代码的下载链接 `https://bit.ly/3US7qb1` 是一个短链接，无法直接分析其内容。这意味着存在一定的投毒风险，因为该链接可能指向包含恶意代码的Payload。虽然README.md文件本身看起来无害，但无法保证下载的脚本的安全性。漏洞作者很可能将恶意代码隐藏在下载的脚本中,从而实现投毒。因此，我认为投毒风险较高，约为70%。

**利用方式：**
1.  **目标确认：** 攻击者首先需要确定存在漏洞的FortiManager实例，这些实例通常暴露在互联网上，并且监听541端口。
2.  **未经身份验证的请求：** 攻击者构造特制的请求，利用`fgfmsd`守护进程中缺失的身份验证机制。
3.  **命令执行：** 通过精心设计的请求，攻击者可以在目标系统上执行任意代码或命令。
4. **后渗透:** 获取初始访问权限后，攻击者可以横向移动到其他系统，窃取敏感数据，或者破坏整个网络。

**结论：**
CVE-2024-47575是一个高危漏洞，具有可利用性。由于存在未经验证的下载链接，使用提供的PoC脚本存在较高的投毒风险。建议在隔离环境中分析和验证PoC，并在生产环境中尽快应用补丁。

**项目地址:** [expl0itsecurity/CVE-2024-47575](https://github.com/expl0itsecurity/CVE-2024-47575)

**漏洞详情:** [CVE-2024-47575](https://nvd.nist.gov/vuln/detail/CVE-2024-47575)