## CVE-2025-53770-SharePoint-Remote Code Execution

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要网络访问受影响的 SharePoint 服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，由不安全的反序列化未受信任的数据导致。攻击者可以通过发送特制的请求到易受攻击的 ToolPane.aspx 页面，绕过身份验证，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  攻击者向 SharePoint 服务器的 ToolPane.aspx 发送包含恶意序列化数据的 POST 请求，绕过身份验证。
2.  利用 w3wp.exe 进程执行经过编码的 PowerShell 命令，这可能表明存在漏洞利用或后渗透活动。
3.  攻击者通常会使用 base64 对命令进行混淆。
4.  Payload 允许攻击者提取和打印运行它的机器上的关键 ASP.NET 配置密钥，例如验证密钥和解密密钥。
5.  编译 C# 源代码，生成可执行文件到服务器临时目录，然后将该可执行文件作为 payload 执行。
6.  在 SharePoint 路径中创建一个 Web 后门（恶意 ASPX 文件），当访问该文件时，允许执行或下载外部 payload。
7.  攻击者可以访问MachineKeySection的应用程序配置，从而暴露敏感的加密密钥，如验证密钥和解密密钥，这些密钥对 ASP.NET 安全至关重要，能保护身份验证 cookies 和 ViewState。暴露或检索这些密钥使攻击者能够伪造身份验证令牌、解密受保护的数据或对 Web 应用程序执行其他攻击。

**有效性评估：**

提供的 POC 代码（README.md）展示了漏洞利用的步骤和技术，以及在实际利用中观察到的行为。参考搜索引擎结果，该漏洞已在野外被积极利用，并且存在公开可用的利用代码。因此，提供的 POC 代码是有效的，能够复现漏洞。

**投毒风险评估：**

提供的 README.md 文件本身不包含恶意代码，主要描述了漏洞利用过程和攻击行为。但是，由于攻击链中涉及从远程服务器下载 payload.exe，并创建 ASPX webshell，存在潜在的投毒风险。攻击者可能在后续阶段替换或修改这些 payload，植入恶意代码。虽然README.md本身没有投毒，但它描述的攻击流程依赖于外部资源，存在被投毒的风险。考虑到这一点，将投毒风险评估为 10%。需要注意的是，这里的“投毒”指的是攻击者在后续攻击阶段引入恶意代码的可能性，而非 README.md 文件本身包含恶意代码。


**项目地址:** [bossnick98/-SOC342---CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-and-RCE](https://github.com/bossnick98/-SOC342---CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-and-RCE)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)