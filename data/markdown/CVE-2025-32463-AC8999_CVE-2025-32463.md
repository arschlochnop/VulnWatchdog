## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是一个 Sudo 的本地提权漏洞。该漏洞出现在 Sudo 1.9.14 到 1.9.17p1 版本中。利用方式是攻击者可以利用 `--chroot` 选项，通过使用用户可控的目录中的 `/etc/nsswitch.conf` 文件来加载恶意的共享库，从而获得 root 权限。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有可用的 PoC 代码。PoC 代码通过创建一个临时的 chroot 环境，并在该环境中构建恶意的 `/etc/nsswitch.conf` 文件和一个包含提权代码的共享库。然后，通过 `sudo -R` 命令指定该 chroot 环境，并执行一个任意命令，从而触发漏洞，获得 root 权限。

**投毒风险：**

查看提供的 PoC 代码，发现以下几点存在潜在的投毒风险：

*   **`prepare_command(args)` 函数:**  这个函数将用户提供的参数直接拼接成命令字符串，并在后续通过 `execl` 执行。如果用户提供的参数包含恶意代码，可能会被执行。
*   **C代码中的cmd_escaped变量:** 该变量来自用户的输入，虽然进行了转义，但是转义的完整性和安全性需要仔细评估，以防止绕过。
*   **整体风险评估:** 虽然 PoC 代码的目的是演示漏洞利用，但如果恶意用户修改 `create_c_file` 函数生成的 C 代码，或者修改 `prepare_command` 函数来注入恶意命令，则可能实现更隐蔽的攻击。例如，将恶意后门植入到系统中。整体代码看起来是为了验证漏洞，代码结构清晰，逻辑合理。只有一些潜在的风险，判定投毒概率为10%。

**利用方式：**

1.  **创建临时目录：** PoC脚本首先会创建一个临时目录作为攻击的“舞台”。
2.  **构建恶意环境：** 在临时目录中，PoC 会创建 `woot/etc/nsswitch.conf` 文件，其中包含指向恶意共享库的配置。
3.  **编译恶意共享库：** PoC 会编译一个 C 语言程序，该程序包含在构造函数中执行的提权代码。这个 C 程序会被编译成共享库 `libnss_/woot1337.so.2`。
4.  **触发漏洞：** 通过执行 `sudo -R woot woot` 命令，Sudo 会使用临时目录中的 `/etc/nsswitch.conf` 文件，从而加载恶意的共享库。
5.  **提权：** 恶意共享库中的代码会在加载时自动执行，从而将当前用户的权限提升为 root。

**项目地址:** [AC8999/CVE-2025-32463](https://github.com/AC8999/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)