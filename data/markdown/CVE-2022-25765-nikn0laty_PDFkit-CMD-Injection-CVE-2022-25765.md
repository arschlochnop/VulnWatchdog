## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.6

**利用条件:** 需要目标服务器运行存在漏洞的pdfkit服务，且攻击者能够向其发送HTTP POST请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-25765是pdfkit库中存在的一个命令注入漏洞。根据漏洞信息和搜索引擎结果，该漏洞源于pdfkit对URL参数未进行充分的过滤和安全处理，导致攻击者可以通过构造恶意的URL，将恶意命令注入到系统执行。漏洞利用代码（CVE-2022-25765.py）展示了如何通过发送包含恶意URL的POST请求，在目标服务器上执行任意命令，从而获取反向shell。从代码来看，它构造了一个包含反向连接bash命令的URL，并将其作为参数传递给pdfkit，导致命令执行。分析提供的POC代码，未发现明显的投毒代码。

**利用方式：**

1.  攻击者构造一个包含恶意命令的URL。该URL利用了pdfkit对URL处理不当的漏洞。
2.  攻击者使用POST请求将该恶意URL作为参数发送到目标服务器上运行的pdfkit服务。
3.  pdfkit在处理该URL时，由于未进行充分的安全检查，导致恶意命令被执行。
4.  恶意命令执行后，攻击者可以获得目标服务器的控制权，例如通过反向shell。

**有效性：**

根据漏洞描述和提供的PoC代码，该漏洞利用方式有效。PoC代码能够成功利用该漏洞执行命令并获得反向shell。

**投毒风险：**

对提供的PoC代码（CVE-2022-25765.py和README.md）进行了检查，没有发现明显的投毒代码，即恶意作者故意加入的、与漏洞利用无关的恶意功能或后门。 代码功能相对清晰，主要用于构造和发送恶意请求以利用命令注入漏洞。因此，投毒风险评估为0%。

**项目地址:** [nikn0laty/PDFkit-CMD-Injection-CVE-2022-25765](https://github.com/nikn0laty/PDFkit-CMD-Injection-CVE-2022-25765)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)