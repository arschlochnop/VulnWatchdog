## CVE-2025-41656-Pilz-Node-RED未授权远程代码执行

**漏洞编号:** CVE-2025-41656

**漏洞类型:** 未授权远程代码执行

**影响应用:** Pilz IndustrialPI 4 Node-RED

**危害等级:** 严重，可能导致完全控制受影响设备

**影响版本:** <= 2024-08

**利用条件:** 需要网络访问Node-RED服务，且Node-RED未配置身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-41656 漏洞存在于 Pilz IndustrialPI 4 的 Node-RED 集成中，由于 Node-RED 服务器默认未配置身份验证，导致未经身份验证的远程攻击者可以利用此漏洞在受影响的设备上以高权限执行任意命令。

**漏洞利用有效性：**
提供的POC代码有效。代码通过发送一个包含恶意配置的 HTTP POST 请求到 Node-RED 的 `/flows` 端点，从而创建一个新的 Node-RED 流。这个流包含一个 `exec` 节点，该节点被配置为执行任意 shell 命令。在这个例子中，它执行一个反向 shell 连接到攻击者的机器。

**投毒风险分析：**
代码仓库中存在一定的投毒风险，但概率较低（10%）。主要基于以下几点：

1.  **依赖外部资源：** Dockerfile中使用了`git clone https://github.com/WiringPi/WiringPi.git`，该项目存在被篡改的风险。
2.  **README文件引导：** `README.md` 文件指导用户执行一些操作，例如运行 `docker compose up --build -d`。 虽然这些命令本身没有明显的恶意行为，但如果依赖的镜像或者文件被篡改，可能会引入恶意代码。
3.  **IP地址替换：** `README.md` 指导用户替换 `cve_2025_41656.py` 和 Dockerfile 中 IP 地址，如果用户不小心使用了错误的 IP 地址（例如攻击者控制的地址），可能导致意外行为。
4.  **Docker镜像风险：** 如果仓库作者在构建 Docker 镜像过程中插入了恶意代码，例如通过 `install.sh` 脚本，攻击者可以控制容器内部的行为。

**利用方式：**
1.  **确定目标：** 找到运行着存在漏洞版本Node-RED的Pilz IndustrialPI 4设备。
2.  **检查配置：** 确认 Node-RED 未配置身份验证。
3.  **执行POC：**
    *   部署POC代码提供的环境，包括Node-RED 和 OpenPLC容器。
    *   修改 `cve_2025_41656.py` 文件中的 `NODE_RED_IP` 和 `NODE_RED_PORT` 变量，将其设置为目标 Node-RED 服务的 IP 地址和端口。
    *   修改`cve_2025_41656.py` 中反弹shell的IP地址为攻击者控制的机器IP。
    *   运行 `python3 cve_2025_41656.py` 脚本，发送恶意请求。
4.  **获取控制：** 成功利用漏洞后，攻击者将在其机器上收到一个反向 shell，从而可以完全控制受影响的设备。

**缓解措施：**
正如 `README.md` 中提到的，缓解措施包括：

*   为 Node-RED 实施 TLS 和身份验证机制。
*   隔离 SCADA 网络以防止未经授权的访问。
*   使用 IDS/IPS 系统监控包含 Node-RED 的网络，以查找反向 shell 流量。

**项目地址:** [wallyschag/CVE-2025-41656](https://github.com/wallyschag/CVE-2025-41656)

**漏洞详情:** [CVE-2025-41656](https://nvd.nist.gov/vuln/detail/CVE-2025-41656)