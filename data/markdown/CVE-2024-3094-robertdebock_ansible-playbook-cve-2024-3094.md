## CVE-2024-3094-xz-utils供应链投毒

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链投毒

**影响应用:** xz-utils

**危害等级:** 极危，可能导致远程代码执行和系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用受影响的xz-utils版本，并且sshd等服务链接了被污染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了 xz-utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，然后修改 liblzma 代码中的特定函数。这导致所有链接到该库的软件都会使用被修改的 liblzma 库，从而拦截并修改与该库的数据交互。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的。它允许攻击者在目标系统上执行未经授权的远程代码，通常通过SSH服务。

**投毒风险：**
提供的 Ansible 代码用于检测 CVE-2024-3094 的存在，而不是利用漏洞。它包含一个 Ansible playbook，用于检查系统是否容易受到攻击。`robertdebock.cve_2024_3094` 角色可能包含检测逻辑，但也可能存在作者添加的额外代码。 因为角色代码未知，不能完全排除投毒风险，因此估算投毒风险为10%。

**利用方式：**
1.  攻击者通过供应链攻击，将恶意代码注入到 xz-utils 的源代码中（具体为5.6.0和5.6.1版本）。
2.  当开发者构建并发布这些受污染的 xz-utils 版本时，恶意代码就被植入到用户的系统中。
3.  恶意代码修改了 liblzma 库，劫持了 SSH 的认证过程。
4.  攻击者可以利用修改后的 SSH 认证绕过系统认证，实现远程代码执行。
5.  攻击成功后，攻击者可以完全控制受感染的系统。

**项目地址:** [robertdebock/ansible-playbook-cve-2024-3094](https://github.com/robertdebock/ansible-playbook-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)