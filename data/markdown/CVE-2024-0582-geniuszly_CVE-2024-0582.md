## CVE-2024-0582 - Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个use-after-free 漏洞。该漏洞源于不当的 buffer ring 处理。攻击者可以通过注册一个 buffer ring，对其进行 mmap()，然后释放它来触发此漏洞。

**有效性：**

根据搜索引擎结果和漏洞利用代码，此漏洞的POC是可用的。GitHub 上有相关的利用代码(ysanatomic/io_uring_LPE-CVE-2024-0582)。其他搜索结果也表明该漏洞已被公开讨论和分析(例如，Exodus Intelligence 的博客文章)。提供的C代码片段是POC的一部分，展示了如何设置和利用io_uring的buffer ring。

**投毒风险：**

由于提供的代码片段来自一个GitHub仓库，存在潜在的投毒风险。虽然代码本身看起来是针对该漏洞的利用，但是难以完全保证没有隐藏的恶意代码。考虑到代码可能被修改过，存在大约10%的投毒风险。这种风险通常包括添加后门，收集信息或执行其他恶意操作。 最好在使用前仔细审查所有代码，并从可信来源获取。

**利用方式：**

1.  **注册 buffer ring：**  攻击者使用 `IORING_REGISTER_PBUF_RING` 注册一个 buffer ring。
2.  **mmap()：**  注册的 buffer ring 被映射到用户空间。
3.  **释放：**  在 buffer ring 仍然被映射的情况下，释放该 buffer ring。
4.  **Use-After-Free：**  当内核尝试访问已释放的 buffer ring 时，会发生 use-after-free 漏洞。这可能允许攻击者覆盖内核内存，从而导致权限提升或系统崩溃。

提供的 C 代码片段展示了如何初始化 io_uring 实例，设置 buffer ring，并可能触发该漏洞。关键步骤包括使用 `io_uring_register_buf_ring` 注册 buffer ring 和使用 `mmap` 映射该 ring。

**项目地址:** [geniuszly/CVE-2024-0582](https://github.com/geniuszly/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)