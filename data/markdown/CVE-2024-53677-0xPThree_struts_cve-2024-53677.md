## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统运行受影响版本的Apache Struts，并且使用了存在漏洞的FileuploadInterceptor文件上传机制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞。攻击者可以通过操纵文件上传参数，实现路径遍历，从而将恶意文件上传到受限制的目录，最终可能导致远程代码执行。

**有效性：**
提供的PoC代码有效。从README.md可以看出，该PoC提供了一个Docker环境，用于搭建存在漏洞的Apache Struts环境。check.py脚本通过上传包含恶意路径的文件，检测目标是否存在CVE-2024-53677漏洞。如果成功覆盖了目标目录下的文件，则表明目标存在漏洞。

**投毒风险：**
分析仓库中的代码，主要关注Dockerfile和check.py脚本。Dockerfile用于构建存在漏洞的Struts环境，没有发现明显的投毒代码。check.py脚本的主要功能是检测漏洞是否存在，但也存在一定的风险。

*   **check.py潜在风险：**
    *   **依赖风险：** 虽然check.py脚本依赖较少，但是如果篡改check.py，例如修改上传的文件内容，可能会导致恶意代码上传到目标服务器。或者通过篡改`test_filename`来实现进一步的攻击。

综合分析，投毒风险较低，大约10%。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如，将文件名设置为`../../../../tmp/shell.jsp`，尝试将文件上传到服务器的`/tmp`目录下。
2.  服务器在处理文件上传请求时，由于存在路径遍历漏洞，会将恶意文件写入到指定的目录。
3.  如果上传的文件是可执行文件（例如，JSP脚本），攻击者可以通过访问该文件，执行恶意代码，从而获得服务器的控制权。

漏洞的利用依赖于Struts的FileuploadInterceptor拦截器。如果应用程序没有使用这个拦截器，则不会受到此漏洞的影响。

**搜索引擎结果补充：**
*   多个搜索结果表明该漏洞允许未经验证的攻击者执行路径遍历并可能进行RCE。
*   一些文章强调了升级到6.4.0或更高版本，以及迁移到新的文件上传机制的重要性。
*   CISA ADP将此漏洞标记为具有可利用的PoC，且技术影响为“total”。


**项目地址:** [0xPThree/struts_cve-2024-53677](https://github.com/0xPThree/struts_cve-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)