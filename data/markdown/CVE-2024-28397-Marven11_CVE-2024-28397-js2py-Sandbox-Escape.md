## CVE-2024-28397-js2py-沙箱逃逸

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要Python环境及安装js2py模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397是js2py库中存在的一个漏洞，攻击者可以通过构造恶意的JavaScript代码，利用js2py的disable_pyimport()函数的缺陷，绕过沙箱限制，在宿主机上执行任意Python代码，从而实现远程代码执行。该漏洞影响js2py 0.74及以下版本，需要在Python3.12以下运行。漏洞利用方式为，攻击者可以通过恶意网站或者API调用将恶意的JavaScript代码传递给受害者，受害者使用js2py解析该代码时，攻击者可以执行任意系统命令。 

 **有效性：** 

 根据提供的漏洞信息和利用代码，POC代码有效，可以绕过js2py的沙箱限制，在主机上执行任意命令。

 **投毒风险：** 

 漏洞利用代码仓库主要包含漏洞说明文档、受影响版本测试结果、动态patch脚本等，未发现明显的恶意投毒代码。但考虑到任何代码都存在潜在风险，以及攻击者可能利用该漏洞进行二次传播，仍然存在一定投毒风险，初步评估为10%。风险主要来源于：

 *   `fix.py` 脚本虽然用于修复漏洞，但如果被篡改，可能引入新的安全问题。
 *   `poc.py` 脚本本身包含执行系统命令的代码，如果被修改，可能执行恶意操作。
 *   攻击者可能fork该仓库，并在其中添加恶意代码，诱导用户下载。

 **利用方式：**

 1.  攻击者构造包含恶意JavaScript代码的网页或API响应。
 2.  受害者使用受影响版本的js2py解析恶意代码。
 3.  恶意JavaScript代码利用js2py的漏洞，获得Python对象引用。
 4.  通过Python对象，执行任意系统命令。

**项目地址:** [Marven11/CVE-2024-28397-js2py-Sandbox-Escape](https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)