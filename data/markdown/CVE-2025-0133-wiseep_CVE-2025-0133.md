## CVE-2025-0133 PAN-OS GlobalProtect Reflected XSS

**漏洞编号:** CVE-2025-0133

**漏洞类型:** Reflected XSS

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 中危，可能导致凭据盗窃和网络钓鱼

**影响版本:** PAN-OS 11.2.0 to 11.2.7
PAN-OS 11.1.0 to 11.1.10
PAN-OS 10.2.0 to 10.2.16
PAN-OS 10.1.0 to 10.1.14

**利用条件:** 需要目标启用GlobalProtect网关或门户，且用户已通过Captive Portal身份验证。开启Clientless VPN会增加风险。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-0133是Palo Alto Networks PAN-OS GlobalProtect网关和门户功能中的一个反射型跨站脚本（XSS）漏洞。攻击者可以构造恶意链接，诱骗已通过身份验证的Captive Portal用户点击，从而在用户浏览器上下文中执行恶意JavaScript代码。

**有效性：**
提供的PoC代码尝试利用此漏洞。它通过向目标GlobalProtect网关或门户发送包含恶意SVG/script有效负载的HTTP GET请求来实现。如果目标存在漏洞，服务器将反射此payload，导致恶意JavaScript代码在受害者浏览器中执行。根据报告，此漏洞的利用旨在进行网络钓鱼攻击，特别是在启用了无客户端VPN的情况下。该PoC通过扫描目标URL列表，判断服务器响应中是否存在特定的XSS指示器（`<svg><script>prompt("wiseep")</script>`）来判断漏洞是否存在。PoC扫描的原理符合漏洞描述，因此该PoC被认为是有效的。

**投毒风险：**
分析PoC代码后，发现投毒的可能性较低，大约5%。PoC主要功能是扫描和验证XSS漏洞。虽然存在一定的风险，即攻击者可能会修改PoC以包含恶意功能，例如将cookie发送到外部服务器，但目前的代码主要关注漏洞验证，没有明显的后门。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的特殊URL。该URL指向目标PAN-OS设备的GlobalProtect网关或门户。
2.  攻击者通过电子邮件、社交媒体或其他方式诱骗目标用户点击该链接。
3.  如果用户已通过Captive Portal身份验证，并且点击了恶意链接，恶意JavaScript代码将在用户的浏览器上下文中执行。
4.  恶意JavaScript代码可以执行各种恶意操作，包括窃取用户的凭据、重定向用户到恶意网站或执行其他恶意攻击。
5. 通过XSS窃取cookie之后，攻击者可使用窃取的cookie模拟受害者登录GlobalProtect，进一步盗取信息。

**缓解措施：**
*   升级到已修复的PAN-OS版本（11.2.8, 11.1.11, 10.2.17或更高版本）。
*   启用威胁防御订阅，并启用Threat ID 510003和510004。
*   禁用Clientless VPN。
*   教育用户识别和避免点击可疑链接。

**项目地址:** [wiseep/CVE-2025-0133](https://github.com/wiseep/CVE-2025-0133)

**漏洞详情:** [CVE-2025-0133](https://nvd.nist.gov/vuln/detail/CVE-2025-0133)