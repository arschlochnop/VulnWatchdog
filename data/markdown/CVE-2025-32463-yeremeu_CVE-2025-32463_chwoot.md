## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 到 1.9.17p1之前

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32463 是 Sudo 中的一个本地提权漏洞。攻击者可以通过 `--chroot` 选项使用用户控制的目录中的 `/etc/nsswitch.conf` 文件，从而获得 root 权限。

**漏洞利用有效性分析：**

*   根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，且危害等级为高危。
*   漏洞利用代码中提供了Dockerfile，用于构建存在漏洞的Sudo版本（1.9.16p2）。
*   Dockerfile中包含PoC脚本 `sudo-chwoot.sh`，该脚本尝试利用漏洞提权。
*   `run.sh` 用于构建和运行包含漏洞环境的 Docker 容器，并执行 PoC 脚本，证明了利用的便捷性。

**投毒风险分析：**

*   仔细检查了Dockerfile和poc脚本，未发现明显的恶意代码。
*   PoC脚本的主要目的是创建一个临时的目录，然后使用 sudo 的 chroot 功能更改根目录，并执行指定的命令（默认为 /bin/bash）。
*   虽然利用本身是为了提权，但未发现作者主动添加后门或破坏系统的行为。
*   投毒风险较低，大概在 1% 左右。

**利用方式：**

1.  构建包含漏洞版本的 Sudo 的 Docker 镜像。
2.  运行 Docker 容器，获得一个具有普通用户权限的 shell 环境。
3.  执行 PoC 脚本 `sudo-chwoot.sh`，该脚本会利用 `--chroot` 选项，并加载用户可控的 `/etc/nsswitch.conf`，达到提权的目的。
4.  如果成功，将在 chroot 环境中获得 root 权限。

**项目地址:** [yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)