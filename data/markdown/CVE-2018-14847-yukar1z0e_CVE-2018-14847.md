## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)