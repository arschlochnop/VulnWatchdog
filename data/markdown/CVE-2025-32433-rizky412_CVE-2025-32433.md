## CVE-2025-32433-Erlang/OTP-SSH预认证RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** OTP-25.3.2.20之前, OTP-26.0-rc1到OTP-26.2.5.11, OTP-27.0-rc1到OTP-27.3.3

**利用条件:** 目标系统运行存在漏洞版本的Erlang/OTP SSH服务，且攻击者可以建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32433是Erlang/OTP SSH服务器中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。该漏洞源于SSH协议消息处理中的缺陷。攻击者可以通过发送特制的SSH消息，在身份验证之前触发漏洞，从而在目标系统上执行任意命令。提供的POC代码模拟了攻击过程，首先建立与SSH服务器的连接，然后发送经过构造的`SSH_MSG_KEXINIT`，`SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST`消息。其中`SSH_MSG_CHANNEL_REQUEST` 消息携带了执行任意erlang代码的命令。如果目标服务器存在漏洞，此操作将导致在服务器上创建`/lab.txt`文件。审查了代码，没有发现明显的投毒迹象。Dockerfile用于构建存在漏洞的环境，ssh_server.erl是模拟的ssh服务器，用于漏洞验证，不是后门。

**利用方式：**

1.  **连接目标SSH服务器：** 使用socket连接目标服务器的SSH端口（默认为22）。
2.  **发送初始SSH握手消息：** 发送包含SSH版本信息的banner。
3.  **构建并发送恶意SSH_MSG_KEXINIT包：**  构造一个`SSH_MSG_KEXINIT`包，用于密钥交换初始化。
4.  **构建并发送恶意SSH_MSG_CHANNEL_OPEN包:**  构造一个`SSH_MSG_CHANNEL_OPEN`包，用于打开SSH通道。
5.  **构建并发送恶意SSH_MSG_CHANNEL_REQUEST包：**  构造一个`SSH_MSG_CHANNEL_REQUEST`包，包含要执行的恶意命令（例如，写入文件）。此消息在身份验证之前发送。
6.  **检查结果：**  如果漏洞利用成功，指定的命令将在服务器上执行，POC代码中会尝试创建`/lab.txt`文件。

根据漏洞信息和代码，POC代码利用了预认证阶段的漏洞，攻击成功率较高。

**项目地址:** [rizky412/CVE-2025-32433](https://github.com/rizky412/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)