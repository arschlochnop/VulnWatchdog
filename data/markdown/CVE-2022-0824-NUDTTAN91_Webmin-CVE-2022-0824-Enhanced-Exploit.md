## CVE-2022-0824-Webmin-RCE

**漏洞编号:** CVE-2022-0824

**漏洞类型:** 远程代码执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.990

**利用条件:** 需要Webmin登录凭据（低权限用户即可）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0824是Webmin 1.990之前版本中存在的一个由于不当访问控制导致的远程代码执行漏洞。攻击者可以通过文件管理器利用此漏洞。利用过程如下：

1.  **身份验证：** 首先，攻击者需要具有Webmin的有效登录凭据，即使是权限较低的用户也可以。
2.  **Payload生成：**  根据利用方式（命令执行或反向Shell），生成包含恶意代码的CGI脚本（Perl、Bash或Python）。
3.  **文件上传：**  通过Webmin文件管理器的“HTTP下载”功能上传payload文件到Webmin服务器。该工具支持多种上传方式，包括HTTP下载、直接上传、以及命令执行创建。
4.  **权限设置：**  设置上传的CGI脚本的执行权限，确保Webmin能够执行该脚本。
5.  **命令执行/反向Shell：**  通过访问上传的CGI脚本，执行预期的命令或建立反向Shell连接。

该漏洞利用代码提供命令执行和反向shell两种模式，增强了攻击的灵活性。

**投毒风险分析：**

虽然提供的代码看起来是一个漏洞利用工具，但仍然存在一定的投毒风险。例如，

*   **LICENSE欺骗：** 使用宽松的MIT协议，降低使用者警惕性。
*   **payload携带后门：** CGI payload可能包含隐蔽的后门代码，允许攻击者在受害者不知情的情况下访问系统。
*   **依赖引入恶意代码：** 通过`pip3 install requests urllib3`引入包含恶意代码的第三方库。
*   **Callback地址：**  反向Shell模式中，如果攻击者控制了callback IP/Port，可能在用户不知情的情况下建立连接，导致信息泄露或者植入恶意程序。
*   **文件名策略：** 攻击者可以利用该策略，在受害者系统中留下恶意的文件。

综合考虑，该漏洞利用代码存在10%的投毒风险，用户在使用时需谨慎，务必进行代码审计和安全检查。

**项目地址:** [NUDTTAN91/Webmin-CVE-2022-0824-Enhanced-Exploit](https://github.com/NUDTTAN91/Webmin-CVE-2022-0824-Enhanced-Exploit)

**漏洞详情:** [CVE-2022-0824](https://nvd.nist.gov/vuln/detail/CVE-2022-0824)