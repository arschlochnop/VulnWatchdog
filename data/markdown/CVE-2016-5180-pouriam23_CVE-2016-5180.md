## CVE-2016-5180-c-ares 堆缓冲区溢出

**漏洞编号:** CVE-2016-5180

**漏洞类型:** 堆缓冲区溢出

**影响应用:** c-ares

**危害等级:** 高危，可能导致拒绝服务或远程代码执行

**影响版本:** 1.x before 1.12.0

**利用条件:** 需要能够控制或影响传递给 c-ares 的主机名参数

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-5180 是 c-ares 库中 ares_create_query 函数的堆缓冲区溢出漏洞。攻击者可以通过提供包含转义尾随点的主机名（例如 "hello\."）来触发此漏洞。由于对主机名大小的计算不正确，导致在堆上写入超出分配的缓冲区，从而可能导致拒绝服务或执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响 c-ares 1.x 到 1.12.0 之前的版本。

**投毒风险：**
提供的漏洞利用代码是一个 `package-lock.json` 文件，它锁定了项目依赖的版本。这个文件本身不包含任何可执行代码，因此直接包含恶意代码的可能性很低。但是，它列出的依赖项（如 `body-parser` 和 `express`）如果本身存在安全漏洞，或者被恶意篡改 (例如通过供应链攻击)，则可能间接引入风险。通过供应链攻击篡改依赖项，以实施投毒攻击的可能性很小，大约1%。

**利用方式：**
1.  应用程序使用存在漏洞的 c-ares 库版本。
2.  攻击者找到一个点，可以控制应用程序使用 c-ares 库解析的主机名。
3.  攻击者提供一个包含转义尾随点的主机名，例如 `longname\.`。
4.  `ares_create_query` 函数计算主机名大小时出现错误，导致缓冲区溢出。
5.  溢出可能导致应用程序崩溃（拒绝服务），或者如果攻击者能够精确控制溢出内容，则可能执行任意代码。

**项目地址:** [pouriam23/CVE-2016-5180](https://github.com/pouriam23/CVE-2016-5180)

**漏洞详情:** [CVE-2016-5180](https://nvd.nist.gov/vuln/detail/CVE-2016-5180)