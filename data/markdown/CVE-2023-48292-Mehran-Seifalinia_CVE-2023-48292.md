## CVE-2023-48292 - XWiki Admin Tools CSRF to RCE

**漏洞编号:** CVE-2023-48292

**漏洞类型:** CSRF to RCE

**影响应用:** XWiki Admin Tools

**危害等级:** 严重，攻击者可以利用 CSRF 漏洞，在管理员不知情的情况下执行任意 shell 命令，导致完全控制 XWiki 服务器

**影响版本:** >= 4.4, < 4.5.1

**利用条件:** 需要管理员用户访问攻击者控制的页面或链接，且目标 XWiki 安装了受影响版本的 Admin Tools 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-48292 是 XWiki Admin Tools 插件中的一个跨站请求伪造 (CSRF) 漏洞，它允许攻击者诱骗管理员执行任意 shell 命令。漏洞存在于版本 4.4 到 4.5.1 之前。攻击者可以通过在 XWiki 页面（例如评论）中嵌入恶意链接或图片来实现攻击。当管理员访问包含恶意内容的页面时，他们的浏览器会自动向 XWiki 服务器发送一个包含 shell 命令的请求，由于 Admin Tools 插件缺乏 CSRF 保护，该命令会被执行。

漏洞利用方式：

1.  攻击者构造一个包含恶意 shell 命令的 URL，例如 `/xwiki/bin/view/Admin/RunShellCommand?command=touch%20/tmp/attacked`。
2.  攻击者将该 URL 嵌入到 XWiki 页面中，例如评论、博客文章等。
3.  攻击者诱骗管理员访问包含恶意 URL 的页面。
4.  当管理员访问该页面时，他们的浏览器会自动向 XWiki 服务器发送包含恶意 shell 命令的请求。
5.  XWiki 服务器执行该 shell 命令。

有效性评估：

漏洞库信息、搜索结果和提供的漏洞利用代码（LICENSE 和 README.md）都表明此漏洞是真实存在的，并且漏洞利用代码库本身提供了利用此漏洞的证明。由于 PoC 仓库只包含漏洞声明和版权信息，缺乏实际的exp代码，因此需要自行构造利用链。

投毒风险评估：

提供的漏洞利用代码只包含 LICENSE 和 README.md 文件，没有发现任何可疑代码或后门。因此，投毒风险较低（0%）。 但是，需要注意的是，实际的漏洞利用 EXP 可能包含恶意代码，因此在使用任何公开的漏洞利用代码之前，都应该进行仔细的审查。


**项目地址:** [Mehran-Seifalinia/CVE-2023-48292](https://github.com/Mehran-Seifalinia/CVE-2023-48292)

**漏洞详情:** [CVE-2023-48292](https://nvd.nist.gov/vuln/detail/CVE-2023-48292)