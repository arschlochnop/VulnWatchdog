## CVE-2025-0282-Ivanti Connect Secure-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，允许未经身份验证的远程攻击者执行代码。

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要目标系统运行存在漏洞的Ivanti产品，并且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282是一个存在于Ivanti Connect Secure, Policy Secure, 和 Neurons for ZTA gateways中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞已被积极利用，并且存在公开的漏洞利用代码。POC代码尝试利用IF-T协议的漏洞，通过精心构造的数据包溢出栈缓冲区并覆盖返回地址，从而执行攻击者控制的代码。该代码包含针对特定版本的偏移量，如果版本检测成功并偏移量匹配，则漏洞利用的有效性较高。但如果版本不匹配，则利用会失败。

**投毒风险分析：** POC代码本身的功能是添加一个后门帐户（admin/admin），允许攻击者登录系统。这本身可以被视为一种投毒行为，因为攻击者可以通过该帐户长期控制系统。此外，POC代码包含许多“CAFEBEEF”魔术字，如果攻击者故意将这些值设置为恶意代码，则可能构成更隐蔽的投毒。总体而言，漏洞利用代码主要目标是添加后门用户,存在一定投毒风险，但直接向payload中植入恶意代码的概率较低，估计为10%。

**利用方式：**
1.  **版本检测：** 首先，利用代码尝试通过访问`/dana-na/auth/url_admin/welcome.cgi?type=inter`来检测目标Ivanti产品的版本。
2.  **选择目标：** 根据检测到的版本，选择相应的利用目标（包含偏移量等信息）。
3.  **协议切换：** 发送HTTP请求，尝试将连接升级到IF-T/TLS 1.0协议。
4.  **发送Payload：** 构造包含溢出数据的IF-T数据包，覆盖栈上的返回地址。Payload中包含：
    *   填充数据，用于到达vftable指针。
    *   指向vftable的gadget，用于控制程序流程。
    *   用于进一步控制堆栈和执行system函数的gadget。
    *   用于添加管理员后门用户的命令 (添加到`/etc/passwd`和`/etc/shadow`)。
5.  **执行命令：** 覆盖返回地址后，程序返回到攻击者控制的地址，最终执行添加后门用户的命令。


**项目地址:** [almanatra/CVE-2025-0282](https://github.com/almanatra/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)