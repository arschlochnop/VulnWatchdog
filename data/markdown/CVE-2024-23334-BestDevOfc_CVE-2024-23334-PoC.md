## CVE-2024-23334-aiohttp目录穿越漏洞

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录穿越

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`配置且存在静态文件路由

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-23334是aiohttp框架中的一个目录穿越漏洞。当`aiohttp.web.static`函数配置`follow_symlinks=True`时，由于缺少对文件读取路径的校验，攻击者可以通过构造包含`../`的恶意URL，访问静态文件根目录之外的文件。搜索引擎结果也证实了该漏洞的存在，并指出可能导致敏感信息泄露。提供的PoC代码通过循环构造包含多个`../`的URL，尝试读取`/etc/passwd`文件。  

**有效性：**
根据提供的PoC代码和漏洞描述，可以判断PoC代码有效。攻击者可以通过该PoC读取服务器上的敏感文件，如/etc/passwd。PoC会循环发送请求，每次增加`../`的数量，直到到达根目录。然后访问/etc/passwd文件。

**投毒风险：**
PoC代码非常简单，只是发送HTTP请求来利用目录穿越漏洞。该代码的主要功能是利用漏洞，没有发现任何隐藏的、恶意的代码，比如执行系统命令或上传恶意文件等。因此，不存在投毒风险的可能性较高，可以认为是 0%。

**利用方式：**
1.  目标系统运行着受影响版本的aiohttp应用，并且启用了静态文件服务，同时设置了`follow_symlinks=True`。
2.  攻击者构造包含`../`的HTTP请求，例如`/static/../../../../etc/passwd`，发送到目标服务器。
3.  服务器没有正确验证请求路径，从而允许攻击者访问`/etc/passwd`文件，导致敏感信息泄露。

**项目地址:** [BestDevOfc/CVE-2024-23334-PoC](https://github.com/BestDevOfc/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)