## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送特制的邮件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的邮件（例如，会议邀请）触发此漏洞。漏洞原理是 Outlook 在处理邮件时，会尝试访问邮件中指定的 `ReminderSoundFile` 路径，而无需用户交互。如果该路径是 UNC 路径指向攻击者控制的服务器，则 Outlook 会尝试使用用户的 NTLM hash 向该服务器进行身份验证，从而允许攻击者捕获 NTLM hash 并进行 NTLM Relay 攻击，冒充受害者身份。

**有效性分析：**

根据漏洞描述和提供的PoC代码，该漏洞利用方法是有效的。PoC代码通过 `win32com.client` 模块创建 Outlook 的 AppointmentItem 对象，并设置 `ReminderSoundFile` 属性为指向攻击者控制的 UNC 路径。当 Outlook 处理该邮件时，会尝试访问该 UNC 路径，从而泄露 NTLM hash。

**投毒风险分析：**

PoC代码包含两个文件：`Exploit.py` 和 `LICENSE`。 `LICENSE` 文件是 GNU General Public License v3，标准协议许可文件。 `Exploit.py` 脚本的主要功能是生成带有恶意 `ReminderSoundFile` 属性的 Outlook 邮件，并不包含任何可疑的或恶意的代码。所有的操作都围绕利用漏洞展开，脚本本身并无隐藏的后门或者恶意行为。

**利用方式：**

1.  攻击者使用 PoC 脚本 `Exploit.py` 生成恶意的 Outlook 邮件 (.msg 文件)。脚本需要指定目标邮箱地址和攻击者的 IP 地址（或攻击者控制的服务器的 UNC 路径）。
2.  攻击者将生成的邮件发送给受害者。
3.  当受害者使用受影响版本的 Outlook 打开或预览该邮件时，Outlook 会尝试访问邮件中指定的 UNC 路径。
4.  攻击者在其控制的服务器上监听 NTLM 身份验证请求。
5.  一旦 Outlook 尝试进行身份验证，攻击者就可以捕获受害者的 NTLM hash。
6.  攻击者可以使用捕获的 NTLM hash 进行 NTLM Relay 攻击，冒充受害者。

根据搜索结果，此漏洞已被广泛利用，并且 CISA 已将其添加到 Known Exploited Vulnerabilities Catalog 中。

**项目地址:** [tiepologian/CVE-2023-23397](https://github.com/tiepologian/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)