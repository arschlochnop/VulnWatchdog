## CVE-2012-2982 - Webmin file/show.cgi 远程命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.590

**利用条件:** 需要Webmin服务器运行在受影响版本，并已通过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Webmin的file/show.cgi文件中。经验证该漏洞允许经过身份验证的远程用户通过路径名中的无效字符（例如|管道符）执行任意命令。利用方式如下：

1.  **身份验证：** 首先需要使用Webmin的有效用户名和密码进行身份验证。 exploit.py 脚本中的`session_login.cgi`负责登录。
2.  **获取SID：** 成功登录后，服务器会返回一个会话ID（SID），该SID存储在cookie中。脚本从响应header `Set-Cookie` 中提取`sid`的值。
3.  **构造恶意请求：** 脚本构造一个包含管道字符的恶意URL，将其发送到/file/show.cgi。 其中，`/bin/%s|%s|` 部分允许执行命令注入。
4.  **命令执行：**  服务器在处理包含管道字符的URL时，会执行由攻击者注入的命令。 exploit.py 使用 bash反弹shell。
5.  **反弹Shell：** 成功利用后，攻击者会在其指定的LHOST和LPORT上获得一个反弹shell，从而完全控制服务器。

**有效性：** 根据漏洞信息和搜索结果，存在公开的PoC代码，且Metasploit中也存在该漏洞的利用模块。提供的Python脚本可以有效利用此漏洞。

**投毒风险：** 检查提供的代码后，没有发现明显的投毒代码。该漏洞利用脚本的目的明确，即利用身份验证和`/file/show.cgi` 中的命令注入漏洞来获得反弹shell。


**项目地址:** [OstojaOfficial/CVE-2012-2982](https://github.com/OstojaOfficial/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)