## CVE-2023-40355-Axigen WebMail-XSS

**漏洞编号:** CVE-2023-40355

**漏洞类型:** XSS

**影响应用:** Axigen WebMail

**危害等级:** 中危，可能导致敏感信息泄露、会话劫持或恶意脚本执行

**影响版本:** 10.3.3.0 before 10.3.3.59, 10.4.0 before 10.4.19, and 10.5.0 before 10.5.5

**利用条件:** 需要用户已登录并访问恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40355是Axigen WebMail中存在的一个跨站脚本漏洞，位于Standard和Ajax版本切换的逻辑中。攻击者可以通过构造包含恶意JavaScript代码的URL，当用户点击该链接时，恶意代码将在用户浏览器中执行。

**有效性：**
提供的POC代码尝试通过在username参数中注入JavaScript代码`alert(document.cookie)`来触发XSS漏洞。该代码针对`/index.hsp`路径，并添加了`passwordExpired=yes`参数，这与漏洞描述中提到的版本切换逻辑相关。如果漏洞存在，用户访问该URL时会弹出一个包含cookie的警告框，验证了漏洞的存在。

**投毒风险：**
虽然POC代码本身看起来无害，只是用于验证漏洞的存在。但是，潜在的投毒风险在于：

1.  **domain.txt文件：** 脚本从`domain.txt`文件中读取目标域名。攻击者可能会诱骗用户修改该文件，添加恶意域名，从而导致脚本扫描不安全的目标。
2.  **依赖关系：** 脚本依赖于`requests`和`colorama`库。虽然这些库本身是常用的，但如果用户从不可信的来源下载或安装了被篡改的库，则可能存在投毒风险。
3.  **README文件：** README文件中包含指向外部链接，用户点击链接后，可能会访问到恶意网站。
4.  **作者动机：**虽然作者提供了有价值的漏洞验证，但也存在作者诱导受害者点击其他恶意链接的情况。

基于以上分析，我给出的投毒风险是10%，主要集中在用户对脚本依赖项的信任和对`domain.txt`文件的修改上。

**利用方式：**

1.  **构造恶意URL：** 攻击者构造一个包含XSS payload的URL，例如：`http://example.com/index.hsp?passwordExpired=yes&username=\'-alert(document.cookie),//`。
2.  **诱骗用户点击：** 攻击者通过钓鱼邮件、社交媒体或其他方式诱骗用户点击该URL。
3.  **执行恶意代码：** 当用户点击该URL后，Axigen WebMail的服务器会将恶意JavaScript代码嵌入到响应页面中。
4.  **获取用户敏感信息：** 用户的浏览器执行恶意JavaScript代码，攻击者可以获取用户的cookie、session信息，甚至可以执行其他恶意操作，例如重定向到恶意网站、修改用户账户信息等。
5.  **邮件窃取:** 搜索结果中提到可以通过XSS窃取用户邮件，这可能是通过JS读取邮件内容并发送给攻击者服务器实现。

**总结：**
CVE-2023-40355是一个中危的XSS漏洞，攻击者可以利用该漏洞获取用户的敏感信息。该POC代码有效验证漏洞的存在性，但是潜在的风险在于`domain.txt`文件和依赖项的信任。用户在使用该POC代码时应保持警惕，确保从可信的来源获取代码，并仔细审查代码内容，避免遭受攻击。

**项目地址:** [ace-83/CVE-2023-40355](https://github.com/ace-83/CVE-2023-40355)

**漏洞详情:** [CVE-2023-40355](https://nvd.nist.gov/vuln/detail/CVE-2023-40355)