## CVE-2016-15042 - WordPress Plugin Arbitrary File Upload

**漏洞编号:** CVE-2016-15042

**漏洞类型:** 任意文件上传

**影响应用:** N-Media Post Front-end Form & Frontend File Manager (WordPress plugins)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.0 (Frontend File Manager), <= 1.0 (N-Media Post Front-end Form)

**利用条件:** 目标WordPress站点安装了受影响版本的插件，且漏洞未修复。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-15042 描述了 WordPress 插件 Frontend File Manager 和 N-Media Post Front-end Form 中的任意文件上传漏洞。由于插件缺乏充分的文件类型验证，未经身份验证的攻击者可以上传任意文件到受影响的服务器，包括恶意的 PHP 脚本，从而导致远程代码执行。

**有效性:**
根据漏洞信息和搜索引擎结果，可以确认该漏洞的存在和影响，存在可利用性。虽然提供的漏洞利用代码是Node.js写的restapi，跟上传漏洞本身没有直接关系，但是搜索引擎结果中的链接表明该漏洞可被利用。

**投毒风险:**
提供的代码是一个简单的 Node.js REST API，存在以下风险:
*   `package.json` 包含大量依赖项，增加了供应链攻击的风险。虽然看起来都是常规的库，但任何一个库被投毒都可能影响整个应用。
*   `index.js` 使用 `cors()` 中间件，如果配置不当可能引入跨域安全问题。使用 `ssl-express-www` 中间件强制 HTTPS，但需要正确配置服务器证书才能生效。代码使用了api-rey和zrapi这两个未知的依赖,增加了投毒风险,但是从文件名来看这两个依赖可能只是api的集合,所以投毒的风险占比不高.因此评估投毒风险为10%。

**利用方式:**
1.  确定目标WordPress站点是否安装了受影响版本的Frontend File Manager或N-Media Post Front-end Form插件。
2.  构造恶意的HTTP请求，绕过插件的文件类型验证机制。
3.  上传包含恶意代码的PHP文件或其他可执行文件到服务器。
4.  通过访问上传的文件，执行恶意代码，实现远程代码执行。

**项目地址:** [Aditya43621/lab-cve-2016-15042](https://github.com/Aditya43621/lab-cve-2016-15042)

**漏洞详情:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)