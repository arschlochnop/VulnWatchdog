## CVE-2023-38646-Metabase-RCE

**漏洞编号:** CVE-2023-38646

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Metabase

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意命令。

**影响版本:** < 0.46.6.1 (Open Source) 和 < 1.46.6.1 (Enterprise)

**利用条件:** 目标Metabase实例需要是受影响的版本，且不需要身份验证即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38646 是 Metabase 中的一个未经身份验证的远程代码执行漏洞。根据漏洞信息和搜索结果，攻击者可以利用此漏洞在 Metabase 服务器上执行任意命令，权限级别等同于服务器进程的权限。提供的PoC代码利用 `unshare` 命令创建一个隔离的命名空间，然后在该命名空间中复制 `python3`，并赋予其 `cap_setuid` 能力。 接着，利用 `mount -t overlay` 创建一个 overlay 文件系统。最后，在新的命名空间中使用提权的 `python3` 执行 payload，该payload设置用户ID为0 (root) 并产生一个 bash shell. 由于代码直接利用了/u*/b*/p*3 查找python3的路径，有一定的概率因为目标环境没有该路径而无法执行。投毒风险评估：虽然提供的PoC的目的是提权和执行任意命令，但是其中可能包含隐蔽的恶意代码，例如反弹shell或者下载并执行其他恶意程序。 由于该poc存在下载恶意文件的可能，因此，该poc存在一定比例的投毒风险，大约10%。漏洞利用方式：攻击者发送特制的请求到Metabase服务器，利用漏洞执行操作系统命令。命令执行的上下文与Metabase服务器进程的权限相同。 因此，漏洞可以被用来获取对服务器的完全控制，并可能导致数据泄露、服务中断或进一步的横向移动。

**项目地址:** [acesoyeo/METABASE-RCE-CVE-2023-38646-](https://github.com/acesoyeo/METABASE-RCE-CVE-2023-38646-)

**漏洞详情:** [CVE-2023-38646](https://nvd.nist.gov/vuln/detail/CVE-2023-38646)