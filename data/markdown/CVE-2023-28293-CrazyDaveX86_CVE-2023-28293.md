## CVE-2023-28293 - Windows Kernel Elevation of Privilege

**漏洞编号:** CVE-2023-28293

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，允许低权限用户提升至SYSTEM权限

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 需要本地访问，用户需具备加载驱动程序的权限（通常需要管理员权限，或通过其他方式绕过签名验证）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-28293是一个Windows内核特权提升漏洞。根据漏洞库信息和搜索引擎结果，此漏洞存在于多个Windows版本中。利用代码显示，该漏洞可以通过构造特定的IOCTL调用来与存在漏洞的内核驱动程序进行交互，从而执行任意内核内存操作。这可能被滥用来提升权限或在内核上下文中执行代码。

**有效性评估：**
提供的PoC代码看起来是有效的，因为它包含加载、与驱动程序交互和卸载驱动程序的基本框架。漏洞利用的关键在于`IOCTL_VULN_CODE`的处理以及如何构造`input_buffer`以利用该漏洞。由于没有提供漏洞驱动程序，无法直接验证PoC的有效性，但根据描述，只要找到了存在漏洞的驱动程序并理解如何构造`input_buffer`，就可以成功利用该漏洞。

**投毒风险分析：**
该存储库中存在恶意代码的风险较低，估计为5%。代码的结构清晰，主要用于加载/卸载驱动程序并发送 IOCTL。主要关注点是：
*   **`core.cpp` 和 `core.h`**: 这些文件包含驱动程序加载/卸载的函数和一些常量定义，例如设备名称和 IOCTL 代码，看起来没有可疑之处。
*   **`main.cpp`**: 此文件包含 PoC 的主要逻辑。它加载驱动程序，打开设备，发送 IOCTL，然后清理。虽然理论上可以在 `input_buffer` 中嵌入恶意代码，但如果没有关于如何触发漏洞的进一步信息，这段代码本身不具有明显的投毒性。由于用户需要自行查找漏洞驱动并编译poc, 并且需要管理员权限或者绕过驱动签名来加载驱动，增加了投毒难度.但是不排除作者在后期更新poc脚本,添加一些恶意代码，例如通过IOCTL调用在内核中执行任意代码。

**利用方式：**
1.  **找到存在漏洞的驱动程序：**首先需要确定一个受此 CVE 影响且存在漏洞的驱动程序。
2.  **分析漏洞驱动的IOCTL处理函数：** 找到驱动程序后，需要分析其代码，确定 `IOCTL_VULN_CODE` 对应的处理函数中的漏洞点。这个漏洞点通常是缓冲区溢出、整数溢出或任意内存写入等。
3.  **构造恶意的输入缓冲区：** 根据漏洞点，精心构造 `input_buffer` 的内容。例如，如果存在缓冲区溢出，则需要填充足够多的数据来覆盖返回地址，并将其指向 shellcode 的地址。
4.  **加载驱动程序：** 使用 `LoadDriver` 函数加载存在漏洞的驱动程序。这通常需要管理员权限，或者需要绕过驱动签名验证。
5.  **打开设备：** 使用 `CreateFile` 函数打开与驱动程序关联的设备。
6.  **发送 IOCTL：** 使用 `DeviceIoControl` 函数发送构造好的 IOCTL 请求，触发漏洞。
7.  **执行 Shellcode（或实现其他特权提升方式）：** 如果成功利用漏洞，则可以执行 shellcode 或使用其他方法来提升权限。

**项目地址:** [CrazyDaveX86/CVE-2023-28293](https://github.com/CrazyDaveX86/CVE-2023-28293)

**漏洞详情:** [CVE-2023-28293](https://nvd.nist.gov/vuln/detail/CVE-2023-28293)