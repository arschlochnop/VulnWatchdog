## CVE-2021-42694-Unicode Homoglyph Injection

**漏洞编号:** CVE-2021-42694

**漏洞类型:** 代码注入

**影响应用:** 多种编程语言（C, C++, C#, Go, Python, Rust, JS等）

**危害等级:** 高危，可能导致代码执行，权限提升

**影响版本:** Unicode Specification <= 14.0

**利用条件:** 需要开发者或代码审查者未能发现源代码中存在的同形异义字符

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42694 漏洞源于 Unicode 规范允许使用视觉上相同的同形异义字符创建源代码标识符，如函数名。攻击者可以利用这一点，在 upstream 软件依赖项中注入恶意标识符定义，下游软件在不知情的情况下调用这些恶意标识符，从而实现攻击。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞是有效的。POC代码提供了一个代码生成器，用于在源代码中插入同形异义字符，验证了漏洞的可利用性。

**投毒风险：** 

*   POC 代码本身的主要功能是生成包含同形异义字符的恶意代码，属于漏洞利用工具，而非直接的投毒代码。代码主要是进行字符替换，将正常字符替换为视觉上相似的 Unicode 字符。这种替换行为本身就可以被视为一种广义上的“污染”，因为它改变了代码的原始含义，但如果利用方式是将生成的恶意代码植入到目标项目中，就属于更高级别的攻击。
* LICENSE文件以及README.md均为开源协议，版权声明等。未发现有恶意代码。
* codegen.py脚本根据模板文件进行字符替换，本身不包含恶意逻辑，投毒风险较低。
* homoglyphs.txt文件包含了大量同形异义字符，本身属于正常数据，但可能被恶意利用。所以，需要人工审计模板文件和生成代码。 
  综上，此仓库中存在作者隐藏的直接投毒代码的可能性较低。但存在被攻击者利用该项目代码，针对其他项目进行投毒的可能性。整体评估投毒风险在10%左右。

**利用方式：**

1.  **生成恶意代码：** 使用 POC 代码提供的代码生成器，根据包含同形异义字符占位符的模板文件，生成恶意代码。这些代码中的某些标识符（例如函数名、变量名）在视觉上与正常的标识符非常相似，但实际上是不同的 Unicode 字符。
2.  **注入恶意代码：** 将生成的恶意代码注入到目标软件项目中。这可以通过多种方式实现，例如：
    *   提交包含恶意代码的 Pull Request 到开源项目。
    *   在闭源项目中，通过某种方式（例如供应链攻击）替换或修改源代码文件。
3.  **诱导代码审查：** 利用同形异义字符的迷惑性，使得代码审查人员难以发现恶意代码。由于视觉上的相似性，审查人员可能误认为恶意代码是正常的代码。
4.  **执行恶意代码：** 当目标软件执行包含恶意代码的程序时，恶意标识符将被解析为实际的 Unicode 字符，从而执行攻击者预期的恶意操作。这可能导致各种安全问题，例如代码执行、权限提升等。

总而言之，此漏洞的利用依赖于攻击者巧妙地利用 Unicode 的特性，以及代码审查人员的疏忽。防御此漏洞的关键在于提高代码审查的严格性，并使用工具检测源代码中是否存在同形异义字符。

**项目地址:** [simplylu/CVE-2021-42694](https://github.com/simplylu/CVE-2021-42694)

**漏洞详情:** [CVE-2021-42694](https://nvd.nist.gov/vuln/detail/CVE-2021-42694)