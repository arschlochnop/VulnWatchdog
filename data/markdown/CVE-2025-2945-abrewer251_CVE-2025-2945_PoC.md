## CVE-2025-2945-pgAdmin4-远程代码执行

**漏洞编号:** CVE-2025-2945

**漏洞类型:** 远程代码执行

**影响应用:** pgAdmin 4

**危害等级:** 严重，未经授权的远程代码执行

**影响版本:** < 9.2

**利用条件:** 需要有效的pgAdmin4用户名和密码，目标pgAdmin4实例版本低于9.2，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-2945 存在于 pgAdmin 4 的 Query Tool 和 Cloud Deployment 模块中。攻击者可以利用两个 POST 端点 /sqleditor/query_tool/download (query_commited 参数) 和 /cloud/deploy (high_availability 参数)，将恶意代码传递给 Python 的 eval() 函数，从而执行任意代码。漏洞利用代码显示，该 PoC 通过以下步骤利用漏洞：

1.  使用提供的用户名和密码对 pgAdmin 4 进行身份验证。
2.  初始化 SQL 编辑器会话。
3.  发现有效的服务器连接 ID（服务器组和服务器 ID）。
4.  通过 `query_commited` 参数提交恶意 payload，触发服务器上的 `eval()`。
5.  观察 HTTP 500 响应，表明 payload 已在后端执行。

**有效性：**根据漏洞信息和利用代码，此漏洞可以有效利用。多个搜索引擎结果也证实了该漏洞的存在和严重性，并提供了相关的分析和修复建议。

**投毒风险：**代码包含一个 MIT 许可证，作者声明不负责任何滥用或损害。代码的目的是重现 Metasploit 模块的功能，并且结构清晰，没有明显的恶意行为。但是存在极低的投毒风险：PoC中可能存在一些未公开的后门代码，但可能性极低，因此预估风险为1%。请务必在隔离环境中测试。

**利用方式：**攻击者需要有效的 pgAdmin 4 凭据。利用方式是向 /sqleditor/query_tool/download 端点发送带有恶意 `query_commited` 参数的 POST 请求。由于 pgAdmin 4 使用 Python 的 `eval()` 函数处理 `query_commited` 参数而未进行充分的输入验证，攻击者可以注入任意 Python 代码，从而在服务器上执行远程代码。

**项目地址:** [abrewer251/CVE-2025-2945_PoC](https://github.com/abrewer251/CVE-2025-2945_PoC)

**漏洞详情:** [CVE-2025-2945](https://nvd.nist.gov/vuln/detail/CVE-2025-2945)