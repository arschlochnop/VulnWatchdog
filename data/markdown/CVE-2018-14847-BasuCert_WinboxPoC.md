## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)