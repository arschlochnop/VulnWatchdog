## CVE-2024-23897 - Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP, WebSocket, SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中。由于 Jenkins 未禁用 args4j 库的一个特性，该特性会将参数中以'@'字符开头的路径替换为文件内容，导致未经身份验证的攻击者可以读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**
提供的 Python POC 代码通过利用 Jenkins CLI 接口的漏洞，尝试读取指定文件。代码首先验证目标 Jenkins 实例的版本是否在受影响范围内（<= 2.441）。然后，它通过并发的上传和下载请求，利用 `@file` 语法读取文件内容。POC 代码看起来是有效的，能够成功读取文件。

**投毒风险分析：**
查看提供的POC代码，没有发现明显的投毒行为。代码功能集中在利用漏洞读取文件上，没有包含任何恶意操作，例如修改系统配置、上传恶意文件或执行其他未经授权的操作。LICENSE文件也标明是MIT开源协议。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 攻击者需要确定目标 Jenkins 实例的版本是否在受影响范围内（<= 2.441，或 LTS <= 2.426.2）。可以通过查看 HTTP 响应头中的 `X-Jenkins` 字段来获取版本信息。
2.  **构造 CLI 请求：** 攻击者构造一个包含 `@file` 语法的 CLI 请求，其中 `file` 是要读取的文件的路径。例如，`@/etc/passwd` 将会读取 `/etc/passwd` 文件的内容。
3.  **通过 CLI 接口发送请求：**攻击者可以通过 HTTP、WebSocket 或 SSH 等方式，将构造的 CLI 请求发送到 Jenkins 实例。
4.  **读取文件内容：** Jenkins CLI 命令解析器会将 `@file` 替换为文件内容，并将内容返回给攻击者。攻击者即可获取目标文件内容，可以利用读取到的信息进行进一步的攻击行为。

**缓解措施：**
*   升级 Jenkins 到安全版本（>= 2.442，LTS >= 2.426.3）。
*   禁用 Jenkins CLI 接口，如果不需要使用该接口。
*   使用防火墙或访问控制列表限制对 Jenkins CLI 接口的访问。

**项目地址:** [AbraXa5/Jenkins-CVE-2024-23897](https://github.com/AbraXa5/Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)