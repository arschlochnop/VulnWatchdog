## CVE-2016-10924-ebook-download-Directory Traversal

**漏洞编号:** CVE-2016-10924

**漏洞类型:** Directory Traversal

**影响应用:** WordPress ebook-download plugin

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** < 1.2

**利用条件:** 目标WordPress站点安装了受影响版本的ebook-download插件，并且攻击者可以发起HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10924 是 WordPress ebook-download 插件 1.2 版本之前存在的目录遍历漏洞。根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以得出以下结论：

1.  **有效性：** PoC代码有效。PoC代码使用Python编写，通过构造包含目录遍历的URL，向 `filedownload.php` 发起请求，尝试读取服务器上的任意文件。`pidbrute.py` 首先尝试读取 `/proc/sched_debug`，然后提示用户手动输入文件名进行读取，或者遍历 `/proc/<pid>/cmdline` 来获取进程信息。  `rvizx/CVE-2016-10924`仓库提供了PoC，表明该漏洞可被成功利用。

2.  **投毒风险：** PoC代码本身主要功能是利用漏洞，但存在一定的投毒风险。`pidbrute.py` 代码本身主要是利用目录遍历漏洞读取文件，但作者可以通过一些方式来隐藏恶意代码：
    *   **URL参数注入：** 在请求的URL中，可能会通过某种编码方式注入恶意代码，例如尝试执行系统命令。
    *   **文件内容解析：** 虽然PoC代码主要是读取文件内容，但如果读取的文件是可执行脚本（例如PHP文件），攻击者可以精心构造这些脚本，使其在被读取后执行恶意操作。
    *   **PID暴力枚举的风险：** 代码通过暴力枚举进程ID `/proc/<pid>/cmdline` 来尝试读取所有进程的信息。这本身可能对服务器性能造成一定的压力，如果被恶意利用，可能导致拒绝服务攻击。不过，这种风险相对较低。
    综合考虑，由于其主要功能是漏洞利用，而非直接执行恶意代码，所以投毒风险较低，这里给出 10% 的投毒风险。

3.  **利用方式：**
    a.  攻击者构造包含目录遍历的URL，例如：
    ```
    /wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../../wp-config.php
    ```
    b.  `filedownload.php` 脚本没有充分验证 `ebookdownloadurl` 参数，导致攻击者可以读取任意文件。
    c.  利用 PoC 脚本（`pidbrute.py`），可以自动化地进行目录遍历和PID枚举，更高效地获取敏感信息。

总而言之，该漏洞利用方式较为简单，危害较高，攻击者可以利用该漏洞读取 WordPress 配置文件（`wp-config.php`），获取数据库凭据等敏感信息，进而控制整个网站。

**项目地址:** [rvizx/CVE-2016-10924](https://github.com/rvizx/CVE-2016-10924)

**漏洞详情:** [CVE-2016-10924](https://nvd.nist.gov/vuln/detail/CVE-2016-10924)