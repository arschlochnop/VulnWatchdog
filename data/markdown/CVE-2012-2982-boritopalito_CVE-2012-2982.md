## CVE-2012-2982-Webmin-命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.590

**利用条件:** 需要Webmin的身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2012-2982是Webmin 1.590及更早版本中file/show.cgi文件存在的一个命令注入漏洞。经过身份验证的远程用户可以通过在路径名中使用无效字符（如 | 管道符）来执行任意命令。

**有效性：**根据漏洞库信息、搜索结果以及利用代码仓库SieGer05/CVE-2012-2982-Webmin-Exploit和Rapid7的Metasploit模块（exploit/unix/webapp/webmin_show_cgi_exec）的存在，确认该漏洞是有效的，并且存在公开可用的PoC。

**投毒风险：**提供的PoC代码主要功能是尝试登录Webmin。虽然这段代码本身看起来无害，但依赖了如okhttp3等第三方库，且`jcommander`的版本为`LATEST`，这引入了一些不确定性，但整体风险较低。仓库中是否存在其他隐蔽的恶意代码无法仅凭提供的片段判断，整体投毒风险评估为10%。需要注意的是，该PoC代码目前仅实现了登录功能，还未实现命令注入，需要进一步开发才能完整利用该漏洞。

**利用方式：**该漏洞的利用方式如下：

1.  攻击者需要首先获取Webmin的有效用户名和密码。
2.  然后，攻击者向`file/show.cgi`发送包含恶意字符（如`|`）的请求。例如，可以将恶意字符注入到文件路径参数中，从而执行任意命令。
3. Webmin会解析文件路径，由于没有正确过滤恶意字符，导致命令注入。
4.  攻击者可以利用该漏洞执行任意系统命令，从而完全控制Webmin服务器。

**项目地址:** [boritopalito/CVE-2012-2982](https://github.com/boritopalito/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)