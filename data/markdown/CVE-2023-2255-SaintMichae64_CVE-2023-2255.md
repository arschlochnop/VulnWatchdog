## CVE-2023-2255-LibreOffice-远程文件加载

**漏洞编号:** CVE-2023-2255

**漏洞类型:** 远程文件加载

**影响应用:** LibreOffice

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** 7.4 (小于 7.4.7), 7.5 (小于 7.5.3)

**利用条件:** 用户打开恶意构造的 LibreOffice 文档

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-2255 漏洞是 LibreOffice 中存在的权限控制不当漏洞，允许攻击者构造恶意的文档，在用户不知情的情况下加载外部链接的内容。攻击者通过在 LibreOffice 文档中嵌入包含外部链接的浮动框架（Floating Frames），当用户打开该文档时，LibreOffice 会自动加载这些外部链接的内容，而不会提示用户进行授权。这种行为与 LibreOffice 中对其他类型链接内容的处理方式不一致。

**有效性：**

根据提供的漏洞信息和搜索引擎结果，漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `exploit.py` 的作用是创建一个包含恶意 payload 的 LibreOffice 文档（.odt文件）。该脚本读取指定的 payload 文件，并将其嵌入到 .odt 文件中作为一个宏。`README.md` 文件提供了使用该脚本的命令示例，表明该脚本旨在生成一个利用该漏洞的文档。

**投毒风险：**

分析 `exploit.py` 的代码，其主要功能是将用户指定的 payload 文件内容嵌入到生成的 .odt 文件中，没有发现作者隐藏的投毒代码。Payload的安全性由用户自己负责。考虑到 payload 可能是任意代码，从最终利用效果而言，存在用户执行恶意 payload 的风险。投毒风险较低，但存在最终payload可能有害的可能性，估计概率为1% (此处的投毒指的是代码本身是否包含恶意目的，而非最终payload是否是恶意的)。

**利用方式：**

1.  攻击者使用 `exploit.py` 脚本，指定一个恶意 payload 文件，生成一个恶意的 LibreOffice 文档（.odt 文件）。Payload可以是通过各种方式执行的命令，webshell或者脚本等。
2.  攻击者将该恶意文档发送给目标用户。
3.  目标用户使用受影响版本的 LibreOffice 打开该恶意文档。
4.  LibreOffice 在未提示用户的情况下，自动加载文档中浮动框架链接的外部资源，触发 payload 的执行。如果 payload 是一个 webshell，则成功获取shell。

**项目地址:** [SaintMichae64/CVE-2023-2255](https://github.com/SaintMichae64/CVE-2023-2255)

**漏洞详情:** [CVE-2023-2255](https://nvd.nist.gov/vuln/detail/CVE-2023-2255)