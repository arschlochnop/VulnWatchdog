## CVE-2024-9047 - WordPress File Upload插件路径遍历漏洞

**漏洞编号:** CVE-2024-9047

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WordPress File Upload插件

**危害等级:** 高危，可能导致敏感文件泄露或删除

**影响版本:** <= 4.24.11

**利用条件:** 目标WordPress站点安装了受影响版本的WordPress File Upload插件，且运行在PHP 7.4或更早版本上。攻击者需要能够访问存在漏洞的WordPress站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9047是WordPress File Upload插件（版本<= 4.24.11）中wfu_file_downloader.php文件存在的一个未经身份验证的路径遍历漏洞。攻击者可以通过构造恶意的请求，读取或删除服务器上的任意文件。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在以及受影响的版本范围。PoC代码 `cve-2024-9047.sh` 脚本利用了`wfu_file_downloader.php` 中的路径遍历漏洞读取指定文件。

**投毒风险分析：**

提供的PoC代码主要是一个shell脚本，用于发送HTTP请求利用路径遍历漏洞。该脚本本身功能较为简单，风险较低。检查了 `cve-2024-9047.sh` 脚本， 主要功能是发送包含恶意文件路径的HTTP请求到 `wfu_file_downloader.php` 。该脚本没有发现明显的恶意代码或后门。`README.md` 文件也主要是漏洞描述和使用说明，未发现可疑内容。 但考虑到Github仓库可能被篡改或替换,所以存在10%的投毒风险，此风险主要来自下载了被篡改的脚本。

**利用方式分析：**

1.  **确定目标：** 使用Fofa等搜索引擎查找安装了受影响版本WordPress File Upload插件的网站。
2.  **构造恶意请求：**  攻击者构造包含路径遍历payload的HTTP请求，发送到 `wfu_file_downloader.php` 文件。 例如，可以使用 `..` 来跳出目录限制，访问系统敏感文件，如 `/etc/passwd`。
3.  **发送请求并获取文件内容：**  服务器在未进行充分验证的情况下，处理请求并返回指定文件的内容。
4.  **文件删除** 由于漏洞也可以进行文件删除,攻击者可以发送恶意请求,删除服务器上的文件,造成拒绝服务攻击。

**项目地址:** [verylazytech/CVE-2024-9047](https://github.com/verylazytech/CVE-2024-9047)

**漏洞详情:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)