## CVE-2023-28121 - WooCommerce Payments 未授权提权漏洞

**漏洞编号:** CVE-2023-28121

**漏洞类型:** 权限提升

**影响应用:** WooCommerce Payments WordPress Plugin

**危害等级:** 高危，允许未经身份验证的攻击者以管理员身份发送请求，从而获得对站点的完全控制。

**影响版本:** < 5.6.2

**利用条件:** 目标站点已安装并启用了受影响版本的 WooCommerce Payments 插件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-28121 是 WooCommerce Payments 插件中的一个未授权提权漏洞。根据漏洞库信息，未经验证的攻击者可以代表高权限用户（如管理员）发送请求，从而获得管理员权限。提供的漏洞利用代码是一个Python脚本，旨在利用此漏洞。脚本首先检查 WooCommerce Payments 插件的版本是否易受攻击，然后尝试创建一个新的管理员用户或提升现有用户的权限。该脚本还包含Telegram通知功能，可以在成功利用后发送通知。由于脚本直接对目标站点进行操作，修改用户权限，存在潜在的风险（例如，如果脚本执行失败，可能会导致站点不稳定或数据损坏）。此外，该脚本包含从结果文件中读取网站 URL 的功能。如果脚本在未经验证的环境中使用恶意url文件，可能会增加批量攻击的风险。因此，该脚本存在一定的投毒风险，风险系数预估为10%。

漏洞利用方式：
1.  攻击者向目标网站发送特制的 HTTP 请求，模拟管理员或其他高权限用户的操作。
2.  利用 WooCommerce Payments 插件中的身份验证绕过漏洞，绕过权限验证。
3.  成功执行恶意操作，例如创建新的管理员帐户或修改现有帐户的权限。

**项目地址:** [0axz-tools/CVE-2023-28121](https://github.com/0axz-tools/CVE-2023-28121)

**漏洞详情:** [CVE-2023-28121](https://nvd.nist.gov/vuln/detail/CVE-2023-28121)