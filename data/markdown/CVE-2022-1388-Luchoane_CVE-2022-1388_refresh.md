## CVE-2022-1388-F5 BIG-IP-iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标设备运行受影响的F5 BIG-IP版本，且可以通过网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，已被CISA列入已知被利用的漏洞目录。提供的POC代码 `refresh.py` 利用该漏洞，通过构造特定的HTTP请求头（包括`Host`、`Authorization`、`X-F5-Auth-Token`、`Connection`和`Content-Type`）和JSON格式的请求体，向目标设备的iControl REST API发送恶意请求，从而执行任意命令。利用方式包括单目标利用、批量利用和交互式shell。

**有效性：**
提供的POC代码 `refresh.py` 有效，可以用来验证和利用 CVE-2022-1388 漏洞。

**投毒风险：**
POC代码本身没有明显的投毒后门。代码逻辑比较简单，主要是发送特定的 HTTP 请求以绕过身份验证并执行命令。代码通过 `requests` 库发送 HTTP 请求，`urllib3.disable_warnings()` 禁用了SSL警告，这在生产环境中不推荐，但是为了测试，减少不必要的报错。`Authorization` 头部使用了硬编码的 base64 编码的用户名密码 `admin:horizon3`，这是一个测试凭证，但如果直接使用在生产环境中，存在安全风险。`Connection: X-F5-Auth-Token`  表明客户端希望连接在发送 `X-F5-Auth-Token` 后保持打开状态，以便可以发送更多请求。 `Host: 127.0.0.1` 头部用于欺骗服务器，使其认为请求来自本地。总体而言，投毒风险较低，但是存在误用风险，例如使用硬编码的凭据或禁用 SSL 验证。

**利用方式：**
1.  **单目标利用：** 使用 `-u` 参数指定目标URL，`-c` 参数指定要执行的命令。
2.  **批量利用：** 使用 `-f` 参数指定包含目标URL列表的文件，`-c` 参数指定要执行的命令。
3.  **交互式shell：** 使用 `-s` 参数指定目标URL，获取一个交互式的shell。

**项目地址:** [Luchoane/CVE-2022-1388_refresh](https://github.com/Luchoane/CVE-2022-1388_refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)