## CVE-2023-21716-Microsoft Word 远程代码执行漏洞

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Word

**危害等级:** 高危，允许远程攻击者在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Microsoft Office 2013 SP1, 2016, 2019, 2021, 365 Apps for Enterprise, SharePoint Server 2013 SP1, 2016, 2019, Subscription Edition, Office Online Server, Office Web Apps Server 2013 SP1等，具体版本范围请参考CVE描述。

**利用条件:** 用户需要打开特制的RTF文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-21716是一个Microsoft Word远程代码执行漏洞，CVSS评分为9.8（严重）。漏洞根源在于Microsoft Word在解析RTF文件时，`wwlib.dll`库中存在堆损坏漏洞。利用方式是构造一个包含恶意代码的RTF文件，当用户打开或预览该文件时，攻击者可以在受害者计算机上执行任意代码。

提供的POC代码 `POC.py` 通过生成一个包含大量字体定义的RTF文件来触发漏洞。该脚本允许用户指定字体数量，默认值为32761。它创建了一个名为 `tezt.rtf` 的文件，其中包含一个字体表，该表具有大量条目 `{\f%dA;}\n`，目的是利用字体表解析过程中的整数溢出或堆损坏。

README.md 只是一个描述性的文件，没有恶意代码。

**有效性：** 根据漏洞描述和POC代码原理，该POC代码有较高的有效性，通过构造包含大量字体定义的RTF文件，可以触发目标Word版本的漏洞，从而造成远程代码执行。

**投毒风险：** 在提供的代码仓库中，`POC.py` 文件的目的是生成触发漏洞的RTF文件，没有发现隐藏的恶意代码或后门。README.md文件也只是描述性文档。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用 `POC.py` 脚本生成恶意的 `tezt.rtf` 文件。
2.  攻击者将该RTF文件发送给受害者。
3.  受害者使用存在漏洞的Microsoft Word版本打开 `tezt.rtf` 文件。
4.  Word解析该文件时，由于字体表包含大量字体，触发`wwlib.dll`库的堆损坏漏洞。
5.  攻击者利用该漏洞在受害者系统上执行任意代码。

**项目地址:** [AiK1d/CVE-2023-21716-POC](https://github.com/AiK1d/CVE-2023-21716-POC)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)