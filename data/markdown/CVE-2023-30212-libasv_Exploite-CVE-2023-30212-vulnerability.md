## CVE-2023-30212 - OURPHP v7.2.0 反射型XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 反射型跨站脚本 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致会话劫持、网页挂马、钓鱼攻击等

**影响版本:** <= 7.2.0

**利用条件:** 用户需要点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212漏洞存在于OURPHP v7.2.0的`/client/manage/ourphp_out.php`文件中。这是一个反射型XSS漏洞，攻击者可以通过构造包含恶意JavaScript代码的URL，诱使用户点击该URL来触发XSS攻击。

**有效性：**
从漏洞信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞是真实存在的，并且有可用的POC。
提供的POC代码 `/tmp/7ee5bd55888342b8dc5c74543ffffa17/README.md` 中，描述了利用该漏洞的URL：`http://localhost:8080/client/manage/ourphp_out.php?ourphp_admin=logout&out=<\/script><script>alert(xss)<\/script>`。 该URL将导致在受害者浏览器中执行`alert(xss)`，证明了漏洞的存在。

**投毒风险：**
`/tmp/7ee5bd55888342b8dc5c74543ffffa17/README.md`文件主要描述了如何配置Docker环境来复现该漏洞。其中包含了Docker安装、镜像构建和容器运行的步骤，以及MySQL数据库的简单配置。这些步骤本身并不存在明显的投毒风险。
`/tmp/7ee5bd55888342b8dc5c74543ffffa17/admin.php` 文件看起来像是OURPHP的一个后台管理页面, 包含了登录验证相关的代码。虽然里面没有发现直接插入的恶意代码，但原始代码本身可能包含其他漏洞或者后门。但是基于当前提供的信息，很难确定是否存在恶意行为，所以投毒风险较低。

综合来看，该仓库的主要目的是为了复现CVE-2023-30212漏洞，其投毒风险较低，为10%。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://localhost:8080/client/manage/ourphp_out.php?ourphp_admin=logout&out=<\/script><script>alert(xss)<\/script>`
2.  攻击者通过各种手段（例如，电子邮件、社交媒体等）诱使受害者点击该URL。
3.  如果受害者点击了该URL，恶意JavaScript代码将在受害者的浏览器中执行，从而实现XSS攻击。攻击者可以利用XSS攻击来窃取用户的cookie、会话信息，或者进行网页挂马、钓鱼攻击等恶意行为。

**项目地址:** [libasv/Exploite-CVE-2023-30212-vulnerability](https://github.com/libasv/Exploite-CVE-2023-30212-vulnerability)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)