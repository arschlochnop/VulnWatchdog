## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为默认shell，且CGI脚本或其他方式允许通过环境变量传递数据到Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过构造包含恶意代码的环境变量，当Bash执行某些操作（例如，通过CGI脚本）时，这些恶意代码会被执行，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的Dockerfile和利用代码，可以判断该POC代码是有效的。Dockerfile配置了一个易受攻击的环境，包括安装了老版本的Ubuntu、Apache2以及一个CGI脚本。exp_deface.sh脚本演示了如何通过构造特定的User-Agent头，向服务器发送包含恶意Bash代码的环境变量，从而修改目标服务器的index.html文件。

**投毒风险：**

在提供的代码仓库中，存在一定程度的投毒风险。尽管主要目的是为了演示Shellshock漏洞，但exp_deface.sh脚本本身就具有一定的破坏性。如果未经授权地在目标系统上运行此脚本，会导致网页被篡改，构成非法入侵行为。分析：

*   **Dockerfile:**  主要用于构建漏洞环境，没有发现明显的恶意代码。
*   **README.md:**  提供漏洞描述和使用说明，包含免责声明。
*   **exp_deface.sh:**  虽然演示了漏洞利用，但也包含修改网页内容的操作，存在潜在的破坏性。该脚本未经授权的使用构成恶意行为。
*   **index.html:**  默认的网页内容，没有恶意代码。
*   **main.sh:**  启动Apache2服务的脚本，没有恶意代码。
*   **vulnerable:**  CGI脚本，用于触发Shellshock漏洞，本身不包含恶意代码，但会被利用。

代码仓库的主要目的是复现和演示漏洞，但利用脚本具有一定的破坏性，如果滥用，可能会造成实际损害，存在10%的投毒风险，主要风险点在于使用者滥用`exp_deface.sh`脚本进行未授权的渗透。

**利用方式：**

1.  **环境搭建:** 使用Dockerfile构建包含易受攻击Bash版本的Docker容器。
2.  **CGI脚本:**  将vulnerable脚本放置在CGI目录下，使其能够被Apache服务器执行。
3.  **构造恶意请求:**  利用curl命令构造包含恶意Bash代码的环境变量，例如User-Agent头。
4.  **触发漏洞:**  向CGI脚本发送构造的恶意请求，触发Shellshock漏洞，从而执行恶意代码。
5.  **远程代码执行:** 恶意代码在服务器上执行，攻击者可以执行任意命令，例如修改网页内容(defacement)。

**项目地址:** [RadYio/CVE-2014-6271](https://github.com/RadYio/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)