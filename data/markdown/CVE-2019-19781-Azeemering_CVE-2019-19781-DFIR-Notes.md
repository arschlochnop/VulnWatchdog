## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)