## CVE-2024-41713 - Mitel MiCollab 路径遍历

**漏洞编号:** CVE-2024-41713

**漏洞类型:** 路径遍历

**影响应用:** Mitel MiCollab

**危害等级:** 高危，可能导致未授权访问，数据泄露和系统配置篡改

**影响版本:** <= 9.8 SP1 FP2 (9.8.1.201)

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-41713是一个Mitel MiCollab NuPoint Unified Messaging (NPM)组件中的路径遍历漏洞。未经验证的攻击者可以通过发送特制的请求来读取服务器上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** 由于MiCollab在处理用户输入时没有进行充分的验证，攻击者可以在文件路径中使用`..;`来绕过访问控制，从而访问受限目录之外的文件。
2.  **利用步骤：**
    *   首先，POC代码通过检查`/portal/`和`/npm-pwg/..;/usp/`页面内容，来确认目标服务器是否为Mitel MiCollab并且存在漏洞。
    *   如果确认存在漏洞，则构造包含恶意文件路径的POST请求发送到`/npm-pwg/..;/ReconcileWizard/reconcilewizard/sc/IDACall`接口。 文件路径被编码在POST数据中的`_transaction`参数中，利用了`downloadReport`操作中的`reportName`字段。 
    *   服务器在处理这个请求时，由于路径遍历漏洞，会读取攻击者指定的文件，并通过响应返回文件内容。
3.  **代码分析：**
    *   代码首先定义了目标URL和目标文件，然后构造了包含恶意路径的POST请求。
    *   代码使用requests库发送HTTP请求，并禁用SSL验证以避免证书问题。
    *   代码检查了服务器的响应，并打印读取到的文件内容。
4.  **投毒风险评估：** 代码本身没有明显的投毒风险。该代码的功能明确，即利用路径遍历漏洞读取文件。代码没有执行恶意操作，例如修改文件或执行系统命令。代码中使用的库都是标准库，没有引入任何外部依赖项，这降低了引入恶意代码的可能性。
5.  **有效性：**  根据搜索结果和漏洞库信息，此漏洞PoC已公开，并且被积极利用。提供的PoC代码直接利用了路径遍历漏洞读取任意文件，因此有效性很高。


**项目地址:** [watchtowrlabs/Mitel-MiCollab-Auth-Bypass_CVE-2024-41713](https://github.com/watchtowrlabs/Mitel-MiCollab-Auth-Bypass_CVE-2024-41713)

**漏洞详情:** [CVE-2024-41713](https://nvd.nist.gov/vuln/detail/CVE-2024-41713)