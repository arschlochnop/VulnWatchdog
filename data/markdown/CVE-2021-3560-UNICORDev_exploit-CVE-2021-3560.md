## CVE-2021-3560-polkit-本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户提权至root

**影响版本:** 0.0 - 0.118

**利用条件:** 本地用户权限，目标系统安装了存在漏洞的polkit版本，需要accountsservice, gnome-control-center, openssl, sudo

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的攻击者通过绕过 D-Bus 请求的凭据检查来提升权限至 root 用户。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息表明该漏洞已被积极利用（KEV），并且存在公开可用的利用代码。

**投毒风险：**
代码中存在轻微的投毒风险，主要集中在以下几个方面：

1.  **依赖项安装：** Dockerfile中`apt install -y accountsservice gnome-control-center sudo openssl`命令确保了利用程序所需的依赖项已安装，但如果这些软件包的源被篡改，则可能引入恶意软件。虽然概率较低，但不能完全排除。
2.  **脚本执行：** exploit-CVE-2021-3560.py脚本从GitHub下载，如果GitHub仓库被攻陷，脚本可能被替换为恶意版本。用户应该审查下载的脚本，并验证其哈希值。

总体而言，直接的、明显的恶意代码（如反向shell或数据窃取）不存在。但是，由于脚本执行敏感操作（创建用户、修改密码、提升权限），即使是细微的偏差也可能导致安全问题，因此存在较低的投毒风险，这里评估为5%。

**利用方式：**

1.  **漏洞原理：** polkit在处理D-Bus请求时，由于未正确验证凭据，导致攻击者可以伪造请求，从而绕过身份验证。
2.  **利用步骤：**
    *   攻击者使用提供的exploit-CVE-2021-3560.py脚本，指定用户名和密码（可选）。
    *   脚本利用漏洞，在系统中创建一个具有sudo权限的新用户。
    *   攻击者可以使用新创建的用户通过`su`命令切换到该用户，然后使用`sudo su`命令获得root权限。
3.  **缓解措施：**
    *   将polkit升级到已修复的版本。
    *   限制对D-Bus的访问。
    *   监控系统中的异常用户创建和提权行为。

**项目地址:** [UNICORDev/exploit-CVE-2021-3560](https://github.com/UNICORDev/exploit-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)