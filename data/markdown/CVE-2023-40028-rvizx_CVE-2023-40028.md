## CVE-2023-40028 - Ghost CMS 任意文件读取

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost CMS

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 5.59.1

**利用条件:** 需要具有Ghost CMS的管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40028是Ghost CMS中存在的一个任意文件读取漏洞。经过身份验证的用户可以上传包含符号链接的文件。这些符号链接随后可用于读取服务器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞描述：** 经过身份验证的用户可以上传包含符号链接的文件。
2.  **利用条件：** 需要Ghost CMS的版本小于5.59.1并且具有管理员权限。
3.  **利用步骤：**
    *   攻击者需要登录Ghost CMS后台。
    *   攻击者创建一个指向目标文件的符号链接。
    *   攻击者上传包含该符号链接的压缩包。
    *   攻击者通过访问上传的符号链接来读取目标文件。
4.  **有效性：** 根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码通过创建一个指向目标文件的符号链接，然后将其打包并上传到Ghost CMS，从而实现任意文件读取。
5.  **投毒风险：** PoC代码本身主要功能是创建和上传包含恶意符号链接的zip文件以利用该漏洞。经过分析，代码中发现轻微的投毒风险，主要集中在以下几点：
    *   `os.system`函数的使用：代码中多次使用`os.system`来执行系统命令，例如创建符号链接、压缩文件等。如果目标系统上存在恶意程序，这些命令可能会被篡改以执行恶意操作。 虽然目前代码中的命令是良性的，但攻击者可以修改这些命令来执行其他恶意操作，例如下载和执行恶意代码，或者删除系统文件。如果存在其他的恶意代码可以判定为投毒风险。 
    *   依赖外部资源：PoC代码依赖`curl`命令进行登录身份验证。如果`curl`命令被替换为恶意版本，攻击者可以窃取用户的登录凭据。但这种风险主要取决于目标系统的安全性，而非PoC代码本身。

    因此，考虑到以上因素，该PoC代码存在一定的投毒风险，比例约为10%。主要是因为其依赖于系统命令执行，存在被篡改的可能。

**项目地址:** [rvizx/CVE-2023-40028](https://github.com/rvizx/CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)