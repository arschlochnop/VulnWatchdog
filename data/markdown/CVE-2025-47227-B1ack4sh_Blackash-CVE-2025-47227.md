## CVE-2025-47227-ScriptCase-管理员账户接管

**漏洞编号:** CVE-2025-47227

**漏洞类型:** 不正确的权限管理/密码重置缺陷

**影响应用:** ScriptCase

**危害等级:** 高危，允许未经身份验证的攻击者接管管理员账户

**影响版本:** <= 9.12.006 (23)

**利用条件:** 需要网络访问目标ScriptCase实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息，CVE-2025-47227 存在于 Netmake ScriptCase 9.12.006 (23) 及更早版本的生产环境扩展中。攻击者可以通过发送 GET 和 POST 请求到 `login.php` 绕过身份验证，从而接管管理员账户。提供的POC代码尝试自动化利用此漏洞。

**有效性评估：**

POC代码似乎有效，因为它实现了以下步骤，这些步骤与漏洞描述中提到的攻击流程相符：

1.  **准备会话：** 通过访问 `login.php` 设置会话状态。
2.  **获取验证码：** 从 `secureimage.php` 获取验证码图片。
3.  **重置密码：** 使用识别的验证码和伪造的电子邮件地址，向 `login.php` 发送密码重置请求。

POC代码使用了OCR (pytesseract) 来自动解决验证码。如果OCR失败，它还提供了手动输入验证码的选项，以提高成功率。

根据github链接 [https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228](https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228)，该漏洞可以实现预身份验证的远程命令执行。

**投毒风险分析：**

该脚本使用了以下第三方库：

*   Pillow (PIL): 用于图像处理。
*   pytesseract: 用于OCR。
*   requests: 用于发送HTTP请求。
*   BeautifulSoup4: 用于HTML解析。

这些库本身是常用的，并且没有明显的迹象表明作者故意引入了恶意代码。但是，所有第三方依赖项都可能引入供应链风险。该代码本身会生成一个随机密码,并输出,本身不具有后门特性.
以下是一些潜在的风险点：
*  使用了verify=False,忽略SSL证书验证.这可能导致中间人攻击.增加信息泄露风险。
*   OCR的准确性依赖于训练数据和图像质量。如果OCR无法正确识别验证码，攻击可能会失败.但代码中包含手动输入验证码重试的机制，一定程度上降低了此风险。
* 该代码中的email参数是伪造的，但攻击成功不需要真实的邮箱,所以问题不大。
*   代码在密码重置成功后会打印新密码和(伪造的)电子邮件地址。如果此代码在公共环境中运行，可能会泄露这些凭据。

总体而言，POC代码中存在明显的投毒代码的可能性较低（大约 10%），主要是由于对第三方库的依赖以及忽略SSL证书验证带来的潜在风险，但代码本身的目的仅为验证漏洞，不包含后门. 风险主要集中在依赖库的安全性以及脚本的运行环境。

**利用方式：**

1.  攻击者首先发送一个GET请求到`login.php`，设置会话中的`is_page`变量为true，绕过身份验证检查。
2.  攻击者发送一个GET请求到`secureimage.php`，获取验证码图片。
3.  攻击者使用OCR软件识别验证码图片中的文本。
4.  攻击者构造一个POST请求到`login.php`，包含以下参数：
    *   `ajax`: `nm`
    *   `nm_action`: `change_pass`
    *   `email`: 伪造的电子邮件地址
    *   `pass_new`: 新密码
    *   `pass_conf`: 新密码确认
    *   `lang`: `en-us`
    *   `captcha`: 识别的验证码文本
5.  如果验证码正确，服务器将重置管理员密码为攻击者提供的新密码。攻击者可以使用新密码登录管理员账户。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-47227](https://github.com/B1ack4sh/Blackash-CVE-2025-47227)

**漏洞详情:** [CVE-2025-47227](https://nvd.nist.gov/vuln/detail/CVE-2025-47227)