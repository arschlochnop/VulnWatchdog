## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户凭据泄露、会话劫持、恶意脚本执行

**影响版本:** 小于 11.109.9999.116

**利用条件:** 需要目标cPanel实例存在漏洞，且用户访问恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29489 是 cPanel 中存在的一个反射型跨站脚本漏洞。攻击者可以通过构造包含恶意 JavaScript 代码的 URL，当用户点击该链接时，恶意脚本会在用户的浏览器中执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，可以判断该POC代码有效。POC代码通过构造特定的 URL (`/cpanelwebcall/<img%20src=x%20onerror="prompt('0-D3y')">hacked%20by%200-D3y`)，利用 cPanel 对 `cpanelwebcall` 端点的不当处理，触发 XSS 漏洞。成功利用会在页面上弹窗显示 '0-D3y'，证明恶意脚本已成功执行。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。代码的功能主要是：

1.  从文件中读取 URL 列表
2.  对每个 URL 构造包含 XSS Payload 的请求
3.  验证响应中是否成功执行了 XSS Payload
4.  如果成功，将 URL 写入文件并尝试在浏览器中打开。

代码中使用的第三方库如 `shodan`, `requests`, `BeautifulSoup` 均为常用的安全测试工具，没有发现恶意行为。因此，投毒风险较低，预估为 0%。

**利用方式：**

利用方式如下：

1.  准备目标 cPanel 服务器的 URL 列表。
2.  运行 POC 脚本，脚本会自动对 URL 列表中的每个 URL 进行 XSS 测试，如果目标存在漏洞，会尝试利用。
3.  或者，攻击者可以直接构造包含恶意 XSS Payload 的 URL，然后诱骗用户点击该 URL。例如: `http://target/cpanelwebcall/<img%20src=x%20onerror="prompt('0-D3y')">hacked%20by%200-D3y`
4.  如果用户点击了恶意链接，且目标 cPanel 版本存在漏洞，则 XSS Payload 会在用户浏览器中执行。

**缓解措施：**

1.  升级 cPanel 到修复版本 (>= 11.109.9999.116)。
2.  对用户输入进行严格的过滤和转义。

**项目地址:** [0-d3y/CVE-2023-29489](https://github.com/0-d3y/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)