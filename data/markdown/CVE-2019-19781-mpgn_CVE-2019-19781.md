## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)