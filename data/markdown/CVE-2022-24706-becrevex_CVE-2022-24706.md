## CVE-2022-24706-Apache CouchDB-远程代码执行

**漏洞编号:** CVE-2022-24706

**漏洞类型:** 远程代码执行

**影响应用:** Apache CouchDB

**危害等级:** 高危，可能导致未经授权的访问和远程代码执行

**影响版本:** <= 3.2.1

**利用条件:** 目标CouchDB实例使用默认配置，未进行安全加固，并且4369端口对外开放。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-24706 漏洞是 Apache CouchDB 3.2.1 及更早版本中存在的一个远程代码执行漏洞。由于默认安装配置不安全，未经身份验证的攻击者可以利用此漏洞获取管理员权限。

**利用方式：**

1.  **EPMD端口扫描：** 攻击者首先需要确定目标 CouchDB 实例的 EPMD (Erlang Port Mapper Daemon) 端口是否对外开放（通常是 4369 端口）。
2.  **节点发现：** 通过 EPMD 服务，攻击者可以发现 CouchDB 集群中的 Erlang 节点。
3.  **身份验证绕过：** 漏洞的根源在于 CouchDB 使用了默认的 Erlang cookie 值（"monster"）。攻击者可以使用此默认 cookie 绕过身份验证。
4.  **远程代码执行：** 成功绕过身份验证后，攻击者可以执行任意代码。

**有效性：**

提供的 Nmap 脚本 `erlang_vuln_checker.nse` 旨在检测目标 CouchDB 实例是否存在此漏洞。它通过以下步骤进行验证：

1.  连接到目标主机的 EPMD 端口。
2.  检索 Erlang 节点信息。
3.  尝试使用默认 cookie (或用户提供的 cookie) 对 Erlang 节点进行身份验证。
4.  如果身份验证成功，则表明存在漏洞。

根据漏洞信息和搜索结果，此漏洞利用代码是有效的，可以用来检测漏洞是否存在。

**投毒风险：**

查看提供的脚本代码，该 Nmap 脚本主要用于检测目标是否存在 CVE-2022-24706 漏洞，没有发现任何可疑的或恶意的代码，因此几乎没有投毒风险。


**项目地址:** [becrevex/CVE-2022-24706](https://github.com/becrevex/CVE-2022-24706)

**漏洞详情:** [CVE-2022-24706](https://nvd.nist.gov/vuln/detail/CVE-2022-24706)