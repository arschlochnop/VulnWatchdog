## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致任意文件覆盖和权限提升

**影响版本:** 5.8 <= Kernel Version < 5.16.11 (Also affects 5.15.x before 5.15.25 and 5.10.x before 5.10.102)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个存在于Linux内核中的本地权限提升漏洞。该漏洞允许未授权的本地用户覆盖只读文件中的数据。通过利用此漏洞，攻击者可以将恶意代码注入到以root权限运行的进程中，从而获得root权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的PoC是有效的，并且已被广泛利用。漏洞利用代码中，虽然提供了一个检测脚本，但结合搜索结果来看，确认漏洞利用是可行的。

**投毒风险：**
提供的漏洞利用代码主要是一个检测脚本，用于检测目标系统是否存在该漏洞。`dpipe.sh`脚本主要通过比较内核版本来判断是否存在漏洞。`test.sh`脚本通过遍历不同的内核版本，调用`dpipe.sh`脚本进行检查。`README.md`文件提供漏洞的相关信息和使用说明。

尽管主要功能是漏洞检测，但仍然存在一定的投毒风险：
*   **依赖风险：** 如果攻击者替换了`dpipe.sh`脚本中的内核版本判断逻辑，可能会误导用户认为系统是安全的，从而降低用户的安全意识。
*   **潜在的后门植入：** 攻击者可以修改`dpipe.sh`或`test.sh`脚本，添加额外的代码，例如下载并执行恶意脚本等。然而，从目前的代码来看，这种风险较低。

综上所述，投毒风险评估为10%。主要风险在于脚本被篡改后误导用户或被用于下载恶意payload，但目前提供的代码本身没有明显的投毒行为。

**利用方式：**
利用Dirty Pipe漏洞进行权限提升的一般步骤如下：
1.  **利用管道 (pipe):**  创建一个管道用于和存在漏洞的内核函数进行交互。
2.  **寻找目标文件:** 找到一个目标文件，该文件需要具有较高的权限或对系统安全至关重要，例如SUID程序。
3.  **偏移计算:** 计算需要在目标文件中覆盖的具体位置。
4.  **数据注入:** 使用Dirty Pipe漏洞，将恶意代码或数据覆盖到目标文件中。
5.  **触发执行:** 执行被修改的文件，从而触发恶意代码，最终获得更高的权限。

漏洞利用代码本身不包含完整的利用程序，而是着重于漏洞检测。实际的漏洞利用通常涉及更复杂的代码，用于打开目标文件、创建管道、计算偏移量和写入恶意数据。

**项目地址:** [muhammad1596/CVE-2022-0847-dirty-pipe-checker](https://github.com/muhammad1596/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)