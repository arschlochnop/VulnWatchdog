## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/恶意内容注入

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/恶意内容注入

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露或恶意内容被注入到上传的文件中

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入、支持partial PUT、存在特定的目录结构、攻击者需要了解敏感文件名、使用Tomcat文件会话保持且为默认存储位置、存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，由于Tomcat在处理包含内部点（file.Name）的文件名时存在缺陷，结合Default Servlet的写入功能，可能导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。

**漏洞利用有效性：**
根据搜索结果和漏洞库信息，CVE-2025-24813被广泛认为是可利用的，并且已经出现公开的利用方法。多个安全厂商和CERT机构发布了关于该漏洞的警告，部分报告指出该漏洞已经在野外被利用，因此该漏洞利用的有效性较高。

**投毒风险分析：**
提供的漏洞利用代码看起来像是 Maven Wrapper 脚本。Maven Wrapper 本身是一个工具，用于确保项目使用特定版本的 Maven 构建工具。这个脚本的功能是下载和执行指定版本的 Maven。因此，直接在这个脚本中进行投毒相对困难。但是，仍然存在一些潜在的投毒风险点：

1.  **distributionUrl篡改：** 攻击者可以修改 `.mvn/wrapper/maven-wrapper.properties` 文件中的 `distributionUrl` 属性，将其指向一个恶意的 Maven 发行版。这个恶意的 Maven 发行版可能包含后门或恶意代码，当开发者或构建系统使用 Maven Wrapper 构建项目时，就会执行这些恶意代码。
2.  **伪造 Maven 仓库：** 攻击者可以搭建一个伪造的 Maven 仓库，拦截 Maven Wrapper 下载 Maven 发行版的请求。这个伪造的 Maven 仓库可以返回一个包含后门的 Maven 发行版。

考虑到 Maven Wrapper 脚本本身的性质，以及通常会对下载的 Maven 发行版进行校验，直接投毒的概率较低，估计在5%左右。但也不能完全排除，因为攻击者可以通过社会工程学等手段诱导用户使用被篡改的 `distributionUrl`。

**漏洞利用方式：**
根据漏洞描述，漏洞利用方式取决于满足的条件：

1.  **信息泄露/恶意内容注入：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   存在一个公共上传目录的子目录，作为安全敏感文件的目标 URL。
    *   攻击者了解安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。
    攻击者可以利用路径等价漏洞读取敏感文件或向其中注入恶意内容。

2.  **远程代码执行：** 如果满足以下所有条件：
    *   Default Servlet 开启写入功能。
    *   支持 partial PUT 请求。
    *   应用程序使用 Tomcat 的文件会话保持机制，且为默认存储位置。
    *   应用程序包含一个可以被用于反序列化攻击的库。
    攻击者可以利用路径等价漏洞将恶意序列化数据写入到会话文件中，并触发反序列化漏洞，从而执行任意代码。

**总结：**
CVE-2025-24813 是一个高危漏洞，需要尽快进行修复。在修复之前，应该禁用 Default Servlet 的写入功能，并限制 partial PUT 请求的使用。同时，应该对 Maven Wrapper 脚本进行安全审计，确保其指向的 Maven 发行版是可信的。

**项目地址:** [n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813](https://github.com/n0n-zer0/Spring-Boot-Tomcat-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)