## CVE-2025-32756 - Fortinet 栈缓冲区溢出

**漏洞编号:** CVE-2025-32756

**漏洞类型:** 栈缓冲区溢出

**影响应用:** FortiVoice, FortiMail, FortiNDR, FortiRecorder, FortiCamera

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** FortiVoice (7.2.0, 7.0.0-7.0.6, 6.4.0-6.4.10), FortiRecorder (7.2.0-7.2.3, 7.0.0-7.0.5, 6.4.0-6.4.5), FortiMail (7.6.0-7.6.2, 7.4.0-7.4.4, 7.2.0-7.2.7, 7.0.0-7.0.8), FortiNDR (7.6.0, 7.4.0-7.4.7, 7.2.0-7.2.4, 7.1.0-7.1.1, 7.0.0-7.0.6, 1.5.0-1.5.3, 1.4.0, 1.3.0-1.3.1, 1.2.0, 1.1.0), FortiCamera (2.1.0-2.1.3, 2.0 all versions, 1.1 all versions)

**利用条件:** 需要目标设备可网络访问，且漏洞存在于web管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32756 是 Fortinet 产品中的一个栈缓冲区溢出漏洞，允许未经身份验证的远程攻击者通过特制的 HTTP 请求执行任意代码或命令。漏洞存在于处理 HTTP 请求中的 `enc` 参数时，由于缺少适当的边界检查，导致缓冲区溢出。

**利用方式：**
1.  攻击者向目标 Fortinet 设备发送包含特制 AuthHash Cookie 的 HTTP 请求。
2.  AuthHash Cookie 中的 `enc` 参数包含恶意数据，该数据旨在溢出栈缓冲区。
3.  当设备处理该请求时，`enc` 参数中的数据会覆盖栈上的内存，从而允许攻击者执行任意代码。

**有效性：**
根据搜索结果和 PoC 代码，该漏洞已被积极利用，PoC 似乎有效。

**投毒风险：**
PoC代码的主要功能是溢出，虽然部分代码存在简化（例如硬编码的salt），但整体逻辑是为了验证漏洞，而不是植入后门或者恶意代码。投毒风险极低，判断投毒风险为5%，主要考虑作者可能在其他地方隐藏了一些不明显的恶意行为。此处的低概率投毒风险主要来自于作者引入了不必要的复杂逻辑，或者使用了不常见的编码方式，从而增加了代码审查的难度，存在植入恶意代码的可能性。

**项目地址:** [kn0x0x/CVE-2025-32756-POC](https://github.com/kn0x0x/CVE-2025-32756-POC)

**漏洞详情:** [CVE-2025-32756](https://nvd.nist.gov/vuln/detail/CVE-2025-32756)