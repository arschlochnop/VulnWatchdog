## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要Next.js应用使用了中间件进行权限校验，并且存在受影响的版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件中存在的权限绕过漏洞。根据漏洞描述，如果 Next.js 应用使用中间件进行权限验证，攻击者可以通过某种方式绕过这些验证。

**有效性评估：**
从搜索引擎结果来看，多个安全厂商都对此漏洞进行了分析，确认其存在且危害较高。漏洞库信息也提供了受影响的版本范围。提供的代码包含三个 Python 脚本和一个域名列表。其中 `main.py` 用于检测目标网站是否基于 Next.js 构建。`sites-parser.py` 是一个用于从 Google 搜索结果中提取域名列表的爬虫脚本。`sites.txt` 包含一个域名列表，用于给 `main.py` 进行测试。这些脚本本身并没有直接利用漏洞，而是用于发现潜在的受害者，因此提供的代码本身**不直接是POC**，它只是辅助发现目标。

要完全验证该漏洞，需要构造特定的 HTTP 请求，通常涉及操纵 `x-middleware-subrequest` 头部，才能绕过中间件的权限检查。根据已有的信息，验证 POC 有效需要一个存在漏洞的 Next.js 应用，根据该漏洞的特性构造 payload.

**投毒风险：**
提供的 Python 脚本和域名列表本身不包含恶意代码，没有发现任何可疑的后门或者恶意行为。`sites-parser.py` 的目的是从 Google 搜索结果中提取域名，这本身是一个常见的网络爬虫行为。`main.py` 只是检查目标是否使用了 Next.js。因此，可以认为此代码**不存在投毒风险**。

**利用方式：**
1.  攻击者首先需要找到一个使用受影响版本 Next.js 的应用，并且该应用使用了中间件进行权限验证。
2.  利用`x-middleware-subrequest`头部，来绕过中间件的权限验证
3.  通过发送精心构造的包含 `x-middleware-subrequest` 头部或其他相关头部信息的 HTTP 请求，绕过中间件的授权检查，从而访问受保护的资源或执行未授权的操作。
4.  由于该漏洞是权限绕过，利用成功后，攻击者可以以未授权用户的身份执行操作，例如访问管理员页面、查看敏感数据等。

**项目地址:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)