## CVE-2024-13869-WPvivid-Arbitrary File Upload

**漏洞编号:** CVE-2024-13869

**漏洞类型:** 任意文件上传

**影响应用:** WPvivid Backup & Migration

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.9.112

**利用条件:** 需要管理员或以上级别权限的已认证用户，目标服务器运行NGINX

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-13869是WPvivid Backup & Migration插件中的一个任意文件上传漏洞。该漏洞允许经过身份验证的管理员或以上级别的用户上传任意文件，由于缺少文件类型验证。上传的文件保存在`/wp-content/wpvividbackups/`目录下。该漏洞的利用方式如下：

1.  **身份验证：** 使用管理员或以上级别的用户名和密码登录WordPress后台。
2.  **获取Nonce：** 访问WPvivid插件的设置页面，从HTML源代码中提取`ajax_nonce`值。该Nonce用于绕过CSRF保护。
3.  **上传Web Shell：** 使用`multipart/form-data`格式构造HTTP POST请求，将包含恶意代码（例如PHP Web Shell）的文件上传到服务器。需要设置正确的`Content-Disposition`、`name`、`filename`和`Content-Type`头。`action`参数设置为`wpvivid_upload_files`。
4.  **执行恶意代码：** 成功上传后，可以通过访问上传的文件（例如`victim_url/wp-content/wpvividbackups/hack.php?cmd=恶意命令`）来执行任意代码。

**有效性评估：**
根据漏洞信息和POC代码，该漏洞利用的有效性较高。POC代码演示了如何利用管理员凭据登录，获取nonce，并上传包含Web shell的恶意文件。搜索结果也证实了该漏洞的存在和影响。

**投毒风险评估：**
分析POC代码后，没有发现作者隐藏的恶意代码或后门。该POC代码主要用于演示漏洞利用过程，包含一个简单的webshell，方便用户进行测试，并不会主动对目标造成其它危害。因此，仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式总结：**
攻击者需要具备管理员或以上级别的WordPress账户。利用方式主要是通过构造特定的HTTP请求绕过文件类型验证，上传包含恶意代码的Web Shell，并最终通过访问Web Shell来执行任意命令，从而控制服务器。注意，此漏洞主要影响使用NGINX Web服务器的WordPress实例。

**项目地址:** [d0n601/CVE-2024-13869](https://github.com/d0n601/CVE-2024-13869)

**漏洞详情:** [CVE-2024-13869](https://nvd.nist.gov/vuln/detail/CVE-2024-13869)