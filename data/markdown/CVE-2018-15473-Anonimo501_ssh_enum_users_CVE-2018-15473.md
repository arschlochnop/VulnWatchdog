## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)