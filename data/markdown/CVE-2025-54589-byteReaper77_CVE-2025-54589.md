## CVE-2025-54589 - copyparty Reflected XSS via Filter Parameter

**漏洞编号:** CVE-2025-54589

**漏洞类型:** Reflected XSS

**影响应用:** copyparty

**危害等级:** 中危，CVSS 6.3，可能导致敏感信息泄露、用户会话劫持、恶意脚本执行等

**影响版本:** < 1.18.7

**利用条件:** 需要用户访问包含恶意filter参数的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54589是一个存在于Copyparty 1.18.6及更早版本中的反射型跨站脚本（XSS）漏洞。攻击者可以利用`filter`参数，通过构造包含恶意JavaScript代码的URL，当用户访问此URL时，恶意代码将在用户的浏览器中执行。

**有效性：**
提供的PoC代码旨在利用此漏洞。代码包含一个C语言编写的exploit程序，该程序通过向目标Copyparty服务器发送包含XSS payload的请求来验证漏洞是否存在。如果服务器返回的响应中包含未经转义的payload，则表示漏洞存在。

**投毒风险：**
PoC代码主要用于检测XSS漏洞，但存在轻微的投毒风险。虽然代码本身的功能是发送payload并检测响应，但恶意攻击者可能在编译后的二进制文件中插入额外的恶意代码。例如，攻击者可以修改`write_cb`函数，在接收到服务器响应后执行额外的操作，比如向其他服务器发送请求、记录用户信息等。通过快速浏览代码，没有发现明显的直接投毒代码，例如预设后门或者直接执行系统命令。投毒风险较低，估计为10%。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，并将恶意代码作为`filter`参数的值。例如：`/?ru&filter=<script>alert('XSS')</script>`。
2.  攻击者诱导受害者点击此URL（例如通过电子邮件、社交媒体等）。
3.  当受害者访问此URL时，Copyparty服务器会将包含恶意JavaScript代码的`filter`参数值插入到HTML响应中，而没有进行适当的转义。
4.  受害者的浏览器解析HTML响应并执行其中的恶意JavaScript代码。
5.  恶意JavaScript代码可以执行各种恶意操作，例如：
    *   窃取用户的Cookie信息，从而劫持用户的会话。
    *   将用户重定向到恶意网站。
    *   在用户的浏览器中执行任意JavaScript代码，从而控制用户的浏览器。
    *   篡改网页内容。

**缓解措施：**
*   升级到Copyparty 1.18.7或更高版本。
*   对用户输入进行严格的验证和转义。
*   实施内容安全策略（CSP）。

**项目地址:** [byteReaper77/CVE-2025-54589](https://github.com/byteReaper77/CVE-2025-54589)

**漏洞详情:** [CVE-2025-54589](https://nvd.nist.gov/vuln/detail/CVE-2025-54589)