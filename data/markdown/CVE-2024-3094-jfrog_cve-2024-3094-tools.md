## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和潜在的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是一个在XZ Utils压缩库中发现的供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码嵌入到liblzma库的构建过程中，该恶意代码能够修改SSH守护进程sshd的行为，允许未经授权的远程访问。

**有效性：**

提供的POC代码（cve-2024-3094-detector.sh）本身**不是**漏洞利用代码，而是用于**检测系统是否受到CVE-2024-3094影响的工具**。它通过检查XZ Utils的版本以及sshd是否链接到liblzma来判断系统是否易受攻击。真正的漏洞利用发生在恶意代码修改后的liblzma被sshd使用时。

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响严重。

**投毒风险：**

提供的代码仓库（jfrog/cve-2024-3094-tools）的目的是提供检测工具，帮助用户识别潜在的风险。代码本身**没有发现任何投毒代码**。提供的检测脚本只是检查是否存在恶意版本的`xz`或`liblzma`，以及SSH是否链接到`liblzma`。因此，可以认为该仓库中不存在作者隐藏的投毒代码。

**利用方式：**

1.  **供应链投毒：** 攻击者首先需要将恶意代码注入到XZ Utils的源代码中，并将其传播到受影响的系统上。
2.  **恶意代码激活：** 当受影响的系统在构建XZ Utils时，恶意代码会被激活，修改liblzma库。
3.  **SSH后门植入：** 修改后的liblzma库会被sshd链接，导致sshd的行为被篡改。
4.  **远程访问：** 攻击者可以通过特定的SSH连接，利用后门绕过身份验证，获得对系统的远程访问权限。

总而言之，该漏洞的利用涉及到复杂的供应链攻击和代码混淆技术，需要攻击者具备较高的技术水平。

**项目地址:** [jfrog/cve-2024-3094-tools](https://github.com/jfrog/cve-2024-3094-tools)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)