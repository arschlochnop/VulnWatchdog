## CVE-2023-1545-Teampass-SQL注入

**漏洞编号:** CVE-2023-1545

**漏洞类型:** SQL注入

**影响应用:** Teampass

**危害等级:** 高危，可能导致数据泄露

**影响版本:** < 3.0.0.23

**利用条件:** Teampass的API功能需要启用，且目标存在未修复漏洞的Teampass实例。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-1545是Teampass版本低于3.0.0.23中存在的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用/api/index.php/authorize接口绕过身份验证或提取敏感数据。从提供的POC代码来看，利用方式为：

1.  **检查API可用性：** 首先验证Teampass实例的API功能是否启用。
2.  **SQL注入：** 构造包含SQL注入的JSON payload，其中`login`字段被注入恶意SQL代码。代码使用了`UNION SELECT`语句将攻击者构造的SQL查询结果附加到原始查询结果中，绕过身份验证。
3.  **发送请求：** 使用POST请求将包含恶意payload的JSON数据发送到`/api/index.php/authorize`接口。
4.  **提取信息：** 如果注入成功，服务器会返回一个JWT token，POC代码会解析JWT token中的payload部分，提取`public_key`字段的内容，即SQL注入查询的结果。该POC代码通过注入SQL语句获取用户名和密码信息。

**有效性：** 提供的POC代码看起来是有效的。因为它模拟了利用CVE-2023-1545漏洞的步骤，包括构造恶意SQL语句，发送API请求和解析响应。

**投毒风险：** 提供的POC代码中没有发现明显的投毒代码。代码主要功能是利用SQL注入漏洞读取数据库信息。因此，投毒风险评估为0%。

**项目地址:** [sternstundes/CVE-2023-1545-POC-python](https://github.com/sternstundes/CVE-2023-1545-POC-python)

**漏洞详情:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)