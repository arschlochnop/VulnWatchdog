## CVE-2021-30180-Apache Dubbo-RCE

**漏洞编号:** CVE-2021-30180

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Dubbo

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 2.7.9

**利用条件:** 需要目标系统使用Apache Dubbo且开启Tag路由功能，攻击者需要能够影响Dubbo消费者的配置，例如通过修改注册中心数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-30180 漏洞是 Apache Dubbo 在处理 Tag 路由规则时，由于 YAML 反序列化不安全导致的远程代码执行漏洞。攻击者可以构造恶意的 YAML 格式的路由规则，当 Dubbo 消费者解析这些规则时，会执行攻击者预设的恶意代码。 

**有效性:** 根据漏洞信息和搜索结果，该漏洞利用是有效的，因为 Dubbo 2.7.9 之前的版本存在不安全的 YAML 反序列化。 

**投毒风险:** 提供的代码是 `CHANGES.md`，是 Dubbo 的版本更新日志，不包含任何可疑的或恶意的代码。因此，投毒风险为 0%。

**利用方式:**

1.  **利用点:** Dubbo 的 Tag 路由功能，允许用户自定义路由规则。
2.  **漏洞原理:** Dubbo 在解析 YAML 格式的路由规则时，使用了不安全的 YAML 反序列化方式，允许调用任意构造器。
3.  **攻击步骤:**
    *   攻击者构造包含恶意代码的 YAML 路由规则。
    *   攻击者将恶意的路由规则注入到 Dubbo 消费者可以访问的注册中心（如 ZooKeeper, Nacos等）。
    *   Dubbo 消费者从注册中心获取路由规则并解析，触发不安全的 YAML 反序列化，执行攻击者预设的代码。
4. **修复方式：** 升级到 Apache Dubbo 2.7.9 或更高版本，该版本修复了不安全的 YAML 反序列化问题。

**项目地址:** [shoucheng3/apache__dubbo_CVE-2021-30180_2.7.9](https://github.com/shoucheng3/apache__dubbo_CVE-2021-30180_2.7.9)

**漏洞详情:** [CVE-2021-30180](https://nvd.nist.gov/vuln/detail/CVE-2021-30180)