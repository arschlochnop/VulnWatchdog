## CVE-2024-56249-WPMasterToolKit-任意文件上传

**漏洞编号:** CVE-2024-56249

**漏洞类型:** 任意文件上传

**影响应用:** WPMasterToolKit WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.13.1

**利用条件:** 需要具有WordPress管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-56249 存在于 WPMasterToolKit WordPress 插件 1.13.1 及更早版本中，是一个任意文件上传漏洞。攻击者利用此漏洞，可以通过上传恶意文件（如 Web Shell）到服务器，从而执行任意代码。

**有效性评估：**
根据漏洞信息和漏洞利用代码，该漏洞利用是有效的。漏洞利用代码首先探测目标是否存在漏洞版本的插件，然后尝试使用提供的管理员凭据登录 WordPress 后台，如果登录成功，则提取上传文件所需的安全令牌（nonce 和 token），最后上传指定文件到指定路径。通过最终检测上传文件的URL，判断是否利用成功。

**投毒风险分析：**
该漏洞利用代码主要功能是验证和利用漏洞。风险点在于，脚本在未做任何验证的情况下直接读取`-fn`传入的文件，这可能导致攻击者误用该脚本，上传一些本不应该被上传的文件，如包含敏感信息的配置文件。另外，脚本在上传文件时，直接使用`text/plain`作为Content-Type，如果攻击者上传的是PHP脚本，可能需要修改Content-Type为`application/x-httpd-php`才能成功执行。总的来说，存在一定的投毒风险，约为10%。

**利用方式：**
1.  **漏洞探测：** 利用代码首先尝试访问插件的 README.txt 文件，并从中提取插件版本号，确认目标是否受漏洞影响。
2.  **身份验证绕过/管理员权限利用：**  攻击者需要提供 WordPress 管理员的用户名和密码，脚本尝试登录 WordPress 后台。
3.  **提取安全令牌：** 登录成功后，脚本访问插件的特定页面，提取上传文件所需的 nonce 和 token。
4.  **文件上传：**  脚本构造一个包含文件内容的 POST 请求，将文件上传到服务器上的指定目录。
5.  **验证：** 上传完成后，脚本尝试访问上传的文件，以验证上传是否成功。如果文件可以访问，则表明漏洞利用成功。

**项目地址:** [Nxploited/CVE-2024-56249](https://github.com/Nxploited/CVE-2024-56249)

**漏洞详情:** [CVE-2024-56249](https://nvd.nist.gov/vuln/detail/CVE-2024-56249)