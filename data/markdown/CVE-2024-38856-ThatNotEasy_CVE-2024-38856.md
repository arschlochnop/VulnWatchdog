## CVE-2024-38856-Apache OFBiz-未授权访问导致RCE

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 目标服务器开放80/443端口，且存在未授权访问的ProgramExport接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache OFBiz存在未授权的`ProgramExport`端点，允许未经身份验证的用户执行屏幕渲染代码。利用方式是构造包含恶意Groovy代码的POST请求，并通过`groovyProgram`参数发送到易受攻击的端点。PoC通过base64编码和Unicode转义绕过可能的字符过滤，最终利用`bash -i`建立反向shell。PoC代码本身存在一定的风险，如果目标环境无法访问互联网，则无法建立反向shell。代码中的风险主要在于用户需要自己配置目标IP和端口，以及执行命令，存在潜在的恶意利用风险，因此投毒风险评级为10%。主要集中在可能通过修改payload执行恶意行为，而非直接的代码层面恶意逻辑。

**漏洞利用方式:**

1.  **确定目标:** 找到运行Apache OFBiz <= 18.12.14 的服务器。
2.  **构造Payload:** 使用PoC中的`commandEncoder`和`payloadUnicode`函数，将要执行的命令编码为Groovy payload。
3.  **发送请求:** 将构造好的payload作为`groovyProgram`参数，以POST请求的方式发送到以下任一端点：
    *   `webtools/control/forgotPassword/ProgramExport`
    *   `webtools/control/main/ProgramExport`
    *   `webtools/control/showDateTime/ProgramExport`
    *   `webtools/control/view/ProgramExport`
    *   `webtools/control/TestService/ProgramExport`
4.  **执行代码:** 如果目标服务器存在漏洞，则会执行payload中的Groovy代码，从而执行任意命令。

**项目地址:** [ThatNotEasy/CVE-2024-38856](https://github.com/ThatNotEasy/CVE-2024-38856)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)