## CVE-2022-0995 - Linux Kernel watch_queue OOB Write

**漏洞编号:** CVE-2022-0995

**漏洞类型:** 内存破坏/Out-of-bounds Write

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致提权或拒绝服务

**影响版本:** kernel 5.17 rc8

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0995 是 Linux 内核 watch_queue 事件通知子系统中的一个越界写入漏洞。该漏洞允许本地用户通过精心构造的事件通知请求覆盖内核内存，从而可能导致权限提升或者拒绝服务。

**有效性：** 根据搜索结果（特别是`https://github.com/Bonfee/CVE-2022-0995`），已经存在公开可用的利用代码，但可靠性可能不是100%，需要多次尝试。漏洞库信息也证实了该漏洞的存在和影响。

**投毒风险：** 提供的POC代码只包含一个README.md文件，没有任何可执行代码。因此，直接的投毒风险较低，但依然需要谨慎。假设该代码库后续提交了恶意代码，则存在投毒风险。根据当前信息，投毒的可能性较低，大约为10%，主要是考虑到未来代码更新的潜在风险。

**利用方式：**  利用方式是通过触发 watch_queue 子系统中的越界写入漏洞，覆盖内核内存。利用过程通常涉及以下步骤：

1.  构造特定的文件监视事件（watch events），触发 watch_queue 事件通知机制。
2.  利用越界写入漏洞，覆盖目标内核内存区域，例如覆盖用户权限信息，从而实现权限提升。
3.  或者，覆盖关键内核数据结构，导致系统崩溃，实现拒绝服务。

搜索结果中的网页 `https://www.wiz.io/vulnerability-database/cve/cve-2022-0995` 提供了关于该漏洞的更多背景信息，而`https://github.com/Bonfee/CVE-2022-0995` 提供了实际的利用代码示例。该漏洞需要本地用户权限才能利用。

**项目地址:** [A1b2rt/cve-2022-0995](https://github.com/A1b2rt/cve-2022-0995)

**漏洞详情:** [CVE-2022-0995](https://nvd.nist.gov/vuln/detail/CVE-2022-0995)