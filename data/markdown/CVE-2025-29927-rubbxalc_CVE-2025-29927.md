## CVE-2025-29927-Next.js-中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用Next.js中间件进行授权验证，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 存在于 Next.js 中间件中，由于对 `x-middleware-subrequest` 标头处理不当导致授权绕过。攻击者可以通过发送包含该标头的特制 HTTP 请求，绕过中间件的身份验证和授权检查，从而访问受保护的路由。

**漏洞利用方式：**

1.  **发送基线请求：** 首先，发送一个不带任何特殊标头的请求到目标路由，以确定是否存在中间件保护（通常表现为307重定向）。
2.  **发送包含 'x-middleware-subrequest' 标头的请求：** 如果基线请求重定向，则发送一个包含 `x-middleware-subrequest: middleware` 标头的相同请求。  如果漏洞存在，服务器将跳过中间件验证，并允许访问受保护的路由。

**有效性：**

根据漏洞描述、搜索结果和提供的 POC 代码，该漏洞利用是有效的。  POC 代码的 `exploit.py` 脚本首先发送一个基线请求来检测重定向，然后尝试使用 `x-middleware-subrequest` 标头绕过中间件。

**投毒风险：**

提供的代码主要功能是利用漏洞，并未发现明显的恶意代码。`requirements.txt` 文件中只包含了常用的 `requests`、`colorama` 和 `beautifulsoup4` 库，没有可疑的依赖项。不过，任何代码都存在潜在的风险，因此，投毒风险评估为 5%，主要是因为代码来源的信任度以及作者可能会在未来版本中引入恶意代码的可能性。

**总结：**

该漏洞是一个严重的安全问题，可能导致未经授权的访问。提供的 POC 代码可以用来验证漏洞是否存在。建议受影响的 Next.js 应用升级到安全版本，或者采取缓解措施，例如阻止包含 `x-middleware-subrequest` 标头的外部请求。

**项目地址:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)