## CVE-2025-4380 - Ads Pro Plugin <= 4.89 - Unauthenticated Local File Inclusion

**漏洞编号:** CVE-2025-4380

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Ads Pro Plugin - Multi-Purpose WordPress Advertising Manager

**危害等级:** 高危，可导致敏感信息泄露和任意代码执行

**影响版本:** <= 4.89

**利用条件:** 目标WordPress站点安装了受影响版本的Ads Pro插件，且插件未进行安全加固。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4380 存在于 Ads Pro Plugin <= 4.89 版本中。未经身份验证的攻击者可以通过 `bsa_preview_callback` 函数的 `bsa_template` 参数进行本地文件包含。通过构造包含目录遍历的恶意请求，攻击者可以读取服务器上的任意文件，例如 `/etc/passwd` 和 `wp-config.php`。如果站点存在可上传的.php文件或者已存在恶意.php文件，则可能进一步导致远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码提供了一个Python脚本，可以利用该漏洞读取任意文件。搜索引擎结果中也包含了对该漏洞的描述和利用分析，进一步证实了其有效性。

**投毒风险：**

检查PoC代码 `cve_2025_4380.py` 后，未发现明显的恶意代码或后门。该脚本的主要功能是发送包含恶意 `bsa_template` 参数的HTTP POST请求，并打印服务器的响应内容。代码相对简单，功能明确。但是考虑到作者声明的用途是`authorized security testing only`，以及网络安全工具本身存在的风险，将投毒风险设为1%。

**利用方式：**

1.  **确定目标：** 确定目标WordPress站点的URL，并确认其安装了受影响版本的Ads Pro插件。
2.  **构造恶意请求：** 使用PoC代码或手动构造包含恶意`bsa_template`参数的HTTP POST请求。`bsa_template`参数的值应为要读取的文件路径，例如`../../../../etc/passwd`。
3.  **发送请求：** 将构造的请求发送到`/wp-admin/admin-ajax.php` endpoint。
4.  **获取文件内容：** 如果漏洞利用成功，服务器将返回请求的文件内容。攻击者可以分析返回的内容，获取敏感信息或进一步利用。

**缓解措施：**
*   升级Ads Pro插件到不受影响的版本。
*   限制Web服务器对敏感文件的访问权限。
*   使用Web应用程序防火墙（WAF）检测和阻止LFI攻击。

**项目地址:** [r0otk3r/CVE-2025-4380](https://github.com/r0otk3r/CVE-2025-4380)

**漏洞详情:** [CVE-2025-4380](https://nvd.nist.gov/vuln/detail/CVE-2025-4380)