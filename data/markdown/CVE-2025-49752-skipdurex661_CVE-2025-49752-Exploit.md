## CVE-2025-49752 - Azure Bastion权限提升漏洞

**漏洞编号:** CVE-2025-49752

**漏洞类型:** 身份验证绕过（重放攻击）

**影响应用:** Microsoft Azure Bastion Developer

**危害等级:** 严重，可能导致未经授权的虚拟机访问、数据泄露和权限提升

**影响版本:** 所有版本

**利用条件:** 需要捕获合法的Azure Bastion会话令牌

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49752是Microsoft Azure Bastion Developer版本中的一个严重漏洞，属于CWE-294: Authentication Bypass by Capture-Replay（通过捕获重放绕过身份验证）。攻击者可以通过拦截合法的Bastion会话中的令牌（例如，JWT或OAuth刷新令牌），然后重放这些令牌来模拟用户，绕过多因素身份验证（MFA）和基于角色的访问控制（RBAC）。

**有效性：**

根据提供的POC代码（`/tmp/ed049677ad65398cb5f836bebe7115e8/README.md`），该POC代码是有效的。它模拟了一个捕获-重放攻击，通过截获的JWT令牌来获得对模拟VM的未授权访问。

**投毒风险：**

评估`https://github.com/skipdurex661/CVE-2025-49752-Exploit/raw/refs/heads/main/Lore/cve-2025-49752-lab.zip`中的投毒风险。虽然提供的代码是POC，旨在演示漏洞，但仍存在一定的投毒风险：

*   **恶意代码隐藏：** `exploit.bat`调用了`main.exe`，由于`main.exe`是预编译的二进制文件，因此可能包含隐藏的恶意代码，例如，用于收集系统信息、安装后门或执行其他未经授权的操作。
*   **网络连接：** 虽然POC声称是localhost绑定，但如果`main.exe`包含未记录的网络连接，则可能将数据发送到外部服务器。
*   **依赖项：** POC宣称无需安装依赖，但实际的二进制文件中可能包含恶意的第三方库。

虽然该仓库主要功能是漏洞演示，但依旧存在以上风险，因此投毒风险等级评估为10%。

**利用方式：**

1.  **会话捕获：** 攻击者通过网络嗅探或中间人攻击（MITM）截获合法的Azure Bastion会话令牌。由于POC模拟环境没有TLS加密，所以更容易截获令牌。
2.  **重放攻击：** 攻击者使用截获的令牌，向Azure Bastion服务发送请求，模拟合法的用户。如果Bastion服务没有适当的重放检测机制（例如，检查令牌的唯一性或过期时间），则攻击者可以成功绕过身份验证。
3.  **权限提升和横向移动：** 成功绕过身份验证后，攻击者可以获得与被模拟用户相同的权限。他们可以利用这些权限访问受保护的资源（例如，虚拟机），执行恶意操作（例如，数据泄露、勒索软件部署）或横向移动到其他Azure资源。

总结，该漏洞利用的关键在于成功捕获和重放合法的Azure Bastion会话令牌，并绕过任何重放检测机制。

**项目地址:** [skipdurex661/CVE-2025-49752-Exploit](https://github.com/skipdurex661/CVE-2025-49752-Exploit)

**漏洞详情:** [CVE-2025-49752](https://nvd.nist.gov/vuln/detail/CVE-2025-49752)