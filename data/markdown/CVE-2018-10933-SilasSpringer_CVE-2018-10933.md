## CVE-2018-10933 - libssh Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** Authentication Bypass

**影响应用:** libssh

**危害等级:** 高危，未经授权的远程访问

**影响版本:** 0.6 - 0.7.6, 0.8 - 0.8.4

**利用条件:** 目标系统运行受影响的libssh版本，并且开放SSH端口(通常是22)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-10933 漏洞存在于libssh服务器端的状态机中，允许未经身份验证的客户端通过发送特制的SSH2_MSG_USERAUTH_SUCCESS消息来绕过身份验证过程。攻击者可以创建通道而无需先进行身份验证，从而获得未经授权的访问权限。

**利用方式：**
1.  攻击者连接到目标服务器的SSH端口。
2.  攻击者发送一个SSH2_MSG_USERAUTH_SUCCESS消息，而不是执行正常的SSH身份验证过程。
3.  如果服务器的libssh版本存在漏洞，它将错误地接受此消息，并允许攻击者创建一个未经身份验证的会话。
4.  攻击者可以使用此会话执行任意命令或访问敏感数据，具体取决于服务器的配置。

**有效性：**
提供的Dockerfile和Python脚本`libsshauthbypass.py`提供了一个可用的POC。Dockerfile构建了一个易受攻击的libssh环境（0.8.1），而`libsshauthbypass.py`脚本实现了身份验证绕过漏洞。 `README.md`文件描述了如何使用该POC进行利用。

**投毒风险：**
虽然提供的代码主要用于演示漏洞，但仍存在轻微的投毒风险。以下是一些需要考虑的因素：
* **build_run.sh:** 此脚本用于构建和运行Docker容器。 脚本内容为构建docker镜像后,运行run.sh, 没有发现明显恶意代码. 风险极低.
* **libsshauthbypass.py:** 该脚本本身是利用libssh漏洞，但如果被恶意修改，例如在执行命令之前或之后添加恶意代码，可能会对目标系统造成进一步的损害。目前脚本中没有发现隐藏的恶意代码.
* **Dockerfile:** Dockerfile下载了`vulhub/libssh:0.8.1`镜像作为基础镜像。存在基础镜像本身存在后门的潜在风险，但这不是此仓库作者的投毒行为。
* **flag.txt:** 包含一个CTF标志。在真实世界的攻击中，这可能被替换为恶意负载或用于隐藏攻击意图。此文件不是投毒行为。

总体而言，代码库的投毒风险较低（估计约为5%）。风险主要集中在以下几个方面：1）恶意修改`libsshauthbypass.py`脚本；2）基础Docker镜像`vulhub/libssh:0.8.1`本身可能存在后门；3）攻击者可能将`flag.txt`替换为恶意文件，用于迷惑安全分析师或隐藏攻击意图。但是，这些风险可以通过代码审查和使用受信任的Docker镜像来降低。

**项目地址:** [SilasSpringer/CVE-2018-10933](https://github.com/SilasSpringer/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)