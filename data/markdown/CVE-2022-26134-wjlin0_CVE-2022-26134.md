## CVE-2022-26134 - Atlassian Confluence OGNL 注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 存在于 Atlassian Confluence Server 和 Data Center 中，是一个未经身份验证的远程代码执行漏洞。攻击者通过构造恶意的 OGNL 表达式，可以在 Confluence Server 或 Data Center 实例上执行任意代码。

**利用方式：**

1.  攻击者发送包含恶意 OGNL 表达式的 HTTP 请求到存在漏洞的 Confluence 实例。
2.  Confluence 实例解析并执行该 OGNL 表达式。
3.  攻击者从而可以在服务器上执行任意代码。

提供的Go语言POC代码，首先检查目标URL是否存在漏洞，通过发送包含OGNL表达式的HTTP GET请求，判断响应头中是否存在`X-Cmd-Response`字段，并且状态码为302。如果存在，则证明目标存在漏洞。然后，POC代码允许用户输入命令，并将其嵌入到 OGNL 表达式中，再次发送到目标服务器执行，并将结果输出。

**投毒风险分析：**

代码主要功能是发送HTTP请求，然后获取返回包头中的X-Cmd-Response内容，以及利用状态码判断漏洞是否存在。通读代码，没有发现明显的恶意行为，例如植入后门、收集用户信息等。但是，存在极小的风险，例如作者可能通过精心构造的命令，在目标服务器上执行恶意操作。因此，投毒风险估计为5%。

**项目地址:** [wjlin0/CVE-2022-26134](https://github.com/wjlin0/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)