## CVE-2019-10219 - Hibernate-Validator SafeHtml XSS

**漏洞编号:** CVE-2019-10219

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** Hibernate-Validator

**危害等级:** 中危，可能导致用户信息泄露或恶意脚本执行

**影响版本:** 6.0.0.Alpha1 <= version <= 6.0.17.Final, 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**利用条件:** 需要应用程序使用Hibernate-Validator的SafeHtml验证器，并且用户可控的输入会经过此验证器并最终在Web页面上显示。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-10219 存在于 Hibernate-Validator 中，具体来说是 SafeHtml 验证器未能正确清理包含恶意代码的 HTML 注释和指令。这允许攻击者注入恶意脚本，导致 XSS 攻击。

**有效性：**
根据漏洞库信息，搜索引擎结果，以及存在的PoC代码（链接：https://github.com/poc-effectiveness/PoCAdaptation/tree/main/Adapted/CVE-2019-10219 和 https://github.com/poc-effectiveness/PoCAdaptation/tree/main/Origin/CVE-2019-10219/exploit），可以判断此漏洞利用是有效的。

**投毒风险：**
提供的代码片段主要是Hibernate Validator的贡献指南和README文件，看起来不像是恶意代码。虽不排除仓库其他部分存在恶意代码的可能性，但仅凭当前信息判断，投毒风险较低，约为5%。需进一步审查整个仓库以确定。

**利用方式：**
攻击者可以构造包含恶意 HTML 注释或指令的输入，绕过 SafeHtml 验证器的清理，将恶意脚本注入到 Web 页面中。当用户访问包含此恶意脚本的页面时，脚本将在用户的浏览器中执行，可能导致 cookie 窃取、会话劫持或页面重定向等攻击。

**项目地址:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final)

**漏洞详情:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)