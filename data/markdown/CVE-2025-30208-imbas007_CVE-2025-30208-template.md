## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** 需要Vite开发服务器显式暴露给网络 (使用 `--host` 或 `server.host` 配置项)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30208 是 Vite 开发服务器中的一个任意文件读取漏洞。该漏洞源于 Vite 未正确处理包含 `?raw??` 或 `?import&raw??` 的 URL。攻击者可以通过构造包含这些参数的 URL 来绕过 `server.fs.deny` 限制，读取服务器上的任意文件内容。

**有效性分析：**
提供的 Nuclei 模板利用了 `?raw` 查询参数绕过文件系统访问限制。通过发送包含恶意路径的 GET 请求，例如 `{{BaseURL}}/etc/passwd?raw`，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。模板中的 matcher 使用 `root:x:0:0:` 和 `/bin/bash` 关键字验证响应是否包含预期内容，这表明 POC 代码有效。

**投毒风险分析：**
分析了提供的三个文件：`CVE-2025-30208.yaml` (Nuclei 模板), `README.md` 和目录名。Nuclei 模板旨在检测漏洞，而不是利用漏洞植入后门。`README.md` 文件包含有关如何运行模板和搜索易受攻击实例的信息，未发现任何可疑代码。目录名 `/tmp/5605a217bfb06e95f925e00085e50ead/` 是一个临时目录，看起来是随机生成的，这降低了投毒的可能性。因此，可以判定投毒风险为 0%。

**利用方式：**
1.  Vite 开发服务器必须显式暴露给网络 (使用 `--host` 或 `server.host` 配置项)。
2.  攻击者构造包含 `?raw` 或 `?import&raw` 的恶意 URL，例如 `/etc/passwd?raw`，并将其发送到易受攻击的 Vite 开发服务器。
3.  Vite 服务器在未经适当验证的情况下处理该请求，并返回指定文件的内容。
4.  攻击者可以利用此漏洞读取服务器上的敏感文件，例如配置文件、源代码等。

**项目地址:** [imbas007/CVE-2025-30208-template](https://github.com/imbas007/CVE-2025-30208-template)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)