## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致数据库访问、数据泄露和远程代码执行

**影响版本:** 受影响版本：2021.0.6 (13.0.6)之前, 2021.1.4 (13.1.4)之前, 2022.0.4 (14.0.4)之前, 2022.1.5 (14.1.5)之前, and 2023.0.1 (15.0.1)之前的所有版本（包括2020.0和2019x以及更早的未支持版本）

**利用条件:** 需要网络访问MOVEit Transfer的web应用程序

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362 是 MOVEit Transfer 中的一个 SQL 注入漏洞，未经身份验证的攻击者可以通过该漏洞访问 MOVEit Transfer 的数据库。 根据使用的数据库引擎（MySQL、Microsoft SQL Server 或 Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行 SQL 语句来更改或删除数据库元素。该漏洞在野外被积极利用。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者利用SQL注入漏洞，向MOVEit Transfer Web应用程序发送特制的SQL查询，绕过身份验证并获得数据库访问权限。
2.  **信息泄露和数据库操作：** 成功利用SQL注入后，攻击者可以读取数据库内容、修改数据、甚至执行任意SQL命令。
3.  **远程代码执行：**  通过执行SQL语句，攻击者可能能够执行系统命令，从而实现远程代码执行。

**POC有效性：**

提供的POC代码看起来是有效的。它利用HTTParty库发送请求，并精心构造了带有SQL注入的Header，结合session变量设置绕过验证。代码目标明确，结构清晰，验证了未授权的RCE利用链。

**投毒风险：**

代码中存在轻微的投毒风险的可能性，但主要集中在以下几个方面：

*   **依赖项：** 代码依赖于httparty和openssl等ruby库。如果这些库本身被投毒，可能会影响漏洞利用的安全性。但这不是POC本身的问题。
*   **目标IP：**  POC代码中定义了TARGET常量，攻击者可能会修改此值，如果未经授权扫描或攻击目标，可能导致法律问题。
*   **远程代码执行的payload：** 目前，exp中硬编码的payload为启动`notepad.exe`，攻击者可以修改此payload以执行其他恶意操作。但这取决于使用exp的人。

风险评估：5%。 此百分比很低，因为代码本身主要关注于利用，而不是分发恶意软件或执行后门操作。主要风险在于使用者对payload的修改和目标的选择，与代码本身关系不大。

**项目地址:** [sfewer-r7/CVE-2023-34362](https://github.com/sfewer-r7/CVE-2023-34362)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)