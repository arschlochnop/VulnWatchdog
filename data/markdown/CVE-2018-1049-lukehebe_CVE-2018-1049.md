## CVE-2018-1049-Systemd-DoS

**漏洞编号:** CVE-2018-1049

**漏洞类型:** 竞争条件导致拒绝服务

**影响应用:** systemd

**危害等级:** 中危，导致拒绝服务，系统挂起

**影响版本:** prior to 234

**利用条件:** 需要目标系统运行存在漏洞版本的systemd，并且存在竞争条件触发的机会

**POC 可用性:** 否 (提供的代码利用了不同的漏洞)

**投毒风险:** 0%

## 详情

CVE-2018-1049描述了systemd 234之前版本中.mount和.automount单元之间的竞争条件。当内核的automount请求没有被systemd及时处理时，可能导致内核持有挂载点，进而导致尝试使用该挂载点的进程挂起，最终造成拒绝服务。

提供的Python脚本 `vyos_exp.py` 实际上是针对VyOS (Vyatta) 的权限提升漏洞的利用，不是直接利用CVE-2018-1049。它通过SSH连接到目标设备，尝试进行shell突破，然后通过sudo执行一个Perl脚本 (`/opt/vyatta/bin/sudo-users/vyatta-show-lldp.pl`)，在`-i`参数中注入命令，从而获取root权限。

根据提供的漏洞信息，以及搜索结果，CVE-2018-1049本身是拒绝服务漏洞，不是权限提升。

由于提供的脚本利用的是VyOS的另一个漏洞，因此脚本本身并不能验证CVE-2018-1049的有效性。

**投毒风险分析:** 提供的Python脚本中并没有明显的投毒代码。该脚本的功能是连接到目标系统，然后执行一系列操作来利用VyOS的漏洞以获取root权限。脚本首先尝试进行shell突破，然后构造包含反向shell的payload，通过命令注入执行，从而获取对目标系统的控制权。代码功能明确，未发现隐藏的恶意行为。

**项目地址:** [lukehebe/CVE-2018-1049](https://github.com/lukehebe/CVE-2018-1049)

**漏洞详情:** [CVE-2018-1049](https://nvd.nist.gov/vuln/detail/CVE-2018-1049)