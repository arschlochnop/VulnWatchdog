## CVE-2019-9053-CMS Made Simple-时间盲注SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露，权限提升

**影响版本:** <= 2.2.9

**利用条件:** 需要目标存在News模块且可未授权访问，需要配置TIME变量来适应网络延迟

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053 存在于 CMS Made Simple 2.2.9 及更早版本的 News 模块中。攻击者可以通过构造恶意的 URL，利用 `m1_idlist` 参数实现未经身份验证的时间盲注 SQL 注入。

**有效性：**
提供的PoC代码（46635.py）看起来是有效的。它利用时间盲注来提取数据库信息，包括 salt、password 和 username。从搜索引擎结果来看，已经存在公开的PoC和利用方法，进一步证实了该漏洞的可利用性。

**投毒风险：**
PoC 代码存在一定投毒风险，大约 10%。风险主要来自于以下几个方面：
1.  **TIME 变量：**  PoC 代码需要用户手动设置 TIME 变量，该变量直接影响利用的成功率。如果 TIME 设置不当（过小），可能无法正确判断时间延迟，导致利用失败。
2.  **Wordlist 依赖：**  密码破解功能依赖于用户提供的 wordlist。如果 wordlist 不包含正确的密码，破解将失败。虽然这本身不是投毒，但会降低脚本的有效性，使使用者产生怀疑。
3.  **代码可读性：**  代码中存在一些不必要的变量和函数调用，可能使代码更难理解和审查，从而增加潜在风险。
4. **termcolor 库依赖:** 虽然termcolor库主要用于美化输出，但如果用户没有安装这个库，脚本会抛出异常并停止执行，可能给用户带来不便，降低用户的信任度。

虽然存在以上风险，但代码中没有发现明显的恶意代码（例如反弹 shell 或删除文件）。PoC 的主要目的是利用 SQL 注入漏洞，而不是执行恶意操作。

**利用方式：**
利用方式如下：
1.  **定位存在 News 模块的 CMS Made Simple 站点：**  目标站点必须运行存在漏洞的 CMS Made Simple 版本，并且启用 News 模块。
2.  **构造恶意 URL：**  攻击者构造包含恶意 SQL 语句的 URL，其中 SQL 语句被注入到 `m1_idlist` 参数中。该 SQL 语句利用 sleep() 函数造成时间延迟，根据响应时间来判断 SQL 语句的真假。
3.  **提取数据库信息：**  通过时间盲注，攻击者可以逐个字符地提取数据库中的敏感信息，例如用户名、密码哈希和 salt。
4.  **破解密码：**  如果攻击者获得了密码哈希和 salt，可以使用 wordlist 进行离线破解。

**总结：**
该漏洞利用较为复杂，需要一些 SQL 注入的基础知识和对目标站点的了解。虽然 PoC 代码的存在一定的投毒风险，但主要是由于代码质量和配置问题，而不是恶意的后门代码。攻击者利用该漏洞可以获取数据库中的敏感信息，从而控制整个网站。

**项目地址:** [n3rdh4x0r/CVE-2019-9053](https://github.com/n3rdh4x0r/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)