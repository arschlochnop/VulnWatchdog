## CVE-2025-30208-Vite-文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite开发服务器需要明确暴露在网络中（使用`--host`或`server.host`配置选项）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30208 存在于 Vite 的文件读取漏洞，攻击者可以通过构造包含 `?raw??` 或 `?import&raw??` 的特殊 URL 绕过 `server.fs.deny` 限制，读取服务器上的任意文件内容。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并且提供了受影响的版本范围。
*   搜索结果中多个来源（NVD, RedHat, Vulert, Tenable, OSV, Vulmon, Mitre, VulDB, Vumetric）都确认了该漏洞的存在，并给出了相应的描述。
*   漏洞利用代码提供了一个扫描器，用于自动检测 Vite 开发服务器是否存在该漏洞。该扫描器使用 FOFA API 收集目标，并尝试利用 `?raw??` 或 `?import&raw??` 构造的 URL 来读取文件。因此，根据这些信息，可以判断提供的POC代码是有效的。

**投毒风险分析：**

提供的代码包含以下文件：

*   LICENSE：MIT许可证
*   README-CN.md：中文说明文档
*   README.md：英文说明文档
*   main.py：漏洞扫描器主程序

`main.py` 的内容不完整，缺少关键代码，因此无法完整评估其行为。但根据现有的信息判断投毒风险，风险较低原因如下：

*   使用了常见的开源许可证(MIT)，相对较为规范。
*   代码结构比较清晰，主要功能是使用FOFA API获取目标，然后利用漏洞进行扫描，并生成CSV报告。
*   虽然`main.py`不完整，但从已有的代码片段可以看出，该扫描器的核心功能是发送 HTTP 请求来检查漏洞，没有发现明显的恶意代码或后门。
*   该工具需要用户提供 FOFA API 账号，这在一定程度上限制了恶意使用。

基于上述分析，投毒风险较低，约为5%。主要的风险可能在于 `main.py` 完整代码中可能存在未公开的恶意行为，但从现有信息无法判断。

**利用方式：**

1.  **目标确定：** 使用FOFA或其他资产搜索引擎收集暴露在公网上的Vite开发服务器。这些服务器通常监听特定的端口（例如3000、5173等）。
2.  **漏洞利用：** 构造包含 `?raw??` 或 `?import&raw??` 的特殊 URL。例如，要读取服务器上的 `/etc/passwd` 文件，可以尝试访问以下URL：
    *   `http://target:port/../../../../../../../../etc/passwd?raw??`
    *   `http://target:port/../../../../../../../../etc/passwd?import&raw??`
3.  **信息获取：** 如果目标服务器存在漏洞，并且允许访问 `/etc/passwd` 文件，则服务器将返回该文件的内容。
4.  **重复利用：** 攻击者可以重复上述步骤，读取其他敏感文件，例如 `.env` 文件、配置文件等，从而获取敏感信息。

**项目地址:** [xuemian168/CVE-2025-30208](https://github.com/xuemian168/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)