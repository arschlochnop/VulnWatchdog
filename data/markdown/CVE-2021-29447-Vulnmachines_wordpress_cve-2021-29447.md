## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要作者或具有上传权限的用户账号，WordPress运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-29447是WordPress的一个XXE（XML外部实体注入）漏洞，存在于5.6.0到5.7.1版本之间，且WordPress必须运行在PHP 8环境下。攻击者需要具备上传文件的权限（如作者角色），可以通过上传包含恶意XML代码的文件到媒体库来触发该漏洞，导致服务器上的敏感文件泄露，或者进行服务器端请求伪造(SSRF)。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC是存在的，并且已经公开。漏洞利用代码中给出了credits链接，参考motikan2010的github页面可以找到更多信息。

**投毒风险：**
该漏洞利用代码只有一个简单的README.md文件，其中包含漏洞描述和credit信息。 从提供的代码本身来看，不存在明显的恶意投毒代码。但是，考虑到攻击者可能将恶意payload嵌入到精心构造的媒体文件中，并诱导用户上传，从而实现攻击。因此，PoC仓库本身直接包含恶意代码的可能性较低，主要风险在于利用该漏洞的Payload本身。PoC仓库可能包含有诱导性的文件，例如看似无害的音频文件，但其中包含恶意的XML，因此存在一定的投毒风险，但是概率较低。

**利用方式：**
1.  攻击者需要一个具有上传文件权限的WordPress用户账号（例如，作者角色）。
2.  攻击者创建一个包含恶意XML代码的文件，例如一个包含XXE payload的MP3或者WAVE文件（参考packetstormsecurity上的相关链接）。
3.  攻击者通过WordPress的媒体库上传该恶意文件。
4.  当WordPress处理该文件时，XML解析器会尝试解析文件中的外部实体，从而导致XXE漏洞。
5.  攻击者可以利用该漏洞读取服务器上的任意文件，或者进行服务器端请求伪造攻击。

综上，此漏洞的PoC是有效的。 投毒风险较低，主要来自恶意构造的文件本身。 利用方式是上传包含恶意XML的媒体文件触发XXE。

**项目地址:** [Vulnmachines/wordpress_cve-2021-29447](https://github.com/Vulnmachines/wordpress_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)