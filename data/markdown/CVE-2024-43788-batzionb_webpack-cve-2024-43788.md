## CVE-2024-43788-Webpack-XSS

**漏洞编号:** CVE-2024-43788

**漏洞类型:** XSS (DOM Clobbering)

**影响应用:** Webpack

**危害等级:** 中危，可能导致用户凭据泄露或恶意脚本执行

**影响版本:** >= 5.0.0-alpha.0, < 5.94.0

**利用条件:** 需要网站使用受影响版本的Webpack，并允许用户注入带有特定属性的HTML标签

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43788是Webpack中AutoPublicPathRuntimeModule的一个DOM Clobbering漏洞，可能导致跨站脚本攻击(XSS)。

**有效性:**  根据漏洞库信息和搜索结果，此漏洞已经确认存在，并且有POC。

**利用方式:**
1.  攻击者需要在目标网站上注入一段特定的HTML代码，通常是不包含script标签的。 这些HTML元素(例如`<img>`)需要具有精心设计的`name`或`id`属性, 利用DOM Clobbering机制来覆盖Webpack生成的JavaScript代码中的变量。
2.  Webpack的AutoPublicPathRuntimeModule中存在一个gadget，该gadget使用被覆盖的变量。
3.  当Webpack生成的代码执行时，它会使用被恶意HTML代码覆盖的变量，从而导致执行攻击者控制的JavaScript代码，造成XSS。

**投毒风险:**
提供的`package-lock.json`文件本身不包含可直接执行的恶意代码，它只是一个依赖关系锁定的文件。 投毒风险较低，但仍然存在可能性，因为依赖包可能会被篡改。 例如, 攻击者可能会尝试通过篡改 `webpack` 或 `webpack-cli` 等依赖包来引入恶意代码。检查依赖项的来源和完整性是发现潜在投毒行为的关键。 因此，我们认为投毒风险约为10%。

**搜索引擎结果分析:**
搜索结果确认了CVE-2024-43788的存在和XSS漏洞。

**漏洞利用代码分析:**
漏洞利用代码（`package-lock.json`）定义了项目依赖，指定了`webpack`的版本是 `5.93.0`，符合受影响版本范围。 该文件也依赖了`express`, 可以推断出漏洞利用的测试需要搭建一个web服务器。 通过操纵HTML中的name/id属性来覆盖Webpack生成的全局变量`__webpack_public_path__`, 从而修改资源加载路径并执行恶意JS代码, 造成XSS。 该文件本身没有直接植入恶意代码， 但后续的利用流程需要仔细审查， 谨防被植入后门。

**项目地址:** [batzionb/webpack-cve-2024-43788](https://github.com/batzionb/webpack-cve-2024-43788)

**漏洞详情:** [CVE-2024-43788](https://nvd.nist.gov/vuln/detail/CVE-2024-43788)