## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, <= LTS 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口（HTTP/WebSocket/SSH）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，由于Jenkins CLI命令解析器中的args4j库存在缺陷，允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。攻击者可以通过在CLI参数中使用'@'字符后跟文件路径来触发该漏洞，Jenkins会将'@'符号后面的文件内容包含进参数里，从而读取文件内容。

**有效性：**
根据漏洞库信息、搜索引擎结果，该漏洞是真实存在的，并且已经有公开的利用代码。搜索结果中也提到了该漏洞可以通过HTTP, WebSocket和SSH进行利用。漏洞库信息中也明确了受影响的版本范围。

**投毒风险：**
提供的“漏洞利用代码”实际上是官方提供的缓解措施，用于禁用Jenkins CLI的HTTP端点和SSH端口，以防止漏洞被利用。 `disable-cli.groovy` 脚本用于禁用CLI HTTP端点，并且可以配置为在Jenkins启动时自动执行。所以，该仓库中不太可能存在投毒代码，存在概率极低。因为提供的代码是防御代码，虽然该仓库有可能被恶意修改，但是可能性极低，给出的投毒风险为10%。

**利用方式：**
1.  攻击者通过HTTP、WebSocket或SSH等方式访问Jenkins CLI接口。
2.  在CLI参数中，攻击者使用`@`符号后跟目标文件路径（例如，`@/etc/passwd`）。
3.  Jenkins解析CLI参数时，会将指定文件的内容读取并包含在参数中。
4.  攻击者通过CLI接口获取到目标文件的内容。

**项目地址:** [jenkinsci-cert/SECURITY-3314-3315](https://github.com/jenkinsci-cert/SECURITY-3314-3315)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)