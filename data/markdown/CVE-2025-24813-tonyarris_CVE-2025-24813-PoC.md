## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足以下条件：1. writes enabled for the default servlet (默认禁用); 2. 支持 partial PUT (默认启用); 3. 使用 Tomcat 的 file based session persistence 和默认存储位置; 4. 应用包含一个可能被用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 远程代码执行漏洞，利用了 Tomcat 处理部分 PUT 请求的方式。攻击者可以通过上传恶意构造的文件（利用 Ysoserial 生成反序列化 payload）到 Tomcat 服务器，然后通过 GET 请求触发反序列化，从而执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（Rapid7, GreyNoise, socprime 等）以及提供的 POC 代码，可以判断该漏洞是有效的，并且已经被观察到在野利用。POC 代码通过生成多种 Ysoserial payload 并尝试上传，增加了漏洞利用成功的概率。

**投毒风险分析：**

分析提供的 POC 代码，发现其主要功能是利用 ysoserial 生成反序列化 payload，然后通过 PUT 和 GET 请求触发漏洞。代码本身没有明显的恶意行为，例如向其他服务器发送信息或篡改本地文件。主要风险在于使用未经验证的第三方库（ysoserial），这本身可能存在安全风险，但是这是漏洞利用本身的一部分，而不是作者额外添加的恶意代码。

评估投毒风险较低，约为5%。

**利用方式：**

1.  **前提条件：** 目标 Tomcat 服务器需要满足特定配置条件，包括开启了 default servlet 的写入权限，支持 partial PUT，并且应用使用了 Tomcat 的文件会话持久化功能，且包含可被利用的反序列化库。
2.  **生成 Payload：** 使用 ysoserial 工具生成包含恶意命令的反序列化 payload。POC 代码支持批量生成不同 gadget chain 的 payload，提高成功率。
3.  **PUT 请求：** 通过 PUT 请求，将生成的 payload 分段上传到目标 Tomcat 服务器。利用 Content-Range 头部模拟 partial PUT 请求。
4.  **GET 请求：** 通过 GET 请求，触发 Tomcat 对上传文件的反序列化操作，从而执行恶意代码。
5.  **执行命令：** 成功利用漏洞后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [tonyarris/CVE-2025-24813-PoC](https://github.com/tonyarris/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)