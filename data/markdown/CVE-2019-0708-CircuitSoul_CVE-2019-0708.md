## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)