## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)