## CVE-2023-40028-Ghost-任意文件读取

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 5.59.1

**利用条件:** 需要Ghost后台高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40028是Ghost内容管理系统中的一个漏洞，允许经过身份验证的用户上传包含符号链接的文件，从而导致任意文件读取。攻击者利用此漏洞，可以读取服务器上的任意文件，可能泄露敏感信息，如配置文件、数据库凭据等。

**漏洞利用方式：**

1.  攻击者需要拥有Ghost后台的账户，并且具备上传文件的权限。
2.  攻击者构造一个包含指向目标文件的符号链接的zip文件。
3.  攻击者通过Ghost后台的文件上传功能上传该zip文件。
4.  Ghost解压zip文件，创建符号链接。
5.  攻击者通过访问该符号链接对应的URL，读取目标文件内容。

**代码分析：**

提供的POC脚本`CVE-2023-40028.sh` 实现了上述攻击流程：

*   脚本首先获取Ghost的URL，以及攻击所需的用户名和密码。
*   `generate_exploit`函数创建包含指向目标文件的符号链接的zip文件。
*   `send_exploit`函数将该zip文件上传到Ghost服务器。
*   脚本最后通过curl访问符号链接，读取目标文件内容。

**投毒风险分析：**

对提供的POC代码进行分析，发现以下潜在的风险点：

*   脚本中的`GHOST_URL`变量，如果被修改为攻击者控制的服务器，可能导致用户的用户名和密码泄露。
*   虽然脚本本身并没有明显的恶意代码，但下载和执行任何第三方脚本都存在风险。攻击者可能在脚本中加入恶意代码，例如植入后门、收集用户数据等。

综合来看，此仓库中存在作者隐藏的投毒代码的风险较低，判断投毒风险为10%。主要是脚本中存在变量可被替换，存在一定的钓鱼风险。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞利用的有效性较高。只要满足漏洞利用的条件（Ghost版本低于5.59.1，拥有高权限用户账户），攻击者就可以成功利用该漏洞读取服务器上的任意文件。

**项目地址:** [BBSynapse/CVE-2023-40028](https://github.com/BBSynapse/CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)