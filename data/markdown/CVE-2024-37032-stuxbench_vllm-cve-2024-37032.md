## CVE-2024-37032-Ollama-路径遍历

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件读取甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要能够向 Ollama 服务器发送请求，权限要求较低（低权限用户即可触发）

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2024-37032是Ollama中存在的一个路径遍历漏洞，具体原因是Ollama在处理模型路径时，没有充分验证digest的格式（预期为64位十六进制的sha256值）。这使得攻击者可以构造恶意的digest，包含例如"../"这样的路径遍历序列，从而访问受限目录之外的文件。

**有效性评估：**

根据提供的漏洞信息，POC代码并不直接可用。漏洞信息提及了包含`modelpath_test.go`的修复commit，表明存在测试用例可以触发和验证该漏洞。Vicarius的文章提供了更详细的漏洞分析。但是，提供的代码是构建vLLM容器的Dockerfile和一些脚本，与Ollama漏洞本身无关，因此无法直接验证CVE-2024-37032。

**投毒风险评估：**

提供的Dockerfile和相关脚本的目的是为了构建一个包含vLLM（一个快速的LLM推理库）的Docker镜像。这些文件本身看起来是安全的，目的是自动化构建和部署vLLM，没有发现任何恶意代码或后门。

因此，投毒风险很低。这里评估为0%。

**利用方式分析：**

1.  **构造恶意模型digest：** 攻击者需要能够向Ollama服务器发送请求，其中包含用于指定模型路径的digest参数。
2.  **路径遍历：** 将digest设置为包含路径遍历序列的值，例如`../`，目的是逃逸出预期的模型存储目录。
3.  **访问敏感文件/RCE：** 成功利用路径遍历后，攻击者可能能够读取服务器上的任意文件（如果Ollama进程具有相应的权限），或者结合其他漏洞实现远程代码执行。

由于Ollama在处理请求时会使用该digest构建文件路径，不充分的验证允许攻击者控制路径的一部分，从而访问到不应该访问的文件或目录。该漏洞CVSS评分为8.8，说明其潜在危害较大。

**项目地址:** [stuxbench/vllm-cve-2024-37032](https://github.com/stuxbench/vllm-cve-2024-37032)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)