## CVE-2023-1829 Linux Kernel tcindex Use-After-Free 漏洞

**漏洞编号:** CVE-2023-1829

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** <= 6.2 (根据CVE信息，影响3.8到6.2版本)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1829 是 Linux Kernel traffic control index filter (tcindex) 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞实现本地权限提升。

**有效性评估：**

从提供的漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，并且存在可用的PoC。

**漏洞利用方式：**

1.  漏洞位于`tcindex_delete`函数中，该函数在删除底层结构时，没有正确地禁用 filters，导致双重释放（double free）。
2.  本地攻击者可以利用此漏洞，通过精心构造的 traffic control (tc) 命令触发 use-after-free。
3.  成功利用该漏洞可以导致任意代码执行，从而将普通用户权限提升为 root 权限。
4.  提供的PoC代码使用了`libmnl`和`libnftnl`库，表明其利用涉及 Netlink 套接字来配置 traffic control。
5.  `get_root_src/get_root.c` 文件中的代码用于在获得 root 权限后启动一个 shell。

**投毒风险分析：**

分析PoC代码后，发现以下几点值得注意：

1.  `Makefile`包含`get_root`目标的编译，这部分代码用于提权后执行`bash`。
2.  `inc/cls.h` 文件中定义了一些网络相关的常量，如 `TRIG_HOST`，`TRIG_PORT`，`ADDR_SERVER`等，可能用于触发漏洞或与漏洞利用相关的其他操作。但是目前没有发现恶意连接或反弹shell的可疑代码。
3.  PoC代码依赖`libnftnl-dev`和`libmnl-dev`，确保目标系统安装了这些库。
4.  `README.md`中提到该PoC在Ubuntu 22.04 official source code 5.15.0-25.25上测试通过，表明此PoC可能依赖于特定内核版本或配置。
5.  PoC代码参考了 `https://github.com/randorisec/CVE-2022-34918-LPE-PoC/tree/main`，CVE-2022-34918是另外一个LPE漏洞，这说明PoC作者可能借鉴了其他漏洞的利用技术。

**投毒风险评估:**

综合分析，认为此PoC存在一定的投毒风险，概率约为 10%。`inc/cls.h`中预留的网络参数常量，不排除作者未来添加恶意代码的可能性。虽然目前未发现明显的恶意行为，但建议在使用此PoC时进行代码审计，并在受控环境中运行，以防止潜在的安全风险。

**总结:**

提供的PoC代码看起来是有效的，可以利用 CVE-2023-1829 漏洞实现本地权限提升。但由于其代码的复杂性以及参考了外部链接，存在一定的投毒风险，需要谨慎使用。


**项目地址:** [lanleft/CVE-2023-1829](https://github.com/lanleft/CVE-2023-1829)

**漏洞详情:** [CVE-2023-1829](https://nvd.nist.gov/vuln/detail/CVE-2023-1829)