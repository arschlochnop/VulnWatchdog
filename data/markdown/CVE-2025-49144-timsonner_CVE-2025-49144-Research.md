## CVE-2025-49144-Notepad++-特权提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 特权提升

**影响应用:** Notepad++

**危害等级:** 高危，允许本地用户获得SYSTEM权限

**影响版本:** < 8.8.2

**利用条件:** 需要用户下载并运行恶意程序，且与Notepad++安装包位于同一目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49144是Notepad++ v8.8.1及更早版本中存在的特权提升漏洞。利用方式为：

1.  攻击者将恶意的可执行文件（例如，伪装成`regsvr32.exe`或其他系统二进制文件）与Notepad++的官方安装程序放置在同一目录下（通常是用户的下载目录）。
2.  通过社会工程或其他手段诱使用户运行Notepad++安装程序。
3.  由于安装程序在不安全的路径下搜索依赖的DLL或其他可执行文件，它会优先加载并执行攻击者放置的恶意程序，并以SYSTEM权限运行。

漏洞利用代码分析：

提供的代码主要包含以下几个部分：

*   `archive-org.txt`: 包含来自Internet Archive的Notepad++下载链接。
*   `call-agent-no-prompt.cs` 和 `call-agent.cs`:  这两个C#程序尝试启动Notepad++安装程序。 `call-agent-no-prompt.cs`尝试删除Zone.Identifier来隐藏安全警告。
*   `npp.8.8.1.checksums.sha256`: 包含Notepad++ v8.8.1安装程序的SHA256校验和，用于验证下载的完整性。
*   `pop-shell.cs`: 一个简单的C#程序，用于启动一个带`-NoExit`参数的powershell窗口。

有效性分析：

根据漏洞描述，利用此漏洞的关键在于将恶意程序放置在与Notepad++安装程序相同的目录中，并诱使用户运行安装程序。`call-agent.cs`和`call-agent-no-prompt.cs`代码的功能是启动安装程序，但它们本身并没有包含恶意的代码。`pop-shell.cs`虽然会打开一个PowerShell窗口，但是其本身不具备提权的能力。 因此利用需要配合其他的恶意程序。 根据搜索结果，攻击者需要将恶意的regsvr32.exe放置在与安装程序相同的目录中。 综上，POC的有效性依赖于攻击者放置的恶意程序。代码本身不执行攻击，提供的是启动安装程序，因此有效性不能完全确定。 也就是说，只有将恶意的文件改名为安装程序需要加载的程序，才能利用成功。 该漏洞的利用方式明确有效。

投毒风险分析：

提供的代码中，没有发现明显的恶意或后门代码。 C#代码的功能都是较为直接的系统调用。因此，投毒风险较低。


**项目地址:** [timsonner/CVE-2025-49144-Research](https://github.com/timsonner/CVE-2025-49144-Research)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)