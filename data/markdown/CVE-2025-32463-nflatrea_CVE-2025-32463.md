## CVE-2025-32463 - Sudo 本地提权漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得 root 权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限,目标系统sudo版本在受影响范围内，存在gcc和基础编译工具

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Sudo 的 `--chroot` 选项中。当 Sudo 使用 `--chroot` 选项进入一个由非特权用户控制的目录时，它会使用 chroot 环境中的 NSS 配置来解析用户信息。攻击者可以通过在 chroot 环境中放置恶意的共享对象（例如 `libnss_/bipboop.so.2`），从而在 sudo 运行时加载该共享对象，导致以 root 权限执行任意代码，实现本地提权。 

**有效性：**
从漏洞描述、搜索结果和提供的 PoC 代码来看，该漏洞利用的有效性很高。PoC 代码 `bipboop.sh` 完整地演示了如何创建一个假的 chroot 环境、构建一个恶意的 NSS 模块，然后使用 `sudo -R` 触发漏洞。

**投毒风险：**
PoC 代码的主要目的是利用漏洞进行提权，其核心操作包括创建 chroot 环境、编译恶意共享对象并利用 sudo 触发执行。`bipboop.sh` 脚本中看似正常的代码创建了`boop/etc/nsswitch.conf`文件，指向了一个不存在的服务 `/bipboop`，正常情况下会加载`libnss_/bipboop.so.2` 文件，执行其中的恶意代码以提升权限。风险点在于这个so文件如果包含恶意指令可能会导致系统崩溃或被植入后门，如果这个so文件被作者替换成具有破坏性的代码，那么就会产生投毒行为。 但脚本本身的功能主要是漏洞利用，没有发现明显的额外恶意行为。但是考虑到共享对象可能包含的隐蔽风险，这里给出10%的投毒风险评估。

**利用方式：**
1.  **创建 chroot 环境：** 使用 `mktemp` 创建一个临时目录作为 chroot 环境。
2.  **构建恶意的 NSS 模块：** 编写 C 代码（`bipboop.c`），该代码在加载时会执行提权操作。将其编译为共享对象 `libnss_/bipboop.so.2`。
3.  **配置 NSS：** 在 chroot 环境中创建 `etc/nsswitch.conf` 文件，使其指向恶意的 NSS 模块。
4.  **触发漏洞：** 使用 `sudo -R` 选项进入 chroot 环境，这会触发 NSS 查找，加载恶意的共享对象，并执行其中的提权代码。

通过以上步骤，攻击者可以利用该漏洞获得 root 权限。

**项目地址:** [nflatrea/CVE-2025-32463](https://github.com/nflatrea/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)