## CVE-2025-29927-Next.js Middleware Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行权限验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中的一个授权绕过漏洞。攻击者可以通过在HTTP请求中设置`x-middleware-subrequest: middleware`头来绕过中间件的身份验证检查，从而访问受保护的路由。 

**有效性：**
提供的POC代码是有效的，它演示了如何使用`x-middleware-subrequest`头绕过Next.js中间件的身份验证。

**投毒风险：**
查看了仓库中的文件：
*   `/README.md`: 提供了漏洞描述、安装和运行指南，以及如何利用漏洞的说明。
*   `/middleware.ts`: 包含中间件逻辑，用于检查用户是否已通过身份验证。存在漏洞的代码。
*   `/next-env.d.ts`: Next.js环境声明文件，不包含任何恶意代码。
*   `/next.config.js`: Next.js配置文件，开启appDir试验性功能,不包含任何恶意代码
*   `/package-lock.json`: 包依赖锁定文件，不包含任何恶意代码。

所有文件中的代码都与漏洞描述和利用方式一致。考虑到这些因素，投毒风险较低，大约为5%。

**利用方式：**
1.  目标应用使用受影响版本的Next.js，并且使用中间件进行权限验证。
2.  攻击者构造一个HTTP请求，其中包含`x-middleware-subrequest: middleware`头。
3.  攻击者将此请求发送到受保护的路由。
4.  Next.js中间件错误地处理了`x-middleware-subrequest`头，导致身份验证检查被绕过。
5.  攻击者可以未经授权访问受保护的资源。

**项目地址:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)