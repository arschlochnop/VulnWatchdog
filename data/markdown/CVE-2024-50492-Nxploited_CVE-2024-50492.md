## CVE-2024-50492-ScottCart-代码注入

**漏洞编号:** CVE-2024-50492

**漏洞类型:** 代码注入

**影响应用:** ScottCart WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.1

**利用条件:** 需要目标网站安装了存在漏洞的ScottCart插件且未进行修复。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50492 存在于 Scott Paterson 的 ScottCart WordPress 插件中，允许未经身份验证的攻击者执行远程代码。该漏洞源于插件注册了一个未受保护的 AJAX action `scottcart_load_function`，该 action 通过 `call_user_func($_POST['function'])` 执行用户通过 POST 请求传递的任意 PHP 函数。攻击者可以利用此漏洞执行诸如 `phpinfo()` 之类的函数以获取敏感信息，或者执行 `system()` 函数以执行任意系统命令。利用方式：攻击者构造一个包含 `action=scottcart_load_function` 和 `function=恶意函数名` 的 POST 请求发送到 `/wp-admin/admin-ajax.php`。POC 代码中的 `CVE-2024-50492.py` 文件实现了此攻击，它允许指定目标 URL 和要执行的函数，默认 payload 为 `phpinfo()`。投毒风险分析：该仓库的投毒风险较低，主要因为 PoC 代码的功能较为明确，目的是验证漏洞的存在。存在的风险点在于，攻击者可能会修改 payload 参数以执行恶意代码，例如添加反弹 shell 的代码。但是，仓库本身并没有隐藏的恶意代码或后门。`README.md` 文件也详细描述了漏洞的原理和利用方法，这有助于用户理解和防范风险。尽管如此，仍然存在一小部分风险（约5%），即有人可能在不知情的情况下使用包含恶意 payload 的 PoC 代码。

**项目地址:** [Nxploited/CVE-2024-50492](https://github.com/Nxploited/CVE-2024-50492)

**漏洞详情:** [CVE-2024-50492](https://nvd.nist.gov/vuln/detail/CVE-2024-50492)