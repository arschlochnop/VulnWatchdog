## CVE-2025-32429-XWiki Platform-SQL注入

**漏洞编号:** CVE-2025-32429

**漏洞类型:** SQL注入

**影响应用:** XWiki Platform

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 9.4-rc-1 ~ 16.10.5, 17.0.0-rc-1 ~ 17.2.2

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32429存在于XWiki Platform的getdeleteddocuments.vm模板中，攻击者可以通过操纵`sort`参数来注入恶意的SQL代码。漏洞利用代码提供了一个C语言编写的PoC，可以检测WAF，并尝试执行SQL注入攻击，包括基于布尔、基于时间的盲注以及union查询。PoC代码编译运行后，通过向目标URL发送包含恶意SQL语句的请求，判断是否存在SQL注入漏洞。

**有效性：** 根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。漏洞库明确指出`getdeleteddocuments.vm`的`sort`参数存在SQL注入，搜索结果也确认了该漏洞的存在，并且PoC代码旨在验证并利用此漏洞。

**投毒风险：** 提供的代码中存在一些可疑的地方，例如`exitAssembly`函数使用了内联汇编，直接调用了Linux的exit系统调用，看起来没有必要。但是总体来看，这个PoC代码主要功能是执行SQL注入，没有发现明显的恶意代码或者后门，因此判定投毒的风险较低，约为5%。风险主要集中在编译环境的安全性，以及libcurl库本身是否存在未知的漏洞上。

**利用方式：**
1.  **确定目标：** 确定存在漏洞的XWiki Platform版本。
2.  **编译PoC：** 使用GCC编译提供的C代码，需要libcurl和argparse库。
3.  **运行PoC：** 运行编译后的可执行文件，提供目标XWiki实例的URL作为参数。可以选择提供cookie文件以进行身份验证。
4.  **漏洞验证：** PoC首先尝试检测WAF，然后发送一系列包含SQL注入Payload的请求，根据响应时间和内容判断是否存在SQL注入漏洞。
5.  **信息提取：** 如果存在漏洞，攻击者可以进一步利用SQL注入读取数据库信息或执行其他恶意操作。

**项目地址:** [byteReaper77/CVE-2025-32429](https://github.com/byteReaper77/CVE-2025-32429)

**漏洞详情:** [CVE-2025-32429](https://nvd.nist.gov/vuln/detail/CVE-2025-32429)