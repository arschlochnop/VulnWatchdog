## CVE-2025-3102 - SureTriggers 身份验证绕过导致管理员账户创建

**漏洞编号:** CVE-2025-3102

**漏洞类型:** 身份验证绕过

**影响应用:** SureTriggers WordPress插件

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户，导致完全控制目标网站

**影响版本:** <= 1.0.78

**利用条件:** 插件已安装并激活，但未配置API密钥

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3102 存在于 SureTriggers WordPress 插件的 1.0.78 及更早版本中。由于 `autheticate_user` 函数中缺少对 'secret_key' 值的空值检查，导致未经身份验证的攻击者可以绕过身份验证，创建管理员账户。从搜索引擎结果和漏洞描述来看，该漏洞允许攻击者在受影响的 WordPress 站点上创建具有管理权限的新用户，从而完全控制网站。提供的 POC 代码通过向 `/wp-json/sure-triggers/v1/automation/action` 端点发送包含新管理员用户名、密码和电子邮件的精心构造的 JSON 请求来利用此漏洞。由于st_authorization参数为空,导致可以直接创建管理员账户。

**利用方式：**

1.  确定目标 WordPress 站点是否安装并激活了易受攻击的 SureTriggers 插件版本（<= 1.0.78）。可以通过访问 `/wp-content/plugins/suretriggers/readme.txt` 文件并检查“Stable tag:”行来确定插件版本。
2.  如果插件版本易受攻击，则使用提供的 POC 代码，指定目标 URL，所需的管理员电子邮件地址、用户名和密码。
3.  POC 代码将构建一个 JSON payload 并将其发送到 `/wp-json/sure-triggers/v1/automation/action` 端点。
4.  如果利用成功，将在目标 WordPress 站点上创建一个新的管理员账户，攻击者可以使用指定的凭据登录并完全控制网站。

**投毒风险评估：**

代码中存在如下的可疑代码：`requests.packages.urllib3.disable_warnings()` ，作用是禁止urllib3发出的警告。虽然在某些情况下禁用警告可能是有用的，但通常不建议在生产环境中使用，因为它会隐藏潜在的安全问题或配置错误. 通过人工review代码,判断投毒概率在5%左右。POC本身的行为是利用漏洞，不应将其视为投毒。

**项目地址:** [Nxploited/CVE-2025-3102](https://github.com/Nxploited/CVE-2025-3102)

**漏洞详情:** [CVE-2025-3102](https://nvd.nist.gov/vuln/detail/CVE-2025-3102)