## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x and 7.x

**利用条件:** 目标系统运行存在漏洞的MagnusBilling版本，攻击者可发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性很高。搜索引擎结果显示多个来源都确认了此漏洞的存在和严重性，并指出攻击者可以通过未授权的HTTP请求执行任意操作系统命令。

**有效性：**
提供的POC代码尝试利用该漏洞，通过构造包含反弹shell命令的恶意HTTP请求。POC代码构造了一个 URL，其中包含经过URL编码的payload, 该payload会通过`icepay.php`脚本执行系统命令，从而反弹一个shell到攻击者的监听器(LHOST和LPORT)。代码中使用了`requests`库发送HTTP GET请求，并设置了User-Agent头部，模仿curl命令。该POC看起来完整且有效，如果目标环境存在漏洞，则可以成功利用。

**投毒风险：**
审查POC代码后，没有发现明显的投毒代码。该脚本的功能相对清晰：构造恶意请求以触发命令注入并反弹shell。虽然反弹shell本身具有潜在的风险，但这是漏洞利用的一部分，而不是隐藏的恶意功能。因此，可以认为此POC的投毒风险较低，接近0%。

**利用方式：**
1.  确定目标系统运行着存在漏洞的MagnusBilling版本（6.x或7.x）。
2.  设置攻击者的监听器（LHOST和LPORT），通常使用`nc -lvnp <LPORT>`。
3.  修改POC代码中的`TARGET_URL`、`LHOST`和`LPORT`以匹配目标和攻击者的环境。
4.  运行POC脚本。
5.  如果漏洞利用成功，攻击者的监听器将收到来自目标系统的反弹shell。

总体而言，该漏洞的利用方式简单直接，利用风险低，一旦成功利用，将导致严重的后果，如系统完全控制。

**项目地址:** [sk00l/CVE-2023-30258](https://github.com/sk00l/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)