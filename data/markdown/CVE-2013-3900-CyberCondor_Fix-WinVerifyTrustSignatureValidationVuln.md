## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)