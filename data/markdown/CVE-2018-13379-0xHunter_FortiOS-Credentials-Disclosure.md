## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)