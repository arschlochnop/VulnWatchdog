## CVE-2025-49844-Redis Lua Use-After-Free RCE

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器允许执行Lua脚本（未禁用 EVAL 和 EVALSHA 命令）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-49844 是一个 Redis 数据库中由于 Lua 脚本引擎的 use-after-free 漏洞，攻击者可以通过构造恶意的 Lua 脚本，利用 Redis 的内存管理机制缺陷，在内存被释放后再次访问，造成程序崩溃，甚至可以进一步执行任意代码。

**有效性：**
提供的 README.md 文件描述了一个用于检测 Redis 服务器是否存在 CVE-2025-49844 漏洞的扫描器（rscan）。该扫描器通过尝试在 Redis 服务器上执行 Lua 脚本来判断漏洞是否存在。如果服务器返回错误信息，则认为服务器是安全的。因此，提供的代码包含漏洞验证的功能，并提供了修复建议，从侧面说明漏洞利用的有效性。

**投毒风险：**
查看提供的代码（README.md），该文件更像是安全研究人员或红队人员编写的，旨在帮助用户检测和修复漏洞。 虽然存在极小的投毒的可能性，但是从内容可信度来看，基本可以忽略。投毒风险评估为1%的可能性。

**利用方式：**
1.  **漏洞触发：** 攻击者利用 Redis 允许执行 Lua 脚本的功能（`EVAL` 和 `EVALSHA` 命令）。
2.  **构造恶意脚本：** 攻击者编写一个精心设计的 Lua 脚本，该脚本可以操纵 Redis 的垃圾回收器，触发 use-after-free 漏洞。
3.  **内存破坏：** 恶意脚本尝试访问已经被释放的内存。
4.  **代码执行：** 通过利用 use-after-free 漏洞，攻击者可以覆盖内存中的数据，最终导致远程代码执行。

**缓解措施：**
1.  **禁用 Lua 脚本：** 使用 ACL 限制 `EVAL` 和 `EVALSHA` 命令，或者在 `redis.conf` 文件中禁用这些命令。
2.  **升级 Redis 版本：** 升级到 Redis 8.2.2 或更高版本，该版本修复了此漏洞。
3.  **网络隔离：** 限制可以连接到 Redis 服务器的 IP 地址。
4.  **设置密码：** 为 Redis 服务器设置强密码，并创建具有最小权限的用户。

**项目地址:** [angelusrivera/CVE-2025-49844](https://github.com/angelusrivera/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)