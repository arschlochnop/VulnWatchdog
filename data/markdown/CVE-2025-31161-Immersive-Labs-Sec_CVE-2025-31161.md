## CVE-2025-31161 - CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** CrushFTP 10 (10.0 - 10.8.3) 和 CrushFTP 11 (11.0 - 11.3.0)

**利用条件:** 目标 CrushFTP 实例未配置 DMZ 代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，从而完全控制系统。漏洞利用方式主要有两种：一种是利用 AWS4-HMAC 授权方法中的竞争条件，另一种是发送篡改过的 AWS4-HMAC 标头。POC 代码利用第二种方式，通过提供用户名和一个斜杠（/），服务器会成功找到用户名，但随后无法找到预期的 SignedHeaders 条目，导致索引超出范围错误，从而阻止代码到达会话清理步骤，实现身份验证绕过。POC 脚本创建了一个新的管理员用户。该漏洞利用的有效性高，因为漏洞库信息和搜索引擎结果都表明该漏洞已在野外被积极利用。代码本身未发现明显的投毒代码，该仓库的LICENSE使用的MIT许可，且逻辑较为清晰，主要功能是创建用户，因此投毒风险评估为0%。

**利用方式:**

1.  **身份验证绕过:** 通过构造特定的 HTTP 请求，绕过 CrushFTP 的身份验证机制，模拟成已有用户（通常是`crushadmin`）。
2.  **创建管理员账户:**  绕过身份验证后，利用服务器的管理功能，创建一个新的具有管理员权限的用户账户。
3.  **完全控制系统:** 使用新创建的管理员账户登录，获取对 CrushFTP 服务器的完全控制权，包括文件访问、用户管理等。

**项目地址:** [Immersive-Labs-Sec/CVE-2025-31161](https://github.com/Immersive-Labs-Sec/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)