## CVE-2018-10933-libssh-认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，允许未授权访问

**影响版本:** 0.6-0.7.5, 0.8.0-0.8.3

**利用条件:** 目标服务器运行存在漏洞的libssh版本，且服务端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-10933 是 libssh 库中的一个认证绕过漏洞。攻击者可以通过发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息来绕过身份验证，无需提供用户名或密码，直接建立会话。 

**有效性：**
提供的POC代码（`libsshscan.py`）包含两种验证模式：被动模式（banner抓取）和主动模式（绕过认证）。主动模式直接发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息来验证漏洞是否存在，如果服务器存在漏洞，则会成功建立会话，证明POC有效。

**投毒风险：**
查看了提供的`libsshscan.py`代码，该脚本主要功能是扫描和验证libssh漏洞。代码结构清晰，功能明确，没有发现任何可疑的后门代码或恶意行为。脚本通过建立SSH连接，发送特定的SSH消息来模拟攻击，以判断目标是否存在漏洞，其行为与漏洞利用的原理一致。因此，可以认为该代码不存在投毒风险。

**利用方式：**
1.  **Banner Grabbing:** (被动模式)通过连接到目标SSH端口并接收服务器发送的banner信息，初步判断目标libssh的版本。虽然banner信息可能被篡改，但可以作为一个参考。
2.  **Authentication Bypass:** (主动模式)不进行正常的SSH认证流程，直接向服务器发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息。如果服务器存在漏洞，它会错误地认为客户端已经通过身份验证，并允许建立连接。然后，可以打开一个会话并执行操作。

**搜索引擎结果佐证：**
*   NVD 和其他安全厂商 (Rapid7, Cisco) 的描述都表明此漏洞允许未经身份验证的远程攻击者绕过认证。
*   Fluid Attacks 的博客更详细地描述了利用方式，即发送 `user-authenticated packet`。
*   Exploit-DB 也收录了此漏洞的利用代码（链接在漏洞库信息中）。

**项目地址:** [jobroche/libssh-scanner](https://github.com/jobroche/libssh-scanner)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)