## CVE-2017-7529-Nginx Range Filter Integer Overflow

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 整数溢出

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2

**利用条件:** 需要开启range filter模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7529是Nginx range filter模块中的一个整数溢出漏洞。攻击者可以通过构造特殊的HTTP Range请求头，触发整数溢出，导致Nginx返回部分缓存文件内容，从而泄露敏感信息。

**有效性：**

提供的Dockerfile和相关配置文件构建了一个存在漏洞的Nginx环境（1.13.1版本）。`index.html`文件包含了利用此漏洞的说明。根据说明，需要先访问 `/proxy/demo.png` 获取 `Content-Length`，然后构造一个恶意的Range请求，如下所示：

```
curl -i http://127.0.0.1:8000/proxy/demo.png -r -17208,-9223372036854758600
```

POC代码有效，可以复现漏洞。

**投毒风险：**

查看Dockerfile，没有发现明显的投毒代码。Dockerfile的内容主要用于构建Nginx环境和Apache环境。`main.sh` 只是简单的启动Nginx和Apache，并保持运行。`build` 目录下的配置文件主要是Nginx和Apache的配置，没有发现恶意配置。所以，此仓库的投毒风险较低。

**利用方式：**

1.  **找到目标服务器上缓存的文件：** 首先需要知道目标服务器上缓存的文件路径，例如`/proxy/demo.png`。
2.  **获取Content-Length：** 通过发送一个HEAD请求或者GET请求，获取目标缓存文件的`Content-Length`。
3.  **构造恶意Range请求：** 根据`Content-Length`，构造一个恶意的Range请求头。具体的Range值计算方式如`index.html` 中所述。一个典型的恶意Range请求头如下：`Range: bytes=-17208,-9223372036854758600`
4.  **发送请求：** 将构造好的Range请求发送给目标服务器。如果服务器存在漏洞，则会返回部分缓存文件内容。

**搜索引擎结果佐证：**

搜索引擎结果均指出CVE-2017-7529是Nginx range filter模块中的一个整数溢出漏洞，可能导致敏感信息泄露。漏洞影响的版本范围是0.5.6到1.13.2。

**项目地址:** [cved-sources/cve-2017-7529](https://github.com/cved-sources/cve-2017-7529)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)