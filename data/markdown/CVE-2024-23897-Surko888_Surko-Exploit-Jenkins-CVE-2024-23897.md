## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的后跟文件路径的部分替换为文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**有效性分析：**
提供的Python POC代码似乎有效。它首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`文件，然后使用下载的jar文件和用户提供的文件路径构建一个Java命令，该命令利用漏洞读取文件。代码还包含必要的错误处理机制，例如检查HTTP响应状态码和捕获子进程错误。

**投毒风险分析：**
代码中存在轻微的投毒风险，风险占比约为10%。

*   **风险点：**
    *   `os.remove(archivo_jar)`: 理论上，如果恶意用户控制了文件系统，可能会通过符号链接等方式，让此删除操作影响到其他文件，虽然概率较低。
    *   `subprocess.run(payload, shell=True, check=True)`: 使用`shell=True`可能会受到命令注入的风险，但前提是攻击者能够控制`ruta`变量，这在漏洞利用的上下文中是预期行为，不算额外的投毒。

**漏洞利用方式：**
1.  攻击者使用提供的IP地址和端口从Jenkins服务器下载`jenkins-cli.jar`文件。
2.  攻击者提供想要读取的文件的路径（例如`/etc/passwd`）。
3.  POC脚本构造包含目标文件路径的payload，并作为参数传递给`jenkins-cli.jar`。
4.  Jenkins CLI解析参数，读取指定文件，并将其内容返回给攻击者。
5.  脚本删除下载的`jenkins-cli.jar`文件。

根据搜索引擎结果，此漏洞可以通过HTTP、WebSocket和SSH进行利用，其中HTTP和WebSocket的利用可能性最高。


**项目地址:** [Surko888/Surko-Exploit-Jenkins-CVE-2024-23897](https://github.com/Surko888/Surko-Exploit-Jenkins-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)