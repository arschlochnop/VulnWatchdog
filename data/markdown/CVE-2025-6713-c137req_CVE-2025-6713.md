## CVE-2025-6713-MongoDB-权限绕过

**漏洞编号:** CVE-2025-6713

**漏洞类型:** 权限绕过

**影响应用:** MongoDB Server

**危害等级:** 高危，可能导致未授权的数据访问

**影响版本:** MongoDB Server v8.0 < 8.0.7, v7.0 < 7.0.19, v6.0 < 6.0.22

**利用条件:** 需要对MongoDB实例的网络访问权限，并且用户需要具有可以执行聚合管道的权限（即使是低权限用户）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-6713 是 MongoDB Server 中一个由于 `$mergeCursors` 阶段处理不当造成的权限绕过漏洞。未授权用户可以构造恶意的聚合管道，在没有适当授权的情况下访问数据。

**漏洞利用方式：**

1.  攻击者利用聚合管道中的 `$mergeCursors` 阶段。
2.  `$mergeCursors` 允许将一个集合的数据合并到另一个集合中。
3.  通过构造恶意的 `$mergeCursors` 配置，攻击者可以指定访问受限的集合，从而绕过权限验证。
4.  POC 代码中构造了聚合管道，使用 `$mergeCursors` 从受限集合 `rcollection` 合并数据到公开集合 `acollection`，最终实现对 `rcollection` 的未授权访问。
5.  POC 代码通过创建两个集合，一个公共集合 `acollection` 和一个受限集合 `rcollection` 来模拟环境。然后，它执行包含恶意 `$mergeCursors` 阶段的聚合管道，该管道旨在将 `rcollection` 的数据合并到 `acollection` 中。

**投毒风险分析：**

虽然 POC 代码本身看起来很简单，并且专注于漏洞利用，但存在轻微的投毒风险。

*   **mconnect 变量：**  代码允许用户修改 `mconnect` 变量来连接到自定义 MongoDB 实例。如果攻击者诱使用户连接到恶意的 MongoDB 实例，则可能会窃取数据或执行其他恶意操作。
*   **dbname,acollection,rcollection 变量：** 数据库、公开集合以及私有集合名称都由用户自定义,存在用户配置风险。
*   **依赖风险：** 该poc依赖pymongo库，如果安装的pymongo库被植入恶意代码，存在风险

总体而言，此仓库中的投毒风险较低，约为 5%。主要是配置信息可能导致风险。

**项目地址:** [c137req/CVE-2025-6713](https://github.com/c137req/CVE-2025-6713)

**漏洞详情:** [CVE-2025-6713](https://nvd.nist.gov/vuln/detail/CVE-2025-6713)