## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)