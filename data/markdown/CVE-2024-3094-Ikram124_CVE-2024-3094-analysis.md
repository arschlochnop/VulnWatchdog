## CVE-2024-3094 - XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的XZ Utils版本被安装且sshd使用liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是XZ Utils库中的一个后门，影响版本5.6.0和5.6.1。攻击者通过一系列复杂的混淆，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后用它来修改liblzma代码中的特定函数。这导致修改后的liblzma库被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。最关键的影响是，该后门允许攻击者绕过SSH身份验证，并可能执行远程代码。漏洞的利用方式是通过恶意代码修改了sshd，使其在身份验证过程中存在漏洞。提供的漏洞利用代码（README.md）本身并不直接提供攻击代码，而是对漏洞进行了描述，并给出了缓解措施。因此，判断POC有效性应该考虑结合其他资料，此README.md起辅助描述作用。投毒风险评估：此README.md文件主要提供漏洞描述和防御建议，虽然可以作为学习资料，但潜在的风险在于，攻击者可能利用此仓库进行混淆，在看似无害的代码中隐藏恶意代码。例如，在相关脚本或配置示例中植入恶意指令。因此，存在一定的投毒风险，预估占比为10%。

**项目地址:** [Ikram124/CVE-2024-3094-analysis](https://github.com/Ikram124/CVE-2024-3094-analysis)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)