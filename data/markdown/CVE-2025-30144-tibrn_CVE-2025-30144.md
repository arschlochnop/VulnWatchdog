## CVE-2025-30144 - fast-jwt 身份验证绕过

**漏洞编号:** CVE-2025-30144

**漏洞类型:** 身份验证绕过

**影响应用:** fast-jwt

**危害等级:** 中危，可能导致未经授权的访问和数据篡改

**影响版本:** < 5.0.6

**利用条件:** 应用程序使用fast-jwt库进行JWT验证，且未进行额外的iss claim验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30144 漏洞存在于 fast-jwt 5.0.6 之前的版本中，由于其对 JWT 的 `iss` (issuer) claim 验证不严格，允许 `iss` 声明为字符串数组。攻击者可以构造一个包含恶意 issuer 的 JWT，例如 `['https://attacker-domain/', 'https://valid-iss']`。由于 fast-jwt 的验证机制允许这种格式，且如果应用程序依赖的外部库（例如 `get-jwks`）没有独立验证 `iss` claim，攻击者就可以绕过身份验证。攻击者通过在 `iss` 数组中添加自己的域名，欺骗应用程序信任伪造的 JWT。

**利用方式：**

1.  攻击者搭建一个服务器，用于提供 JWT 密钥和伪造的 issuer 信息（例如，`.well-known/jwks.json`）。
2.  攻击者构造一个 JWT，其中 `iss` claim 包含攻击者服务器的地址和合法的 issuer 地址，例如 `iss: ['https://attacker-domain/', 'https://valid-iss']`。
3.  攻击者使用攻击者服务器的私钥签名 JWT。
4.  攻击者将伪造的 JWT 发送给目标应用程序。
5.  如果目标应用程序使用存在漏洞的 fast-jwt 版本，并且依赖的外部库没有进行 `iss` claim 的额外验证，则 JWT 将被视为有效，攻击者成功绕过身份验证。

**POC有效性：**

提供的 POC 代码模拟了利用该漏洞的场景，包括一个存在漏洞的服务器（端口 3000）和一个用于生成恶意 JWT 的服务器（端口 3001）。POC 演示了如何构建包含恶意 `iss` claim 的 JWT，并通过 `curl` 命令验证了可以绕过目标服务器的身份验证。

**投毒风险分析：**

检查POC代码，其中主要操作是设置服务器以生成和验证JWT令牌。在端口3001上运行的服务器创建令牌，其中`iss`声明设置为包含主机和有效issuer的数组，这允许绕过验证。端口3000上的服务器验证令牌。没有明显的恶意代码，即设计来直接损害系统或窃取数据的代码。然而，此PoC的目的是展示漏洞，可以被滥用来创建未经授权的访问，它本身不是恶意的，而是利用现有的软件缺陷。但依然存在一定风险,攻击者可能混淆真实攻击代码到POC代码中,所以推测为10%。

**项目地址:** [tibrn/CVE-2025-30144](https://github.com/tibrn/CVE-2025-30144)

**漏洞详情:** [CVE-2025-30144](https://nvd.nist.gov/vuln/detail/CVE-2025-30144)