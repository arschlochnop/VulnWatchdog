## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)