## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)