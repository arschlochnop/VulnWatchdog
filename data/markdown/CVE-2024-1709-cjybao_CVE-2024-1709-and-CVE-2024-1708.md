## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行和控制关键系统

**影响版本:** <= 23.9.7

**利用条件:** 目标ScreenConnect实例可从网络访问，且版本低于或等于23.9.7

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 23.9.7 及更早版本中的一个身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL，绕过身份验证机制，从而直接访问敏感信息或关键系统。\n\n**漏洞利用有效性：**\n根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用具有很高的有效性。CISA已将其添加到已知被利用的漏洞目录(KEV)。搜索引擎结果也表明该漏洞被积极利用，并且存在公开的POC。\n\n**投毒风险评估：**\n该POC代码的投毒风险较低，约为1%。代码主要功能是创建并上传一个恶意扩展，该扩展包含一个webshell。webshell允许攻击者在目标系统上执行任意命令。虽然存在执行任意命令的风险，但代码本身没有明显的恶意行为，例如删除文件、传播恶意软件等。风险主要在于使用者利用此webshell进行恶意操作。\n\n**漏洞利用方式：**\n漏洞利用方式如下：\n1.  **身份验证绕过：** 攻击者利用身份验证绕过漏洞，无需有效凭据即可与ScreenConnect服务器交互。具体绕过方式可能涉及操纵URL路径或利用其他未公开的身份验证机制缺陷。\n2.  **上传恶意扩展：** 攻击者使用POC代码创建一个包含webshell的恶意扩展。扩展包含一个C# webshell，该webshell通过查询字符串参数`cmd`接收命令并在服务器上执行。\n3.  **远程代码执行：** 攻击者通过访问webshell的URL，并传递要执行的命令作为查询字符串参数，在服务器上执行任意代码。\n\n**总结：**\nCVE-2024-1709 是一个严重的安全漏洞，利用简单，影响广泛。受影响的组织应立即升级到 ConnectWise ScreenConnect 23.9.8 或更高版本。

**项目地址:** [cjybao/CVE-2024-1709-and-CVE-2024-1708](https://github.com/cjybao/CVE-2024-1709-and-CVE-2024-1708)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)