## CVE-2023-38831-WinRAR远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2023-38831是WinRAR在6.23版本之前存在的一个远程代码执行漏洞。该漏洞的利用方式是构造一个特殊的ZIP压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且已经在野外被利用。漏洞利用代码提供了一个框架，用于生成包含恶意payload的ZIP压缩包，从而实现远程代码执行。

**投毒风险分析：**
提供的代码是一个框架，用于生成漏洞利用的 ZIP 文件，包含生成 exp，邮件发送，下载链接生成等功能。代码中存在潜在的投毒风险，主要体现在以下几个方面：

1.  **Payload 植入:**  该框架可以自定义payload，如果用户在不了解 payload 内容的情况下使用，可能运行恶意指令。
2.  **代码可信度:** 虽然作者声明为安全开发成员，并开源了代码，但代码的安全性仍然需要进一步审计。存在作者预留后门的可能性。 考虑到这是一个漏洞利用框架，其本质就是为了执行恶意代码，所以判定为投毒代码的风险为50%。

**漏洞利用方式：**

1.  攻击者使用该漏洞利用框架(evil-winrar)生成一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（如JPG图片）和一个同名的文件夹，文件夹中包含恶意可执行文件。
3.  攻击者通过社会工程学等方式诱骗用户使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包。
4.  用户尝试查看良性文件时，WinRAR 会错误地执行同名文件夹中的恶意代码。
5.  恶意代码在用户系统上执行，攻击者从而实现远程代码执行，控制受害者的计算机。

**项目地址:** [youmulijiang/evil-winrar](https://github.com/youmulijiang/evil-winrar)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)