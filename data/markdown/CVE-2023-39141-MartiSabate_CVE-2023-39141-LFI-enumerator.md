## CVE-2023-39141-webui-aria2-路径遍历

**漏洞编号:** CVE-2023-39141

**漏洞类型:** 路径遍历

**影响应用:** webui-aria2

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 所有版本，直至发现漏洞时的最新提交

**利用条件:** 需要网络访问webui-aria2服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-39141是一个存在于webui-aria2中的路径遍历漏洞。攻击者可以利用此漏洞读取服务器上任意文件，前提是运行webui-aria2的用户具有读取这些文件的权限。

**有效性：**
提供的PoC代码 (`enumerator.sh`) 看起来是有效的。它使用 `curl` 命令，通过构造包含路径遍历序列 (`/../../../../../../../../../../../../../../../../../../../../`) 的URL来请求目标文件。如果服务器返回状态码 200，则表示文件存在且可读取，脚本会将响应保存到本地 `web` 目录。

**投毒风险：**
PoC代码本身主要功能是利用路径遍历漏洞枚举和下载文件。投毒风险较低，主要存在于以下几个方面：
1.  **下载的文件可能包含恶意代码：** 如果攻击者利用该漏洞下载了可执行文件或配置文件，这些文件可能已经被恶意修改。用户下载并使用这些文件可能导致系统被感染。但这是漏洞利用本身的风险，而非PoC代码投毒。
2.  **`response.txt`文件内容篡改:** 恶意攻击者可能通过修改`response.txt`内容,使其展示错误的文件状态，从而引导用户下载错误或恶意文件。
3.  **依赖的外部命令存在风险：**  脚本依赖 `curl`, `cut`, `head` 和标准 shell 工具。如果这些工具本身被恶意替换或污染，脚本的执行结果可能会被篡改。这种风险与脚本本身无关，而是系统安全问题。

综合考虑，投毒风险较低，估计在10%左右。主要的风险在于下载的文件本身可能包含恶意内容。

**利用方式：**
1.  **确定目标webui-aria2实例的URL。**
2.  **准备一个包含可能存在的文件和目录路径的字典 (`wordlist`)。** 例如，可以包含 `/etc/passwd`, `/home/user/.ssh/id_rsa`, `/var/log/nginx/access.log` 等敏感文件路径。
3.  **运行 `enumerator.sh` 脚本，提供字典和目标URL作为参数。**
4.  **脚本会尝试下载字典中的每个文件。如果文件存在且可访问，则会被保存到本地 `web` 目录中。**
5.  **分析下载的文件，寻找敏感信息。**

漏洞利用的关键在于构造正确的URL，利用路径遍历序列绕过webui-aria2的文件访问限制。

**项目地址:** [MartiSabate/CVE-2023-39141-LFI-enumerator](https://github.com/MartiSabate/CVE-2023-39141-LFI-enumerator)

**漏洞详情:** [CVE-2023-39141](https://nvd.nist.gov/vuln/detail/CVE-2023-39141)