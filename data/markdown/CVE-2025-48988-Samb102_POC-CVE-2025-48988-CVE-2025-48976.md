## CVE-2025-48988-Apache Tomcat-资源耗尽

**漏洞编号:** CVE-2025-48988

**漏洞类型:** 资源耗尽

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务拒绝 (DoS)

**影响版本:** 11.0.0-M1 <= 11.0.7, 10.1.0-M1 <= 10.1.41, 9.0.0.M1 <= 9.0.105

**利用条件:** 需要网络访问Tomcat服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-48988 漏洞是 Apache Tomcat 中的一个资源分配漏洞，允许攻击者通过发送大量包含多个 part 和 header 的 multipart 请求来耗尽服务器资源，导致拒绝服务。  

**有效性：**  
根据提供的漏洞信息和POC代码，该POC代码是有效的。  它通过构造包含大量 part 和 header 的 multipart 请求来利用 Tomcat 在处理文件上传时资源限制不足的问题。Dockerfile 使用了存在漏洞的 Tomcat 版本 (10.1.41)，并且 POC 包含验证步骤，通过 `docker stats` 观察 CPU 使用率的显著增加。

**投毒风险：**  
此仓库中存在投毒代码的可能性较低，大概在5%左右。 代码相对简单，主要用于演示漏洞。  
主要的脚本是 `exploit-cve-2025-48988.py`， 该脚本的功能是构建并发送恶意的multipart请求。Dockerfile 用于构建包含易受攻击版本的Tomcat的Docker镜像。 web.xml 和 UploadServlet.java 文件是简单的Servlet配置，用于处理文件上传。 
潜在的投毒方式可能是在 exploit 脚本中添加额外的恶意负载，或是在 Servlet 代码中添加后门。 然而，考虑到这是一个PoC项目，作者旨在重现漏洞，因此直接添加恶意后门的可能性较低。 比较隐蔽的方式可能是控制 Content-Type，在一定条件下触发反序列化漏洞，不过这不属于本次漏洞讨论范畴。

**利用方式：**  
1.  **漏洞原理：**  Tomcat 未对 multipart 请求中 part 和 header 的数量进行有效限制，导致服务器在处理大量 part 和 header 时消耗大量资源，最终导致服务拒绝。
2.  **攻击步骤：**  
    *   攻击者构建恶意的 multipart 请求，其中包含大量的 part (例如 1000 个) 和 header (每个 part 包含 50 个 header)。
    *   攻击者将此恶意请求发送到 Tomcat 服务器上的文件上传端点 (例如 `/upload`)。
    *   Tomcat 服务器尝试解析和处理这些大量的 part 和 header，导致 CPU 和内存资源被耗尽。
    *   服务器变得无响应，无法处理正常用户的请求，从而导致拒绝服务。
3.  **缓解措施：**  升级到 Tomcat 11.0.8, 10.1.42 或 9.0.106，这些版本修复了此漏洞。

**项目地址:** [Samb102/POC-CVE-2025-48988-CVE-2025-48976](https://github.com/Samb102/POC-CVE-2025-48988-CVE-2025-48976)

**漏洞详情:** [CVE-2025-48988](https://nvd.nist.gov/vuln/detail/CVE-2025-48988)