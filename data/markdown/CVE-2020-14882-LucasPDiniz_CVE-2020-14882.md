## CVE-2020-14882 - Oracle WebLogic RCE

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要目标服务器开放HTTP端口(通常为7001)，攻击者能够通过网络访问该端口，且目标服务器未打相关补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-14882是Oracle WebLogic Server控制台组件中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过HTTP协议利用，从而完全控制受影响的WebLogic Server实例。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，此漏洞的POC代码是有效的。多个来源 (NVD, Rapid7, Tenable, 其他安全博客) 证实了该漏洞的存在和可利用性，并且给出了CVSS 3.1评分9.8，表明该漏洞是严重且易于利用的。提供的POC代码展示了如何通过构造特定的HTTP请求，利用`console.portal`页面和Spring的`FileSystemXmlApplicationContext`来加载远程XML文件，从而执行任意代码。

**投毒风险评估：**

提供的README.md文件中包含的POC代码本身旨在利用漏洞，而不是投毒。投毒的风险主要在于，如果攻击者修改了提供XML文件的服务器 (192.168.0.16)或者替换XML文件内容，则可以执行恶意的代码，造成拒绝服务、数据篡改或植入后门等风险。在给定的上下文中，由于提供的POC代码依赖于攻击者控制的服务器和XML文件，因此如果仓库所有者在不知情的情况下使用了修改后的恶意XML文件，则可能存在一定的投毒风险，但可能性很低，因此估计为5%。

**利用方式分析：**

1.  **漏洞入口点：** 该漏洞通过WebLogic Server的控制台组件的`console.portal`页面暴露，该页面允许未经身份验证的访问。
2.  **利用机制：** 攻击者利用Spring Framework的`FileSystemXmlApplicationContext`类来加载远程XML配置文件。
3.  **攻击步骤：**
    *   攻击者构造一个包含恶意配置的XML文件，该文件指定要执行的命令（例如，启动计算器）。
    *   攻击者启动一个HTTP服务器来托管该XML文件。
    *   攻击者向目标WebLogic Server发送一个特制的HTTP请求，该请求包含指向攻击者托管的XML文件的URL。
    *   WebLogic Server加载并解析该XML文件，从而执行攻击者指定的恶意代码。
4.  **无身份验证：** 该漏洞无需任何身份验证即可利用，这意味着任何可以访问WebLogic Server的HTTP端口的攻击者都可以尝试利用此漏洞。

**总结：**

CVE-2020-14882是一个严重的安全漏洞，攻击者可以利用它来远程控制WebLogic Server。该漏洞的利用非常简单，只需要构造一个恶意的HTTP请求和一个包含恶意配置的XML文件。强烈建议受影响的用户尽快应用Oracle提供的安全补丁。

**项目地址:** [LucasPDiniz/CVE-2020-14882](https://github.com/LucasPDiniz/CVE-2020-14882)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)