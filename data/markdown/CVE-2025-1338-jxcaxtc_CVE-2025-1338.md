## CVE-2025-1338-NUUO Camera-命令注入

**漏洞编号:** CVE-2025-1338

**漏洞类型:** 命令注入

**影响应用:** NUUO Camera

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 20250203

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1338是NUUO Camera的一个命令注入漏洞，影响版本至20250203。漏洞存在于`/handle_config.php`文件的`print_file`函数的`log`参数中。攻击者可以通过构造恶意请求，将恶意命令注入到`log`参数中，从而在服务器上执行任意命令。

**有效性评估：**
提供的Python POC代码通过向`/handle_config.php`发送GET请求，并在`log`参数中包含`id`命令（`;id`）来利用此漏洞。如果服务器返回包含`uid=`和`gid=`的响应，则表示目标存在漏洞。代码中包含验证逻辑，通过判断响应中是否包含`uid=`和`gid=`字符串来确认漏洞的存在，因此可以判断该POC有效。

**投毒风险分析：**
查看提供的Python POC代码，该脚本的主要功能是加载目标URL列表，然后对每个URL发送包含恶意命令的HTTP请求，根据响应内容判断是否存在漏洞。脚本包含以下几个关键部分：

*   **目标加载：** 从文件中读取目标URL。
*   **请求构造：** 构造包含恶意命令的HTTP GET请求。
*   **漏洞验证：** 检查响应内容，判断是否存在漏洞。
*   **结果输出：** 将结果输出到屏幕和文件。

该脚本没有发现任何恶意代码，例如反弹shell、上传恶意文件或删除系统文件等。脚本的目的是检测目标是否存在漏洞，而不是利用漏洞进行恶意攻击。因此，该POC代码的投毒风险较低，仅为0%。

**利用方式：**
1.  攻击者需要一个包含目标NUUO Camera设备的URL列表。
2.  攻击者运行POC脚本，指定目标URL列表文件。
3.  POC脚本向每个目标设备的`/handle_config.php`发送包含恶意命令的HTTP GET请求（例如，`?log=;id`）。
4.  如果目标设备存在漏洞，它将执行注入的命令（`id`），并将结果返回给攻击者。
5.  攻击者可以根据返回的结果判断目标设备是否存在漏洞，如果存在，则可以进一步利用该漏洞执行其他恶意命令。

**项目地址:** [jxcaxtc/CVE-2025-1338](https://github.com/jxcaxtc/CVE-2025-1338)

**漏洞详情:** [CVE-2025-1338](https://nvd.nist.gov/vuln/detail/CVE-2025-1338)