## CVE-2022-25842-com.alibaba.oneagent-Zip Slip

**漏洞编号:** CVE-2022-25842

**漏洞类型:** Zip Slip

**影响应用:** com.alibaba.oneagent:one-java-agent-plugin

**危害等级:** 中危，可能导致任意文件写入和远程代码执行

**影响版本:** 所有版本

**利用条件:** 需要用户交互，高攻击复杂度

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 com.alibaba.oneagent:one-java-agent-plugin 中，由于程序在提取 ZIP 压缩包时未正确校验文件名，攻击者可以构造包含目录遍历字符（如 `../../evil.exe`）的恶意 ZIP 压缩包，当用户解压此压缩包时，恶意文件将被写入到任意位置，从而覆盖可执行文件并最终实现远程命令执行。

**有效性：**
提供的漏洞库信息、搜索引擎结果和漏洞描述均表明该漏洞存在，并且存在概念验证代码。漏洞利用的有效性取决于目标系统是否使用了存在漏洞的 one-java-agent-plugin 版本以及用户是否会解压恶意构造的 ZIP 文件。

**投毒风险：**
提供的漏洞利用代码段仅包含 Apache 2.0 许可证文本，不包含任何可疑或恶意的代码。因此，此处不存在明显的投毒风险。

**利用方式：**
1.  **构造恶意 ZIP 文件：** 攻击者需要创建一个 ZIP 文件，其中包含带有目录遍历字符的文件名，例如 `../../evil.exe`。`evil.exe` 是攻击者想要写入目标系统的恶意程序。
2.  **诱骗用户解压：** 攻击者需要诱骗目标用户使用存在漏洞的 one-java-agent-plugin 解压该恶意 ZIP 文件。这可能通过社交工程或其他欺骗手段实现。
3.  **覆盖文件：** 当用户解压恶意 ZIP 文件时，存在漏洞的 one-java-agent-plugin 会将 `evil.exe` 写入到用户指定目录之外的位置，从而可能覆盖系统关键文件或其他可执行文件。
4.  **执行恶意代码：** 如果攻击者成功覆盖了可执行文件，他们可以等待用户或系统执行被覆盖的文件，从而实现远程命令执行。

**项目地址:** [shoucheng3/alibaba__one-java-agent_CVE-2022-25842_0-0-1](https://github.com/shoucheng3/alibaba__one-java-agent_CVE-2022-25842_0-0-1)

**漏洞详情:** [CVE-2022-25842](https://nvd.nist.gov/vuln/detail/CVE-2022-25842)