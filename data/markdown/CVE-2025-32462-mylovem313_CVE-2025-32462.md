## CVE-2025-32462-Sudo-Host绕过

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危，可能导致本地权限提升

**影响版本:** 1.8.8 <= Sudo < 1.9.17p1

**利用条件:** 目标系统存在sudoers配置，指定了非当前主机或ALL以外的主机名

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32462 是 Sudo 中一个主机名绕过漏洞。当 sudoers 文件中指定了非当前主机或 ALL 的主机时，攻击者可以利用 `-h` 选项指定一个目标主机，从而绕过主机名限制，在不应该被允许的主机上执行命令。根据搜索引擎结果，该漏洞存在了很长时间，但影响范围相对较小，需要特定的 sudoers 配置才能触发。POC代码的有效性较高，其实现原理是通过构建 `sudo -h <target_host> <command>` 命令，利用漏洞绕过主机名验证。

**有效性:**
根据漏洞描述和搜索结果，该POC有效，可以复现该漏洞，实现权限提升，利用条件是目标系统存在特定的 sudoers 配置。

**投毒风险:**
提供的C代码非常简单，其功能就是获取目标主机和要执行的命令，然后构建并执行sudo命令。该代码没有发现任何明显的恶意代码或隐藏的后门。投毒风险很低。

**利用方式:**
1.  目标系统存在漏洞版本的Sudo (1.8.8 <= Sudo < 1.9.17p1)。
2.  Sudoers配置文件中需要配置了针对特定用户的，仅允许在特定主机上执行命令的规则，且该主机不是当前主机或ALL。
3.  攻击者利用 `-h` 参数指定一个目标主机，并执行命令，即可绕过主机名检查，在其他主机上执行命令，从而可能提升权限。

**项目地址:** [mylovem313/CVE-2025-32462](https://github.com/mylovem313/CVE-2025-32462)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)