## CVE-2021-42013-Apache HTTP Server-路径遍历与远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历与远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是对 CVE-2021-41773 不完整修复的延续。攻击者可以利用此漏洞，通过构造包含恶意路径的URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了 CGI 脚本，攻击者可能通过上传恶意脚本执行远程代码。

**有效性:** 根据漏洞描述和PoC代码，该漏洞是有效的。PoC代码展示了通过`../`进行路径遍历，读取`/etc/passwd`文件的几种方式，包括对`.`和`/`的URL编码绕过。

**投毒风险:** PoC 代码本身较为简单，仅包含用于验证漏洞的 URL。但考虑到攻击者可能利用此漏洞部署恶意 CGI 脚本，存在一定投毒风险，约10%。README.md文件描述简单，未发现异常。

**利用方式:**
1.  **路径遍历:** 构造包含编码后的`../`的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取目标服务器上的敏感文件。
2.  **远程代码执行 (RCE):**  如果目标服务器允许执行 CGI 脚本，攻击者可以上传一个包含恶意代码的 CGI 脚本，并通过构造路径遍历 URL 来访问该脚本，从而执行任意命令。

**项目地址:** [Vulnmachines/cve-2021-42013](https://github.com/Vulnmachines/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)