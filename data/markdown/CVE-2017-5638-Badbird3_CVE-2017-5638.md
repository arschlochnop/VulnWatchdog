## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)