## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的一个漏洞。攻击者可以构造一个包含良性文件（例如 .jpg 文件）和一个同名文件夹的 ZIP 压缩包。该文件夹中包含恶意代码（例如 .cmd 文件）。当用户尝试查看良性文件时，WinRAR 会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码有效，它演示了如何创建一个恶意的 RAR 文件来利用此漏洞。

*   `DoS.cmd` 文件包含恶意代码，用于创建多个消息框，模拟拒绝服务攻击。
*   `exploit.py` 脚本用于生成包含恶意 `DoS.cmd` 文件的 RAR 文件，并利用漏洞触发代码执行。
*   `README.md` 详细解释了漏洞原理和利用方法，并提供了攻击成功的截图。

**投毒风险：**

此仓库中可能存在轻微的投毒风险，约为5%。

*   `DoS.cmd` 只是一个简单的拒绝服务攻击示例，但攻击者可能会将其替换为更具破坏性的恶意代码，例如勒索软件或信息窃取程序。如果下载者不仔细检查 `DoS.cmd` 的内容，可能会在不知情的情况下运行恶意代码。
*   `exploit.py` 脚本本身没有明显的恶意代码，但它可以被修改以生成包含不同恶意代码的 RAR 文件。下载者应该仔细审查脚本的内容，确保它不会被用于传播恶意软件。

**利用方式：**

1.  攻击者创建一个包含良性文件（例如 `image.jpg`）和一个同名文件夹（例如 `image.jpg `）的 ZIP 压缩包。注意文件夹名称后面有一个空格。
2.  在同名文件夹中，攻击者放置恶意代码（例如 `image.jpg .cmd`）。
3.  攻击者将 ZIP 文件转换为 RAR 文件（POC 脚本完成了此过程）。
4.  攻击者诱骗用户使用受影响的 WinRAR 版本打开 RAR 文件并尝试查看良性文件（`image.jpg`）。
5.  WinRAR 错误地执行同名文件夹中的恶意代码 (`image.jpg .cmd`)，从而导致远程代码执行。

由于该漏洞被广泛利用，并且网上存在大量相关的 POC 代码，因此攻击者很容易发起攻击。


**项目地址:** [RonF98/CVE-2023-38831-POC](https://github.com/RonF98/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)