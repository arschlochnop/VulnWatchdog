## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)