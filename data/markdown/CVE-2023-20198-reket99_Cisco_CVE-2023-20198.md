## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可导致完全控制受影响的Cisco IOS XE设备

**影响版本:** 16.1.1 to 17.12.1 (部分版本)

**利用条件:** Web UI功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。攻击者可以利用此漏洞，在未经身份验证的情况下，创建一个具有特权级别15（完全访问所有命令）的本地用户。接下来，攻击者可以利用CVE-2023-20273，通过新创建的本地用户提升权限至root并在文件系统中写入植入物。漏洞利用流程如下：

1.  **CVE-2023-20198 利用:**  未经验证的攻击者通过发送特制的POST请求到`/webui/logoutconfirm.html`，绕过身份验证，创建一个具有管理员权限的新用户。
2.  **CVE-2023-20273 利用:** 使用步骤1中创建的管理员用户，利用另一个Web UI组件中的漏洞，提升权限到root，并写入恶意植入物。

提供的POC代码尝试通过向目标IP地址的`/webui/logoutconfirm.html`发送POST请求来验证漏洞是否存在。如果响应状态码为200，并且响应长度较短（小于32字节），则认为该IP地址易受攻击。然后，脚本会使用curl再次发送请求，如果返回特定的输出长度，则确认漏洞存在。

**关于投毒风险:**

虽然该脚本的主要目的是验证漏洞的存在，但仍然存在一定的投毒风险。风险点在于subprocess.run函数中，使用shell=True来执行curl命令。这使得代码容易受到命令注入攻击，如果攻击者能够控制IP地址或相关参数，则可能执行任意命令。 此外，脚本会将成功利用漏洞的IP地址记录到results.csv 文件中，这虽然不是恶意行为，但可能被恶意行为者利用。投毒风险评估为10%，主要是因为使用了subprocess.run(shell=True)执行外部命令。

**项目地址:** [reket99/Cisco_CVE-2023-20198](https://github.com/reket99/Cisco_CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)