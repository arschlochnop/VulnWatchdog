## CVE-2024-45352 - Xiaomi Smarthome Application Code Execution

**漏洞编号:** CVE-2024-45352

**漏洞类型:** 代码执行

**影响应用:** Xiaomi Smarthome Application

**危害等级:** 高危，可能导致设备控制和数据泄露

**影响版本:** 10.0.623

**利用条件:** 用户需要点击恶意链接或被诱导执行恶意操作，需要应用存在WebView组件且未进行严格的输入验证。

**POC 可用性:** 部分

**投毒风险:** 5%

## 详情

CVE-2024-45352 漏洞存在于小米智能家居应用程序中，由于不正确的输入验证导致的代码执行漏洞。攻击者可以利用 WebView 组件，通过构造恶意的输入，例如 JavaScript 代码，在应用程序的上下文中执行任意代码。这可能允许攻击者控制智能家居设备，窃取用户数据，或执行其他恶意操作。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，该漏洞确实存在，并且被标记为高危。POC代码只包含许可证和README文件，并没有实际的漏洞利用代码。因此，无法直接评估提供的POC代码的有效性。需要进一步搜索或开发实际的漏洞利用代码才能验证漏洞的有效性。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。初步判断，这些文件本身不包含恶意代码。但需要注意的是，后续攻击者可能会在此仓库中添加恶意代码，从而达到投毒的目的。由于提供的文件内容非常简单，投毒的概率较低，但不能完全排除。因此，投毒风险评估为 5%。

**利用方式：**
1.  **攻击向量：** 攻击者可以构造包含恶意代码的网页或者其他形式的内容，通过诱骗用户点击或者加载该内容，触发应用程序中的 WebView 组件。
2.  **漏洞触发：** WebView 组件在处理恶意内容时，由于没有进行充分的输入验证，导致恶意代码得以执行。
3.  **代码执行：** 执行的恶意代码可以在应用程序的上下文中运行，从而获得对智能家居设备的控制权限，或窃取用户数据。

**缓解措施：**
*   升级到最新版本的小米智能家居应用程序。
*   避免点击不明来源的链接和加载不明来源的内容。
*   小米官方应加强对 WebView 组件的输入验证，防止恶意代码执行。

**项目地址:** [Edwins907/-CVE-2024-45352](https://github.com/Edwins907/-CVE-2024-45352)

**漏洞详情:** [CVE-2024-45352](https://nvd.nist.gov/vuln/detail/CVE-2024-45352)