## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP 的 iControl REST API 身份验证绕过漏洞。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行任意命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，可以确认该漏洞是有效的。搜索引擎结果中的多个链接（例如，CISA的 advisory，Palo Alto Networks的分析，以及Picus Security的模拟）都表明该漏洞已被积极利用，并可能导致远程代码执行。

**投毒风险：**
提供的 POC 代码非常简单，仅包含一个 curl 命令，用于测试漏洞的存在。该命令执行 "id" 命令，用于验证是否能够执行任意命令。 仓库中只包含一个简单的说明文件，没有发现任何隐藏的恶意代码或意图。因此，投毒风险很低，可以认为接近于0%。POC 代码主要是利用漏洞实现远程命令执行。

**利用方式：**
1.  攻击者发送一个包含特定header的HTTP请求到受影响的F5 BIG-IP设备的iControl REST API端点 `/mgmt/tm/util/bash`。
2.  关键的header包括:
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (尽管是认证header,但会被绕过)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
3.  请求体包含要执行的命令，例如 `{"command":"run","utilCmdArgs":"-c id"}`。
4.  由于身份验证绕过漏洞，BIG-IP设备会执行请求体中的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞执行任意命令，从而完全控制受影响的系统。

**项目地址:** [On-Cyber-War/CVE-2022-1388](https://github.com/On-Cyber-War/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)