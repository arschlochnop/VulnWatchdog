## CVE-2024-8636-Chrome-Skia堆缓冲区溢出

**漏洞编号:** CVE-2024-8636

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Google Chrome

**危害等级:** 高危，可能导致堆损坏和远程代码执行

**影响版本:** < 128.0.6613.137

**利用条件:** 需要用户打开特制的HTML页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-8636 是 Google Chrome 浏览器 Skia 组件中的一个堆缓冲区溢出漏洞。攻击者可以通过构造恶意的 HTML 页面来触发该漏洞，从而可能导致堆损坏，最终导致远程代码执行。

**有效性：**
根据提供的漏洞利用代码，该漏洞可以通过以下步骤重现：
1.  将 `chromium.diff` 补丁应用于 Chromium 源代码。
2.  运行 `genskpic.py` 生成 `drawable_picture.skp.hh`，然后将其移动到 `src/gpu/command_buffer/client`。
3.  构建并启动浏览器。
4.  打开 `index.html` 触发 PoC。
5.  GPU 进程将会崩溃。

`chromium.diff` 文件修改了 `gpu/command_buffer/client/raster_implementation.cc` 文件，在 `RasterImplementation::UnmapRasterCHROMIUM` 函数中添加了一段代码，用于创建和填充 GPU 共享内存缓冲区。这段代码看起来是为了触发 Skia 组件中的一个漏洞。通过修改后的chromium代码，可以触发GPU进程崩溃，说明POC代码具有一定有效性

**投毒风险：**
在提供的代码中，`chromium.diff` 补丁看起来像是漏洞利用的必要部分，并包含一些可能用于控制堆分配的代码。然而， `genskpic.py` 这个脚本的代码并没有提供，所以无法确定这个脚本是否有隐藏的恶意代码。

仔细分析 `chromium.diff` 文件。其中创建了两个共享内存buffer: `rasterBuffer`和`fontBuffer`。并且使用硬编码的数据 `kOpData`，`kCreateGPUProcessTypefaceBytestreamBegin`和 `kSkiaPictureBytes` 来填充`fontBuffer`。代码的逻辑复杂程度较高,没有明显直接的后门代码。 但是依然存在风险， 因为缺少 `genskpic.py` 脚本，不能完全排除投毒的可能性。

综合考虑，投毒风险预估为10%。

**利用方式：**
利用方式如下：
1.  攻击者需要构造一个恶意的 HTML 页面，该页面会触发 Skia 组件中的堆缓冲区溢出漏洞。
2.  当用户使用 Chrome 浏览器打开该页面时，Skia 组件会尝试处理恶意数据，从而导致堆缓冲区溢出。
3.  攻击者可以利用堆缓冲区溢出漏洞来覆盖堆上的其他数据，从而控制程序的执行流程。
4.  最终，攻击者可以利用该漏洞来执行任意代码。

**项目地址:** [HyHy100/Chrome-Skia-CVE-2024-8636](https://github.com/HyHy100/Chrome-Skia-CVE-2024-8636)

**漏洞详情:** [CVE-2024-8636](https://nvd.nist.gov/vuln/detail/CVE-2024-8636)