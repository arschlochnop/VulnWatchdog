## CVE-2017-7529-Nginx Range Filter Integer Overflow

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 整数溢出

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2

**利用条件:** 目标服务器运行受影响的Nginx版本，且启用了range filter模块，存在可访问的资源。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7529是Nginx range filter模块中的一个整数溢出漏洞。通过构造畸形的HTTP Range请求头，可以触发整数溢出，导致Nginx返回超出预期范围的数据，从而泄露敏感信息，例如缓存文件头等。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞存在于Nginx 0.5.6到1.13.2版本。提供的POC代码利用Python编写，通过发送特制的Range请求，尝试触发整数溢出。根据代码逻辑，首先获取Content-Length，然后构造畸形的Range头，如果服务器返回206状态码且响应包含Content-Range，则认为存在漏洞，之后尝试读取并hexdump泄露的数据。POC代码的有效性较高，因为该漏洞已经公开，并且有公开的利用代码。

**投毒风险：**
分析提供的POC代码和README.md文件，该仓库主要包含漏洞利用脚本和一个简单的README。没有发现明显的恶意代码或后门。但仍然存在一些风险：
*   **依赖风险：** 脚本依赖 colorama 和 termcolor 库，攻击者可能通过篡改依赖进行投毒。
*   **利用方式篡改：** 攻击者可能修改利用方式，造成拒绝服务攻击或更严重的后果。
*   **误导性信息：** README.md 可能包含误导性信息，例如错误的用法示例，引导用户执行错误的操作。

综合评估，该仓库存在一定的投毒风险，估计为10%。 主要风险在于依赖包的潜在风险,以及利用脚本被修改成其他攻击方式的可能性。

**利用方式：**
1.  **确定目标Nginx版本：** 确认目标服务器运行的Nginx版本在受影响的范围内（0.5.6 - 1.13.2）。
2.  **下载POC代码：** 从GitHub仓库下载CVE-2017-7529的POC代码。
3.  **安装依赖：** 安装POC代码所需的Python依赖库，例如requests, colorama和termcolor。
4.  **运行POC脚本：** 使用Python解释器运行POC脚本，并提供目标URL作为参数。
5.  **分析输出：** 观察脚本的输出，如果目标服务器被判断为易受攻击，脚本将尝试泄露敏感信息并以十六进制格式显示。

该漏洞利用成功的关键在于构造正确的Range请求头，以触发整数溢出。POC代码中已经包含了构造Range请求头的逻辑，用户只需要提供目标URL即可。

**项目地址:** [Shehzadcyber/CVE-2017-7529](https://github.com/Shehzadcyber/CVE-2017-7529)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)