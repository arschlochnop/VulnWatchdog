## CVE-2020-13405-Microweber-用户数据库泄露

**漏洞编号:** CVE-2020-13405

**漏洞类型:** 信息泄露

**影响应用:** Microweber

**危害等级:** 中危，可能导致用户凭据泄露

**影响版本:** < 1.1.20

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Microweber 1.1.20之前的版本中。未经身份验证的攻击者可以通过向`/modules/`发起POST请求，触发`userfiles/modules/users/controller/controller.php`中的漏洞，从而泄露用户数据库信息。

**有效性：**根据漏洞描述，搜索引擎结果和GitHub上的POC仓库`mrnazu/CVE-2020-13405`，该漏洞利用是有效的，通过发送特定的POST请求即可获取用户数据库信息。

**投毒风险：**提供的漏洞利用代码只有一段GPL协议，无法判断是否包含投毒代码。但根据链接https://github.com/mrnazu/CVE-2020-13405，该仓库展示了利用`dd(User::all())`来dump用户数据库信息的代码，是一个合法的漏洞验证代码。从协议文本本身看，没有发现恶意代码。但是不排除其他文件存在恶意代码的可能性，这里设定为1%。

**利用方式：**
1.  攻击者无需身份验证。
2.  攻击者构造一个POST请求，目标是`/modules/`。
3.  服务器端`/userfiles/modules/users/controller/controller.php`处理该请求时，由于漏洞存在，直接返回了所有用户数据。
4.  攻击者获取包含用户凭据等敏感信息的数据库内容。

**项目地址:** [mrnazu/CVE-2020-13405](https://github.com/mrnazu/CVE-2020-13405)

**漏洞详情:** [CVE-2020-13405](https://nvd.nist.gov/vuln/detail/CVE-2020-13405)