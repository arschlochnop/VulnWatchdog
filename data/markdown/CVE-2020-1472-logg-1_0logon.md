## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的权限提升漏洞。未经身份验证的攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。攻击成功后，攻击者可以在网络设备上运行特制的应用程序，最终获得域管理员权限，完全控制域。

**漏洞利用方式：**

1.  **建立连接：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零化凭据：**  攻击者发送一个所有位均为零的凭据和挑战，利用Netlogon协议中的加密缺陷。
3.  **密码重置：**  如果身份验证绕过成功，攻击者将尝试将域控制器的机器帐户密码重置为空。
4.  **提权：** 使用重置后的空密码或修改后的密码，攻击者可以冒充域控制器，窃取域凭据并接管域。

**有效性：**

提供的POC代码是有效的，因为它利用了Netlogon协议中的加密漏洞，允许攻击者将域控制器的机器帐户密码重置为空，从而获得域管理员权限。搜索结果中的多个链接表明该漏洞已广泛传播，并且存在可用的利用代码。

**投毒风险：**

经过分析，提供的POC代码本身没有发现明显的恶意投毒代码。该脚本的主要功能是利用漏洞进行身份验证绕过和密码重置。脚本相对简洁，目标明确，没有发现任何尝试执行额外恶意操作的代码。

**结论：**

CVE-2020-1472是一个严重的安全漏洞，攻击者可以利用它完全控制Windows Server域。提供的POC代码可以有效利用此漏洞。根据代码的审查，未发现投毒风险。

**项目地址:** [logg-1/0logon](https://github.com/logg-1/0logon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)