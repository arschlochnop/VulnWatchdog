## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)