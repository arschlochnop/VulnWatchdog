## CVE-2025-24893-XWiki-远程代码执行

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 小于15.10.11，小于16.4.1，以及小于16.5.0RC1的版本

**利用条件:** 目标XWiki实例可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24893 是一个 XWiki 平台中的远程代码执行漏洞。未经身份验证的攻击者可以通过向 `SolrSearch` 发送请求来执行任意代码。漏洞原因是 SolrSearch 宏中对用户输入验证不足，导致可以通过注入 Groovy 代码来执行任意命令。 

**利用方式：**

1.  **构建恶意请求：** 攻击者构造包含恶意 Groovy 代码的 URL，该代码将作为参数传递给 `SolrSearch` 宏。
2.  **发送请求：** 将构建的 URL 发送到易受攻击的 XWiki 实例。
3.  **代码执行：** XWiki 实例执行注入的 Groovy 代码，从而允许攻击者执行任意命令。

提供的 PoC 代码首先确定目标 URL 的协议 (HTTP 或 HTTPS)，然后构建包含要执行的命令的 payload，并将其 URL 编码。 该 payload 被注入到发送到 `/bin/get/Main/SolrSearch` 端点的请求中。响应被解析以提取命令的输出。

**有效性：**

根据漏洞库信息和搜索引擎结果，PoC 代码应有效，因为该漏洞允许未经身份验证的远程代码执行。

**投毒风险：**

PoC 代码包含一个MIT协议的开源许可，并且 README.md 文件声明该代码仅用于教育和授权渗透测试目的，明确指出提供“非破坏性的 PoC 脚本”。

该代码包含以下安全措施，降低了恶意使用的风险：

*   `build_command_payload` 函数使用 `urllib.parse.quote` 对 payload 进行 URL 编码，这可以防止某些类型的注入攻击。
*   `extract_output` 函数使用正则表达式来提取输出，这可以防止恶意代码被执行。

代码中没有发现任何隐藏的后门或恶意代码。因此，投毒风险为 0%。

**项目地址:** [The-Red-Serpent/CVE-2025-24893](https://github.com/The-Red-Serpent/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)