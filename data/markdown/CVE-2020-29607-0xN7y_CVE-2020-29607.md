## CVE-2020-29607-Pluck CMS-文件上传绕过导致远程代码执行

**漏洞编号:** CVE-2020-29607

**漏洞类型:** 文件上传绕过

**影响应用:** Pluck CMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.7.13

**利用条件:** 需要管理员权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Pluck CMS 4.7.13之前的版本中。具有管理员权限的用户可以通过"manage files"功能绕过文件上传限制，上传包含恶意PHP代码的phar文件，从而实现远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，利用提供的PoC脚本`CVE-2020-29607.py`，需要提供Pluck CMS的URL和管理员密码。该脚本会尝试使用提供的凭据登录到Pluck CMS后台。
2.  **上传恶意文件：** 成功登录后，脚本构造一个包含恶意PHP代码的phar文件，该文件包含一个`system($_GET["a"])`，允许通过GET参数`a`执行任意命令。然后，脚本使用构造的multipart/form-data请求将该文件上传到服务器的`files`目录下，绕过了文件上传限制。
3.  **远程代码执行：**  一旦文件上传成功，脚本构造一个GET请求，访问上传的phar文件，并在`a`参数中指定要执行的系统命令。服务器执行该命令并将结果返回给攻击者。

**有效性：**

提供的PoC代码看起来有效，因为它模拟了管理员登录过程，构造了恶意文件上传请求，并发送带有命令执行参数的GET请求来触发漏洞。

**投毒风险：**

检查了PoC脚本`CVE-2020-29607.py`和`README.md`。未发现任何明显的投毒代码。该脚本的功能仅限于利用该漏洞进行远程代码执行，没有额外的恶意行为。该漏洞利用代码的主要作用是上传包含`<?php system($_GET["a"]); ?>` 的`shell1.phar`文件，该文件是漏洞利用的核心，本身并非恶意代码，而是用于触发漏洞的后门。因此，投毒风险评估为0%。

**项目地址:** [0xN7y/CVE-2020-29607](https://github.com/0xN7y/CVE-2020-29607)

**漏洞详情:** [CVE-2020-29607](https://nvd.nist.gov/vuln/detail/CVE-2020-29607)