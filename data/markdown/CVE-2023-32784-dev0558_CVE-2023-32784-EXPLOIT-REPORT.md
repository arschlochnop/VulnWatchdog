## CVE-2023-32784-KeePass Master Password Recovery

**漏洞编号:** CVE-2023-32784

**漏洞类型:** 内存泄漏

**影响应用:** KeePass

**危害等级:** 高危，可能导致凭据泄露

**影响版本:** 2.x before 2.54

**利用条件:** 需要能够访问系统的内存镜像（例如，进程dump、交换文件、休眠文件或RAM dump）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32784 存在于 KeePass 2.x 2.54之前版本中，由于不正确地处理内存中的字符串，主密码的每个字符都会在内存中留下痕迹。攻击者可以从内存镜像（例如，`pagefile.sys`，`hiberfil.sys`或直接RAM dump）中提取这些痕迹，从而恢复主密码（除第一个字符外）。

**利用方式：**

1.  获取KeePass进程的内存dump文件（.DMP）。这可以通过多种方式实现，例如使用任务管理器或其他调试工具。
2.  使用 KeePass Master Password Dumper 工具（PoC 代码），该工具通过模式识别从内存dump中提取密码字符。
3.  运行该工具，指定内存dump文件作为输入。
4.  该工具会输出恢复的主密码，除了第一个字符。

**投毒风险分析：**

查看提供的POC代码，主要是利用了KeePass的内存处理缺陷，通过dotnet运行对DMP文件进行分析。虽然代码本身是为了演示漏洞利用，但是仍然存在一定的投毒风险。例如作者在github仓库中添加一些恶意的依赖项或修改PoC代码，来获取用户的系统信息，或者植入恶意代码。但由于漏洞原理明确，且代码相对简单，因此风险较低，预估投毒风险为10%。建议在使用PoC代码之前，进行代码审计，并在隔离环境中运行。

**有效性：**
根据漏洞描述和PoC代码，此漏洞利用是有效的。搜索结果也确认了此漏洞的存在以及相应的利用方法。PoC 通过分析内存dump文件来恢复 KeePass 的主密码，这与漏洞描述相符。


**项目地址:** [dev0558/CVE-2023-32784-EXPLOIT-REPORT](https://github.com/dev0558/CVE-2023-32784-EXPLOIT-REPORT)

**漏洞详情:** [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-32784)