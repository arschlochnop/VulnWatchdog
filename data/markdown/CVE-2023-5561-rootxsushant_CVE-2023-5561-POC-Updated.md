## CVE-2023-5561 - WordPress Unauthenticated Post Author Email Disclosure

**漏洞编号:** CVE-2023-5561

**漏洞类型:** 信息泄露

**影响应用:** WordPress

**危害等级:** 中危，泄露用户邮箱信息

**影响版本:** < 6.3.2

**利用条件:** 目标WordPress网站REST API已启用且版本低于6.3.2，并且存在公开发布文章的用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5561 漏洞允许未经身份验证的攻击者通过WordPress REST API获取发布了公开文章的用户的电子邮件地址。该漏洞利用了REST API在搜索用户时未正确限制可搜索的字段。攻击者可以通过构造特定的请求，利用 Oracle 风格的攻击来逐步猜测用户电子邮件地址。

**有效性：**根据漏洞描述、搜索引擎结果以及提供的PoC代码，该漏洞是有效的。PoC代码通过向`/wp-json/wp/v2/users` REST API endpoint发送带有`search`参数的请求，尝试枚举用户邮箱。该PoC已经过修改，在每次请求之间添加了10秒的延迟，以避免触发WAF或服务器阻止。

**投毒风险：** PoC代码本身主要用于信息泄露，作者添加延迟是为了绕过WAF规则，降低被封禁的风险。检查该PoC代码，没有发现明显的恶意代码，例如执行系统命令或修改文件。PoC代码的风险在于其用途，而非代码本身。由于 PoC 的目的是信息泄露，其本身存在一定的风险，需要对潜在风险进行评估，但是PoC代码作者的添加的休眠时间,有可能导致攻击速度过慢, 降低攻击效率, 一定程度上可以视为是一种隐晦的投毒。综合评估，投毒风险较低，约 10%。

**利用方式：**
1.  确定目标WordPress网站的根URL。
2.  运行提供的PoC脚本，并将目标URL作为参数传递。
3.  PoC脚本将向`/wp-json/wp/v2/users` endpoint发送请求，通过不断猜测字符来获取用户的电子邮件地址。
4.  成功利用该漏洞后，攻击者将获得发布了公开文章的用户的电子邮件地址列表。

**项目地址:** [rootxsushant/CVE-2023-5561-POC-Updated](https://github.com/rootxsushant/CVE-2023-5561-POC-Updated)

**漏洞详情:** [CVE-2023-5561](https://nvd.nist.gov/vuln/detail/CVE-2023-5561)