## CVE-2025-53770-Microsoft SharePoint Server-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问和目标SharePoint服务器未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于未经验证的数据反序列化而产生。攻击者可以发送特制的请求到 SharePoint 服务器，从而执行任意代码。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞已经被积极利用，并且存在公开的 POC 代码，因此判断提供的POC代码有效。

**投毒风险：**
POC代码包含一个经过编码的 ExcelDataSet (CompressedDataTable)。
分析这个Base64编码并解压缩的数据流，需要对SharePoint的序列化机制有深入的了解。虽然目前无法通过代码直接分析压缩数据中是否包含恶意后门，但payload的整体结构是符合利用CWE-502进行RCE的思路的,因为攻击的本质是利用可控的反序列化数据流来实现RCE。所以初步判断，存在投毒代码的概率较低，但不能完全排除。
投毒风险初步评估为10%， 主要风险在于：
1.  `CompressedDataTable` 内部可能包含恶意代码。

**利用方式：**
1.  攻击者发送包含特制 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数的POST请求到 `/ToolPane.aspx` 页面。
2.  `MSOTlPn_Uri` 参数指向一个恶意的ASCX控件。
3.  `MSOTlPn_DWP` 参数包含经过压缩和Base64编码的序列化数据。
4.  SharePoint服务器在处理该请求时，会反序列化`CompressedDataTable`，如果其中包含恶意代码，则会导致远程代码执行。

利用的关键在于构造恶意的序列化数据，使其在反序列化过程中执行攻击者预期的代码。

**项目地址:** [kaizensecurity/CVE-2025-53770](https://github.com/kaizensecurity/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)