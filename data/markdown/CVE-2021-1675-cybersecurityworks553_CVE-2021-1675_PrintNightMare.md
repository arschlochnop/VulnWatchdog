## CVE-2021-1675 PrintNightmare Windows Print Spooler RCE

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 攻击者需要能够访问目标系统的打印服务。某些利用方式可能需要域环境。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在受影响的系统上以SYSTEM权限执行任意代码。

**有效性：**
搜索结果表明该漏洞存在公开的PoC代码，并且被CISA列入已知被利用的漏洞目录中，因此该漏洞的利用是有效的。

**投毒风险：**
提供的漏洞利用代码片段仅仅是一个GNU GPL许可协议，无法判断其投毒风险，但根据经验判断真实攻击场景中，存在攻击者将恶意payload与正常PoC代码捆绑，或者提供修改后的PoC，存在一定的投毒风险。这里给出的1%风险主要来源于license文件本身可能存在的细微编码问题，或者说该LICENSE被用在恶意的地方。

**利用方式：**
根据搜索结果和漏洞描述，利用方式通常涉及以下步骤：

1.  **利用`RpcAddPrinterDriverEx`函数 (或类似函数):** 攻击者通过该函数向Print Spooler服务添加恶意的打印机驱动程序。
2.  **DLL注入：** 恶意驱动程序实际上是一个DLL，当Print Spooler服务尝试加载该驱动程序时，攻击者的代码会被注入到spoolsv.exe进程中。
3.  **代码执行：** 由于spoolsv.exe以SYSTEM权限运行，因此攻击者注入的代码也会以SYSTEM权限执行，从而完全控制系统。

一些利用方式可能需要身份验证，但其他一些方式则不需要，尤其是在域环境中。根据搜索结果，最初发布的补丁可能并不完全修复该漏洞，导致出现CVE-2021-34527。

总之，攻击者通过精心构造的打印机驱动程序和对Print Spooler服务的利用，可以实现远程代码执行。

**项目地址:** [cybersecurityworks553/CVE-2021-1675_PrintNightMare](https://github.com/cybersecurityworks553/CVE-2021-1675_PrintNightMare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)