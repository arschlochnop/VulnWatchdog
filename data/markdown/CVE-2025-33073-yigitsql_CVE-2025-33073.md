## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本及版本范围在漏洞库信息中已列出

**利用条件:** 需要攻击者在网络中，并具有一定的权限。目标系统需启用SMB服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。根据漏洞库信息，未经适当访问控制的Windows SMB组件允许经过身份验证的攻击者在网络上提升权限。搜索引擎结果显示该漏洞利用了NTLM反射绕过，利用POC代码的github仓库已经存在。提供的POC代码（main.go）是一个用Go编写的HTTP Kerberos Relay Server，它接收带有Negotiate头的HTTP请求，提取Kerberos令牌，然后打印令牌长度。这个PoC缺少实际的SMB relay攻击逻辑，只实现了接受和解析Kerberos认证的初步框架。servers/dnsrelay.go是DNS中继服务器框架代码,暂时没有被main.go引用。因此，提供的PoC**不完整**，仅能作为漏洞利用的起点。PoC完整性取决于之后是否添加了完整的利用链。 投毒风险分析：提供的PoC代码主要是一个HTTP Kerberos Relay Server，用于接收和解析Kerberos票据。虽然代码本身没有明显的恶意行为，但如果攻击者修改此代码，例如在处理Kerberos票据时执行恶意操作，或者在DNS中继服务器中进行恶意DNS解析，则可能存在投毒风险。目前代码只是一个框架，存在被植入后门的可能，因此判定投毒风险为10%。 利用方式：攻击者首先需要设置一个恶意的SMB服务器或者劫持一个合法的SMB服务器。然后，诱骗受害者连接到该服务器。服务器通过NTLM反射或其他方法，迫使受害者客户端向攻击者控制的Kerberos Relay Server进行身份验证。 Relay Server接收到Kerberos票据后，利用此票据在目标网络上执行提升权限的操作。具体的操作可能包括访问敏感资源或执行特权命令。 总而言之，该漏洞的利用涉及中间人攻击和Kerberos协议的滥用。

**项目地址:** [yigitsql/CVE-2025-33073](https://github.com/yigitsql/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)