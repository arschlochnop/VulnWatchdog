## CVE-2024-38475_SonicBoom_Apache_URL_Traversal

**漏洞编号:** CVE-2024-38475

**漏洞类型:** URL 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致代码执行或源代码泄露

**影响版本:** <= 2.4.59

**利用条件:** mod_rewrite 模块启用且存在不安全的 RewriteRules 配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-38475 是 Apache HTTP Server 中 mod_rewrite 模块的一个 URL 路径遍历漏洞。不正确的输出转义允许攻击者将 URL 映射到服务器允许提供的文件系统位置，但这些位置并非有意或直接通过任何 URL 访问。涉及服务器上下文中将反向引用或变量用作替换的第一个段的替换受到影响。搜索结果表明该漏洞已被积极利用，例如在SonicWall SMA 设备的漏洞利用链中。提供的 PoC 代码 (CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC) 通过自动化 TLS 协商、目录扫描、遍历验证和有效载荷模糊测试来检测未经授权的文件访问。它首先确定服务器支持的最高 TLS/SSL 协议，然后验证目录遍历行为，扫描受 403 保护的目录，确认每个目录的遍历漏洞，并使用自定义有效载荷模糊化文件路径以检测实际泄漏。autoCurl.py 辅助脚本检测目标是否允许PUT方法。投毒风险较低，主要存在于任何来自外部源的代码中，例如恶意目录/文件文字表可能会被植入后门，但是总体比例很小。考虑到样本文件LICENSE声明了MIT开源协议，存在投毒的可能性极低。

**利用方式：**
1.  **漏洞触发:** 攻击者构造包含特殊字符（如 `%2e%2e/` 或 `%2e%2e%5C`）的恶意 URL，利用 mod_rewrite 模块中不正确的转义，尝试访问受保护的文件或目录。
2.  **路径遍历:** 恶意 URL 绕过访问控制，将 URL 映射到服务器根目录之外的文件系统位置。
3.  **信息泄露/代码执行:** 如果成功，攻击者可以读取敏感文件（如源代码、配置文件）或执行服务器上的恶意代码。

**简而言之，攻击者可以通过精心设计的 URL，绕过服务器的安全检查，读取或执行受保护的资源。**

**项目地址:** [abrewer251/CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC](https://github.com/abrewer251/CVE-2024-38475_SonicBoom_Apache_URL_Traversal_PoC)

**漏洞详情:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)