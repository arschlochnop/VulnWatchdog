## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全被控制

**影响版本:** <= 1.11.24

**利用条件:** 需要目标服务器运行Chamilo LMS，且版本在受影响范围内。攻击者需要能够通过网络访问目标服务器的`/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个未授权文件上传漏洞，位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中。未经身份验证的攻击者可以通过上传恶意文件（如 webshell）来执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** `bigUpload.php` 文件处理大文件上传功能时，未对上传的文件类型进行严格的验证，允许上传具有危险类型的文件，如 PHP 文件。
2.  **利用步骤：**
    *   攻击者使用提供的 `exploit.py` 脚本，指定目标 Chamilo LMS 实例的 URL 和要上传的 webshell 文件。
    *   脚本将 webshell 文件通过 POST 请求发送到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 路径。
    *   如果上传成功，攻击者可以通过访问上传的 webshell 文件来执行任意代码。

3.  **有效性分析：** 根据漏洞描述和搜索引擎结果，该漏洞的 POC 代码是有效的，可以实现远程代码执行。

4.  **投毒风险分析：**
    *   `exploit.py` 脚本是一个简单的文件上传脚本，主要功能是发送 POST 请求，上传指定的文件到目标 URL。代码本身没有发现任何可疑或恶意的行为。
    *   `README.md` 文件仅包含脚本的使用说明，没有包含任何可执行代码或恶意链接。
    *   因此，该仓库中存在投毒代码的可能性较低，可以判断投毒风险为0%。

5.  **利用方式总结：**
    *   **目标：** Chamilo LMS <= 1.11.24
    *   **漏洞：** 未授权文件上传 (CVE-2023-4220)
    *   **攻击方式：** 使用 `exploit.py` 脚本上传 webshell 到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`，然后访问 webshell 执行任意代码。

**项目地址:** [zora-beep/CVE-2023-4220](https://github.com/zora-beep/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)