## CVE-2024-3661 - TunnelVision VPN Bypass

**漏洞编号:** CVE-2024-3661

**漏洞类型:** VPN绕过

**影响应用:** VPN客户端

**危害等级:** 高危，可能导致敏感数据泄露，流量被窃听或篡改

**影响版本:** 受影响的VPN客户端依赖于DHCP的路由配置

**利用条件:** 攻击者需要位于与目标客户端相同的局域网内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3661（TunnelVision）漏洞允许攻击者通过恶意配置的DHCP服务器绕过VPN连接，迫使流量泄漏到物理接口。该漏洞利用了DHCP协议的121选项（classless static route option），攻击者通过发送包含恶意路由信息的DHCP Offer，修改受害者客户端的路由表，将原本应该通过VPN隧道传输的流量重定向到攻击者控制的网络。提供的POC代码包含两个Python脚本：`dhcp_server.py`用于发送包含恶意路由选项的DHCP Offer，`dhcp_starvation.py` 用于耗尽DHCP服务器的IP地址池，增加攻击者恶意DHCP Offer被接受的可能性。`dhcp_server.py`脚本构造了一个包含option 121的DHCP Offer数据包，其中包含将特定目标（例如8.8.8.8，10.1.16.0/22，10.1.20.0/24）的流量路由到攻击者控制的网关（192.168.1.186）的路由条目。攻击者需要位于与目标客户端相同的局域网内，并运行此脚本。`dhcp_starvation.py`脚本通过发送大量伪造MAC地址的DHCP Discover请求，耗尽DHCP服务器的可用IP地址，从而增加目标客户端接受恶意DHCP Offer的可能性。根据分析，提供的POC代码主要目的是演示漏洞利用过程，没有发现隐藏的恶意代码或后门，因此投毒风险为0%。利用方式：攻击者首先可以使用dhcp_starvation.py耗尽局域网内合法DHCP服务器的地址资源，然后运行dhcp_server.py脚本，发送带有恶意路由选项（Option 121）的DHCP Offer，诱使目标VPN客户端将流量路由到攻击者控制的网关，从而绕过VPN。

**项目地址:** [Wh1t3Fox/CVE-2024-3661](https://github.com/Wh1t3Fox/CVE-2024-3661)

**漏洞详情:** [CVE-2024-3661](https://nvd.nist.gov/vuln/detail/CVE-2024-3661)