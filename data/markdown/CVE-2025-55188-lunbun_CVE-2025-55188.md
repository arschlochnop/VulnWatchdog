## CVE-2025-55188-7-Zip-符号链接处理不当

**漏洞编号:** CVE-2025-55188

**漏洞类型:** 符号链接处理不当

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致任意文件写入和代码执行

**影响版本:** < 25.01

**利用条件:** 需要用户解压恶意构造的压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-55188 是 7-Zip 在 25.01 版本之前存在的一个符号链接处理不当漏洞。攻击者可以构造包含恶意符号链接的压缩文件，当用户使用存在漏洞的 7-Zip 版本解压该文件时，符号链接可能被不正确地解析，导致文件被写入到预期之外的位置，进而可能导致任意文件写入甚至代码执行。

**漏洞利用方式：**

1.  **POC分析：** 提供的POC代码 `poc_vrt` 目录下的 `rce.py` 脚本用于生成一个恶意的 `rce.tar` 文件。这个tar文件包含精心构造的符号链接，旨在利用7-Zip的符号链接处理缺陷。
2.  **利用 `rce.tar` 文件:**  
    *   文件 `a/b/link` 是一个指向 `/a` 的符号链接。
    *   文件 `link` 是一个指向 `a/b/link/../../` 的符号链接。这个链接巧妙地利用相对路径，试图跳出提取目录。
    *   文件 `link/.bash_aliases` 包含恶意代码，会在每次打开新的bash终端时执行，实现RCE（远程代码执行）。
3.  **攻击场景：** 当用户在类似 `~/extract` 的目录下解压 `rce.tar` 时，`link/.bash_aliases` 文件会被写入到 `~/.bash_aliases`，而不是 `~/extract/link/.bash_aliases`。 下次用户打开新的终端时，恶意代码会被执行。

**有效性：**
根据漏洞信息、搜索结果和提供的POC代码，可以判断该漏洞是有效的。多个来源（NVD、安全博客等）都确认了该漏洞的存在，并提供了补丁版本。POC代码也提供了可行的利用方式。

**投毒风险：**

根据 `rce.py` 脚本,发现该文件会写入 `.bash_aliases` 文件,会造成每次启动终端都会执行脚本,危害比较大,可能上传者上传了其他恶意的利用脚本到代码仓库中,故风险存在,但 `rce.py` 本身是漏洞验证代码,不属于投毒代码。综合评估投毒风险为10%。


**项目地址:** [lunbun/CVE-2025-55188](https://github.com/lunbun/CVE-2025-55188)

**漏洞详情:** [CVE-2025-55188](https://nvd.nist.gov/vuln/detail/CVE-2025-55188)