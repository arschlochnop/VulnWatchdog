## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)