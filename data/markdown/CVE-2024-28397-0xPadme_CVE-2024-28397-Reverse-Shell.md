## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 目标存在js2py且开启了相关API接口（如/run_code），需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于js2py的js2py.disable_pyimport() 组件中，允许攻击者通过精心构造的API调用执行任意代码。漏洞利用方式为：

1.  **漏洞描述：** CVE-2024-28397 允许攻击者绕过 js2py 的沙箱限制，从而执行任意 Python 代码。
2.  **利用方式：** 攻击者向目标服务器的 `/run_code` 路径发送一个 POST 请求，请求体为 JSON 格式，其中包含 `code` 字段，该字段的值为一段 JavaScript 代码，该 JavaScript 代码利用 js2py 的特性来逃逸沙箱并执行系统命令。
3.  **POC 分析：**  POC 代码通过 JavaScript 代码获取 `__getattribute__` 方法，然后使用该方法获取 `__class__` 和 `__base__` 属性，从而获取到 Python 的基类。然后，POC 代码定义了一个 `findpopen` 函数，该函数递归地搜索 `__subclasses__` 属性，直到找到 `subprocess.Popen` 类。最后，POC 代码使用 `Popen` 类执行任意命令，例如，使用 `busybox nc` 建立反向 shell。
4.  **有效性：**  提供的POC代码是有效的，可以用于在目标系统上执行任意代码。
5.  **投毒风险：** 投毒风险较低。README.md描述了使用方法，exploit.py 脚本清晰地展示了漏洞利用过程。虽然存在少量变量名和结构可能增加阅读难度，但总体而言代码逻辑清晰，没有发现明显的恶意代码或隐藏后门。风险主要来自于目标系统的安全配置和网络环境，而非 exploit 本身。
6.  **搜索引擎结果：** 由于没有提供搜索引擎结果，因此无法基于搜索结果进行分析。


**项目地址:** [0xPadme/CVE-2024-28397-Reverse-Shell](https://github.com/0xPadme/CVE-2024-28397-Reverse-Shell)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)