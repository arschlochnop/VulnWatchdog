## CVE-2025-2294 - Kubio AI Page Builder <= 2.5.1 - 未经身份验证的本地文件包含

**漏洞编号:** CVE-2025-2294

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Kubio AI Page Builder WordPress 插件

**危害等级:** 严重，可能导致敏感数据泄露和远程代码执行

**影响版本:** <= 2.5.1

**利用条件:** 目标WordPress站点安装了存在漏洞的Kubio AI Page Builder插件，且允许未经身份验证的访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2294 是 Kubio AI Page Builder WordPress 插件中的一个未经身份验证的本地文件包含 (LFI) 漏洞，影响版本 <= 2.5.1。攻击者可以通过发送特制的 GET 请求利用此漏洞读取服务器上的任意文件，从而可能导致敏感信息泄露或通过包含恶意文件执行任意代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断此漏洞是有效的。漏洞库中明确指出了LFI漏洞的存在，搜索引擎结果中也包含了多个关于此CVE的描述和讨论。提供的PoC代码包含了一个Python扫描器和一个 nuclei 模板，用于检测和利用该漏洞。其中 `kubio-cve-2025-2294_active.yaml` 模板通过尝试读取 `/etc/passwd` 文件来验证漏洞是否存在。

**投毒风险分析：**

提供的PoC代码主要包含以下文件：

*   `README.md`: 描述了仓库内容。
*   `kubio-cve-2025-2294_active.yaml`: Nuclei模板，通过发送包含路径遍历的GET请求来尝试读取 `/etc/passwd` 文件，验证漏洞存在。
*   `kubio-cve-2025-2294_passive.yaml`: Nuclei模板，基于插件的`readme.txt`文件中的版本号来判断是否存在漏洞, 不会进行利用。
*   `scanner.py`: Python脚本，用于扫描目标是否存在漏洞，也是通过尝试读取 `/etc/passwd` 文件来验证漏洞存在。

潜在的投毒风险点可能存在于 `scanner.py` 脚本中，例如作者可能在代码中添加了额外的恶意功能，如收集目标信息、植入后门等。虽然目前的代码看起来比较直接，但是需要仔细检查以下几个方面：

1.  **外部依赖:** 脚本只使用了requests, re和urllib3库，这些都是常见的库，相对安全，但是仍需要确认是否引入了恶意版本。
2.  **异常处理:** 异常处理部分（`try...except`）可能被用于隐藏恶意行为。当前代码只是简单地忽略了异常，但是如果异常处理中包含恶意代码，则会构成威胁。
3.  **输出文件:** 脚本会将结果写入输出文件，需要确认输出内容是否被篡改，或者包含额外的恶意信息。
4.  **目标清理函数(clean_target):** 检查此函数是否存在对域名或URL的恶意篡改。

综合考虑，此仓库存在一定程度的投毒风险，约为10%。 风险主要集中在扫描器可能在漏洞验证之外，收集或者篡改信息。

**漏洞利用方式：**

1.  **确定目标WordPress站点是否安装了受影响的Kubio AI Page Builder插件，版本为 2.5.1 或更早。**
2.  **使用提供的PoC代码，例如 scanner.py 脚本或 nuclei 模板，发送包含路径遍历的GET请求。**
3.  **GET请求的格式为：`{BaseURL}/?__kubio-site-edit-iframe-preview=1&__kubio-site-edit-iframe-classic-template={payload}`，其中 `{BaseURL}` 是目标站点的URL，`{payload}` 是包含路径遍历的字符串，例如 `../../../../../../../../../etc/passwd`。**
4.  **如果服务器返回 `/etc/passwd` 文件的内容，则表明目标站点存在 LFI 漏洞。**
5.  **攻击者可以修改 `{payload}` 的值，读取其他敏感文件，例如 WordPress 的配置文件 `wp-config.php`，其中包含数据库连接信息。**
6.  **进一步，攻击者可以尝试上传包含 PHP 代码的图片或其他文件，然后通过 LFI 漏洞包含该文件，从而执行任意代码。**

**项目地址:** [romanedutov/CVE-2025-2294](https://github.com/romanedutov/CVE-2025-2294)

**漏洞详情:** [CVE-2025-2294](https://nvd.nist.gov/vuln/detail/CVE-2025-2294)