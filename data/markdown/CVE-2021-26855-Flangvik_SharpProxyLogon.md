## CVE-2021-26855 Microsoft Exchange Server Remote Code Execution Vulnerability (ProxyLogon)

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，未经身份验证的攻击者可以远程执行任意代码

**影响版本:** Microsoft Exchange Server 2013, 2016, and 2019 的多个累积更新版本（具体版本参考漏洞库信息）

**利用条件:** 目标系统必须运行受影响的 Microsoft Exchange Server 版本，且攻击者能够通过网络访问 Exchange Server 的端口（通常是 443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855（ProxyLogon）是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者利用此漏洞可以发送任意 HTTP 请求并伪装成 Exchange Server 本身进行身份验证。结合其他漏洞（例如CVE-2021-27065），可以实现远程代码执行。 

**有效性评估：**

提供的 C# POC 代码 `SharpProxyLogon` 利用了 ProxyLogon 漏洞链。根据 README.md 中的描述和示例，此 POC 允许攻击者绕过身份验证，并最终在目标 Exchange Server 上执行代码。 POC 提供了两种利用方式：一是通过 webshell 落地执行命令，二是通过 shellcode 注入到 `svchost.exe` 进程中。从示例输出结果来看，POC 能够成功获取目标系统的 SYSTEM 权限，表明该代码在未打补丁的系统上是有效的。

**投毒风险分析：**

代码仓库的主要文件是 `SharpProxyLogon.sln` 和 `SharpProxyLogon` 目录下的 C# 代码。根据 `README.md` 文件和代码结构来看，该 POC 主要用于利用 ProxyLogon 漏洞链进行 RCE，并没有明显的投毒迹象。虽然 `SharpProxyLogon` 使用了 `TikiTorch` 代码进行 shellcode 注入，但这是一种常见的技术，本身不构成投毒。但需要注意的是，任何来源不明的代码都存在潜在风险，攻击者可能修改或添加恶意代码。

**利用方式总结：**

1.  **SSRF (CVE-2021-26855):** 利用该漏洞，攻击者可以绕过身份验证，模拟 Exchange Server 的身份发送 HTTP 请求。
2.  **后端漏洞（例如 CVE-2021-27065）：** 结合其他漏洞，例如不安全的序列化或任意文件写入，攻击者可以执行任意代码。
3.  **Webshell 落地：** POC 可以将 webshell 写入到目标服务器的 Web 目录下，从而实现命令执行。
4.  **Shellcode 注入：** POC 还可以将 shellcode 注入到 `svchost.exe` 等进程中，执行更复杂的操作。

**搜索引擎结果分析：**

搜索结果证实了 CVE-2021-26855 的严重性和被广泛利用的情况。多个来源表明该漏洞是一个 SSRF 漏洞，允许未经验证的攻击者发送任意 HTTP 请求。该漏洞常与其他 Exchange Server 漏洞一起利用，形成 ProxyLogon 漏洞链，从而实现 RCE。

**项目地址:** [Flangvik/SharpProxyLogon](https://github.com/Flangvik/SharpProxyLogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)