## CVE-2023-27163 - Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个 SSRF 漏洞。攻击者可以利用 `/api/baskets/{name}` 组件，通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，此漏洞是有效的。多个来源确认了该漏洞的存在，并且提供了可利用的 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意 basket，通过修改 basket 的配置，将 ForwardUrl 设置为攻击者想要访问的内部资源地址。PoC 代码中的 `MakeMaliciousBasket` 函数实现了这个步骤，它向 `/api/baskets` 发送 POST 请求，创建带有恶意配置的 basket。
2.  一旦恶意 basket 创建成功，当 Request-Baskets 服务收到发送到该 basket 的请求时，它会尝试将请求转发到攻击者指定的 ForwardUrl。PoC 代码中 `OpenMaliciousBasket` 函数实现了发送请求到basket, 触发SSRF漏洞.
3. PoC 代码还尝试利用login接口执行命令 `ExecuteCommand`.

**投毒风险：**
虽然PoC的主要目的是演示SSRF，但仍然存在一定的投毒风险。风险点包括:
* `FORWARD_URL`常量，默认指向`http://127.0.0.1:80`。如果攻击者修改了此地址，可以引导受害者请求恶意站点。
* `ExecuteCommand`函数, 攻击者可以通过修改POST请求体中的`username`参数，注入恶意命令。`commandPayload = fmt.Sprintf(commandPayload, b64command)`
代码的免责声明暗示了作者不负责任的态度，也增加了代码存在潜在风险的可能性。综合评估，投毒风险估计为 20%。

**搜索引擎结果验证：**
搜索引擎结果提供了多个关于 CVE-2023-27163 的信息来源，进一步确认了漏洞的存在和影响。Github链接指向了此漏洞的EXP

**项目地址:** [thomas-osgood/CVE-2023-27163](https://github.com/thomas-osgood/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)