## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)