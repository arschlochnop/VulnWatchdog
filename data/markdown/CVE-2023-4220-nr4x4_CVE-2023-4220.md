## CVE-2023-4220 - Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可上传WebShell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，并且可以访问到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个高危漏洞，允许未经身份验证的攻击者通过大文件上传功能上传恶意文件（WebShell），从而实现远程代码执行。

**有效性分析：**

*   漏洞库信息明确指出，Chamilo LMS <= 1.11.24 存在未经身份验证的文件上传漏洞。
*   搜索引擎结果中，大量网页描述了此漏洞，并确认可以实现 RCE。
*   提供的漏洞利用代码包含 Python 脚本 (cve-2023-4220.py) 和 Shell 脚本 (cve-2023-4220.sh)，分别用于交互式 RCE 和反弹 Shell。同时，README.md 中提供了使用 curl 命令手动上传 WebShell 并执行的步骤。
*   漏洞利用代码中的curl 命令尝试上传 `jiji.php` 到 `/main/inc/lib/javascript/bigupload/files/` 目录。通过访问该文件并附加 `jiji` 参数，攻击者可以执行任意系统命令。
*   综合来看，POC代码是有效的，可以利用该漏洞在目标系统上执行任意代码。

**投毒风险分析：**

*   查看提供的代码文件，核心利用逻辑主要集中在上传webshell和执行命令。没有发现明显的恶意代码，如删除文件、修改系统配置等。
*   `cve-2023-4220.sh` 脚本提供了反弹 shell 的功能，攻击者可以利用它来建立持久的远程访问。 虽然这个功能本身是漏洞利用的一部分，但也可能被滥用。
*   `cve-2023-4220.py` 脚本动态生成 webshell 文件，这在一定程度上增加了审查难度，存在细微的隐藏恶意代码的可能性。
*   虽然图片文件显示了命令执行的结果，本身并没有任何恶意代码。
*   综合评估，存在轻微的投毒风险，主要来自于脚本提供的反弹 shell 功能和动态生成webshell文件带来的审查难度，但是可能性较低，概率在5%左右。

**利用方式：**

1.  **上传 WebShell：** 攻击者使用 curl 命令或提供的脚本，将包含恶意代码的 PHP 文件（WebShell）上传到 Chamilo LMS 的 `/main/inc/lib/javascript/bigupload/files/` 目录。利用的上传点为 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported`
2.  **执行命令：** 攻击者通过构造 URL，访问上传的 WebShell 文件，并在 URL 中传递要执行的系统命令。例如，`http://<chamilo>/main/inc/lib/javascript/bigupload/files/jiji.php?jiji=id`。
3.  **反弹 Shell (可选):** 使用 `cve-2023-4220.sh` 脚本提供的反弹 shell 功能，获取目标系统的 shell 控制权。

**总结：**

该漏洞利用方式简单，风险高，容易被攻击者利用。系统管理员应尽快升级 Chamilo LMS 版本到安全版本，并检查是否存在恶意上传的文件。

**项目地址:** [nr4x4/CVE-2023-4220](https://github.com/nr4x4/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)