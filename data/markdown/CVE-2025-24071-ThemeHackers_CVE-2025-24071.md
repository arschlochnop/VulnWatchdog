## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)