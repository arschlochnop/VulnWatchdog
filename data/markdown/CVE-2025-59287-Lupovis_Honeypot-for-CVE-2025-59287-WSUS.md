## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 见cpeApplicability

**利用条件:** 需要网络访问WSUS服务

**POC 可用性:** 是，但为防御性PoC

**投毒风险:** 10%

## 详情

该漏洞是Windows Server Update Service (WSUS)中的一个反序列化漏洞。攻击者可以通过向WSUS服务发送恶意构造的数据，利用该漏洞在目标服务器上执行任意代码。

**有效性：**
根据CISA ADP Vulnrichment的信息，该漏洞存在可利用的PoC。然而，根据提供的代码，该PoC实际上是一个防御性的PoC，旨在创建一个蜜罐来捕获攻击者的行为，而不是真正的漏洞利用程序。它模拟WSUS Web终端节点并记录所有传入的HTTP请求，包括请求体和Header。

**投毒风险：**
该项目主要包含nginx配置，Flask捕获服务，Windows PowerShell测试工具，Suricata规则和KQL查询等组件。`deploy_decoy.sh` 脚本自动化部署蜜罐环境。主要目的是为了检测攻击行为。

虽然表面上看该代码库是防御性的，但仍然存在一定程度的投毒风险（约10%），原因是：
* **依赖风险：** `capture/requirements.txt` 文件中可能包含恶意依赖项。需要仔细检查该文件，确认所有依赖包的来源和完整性。
* **配置错误：** 错误地配置蜜罐环境可能会导致其本身被攻击者利用，例如，如果Flask服务未正确配置，可能存在其他安全漏洞。
* **潜在后门：** 作者可能在Flask捕获服务或其他组件中添加隐藏的后门代码。尽管可能性较小，但不能完全排除。

需要人工审计所有脚本和配置文件的代码，确认其中没有隐藏的恶意代码或配置。

**利用方式：**
由于提供的代码是一个防御性的蜜罐，因此它本身不包含漏洞利用代码。但是，基于漏洞描述，攻击者需要利用WSUS服务中的反序列化漏洞，发送恶意构造的数据。具体的攻击步骤如下：

1.  攻击者识别存在漏洞的WSUS服务器。
2.  攻击者构造包含恶意Payload的序列化数据。
3.  攻击者将恶意序列化数据发送到WSUS服务器的某个端点。
4.  WSUS服务器反序列化数据，导致恶意代码执行。

由于该漏洞是反序列化漏洞，因此可能需要结合ysoserial.net等工具生成相应的Payload。

**项目地址:** [Lupovis/Honeypot-for-CVE-2025-59287-WSUS](https://github.com/Lupovis/Honeypot-for-CVE-2025-59287-WSUS)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)