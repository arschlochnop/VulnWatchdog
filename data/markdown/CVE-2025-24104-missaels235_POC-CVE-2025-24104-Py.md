## CVE-2025-24104 - iOS/iPadOS 本地文件修改漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接处理不当导致的文件修改

**影响应用:** iOS/iPadOS

**危害等级:** 中危，需要用户交互，可能导致受保护的系统文件被修改

**影响版本:** iPadOS < 17.7.4, iOS and iPadOS < 18.3

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 是一个由于符号链接处理不当导致的文件修改漏洞，存在于 iPadOS 和 iOS 中。攻击者可以制作一个恶意的备份文件，诱导用户恢复该备份。由于系统在恢复备份时对符号链接处理不当，攻击者可以利用该漏洞修改受保护的系统文件，如 `/private/etc/passwd`。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意符号链接的备份文件。
2.  攻击者诱骗用户恢复该备份文件。
3.  在备份恢复过程中，恶意符号链接会将目标文件（如 `/private/etc/passwd`）链接到备份文件中的某个攻击者可控的文件。
4.  备份恢复过程会将攻击者可控的文件内容覆盖到目标文件，从而修改了受保护的系统文件。

**POC有效性评估：**

根据漏洞描述和POC代码，该POC利用了 `idevicebackup2` 工具来备份和恢复设备。POC代码通过创建包含恶意符号链接的备份，并尝试将其恢复到目标设备上，验证了该漏洞的存在。如果目标设备的iOS版本低于18.3 (或 iPadOS 17.7.4)，且用户执行了恢复操作，则POC可以成功修改目标文件，证明漏洞利用的有效性。值得注意的是，POC中强调了需要用户交互，即需要用户主动恢复恶意备份。

**投毒风险评估：**

虽然提供的POC代码主要目的是验证漏洞的存在，但仍需评估是否存在隐藏的投毒代码。代码中涉及创建临时目录、执行外部命令(`idevicebackup2`)、读取和写入 plist 文件等操作，这些操作都可能被利用来执行恶意代码。例如，攻击者可能通过修改 plist 文件或在临时目录中放置恶意文件，在用户不知情的情况下执行恶意操作。但是，从代码整体结构来看，其主要功能是围绕漏洞验证展开，恶意代码的隐藏空间相对有限。因此，初步估计投毒风险约为 10%。这个百分比是主观评估，基于对代码的快速审查。更深入的审计可能发现更高或更低的风险。

**缓解措施：**

*   及时更新 iOS/iPadOS 到最新版本。
*   避免恢复来自不可信来源的备份文件。
*   增强对备份文件的安全性检查。

**项目地址:** [missaels235/POC-CVE-2025-24104-Py](https://github.com/missaels235/POC-CVE-2025-24104-Py)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)