## CVE-2020-14883-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2020-14883

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，允许未授权用户接管WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问目标WebLogic服务器，高权限用户网络访问或未授权访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是Oracle WebLogic Server控制台中存在的未授权访问漏洞，结合远程代码执行漏洞（CVE-2020-14882）利用，或者高权限用户利用。

**有效性：**
提供的POC代码是有效的，通过未授权访问/console/images目录下的资源，然后构造恶意请求，绕过身份验证，最终通过`com.tangosol.coherence.mvel2.sh.ShellSession`或`com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext`执行任意代码。代码中包含了对不同WebLogic版本的验证和利用方式，例如远程XML命令执行。

**投毒风险：**
POC代码主要集中在利用漏洞，植入后门可能性较低。代码中包含了DNSLog的检测功能，用于验证漏洞是否存在，但也有可能被恶意使用来收集目标信息。但是从代码整体来看，投毒的可能性较低，主要风险在于被滥用。
判断结果：风险占比为5%，代码较为直接，虽然存在dnslog检测，可以用于信息收集，但总体思路为漏洞利用，而非隐藏恶意行为。

**利用方式：**
1.  **未授权访问验证：** 攻击者首先利用未经身份验证的URL（例如`/console/images/%252E%252E%252Fconsole.portal`）来判断是否存在未授权访问漏洞。
2.  **获取Cookie：** 如果存在未授权访问，则尝试获取`ADMINCONSOLESESSION` cookie。
3.  **版本判断：**  通过页面内容获取WebLogic的版本。
4.  **远程代码执行：**
    *   **POC1 RCE:** 构造包含恶意代码的URL，使用`com.tangosol.coherence.mvel2.sh.ShellSession`执行系统命令。
    *   **远程XML命令执行:**  加载远程XML文件，触发其中的恶意代码。需要提供远程XML文件的URL。
5.  **DNSLog验证：**  使用DNSLog服务来验证命令是否成功执行，攻击者可以创建一个唯一的域名，并在命令中尝试ping该域名，如果DNS服务器收到了请求，则表示命令执行成功。

**项目地址:** [fan1029/CVE-2020-14883EXP](https://github.com/fan1029/CVE-2020-14883EXP)

**漏洞详情:** [CVE-2020-14883](https://nvd.nist.gov/vuln/detail/CVE-2020-14883)