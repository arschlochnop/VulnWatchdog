## CVE-2022-42092-Backdrop CMS-Unrestricted File Upload

**漏洞编号:** CVE-2022-42092

**漏洞类型:** Unrestricted File Upload

**影响应用:** Backdrop CMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.22.0

**利用条件:** 需要目标Backdrop CMS存在，且攻击者能够登录到后台（至少需要较低权限）。 注意：漏洞描述中提及需要高级权限，但利用代码未体现。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-42092 是 Backdrop CMS 1.22.0 版本中存在的一个不受限制的文件上传漏洞。攻击者可以通过上传恶意文件（例如，包含webshell的tar.gz压缩包）到 themes 目录，从而实现远程代码执行。

**有效性评估：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞的利用似乎是有效的。POC代码的流程如下：

1.  **登录:** 使用提供的用户名和密码登录Backdrop CMS后台。
2.  **获取令牌:** 获取管理员安装页面所需的`form_build_id`、`form_token`和`theme_token`。
3.  **创建恶意模块:** 创建一个包含恶意PHP代码的Backdrop CMS模块，该模块会在被安装后执行反弹shell。
4.  **上传恶意模块:** 将恶意模块打包成tar.gz格式并上传到服务器。
5.  **安装恶意模块:** 通过手动安装模块触发恶意代码执行，从而获得反弹shell。
6. **权限绕过:** 如果需要高级权限，可能需要绕过权限验证才能利用该漏洞。

**投毒风险评估：**

POC代码中存在少量投毒风险（估计为1%）。 代码逻辑基本符合漏洞描述，主要功能是利用文件上传漏洞执行命令，但存在细微的潜在风险：

*   **硬编码的边界符:** POC使用了一个硬编码的`BOUNDARY`，如果目标服务器对 multipart/form-data 的处理方式略有不同，可能会导致上传失败。这不是典型的投毒行为，但可能降低利用成功率。

代码本身没有明显的恶意行为，例如删除文件或泄露数据。

**利用方式分析：**

1.  **身份验证:** 攻击者需要有效的Backdrop CMS用户凭据才能登录到后台。
2.  **漏洞利用:** 登录后，攻击者可以利用`admin/installer/manual`页面上传恶意文件。 POC使用了手动安装模块的方式，可能绕过了一些常规的上传限制。
3.  **远程代码执行:** 成功上传并安装恶意模块后，恶意PHP代码将被执行，从而允许攻击者在服务器上执行任意命令。POC中演示了反弹shell的利用方式。

**项目地址:** [ajdumanhug/CVE-2022-42092](https://github.com/ajdumanhug/CVE-2022-42092)

**漏洞详情:** [CVE-2022-42092](https://nvd.nist.gov/vuln/detail/CVE-2022-42092)