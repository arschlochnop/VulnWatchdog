## CVE-2015-1578-u5CMS-Open Redirect & Achat 0.150 beta7-Buffer Overflow

**漏洞编号:** CVE-2015-1578

**漏洞类型:** Open Redirect & Buffer Overflow

**影响应用:** u5CMS & Achat

**危害等级:** 高危，可能导致钓鱼攻击和远程代码执行

**影响版本:** u5CMS < 3.9.4 & Achat 0.150 beta7

**利用条件:** u5CMS需要网络访问，Achat需要目标主机运行服务并监听UDP端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，u5CMS存在多个开放重定向漏洞，攻击者可以利用这些漏洞将用户重定向到恶意网站进行钓鱼攻击。具体来说，可以通过修改`pidvesa` cookie的值，使其指向恶意URL，然后访问`u5admin/pidvesa.php`，或者通过`uri`参数指定恶意URL，然后访问`u5admin/meta2.php`。 

根据搜索引擎结果以及提供的漏洞利用代码，Achat 0.150 beta7存在一个基于UDP的缓冲区溢出漏洞。提供的Metasploit模块利用该漏洞，通过发送特制的UDP数据包，覆盖程序的返回地址，从而执行攻击者提供的shellcode，最终实现远程代码执行。该模块使用`msfvenom`生成payload，并避免了Metasploit内置的payload编码，从而绕过某些限制。

**关于投毒风险：**

阅读Metasploit模块代码，发现其主要功能是利用msfvenom动态生成payload并发送到目标主机。虽然代码中没有明显的恶意逻辑，但`install.sh`脚本可能存在风险，需要仔细审查，以确保没有隐藏的后门或恶意操作。 另外 `Author` 字段为 `'YourName'` 需要引起警惕，可能存在安全风险，例如将恶意代码注入到生成的payload中,总体评估投毒风险为10%。

**利用方式总结：**
* **u5CMS Open Redirect:** 修改`pidvesa` cookie或`uri`参数，使其指向恶意URL，然后诱导用户点击链接。
* **Achat Buffer Overflow:** 使用Metasploit模块，设置RHOST, LHOST, LPORT等参数，然后执行该模块，即可向目标主机发送特制的UDP数据包，触发缓冲区溢出漏洞，从而执行shellcode。

**项目地址:** [yaldobaoth/CVE-2015-1578-PoC-Metasploit](https://github.com/yaldobaoth/CVE-2015-1578-PoC-Metasploit)

**漏洞详情:** [CVE-2015-1578](https://nvd.nist.gov/vuln/detail/CVE-2015-1578)