## CVE-2022-0739 - BookingPress WordPress Plugin SQL注入

**漏洞编号:** CVE-2022-0739

**漏洞类型:** SQL注入

**影响应用:** BookingPress WordPress Plugin

**危害等级:** 高危，可能导致数据泄露、未授权访问和远程代码执行（如果数据库用户权限足够高）

**影响版本:** < 1.0.11

**利用条件:** 目标网站安装了受影响版本的BookingPress插件，且存在可访问的包含BookingPress Widget的页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0739是BookingPress WordPress插件1.0.11之前版本中存在的一个未经身份验证的SQL注入漏洞。该漏洞位于`bookingpress_front_get_category_services` AJAX action中，由于插件未对用户提供的POST数据进行充分的安全过滤，导致攻击者可以构造恶意的SQL查询语句，并将其注入到数据库查询中，从而执行任意SQL代码。利用方式如下：

1.  **漏洞触发点：** `bookingpress_front_get_category_services` AJAX action，无需认证即可访问。
2.  **攻击方式：** 攻击者通过POST请求向`wp-admin/admin-ajax.php`发送包含恶意SQL代码的`category_id`参数。
3.  **POC利用：** 提供的POC代码`cve-2022-0739.py`允许攻击者:
    *   获取数据库元数据。
    *   转储WordPress用户凭据。
    *   执行任意盲注查询 (例如，`SELECT SLEEP(5)`)。
4.  **有效性评估：** 根据漏洞库信息和提供的POC代码，该漏洞利用的有效性很高。POC代码提供了详细的使用说明和示例，表明其可用于实际攻击。
5.  **投毒风险评估：** 代码本身主要功能是利用SQL注入漏洞，没发现明显的恶意代码。
仔细检查了提供的代码文件，包括`LICENSE`、`README.md`、`pyproject.toml`以及`src/cve_2022_0739/`目录下的`__init__.py`和`main.py`文件。`main.py`包含了漏洞利用的核心逻辑，包括发送HTTP请求和处理响应等。虽然代码经过一定程度的混淆，但是没有发现任何隐藏的、与漏洞利用无关的恶意代码。但是考虑到任何人都可以修改并重新发布此POC，存在被他人投毒的可能性。代码可能存在细微的修改，在不影响主要功能的情况下，搜集用户信息或者进行其他恶意行为。综上所述，投毒风险较低，评估为5%。


**项目地址:** [BKreisel/CVE-2022-0739](https://github.com/BKreisel/CVE-2022-0739)

**漏洞详情:** [CVE-2022-0739](https://nvd.nist.gov/vuln/detail/CVE-2022-0739)