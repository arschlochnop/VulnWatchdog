## CVE-2025-59287-WSUS Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** Windows Server 2019 (版本介于 10.0.17763.0 和 10.0.17763.7919 之间，不包括 10.0.17763.7919)、Windows Server 2022 (版本介于 10.0.20348.0 和 10.0.20348.4294 之间，不包括 10.0.20348.4294)、Windows Server 2025 (版本介于 10.0.26100.0 和 10.0.26100.6899 之间，不包括 10.0.26100.6899)、Windows Server 23H2 (版本介于 10.0.25398.0 和 10.0.25398.1913 之间，不包括 10.0.25398.1913), Windows Server 2016 (版本介于 10.0.14393.0 和 10.0.14393.8519 之间，不包括 10.0.14393.8519), Windows Server 2012 (版本介于 6.2.9200.0 和 6.2.9200.25722 之间，不包括 6.2.9200.25722), Windows Server 2012 R2 (版本介于 6.3.9600.0 和 6.3.9600.22824 之间，不包括 6.3.9600.22824)

**利用条件:** 需要能够访问WSUS服务器的网络，并且WSUS服务正在运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是 Windows Server Update Service (WSUS) 中的一个远程代码执行漏洞。该漏洞是由于 WSUS 服务反序列化不可信数据造成的，未经身份验证的攻击者可以通过网络利用此漏洞在服务器上执行任意代码。

**有效性评估：**

提供的POC代码是一个PowerShell脚本，它利用了WSUS服务中的反序列化漏洞。该脚本首先禁用SSL证书验证（这对于测试环境很有用），然后定义了几个函数来获取身份验证Cookie、服务器ID和报告Cookie。脚本利用了 `SimpleAuthWebService` 和 `ClientWebService` 的 SOAP API，构造特定的 SOAP 请求来利用漏洞。

根据描述，攻击者需要编辑脚本中的变量（URL、端口等），启动netcat监听器，然后运行脚本。该脚本会自动下载`ysoserial.net`，生成payload，并将利用代码发送到WSUS服务器。最后，需要打开WSUS控制台才能触发漏洞。

根据CISA ADP的信息，该漏洞具有可自动化利用的特性，并会产生完全的技术影响，因此POC代码很可能有效。

**投毒风险分析：**

PowerShell 脚本的主要功能是利用 WSUS 的反序列化漏洞执行代码。虽然脚本下载并使用 `ysoserial.net` 来生成 payload，但 `ysoserial.net` 本身是一个已知的、用于生成 .NET 反序列化 payload 的工具。脚本本身的代码相对清晰，没有明显的恶意行为，例如持久化后门或数据窃取。然而，始终存在一定的风险：

1.  **依赖外部资源：** 脚本依赖从外部源（`ysoserial.net`）下载工具。如果该源被攻破，则下载的工具可能被替换为恶意版本。
2.  **代码注入风险：** 虽然脚本本身看起来是良性的，但如果攻击者修改了脚本，加入了额外的恶意代码，就可能存在投毒风险。例如，攻击者可能会添加代码，在利用成功后下载和执行额外的恶意 payload。
3. **反序列化Payload:** Payload的构造存在一定风险，可能会加载一些恶意的第三方模块。

综合考虑，认为该仓库中存在作者隐藏的投毒代码的风险较低，概率大约为10%。因为，如果存在投毒行为，主要会出现在修改过的payload上，通过下载恶意payload来实现。

**漏洞利用方式：**

1.  攻击者首先需要确定目标WSUS服务器的URL和端口。
2.  攻击者运行提供的PowerShell脚本`wsus-rce.ps1`，该脚本会自动执行以下操作：
    *   禁用SSL证书验证。
    *   使用`SimpleAuthWebService`获取身份验证Cookie。
    *   使用`ClientWebService`获取报告Cookie。
    *   下载`ysoserial.net`，生成包含恶意命令的.NET反序列化payload。
    *   将payload发送到WSUS服务器。
3.  攻击者打开WSUS控制台，触发反序列化漏洞，从而执行任意代码。通过netcat监听器接受反向shell。

总而言之，此漏洞利用方式涉及通过精心构造的SOAP请求向WSUS服务器发送恶意.NET反序列化payload，从而在服务器上实现远程代码执行。

**项目地址:** [tecxx/CVE-2025-59287-WSUS](https://github.com/tecxx/CVE-2025-59287-WSUS)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)