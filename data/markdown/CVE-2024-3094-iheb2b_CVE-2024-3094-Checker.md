## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。此代码在构建过程中被植入，修改了 liblzma 库的功能。具体而言，它拦截并修改了与该库的数据交互，从而允许攻击者绕过 SSH 身份验证并执行远程代码。该漏洞的利用涉及复杂的混淆技术，恶意代码隐藏在测试文件中，并在构建时被提取并注入到 liblzma 中。 

**有效性分析：**
提供的 "CVE-2024-3094 Checker.sh" 脚本旨在检测系统是否受到此漏洞的影响。它通过检查 XZ Utils 的版本，确认 sshd 是否链接了 lzma 库，并搜索特定的字节模式来识别恶意代码。脚本的目的是验证漏洞是否存在，而不是进行实际的攻击利用。

**投毒风险分析：**
提供的脚本本身不是投毒代码。它是一个检测脚本，用于检查系统上是否存在 CVE-2024-3094 漏洞。它不包含任何恶意功能，例如上传数据、执行任意命令等。脚本的目的是帮助用户识别和修复受影响的系统。

**利用方式分析：**
该漏洞的利用方式相当复杂。首先，攻击者需要将恶意代码注入到 XZ Utils 的源代码中，并设法使其在构建过程中不被发现。然后，当用户下载并构建受感染的 XZ Utils 版本时，恶意代码会被编译到 liblzma 库中。当 sshd 等应用程序链接到 liblzma 时，恶意代码会拦截 SSH 连接的身份验证过程，允许攻击者绕过身份验证并执行任意命令。从搜索结果和漏洞信息来看，攻击目标是SSH服务。

**利用方式总结：**
1.  恶意代码被隐藏在XZ Utils的源代码中。
2.  构建过程会将恶意代码注入到liblzma库中。
3.  sshd链接到liblzma库后，SSH身份验证过程会被恶意代码拦截。
4.  攻击者可以绕过身份验证并执行任意命令。

**信息来源优先级：** 搜索引擎结果、漏洞利用代码、漏洞库信息。

**项目地址:** [iheb2b/CVE-2024-3094-Checker](https://github.com/iheb2b/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)