## CVE-2024-51788 - WordPress The Novel Design Store Directory Plugin 任意文件上传漏洞

**漏洞编号:** CVE-2024-51788

**漏洞类型:** 任意文件上传

**影响应用:** WordPress The Novel Design Store Directory 插件

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** <= 4.3.0

**利用条件:** 目标WordPress站点安装了 The Novel Design Store Directory 插件，且版本小于等于4.3.0

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-51788 是一个存在于 WordPress The Novel Design Store Directory 插件（版本小于等于 4.3.0）中的任意文件上传漏洞。未经身份验证的攻击者可以利用此漏洞上传任意文件，例如 Web Shell，从而导致远程代码执行 (RCE)。

**利用方式：**

1.  **版本验证：** 脚本首先尝试通过访问 readme.txt 文件来验证目标插件的版本。如果无法验证，则会继续执行漏洞利用。
2.  **Cookie 设置：** 脚本生成随机的 cookie 来模拟已登录用户的会话。
3.  **Web Shell 上传：** 脚本构建一个包含恶意 PHP 代码（Web Shell）的文件上传请求，并将该请求发送到 `wp-admin/options-general.php?page=licence` 页面。通过修改 `default_shop_image` 参数上传恶意的PHP文件。
4.  **远程代码执行：** 成功上传 Web Shell 后，攻击者可以通过访问该 Web Shell 并传递命令参数来执行任意代码。

**投毒风险：**

该POC代码存在较高的投毒风险。因为它直接上传包含 `<?php system($_GET['cmd']); ?>` 的 Web Shell，任何人都可以通过访问上传的 Web Shell 并执行任意系统命令。 这可能被恶意使用者利用以攻击更多系统。

**项目地址:** [Nxploited/CVE-2024-51788](https://github.com/Nxploited/CVE-2024-51788)

**漏洞详情:** [CVE-2024-51788](https://nvd.nist.gov/vuln/detail/CVE-2024-51788)