## CVE-2025-49844-Redis-Lua-Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis Lua脚本功能开启，攻击者需具有执行Lua脚本的权限（ACL限制允许）

**POC 可用性:** 否

**投毒风险:** 5%

## 详情

CVE-2025-49844是Redis中Lua脚本引擎存在的一个使用后释放漏洞。攻击者可以通过构造恶意的Lua脚本来操纵垃圾回收器，触发use-after-free，从而导致远程代码执行。漏洞影响版本小于8.2.2。缓解措施包括升级到8.2.2或更高版本，或者使用ACL来限制EVAL和EVALSHA命令，从而禁用Lua脚本的执行。

**有效性分析：**
漏洞库信息表明此漏洞是真实存在的，且危害等级为CRITICAL。POC代码仅仅是一个README.md文件，没有任何实际利用代码，无法直接验证漏洞的有效性。因此，目前POC的有效性无法确认。

**投毒风险分析：**
提供的POC代码只有一个README.md文件，内容非常简单，只包含CVE编号，不包含任何可执行代码，因此投毒的概率极低。可以认为存在极小的投毒风险（例如，未来作者可能会添加恶意代码）。

**利用方式：**
1.  攻击者需要连接到Redis服务器。
2.  攻击者需要具有执行Lua脚本的权限。默认情况下，如果没有设置ACL，所有用户都可以执行Lua脚本。
3.  攻击者需要构造一个恶意的Lua脚本，该脚本可以操纵垃圾回收器并触发use-after-free。
4.  成功利用该漏洞后，攻击者可以在Redis服务器上执行任意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-49844](https://github.com/B1ack4sh/Blackash-CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)