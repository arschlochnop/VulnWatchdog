## CVE-2025-52970-FortiWeb-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2025-52970

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** FortiWeb

**危害等级:** 高危，可导致完全控制受影响的 FortiWeb 设备

**影响版本:** <=7.6.3, <=7.4.7, <=7.2.10, <=7.0.10

**利用条件:** 需要能够通过网络访问 FortiWeb 设备的管理界面, 并且需要具备针对目标用户的非公开信息（根据漏洞库描述）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-52970 漏洞是 Fortinet FortiWeb 中的一个参数处理不当漏洞（CWE-233），允许未经身份验证的远程攻击者利用特定构造的请求绕过身份验证，并获得设备的管理员权限。根据漏洞库信息，攻击需要非公开信息，这增加了攻击的复杂性，CVSS评分表明这是一个高危漏洞，具有高机密性、完整性和可用性影响。搜索结果表明该漏洞已经被公开披露，并且存在可用的漏洞利用代码（POC）。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过构造包含恶意 SQL 注入的 `Authorization` 请求头，向 `/api/fabric/device/status` API 端点发送请求，绕过身份验证机制。
2.  **远程代码执行（RCE）：** 漏洞利用代码使用 SQL 注入来写入 webshell 和执行 chmod 命令。
    *   首先，它使用 SQL 注入在数据库表 `fabric_user.a` 中写入一个简单的 webshell (保存在 `/migadmin/cgi-bin/x.cgi`)。 这个 webshell 简单地执行 `User-Agent` 中的命令。
    *   然后，它使用 SQL 注入写入一个 chmod 脚本到 `/var/log/lib/python3.10/pylab.py`.
    *   最后，它通过访问 `/cgi-bin/ml-draw.py` 来触发 chmod 命令的执行，从而使 webshell 具备执行权限。
3.  **命令执行：** 成功部署 webshell 后，攻击者可以通过修改 HTTP 请求的 `User-Agent` 头来执行任意命令。

**有效性评估：**
根据搜索结果和提供的漏洞利用代码，该漏洞的POC是可用的，并且已经被公开讨论，因此该POC很可能有效。漏洞利用代码实现了身份验证绕过和远程代码执行，证明了漏洞的可利用性。

**投毒风险评估：**
仔细分析提供的Python脚本`CVE-2025-52970.py`，存在一定投毒风险，可能性为10%。

*   **可能的投毒点分析：**
    *   **Webshell位置：**/migadmin/cgi-bin/x.cgi。虽然webshell本身功能比较直接（执行User-Agent中的命令），但该路径的选择可能较为隐蔽，不易被发现。如果目标系统运维人员不熟悉此路径，可能会忽略webshell的存在。
    *   **依赖关系：**脚本依赖于`requests`和`urllib3`库。虽然这是常见的库，但如果目标系统缺少这些依赖，攻击者可以诱导受害者安装包含恶意代码的库。
    *   **错误处理：**脚本中的错误处理相对简单。虽然有`try-except`块，但如果请求失败，可能不会提供足够的信息来帮助受害者识别问题，从而增加了攻击者隐藏恶意行为的机会。

*  **理由：**
    *   该脚本的主要功能是利用已知的身份验证绕过漏洞执行远程代码。webshell功能简单，主要风险在于位置的隐蔽性。
    *  该脚本没有任何明显的恶意代码，例如反向shell、数据窃取或破坏操作。然而，攻击者完全可以修改脚本，加入这些恶意行为。webshell本身也为后续的恶意操作提供了便利。
    *   该脚本的设计可能旨在隐藏真实目的。利用SQL注入写入webshell和chmod脚本，这种多步骤的利用过程增加了复杂性，使得快速分析变得困难。攻击者可能试图利用这一点，在后续阶段添加恶意功能。

总体而言，该脚本存在一定的投毒风险。虽然该脚本主要关注利用已知漏洞，但攻击者完全可以利用脚本的特性来隐藏其他恶意行为。

**缓解措施：**
*   立即升级 FortiWeb 到不受影响的版本（8.0.0 或以上，7.6.4 或以上，7.4.8 或以上，7.2.11 或以上，7.0.11 或以上）。
*   如果无法立即升级，请实施网络分段和访问控制策略，限制对 FortiWeb 管理界面的访问。
*   监控 FortiWeb 设备的日志，以检测任何可疑活动。

**项目地址:** [34zY/CVE-2025-52970](https://github.com/34zY/CVE-2025-52970)

**漏洞详情:** [CVE-2025-52970](https://nvd.nist.gov/vuln/detail/CVE-2025-52970)