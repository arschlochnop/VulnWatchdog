## CVE-2025-32432-CraftCMS-RCE

**漏洞编号:** CVE-2025-32432

**漏洞类型:** 远程代码执行

**影响应用:** CraftCMS

**危害等级:** 高危，未经授权的攻击者可以执行任意代码，完全控制系统

**影响版本:** 3.0.0-RC1 to 3.9.15, 4.0.0-RC1 to 4.14.15, and 5.0.0-RC1 to 5.6.17

**利用条件:** 目标 CraftCMS 实例版本在受影响范围内，且未应用安全补丁。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32432 是 Craft CMS 中的一个远程代码执行 (RCE) 漏洞。根据漏洞信息和搜索结果，该漏洞影响多个 Craft CMS 版本，并且利用复杂度低，影响严重。漏洞利用代码 `CVE-2025-32432.py` 尝试通过 `assets/generate-transform` 接口执行 PHP 代码。该 POC 脚本首先尝试获取 CSRF token，然后构造包含恶意 PHP 代码的 payload，发送到目标 Craft CMS 服务器。如果服务器存在漏洞，则会执行 payload 中的 PHP 代码，例如，调用 `phpinfo()` 来验证漏洞。脚本会尝试提取 `CRAFT_DB_DATABASE` 和 `HOME` 目录信息来验证利用结果。由于该POC提取数据库名称和HOME目录来验证成功, 存在极低的投毒风险, 主要是考虑到攻击者可能会在`assetId`等参数中植入恶意代码, 但概率较低.

**漏洞利用方式：**

1.  **获取 CSRF Token：** 攻击者首先需要从 Craft CMS 的某个页面（例如 dashboard）获取有效的 CSRF token。POC 代码使用 `extract_csrf_token` 函数完成此操作。
2.  **构造恶意 Payload：** 攻击者构造一个包含恶意 PHP 代码的 JSON payload。POC 代码中，`handle` 参数被设计成包含一个可以触发 PHP 函数执行的结构。具体来说，它利用 `craft\behaviors\FieldLayoutBehavior` 类和 `GuzzleHttp\Psr7\FnStream` 类，结合 `phpinfo()` 函数，来执行任意 PHP 代码。
3.  **发送请求：** 攻击者将包含恶意 payload 的 POST 请求发送到 `/index.php?p=admin/actions/assets/generate-transform` 接口，并在请求头中包含 CSRF token。
4.  **执行代码：** 如果 Craft CMS 存在漏洞，服务器将执行 payload 中的 PHP 代码。
5.  **验证结果：** 攻击者检查服务器的响应，判断 payload 是否成功执行。POC 代码会查找 `PHP Version` 字符串来验证 `phpinfo()` 是否成功执行，并尝试提取 `CRAFT_DB_DATABASE` 和 `HOME` 目录的值作为进一步的验证。

**有效性：**

根据漏洞信息和搜索结果，以及 POC 代码的实现方式，可以判断该 POC 代码是有效的。多个来源都确认了该漏洞的存在和易于利用的特点。该漏洞的CVSS评分为10，表明其危害性极高。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-32432](https://github.com/B1ack4sh/Blackash-CVE-2025-32432)

**漏洞详情:** [CVE-2025-32432](https://nvd.nist.gov/vuln/detail/CVE-2025-32432)