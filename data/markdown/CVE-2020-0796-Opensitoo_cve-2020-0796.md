## CVE-2020-0796-SMBGhost-远程代码执行

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows

**危害等级:** 高危，可导致远程代码执行和系统控制

**影响版本:** Windows 10 Version 1903/1909, Windows Server version 1903/1909

**利用条件:** 目标系统开启SMBv3服务，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名SMBGhost，是Microsoft SMBv3协议处理特定请求时存在远程代码执行漏洞。该漏洞影响Windows 10 1903/1909和Windows Server 1903/1909版本。根据NVD的描述，该漏洞在于SMBv3协议处理请求的方式，攻击者可以利用此漏洞在目标系统上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此漏洞POC代码的有效性较高。搜索引擎结果中包含CISA的警告，表明存在可用的POC代码，并存在实际利用情况。提供的漏洞利用代码包含两个scanner.py脚本，一个检测脚本和一个更完整的exploit。这些代码旨在检测目标系统是否存在漏洞，并可能进一步利用该漏洞。

**投毒风险分析：**

分析提供的python代码，其中包含检测和利用漏洞的代码，但未发现明显的恶意代码。投毒风险主要存在于以下几个方面：

1.  **代码复杂性：** 漏洞利用代码相对复杂，攻击者可能通过修改代码，添加恶意功能，例如植入后门或进行拒绝服务攻击。但是，代码本身是为了验证和利用漏洞而设计的，并没有主动植入恶意代码的意图。
2.  **依赖项：** 提供的代码依赖于Python环境，如果攻击者修改代码，引入恶意的第三方库，可能存在投毒风险。

综合来看，此仓库的投毒风险较低，但仍需谨慎使用。

**利用方式分析：**

根据漏洞信息和POC代码，利用方式如下：

1.  **协议交互：**  漏洞存在于SMBv3协议中，利用需要与目标系统的SMB服务进行通信。
2.  **畸形数据包：**  通过构造特定的SMBv3数据包，包含畸形的压缩转换信息，触发缓冲区溢出。
3.  **代码执行：**  成功触发漏洞后，可以在目标系统上执行任意代码，实现远程控制。

提供的代码中，`cve-2020-0796-scanner.py`用于检测目标系统是否存在漏洞。通过发送特制的SMB协商请求，检查返回结果中的特定字段来判断目标系统是否易受攻击。而`cve-2020-0796.py`则尝试利用该漏洞进行攻击。尽管只有部分代码，但根据提供的描述，它利用了SMBv3的压缩机制中的bug。

综上，该漏洞是一个严重的安全问题，需要及时修补。在测试和验证漏洞时，需要采取必要的安全措施，避免造成不必要的损失。

**项目地址:** [Opensitoo/cve-2020-0796](https://github.com/Opensitoo/cve-2020-0796)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)