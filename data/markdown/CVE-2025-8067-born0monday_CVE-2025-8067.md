## CVE-2025-8067-Udisks-OOB Read

**漏洞编号:** CVE-2025-8067

**漏洞类型:** 越界读取 (Out-of-bounds Read)

**影响应用:** Udisks

**危害等级:** 高危，可能导致信息泄露、权限提升和拒绝服务

**影响版本:** 受影响版本包括 Red Hat Enterprise Linux 6, 7, 8, 9, 10 的部分 udisks2 版本，具体请参考漏洞库信息

**利用条件:** 本地访问，需要能够通过 D-Bus 与 Udisks daemon 通信。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-8067 是 Udisks daemon 中的一个越界读取漏洞。攻击者可以利用此漏洞通过 D-Bus 接口创建 loop 设备时，传递一个负数索引作为文件描述符列表的索引，导致 Udisks daemon 读取超出文件描述符范围的内存，从而可能导致崩溃、权限提升或泄露敏感信息。

**有效性：**
提供的 PoC 代码 `poc-fd-steal.py` 和 `poc.py` 是有效的。`poc.py` 通过发送一个极小的负数索引来触发 OOB 读取，导致 Udisks 守护程序崩溃，实现了拒绝服务。`poc-fd-steal.py` 通过尝试不同的负数索引，找到一个有效的文件描述符，并将其挂载为 loop 设备，实现了文件描述符窃取，从而可能访问特权用户的文件。

**投毒风险：**
该漏洞利用代码看起来是直接利用漏洞本身，没有发现明显的投毒代码或恶意行为。`README.md` 文件只是提供了关于漏洞的链接。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者利用 D-Bus 与 Udisks daemon 通信。
2.  攻击者调用 `LoopSetup` 方法，创建一个 loop 设备。
3.  在调用 `LoopSetup` 方法时，攻击者传递一个负数索引作为文件描述符列表的索引。
4.  由于 Udisks daemon 没有正确地验证索引的下限，导致它读取超出文件描述符列表范围的内存。
5.  此操作可能导致 Udisks daemon 崩溃（拒绝服务）或者，在`poc-fd-steal.py`中，通过尝试不同的负数索引，可能会成功“窃取”一个由 Udisks daemon 打开的文件描述符，并将它挂载为一个loop设备，从而能够读取该文件描述符所指向的文件。这可以用来读取特权用户的文件，实现权限提升。

**搜索引擎结果分析：**
搜索结果证实了漏洞的存在，严重性较高，并提供了漏洞的描述和缓解步骤。结果中包含来自 Red Hat、NVD 和其他安全机构的信息，表明该漏洞已被广泛关注并正在被积极修复。


**项目地址:** [born0monday/CVE-2025-8067](https://github.com/born0monday/CVE-2025-8067)

**漏洞详情:** [CVE-2025-8067](https://nvd.nist.gov/vuln/detail/CVE-2025-8067)