## CVE-2015-6967-Nibbleblog-Unrestricted File Upload

**漏洞编号:** CVE-2015-6967

**漏洞类型:** Unrestricted File Upload

**影响应用:** Nibbleblog

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 4.0.5

**利用条件:** 需要管理员权限访问 Nibbleblog 后台

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-6967 存在于 Nibbleblog 4.0.5 之前的版本中，My Image 插件存在未限制的文件上传漏洞。攻击者（需要管理员权限）可以通过上传包含恶意代码的文件，例如 PHP reverse shell，到 `content/private/plugins/my_image/image.php` 路径下，并通过直接访问该文件来执行任意代码。

**利用方式：**
1.  使用管理员账号登录 Nibbleblog 后台。
2.  通过 My Image 插件的文件上传功能，上传一个包含 PHP 代码的恶意文件（例如 reverse shell）。
3.  通过构造 URL，直接访问上传的恶意文件 `content/private/plugins/my_image/image.php`，触发恶意代码执行。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出该漏洞允许远程代码执行，搜索引擎结果中包含多个对此漏洞的描述，并且 exploit-db 上也有 Metasploit 模块。提供的 Python 脚本也尝试自动化利用该漏洞。

**投毒风险：**
提供的 Python 脚本主要功能是：
1.  使用提供的用户名和密码登录 Nibbleblog 管理后台。
2.  构造一个包含 PHP reverse shell 的 payload。
3.  通过 My Image 插件上传该 payload。
4.  使用给定的IP地址和端口建立反向shell连接。

代码中唯一的潜在风险在于 reverse shell 的植入，但这属于漏洞利用的正常流程，不能算是投毒。投毒指的是在代码中插入与漏洞利用无关的恶意代码。代码相对简单，没有发现明显的投毒行为，但是仍需人工审计。

综上，投毒风险评估为 1%，主要因为作者可能通过反向shell获取控制权限后进行恶意活动。

**漏洞利用代码分析：**
提供的Python脚本利用了Nibbleblog的后台文件上传功能，通过上传一个PHP reverse shell文件到服务器，然后通过访问该文件执行代码。

该脚本通过`requests`库模拟HTTP请求，自动化了整个漏洞利用过程，包括登录、上传恶意文件和触发代码执行。

使用方式：`python CVE-2015-6967.py <Nibbleblog URL> -U <username> -P <password> -p <host_port> -H <host_ip>`

**项目地址:** [innocentx0/CVE-2015-6967-EXPLOIT](https://github.com/innocentx0/CVE-2015-6967-EXPLOIT)

**漏洞详情:** [CVE-2015-6967](https://nvd.nist.gov/vuln/detail/CVE-2015-6967)