## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者在用户尝试查看 ZIP 压缩包中的良性文件时执行任意代码。该漏洞源于 WinRAR 处理 ZIP 压缩包时，允许压缩包包含一个良性文件（例如 .JPG）和一个同名文件夹。当用户尝试访问该良性文件时，WinRAR 实际上会处理同名文件夹中的内容，从而允许攻击者在文件夹中放置恶意可执行文件并执行。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞已经被广泛利用，PoC 代码的存在也进一步验证了其有效性。

**投毒风险：**
提供的 Python 脚本 (`51721.py`) 用于生成 Windows x64 平台的反向 TCP Shellcode。该脚本本身不包含明显的恶意代码，功能是生成 shellcode。需要用户自行配置 IP 地址和端口。但是，由于该代码需要用户执行，并且可以生成任意 shellcode，存在一定投毒风险，例如，如果攻击者提供修改后的脚本，生成包含恶意功能的 shellcode (如删除文件，上传用户信息)，则用户可能无意中执行该恶意 shellcode. 脚本本身不包含网络连接或者其他与远程服务器通信的行为，可以基本判断代码仓库投毒风险较低.

**利用方式：**
1.  攻击者创建一个恶意的 ZIP 压缩包。
2.  该 ZIP 压缩包包含一个良性文件（例如 image.jpg）和一个同名文件夹（image.jpg）。
3.  同名文件夹包含恶意可执行文件，例如 exploit.exe，并可能包含一个 `.lnk` 文件，该快捷方式指向该恶意可执行文件。
4.  攻击者诱骗用户使用受影响版本的 WinRAR 打开该 ZIP 压缩包并尝试查看良性文件。
5.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，从而导致远程代码执行。

**项目地址:** [MaorBuskila/Windows-X64-RAT](https://github.com/MaorBuskila/Windows-X64-RAT)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)