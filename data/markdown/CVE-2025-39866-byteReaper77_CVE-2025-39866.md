## CVE-2025-39866 - Linux Kernel Use-After-Free

**漏洞编号:** CVE-2025-39866

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致系统崩溃、拒绝服务或权限提升

**影响版本:** < 6.12.16

**利用条件:** 需要能够加载内核模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是Linux内核文件系统写回机制中__mark_inode_dirty()函数中的一个use-after-free漏洞。当__mark_inode_dirty()获取bdi_writeback结构体时，可能存在竞争条件，导致该结构体已经被释放。攻击者可以通过以下步骤利用此漏洞：

1.  **线程1（主线程）:** 创建一个目标写回文件的inode结构体，并创建一个writeback object（wb），保存到wb_old变量。
2.  **线程2（内核线程）:** 创建一个内核线程，该线程调度一个work item，该work item运行inode_switch_wbs_work_fn函数，该函数更新inode->i_wb并且调用wb_put_many。
3.  **线程2:** 释放wb_old指向的writeback object。
4.  **线程1:** 尝试访问已经被释放的wb_old指向的内存，导致内核崩溃 (UAF)。

**有效性：**
提供的POC代码试图重现此竞争条件并触发UAF漏洞，从而导致内核崩溃。根据漏洞描述和POC代码的逻辑，此POC具有较高的有效性。

**投毒风险：**
查看提供的POC代码，主要由三个文件组成：
LICENSE文件是MIT开源协议，不包含投毒代码
README.md 文件是漏洞描述，和使用方法，不包含投毒代码
poc.c文件是漏洞验证代码，根据代码逻辑主要分为创建线程，利用漏洞，没有发现明显的恶意代码。
综合判断投毒风险较低，但是也需要人工进行代码审计确定是否存在隐藏的后门代码，这里给出`1%`的风险值。

**利用方式：**
利用方式主要是通过竞争条件触发use-after-free。攻击者需要能够加载内核模块，并执行相应的操作才能触发漏洞。成功利用可能导致拒绝服务，也可能结合其他技术实现权限提升。

**优先级排序：**
1.  **漏洞利用代码：** POC 代码验证了漏洞的存在，并提供了利用方法。
2.  **搜索引擎结果：** 搜索引擎结果提供了漏洞影响、缓解措施和CVSS评分等信息，有助于了解漏洞的严重程度。
3.  **漏洞库信息：** 漏洞库信息提供了漏洞的详细描述、影响版本和修复方案等信息，是了解漏洞的基础。

**项目地址:** [byteReaper77/CVE-2025-39866](https://github.com/byteReaper77/CVE-2025-39866)

**漏洞详情:** [CVE-2025-39866](https://nvd.nist.gov/vuln/detail/CVE-2025-39866)