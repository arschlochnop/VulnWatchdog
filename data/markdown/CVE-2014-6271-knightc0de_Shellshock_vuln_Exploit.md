## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行，系统权限获取

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash作为shell，且存在CGI脚本或允许通过环境变量传递命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。当Bash shell处理这些环境变量时，会在函数定义后执行嵌入的命令，从而导致安全风险。

**有效性：**

提供的PoC代码是有效的，它通过`pwn`库和`requests`库实现漏洞利用。该脚本通过构造包含恶意Bash代码的HTTP请求头（User-Agent, Cookie, Referer）发送到目标服务器，如果目标服务器存在CGI脚本且使用存在漏洞的Bash版本，则会执行恶意代码，并反弹shell到攻击者指定的IP地址和端口。

**投毒风险：**

该仓库中存在一定的投毒风险，风险评估为10%。虽然作者提供了免责声明，并且主要代码逻辑是为了利用Shellshock漏洞，但仍然存在潜在的后门或恶意修改的可能性，尽管看起来相对较低：
*   **依赖风险**: 依赖`pwn`和`requests`库，如果这些库被篡改，可能引入恶意代码。
*   **Payload定制**: Payload的构造方式可能被修改，引入额外的恶意行为。

**利用方式：**

1.  **确定目标：** 寻找运行CGI脚本的web服务器，或者其他任何可能通过环境变量传递命令给Bash的应用程序。
2.  **构造Payload：** 构造一个包含恶意Bash代码的环境变量，例如：`() { :;}; /bin/bash -c 'command'`。
3.  **传递Payload：** 通过HTTP请求头（User-Agent, Cookie, Referer）或者其他方式将payload作为环境变量传递给目标系统。
4.  **触发漏洞：** 当Bash shell处理包含恶意代码的环境变量时，会执行嵌入的命令。
5.  **获取权限：** 利用反弹shell或其他方式获取目标系统的控制权。

**项目地址:** [knightc0de/Shellshock_vuln_Exploit](https://github.com/knightc0de/Shellshock_vuln_Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)