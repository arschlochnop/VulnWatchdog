## CVE-2023-25690-Apache HTTP Server-HTTP Request Smuggling

**漏洞编号:** CVE-2023-25690

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致绕过访问控制，代理未预期的URL到现有源服务器，以及缓存投毒。

**影响版本:** 2.4.0 <= version <= 2.4.55

**利用条件:** 需要启用mod_proxy和某种形式的RewriteRule或ProxyPassMatch，其中非特定模式匹配用户提供的请求目标(URL)数据的某些部分，然后使用变量替换重新插入到代理的请求目标中。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-25690 漏洞存在于 Apache HTTP Server 2.4.0 到 2.4.55 版本中，是由于 mod_proxy 模块在特定配置下存在 HTTP 请求走私漏洞。

**漏洞利用方式：**

1.  **漏洞原理：** 当 Apache 启用了 `mod_proxy` 模块，并且配置了 `RewriteRule` 或 `ProxyPassMatch`，如果这些规则使用非特定的模式匹配用户提供的 URL，并将其重新插入到代理的请求中，就可能导致 HTTP 请求走私。
2.  **利用场景：**  攻击者可以通过构造特殊的 HTTP 请求，利用 `RewriteRule` 或 `ProxyPassMatch` 的模式匹配和变量替换机制，将恶意请求注入到后端服务器。例如，攻击者可以在 URL 中注入 CRLF 字符，从而实现 header 注入和请求拆分。
3.  **具体步骤：**
    *   构造包含恶意 header 或 payload 的 URL。
    *   该 URL 被 `RewriteRule` 或 `ProxyPassMatch` 规则匹配，并将恶意 payload 插入到代理的请求中。
    *   代理服务器将构造的请求发送到后端服务器。
    *   由于请求拆分，恶意 payload 可以被解释为新的请求，从而攻击后端服务器。
4.  **示例配置：**

```
RewriteEngine on
RewriteRule "^/here/(.*)" "http://example.com:8080/elsewhere?$1"; [P]
ProxyPassReverse /here/ http://example.com:8080/
```

**投毒风险评估：**

此仓库的目的是提供漏洞的PoC，用于验证漏洞的存在和利用方式。虽然存在一定的投毒风险，但风险较低，原因如下：

*   **代码透明：** 提供的 Dockerfile 和 httpd.conf 配置较为完整，易于审查。
*   **文档详细：** README.md 文件对漏洞原理、利用方式、环境搭建等进行了详细描述。
*   **关注度高：**  该漏洞是公开披露的漏洞，相关信息较多，易于识别潜在的恶意代码。

虽然风险较低，但仍建议仔细审查 PoC 代码，确保环境安全。

**项目地址:** [dhmosfunk/CVE-2023-25690-POC](https://github.com/dhmosfunk/CVE-2023-25690-POC)

**漏洞详情:** [CVE-2023-25690](https://nvd.nist.gov/vuln/detail/CVE-2023-25690)