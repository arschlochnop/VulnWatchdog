## CVE-2024-11972-Hunk Companion-未授权插件安装

**漏洞编号:** CVE-2024-11972

**漏洞类型:** 未授权插件安装

**影响应用:** Hunk Companion WordPress插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.9.0

**利用条件:** 需要目标WordPress站点安装了受影响版本的Hunk Companion插件，且REST API未正确鉴权。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-11972 漏洞允许未经身份验证的攻击者利用 Hunk Companion WordPress 插件 1.9.0 之前的版本中不正确的 REST API 端点授权，从而安装和激活来自 WordPress.org 存储库的任意插件。这包括可能存在已知漏洞或包含恶意代码的插件。利用方式如下：

1.  **漏洞描述：** 插件未对REST API endpoint做正确的权限校验，导致未授权用户也可以调用相关接口。
2.  **利用方式：** 攻击者可以构造恶意的HTTP POST请求，绕过身份验证，调用安装和激活插件的REST API endpoint。通过指定插件名称，攻击者可以安装任意WordPress.org上的插件。
3.  **攻击后果：** 成功利用此漏洞可能导致远程代码执行 (RCE)，因为攻击者可以安装包含恶意代码的插件，从而完全控制受影响的 WordPress 站点。
4. **关于投毒风险：**提供的代码片段是AGPL协议的许可文件，无法直接判断是否存在投毒风险。但鉴于攻击者可以通过该漏洞安装任意插件，如果安装的插件本身包含恶意代码，则存在投毒风险。 即使POC本身没有恶意代码，攻击者也可以利用此漏洞安装恶意插件，从而达到投毒的目的。所以存在一定的风险，大约10%。

**项目地址:** [JunTakemura/exploit-CVE-2024-11972](https://github.com/JunTakemura/exploit-CVE-2024-11972)

**漏洞详情:** [CVE-2024-11972](https://nvd.nist.gov/vuln/detail/CVE-2024-11972)