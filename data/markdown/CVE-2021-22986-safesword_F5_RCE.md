## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本的 F5 BIG-IP/BIG-IQ，并且可以访问 iControl REST 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以通过向易受攻击的 iControl REST 端点发送特制的 POST 请求来利用此漏洞，从而在目标系统上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明，该漏洞已被积极利用，并且有公开可用的 POC 代码。

**投毒风险：**

分析提供的 POC 代码 `f5_rce.py`，没有发现明显的恶意代码。该脚本使用 `requests` 库发送 HTTP 请求，并根据响应判断漏洞是否存在。`README.md` 文件描述了脚本的使用方法，并指出了该 POC 可能存在的局限性。但是，仍然存在细微的投毒风险，例如：

*   **依赖风险：** 脚本依赖 `requests` 库。如果攻击者控制了该库的安装源，可能会植入恶意代码。
*   **命令注入：** 脚本使用 `format` 函数格式化命令，可能存在命令注入的风险，但可能性较低，因为参数 `--command` 的执行，需要用户进行主动设置。
*   **输出文件：** `save_file` 函数会将目标 URL 保存到文件中，可能造成信息泄露。该文件默认保存在攻击者机器上，影响较小。

因此，投毒风险较低，约为 5%。

**利用方式：**

1.  攻击者向目标 F5 BIG-IP/BIG-IQ 设备的 iControl REST 接口发送特制的 POST 请求。
2.  请求的 payload 包含要执行的命令。
3.  由于漏洞存在于身份验证绕过中，因此攻击者无需提供有效的身份验证凭据即可发送此请求。
4.  目标设备执行命令，并将结果返回给攻击者。

提供的 POC 代码 `f5_rce.py` 实现了此利用方式。该脚本接受目标 URL 和要执行的命令作为参数，并发送相应的 POST 请求。

**项目地址:** [safesword/F5_RCE](https://github.com/safesword/F5_RCE)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)