## CVE-2023-30258 MagnusBilling 命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，允许远程攻击者执行任意命令

**影响版本:** 6.x 和 7.x

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30258 是 MagnusBilling 6.x 和 7.x 版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送恶意的 HTTP 请求来执行任意操作系统命令。根据搜索结果和提供的漏洞利用代码（TryHackMe Room Walkthrough），该漏洞利用方式如下：

1.  **漏洞定位：** 通过网络扫描和目录枚举（如使用Nmap和Gobuster）发现 MagnusBilling 应用实例。
2.  **漏洞触发：**  利用 Metasploit 模块 `exploit/linux/http/magnusbilling_unauth_rce_cve_2023_30258`，该模块专门针对此漏洞。此漏洞存在于 `icepay.php` 脚本中（根据 Github 搜索结果 `tinashelorenzi/CVE-2023-30258-magnus-billing-v7-exploit`）。
3.  **利用过程：** 配置 Metasploit 模块，设置目标主机 (RHOSTS) 和本地监听地址 (LHOST)，然后运行 exploit 即可获得 Meterpreter shell。
4.  **有效性：** 提供的 Metasploit 模块已经存在，且搜索结果中 Rapid7 也有相关模块，表明 POC 是有效的。
5.  **投毒风险：** 提供的代码片段是一个 TryHackMe 房间的 walkthrough，主要是演示漏洞利用过程，并非直接的漏洞利用代码，而是Metasploit利用教程，没有发现任何恶意或后门代码。因此，投毒风险为0%。

**项目地址:** [AdityaBhatt3010/TryHackMe-Room-Walkthrough-Billing](https://github.com/AdityaBhatt3010/TryHackMe-Room-Walkthrough-Billing)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)