## CVE-2022-30333-UnRAR目录遍历

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录遍历

**影响应用:** UnRAR (Linux/UNIX)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行存在漏洞的UnRAR版本，且攻击者能够控制或影响RAR文件的内容或解压过程。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于RARLAB UnRAR 6.12之前的Linux和UNIX版本中。攻击者可以构造恶意的RAR压缩包，其中包含指向任意文件路径的符号链接。当UnRAR解压该压缩包时，会将指定文件写入目标系统的任意位置。根据搜索结果和提供的POC代码，利用方式如下：

1.  **构造恶意RAR压缩包：** 使用POC脚本（`cve-2022-30333.rb`）生成包含恶意符号链接的RAR压缩包。脚本接收两个参数：目标文件路径（包括目录遍历）和payload文件路径。脚本会将payload写入到指定的目标文件路径。
2.  **利用目录遍历：** 恶意压缩包中的符号链接包含目录遍历字符（如`../../`），允许攻击者突破UnRAR的解压目录限制，写入到系统中的任意位置。
3.  **写入任意文件：** 攻击者可以通过修改脚本中的目标文件路径，将恶意payload写入到特定的系统文件中，例如`~/.ssh/authorized_keys`以实现SSH免密登录，或者写入Web服务器的公共目录以执行任意代码(如Zimbra的例子)。

**有效性：** 根据漏洞描述和POC代码，该漏洞利用方式是有效的。POC代码已经验证了该漏洞的存在。

**投毒风险：** 查看ruby脚本，发现脚本的作用是根据用户输入的目标路径和payload生成rar压缩包。没有发现任何与脚本原始功能无关的代码，因此投毒风险较低。所以此处投毒风险为0%。

**项目地址:** [J0hnbX/CVE-2022-30333](https://github.com/J0hnbX/CVE-2022-30333)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)