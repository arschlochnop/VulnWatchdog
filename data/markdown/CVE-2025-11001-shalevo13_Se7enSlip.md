## CVE-2023-52169-7-Zip-符号链接穿越漏洞

**漏洞编号:** CVE-2025-11001

**漏洞类型:** 符号链接穿越

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意文件写入和潜在的代码执行

**影响版本:** < 23.01

**利用条件:** 需要用户使用受影响版本的 7-Zip 解压恶意 ZIP 文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-52169 是 7-Zip 中的一个符号链接穿越漏洞。攻击者可以创建恶意的 ZIP 压缩包，当受害者使用存在漏洞的 7-Zip 版本（< 23.01）解压时，该压缩包可以写入到解压目录之外的文件。这通过利用以下机制实现：

1.  **符号链接穿越：** ZIP 文件包含指向解压目录之外的符号链接。
2.  **路径穿越：** 使用 `../` 序列来尝试跳出解压目录。
3.  **绝对路径：** 在 ZIP 文件中使用绝对路径，尝试写入文件系统的任意位置。

提供的漏洞利用代码是一个交互式 Web 应用程序（Se7enSlip），旨在演示和检测此漏洞。虽然该应用程序本身包含安全特性，例如速率限制和文件验证，但它也提供了一个创建包含各种漏洞模式的测试 ZIP 文件的 API 端点 (`POST /api/create-test-zip`)。这使得用户可以方便地生成用于测试目的的恶意 ZIP 文件。

**有效性：** 根据描述和 CVE 信息，该 POC 代码是有效的，因为它演示了漏洞的利用方式并帮助检测漏洞的存在。

**投毒风险：** 代码库中存在投毒代码的风险较低，估计为 10%。主要风险在于以下几个方面：

*   **create-test-zip端点:** 恶意开发者可能通过 create-test-zip 生成包含超出预期功能的 ZIP 文件，比如进行反弹shell尝试。
*   **依赖风险：** 虽然前端使用了 Vanilla JavaScript 减少了依赖，但后端 Node.js 仍然依赖了如 Express.js, Multer, yauzl 等库，如果这些库被投毒，则可能影响 Se7enSlip。

**利用方式：**

1.  攻击者创建一个恶意的 ZIP 文件，其中包含符号链接、路径穿越序列或绝对路径。
2.  攻击者诱骗受害者使用存在漏洞的 7-Zip 版本解压该 ZIP 文件。
3.  7-Zip 解压 ZIP 文件时，未能正确验证文件路径，导致文件被写入到解压目录之外的任意位置。
4.  这可能导致任意文件覆盖、配置文件修改，甚至在某些情况下执行恶意代码，从而导致系统被攻击者控制。

**项目地址:** [shalevo13/Se7enSlip](https://github.com/shalevo13/Se7enSlip)

**漏洞详情:** [CVE-2025-11001](https://nvd.nist.gov/vuln/detail/CVE-2025-11001)