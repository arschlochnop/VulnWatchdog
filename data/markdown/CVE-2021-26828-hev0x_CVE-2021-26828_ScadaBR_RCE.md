## CVE-2021-26828-ScadaBR-任意文件上传导致远程代码执行

**漏洞编号:** CVE-2021-26828

**漏洞类型:** 任意文件上传

**影响应用:** ScadaBR

**危害等级:** 高危，可能导致远程代码执行，控制整个系统

**影响版本:** 通过 0.9.1 在 Linux 上，通过 1.12.4 在 Windows 上

**利用条件:** 需要远程认证用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26828 漏洞存在于 OpenPLC ScadaBR 中，允许经过身份验证的远程用户通过 view_edit.shtm 上传和执行任意 JSP 文件。利用方式为：

1.  **身份验证：** 首先需要使用有效的用户名和密码登录 ScadaBR 系统。
2.  **上传恶意 JSP 文件：** 登录后，攻击者通过 view_edit.shtm 页面上传包含恶意代码的 JSP 文件。POC代码中通过multipart/form-data方式上传webshell.jsp。
3.  **远程代码执行：** 上传的 JSP 文件会被服务器解析并执行，从而允许攻击者在服务器上执行任意代码。

**关于有效性：**
根据提供的漏洞信息和POC代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果表明该漏洞允许经过身份验证的用户上传任意JSP文件并执行。POC代码也展示了如何利用该漏洞上传 webshell，从而实现远程代码执行。

**关于投毒风险：**
POC代码中，虽然主要功能是上传webshell以实现反弹shell，但仍存在一定的投毒风险，风险比例为10%。

*   **反弹shell依赖：** POC利用代码包含反弹shell的JSP payload，依赖于攻击者指定的IP地址和端口。如果攻击者更改了这些参数，可能会导致受害者暴露其IP地址或者连接到恶意的服务器。
*   **代码的潜在修改：** 虽然提供的代码看起来直接了当，但攻击者可能修改JSP payload，例如包含额外的恶意代码或者后门，从而在受害者不知情的情况下植入恶意程序。

总的来说，虽然主要目的是演示漏洞利用，但不能完全排除作者或其他人修改代码以包含恶意功能的可能性，因此存在一定的投毒风险。

**项目地址:** [hev0x/CVE-2021-26828_ScadaBR_RCE](https://github.com/hev0x/CVE-2021-26828_ScadaBR_RCE)

**漏洞详情:** [CVE-2021-26828](https://nvd.nist.gov/vuln/detail/CVE-2021-26828)