## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要目标系统安装Git LFS 2.12.0，并且使用受影响的Git客户端，如GitHub CLI, GitHub Desktop等

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0中，允许远程代码执行。攻击者可以构造包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，恶意代码会在受害者的机器上执行。

**有效性：** 提供的Go语言POC代码是有效的，它通过将自身（编译后的git.exe）放置在特定位置，并在`git clone`操作期间被调用，从而执行恶意代码。代码中包含反向shell的逻辑，如果连接失败，会执行计算器程序作为测试。

**投毒风险：** 代码本身的主要功能是利用漏洞，从分析来看，该POC代码不包含明显的恶意投毒行为。代码目的明确，虽然会产生恶意行为，但那是漏洞利用的必然结果。因此，投毒风险评估为0%。

**利用方式：**

1.  **准备恶意仓库：** 攻击者创建一个包含恶意Git LFS对象的仓库。
2.  **植入Payload：**  攻击者将编译后的恶意Go代码（伪装成`git.exe`）放入仓库中，或者确保受害者clone仓库时，将该文件下载到特定目录并覆盖原有的`git.exe`。
3.  **诱骗克隆：**  攻击者诱骗受害者克隆这个恶意仓库。
4.  **触发漏洞：**  当受害者执行`git clone`命令时，Git LFS会尝试处理LFS对象，触发漏洞，从而执行攻击者植入的恶意代码。
5.  **执行恶意代码：** 恶意代码执行，通常是反向Shell，允许攻击者远程控制受害者的机器。或者弹出计算器。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955-Go)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)