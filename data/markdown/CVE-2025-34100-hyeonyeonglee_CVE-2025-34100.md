## CVE-2025-34100-BuilderEngine-RCE

**漏洞编号:** CVE-2025-34100

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** BuilderEngine

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 3.5.0

**利用条件:** 目标系统安装BuilderEngine 3.5.0，并且未对文件上传功能进行任何身份验证或访问控制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于BuilderEngine 3.5.0中，由于集成了elFinder 2.0文件管理器和jQuery File Upload插件，且未能正确验证或限制文件类型和上传位置，导致未经身份验证的攻击者可以上传恶意的.php文件并在服务器上执行任意PHP代码。漏洞利用方式如下：

1.  **查找上传点：** 通过分析目标系统，确定elFinder文件管理器的上传接口。根据漏洞描述，该接口可能位于`/themes/dashboard/assets/plugins/jquery-file-upload/server/php/`或者`/finder/connector.php`附近。
2.  **上传恶意文件：** 构造一个包含恶意PHP代码的.php文件，例如一个简单的webshell。由于系统没有进行文件类型验证，可以直接上传。
3.  **执行恶意代码：** 上传成功后，访问上传的.php文件，触发恶意代码的执行。由于代码在web服务器进程上下文中执行，攻击者可以获得对服务器的控制权。

**POC有效性分析：**

根据漏洞描述和搜索结果，此漏洞利用链非常直接，并且存在公开的Metasploit模块。因此，提供的PoC，即上传`.php`文件执行，是有效的。

**投毒风险分析：**

提供的文件包括`docker-compose.yml`，`codeception.yml`，`finder.html`，和几个php文件。这些文件用于搭建一个可复现漏洞的环境。`docker-compose.yml`定义了web和db服务，`finder.html`提供了 elFinder 的界面，而其他的php文件属于builderengine本身。

虽然这些文件本身不包含明显的恶意代码，但是，创建漏洞环境本身可能被用于恶意目的。例如，有人可能使用此docker环境进行恶意软件测试或渗透测试练习。此外，`finder.html`使用的外部资源（如jQuery和jQuery UI的CDN）存在被劫持的风险，但这不属于代码本身的投毒。总的来说，直接投毒的风险较低，但间接的风险是存在的。 投毒风险大约5%。


**项目地址:** [hyeonyeonglee/CVE-2025-34100](https://github.com/hyeonyeonglee/CVE-2025-34100)

**漏洞详情:** [CVE-2025-34100](https://nvd.nist.gov/vuln/detail/CVE-2025-34100)