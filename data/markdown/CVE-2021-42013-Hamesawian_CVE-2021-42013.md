## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49和2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞允许攻击者利用路径遍历攻击，将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有受到“require all denied”的默认配置保护，请求可能会成功。如果CGI脚本对这些别名路径也启用，可能导致远程代码执行。
提供的POC代码使用`curl`命令尝试通过路径遍历读取`/etc/passwd`文件。攻击者通过`cgi-bin`目录，使用编码后的`../`来尝试访问`/etc/passwd`，验证是否存在路径遍历漏洞。

**投毒风险分析：**
查看漏洞利用代码仓库，其中包含用于测试漏洞的curl命令，以及一个README文件，描述了漏洞和版本。并没有发现任何恶意代码，因此投毒风险为0%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含编码后的路径遍历字符（如`%32%65`代表`.`）的URL，尝试访问受限目录之外的文件。
2.  **条件：** 成功利用的前提是：
    *   目标服务器运行Apache HTTP Server 2.4.49或2.4.50。
    *   受影响的文件没有被`require all denied`配置保护。
    *   CGI脚本已启用。
3.  **远程代码执行（如果满足CGI条件）：** 如果CGI脚本已启用，攻击者可以通过上传恶意CGI脚本并执行，从而实现远程代码执行。

**总结：** 此漏洞的利用依赖于服务器配置。 如果`/etc/passwd`可以读取，代表着高危漏洞利用的开始,可以进行进一步利用,如果CGI可用，那么将可以达成远程代码执行。

**项目地址:** [Hamesawian/CVE-2021-42013](https://github.com/Hamesawian/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)