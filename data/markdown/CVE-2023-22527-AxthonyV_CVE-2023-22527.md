## CVE-2023-22527-Confluence-RCE

**漏洞编号:** CVE-2023-22527

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 8.0.0 <= version < 8.5.4

**利用条件:** 目标Confluence实例版本在受影响范围内，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22527是一个Atlassian Confluence Data Center和Server中的模板注入漏洞，允许未经身份验证的攻击者实现远程代码执行。根据漏洞库信息，受影响的版本是8.0.0到8.5.3。搜索引擎结果表明，该漏洞已被积极利用，并可能被用于cryptojacking和勒索软件攻击。POC代码是一个Python脚本，它通过向`/template/aui/text-inline.vm`端点发送包含OGNL表达式的POST请求来利用该漏洞。OGNL表达式允许攻击者执行任意Java代码。该脚本提供了一个半交互式shell，允许攻击者执行命令并查看结果。

**有效性：** 根据漏洞信息和搜索结果，该POC代码是有效的，因为许多文章都表明该漏洞被积极利用，且公开的POC允许进行RCE。

**投毒风险：** 检查提供的POC代码，没有发现明显的恶意代码或后门。该脚本直接利用OGNL注入执行命令。LICENSE文件和README.md文件也符合正常的开源项目结构。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造恶意的OGNL表达式。
2.  攻击者将包含OGNL表达式的payload通过POST请求发送到`/template/aui/text-inline.vm`端点。
3.  Confluence服务器解析OGNL表达式，导致任意Java代码执行。
4.  攻击者利用执行的Java代码在服务器上执行命令。

**项目地址:** [AxthonyV/CVE-2023-22527](https://github.com/AxthonyV/CVE-2023-22527)

**漏洞详情:** [CVE-2023-22527](https://nvd.nist.gov/vuln/detail/CVE-2023-22527)