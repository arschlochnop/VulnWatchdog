## CVE-2025-24813-Apache Tomcat 反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下所有条件：
1.  默认Servlet开启了写入 (默认关闭)
2.  支持Partial PUT (默认开启)
3.  应用使用Tomcat基于文件的Session持久化，且使用默认存储位置
4.  应用包含一个可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个反序列化远程代码执行漏洞。该漏洞利用了Tomcat处理部分 PUT 请求时文件路径等效性问题，攻击者可以通过上传恶意构造的文件，在特定配置下实现远程代码执行。

**有效性分析:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果显示该漏洞已经被积极利用，并且有公开的利用代码。POC代码中包含了版本检测功能，以及利用ysoserial生成payload进行攻击的功能。

**投毒风险分析:**

POC 代码存在一定的投毒风险，虽然主要功能是漏洞验证，但是可能存在以下潜在风险：
*   **Payload 生成依赖外部工具:**  POC依赖ysoserial生成payload，如果ysoserial被替换为恶意版本，可能导致投毒。
*   **自定义恶意Payload:**  攻击者可能会修改payload生成部分，植入恶意代码。
*   **不完善的错误处理:** 代码中错误处理可能不够完善，可能存在导致拒绝服务或其他意外行为。

综合考虑，POC代码主要用于验证漏洞，但仍存在一定投毒风险。可以评估为20%。

**利用方式:**

1.  **版本检测:**  POC首先检测目标Tomcat的版本，判断是否存在漏洞。
2.  **Payload生成:**  如果目标版本存在漏洞，POC会根据选择的模式（弹计算器、DNS验证等），使用ysoserial生成反序列化payload。
3.  **Partial PUT上传:**  POC通过发送带有`Content-Range`头的PUT请求，将payload上传到Tomcat服务器。
4.  **触发反序列化:**  通过构造包含恶意Session ID的GET请求或其他方式触发反序列化，从而执行payload中的恶意代码。

**项目地址:** [Franconyu/Poc_for_CVE-2025-24813](https://github.com/Franconyu/Poc_for_CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)