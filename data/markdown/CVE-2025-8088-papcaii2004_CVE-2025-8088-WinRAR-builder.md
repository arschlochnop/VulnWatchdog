## CVE-2025-8088-WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者通过构造恶意压缩文件执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开恶意构造的RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是一个影响Windows版WinRAR的路径遍历漏洞，攻击者可以利用此漏洞通过构造恶意的RAR压缩文件执行任意代码。漏洞利用方式为：

1.  攻击者创建一个包含恶意payload的RAR压缩文件。
2.  该压缩文件利用路径遍历漏洞，将payload写入到任意目录，例如启动目录。
3.  当用户使用存在漏洞的WinRAR版本（<=7.12）解压该压缩文件时，payload将被写入目标目录。
4.  如果payload被写入启动目录，下次系统启动时，payload将被执行。

**漏洞利用代码分析：**

提供的漏洞利用代码（builder.py）是一个用于生成恶意RAR文件的Python脚本。该脚本的功能包括：

*   创建包含多个ADS（Alternate Data Streams）的RAR压缩文件，每个ADS对应不同的路径遍历深度。
*   修改RAR文件头，以利用路径遍历漏洞。
*   将payload写入Windows启动目录，以便在系统重启时自动执行。

脚本允许用户指定多个payload和目标提取路径。`PAYLOAD_MAPPING`变量定义了payload文件名和目标提取路径的映射关系。

**投毒风险评估：**

该POC代码的主要功能是生成恶意RAR文件，实现漏洞利用。代码本身看起来没有明显的后门或者恶意行为，但是，payload本身可能是恶意的。用户在使用此POC时，需要自行准备payload，并对其安全性负责。因此，投毒风险在于用户使用的payload是否包含恶意代码。

由于POC需要用户自己添加payload，作者可以在payloads目录中添加示例payload，诱导用户使用。这些示例payload可能包含恶意代码。虽然可能性较低, 但是仍存在一定的风险, 故判定投毒风险为10%。

**项目地址:** [papcaii2004/CVE-2025-8088-WinRAR-builder](https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)