## CVE-2025-34036-TVT-DVR-命令注入

**漏洞编号:** CVE-2025-34036

**漏洞类型:** OS 命令注入

**影响应用:** TVT CCTV-DVR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 0

**利用条件:** 需要网络访问 DVR 的 81 或 82 端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-34036 漏洞存在于 Shenzhen TVT 生产的白标 DVR 设备中，影响一个名为 "Cross Web Server" 的自定义 HTTP 服务，该服务监听 TCP 端口 81 和 82。该漏洞是由于 Web 界面在处理 /language/[lang]/index.html 请求时，对 [lang] 输入未进行充分的过滤，导致在 tar 命令提取语言包时存在命令注入。攻击者可以通过构造恶意的 [lang] 值，在目标设备上执行任意系统命令，权限为 root。

**有效性分析：**

提供的漏洞利用代码是一个 Docker 镜像，用于模拟存在漏洞的 TVT DVR 设备。app.py 文件模拟了 /language/<path:lang> 接口，并检查传入的 lang 参数中是否包含 "echo poc-content > /tmp/poc.txt" 字符串。如果包含，则设置 poc_created 标志为 True，并在访问 /poc.txt 时返回 "poc-content"。 该模拟是为了方便研究人员测试 Nuclei 模板，本身不包含真实的漏洞利用。

根据漏洞库信息，真实的漏洞利用需要在 [lang] 参数中注入 shell 命令。

**投毒风险分析：**

该仓库的主要目的是提供一个安全可控的环境来测试针对 CVE-2025-34036 的 Nuclei 模板。代码中没有明显的恶意后门，但仍然存在一些潜在的风险：

1.  **subprocess.check_output 安全风险**：`app.py` 中的 `subprocess.check_output(cmd, shell=True, stderr=subprocess.STDOUT, text=True)` 函数存在风险。尽管目的是模拟漏洞，但如果研究人员修改此代码，可能引入真实的命令注入。
2.  **依赖风险**：Dockerfile 中使用了 `pip install flask` 安装 Flask 依赖。虽然 Flask 本身很常用，但任何第三方库都可能存在安全问题。
3.  **模拟不完全导致误判**：模拟环境可能无法完全还原真实设备的漏洞触发条件，可能导致 Nuclei 模板的误报或漏报。

综合来看，直接利用提供的代码进行攻击的可能性较低，但由于存在 shell=True 的使用，如果被恶意修改，存在潜在的投毒风险。因此，投毒风险评定为10%。

**漏洞利用方式：**

1.  攻击者构造包含恶意命令的 URL，例如：`http://<target>/language/$(reboot)/index.html`
2.  目标设备接收到请求，将恶意命令拼接到 tar 命令中，导致命令注入。
3.  攻击者可以在目标设备上执行任意系统命令，例如重启设备、下载恶意软件等。

**项目地址:** [Prabhukiran161/cve-2025-34036](https://github.com/Prabhukiran161/cve-2025-34036)

**漏洞详情:** [CVE-2025-34036](https://nvd.nist.gov/vuln/detail/CVE-2025-34036)