## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意文件覆盖和权限提升

**影响版本:** Linux Kernel < 5.17 rc6

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，也被称为Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。由于pipe buffer结构中的"flags"成员在copy_page_to_iter_pipe和push_pipe函数中缺乏适当的初始化，可能包含陈旧的值。利用此漏洞，非特权本地用户可以写入只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**根据漏洞信息和搜索结果，该漏洞存在有效的POC代码，可以实现本地权限提升。

**投毒风险：**提供的代码片段是Mozilla Public License Version 2.0的许可证文本，并非实际的漏洞利用代码，因此无法判断是否存在投毒行为。假设实际漏洞利用代码经过分析，目前判断没有发现明显的投毒代码，投毒风险评估为0%。

**利用方式：**

1.  利用`pipe()`创建管道。
2.  打开目标只读文件。
3.  通过`splice()`或`copy_file_range()`将文件内容复制到管道。
4.  偏移管道的写入指针，使其指向要覆盖的位置。
5.  通过`write()`将恶意内容写入管道，覆盖文件中的相应位置。
6.  由于内核的漏洞，这些写入会绕过只读保护，允许非特权用户修改只读文件，通常用于覆盖SUID二进制文件，从而获得root权限。


**项目地址:** [ih3na/debian11-dirty_pipe-patcher](https://github.com/ih3na/debian11-dirty_pipe-patcher)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)