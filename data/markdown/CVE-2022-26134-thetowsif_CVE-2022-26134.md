## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Confluence Server and Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 7.4.17, < 7.13.7, < 7.14.3, < 7.15.2, < 7.16.4, < 7.17.4, < 7.18.1

**利用条件:** 目标Confluence实例存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个 OGNL 注入漏洞。未经身份验证的攻击者可以通过构造恶意的 OGNL 表达式，在目标服务器上执行任意代码。 

**有效性:** 
根据漏洞库信息、搜索引擎结果（如Rapid7, NVD, Qualys等安全厂商的分析文章）和提供的PoC代码，可以判定该漏洞是真实存在的，并且有公开可用的利用代码，因此该漏洞利用的有效性很高。

**投毒风险:** 
提供的PoC代码主要功能是：
1.  **版本检测:** 通过访问`/login.action`页面，提取页面中的版本信息。
2.  **Payload构造与发送:** 构造包含恶意OGNL表达式的URL，并发送GET请求。
3.  **命令执行结果获取:** 从HTTP响应头`X-Cmd-Response`中提取命令执行结果。

代码本身的功能符合CVE-2022-26134漏洞的利用方式，用于执行命令。 仔细分析了给定的Python POC 代码以及相关文件，并未发现明显的恶意代码或者后门。`requirements.txt`文件中指定的依赖库版本看起来也是合理的。 但是，任何代码都存在潜在的风险，作者可能以不易察觉的方式隐藏恶意代码。 尽管直接证据不足，我依然维持一个较低的风险评估，为5%。

**利用方式:**
1.  攻击者发送一个特制的HTTP GET请求，其中包含恶意的OGNL表达式，该表达式会被Confluence服务器解析并执行。
2.  OGNL表达式中包含需要执行的系统命令，例如，反弹shell、添加用户等。
3.  Confluence服务器执行OGNL表达式中的命令，并将命令执行结果写入HTTP响应头中（`X-Cmd-Response`）。
4.  攻击者从HTTP响应头中获取命令执行结果。

总的来说，利用方式简单直接，无需身份验证，危害巨大。

**项目地址:** [thetowsif/CVE-2022-26134](https://github.com/thetowsif/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)