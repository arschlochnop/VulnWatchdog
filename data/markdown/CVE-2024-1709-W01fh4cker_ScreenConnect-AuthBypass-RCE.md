## CVE-2024-1709 - ConnectWise ScreenConnect 身份验证绕过与远程代码执行

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 严重，可能导致未授权访问、信息泄露和远程代码执行

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行受影响的 ConnectWise ScreenConnect 版本，且攻击者可访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，对 CVE-2024-1709 的有效性、投毒风险和利用方式进行评估分析。

**1. 有效性:**

*   漏洞库信息表明 CVE-2024-1709 是一个身份验证绕过漏洞，影响 ConnectWise ScreenConnect 23.9.7 及更早版本，允许攻击者直接访问敏感信息或关键系统。CVSS 评分高达 10 分，表明其严重性。CISA 已将其添加到已知被利用的漏洞目录中，证明该漏洞正在被积极利用。
*   搜索结果也确认了该漏洞的严重性，并指出存在公开可用的 PoC 利用代码。
*   提供的漏洞利用代码（ScreenConnect-AuthBypass-RCE.py）旨在利用 CVE-2024-1708 和 CVE-2024-1709 实现远程代码执行。该脚本允许攻击者添加具有指定用户名和密码的新管理员用户，从而绕过身份验证。README.md 文件中包含了使用说明和利用示例。
*   综上，该漏洞是有效的，并且存在可用的 PoC 代码，允许攻击者绕过身份验证并可能执行远程代码。

**2. 投毒风险:**

*   分析提供的 POC 代码（`ScreenConnect-AuthBypass-RCE.py`）：
    *   脚本的功能主要是身份验证绕过和添加新用户，以及尝试远程代码执行。
    *   脚本中包含创建 WebHandler 的逻辑,  使用 `ProcessRequest` 函数执行系统命令。
    *   代码中使用 `requests` 库发送 HTTP 请求，这本身并无恶意，但如果服务器响应被篡改或劫持，可能存在风险。
    *   代码逻辑较为清晰，没有明显的隐藏恶意代码的迹象。
*   对 `README.md` 文件的分析：
    *   文件包含安装依赖和使用说明，以及免责声明。没有发现任何可疑内容。
*   虽然主要的目的是漏洞利用，但仍然存在一些潜在的投毒风险，虽然很小，例如：
    *   **依赖项风险：**  虽然 `requests` 是一个常见的库，但恶意作者可能会通过替换 `pip install` 源或使用类似名称的恶意软件包来引入风险。
    *   **服务器端风险：** 脚本成功执行的前提是目标服务器存在漏洞。如果攻击者诱骗用户在受感染的服务器上运行该脚本，服务器本身可能被恶意控制，从而导致进一步的攻击。
    *   **代码篡改：**  在下载和运行脚本之间，攻击者可能会篡改代码，添加恶意功能。
*   因此，投毒风险评估为 10%。这个百分比反映了以下几点：代码本身看起来主要是漏洞利用，但仍然存在一些与依赖项、运行环境相关的潜在风险。

**3. 利用方式:**

1.  **身份验证绕过:** 攻击者利用 CVE-2024-1709 绕过 ConnectWise ScreenConnect 的身份验证机制。
2.  **创建管理员用户:** 使用 PoC 脚本添加一个新的管理员帐户，从而获得对系统的完全控制权。
3.  **远程代码执行 (RCE):** 攻击者利用 CVE-2024-1708 (path traversal) 上传恶意文件，从而在服务器上执行任意代码。
4.  **控制系统:** 攻击者获得系统控制权后，可以访问敏感信息、安装恶意软件或进行其他恶意活动。

总而言之，CVE-2024-1709 是一个严重的安全漏洞，利用难度低，影响范围广。系统管理员应尽快升级到 ConnectWise ScreenConnect 23.9.8 或更高版本，以修复此漏洞。

**项目地址:** [W01fh4cker/ScreenConnect-AuthBypass-RCE](https://github.com/W01fh4cker/ScreenConnect-AuthBypass-RCE)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)