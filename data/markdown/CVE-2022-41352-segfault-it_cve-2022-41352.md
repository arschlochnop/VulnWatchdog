## CVE-2022-41352-Zimbra-RCE

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 远程代码执行

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要能够上传文件到受影响的Zimbra服务器，通常通过邮件附件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41352 是 Zimbra Collaboration Suite 8.8.15 和 9.0 中的一个问题，攻击者可以通过 amavis 利用 cpio 漏洞上传任意文件。具体来说，攻击者可以构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名（例如，`../../../opt/zimbra/jetty/webapps/zimbra/public/shell.jsp`）。当 amavis 使用 cpio 解压此归档文件时，这些文件将被写入到 Zimbra 的 webapps 目录中，从而允许攻击者访问并执行上传的任意文件（如 JSP shell）。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，且存在公开的POC。因此，该漏洞的利用是有效的。

**投毒风险：** 提供的“漏洞利用代码”实际上是一个GNU通用公共许可证的文本文件，不是真正的漏洞利用代码。但是从搜索引擎的结果Cr4ckC4t/cve-2022-41352-zimbra-rce 这个仓库来看存在可利用代码。此条仅分析给出的文件，根据给出的LICENSE文件内容来看，该文件本身没有包含任何恶意代码或后门。因此，可以认为此仓库中作者隐藏的投毒代码的可能性为0%。

**利用方式：**
1.  攻击者构造一个恶意的 cpio 归档文件，其中包含具有路径遍历的文件名，目标是将文件写入 `/opt/zimbra/jetty/webapps/zimbra/public/` 目录。例如，将一个 JSP shell 写入该目录。
2.  攻击者通过某种方式（例如，通过电子邮件附件）将该恶意 cpio 归档文件上传到受影响的 Zimbra 服务器。
3.  Amavis 使用 cpio 解压该归档文件，由于路径遍历漏洞，恶意文件被写入到指定目录。
4.  攻击者现在可以通过访问上传的文件（例如，`https://zimbra.example.com/shell.jsp`）来执行任意代码。

**项目地址:** [segfault-it/cve-2022-41352](https://github.com/segfault-it/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)