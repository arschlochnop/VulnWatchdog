## CVE-2017-1000499-phpMyAdmin-CSRF

**漏洞编号:** CVE-2017-10004

**漏洞类型:** CSRF

**影响应用:** phpMyAdmin

**危害等级:** 中危，可能导致未经授权的数据库操作

**影响版本:** 4.7.x (prior to 4.7.6.1/4.7.7)

**利用条件:** 用户需要登录phpMyAdmin，并访问攻击者提供的恶意页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

提供的漏洞利用代码是针对phpMyAdmin的CSRF漏洞CVE-2017-1000499的PoC。攻击者可以通过诱骗已登录phpMyAdmin的用户访问包含恶意<img>标签的HTML页面，利用这些标签向phpMyAdmin服务器发送预先构造的SQL查询，例如删除数据库。由于用户已经登录，这些请求将以用户的身份执行。 

**有效性：**
该PoC利用了phpMyAdmin中的一个CSRF漏洞，如果目标phpMyAdmin实例的版本在受影响范围内，且用户已经登录，则该PoC是有效的。

**投毒风险：**
代码仓库中存在轻微的投毒风险，风险值在10%左右。 虽然主要的利用方式是CSRF攻击，直接体现在`web/index.html`中。然而，该HTML文件中硬编码了要删除的数据库名称（performance_schema, mysql, sys），这可能引导用户在未经充分理解的情况下运行PoC，从而意外删除重要数据库。

**利用方式：**
1.  攻击者搭建一个包含恶意HTML页面的服务器（PoC中使用了Python的SimpleHTTPServer）。
2.  攻击者诱骗已登录phpMyAdmin的用户访问此页面。
3.  页面上的`<img>`标签会向phpMyAdmin服务器发送构造好的SQL查询，例如删除数据库。由于用户已登录，查询将以用户权限执行。
4.  如果用户点击了恶意链接并且phpMyAdmin版本易受攻击，则攻击成功，数据库将被删除。

**项目地址:** [Villaquiranm/5MMISSI-CVE-2017-1000499](https://github.com/Villaquiranm/5MMISSI-CVE-2017-1000499)

**漏洞详情:** [CVE-2017-10004](https://nvd.nist.gov/vuln/detail/CVE-2017-10004)