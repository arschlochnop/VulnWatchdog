## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 - 7.6.3, 7.4.0 - 7.4.7, 7.2.0 - 7.2.10, <= 7.0.10

**利用条件:** 需要网络访问FortiWeb的`/api/fabric/device/status`接口，且目标FortiWeb存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25257是Fortinet FortiWeb Fabric Connector中的一个预身份验证SQL注入漏洞。漏洞位于`/api/fabric/device/status` API端点。攻击者可以通过在`Authorization: Bearer` header中注入恶意SQL命令来利用此漏洞，可能导致远程代码执行。

**有效性分析：**

提供的PoC代码（`poc.py`和`poc.js`）通过发送带有恶意`Authorization`头的HTTP请求到`/api/fabric/device/status`端点来验证SQL注入。这些PoC旨在通过注入`aaa' OR '1'='1`来测试漏洞是否存在。搜索引擎结果也确认了存在公开可用的PoC，并报告了远程代码执行的可能性，因此PoC代码有效。

**投毒风险分析：**

代码仓库主要包含漏洞说明、PoC脚本（`poc.py`, `poc.js`）和一个日志检测脚本（`detect.py`）。
*   `README.md`: 描述了漏洞和PoC。没有发现可疑代码。
*   `detect.py`: 用于检测日志中是否存在利用尝试。没有发现可疑代码。
*   `poc.py`:  发送包含SQL注入payload的请求。没有发现可疑代码。
*   `poc.js`: 功能与`poc.py`相同，使用JavaScript实现。没有发现可疑代码。

虽然代码本身看起来是直接的PoC，但仍存在一些潜在的投毒风险：

*   **依赖风险：** Python和JavaScript的`requests`和`axios`库本身可能存在安全问题，或者攻击者可以诱导用户安装恶意版本。
*   **RCE的复杂性：**  虽然报告称SQL注入可能导致RCE，但实际利用链可能比简单的PoC复杂。攻击者可能需要上传恶意文件或执行其他操作来实现完整的RCE，这增加了攻击的复杂性，也为攻击者创造了隐藏后门的机会。
*   **供应链攻击：** 虽然当前代码没有明显问题，但如果此PoC被其他攻击者修改或集成到更大的攻击框架中，可能会引入恶意代码。
*   **误导性利用：** PoC 可能仅证明存在SQL注入，但实际利用可能需要更复杂的技巧，攻击者可能利用这一点误导安全研究人员。

综合考虑，代码本身看起来相对安全，但间接依赖关系和潜在的利用复杂性可能存在风险。因此，投毒风险估计为10%。

**利用方式：**

1.  攻击者构造包含恶意SQL payload的`Authorization: Bearer` header。
2.  攻击者发送HTTP(S) GET 请求到目标FortiWeb的`/api/fabric/device/status`端点。
3.  FortiWeb服务器没有正确地过滤或转义恶意SQL payload，导致执行了攻击者注入的SQL代码。
4.  攻击者利用SQL注入漏洞读取敏感数据、修改数据或者执行任意系统命令（如果数据库权限允许）。

**项目地址:** [aitorfirm/CVE-2025-25257](https://github.com/aitorfirm/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)