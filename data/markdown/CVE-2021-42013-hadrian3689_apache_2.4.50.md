## CVE-2021-42013 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器完全控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 需要目标服务器运行受影响的Apache HTTP Server版本，并且配置了Alias-like指令，CGI脚本也需要启用才能实现RCE

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42013 漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历攻击，将 URL 映射到 Alias-like 指令配置的目录之外的文件。如果这些目录之外的文件没有被默认的 “require all denied” 配置保护，请求就能成功。如果 CGI 脚本对这些 aliased 路径启用，可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径遍历 (LFI):** 攻击者使用 `icons/%%32%65%%32%65/...` 这样的payload进行路径穿越，读取服务器上的任意文件（例如 `/etc/passwd`）。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI，攻击者可以利用路径遍历访问 `cgi-bin` 目录，并执行任意命令。PoC 代码中使用了 `.%%32%65` 编码绕过了一些过滤。
    *   PoC 代码中，RCE 通过构造包含恶意命令的 HTTP POST 请求发送到 `cgi-bin` 目录下的 `sh` 脚本来实现。

**有效性评估：**

提供的 PoC 代码有效。它包含 LFI 和 RCE 两种利用方式，并且提供了命令行参数来指定目标 URL，要读取的文件，或者要执行的命令。

**投毒风险评估：**

检查 PoC 代码，没有发现明显的恶意代码或后门。该代码主要功能是利用漏洞进行文件读取或命令执行，没有发现主动修改或上传文件的行为。代码的功能与漏洞描述一致，风险较低。


**项目地址:** [hadrian3689/apache_2.4.50](https://github.com/hadrian3689/apache_2.4.50)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)