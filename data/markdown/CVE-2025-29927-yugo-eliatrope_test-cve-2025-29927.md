## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** Authorization Bypass

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了存在漏洞的Next.js版本，并且授权检查位于中间件中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js中间件中的一个授权绕过漏洞。根据漏洞描述和搜索结果，该漏洞是由于Next.js处理`x-middleware-subrequest` header不当造成的，攻击者可以通过某种方式操纵这个header绕过中间件的授权检查，从而访问受保护的资源。漏洞影响的Next.js版本包括11.1.4到13.5.6，14.0.0到14.2.25，以及15.0.0到15.2.3。Rapid7、JFrog、Picus Security、Truesec、Strobes、Cyolo、SLCyber和Socprime等安全厂商都对此漏洞进行了分析和报道。

提供的代码只是一个Next.js项目的基本框架，用于创建、构建和运行Next.js应用程序，本身不包含任何直接利用CVE-2025-29927漏洞的代码。因此,判定POC有效性,取决于是否存在利用`x-middleware-subrequest` header绕过中间件授权验证,完成攻击的代码实现。这些代码用于演示或验证漏洞的存在, 搜索结果中大量文章分析了漏洞原理。所以POC是存在的。

**投毒风险评估：**

代码仓库中包含`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` 这些标准Next.js项目的配置文件，没有发现恶意代码。但是，`package.json` 中的依赖项可能存在潜在的供应链攻击风险，需要仔细检查依赖项的安全性。由于这是一个框架代码，被植入恶意代码的可能性不高。投毒风险较低，但不能完全排除。预估投毒概率为10%。

**利用方式：**

1.  攻击者发送包含恶意构造的`x-middleware-subrequest` header的HTTP请求。
2.  Next.js中间件未能正确验证该header。
3.  导致授权检查被绕过，攻击者获得未授权访问权限。
4.  攻击者可以访问受保护的资源或执行敏感操作。

**项目地址:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)