## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且存在可执行的CGI脚本目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 和 CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 中的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造特殊的URL来访问服务器上的任意文件，如果服务器启用了CGI脚本执行，则可能导致远程代码执行。

**有效性：**
提供的PoC代码（`exploit.py`）是有效的。它包含利用路径遍历读取任意文件和利用CGI执行远程代码的payload。脚本首先检查目标服务器是否易受攻击（通过检查`Server`头），然后根据用户选择的选项执行相应的攻击。

**投毒风险：**
分析提供的PoC代码，没有发现明显的投毒代码。代码结构清晰，功能明确，主要是构造恶意请求来利用漏洞。脚本中的操作都是为了验证和利用漏洞，没有发现任何隐藏的恶意行为。
投毒风险评估：0%

**利用方式：**
1.  **路径遍历：** 攻击者通过在URL中使用经过特殊编码的路径（例如，`.%2e/%2e%2e`）来绕过服务器的路径检查，从而访问受限目录之外的文件。PoC代码中提供了两个路径遍历Payload `payload1`和`payload2`，利用 `GET` 请求读取文件内容。
2.  **远程代码执行：** 如果服务器配置允许执行CGI脚本，攻击者可以通过路径遍历访问到`bin/sh`，然后通过POST请求将命令作为数据传递给`bin/sh`执行。PoC代码中构造了包含命令的POST请求，利用`req.Session()`和`req.Request()`发送请求并接收响应，实现交互式shell。

**总结：**
该漏洞的利用需要目标服务器存在漏洞版本（2.4.49或2.4.50），并且在路径遍历访问到文件之后，如果服务器配置允许，可以进一步利用CGI执行进行远程代码执行。提供的PoC代码可以成功验证并利用该漏洞，未发现投毒风险。

**项目地址:** [blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution](https://github.com/blackn0te/Apache-HTTP-Server-2.4.49-2.4.50-Path-Traversal-Remote-Code-Execution)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)