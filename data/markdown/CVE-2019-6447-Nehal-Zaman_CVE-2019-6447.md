## CVE-2019-6447 - ES File Explorer 文件管理器 任意文件读取/应用执行

**漏洞编号:** CVE-2019-6447

**漏洞类型:** 任意文件读取/应用执行

**影响应用:** ES File Explorer File Manager

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 4.1.9.7.4

**利用条件:** 目标设备安装ES File Explorer，且与攻击者处于同一局域网内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-6447 漏洞存在于 ES File Explorer File Manager 4.1.9.7.4 及更早版本中。该漏洞允许攻击者通过 TCP 端口 59777 向目标设备发送未经验证的 application/json 数据，从而读取任意文件或执行应用程序。端口会在ES File Explorer 启动后保持开启状态。

**有效性:**
提供的 Python POC 代码 `cve-2019-6447.py` 似乎能够有效利用此漏洞。它允许攻击者指定命令（例如列出文件、图片、视频、音频、应用等）并发送到目标设备的 59777 端口。该代码还包含下载文件的功能。根据漏洞信息，攻击者可以通过构造特定的 HTTP 请求来读取任意文件或执行应用，因此 POC 代码是有效的。

**投毒风险:**
查看了提供的 `cve-2019-6447.py` 文件的内容,没有发现明显的恶意投毒代码,代码功能和描述基本一致,风险较低. 视频文件 `proof/proof.mp4` 通常不包含可执行代码，因此风险也较低。但是，任何外部下载或执行操作都有潜在风险，尽管在此上下文中风险较低。总体投毒风险估计为5%。这是因为代码可以下载文件，攻击者可能更改下载位置，从而替换系统文件。但这种可能性较小，取决于使用方式。

**利用方式:**
1.  目标设备必须安装并运行 ES File Explorer 4.1.9.7.4 或更早版本。
2.  攻击者需要与目标设备处于同一局域网内。
3.  攻击者使用提供的 POC 代码，指定要执行的命令或要下载的文件路径。
4.  POC 代码向目标设备的 59777 端口发送 HTTP POST 请求。
5.  如果命令是文件列表，目标设备将返回文件列表的 JSON 响应。
6.  如果命令是下载文件，目标设备将返回文件内容，POC 代码将其保存到本地。

通过这种方式，攻击者可以获取目标设备上的敏感信息，甚至执行恶意应用。

**项目地址:** [Nehal-Zaman/CVE-2019-6447](https://github.com/Nehal-Zaman/CVE-2019-6447)

**漏洞详情:** [CVE-2019-6447](https://nvd.nist.gov/vuln/detail/CVE-2019-6447)