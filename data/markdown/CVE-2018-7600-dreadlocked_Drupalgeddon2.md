## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)