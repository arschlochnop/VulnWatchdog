## CVE-2025-27519-Cognita-任意文件写入导致RCE

**漏洞编号:** CVE-2025-27519

**漏洞类型:** 任意文件写入

**影响应用:** Cognita

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < a78bd065e05a1b30a53a3386cc02e08c317d2243

**利用条件:** 需要Local环境变量设置为true，通常在使用Docker设置Cognita时。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-27519 是 Cognita 框架中的一个任意文件写入漏洞。当 Local 环境变量设置为 true 时，`/v1/internal/upload-to-local-directory` 端点存在路径遍历漏洞。攻击者可以利用此漏洞写入任意文件。利用方式是，攻击者通过路径遍历漏洞覆盖 `/app/backend/__init__.py` 文件，由于 uvicorn 服务器启用了自动重载，该文件会被自动重新加载并执行，从而导致远程代码执行。提供的漏洞利用代码是针对 `below` 工具的特权提升漏洞，利用了日志文件和符号链接来修改 `/etc/passwd` 文件，与 CVE-2025-27519 （Cognita的任意文件写入漏洞）无关。但是脚本本身会利用系统配置不当修改/etc/passwd，有破坏性。 

**有效性：**
提供的POC 代码是针对 `below` 工具的，与 `Cognita` 的 CVE-2025-27519 漏洞无关，所以无法用于漏洞复现。

**投毒风险：**
该POC脚本的主要功能是利用符号链接和文件覆盖来尝试修改`/etc/passwd`文件。虽然脚本的功能是明确的，但仍然存在一定的投毒风险：

*   **脚本的功能本身具有破坏性：** 脚本的目的是修改系统的`/etc/passwd`文件，这本身就可能导致系统不稳定或者无法启动。如果脚本执行过程中出现错误，可能会破坏`/etc/passwd`文件，导致系统崩溃。
*   **依赖特定环境：** 脚本依赖`/var/log/below/error_root.log`文件的存在和可写权限。如果目标系统不存在这个文件或者权限配置不同，脚本可能无法正常工作，或者产生意料之外的结果。
*   **代码逻辑潜在问题：** 脚本中使用`rm -f`强制删除日志文件，然后创建符号链接。如果在删除和创建符号链接之间出现问题（例如权限不足），可能导致安全风险。
*   **su 命令的风险：** 脚本最后使用`su diablo`命令尝试切换到新创建的用户。如果`su`命令配置不当，可能会导致安全问题。

因此，评估这个仓库的投毒风险约为10%。

**利用方式：**
CVE-2025-27519 漏洞的利用方式是通过网络访问`/v1/internal/upload-to-local-directory` 端点，构造包含路径遍历的payload，将恶意代码写入到`/app/backend/__init__.py` 文件。由于 uvicorn 服务器启用了自动重载，该文件会被自动重新加载并执行，从而导致远程代码执行。

**项目地址:** [Diabl0xE/CVE-2025-27519](https://github.com/Diabl0xE/CVE-2025-27519)

**漏洞详情:** [CVE-2025-27519](https://nvd.nist.gov/vuln/detail/CVE-2025-27519)