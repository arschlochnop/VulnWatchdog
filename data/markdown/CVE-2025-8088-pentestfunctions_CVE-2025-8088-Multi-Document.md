## CVE-2025-8088-WinRAR-路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 WinRAR 在处理压缩文件时存在的路径遍历漏洞(CVE-2025-8088)。攻击者可以构造恶意的RAR压缩包，其中包含具有特制路径的文件，当用户使用 WinRAR 解压该压缩包时，这些文件会被释放到攻击者指定的目录，例如 Windows 的启动目录，从而实现任意代码执行。根据搜索结果和漏洞库信息，该漏洞已被野外利用。提供的 POC 代码 `CVE-2025-8088.py` 旨在生成利用此漏洞的恶意 RAR 压缩包。 

**漏洞利用方式：**
1.  **创建诱饵文件和 Payload:** POC 首先创建一些诱饵文件 (例如 `file1.txt`, `file2.txt` 等) 和一个 payload 文件 (例如 `payload.bat`)。Payload 文件包含攻击者想要执行的恶意命令。
2.  **创建基本 RAR 压缩包:**  POC 使用 WinRAR 的命令行工具 `rar.exe` 将诱饵文件添加到 RAR 压缩包 `base.rar` 中。
3.  **附加 ADS（可选）:** POC 代码尝试将payload附加到诱饵文件作为备用数据流 (ADS)。
4.  **构建相对路径:**  POC 构建包含多个 "..\" 的相对路径，用于进行目录遍历，将 Payload 文件释放到目标目录，例如 Windows 的启动目录 `AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`。
5.  **修补 RAR 压缩包:** POC 读取基本 RAR 压缩包的内容，并在文件头中查找占位符，然后使用构造的相对路径替换占位符。 这通过 `patch_placeholder_in_header` 函数实现。
6.  **重新计算 CRC 校验和:** 由于修改了文件头，POC 重新计算所有头部的 CRC 校验和，确保 RAR 压缩包的完整性。
7.  **生成恶意 RAR 压缩包:** POC 将修改后的数据写入新的 RAR 压缩包 `exploit.rar`。当用户解压 `exploit.rar` 时，`payload.bat` 会被释放到启动目录并执行。

**有效性：**
该 POC 代码看起来是有效的，因为它实现了构造恶意 RAR 压缩包的必要步骤，包括创建诱饵文件、构建相对路径、修改文件头和重新计算 CRC 校验和。 搜索引擎结果也表明此漏洞已被积极利用。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码风险较低。虽然代码会释放一个 bat 文件到启动目录执行，但这是为了验证漏洞,而不是隐藏的恶意行为。风险评估为10%,主要考虑以下几点:
*   **Payload 可配置:** Payload 文件 `payload.bat` 的内容是可配置的，这意味着用户可以修改 payload 的内容。
*   **路径遍历风险:**  尽管 POC 的主要目的是利用路径遍历漏洞，但如果用户不小心，可能会将文件释放到意想不到的位置。
*   **依赖 WinRAR:**  POC 依赖于系统上安装的 WinRAR 命令行工具 `rar.exe`。如果用户使用了被篡改的 `rar.exe`，可能会引入额外的风险。

**项目地址:** [pentestfunctions/CVE-2025-8088-Multi-Document](https://github.com/pentestfunctions/CVE-2025-8088-Multi-Document)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)