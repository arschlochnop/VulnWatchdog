## CVE-2018-8097 - Eve (pyeve) 代码注入

**漏洞编号:** CVE-2018-8097

**漏洞类型:** 代码注入

**影响应用:** Eve (pyeve)

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 0.7.5

**利用条件:** 需要目标系统运行存在漏洞版本的pyeve，并允许通过where参数传递恶意代码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-8097是Eve (pyeve) 0.7.5之前版本中io/mongo/parser.py文件存在的一个代码注入漏洞。攻击者可以通过在 'where' 参数中注入恶意Python代码，从而在服务器上执行任意代码。利用方式是通过构造包含恶意代码的HTTP GET请求，其中恶意代码被嵌入到 'where' 参数中，由于pyeve在处理该参数时存在缺陷，导致恶意代码被执行。提供的POC代码利用了时间盲注的方式，通过控制sleep函数的执行时间来判断文件内容，逐步提取目标文件内容。POC代码本身看起来没有明显的投毒代码，主要功能是利用漏洞读取文件内容，没有发现植入后门或进行其他恶意操作的代码。

**项目地址:** [StellarDriftLabs/CVE-2018-8097](https://github.com/StellarDriftLabs/CVE-2018-8097)

**漏洞详情:** [CVE-2018-8097](https://nvd.nist.gov/vuln/detail/CVE-2018-8097)