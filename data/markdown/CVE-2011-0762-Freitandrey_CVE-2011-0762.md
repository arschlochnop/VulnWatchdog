## CVE-2011-0762-vsftpd-拒绝服务

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** < 2.3.3

**利用条件:** 需要FTP服务开启，且攻击者能够通过FTP协议与服务器建立连接并进行认证（通常需要用户名和密码，或者匿名登录）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2011-0762 漏洞存在于 vsftpd 2.3.3 之前的版本中，攻击者可以通过发送包含精心构造的 glob 表达式的 `STAT` 命令，在多个 FTP 会话中消耗大量的 CPU 资源和进程槽，最终导致拒绝服务。

**漏洞分析：**

*   漏洞位于 `ls.c` 文件的 `vsf_filename_passes_filter` 函数中。
*   攻击者利用 `STAT` 命令发送包含大量嵌套花括号的恶意的glob表达式，例如 `STAT {{*},{{*},...}}` 。
*   `vsf_filename_passes_filter` 函数在处理这些复杂的表达式时，会进行大量的计算，导致 CPU 资源消耗增加。
*   通过建立多个 FTP 会话并发送恶意 `STAT` 命令，攻击者可以耗尽服务器的进程槽，最终导致拒绝服务。

**有效性评估：**

根据漏洞描述和搜索引擎结果，此漏洞是真实存在的，并且存在公开的 PoC 代码（例如，Exploit-DB 上的 16270 和 cxib.net/stuff/vspoc232.c）。提供的 PoC 代码 `cve-2011-0762.c` 实现了利用该漏洞发送恶意 `STAT` 命令的功能。因此，该 PoC 代码的有效性较高。

**投毒风险评估：**

提供的 PoC 代码主要功能是连接到 FTP 服务器，进行身份验证（如果需要），然后发送一个构造好的 `STAT` 命令。代码本身相对简单，主要功能集中在创建 socket 连接、发送数据和接收数据。详细分析代码后，没有发现任何可疑的、与漏洞利用无关的代码，例如：

*   没有尝试执行系统命令的代码。
*   没有尝试写入或修改文件的代码。
*   没有尝试建立反向 shell 的代码。
*   没有连接到其他服务器的代码。

因此，此 PoC 代码的投毒风险较低，几乎可以确定没有投毒。

**利用方式：**

1.  攻击者需要确定目标服务器运行的 vsftpd 版本低于 2.3.3。
2.  攻击者需要能够通过 FTP 协议连接到目标服务器。
3.  攻击者可以使用提供的 PoC 代码（或类似工具），指定目标服务器的 IP 地址、端口、用户名和密码（如果需要）。
4.  PoC 代码会建立与服务器的 FTP 连接，进行身份验证（如果需要），然后发送包含恶意 glob 表达式的 `STAT` 命令。
5.  攻击者可以同时运行多个 PoC 实例，以增加 CPU 资源消耗和进程槽耗尽的速度，从而更快地实现拒绝服务。

**缓解措施：**

1.  将 vsftpd 升级到 2.3.4 或更高版本。
2.  配置 vsftpd 以限制每个 IP 地址的最大连接数。
3.  使用防火墙限制对 FTP 端口的访问。

**项目地址:** [Freitandrey/CVE-2011-0762](https://github.com/Freitandrey/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)