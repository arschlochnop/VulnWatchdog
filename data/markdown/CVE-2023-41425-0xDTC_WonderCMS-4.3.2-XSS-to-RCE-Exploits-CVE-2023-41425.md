## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.0 to 3.4.2

**利用条件:** 需要WonderCMS存在contact.php页面且允许远程安装模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 WonderCMS v.3.2.0 到 v.3.4.2 版本中。攻击者可以通过上传包含恶意 JavaScript 代码的模块（zip文件）到installModule组件，从而利用跨站脚本漏洞执行任意代码。POC利用脚本首先构造包含反向shell的PHP文件，然后将其打包成zip文件，并创建一个XSS payload（xss.js）。该payload通过WonderCMS的contact.php页面注入，诱导管理员或者其他用户访问，从而触发反向shell。利用方式如下：

1.  **设置反向 Shell Listener：** 使用 `nc -nvlp <port>` 命令在攻击者机器上监听指定端口。
2.  **执行 POC 脚本：** 运行提供的 bash 脚本，需要提供WonderCMS的登录URL，攻击者的IP地址和监听端口作为参数。
3.  **脚本功能：**
    *   下载 reverse shell 脚本 (rev.php)
    *   根据提供的 IP 和 Port 更新 rev.php
    *   将 rev.php 打包成 ZIP 文件 (main.zip)
    *   创建 XSS payload (xss.js)，该 payload 包含下载和执行 main.zip 中 rev.php 的代码。
    *   启动一个简单的 HTTP 服务器，用于托管 main.zip 和 xss.js。
    *   通过 contact.php 页面发送 XSS payload，以触发漏洞。
4. **投毒风险分析**: 脚本中存在一些潜在的投毒风险，例如 revshells.com网站提供的反向shell脚本的安全性未知，有可能存在被植入恶意代码的风险。HTTP服务器端口为8000，但是未对这个端口的安全性进行检查，攻击者可以通过修改脚本中的PORT变量，来监听其它端口，从而绕过防火墙，导致更大的安全风险。此外，脚本还下载并执行了额外的PHP代码(rev.php)，进一步增加了风险。因此，综合评估，认为该仓库存在一定程度的投毒风险，占比10%。

**项目地址:** [0xDTC/WonderCMS-4.3.2-XSS-to-RCE-Exploits-CVE-2023-41425](https://github.com/0xDTC/WonderCMS-4.3.2-XSS-to-RCE-Exploits-CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)