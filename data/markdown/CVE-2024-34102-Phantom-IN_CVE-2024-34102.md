## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器存在XML解析功能

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）中的XML外部实体注入（XXE）漏洞。未经身份验证的攻击者可以通过发送特制的XML文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。该漏洞的利用方式是通过发送包含恶意DTD的XML请求，该DTD会尝试从目标服务器读取文件（如/etc/passwd），然后通过HTTP请求将内容发送到攻击者的服务器。提供的POC代码包含一个DTD文件（exploit.dtd），该文件定义了两个实体：`data` 和 `param1`。`data` 实体使用 `php://filter/convert.base64-encode/resource=/etc/passwd` 尝试读取 `/etc/passwd` 文件并进行base64编码。`param1` 实体定义了一个名为 `exfil` 的实体，它将包含编码后的 `/etc/passwd` 数据的URL发送到攻击者的Burp Collaborator服务器 `u0v0hc6fog5kaietmxqshq00xr3ir7.burpcollaborator.net`。根据漏洞描述，成功利用该漏洞可以暴露加密密钥和其他敏感信息，最终获得完整的管理员访问权限。投毒风险分析：该仓库中基本没有投毒的风险，exploit.dtd文件只定义了利用漏洞的方法，没有后门代码。但考虑到是网络上的公开代码，建议在使用前进行详细审查，以确保没有潜在的恶意修改。 搜索引擎结果也验证了该漏洞的存在，并且有多个安全厂商都发布了相关的分析报告和缓解措施。

**项目地址:** [Phantom-IN/CVE-2024-34102](https://github.com/Phantom-IN/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)