## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问Grafana服务，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修复版本外）。漏洞利用方式是通过构造包含目录遍历的 URL，访问 `grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..` 路径，读取服务器上的任意文件。

**有效性:** 提供的 POC 代码通过遍历内置 pluginIDs 列表，构造不同的 URL 来尝试利用该漏洞，读取目标文件。根据搜索结果和漏洞信息，该 POC 代码应该是有效的。

**投毒风险:** 查看 POC 代码后，没有发现任何隐藏的恶意代码或后门。代码的功能是构造 HTTP 请求并打印响应，没有执行任何可能导致系统受到攻击或被控制的操作。投毒风险评估为 0%。

**利用方式:**
1.  确定目标 Grafana 实例的 URL。
2.  选择一个已安装的插件 ID（POC 代码中已提供常见插件 ID 列表）。
3.  构造包含目录遍历的 URL：`grafana_host_url/public/plugins/<plugin_id>/../../../../../../../../..<目标文件路径>`。
4.  发送 HTTP 请求到构造的 URL。
5.  如果漏洞存在，服务器将返回目标文件的内容。

**项目地址:** [rnsss/CVE-2021-43798-poc](https://github.com/rnsss/CVE-2021-43798-poc)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)