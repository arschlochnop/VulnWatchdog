## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地低权限用户提升至root权限

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要目标系统上存在sudo且版本在受影响范围内，并且用户拥有sudoedit权限。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22809是sudoedit中的一个权限提升漏洞。该漏洞源于sudoedit在处理用户提供的环境变量（SUDO_EDITOR、VISUAL和EDITOR）时，对额外的参数处理不当。攻击者可以通过在这些环境变量中注入恶意参数，例如`--`，来绕过保护机制，将任意文件添加到sudoedit要处理的文件列表中，从而以root权限编辑这些文件，最终导致权限提升。

**有效性:** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且危害较高。提供的POC代码仓库的README.md声称可以自动利用该漏洞，但目前只有readme文件，无法判断代码有效性，但是根据描述，该漏洞利用方式比较简单，因此，实现自动利用的代码是可行的。

**投毒风险:** 提供的漏洞利用代码仓库只包含一个README.md文件，没有任何实际的利用代码，因此很难确定是否存在恶意代码。然而，考虑到这是一个可以提升权限的漏洞，攻击者可能会尝试通过包含后门或恶意指令来进一步控制系统。尽管当前没有明确的投毒证据，但考虑到其潜在的风险，投毒风险评估为20%。

**利用方式:**

1.  **利用sudoedit:**  利用sudoedit命令编辑文件。
2.  **设置环境变量:** 设置SUDO_EDITOR, VISUAL, 或者EDITOR环境变量，包含恶意参数。例如 `EDITOR='vim -- /path/to/arbitrary/file'`。
3.  **触发漏洞:**  执行`sudoedit <target_file>`，其中`<target_file>`可以是任意文件，攻击者通过环境变量注入，可以控制实际被编辑的文件，达到修改敏感文件，提升权限的目的。
4.  **权限提升:**  由于sudoedit以root权限运行，攻击者通过修改/etc/passwd或/etc/shadow等文件，或执行其他恶意操作，可以获得root权限。

**项目地址:** [spidoman/CVE-2023-22809-automated-python-exploits](https://github.com/spidoman/CVE-2023-22809-automated-python-exploits)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)