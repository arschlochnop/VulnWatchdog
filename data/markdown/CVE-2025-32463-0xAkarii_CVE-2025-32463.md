## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 到 1.9.17p1 之前

**利用条件:** 本地用户权限，目标系统sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `sudo` 命令的 `--chroot` 选项提权至 root。漏洞原因是 `sudo` 在使用 `--chroot` 时，会加载用户可控目录下的 `/etc/nsswitch.conf` 文件，导致可以加载恶意的共享库。

**漏洞利用方式：**

1.  **创建临时目录:** 创建一个临时目录作为攻击工作区。
2.  **创建恶意共享库:** 编译一个包含constructor属性的C代码，这个constructor函数会在库加载时执行。函数的功能是设置uid和gid为0（root权限），然后执行 `/bin/bash`，从而获得root shell。
3.  **构造nsswitch.conf:**  创建一个包含`passwd: /woot1337`的 `nsswitch.conf` 文件，指示系统从指定位置加载密码数据库。
4.  **利用sudo -R chroot:**  使用 `sudo -R woot woot` 命令，`sudo` 会将根目录切换到 `woot` 目录，并加载 `woot/etc/nsswitch.conf`。由于 `nsswitch.conf` 配置不当，导致恶意共享库被加载。
5.  **获取Root Shell:**  共享库的constructor函数执行，设置进程的uid和gid为0，从而获得root权限的shell。
6.  **清理:** 删除临时目录。

**POC有效性：**

根据漏洞描述和POC代码，该POC能够有效利用此漏洞。POC 代码构建了一个恶意的环境，劫持了动态链接器的行为，从而在 `chroot` 环境中执行代码并获得 root 权限。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。该脚本的主要目的是利用漏洞进行提权，没有发现任何尝试在目标系统上安装后门、收集信息或进行其他恶意操作的迹象。因此，投毒风险评估为0%。

**项目地址:** [0xAkarii/CVE-2025-32463](https://github.com/0xAkarii/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)