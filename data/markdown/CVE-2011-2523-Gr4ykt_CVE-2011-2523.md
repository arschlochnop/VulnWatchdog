## CVE-2011-2523 - vsftpd 2.3.4 后门命令执行

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可导致远程代码执行和完全系统控制

**影响版本:** 2.3.4 downloaded between 20110630 and 20110703

**利用条件:** 目标系统运行受影响的vsftpd版本，且攻击者能够通过网络访问FTP服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523 存在于特定时间段内下载的 vsftpd 2.3.4 版本中，该版本包含一个后门，会在 6200 端口上打开一个 shell。利用方式如下：

1.  攻击者使用提供的 Python 脚本（FTPexploiter.py），该脚本接受目标主机的 IP 地址、FTP 端口、用户名和密码作为参数。
2.  脚本首先通过标准 FTP 端口（通常是 21）连接到目标主机，并尝试使用提供的用户名和密码进行身份验证。
3.  如果身份验证成功，脚本将尝试连接到目标主机上的 6200 端口，该端口由后门打开。 
4.  如果连接到 6200 端口成功，脚本会启动一个交互式 telnet 会话，允许攻击者在目标系统上执行任意命令。 

**有效性：**提供的POC代码有效。该代码通过连接到vsftpd服务器和后门端口，能够建立连接并执行命令。

**投毒风险：** 代码的主要功能是利用已知漏洞，并非恶意软件。代码本身结构简单，直接利用漏洞打开shell。但仍存在极小的投毒风险，体现在：

*   **依赖项：** 脚本使用 `pwn` 和 `telnetlib` 库，虽然常用，但如果用户从非官方源安装这些库，可能存在风险。
*   **编码问题：**  脚本在发送用户名和密码时使用了 `encode('ascii')`，如果用户名或密码包含非 ASCII 字符，可能会导致身份验证失败或者编码错误，虽然不是直接的投毒，但可能导致利用失败，进而误导用户。
*   **端口连接：** 脚本直接连接目标主机的6200端口，可能目标主机未开放该端口或存在防火墙策略，连接失败会暴露攻击尝试。
*   **交互方式：** 使用 `tn2.interact()` 函数直接与 shell 交互，攻击者在交互过程中可能无意中执行危险命令。

**利用方式：**  该漏洞的利用方式是，先通过正常的FTP端口进行认证，认证过程中后门被触发，之后连接到6200端口即可获得shell访问权限。

**项目地址:** [Gr4ykt/CVE-2011-2523](https://github.com/Gr4ykt/CVE-2011-2523)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)