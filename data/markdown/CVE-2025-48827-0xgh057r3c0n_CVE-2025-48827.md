## CVE-2025-48827 vBulletin 未授权API控制器方法调用导致RCE

**漏洞编号:** CVE-2025-48827

**漏洞类型:** 远程代码执行

**影响应用:** vBulletin

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 5.0.0 <= version <= 5.7.5 和 6.0.0 <= version <= 6.0.3 (在PHP 8.1或更高版本上运行时)

**利用条件:** 目标系统运行在PHP 8.1或更高版本上，且安装了存在漏洞的vBulletin版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许未经身份验证的攻击者调用受保护的API控制器方法，通过`ajax/api/ad/replaceAdTemplate`端点注入恶意模板，从而实现远程代码执行。POC代码通过构造包含`passthru`函数的模板，并利用POST请求发送到目标URL的`ajax/api/ad/replaceAdTemplate`端点。成功注入模板后，通过`ajax/render/ad_rce`端点与目标系统进行交互，执行任意系统命令。从提供的漏洞利用代码来看，没有发现任何作者隐藏的投毒代码。

**利用方式：**

1.  **确定目标：** 确定运行着存在漏洞的vBulletin版本的目标URL。
2.  **发送恶意请求：**  构造包含恶意PHP代码的POST请求到`ajax/api/ad/replaceAdTemplate`端点。
3.  **执行任意代码：**  通过`ajax/render/ad_rce`端点发送命令，并获取执行结果。
4.  **交互式Shell：**  利用提供的脚本，可以建立一个交互式的shell，方便进行更深入的渗透测试。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已被野外利用，POC代码的利用方式与描述一致，因此认为提供的POC代码有效。


**项目地址:** [0xgh057r3c0n/CVE-2025-48827](https://github.com/0xgh057r3c0n/CVE-2025-48827)

**漏洞详情:** [CVE-2025-48827](https://nvd.nist.gov/vuln/detail/CVE-2025-48827)