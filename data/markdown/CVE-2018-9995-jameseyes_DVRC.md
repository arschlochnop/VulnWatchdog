## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)