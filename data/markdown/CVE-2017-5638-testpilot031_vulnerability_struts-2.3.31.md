## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)