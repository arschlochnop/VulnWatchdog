## CVE-2025-2857-Firefox-Sandbox Escape

**漏洞编号:** CVE-2025-2857

**漏洞类型:** Sandbox Escape

**影响应用:** Firefox

**危害等级:** 高危，可以完全控制受害者系统

**影响版本:** < 136.0.4, Firefox ESR < 128.8.1, and Firefox ESR < 115.21.1

**利用条件:** 受害者必须运行受影响的Firefox版本在Windows系统上

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-2857 是一个 Firefox 的沙箱逃逸漏洞，由于不正确的 handle 处理，允许一个被攻陷的子进程导致父进程返回一个具有过高权限的句柄，从而导致沙箱逃逸。

**漏洞利用有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是一个已经修复的严重漏洞，存在公开的利用代码。POC 代码通过利用 Firefox 的进程间通信 (IPC) 机制中的漏洞，使得恶意子进程能够突破沙箱限制。

**投毒风险分析：**
提供的 POC 代码存在高风险的投毒行为。install.sh 脚本会执行以下恶意操作：

1.  将漏洞利用程序复制到 `/usr/local/share/.sys/CVE-2025-2857` 目录。这个目录名`.sys`本身具有迷惑性，暗示系统文件，增加隐藏性。
2.  试图通过 `install`, `rsync` 或 `cat` 命令将漏洞利用程序复制到安装目录。使用了多种方法来保证成功复制。
3.  修改 `/etc/profile`、`/etc/bash.bashrc`、`/etc/skel/.bashrc`、`/etc/skel/.profile` 以及所有用户家目录下的 `.bashrc` 和 `.profile` 文件，添加一行 `nohup $INSTALL_DIR/$BINARY_NAME &>/dev/null </dev/null &`。这段代码会在用户登录时静默执行漏洞利用程序，使其在后台运行。这意味着攻击者可以持久地控制受害者系统。
4. 脚本中包含可疑的字符串 `bc1qwejllq892rvznmf5valmyvz887w7strxl9cqh4`， 疑似比特币地址，无法确定是否存在关联。

综上所述，install.sh 脚本执行的操作远远超出了漏洞验证的范围，具有明显的恶意行为和持久化控制意图，因此判定存在高度的投毒风险。

**漏洞利用方式分析：**

1.  攻击者首先需要控制一个 Firefox 的子进程（例如，通过恶意网页或浏览器扩展）。
2.  该子进程利用 CVE-2025-2857 漏洞，诱使父进程（Firefox 主进程）返回一个具有过高权限的句柄。
3.  利用该句柄，攻击者可以突破 Firefox 的沙箱限制，在受害者系统上执行任意代码。
4.  通过 install.sh 中的恶意代码，攻击者可以将恶意程序植入系统，实现持久化控制。

**项目地址:** [ubisoftinc/CVE-2025-2857](https://github.com/ubisoftinc/CVE-2025-2857)

**漏洞详情:** [CVE-2025-2857](https://nvd.nist.gov/vuln/detail/CVE-2025-2857)