## CVE-2015-1635 - HTTP.sys 远程代码执行漏洞

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows HTTP.sys

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2

**利用条件:** 目标系统运行受影响版本的Windows，并且HTTP.sys服务开启（通常为IIS服务器）。攻击者需要能够向目标服务器发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-1635 漏洞存在于 Microsoft Windows HTTP.sys 中，允许远程攻击者通过特制的 HTTP 请求执行任意代码。提供的 Python POC 脚本 `riis.py` 尝试通过发送包含无效 `Range` 头的 HTTP 请求来触发漏洞。该脚本首先发送一个简单的 GET 请求来检查目标是否运行 Microsoft 的 HTTP.sys。然后，它发送第二个请求，该请求包含一个 `Range` 头，其 `bytes` 字段的值设置为一个非常大的数字，旨在触发整数溢出，最终导致拒绝服务或代码执行。

**有效性：**
根据漏洞信息，该漏洞是真实存在的，并且有可用的POC。`riis.py` 脚本的目的是验证目标系统是否存在此漏洞。如果服务器返回 "Requested Range Not Satisfiable"，则表明该系统容易受到攻击 (存在 DoS 风险，是否能RCE取决于补丁情况)。

**投毒风险：**
查看提供的 `riis.py` 脚本和 `README.md` 文件，没有发现明显的恶意或后门代码。脚本的功能仅限于发送特制的HTTP请求以触发漏洞或检测漏洞的存在。因此，投毒风险较低 (0%)。`Remove-IIS-RIIS-` 很可能是一个项目名称, 用于移除受影响的IIS服务或做相关的风险缓解操作。

**利用方式：**
该漏洞的利用方式是向目标服务器发送包含特制 `Range` 头的 HTTP 请求。`Range` 头中的 `bytes` 字段被设置为一个非常大的数字，以触发整数溢出。成功利用该漏洞可能导致拒绝服务（DoS）或远程代码执行（RCE）。攻击者可以构造恶意请求，诱使服务器崩溃或者执行恶意代码。

总而言之，该漏洞的风险很高，利用方式相对简单，但提供的 POC 脚本本身似乎没有包含投毒代码。

**项目地址:** [u0pattern/Remove-IIS-RIIS](https://github.com/u0pattern/Remove-IIS-RIIS)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)