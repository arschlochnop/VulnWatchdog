## CVE-2023-41044-Graylog-路径遍历

**漏洞编号:** CVE-2023-41044

**漏洞类型:** 路径遍历

**影响应用:** Graylog

**危害等级:** 低危，可能导致敏感信息泄露和文件删除

**影响版本:** 5.1.0 <= version < 5.1.3

**利用条件:** 需要具有Admin权限的账号，且服务器开启支持包功能

**POC 可用性:** 否，提供的代码不是POC，而是Graylog仓库的代码

**投毒风险:** 0%

## 详情

CVE-2023-41044 存在于 Graylog 的支持包（Support Bundle）功能中。攻击者需要具有有效的管理员权限才能利用此漏洞。该漏洞源于HTTP API 资源中的用户输入验证不正确。通过构造恶意请求，攻击者可以下载或删除支持包目录的同级目录下的文件，但仅限于目录名称以`/var/lib/graylog-server/support-bundle`或`/usr/share/graylog/data`（Docker镜像）开头的目录。例如，可以访问`/var/lib/graylog-server/support-bundle-test`。提供的代码是 Graylog 仓库中的部分文件（AUTHORS, CODE_OF_CONDUCT.md, CONTRIBUTING.md, LICENSE），不是漏洞利用代码，因此不能用于验证漏洞的有效性。 根据提供的仓库文件，不存在投毒代码。漏洞利用方式如下：

1.  **获取管理员权限：** 攻击者首先需要获取 Graylog 系统的管理员权限。
2.  **构造恶意请求：**  攻击者需要构造包含路径遍历payload的 HTTP 请求，发送到 `/api/system/debug/support/bundle/download/{filename}` 或 `/api/system/debug/support/bundle/{filename}` 接口。
3.  **读取/删除文件：** 通过修改请求中的 `filename` 参数，攻击者可以尝试读取或删除目标目录下的文件。

**项目地址:** [shoucheng3/Graylog2__graylog2-server_CVE-2023-41044_5-1-2](https://github.com/shoucheng3/Graylog2__graylog2-server_CVE-2023-41044_5-1-2)

**漏洞详情:** [CVE-2023-41044](https://nvd.nist.gov/vuln/detail/CVE-2023-41044)