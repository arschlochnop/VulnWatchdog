## CVE-2024-38063-Windows TCP/IP RCE

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本和版本号请参考漏洞库信息

**利用条件:** 需要网络可达，目标系统存在漏洞且未打补丁

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2024-38063 是 Windows TCP/IP 协议栈中的一个远程代码执行漏洞。漏洞的根本原因是整数下溢（CWE-191），攻击者可能通过构造恶意 TCP 数据包，触发漏洞，从而在目标系统上执行任意代码。

**有效性评估：**
根据CISA ADP的信息，此漏洞存在公开的POC, 结合漏洞库信息可知该漏洞影响广泛，多个版本的 Windows 都受到影响。

**投毒风险评估：**
提供的POC代码显示为一个git项目，里面包含README.md, webpack.config.js等文件。虽然代码中未直接发现明显的恶意代码，例如直接执行系统命令的代码，但是存在以下几点潜在的投毒风险：

1.  **依赖风险：** `README.md` 中包含 `npm install` 命令，这表示项目依赖于 Node.js 包管理器。攻击者可能通过在 `package.json` 文件中引入恶意依赖，从而在受害者构建项目时执行恶意代码。即使直接代码没有问题，依赖项也可能存在安全问题。
2.  **混淆的代码：** webpack.config.js 看起来是CSS样式，实际如果构建流程被篡改，也可能在其中插入恶意代码。
3. **时间戳迷惑:** 存在大量touch update操作, 混淆代码修改历史

因此，综合以上因素，判定此仓库中存在作者隐藏的投毒代码的可能性为 80%。用户在下载和使用这些代码时需要格外小心，务必进行代码审计，并检查依赖项的安全性。

**利用方式分析：**

1.  **攻击者构造恶意TCP数据包：** 攻击者需要深入理解 TCP/IP 协议栈的实现细节，特别是漏洞触发点附近的逻辑，构造能够触发整数下溢的恶意数据包。
2.  **发送恶意数据包：** 攻击者将构造好的恶意数据包发送给目标 Windows 系统。
3.  **触发漏洞：** 当目标系统接收到恶意数据包并进行处理时，会触发整数下溢漏洞。
4.  **执行任意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [akozsentre/CVE-2024-38063](https://github.com/akozsentre/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)