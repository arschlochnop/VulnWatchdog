## CVE-2025-53770-Microsoft SharePoint Server-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** SharePoint Server 2016 (on-prem), SharePoint Server 2019 (on-prem), SharePoint Subscription Edition (versionStartIncluding: 16.0.0, versionEndExcluding: 16.0.18526.20508)

**利用条件:** 需要目标系统为受影响的SharePoint Server版本，且攻击者能够上传.aspx文件或发送特制的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中存在的一个远程代码执行漏洞，该漏洞是由于对不可信数据进行反序列化造成的。攻击者可以通过上传恶意的 .aspx 文件或构造包含恶意 ViewState 数据的请求来利用此漏洞，从而在服务器上执行任意代码。根据漏洞信息和搜索结果，此漏洞已被积极利用，并且没有官方补丁可用，因此缓解措施至关重要。POC 代码利用 ViewState 伪造，通过窃取的 ASP.NET `machineKey`（ValidationKey 和 DecryptionKey）绕过签名验证并执行任意代码。虽然提供的 POC 代码本身看起来不包含明显的投毒代码，但由于攻击者需要能够上传恶意.aspx文件或能够发送特制的HTTP请求，因此如果将POC代码进行修改，比如在其中嵌入额外的后门代码或者用于大规模传播，则可能存在投毒风险。该风险比例预估为10%。

**漏洞利用方式：**

1.  **获取 machineKey：** 攻击者首先需要通过某种方式获取 SharePoint 服务器的 machineKey（ValidationKey 和 DecryptionKey）。这通常通过上传一个恶意的 .aspx 文件 (例如 `spinstall0.aspx`) ，利用 SharePoint 的反序列化漏洞读取内存中的敏感信息来实现。
2.  **构造恶意 ViewState：**  利用获取到的 machineKey，攻击者可以构造恶意的 ViewState payload。这些 payload 包含要执行的任意代码。
3.  **发送恶意请求：**  将构造好的恶意 ViewState payload 嵌入到发送给 SharePoint 服务器的 HTTP 请求中。该请求可以是一个 POST 请求，目标是 SharePoint 的某个页面（例如 `/sites/*/_layouts/15/ToolPane.aspx?DisplayMode=Edit`）。
4.  **执行代码：**  SharePoint 服务器在处理请求时，会反序列化 ViewState 数据，由于 ViewState 是伪造的，包含了恶意代码，从而导致服务器执行攻击者指定的代码。代码在 `w3wp.exe` 进程下执行。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-53770](https://github.com/B1ack4sh/Blackash-CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)