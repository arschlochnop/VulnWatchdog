## CVE-2025-32462-Sudo-主机绕过

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危

**影响版本:** < 1.9.17p1 (受影响版本包括 1.8.8)

**利用条件:** sudoers文件配置不当，主机配置非当前主机或ALL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32462是一个Sudo中的权限提升漏洞。当sudoers文件指定的主机既不是当前主机也不是ALL时，列出的用户可以在非预期机器上执行命令。利用方式如下：

1.  **漏洞原理：**  Sudo在处理sudoers文件中指定的主机时存在逻辑错误，导致权限验证绕过。
2.  **利用条件：**
    *   Sudo版本低于1.9.17p1，且高于等于1.8.8。
    *   存在配置错误的sudoers文件，其中指定的主机不是当前主机或ALL。
3.  **漏洞利用：**  用户利用此漏洞，可以在本不应该拥有权限的主机上，执行sudo命令，从而提升权限。

提供的POC代码实际上是一个检测脚本，而不是漏洞利用脚本。它主要检查Sudo版本和`-h`参数的滥用（虽然`-h`参数滥用并非CVE-2025-32462漏洞本身的核心，但脚本作者可能将其视为一种潜在的配置错误）。真正的漏洞利用需要构造特定的sudo命令，以绕过主机验证。

**投毒风险评估：**

该仓库主要提供检测脚本，直接执行恶意代码的风险较低。 `check_cve_2025_32463.sh` 中尝试了 `--chroot /`,但这只会打印到标准输出，不会实际执行任何危险操作。`check_cve_2025_32462.sh` 尝试了 `sudo -h`,这实际上是输出sudo的帮助信息，并不会造成危害. 但仍然需要注意脚本的来源，以及是否有其他隐藏的恶意行为。风险在于，如果攻击者替换了这些脚本，或者在脚本中添加了额外的代码，则可能存在投毒风险，例如收集系统信息、植入后门等。由于脚本本身功能简单，人工审核相对容易，因此投毒风险较低，大约为5%。大部分风险来自于对脚本来源的不信任和对脚本内容未经验证的执行。

**有效性：**

检测脚本本身可以有效判断Sudo版本是否在受影响范围内。但是check_sudo_usage 函数利用`sudo -h`并不能准确的判断是否存在主机配置错误。

综上，脚本的主要作用是辅助检测，而不是直接进行漏洞利用。

**项目地址:** [toohau/CVE-2025-32462-32463-Detection-Script-](https://github.com/toohau/CVE-2025-32462-32463-Detection-Script-)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)