## CVE-2024-12085-rsync-信息泄露

**漏洞编号:** CVE-2024-12085

**漏洞类型:** 信息泄露

**影响应用:** rsync

**危害等级:** 高危，可能导致绕过ASLR等安全机制

**影响版本:** <= 3.3.0

**利用条件:** 需要网络访问rsync服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12085 是 rsync 中的一个信息泄露漏洞。攻击者可以操纵 checksum 长度 (s2length) ，导致 checksum 和未初始化的内存进行比较，从而每次泄露一个字节的未初始化的栈数据。

**漏洞利用方式：**

1.  攻击者首先与 rsync 服务建立连接。
2.  通过构造恶意的参数，特别是操纵 checksum 长度，来触发漏洞。
3.  rsync 在比较 checksum 时，会读取未初始化的栈内存。
4.  未初始化的栈内存内容会被泄露给攻击者。
5.  攻击者可以重复利用该漏洞，多次泄露栈内存，从而获取敏感信息，例如绕过ASLR。

**有效性：**

提供的 POC 代码尝试利用此漏洞。它通过构造特定的 rsync 命令和参数来触发信息泄露。根据代码中的注释，该利用并非通用，目标模块和 checksum 是硬编码的，自动 checksum 计算尚未实现。但是，考虑到有POC代码，并且搜索引擎结果提到此漏洞可绕过ASLR，漏洞利用应该是有效的，但可能需要根据具体环境进行调整。

**投毒风险：**

查看提供的python脚本，
*   `README.md`：这是一个说明文件，没有发现任何可疑代码。
*   `checksum.py`：该脚本用于计算文件的checksum，属于辅助脚本，没有发现任何可疑代码。
*   `exploit.py`：该脚本是漏洞利用的核心，用于发送恶意请求到 rsync 服务器。检查代码后，并没有发现明显的恶意代码或后门。只是存在硬编码，和一些调试信息。但是无法保证是否存在时间差攻击，或者其他隐蔽的攻击方式, 只能给出较低的投毒风险.

因此，此仓库中存在作者隐藏的投毒代码的可能性较低，初步判断投毒风险为 1%。主要风险在于利用代码的可靠性，及能否在目标环境中复现漏洞。

**项目地址:** [Otsutez/cve-2024-12085](https://github.com/Otsutez/cve-2024-12085)

**漏洞详情:** [CVE-2024-12085](https://nvd.nist.gov/vuln/detail/CVE-2024-12085)