## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)