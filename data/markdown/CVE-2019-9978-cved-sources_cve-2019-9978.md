## CVE-2019-9978-Social Warfare-存储型XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 中危，可能导致管理员账户被盗用、网站内容篡改

**影响版本:** < 3.5.3

**利用条件:** 需要目标网站安装了存在漏洞版本的Social Warfare插件，并允许用户（包括未授权用户）访问`wp-admin/admin-post.php?swp_debug=load_options&swp_url=`

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9978 是 WordPress Social Warfare 插件中存在的一个存储型跨站脚本漏洞。攻击者可以通过构造恶意的 `swp_url` 参数，将其发送到 `wp-admin/admin-post.php?swp_debug=load_options` 接口，将恶意的 JavaScript 代码存储在插件的配置中。当管理员或其他用户访问包含该配置的页面时，恶意代码就会被执行。根据搜索引擎结果和漏洞库信息，该漏洞在野外已被利用。提供的 Dockerfile 构建了一个包含漏洞版本（3.5.0）的 WordPress 和 Social Warfare 插件的环境，`main.sh` 脚本启动数据库和 Web 服务器，并激活该插件。漏洞利用方式主要是通过发送包含恶意 JavaScript 代码的请求到存在漏洞的 URL。投毒风险评估： 虽然Dockerfile和build脚本看起来没有明显的恶意代码，但Docker镜像本身的来源需要验证，是否存在投毒的风险为10%，主要体现在以下几点：
1.  **基础镜像风险**: Dockerfile使用了`cved/base-wordpress` 作为基础镜像。如果这个基础镜像本身被篡改过，包含了后门或者恶意软件，那么构建出来的所有容器都会受到影响。
2.  **第三方脚本来源**: `db.sql`脚本的内容没有提供，如果`db.sql`脚本中包含恶意的SQL代码，可能在数据库初始化的时候注入恶意数据或后门。但鉴于该镜像的目的是复现漏洞，因此恶意SQL的可能性较低，但是仍然不能排除。
3. **社会工程学投毒：**例如修改镜像名称，诱导用户使用恶意镜像。

综上，虽然直接投毒的可能性不高，但依然存在潜在的风险。

**项目地址:** [cved-sources/cve-2019-9978](https://github.com/cved-sources/cve-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)