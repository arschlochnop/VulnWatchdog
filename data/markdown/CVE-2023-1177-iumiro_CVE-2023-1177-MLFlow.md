## CVE-2023-1177-mlflow-路径遍历

**漏洞编号:** CVE-2023-1177

**漏洞类型:** 路径遍历

**影响应用:** mlflow

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.2.1

**利用条件:** 需要网络访问mlflow服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和提供的PoC代码，CVE-2023-1177是mlflow版本低于2.2.1时存在的路径遍历漏洞。攻击者可以通过构造包含`\..\filename`的恶意路径，访问服务器上的任意文件。PoC代码通过以下步骤利用该漏洞：

1.  **创建模型:** 使用`ajax-api/2.0/mlflow/registered-models/create`接口创建一个具有唯一名称的模型。
2.  **更新模型:** 使用`ajax-api/2.0/mlflow/model-versions/create`接口更新模型，其中`source`参数包含恶意路径`file:///etc/`。注意，PoC代码中实际上使用的是绝对路径而非相对路径的路径遍历，这和漏洞描述中`\..\filename`不太相符，但也能达到读取任意文件的目的。
3.  **获取数据:** 使用`model-versions/get-artifact`接口获取指定路径的文件内容。PoC中尝试获取`/etc/passwd`文件的内容。

**有效性:**

PoC代码利用了未经验证的用户输入构建文件路径，从而读取了服务器上的任意文件，验证了漏洞的存在。

**投毒风险:**

PoC代码本身目的是利用漏洞读取文件，未发现存在恶意代码或后门，因此投毒风险为0%。

**利用方式:**

攻击者通过发送精心构造的HTTP请求，利用mlflow提供的API接口，绕过访问控制，读取服务器上的敏感文件。虽然漏洞描述说是相对路径的`\..\filename`，但PoC中使用的是`file:///etc/`读取任意文件,也能达到漏洞利用的目的。

**项目地址:** [iumiro/CVE-2023-1177-MLFlow](https://github.com/iumiro/CVE-2023-1177-MLFlow)

**漏洞详情:** [CVE-2023-1177](https://nvd.nist.gov/vuln/detail/CVE-2023-1177)