## CVE-2018-6574 Go "go get" 远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 目标机器需要安装受影响的Go版本，并执行`go get`命令获取包含恶意代码的包。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 漏洞允许攻击者通过利用 `go get` 命令在构建源代码期间执行远程命令。该漏洞源于 Go 在处理 gcc 或 clang 插件特性时，未正确阻止 `-fplugin=` 和 `-plugin=` 参数。攻击者可以通过创建一个包含恶意插件的 Go 包，并在该包的源码中指定使用该插件，当受害者使用 `go get` 获取并构建该包时，恶意插件将被加载和执行，从而实现远程命令执行。

**有效性：**
提供的POC代码看起来是有效的。`attack.c` 包含执行命令 `/usr/local/bin/score 3071f0cf-6174-4749-8ae3-fc6da33ec98b` 的恶意代码。`main.go` 使用 `#cgo CFLAGS: -fplugin=./attack.so` 指令，指示 go 编译器在构建时加载 `attack.so` 插件，从而执行 `attack.c` 中的恶意代码。`exploit.html` 可能是该漏洞的补充利用，通过打开一个URL，并向其postMessage，目的是为了触发漏洞利用。

**投毒风险：**
从提供的代码来看，不存在明显的投毒行为。`attack.c` 的目的明确是执行预定义的命令，这属于漏洞利用的一部分，而不是隐藏的恶意代码。`main.go` 明确指定加载该恶意插件。所以投毒风险评估为 0%。

**利用方式：**
1.  攻击者创建一个包含恶意插件的 Go 包（例如，`attack.c` 编译后的 `attack.so`）。
2.  攻击者创建一个 `main.go` 文件，其中使用 `#cgo CFLAGS: -fplugin=./attack.so` 指令加载恶意插件。
3.  攻击者将该 Go 包托管在一个公开可访问的 Git 仓库或其他代码托管平台。
4.  攻击者诱骗受害者使用 `go get` 命令获取并构建该恶意 Go 包。
5.  当受害者执行 `go get` 命令时，Go 编译器将加载并执行恶意插件，从而执行攻击者预先设定的命令。

**项目地址:** [faiqu3/cve-2018-6574](https://github.com/faiqu3/cve-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)