## CVE-2023-38600 - Apple Safari Web Content Execution of Arbitrary Code

**漏洞编号:** CVE-2023-38600

**漏洞类型:** 代码执行

**影响应用:** Safari, iOS, iPadOS, tvOS, macOS, watchOS

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** < 16.6 (Safari), < 16.6 (iOS and iPadOS), < 16.6 (tvOS), < 13.5 (macOS), < 9.6 (watchOS)

**利用条件:** 需要用户访问恶意网页

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38600 漏洞存在于 Apple Safari 以及其他使用 WebKit 的 Apple 产品中。该漏洞允许恶意网页通过处理 Web 内容导致任意代码执行。根据 ZDI 博客（webpage 0， webpage 7， webpage 8），漏洞根源在于 `copyWithin` 方法使用不当。

**有效性评估：**
提供的 PoC 代码试图利用 `ArrayBuffer.prototype.copyWithin` 方法，结合 redimensionable ArrayBuffer 来触发漏洞。PoC 的基本原理是：
1.  创建一个redimensionable `ArrayBuffer`。
2.  创建一个 `Uint8Array` 视图。
3.  定义一个函数 `shrinkBuffer` 来调整 buffer 的大小为 0。
4.  调用 `copyWithin` 方法，并传入一个带有 `valueOf` 方法的对象，`valueOf` 方法会调用 `shrinkBuffer` 在复制过程中缩小 buffer 的大小。这可能会导致越界写入或其他内存损坏，从而导致任意代码执行。
根据漏洞描述，Apple 通过改进检查修复了该漏洞。如果目标系统满足受影响的版本要求，并且浏览器允许 redimensionable ArrayBuffers，则 PoC 代码**可能有效**。

**投毒风险：**
分析提供的 PoC 代码，主要包含以下几个文件：
*   `README.md`: 简单的说明文件。
*   `index.html`: 包含一个按钮，点击后会执行 `poc.js` 中的代码。
*   `poc.js`: 包含漏洞利用的核心代码，利用 `copyWithin` 和 redimensionable `ArrayBuffer` 触发漏洞。

代码的功能相对清晰，没有发现明显的恶意行为或后门代码。所以投毒的可能性较低, 判定投毒风险为 **0%**。

**利用方式：**
1.  攻击者需要搭建一个恶意网站，其中包含 PoC 代码。
2.  诱使用户使用受影响版本的 Safari 或其他受影响的 Apple 产品访问该网站。
3.  用户点击按钮，触发 JavaScript 代码执行。
4.  `copyWithin` 函数结合 redimensionable `ArrayBuffer` 使用可能导致内存损坏。
5.  如果利用成功，攻击者可以在用户的设备上执行任意代码。

**项目地址:** [afrojack1/cve202338600test.github.io](https://github.com/afrojack1/cve202338600test.github.io)

**漏洞详情:** [CVE-2023-38600](https://nvd.nist.gov/vuln/detail/CVE-2023-38600)