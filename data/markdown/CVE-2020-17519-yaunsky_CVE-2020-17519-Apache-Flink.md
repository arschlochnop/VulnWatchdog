## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 暴露在外网或可被访问的网络环境。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件。\n\n**有效性：**\n
根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。多个来源表明该漏洞已被积极利用，并且CISA已将其添加到已知被利用漏洞目录中。提供的POC代码尝试通过构造包含目录遍历序列的 URL 来读取 `/etc/passwd` 文件，这符合漏洞描述。POC 中 URL 编码 `%252f`是双重编码`/`，目的是绕过一些安全机制。\n\n**投毒风险：**\n
分析提供的 Python 脚本 `CVE-2020-17519.py` 以及相关文件, 发现并没有明显的恶意代码或后门。脚本的功能主要是发送 HTTP 请求到目标 Flink JobManager 实例，利用目录遍历漏洞读取文件。脚本代码相对简单，只实现了漏洞验证的功能, 投毒风险评估为0%。\n\n**利用方式：**\n
1.  **确定目标：** 找到运行 Apache Flink 1.11.0 到 1.11.2 版本的 JobManager 实例，并且该实例的 REST API 可以通过网络访问。
2.  **构造恶意 URL：** 构造包含目录遍历序列的 URL，例如 `/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`，尝试读取目标文件。
3.  **发送请求：** 使用 HTTP GET 请求将构造的 URL 发送到 JobManager 的 REST API。
4.  **分析响应：** 如果服务器返回目标文件的内容，则表明漏洞存在。\n\n**缓解措施：**\n
*   升级到 Apache Flink 1.11.3 或 1.12.0 及以上版本。
*   限制对 JobManager REST API 的访问。

**项目地址:** [yaunsky/CVE-2020-17519-Apache-Flink](https://github.com/yaunsky/CVE-2020-17519-Apache-Flink)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)