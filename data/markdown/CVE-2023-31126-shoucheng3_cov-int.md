## CVE-2023-31126-XWiki-XSS

**漏洞编号:** CVE-2023-31126

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** XWiki

**危害等级:** 高危，可能允许攻击者注入任意HTML代码，从而执行恶意脚本、窃取用户数据或篡改页面内容。

**影响版本:** >= 14.6-rc-1, < 14.10.4

**利用条件:** 需要用户交互（例如，点击恶意链接或访问被篡改的页面）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-31126是XWiki中org.xwiki.commons:xwiki-commons-xml库存在的一个漏洞。该漏洞源于HTML sanitizer对data属性名称中无效字符的处理不当。攻击者可以利用此漏洞注入任意HTML代码，从而导致跨站脚本攻击。从搜索结果来看，多个网站都提到了该漏洞的严重性以及需要用户交互。漏洞利用代码是一个Jenkinsfile，用于构建XWiki Commons。此Jenkinsfile本身并没有直接体现XSS利用代码，但它负责构建存在漏洞的组件，因此间接与漏洞相关。投毒风险评估：虽然Jenkinsfile本身主要用于构建和测试，但它也可能包含一些隐藏的恶意代码，比如在构建过程中下载或执行恶意脚本，或者修改构建后的工件。 考虑到Jenkinsfile的复杂性，以及它在自动化构建过程中的核心地位，存在一定的被投毒风险，估计为10%。漏洞的利用方式：攻击者通过构造包含恶意data属性的HTML代码，利用XWiki的HTML sanitizer中的漏洞，注入恶意的JavaScript代码。当用户访问包含这些恶意代码的页面时，JavaScript代码将在用户的浏览器中执行，从而导致XSS攻击。

**项目地址:** [shoucheng3/cov-int](https://github.com/shoucheng3/cov-int)

**漏洞详情:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)