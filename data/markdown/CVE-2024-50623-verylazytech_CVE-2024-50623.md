## CVE-2024-50623 - Cleo Unrestricted File Upload

**漏洞编号:** CVE-2024-50623

**漏洞类型:** 未限制文件上传

**影响应用:** Cleo Harmony/VLTrader/LexiCom

**危害等级:** 高危，远程代码执行

**影响版本:** < 5.8.0.21

**利用条件:** 需要网络访问目标Cleo服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-50623 存在于 Cleo Harmony、VLTrader 和 LexiCom 产品中，允许未经授权的文件上传和下载，可能导致远程代码执行。根据漏洞库信息和搜索结果，该漏洞已被积极利用。 Rapid7 和 Broadcom 的报告指出，该漏洞已被用于零日攻击。

**有效性：**
提供的PoC代码看起来是有效的。它包含一个bash脚本，用于利用该漏洞进行读取或写入操作。脚本接受目标URL、操作类型（读/写）和文件路径作为参数。 

**投毒风险：**
该仓库存在一定的投毒风险。虽然PoC本身看起来没有明显的恶意代码，但是脚本的复杂性和对外部资源依赖，以及仓库作者诱导用户付费购买服务,会存在一定的投毒风险。例如，脚本可能包含不必要的网络请求，或将文件写入到非预期位置。 因此，在生产环境中使用之前，应仔细审查和测试该脚本。

**利用方式：**
1.  **查找目标：** 使用 Fofa 等搜索引擎查找易受攻击的 Cleo 服务器。
2.  **克隆PoC代码：** 从 GitHub 克隆提供的存储库。
3.  **运行漏洞利用脚本：** 使用 `cve-2024-50623.sh` 脚本，指定目标 URL、操作（读或写）以及要读取或写入的文件路径。如果需要，可以使用代理。
4.  **上传恶意文件：** 通过写入操作上传包含恶意代码的文件，例如 webshell，到服务器的可执行目录。
5.  **执行恶意代码：** 触发服务器执行上传的恶意文件，实现远程代码执行。

**项目地址:** [verylazytech/CVE-2024-50623](https://github.com/verylazytech/CVE-2024-50623)

**漏洞详情:** [CVE-2024-50623](https://nvd.nist.gov/vuln/detail/CVE-2024-50623)