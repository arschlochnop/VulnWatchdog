## CVE-2025-24813 - Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** Default Servlet 开启写入 (默认关闭), 支持Partial PUT (默认开启), 应用使用Tomcat的文件Session持久化存储(默认位置), 存在可用于反序列化攻击的库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个高危漏洞，源于路径等价（Path Equivalence）问题和不安全的反序列化。

**漏洞利用方式：**

1.  **路径等价和信息泄露/恶意内容注入：** 如果 Tomcat 启用了 Default Servlet 的写入功能（`writes enabled for the default servlet`），并支持 partial PUT（`support for partial PUT`），且存在一个安全敏感文件上传的目标 URL 是公共上传 URL 的子目录，攻击者知晓敏感文件名，并使用 partial PUT 上传，则攻击者可能能够查看敏感文件或向其中注入恶意内容。
2.  **反序列化导致远程代码执行：** 如果 Tomcat 启用了 Default Servlet 的写入功能，支持 partial PUT，且应用程序使用了 Tomcat 的基于文件 Session 持久化存储（使用默认存储位置），并且应用程序包含一个可以用于反序列化攻击的库，那么攻击者可能执行远程代码。

**POC 有效性：**

提供的 POC 代码 `poc-cve.py`  是一个 Python 脚本，用于检测和利用 CVE-2025-24813 漏洞。它包含以下功能：

*   检测 Default Servlet 是否可写（通过 PUT 方法）。
*   生成 ysoserial payload 用于反序列化攻击。
*   通过 PUT 方法上传恶意 payload 到 session 文件，从而触发反序列化漏洞。

根据漏洞信息和 POC 代码，此 POC 具备有效性，可以在满足漏洞利用条件的环境中实现远程代码执行。

**投毒风险分析：**

仔细检查了提供的 Python 脚本 `poc-cve.py` 和 `README.md`。代码主要用于生成和上传恶意 payload，利用反序列化漏洞执行命令。以下是风险评估：

*   **高风险部分**  使用了 `ysoserial.jar`，如果下载源被篡改，可能会引入恶意代码。但脚本本身只是调用 `ysoserial.jar`，并没有直接包含恶意逻辑。
*   **潜在风险** 脚本在生成 payload 过程中，如果 `ysoserial.jar`  被替换为恶意版本，或者脚本中的命令注入点被恶意修改，可能导致投毒。
*   **低风险部分**  脚本中包含删除临时文件的函数 `remove_file`，这有助于清理攻击痕迹，本身不属于投毒行为。

综合评估，该仓库存在一定的投毒风险，主要集中在 ysoserial 的依赖和命令注入的可能性上。考虑到代码的整体结构和目的，以及作者声明的教育目的，直接包含恶意代码的可能性较低。风险评估百分比为10%。主要是考虑到使用者可能会误用或在不安全的环境中使用。

**总结：**

CVE-2025-24813 是一个需要多种条件才能触发的漏洞。 POC 实现了漏洞利用，但存在一定的投毒风险，主要是依赖外部工具 `ysoserial` 且需要谨慎使用。


**项目地址:** [maliqto/PoC-CVE-2025-24813](https://github.com/maliqto/PoC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)