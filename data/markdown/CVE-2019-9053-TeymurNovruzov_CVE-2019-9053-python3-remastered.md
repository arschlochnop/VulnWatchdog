## CVE-2019-9053-CMS Made Simple-时间盲注SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据库信息泄露，获取用户凭据等

**影响版本:** <= 2.2.8

**利用条件:** 目标系统安装了CMS Made Simple 2.2.8或更早版本，并且启用了News模块。攻击者需要能够访问目标网站的`moduleinterface.php`页面。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9053 是一个存在于 CMS Made Simple 2.2.8 版本中的时间盲注 SQL 注入漏洞。此漏洞位于 News 模块中，攻击者可以通过构造特制的 URL，利用 `m1_idlist` 参数进行未经身份验证的 SQL 注入攻击。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码 `remastered_exploit.py` 提供了一个可行的 PoC，用于提取数据库信息，例如 salt、用户名、邮箱和密码。

**投毒风险：**

分析 `remastered_exploit.py` 脚本，发现其主要功能是利用时间盲注漏洞提取信息。脚本结构清晰，主要包含以下几个部分：

*   **参数解析：** 使用 `optparse` 解析命令行参数，例如目标 URL 和是否进行密码破解。
*   **漏洞利用：** 构造恶意 payload，通过 `moduleinterface.php` 的 `m1_idlist` 参数进行时间盲注攻击。
*   **信息提取：** 循环遍历字符集，根据响应时间判断字符是否正确，从而逐步提取 salt、用户名、邮箱和密码等敏感信息。
*   **密码破解（可选）：** 如果指定了 `--crack` 参数，则使用提供的字典进行密码破解。

脚本中未发现明显的恶意代码。但是，需要注意以下几点：

*   **依赖外部资源：** 脚本需要 `requests` 库。虽然 `requests` 是一个常用的 Python 库，但攻击者可以修改脚本，使其依赖于包含恶意代码的第三方库。
*   **密码破解字典：** 如果启用了密码破解功能，脚本将使用字典文件进行破解。攻击者可以提供包含常见密码的字典，提高破解成功的概率。
*   **时间参数 TIME：** 脚本中的 `TIME` 变量控制了时间盲注的延迟时间。攻击者需要根据目标服务器的响应速度调整该值，以确保漏洞利用的成功率。

综合来看，该 PoC 代码本身投毒风险较低，但存在潜在的风险点，例如依赖外部资源和密码破解字典。将投毒风险评估为5%。

**利用方式：**

1.  **确定目标 CMS Made Simple 版本：** 攻击者首先需要确定目标网站是否使用了存在漏洞的 CMS Made Simple 版本（<= 2.2.8）。
2.  **找到 News 模块入口：** 攻击者需要找到 News 模块的入口，通常是 `moduleinterface.php` 文件。
3.  **构造恶意 URL：** 攻击者构造包含恶意 SQL 语句的 URL，并将 `m1_idlist` 参数设置为注入点。
4.  **发送请求并分析响应时间：** 攻击者发送构造的 URL 请求，并根据响应时间判断 SQL 语句是否执行成功。
5.  **提取敏感信息：** 通过时间盲注，攻击者可以逐步提取数据库中的敏感信息，例如 salt、用户名、邮箱和密码。
6.  **密码破解（可选）：** 攻击者可以使用提取的 salt 和密码，结合字典文件进行密码破解。

**示例：**

`http://target-uri/moduleinterface.php?mact=News,m1_,default,0&m1_idlist=a,b,1,5)+and+(select+sleep(5)+from+cms_siteprefs+where+sitepref_name+like+%27sitemask%27)--+`

该 URL 利用时间盲注判断 `cms_siteprefs` 表中是否存在 `sitemask` 字段，如果存在，则延迟 5 秒响应。

**项目地址:** [TeymurNovruzov/CVE-2019-9053-python3-remastered](https://github.com/TeymurNovruzov/CVE-2019-9053-python3-remastered)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)