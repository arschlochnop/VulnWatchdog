## CVE-2019-10392-Jenkins Git Client Plugin-OS 命令注入

**漏洞编号:** CVE-2019-10392

**漏洞类型:** OS 命令注入

**影响应用:** Jenkins Git Client Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.8.4 及更早版本, 3.0.0-rc

**利用条件:** 需要对 Jenkins 具有一定的访问权限，例如具有创建或编辑 Job 的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10392 漏洞存在于 Jenkins Git Client Plugin 中，由于插件没有正确限制传递给 'git ls-remote' 调用的 URL 参数的值，导致了 OS 命令注入。

**利用方式：**
攻击者可以通过构造恶意的 URL，将其作为参数传递给 'git ls-remote' 命令，从而执行任意的 OS 命令。
具体来说，攻击者可以在 URL 中插入 shell 命令，当 Jenkins 调用 'git ls-remote' 时，这些命令会被执行。

**有效性：**
根据漏洞库信息、搜索结果和已有的分析来看，该漏洞利用的有效性较高。存在公开的 POC 可以在受影响的 Jenkins 实例上执行命令。

**投毒风险：**
提供的漏洞利用代码（实际上是 Git Client Plugin 的部分源代码）本身不包含直接的投毒代码。 但是，如果攻击者能够篡改 Jenkins 插件仓库（jenkinsci/git-client-plugin），则可以提交包含恶意代码的 pull request，从而实现投毒。 如果攻击者成功合并了包含恶意代码的 pull request，那么所有使用受感染插件的 Jenkins 实例都可能受到攻击。 仓库中的 Jenkinsfile 主要用于构建和测试插件，CONTRIBUTING.md 只是贡献指南，LICENSE 是许可证文件，README.md 是说明文件，这些文件本身被投毒的可能性较低，但如果存在其他方式可以修改源代码并提交，则存在投毒的可能性。
因此，评估投毒风险为 10%。这个评估是基于攻击者需要控制Jenkins插件仓库的权限才能实现大规模投毒，直接利用这个POC进行投毒是不太可行的。

**项目地址:** [shoucheng3/jenkinsci__git-client-plugin_CVE-2019-10392_2-8-4](https://github.com/shoucheng3/jenkinsci__git-client-plugin_CVE-2019-10392_2-8-4)

**漏洞详情:** [CVE-2019-10392](https://nvd.nist.gov/vuln/detail/CVE-2019-10392)