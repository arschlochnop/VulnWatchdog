## CVE-2024-44258 - Apple 设备 ManagedConfiguration 框架 Symlink 漏洞

**漏洞编号:** CVE-2024-44258

**漏洞类型:** 符号链接（Symlink）漏洞

**影响应用:** iOS, iPadOS, visionOS, tvOS

**危害等级:** 高危，可能导致修改受保护的系统文件

**影响版本:** iOS and iPadOS < 17.7, iOS and iPadOS 18.0 < 18.1, visionOS < 2.1, tvOS < 18.1

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-44258 揭示了 Apple 设备中 ManagedConfiguration 框架和 profiled 守护进程中的一个符号链接漏洞。当恢复精心设计的备份时，迁移过程无法验证目标文件夹是否为符号链接，从而导致未经授权的文件迁移到受限区域。

**有效性：**
根据漏洞描述、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC 代码提供了重现漏洞的步骤，包括创建恶意备份、添加文件以及恢复备份。搜索结果中也提到了该漏洞的利用和修复。

**投毒风险：**
PoC代码本身主要包含漏洞说明、重现步骤和补丁说明。LICENSE文件采用标准的MIT许可证。总体来看，投毒风险较低，但仍需谨慎。风险主要在于：
*   **依赖项：** PoC可能依赖于外部库或工具，这些库或工具可能被篡改或包含恶意代码。（虽然PoC代码中没有体现这一点）。
*   **脚本执行：** 如果 PoC 包含任何需要执行的脚本，这些脚本可能被用于执行恶意操作。
因此，初步估计投毒风险在10%左右。 在使用和运行该PoC代码前，务必进行代码审计和安全检查。

**利用方式：**
1.  攻击者创建一个恶意的备份文件，该备份文件包含指向受保护系统区域的符号链接。
2.  用户在受影响的设备上恢复此恶意备份。
3.  在备份恢复过程中，由于符号链接处理不当，文件被写入到受保护的系统区域，从而可能导致修改系统文件。
4.  设备重启后，被迁移的文件/文件夹会出现在先前受保护的位置。

总而言之，该漏洞允许攻击者通过精心制作的备份文件修改受保护的系统文件，存在潜在的提权和恶意代码执行风险。缓解措施包括更新到已修复的 iOS/iPadOS/visionOS/tvOS 版本。

**项目地址:** [ifpdz/CVE-2024-44258](https://github.com/ifpdz/CVE-2024-44258)

**漏洞详情:** [CVE-2024-44258](https://nvd.nist.gov/vuln/detail/CVE-2024-44258)