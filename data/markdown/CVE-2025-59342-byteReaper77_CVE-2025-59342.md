## CVE-2025-59342-esm.sh-路径遍历

**漏洞编号:** CVE-2025-59342

**漏洞类型:** 路径遍历

**影响应用:** esm.sh

**危害等级:** 中危，可能导致任意文件写入

**影响版本:** <= 136

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 esm.sh 的 `X-Zone-Id` HTTP header 处理中。攻击者可以通过在 `X-Zone-Id` header 中插入 `../` 序列，导致文件被写入到任意目录。 

**有效性评估：**
根据漏洞信息和POC代码，该漏洞利用的有效性较高。漏洞库信息和POC代码都表明可以通过操纵`X-Zone-Id`来实现路径遍历。

**投毒风险分析：**
提供的漏洞利用代码包含 `LICENSE`、`README.md` 和 `exploit.c` 三个文件。

*   `LICENSE` 文件是MIT许可证，属于标准协议文件，没有投毒风险。
*   `README.md` 文件是对漏洞的描述和利用方法的说明，也没有发现任何可疑代码。
*   `exploit.c` 是漏洞利用的C代码，需要仔细分析。
    * 该c代码使用了exit64bit函数,该函数通过内联汇编的方式调用了sys_fsync系统调用，并调用exit系统调用退出。看似比较可疑，但是实际的功能是保证漏洞利用的稳定性，可以判定为不是投毒代码. 

综合来看，该仓库的投毒风险较低，但仍需谨慎使用。

**利用方式分析：**
1.  攻击者构造包含 `../` 序列的 `X-Zone-Id` HTTP header。
2.  攻击者发送带有恶意 header 的 HTTP 请求到 esm.sh 服务器的 `/transform` endpoint。
3.  esm.sh 服务器没有正确地对 `X-Zone-Id` 进行 canonicalize 或限制，导致服务器将文件写入到攻击者指定的任意目录。

**项目地址:** [byteReaper77/CVE-2025-59342](https://github.com/byteReaper77/CVE-2025-59342)

**漏洞详情:** [CVE-2025-59342](https://nvd.nist.gov/vuln/detail/CVE-2025-59342)