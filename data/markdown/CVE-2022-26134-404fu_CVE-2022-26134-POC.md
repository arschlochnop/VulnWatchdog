## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，未授权的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence服务可访问，目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center中的OGNL注入漏洞。未经身份验证的攻击者可以利用此漏洞在Confluence服务器或数据中心实例上执行任意代码。通过构造特制的HTTP请求，将恶意OGNL表达式注入到请求的URI中，即可触发该漏洞。该PoC脚本通过发送包含命令的payload来利用该漏洞，并从响应头中提取执行结果。

**漏洞利用方式：**

1.  **构造Payload：** 构造包含OGNL表达式的URL，该表达式可以执行任意命令。PoC中使用了`org.apache.commons.io.IOUtils`和`java.lang.Runtime`来执行系统命令，并将结果写入HTTP响应头。
2.  **发送请求：** 将构造好的URL发送到目标Confluence服务器。
3.  **执行命令：** 如果目标服务器存在漏洞，OGNL表达式将被解析并执行，从而在服务器上执行任意命令。
4.  **获取结果：** 从HTTP响应头中提取命令执行的结果。

**投毒风险分析：**

代码中存在风险函数的调用Runtime.getRuntime().exec(),会存在命令执行的风险。PoC的主要功能是利用OGNL注入执行命令，并将命令回显在HTTP头中。代码本身没有发现明显的恶意逻辑，但如果利用此PoC进行非法活动，比如下载恶意文件，依然会对目标系统造成危害，存在轻微投毒风险。

**项目地址:** [404fu/CVE-2022-26134-POC](https://github.com/404fu/CVE-2022-26134-POC)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)