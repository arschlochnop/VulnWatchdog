## CVE-2023-40028-Ghost-Arbitrary File Read

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 5.59.1

**利用条件:** 需要高权限（Authenticated user）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40028 漏洞存在于 Ghost CMS 5.59.1 之前的版本中。攻击者需要具备 Ghost CMS 的管理员权限，可以通过上传包含符号链接的 ZIP 文件来读取服务器上的任意文件。

**有效性：**

提供的 POC 代码看起来有效，因为它包含了以下步骤：

1.  **身份验证：** 使用提供的用户名和密码对 Ghost CMS 进行身份验证，获取会话 cookie。
2.  **准备文件：** 创建一个包含指向目标文件的符号链接的 ZIP 文件。POC代码先在`/tmp/exploit/content/images/2024`中创建一个uuid名称的png图片，并将其链接到要读取的文件，然后将`/tmp/exploit`目录压缩为`exploit.zip`文件。
3.  **文件上传：** 将生成的 ZIP 文件上传到 Ghost CMS 的数据库导入端点 `/ghost/api/v3/admin/db`。
4.  **读取文件：** 上传后，可以通过访问包含符号链接的图片URL来读取目标文件的内容。

搜索结果也证实了漏洞的存在和可利用性，并且在GitHub上存在POC。

**投毒风险：**

该 POC 代码主要用于演示任意文件读取漏洞，但仍然存在轻微的投毒风险。代码本身看起来相对简单，没有明显的恶意行为，例如执行系统命令或传播恶意软件。但是，攻击者可能会修改 POC 代码以包含以下恶意行为：

*   **数据收集：** 收集有关目标系统的敏感信息，例如操作系统版本、已安装的软件等，并将这些信息发送给攻击者。
*   **后门植入：** 在目标系统上植入后门，以便攻击者将来可以访问该系统。
*   **拒绝服务：** 通过上传大量文件或执行其他资源密集型操作来导致目标系统崩溃。

例如，攻击者可能修改`shell`函数，在打印文件内容前，将cookie和读取的文件路径发送到攻击者的服务器。因为用户需要提供用户名和密码，URL，攻击者可以轻易的获取Ghost站点的敏感信息。所以存在10%的投毒风险。

**利用方式：**

1.  攻击者首先需要获得Ghost CMS的管理权限用户的账号密码
2.  攻击者使用该POC脚本，输入账号密码和目标Ghost CMS的URL。
3.  脚本登录Ghost CMS，获取会话cookie。
4.  攻击者通过交互式shell输入要读取的文件路径。
5.  脚本在本地创建一个包含指向目标文件的符号链接的 ZIP 文件。
6.  脚本将 ZIP 文件上传到 Ghost CMS 的数据库导入端点。
7.  攻击者通过访问包含符号链接的图片URL来读取目标文件的内容。

总而言之，该漏洞允许经过身份验证的用户上传包含符号链接的文件，从而绕过文件访问限制并读取服务器上的任意文件。POC代码是有效的，但存在轻微的投毒风险，用户在使用前应仔细审查代码。

**项目地址:** [monke443/CVE-2023-40028](https://github.com/monke443/CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)