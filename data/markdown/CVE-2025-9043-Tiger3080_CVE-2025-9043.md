## CVE-2025-9043-Seagate Toolkit-权限提升

**漏洞编号:** CVE-2025-9043

**漏洞类型:** 未引用的搜索路径或元素

**影响应用:** Seagate Toolkit

**危害等级:** 高危，可导致权限提升至SYSTEM

**影响版本:** < 2.34.0.33

**利用条件:** 需要管理员权限和对根目录的写权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-9043 存在于Seagate Toolkit 2.34.0.33 之前的版本中，是一个未引用的搜索路径漏洞(CWE-428)。由于服务执行路径没有被正确引用，攻击者如果拥有管理员权限，并且具有对根目录的写入权限，就可以放置一个恶意的`Program.exe`文件。当存在漏洞的服务启动时，恶意的二进制文件会以SYSTEM权限执行，从而导致权限提升。 

**有效性:** 根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的利用是有效的。PoC中描述了攻击者准备恶意DLL和脚本，持续复制到用户可控路径。通过修改安装路径到用户可控位置，安装完成后，攻击者获得了SYSTEM权限的reverse shell，证明了该漏洞可以被成功利用。

**投毒风险:** PoC代码中包含将恶意DLL复制到特定位置的操作，理论上存在将恶意代码伪装成PoC一部分进行传播的风险。虽然主要的漏洞利用逻辑是基于未引用的路径，但复制DLL的操作为植入后门提供了机会。考虑到PoC作者明确，漏洞原理清晰，且PoC主要演示了权限提升，而非植入持久性后门，因此判定投毒风险较低，为10%。这种风险主要来自于用户下载和执行PoC代码时，可能引入了额外的恶意组件。

**利用方式:**
1.  **前提条件:** 攻击者需要具备Windows系统的管理员权限。
2.  **定位未引用的服务路径:** 确定Seagate Toolkit服务未正确引用的可执行文件路径。
3.  **写入恶意文件:** 利用管理员权限，在未引用路径的搜索路径上（通常是根目录），放置一个伪装成`Program.exe`的恶意可执行文件（例如，一个反向shell）。
4.  **重启服务或系统:** 触发Seagate Toolkit服务启动（例如重启系统）。由于服务启动时会搜索未引用的路径，恶意程序会被优先执行，从而获取SYSTEM权限。

**项目地址:** [Tiger3080/CVE-2025-9043](https://github.com/Tiger3080/CVE-2025-9043)

**漏洞详情:** [CVE-2025-9043](https://nvd.nist.gov/vuln/detail/CVE-2025-9043)