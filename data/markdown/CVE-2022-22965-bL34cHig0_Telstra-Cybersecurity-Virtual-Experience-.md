## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat (WAR deployment), 存在RequestMapping和POJO参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22965，又名 Spring4Shell，是一个Spring Framework的远程代码执行漏洞。根据漏洞库信息，运行在JDK 9+的Spring MVC或Spring WebFlux应用可能受到影响。该漏洞利用需要应用部署为Tomcat WAR包。如果部署为Spring Boot可执行jar，则不受影响。漏洞利用方式是利用数据绑定，将恶意属性写入到`class.module.classLoader.resources.context.parent.pipeline.first.pattern`等属性中，最终写入恶意webshell。

**有效性评估：**
根据搜索结果，该漏洞已被积极利用。

**利用方式：**
攻击者通过发送包含恶意参数的HTTP请求，利用Spring的数据绑定功能修改Tomcat的日志配置，写入webshell。webshell的路径和文件名可以通过请求参数指定。攻击者可以通过webshell执行任意代码。

**投毒风险分析：**
提供的代码是一个防火墙脚本，旨在阻止利用CVE-2022-22965的恶意请求。它通过检查请求路径和HTTP头来识别恶意流量，并返回403 Forbidden错误。此代码本身**不包含任何恶意功能或后门**，因此，投毒风险评估为0%。它主要通过正则表达式来匹配恶意请求，如请求路径包含`/tomcatwar.jsp`或者HTTP头部包含`suffix=%>//`等特征。这个脚本的目的是防御Spring4Shell攻击，而不是利用它。

**项目地址:** [bL34cHig0/Telstra-Cybersecurity-Virtual-Experience-](https://github.com/bL34cHig0/Telstra-Cybersecurity-Virtual-Experience-)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)