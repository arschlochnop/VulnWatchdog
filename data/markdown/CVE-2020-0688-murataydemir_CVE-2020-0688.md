## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据进行身份验证，以及对Exchange Control Panel (ECP) 的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 ECP 组件中使用了静态的 cryptographic key。攻击者利用已知密钥伪造 ViewState 数据，从而在服务器上执行任意代码，获取SYSTEM权限。

**有效性：**
提供的POC代码有效。根据漏洞描述，Exchange Server 所有安装共享相同的 validationKey 和 decryptionKey，允许经过身份验证的攻击者通过构造恶意的 ViewState 数据进行反序列化攻击，从而执行任意代码。

**投毒风险：**
该POC代码主要提供的是漏洞利用方法，并引用了YSoSerial.net工具生成payload，本身不包含任何恶意代码或后门。因此，投毒风险极低。

**利用方式：**
1.  攻击者首先需要获取一个有效的Exchange用户账户的凭据（可以通过钓鱼或其他手段）。
2.  使用该凭据登录到 Exchange 的 OWA 或 ECP 页面，获取 `ASP_NET_SessionId` 和 `__VIEWSTATEGENERATOR` 的值。
3.  使用 `YSoSerial.net` 工具，利用已知 `validationKey` (CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF) 和 `validationalg` (SHA1) 生成恶意的 ViewState payload。可以构造payload执行任意命令，例如反弹shell。
4.  将生成的 ViewState payload 插入到 ECP 的请求中，发送到服务器。例如：`http(s)://exchangeserver/ecp/default.aspx?__VIEWSTATEGENERATOR=<generator>&__VIEWSTATE=<ViewState_Payload>`
5.  服务器在处理该请求时，会反序列化恶意的 ViewState 数据，从而执行攻击者指定的代码，最终导致远程代码执行。

**项目地址:** [murataydemir/CVE-2020-0688](https://github.com/murataydemir/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)