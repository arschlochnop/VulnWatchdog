## CVE-2025-50461: Verl Remote Code Execution via Unsafe Model Deserialization

**漏洞编号:** CVE-2025-50461

**漏洞类型:** 远程代码执行

**影响应用:** volcengine/verl

**危害等级:** 高危，允许攻击者执行任意代码，控制受影响的系统。

**影响版本:** <= v0.4.0

**利用条件:** 需要目标系统运行存在漏洞的verl版本，且执行`scripts/model_merger.py`脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Volcengine verl 3.0.0及更早版本的`scripts/model_merger.py`脚本中，当使用"fsdp"后端时，该脚本使用`torch.load()`加载用户提供的`.pt`文件，并且`weights_only=False`。攻击者可以构造恶意的`.pt`文件，其中包含恶意代码，当受害者运行该脚本加载恶意文件时，恶意代码会被执行，导致远程代码执行。

**利用方式：**
1. 攻击者创建恶意的`.pt`模型文件，该文件包含恶意代码（例如，使用`pickle`模块构造一个`Malicious`类，其`__reduce__`方法执行系统命令）。
2. 攻击者将恶意文件重命名为`model_world_size_4_rank_0.pt`，并放置在`TESTS`目录下。
3. 受害者执行`scripts/model_merger.py`脚本，指定`--backend="fsdp" --local_dir="TESTS" --hf_model_path="TESTS"`参数。
4. 脚本会调用`torch.load()`加载恶意的`.pt`文件，导致恶意代码执行。

**POC有效性：**
提供的POC代码是有效的，可以成功触发漏洞并执行任意命令（例如，创建`HACKED!`目录）。

**投毒风险：**
根据提供的代码，没有发现明显的投毒代码。所有的代码都是围绕着验证和利用反序列化漏洞，不存在额外注入恶意代码的行为。因此，投毒风险为0%。

**项目地址:** [Anchor0221/CVE-2025-50461](https://github.com/Anchor0221/CVE-2025-50461)

**漏洞详情:** [CVE-2025-50461](https://nvd.nist.gov/vuln/detail/CVE-2025-50461)