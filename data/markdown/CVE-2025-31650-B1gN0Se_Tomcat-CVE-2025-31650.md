## CVE-2025-31650 - Apache Tomcat DoS

**漏洞编号:** CVE-2025-31650

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器瘫痪

**影响版本:** 9.0.76 - 9.0.102, 10.1.10 - 10.1.39, 11.0.0-M2 - 11.0.5

**利用条件:** 需要目标服务器启用HTTP/2并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31650 漏洞存在于 Apache Tomcat 中，是由于对 HTTP 优先级标头的不正确输入验证造成的。攻击者可以通过发送大量畸形的 HTTP/2 优先级标头，导致服务器内存泄漏，最终触发 OutOfMemoryException 从而造成拒绝服务。

**有效性：**
提供的PoC 代码（TomcatKiller - CVE-2025-31650 PoC）旨在利用此漏洞。该代码通过发送大量包含无效优先级标头的 HTTP/2 请求来攻击目标 Tomcat 服务器。代码中包含检查 HTTP/2 支持的功能以及服务器标头检测，以确认目标是否易受攻击。

**投毒风险：**
PoC 代码主要功能是发送恶意请求以利用漏洞。潜在的投毒风险在于，攻击者可能修改此 PoC 以包含以下恶意行为：
1.  **资源耗尽：** 即使目标服务器未运行 Tomcat，攻击者也可能修改代码以针对其他服务并耗尽其资源。
2.  **信息收集：** 攻击者可能会添加代码以收集有关目标系统的其他信息，例如操作系统版本或已安装的软件。
3.  **后门植入：** 虽然不太可能，但理论上可以修改代码以在目标服务器上植入后门。
通过分析，PoC的代码较为简单，主要目的就是发送大量畸形的HTTP/2请求，如果存在后门，很可能会增加timeout的时间，目前timeout时间是0.3秒，比较短，不太容易藏匿其他代码。因此，投毒风险估计为10%。

**利用方式：**
1.  **目标确认：** 确定目标服务器是否运行 Apache Tomcat 并且启用了 HTTP/2。
2.  **版本检查：** 确定 Tomcat 版本是否在受影响的范围内 (9.0.76 - 9.0.102, 10.1.10 - 10.1.39, 11.0.0-M2 - 11.0.5)。
3.  **发送恶意请求：** 使用 PoC 代码或类似工具，向目标服务器发送大量包含畸形 HTTP 优先级标头的请求。
4.  **监控服务器：** 监控目标服务器的性能。如果利用成功，服务器的内存使用率会逐渐增加，最终导致崩溃或变得无响应。

**项目地址:** [B1gN0Se/Tomcat-CVE-2025-31650](https://github.com/B1gN0Se/Tomcat-CVE-2025-31650)

**漏洞详情:** [CVE-2025-31650](https://nvd.nist.gov/vuln/detail/CVE-2025-31650)