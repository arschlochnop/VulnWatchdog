## CVE-2025-29927 - Next.js Middleware 认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用 Next.js，并且使用了存在漏洞的中间件进行认证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件认证绕过漏洞。该漏洞源于 Next.js 对 `x-middleware-subrequest` 请求头处理不当。当应用在中间件中进行权限验证时，攻击者可以通过构造包含 `x-middleware-subrequest` 请求头的请求来绕过认证，访问受保护的资源。

**漏洞利用方式：**

1.  **检测：** POC 代码首先通过发送 GET 请求到目标 URL，然后检查响应头中是否包含 Next.js 特有的标识，例如 `x-powered-by`，`x-nextjs-cache` 等。如果检测到 Next.js 并且状态码为 200，则认为目标可能存在漏洞。
2.  **绕过认证：** 漏洞利用的关键在于 `x-middleware-subrequest` 请求头。攻击者需要在发送到 Next.js 应用的请求中添加这个请求头，从而绕过中间件的认证检查。
3.  **访问受保护资源：** 一旦成功绕过认证，攻击者就可以访问原本需要授权才能访问的资源。

**有效性：**

POC 代码的有效性在于它可以帮助安全研究人员和开发人员快速检测 Next.js 应用是否存在 CVE-2025-29927 漏洞。POC 脚本通过检查 HTTP 响应头来判断目标站点是否使用了 Next.js 框架，从而帮助用户验证目标是否为受影响的 Next.js 应用。

**投毒风险：**

提供的 POC 代码中没有发现明显的恶意代码或后门，风险较低。代码功能主要是发送 HTTP 请求，检测 Next.js 的存在并打印响应头。因此，该代码被投毒的可能性很低。可以认为投毒风险是0%。

**项目地址:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)