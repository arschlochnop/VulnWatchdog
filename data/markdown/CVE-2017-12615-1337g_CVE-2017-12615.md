## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)