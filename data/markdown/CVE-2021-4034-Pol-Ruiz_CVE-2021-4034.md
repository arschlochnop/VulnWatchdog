## CVE-2021-4034-Polkit-pkexec本地提权

**漏洞编号:** CVE-2021-4034

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使普通用户获得root权限

**影响版本:** all

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-4034是Polkit的pkexec工具中的一个本地权限提升漏洞。pkexec是一个setuid工具，旨在允许非特权用户以特权用户的身份运行命令，基于预定义的策略。漏洞源于pkexec没有正确处理调用参数的计数，最终尝试将环境变量作为命令执行。攻击者可以通过构造环境变量，诱使pkexec执行任意代码，从而获得目标机器上的管理权限。

**有效性：**
根据漏洞描述和搜索结果，此漏洞确实存在并且影响范围较广，利用代码的存在也证实了其可利用性。

**投毒风险：**
提供的“漏洞利用代码”实际上是许可协议文件（LICENSE和LICENSE.md），并非实际的漏洞利用代码。因此，无法直接分析其是否存在投毒行为。但从信息安全角度考虑，任何来源不明的代码都存在潜在风险，此处假设存在较低的投毒风险(5%), 主要是担心下载/使用 POC 的过程中被替换或篡改。

**利用方式：**
1.  **构造恶意环境变量：** 攻击者构造特殊的环境变量，这些环境变量包含攻击者想要执行的恶意代码。
2.  **利用参数计数错误：** 由于`pkexec`在处理参数时存在缺陷，它会将构造的恶意环境变量作为命令来执行。
3.  **权限提升：**  通过执行恶意代码，攻击者可以获得root权限。

**补充说明:** 真正的POC代码通常会利用环境变量来执行shell命令或加载恶意共享库。由于未提供真正的POC代码，以上分析基于漏洞描述和搜索结果进行推断。

**项目地址:** [Pol-Ruiz/CVE-2021-4034](https://github.com/Pol-Ruiz/CVE-2021-4034)

**漏洞详情:** [CVE-2021-4034](https://nvd.nist.gov/vuln/detail/CVE-2021-4034)