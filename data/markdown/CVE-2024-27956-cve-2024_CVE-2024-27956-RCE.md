## CVE-2024-27956-WordPress Automatic Plugin SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 3.92.0

**利用条件:** 目标安装了受影响版本的WordPress Automatic插件，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27956是ValvePress Automatic插件中一个未经身份验证的SQL注入漏洞，影响版本小于等于3.92.0。攻击者可以通过向`wp-content/plugins/wp-automatic/inc/csv.php`发送恶意构造的SQL查询，从而执行任意SQL代码。利用代码`exploit.py`首先创建一个具有管理员权限的恶意用户（eviladmin），从而获得对WordPress站点的完全控制。虽然提供的代码功能明确，但我将投毒风险评为10%。这个评估源于以下考虑：

1.  **外部依赖**: 漏洞利用脚本依赖于`requests`库。虽然这是一个常用的Python库，但攻击者可能在其中插入恶意代码，诱导用户安装。
2.  **硬编码参数**: 脚本中存在一些硬编码的参数，例如默认的用户名(`eviladmin`)和密码哈希。攻击者可能修改这些参数，使得利用过程更容易被检测到或者留下更明显的攻击痕迹，从而降低利用成功率。
3.  **特定URL**: 漏洞利用依赖于特定的URL路径(`/wp-content/plugins/wp-automatic/inc/csv.php`)。插件的目录结构可能会改变，导致漏洞利用失败。

这些因素可能导致利用代码无法在所有目标上成功执行，但其主要目的是创建后门管理员账户，风险依然很高。

**利用方式：**

1.  **发送恶意请求：** 攻击者使用`exploit.py`脚本，该脚本构造包含恶意SQL语句的POST请求，发送到目标WordPress网站的`wp-content/plugins/wp-automatic/inc/csv.php`。
2.  **SQL注入：**  `csv.php`文件没有对请求参数进行充分的过滤，导致SQL注入漏洞。攻击者可以通过`q`参数传递SQL查询语句。
3.  **创建管理员账户：** 攻击者通过SQL注入创建新的管理员账户，如`eviladmin`，并设置密码。
4.  **提升权限：** 攻击者通过SQL注入修改`wp_usermeta`表，将新创建的用户的权限提升为管理员。
5.  **远程代码执行：**  成功利用此漏洞后，攻击者可以使用新创建的管理员账户登录WordPress后台，并通过安装恶意插件或编辑主题文件等方式实现远程代码执行。

**项目地址:** [cve-2024/CVE-2024-27956-RCE](https://github.com/cve-2024/CVE-2024-27956-RCE)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)