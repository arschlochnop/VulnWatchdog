## CVE-2017-7921 - Hikvision IP Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 权限提升/认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可导致完全控制设备、敏感信息泄露

**影响版本:** 受影响版本见漏洞库信息和漏洞利用代码的描述。

**利用条件:** 目标设备使用受影响的固件版本，且Web端口（通常为80/443）可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 漏洞存在于 Hikvision IP 摄像头中，由于身份验证不当导致。攻击者无需任何凭据即可利用此漏洞，通过发送特制的 HTTP 请求到 `/Security/users` 接口来修改现有用户的密码，包括管理员密码，从而完全控制设备。漏洞利用代码 `main.py` 脚本首先从 `ip.txt` 文件读取 IP 地址列表。然后，对于每个 IP 地址，它通过构造的URL下载配置文件，使用AES解密，再通过XOR解密，最后提取配置文件中的字符串。URL中`auth=YWRtaW46MTEK`绕过认证获取配置文件，获取敏感信息，例如用户名和密码。根据漏洞描述和POC代码，该漏洞利用方式有效。代码中没有发现明显的投毒行为。脚本只是尝试下载、解密和分析设备配置文件。

**项目地址:** [initon/Hikvision---CVE-2017-7921](https://github.com/initon/Hikvision---CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)