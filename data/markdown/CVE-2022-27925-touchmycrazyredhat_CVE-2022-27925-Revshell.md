## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限，但存在未经身份验证的利用方式

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-27925 是 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 中存在的路径遍历漏洞。攻击者可以通过 mboximport 功能上传包含恶意路径的 ZIP 压缩包，从而将任意文件写入系统。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码尝试利用该漏洞上传 Webshell 或反弹 Shell。代码中包含了构建恶意 ZIP 压缩包的函数 `build_zip`，以及发送 POST 请求的 `exploit` 函数。POC代码利用了mboximport接口上传zip文件，实现了文件上传和RCE。

**投毒风险：**
虽然 POC 代码本身旨在利用漏洞，但存在一定的投毒风险。代码中存在 webshell 的定义，如果攻击者在未经授权的情况下修改了代码，可以替换 webshell 的内容，例如添加恶意代码或后门，从而在成功利用漏洞后进行进一步的恶意活动。但代码整体较为简单，且目标明确，可以判断投毒风险较低。

**利用方式：**
1.  攻击者首先需要构建一个包含恶意路径的 ZIP 压缩包。恶意路径指向 Web 目录下，例如 `../../../../opt/zimbra/jetty/webapps/zimbraAdmin/webshell.jsp`。
2.  攻击者使用 `mboximport` 功能上传此 ZIP 压缩包。如果上传成功，Zimbra 会将 ZIP 压缩包中的文件解压到指定的路径，从而将 Webshell 写入系统。
3.  攻击者通过访问 Webshell 的 URL 来执行任意命令。

**利用流程总结：**

   1.  **构造恶意 ZIP 文件：** ZIP 文件内部包含精心构造的文件路径，使其在解压时能够写入到目标目录（通常是 Web 服务器的可访问目录）。文件内容为 Webshell 代码（例如JSP代码）。
   2.  **利用 `mboximport` 上传：**  利用 Zimbra 的 `mboximport` 功能，将构造好的恶意 ZIP 文件上传到服务器。
   3.  **路径遍历：**  `mboximport` 解压 ZIP 文件时，由于没有充分验证文件路径，导致路径遍历漏洞，恶意文件被写入到指定目录。
   4.  **访问 Webshell：**  攻击者可以通过 Web 浏览器访问上传的 Webshell 文件，从而执行任意命令。

根据搜索结果，此漏洞已经被广泛利用，并存在未经身份验证的利用方式，因此修复此漏洞至关重要。

**项目地址:** [touchmycrazyredhat/CVE-2022-27925-Revshell](https://github.com/touchmycrazyredhat/CVE-2022-27925-Revshell)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)