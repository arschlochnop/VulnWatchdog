## CVE-2022-0492-Linux Kernel-cgroup_release_agent特权提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致容器逃逸和主机控制

**影响版本:** kernel 5.17 rc3 (受影响)

**利用条件:** 需要cgroups v1 release_agent功能可用

**POC 可用性:** 否 (提供的代码不是漏洞利用的POC)

**投毒风险:** 1%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 `cgroup_release_agent_write` 函数中（kernel/cgroup/cgroup-v1.c）。在特定情况下，攻击者可以利用 cgroups v1 的 release_agent 功能来提升权限，并绕过命名空间隔离。根据搜索结果，这个漏洞允许容器逃逸并控制主机。

**有效性：**
提供的代码实际上是一个shell脚本模板，包含格式化输出功能，**并不是针对CVE-2022-0492漏洞的exploit**。它只是一些颜色输出的辅助函数，没有包含任何利用漏洞的代码。因此，提供的POC代码无效。

**投毒风险：**
代码中包含的`LICENSE`声明为MIT许可证，允许修改和分发。虽然模板本身没有明显的恶意代码，但存在作者可以后续提交恶意代码的风险。由于提供的脚本非常简单，只包含格式化输出，因此其投毒风险较低，估计为1%。潜在的投毒方式可能包括在实际的漏洞利用脚本中嵌入后门，或者利用格式化输出中的特殊字符进行注入，但当前代码不具备这些功能。

**利用方式：**
根据漏洞信息和搜索结果，CVE-2022-0492 的利用方式主要涉及以下步骤：

1.  **利用条件：** 需要目标系统启用cgroups v1，并且攻击者需要具备一定的权限来修改 cgroup 的相关配置，例如 `release_agent`。
2.  **设置 `release_agent`：** 将 cgroup 的 `release_agent` 设置为一个攻击者可控的脚本路径。
3.  **触发 `release_agent`：** 当 cgroup 中的进程退出时，内核会执行 `release_agent` 指定的脚本，此时该脚本将在宿主机命名空间中执行，从而实现权限提升。
4.  **容器逃逸：** 如果攻击者在容器内成功利用此漏洞，则可以逃逸到宿主机，并获得宿主机的控制权。

**总结：** 提供的代码不是漏洞利用的PoC，只是一个格式化输出的模板，投毒风险较低，但仍需注意。

**项目地址:** [Perimora/cve_2022_0492](https://github.com/Perimora/cve_2022_0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)