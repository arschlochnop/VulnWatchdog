## CVE-2023-32784-KeePass主密码恢复

**漏洞编号:** CVE-2023-32784

**漏洞类型:** 内存泄漏/密码恢复

**影响应用:** KeePass

**危害等级:** 高危，允许攻击者恢复明文主密码

**影响版本:** < 2.54

**利用条件:** 需要能够访问目标系统的内存转储（例如，KeePass进程转储，交换文件，休眠文件或RAM转储）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32784 漏洞允许攻击者从 KeePass 2.x（低于 2.54 版本）的内存转储中恢复明文主密码。即使工作区已锁定或不再运行，也可能发生这种情况。该漏洞利用方式主要分为以下几个步骤：

1.  **获取内存转储：** 攻击者需要获取 KeePass 进程的内存转储。这可以通过多种方式实现，例如，直接转储 KeePass 进程的内存、分析交换文件（pagefile.sys）、休眠文件（hiberfil.sys）或整个系统的 RAM 转储。
2.  **分析内存转储：**  攻击者需要分析获取的内存转储，以找到明文形式的主密码。可以使用 `keepass-password-dumper` 等工具辅助分析。
3.  **（如果主密码不完整）暴力破解：**  漏洞描述中指出，只能恢复除第一个字符外的所有密码，因此POC代码`BruteForce-to-KeePass.ps1` 脚本通过用户提供已知的字符集和后缀，组合成密码字典，然后使用PoshKPBrute工具的核心功能（代码已被简化和改编）来识别访问KeePass数据库（kdbx文件）的有效主密钥.
4.  **访问数据库：** 成功恢复主密码后，攻击者可以使用该密码解锁 KeePass 数据库，从而访问其中存储的所有密码和其他敏感信息。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开的利用代码。提供的 PowerShell 脚本 `BruteForce-to-KeePass.ps1` 是一个辅助利用脚本，它通过暴力破解的方式来补全从内存转储中恢复的不完整主密码。因此，该脚本的有效性取决于从内存转储中恢复了多少密码字符。

**投毒风险：**

该脚本存在一定的投毒风险，风险评估为 5%。虽然主要功能是生成密码字典并尝试破解 KeePass 数据库，但攻击者可能在脚本中加入恶意代码，例如：

*   **数据窃取：** 在尝试破解密码的同时，将用户的输入（字符集、已知字符串、KDBX 文件路径）发送到远程服务器。
*   **恶意文件操作：**  在用户不知情的情况下，修改或删除系统文件。
*   **反向Shell：**  在目标机器上启动反向Shell，方便攻击者远程控制。

尽管风险较低，但在执行任何从互联网上下载的脚本之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [und3sc0n0c1d0/BruteForce-to-KeePass](https://github.com/und3sc0n0c1d0/BruteForce-to-KeePass)

**漏洞详情:** [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-32784)