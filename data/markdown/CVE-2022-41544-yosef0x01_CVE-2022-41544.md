## CVE-2022-41544-GetSimple CMS-远程代码执行

**漏洞编号:** CVE-2022-41544

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GetSimple CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** v3.3.16

**利用条件:** 需要目标 GetSimple CMS 实例运行在易受攻击的版本，并且攻击者可以访问该 CMS 实例。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41544 是 GetSimple CMS v3.3.16 中的一个远程代码执行（RCE）漏洞，该漏洞存在于 `admin/theme-edit.php` 文件中，通过 `edited_file` 参数进行利用。攻击者可以利用此漏洞上传恶意PHP文件，从而在服务器上执行任意代码。

**利用方式：**

1.  **版本检测：** 脚本首先尝试确定 GetSimple CMS 的版本，该版本应该小于或等于 3.3.16 才能利用此漏洞。
2.  **API Key 泄露：** 脚本尝试从 `data/other/authorization.xml` 文件中获取 API Key。这是绕过身份验证所必需的。
3.  **Cookie 设置：** 使用用户名、版本和 API Key 生成有效的 Cookie，然后将其设置在请求头中，以进行身份验证绕过。
4.  **CSRF Token 获取：** 从 `admin/theme-edit.php` 页面获取 CSRF Token，这对于后续的 POST 请求至关重要。
5.  **上传 Shell：** 使用构造的 POST 请求，通过 `theme-edit.php` 页面中的 `edited_file` 参数，将包含反向 shell 代码的 PHP 文件上传到服务器。`edited_file` 被设置为 `../shell.php`，从而将 shell 上传到 Web 可访问目录。
6.  **触发 Shell：** 脚本尝试访问上传的 shell 文件 `shell.php`，以触发反向 shell 连接。

**投毒风险分析：**

提供的 POC 代码主要功能是利用漏洞进行远程代码执行，没有明显的投毒代码。虽然脚本会自动上传一个PHP shell，但这属于漏洞利用的一部分，而不是隐藏的恶意行为。

**结论：**

该 POC 代码有效，可以用于在易受攻击的 GetSimple CMS 实例上执行远程代码。代码本身没有发现任何投毒行为。

**项目地址:** [yosef0x01/CVE-2022-41544](https://github.com/yosef0x01/CVE-2022-41544)

**漏洞详情:** [CVE-2022-41544](https://nvd.nist.gov/vuln/detail/CVE-2022-41544)