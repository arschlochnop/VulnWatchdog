## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `sudo` 命令的 `--chroot` 选项，结合用户可控目录下的 `/etc/nsswitch.conf` 文件，获取 root 权限。简单来说，攻击者可以创建一个恶意的 `/etc/nsswitch.conf` 文件，然后利用 `sudo` 命令以 chroot 方式运行程序，`sudo` 会加载攻击者控制的 `/etc/nsswitch.conf` 文件，从而可能加载恶意的动态链接库，最终提升权限。

**漏洞利用方式：**

1.  **创建恶意 `/etc/nsswitch.conf`:**  攻击者需要创建一个包含恶意配置的 `/etc/nsswitch.conf` 文件，该文件指向攻击者控制的恶意共享库。
2.  **利用 `sudo --chroot`:**  攻击者使用 `sudo --chroot` 命令，指定 chroot 目录为包含恶意 `/etc/nsswitch.conf` 的目录。
3.  **权限提升:**  `sudo` 加载恶意的 `/etc/nsswitch.conf` 后，会加载攻击者指定的恶意共享库，从而执行恶意代码并提升到 root 权限。

**POC有效性评估：**

从搜索结果来看，多个来源确认了该漏洞的存在，并将其评为高危。由于漏洞库信息明确指出了受影响的版本范围，并且搜索结果中提供了漏洞分析和缓解措施，可以判断该漏洞利用是有效的。

**投毒风险评估：**

提供的漏洞利用代码是一个 Creative Commons Legal Code 许可协议。它本身不是漏洞利用程序，而是关于代码使用许可的声明。因此，此文件中**不存在**任何形式的恶意代码，投毒风险评估为0%。实际的漏洞利用代码应该包含构建恶意 `/etc/nsswitch.conf` 以及调用 `sudo --chroot` 的过程。如果存在其他相关文件，需要进一步分析才能评估投毒风险。

**项目地址:** [blackcat4347/CVE-2025-32463_PoC](https://github.com/blackcat4347/CVE-2025-32463_PoC)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)