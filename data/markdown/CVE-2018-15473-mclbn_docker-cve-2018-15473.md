## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)