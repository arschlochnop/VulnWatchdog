## CVE-2025-31161-CrushFTP身份认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 10.0.0 <= version < 10.8.4 and 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP实例必须暴露在公网上，且未配置DMZ代理

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31161 是 CrushFTP 10 和 11 版本中存在的一个关键身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞接管 crushadmin 账户，从而完全控制系统。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已经被野外利用。提供的 POC 代码旨在利用此漏洞，通过发送特制的 HTTP 请求绕过身份验证，进而列出现有用户或添加新用户。该POC提供了Go和Bash两种实现，增强了其有效性。

**投毒风险：**
该POC代码主要功能是利用漏洞进行用户枚举和添加用户。虽然没有明显的恶意代码植入，但任何利用漏洞的代码都可能被滥用。风险主要在于以下几点：

*   **滥用风险：** 该工具简化了漏洞利用过程，降低了攻击门槛，可能导致大规模攻击。
*   **依赖性风险：** Bash脚本依赖`curl`，Go脚本依赖Go环境。虽然常用，但如果攻击者修改脚本增加恶意依赖，则存在风险。
*   **更新滞后风险：** 如果 CrushFTP 发布补丁，但使用者未及时更新 POC 代码，可能导致利用失败或留下痕迹。
*   **信息泄露风险：** 使用`-lu`参数列出用户可能泄露信息，方便后续攻击。

综合来看，投毒风险较低，主要风险在于工具本身的利用，以及使用者是否保持更新。因此，评估投毒风险为5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞基于 CrushFTP 中 HTTP 组件的 AWS4-HMAC 授权方法中的竞态条件和缺陷。服务器在验证用户时，首先调用 `login_user_pass()` 函数，无需密码即可验证用户是否存在。攻击者通过发送格式错误的 AWS4-HMAC 头部，可以绕过后续的用户验证，并导致代码索引越界错误，阻止会话清理。
2.  **利用步骤：**
    *   **用户枚举：** 使用 `-lu` 参数列出现有用户列表，例如：`go run cve-2025-31161.go -t example.com -lu`
    *   **添加用户：** 使用 `-au` 参数添加新用户（通常是管理员权限），例如：`go run cve-2025-31161.go -t example.com -au`，然后按照提示输入用户名和密码。
3.  **利用结果：** 成功利用漏洞后，攻击者可以创建任意用户，并通过该用户登录 CrushFTP 系统，执行任意操作，包括读取、修改、删除文件，以及执行系统命令。

**项目地址:** [0xDTC/CrushFTP-auth-bypass-CVE-2025-31161](https://github.com/0xDTC/CrushFTP-auth-bypass-CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)