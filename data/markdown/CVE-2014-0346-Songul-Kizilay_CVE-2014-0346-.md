## CVE-2014-0160 (Heartbleed)

**漏洞编号:** CVE-2014-0346

**漏洞类型:** 信息泄露

**影响应用:** OpenSSL

**危害等级:** 高危，可能导致敏感信息泄露，如私钥、用户凭据等

**影响版本:** OpenSSL 1.0.1 to 1.0.1f (inclusive)

**利用条件:** 目标服务器使用存在漏洞的OpenSSL版本并启用了心跳扩展

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-0160，也被称为Heartbleed漏洞，是OpenSSL加密库中的一个严重漏洞。该漏洞存在于TLS/DTLS心跳扩展的实现中。攻击者可以发送特制的心跳请求到服务器，导致服务器返回内存中的敏感数据，而这些数据可能包含私钥、用户凭据和其他敏感信息。

**有效性：**

提供的POC代码(32745.py)是一个用于检测和利用Heartbleed漏洞的Python脚本。根据漏洞描述和代码内容，该POC能够有效地发送恶意心跳请求，并尝试从服务器的内存中读取数据。脚本会检测服务器是否返回超过预期长度的数据，从而判断服务器是否存在漏洞。

**投毒风险：**

查看了/tmp/a03b0ab06e9a47db898bc28c80f47cf1/32745.py脚本和/tmp/a03b0ab06e9a47db898bc28c80f47cf1/README.md, 脚本本身是一个相对标准的Heartbleed漏洞利用程序，主要功能是发送恶意的心跳包并解析返回的数据。没有发现明显的恶意代码，如反弹shell、持久化后门或其他类型的恶意行为。但需要指出的是，任何漏洞利用代码都具有潜在的风险，因为它们可能会被用于未经授权的渗透测试。`README.md`文件提供了免责声明，进一步降低投毒风险。风险评估为5%。

**利用方式：**

1.  **连接目标服务器：**  POC脚本首先建立与目标服务器的安全连接，模拟正常的SSL/TLS握手过程。
2.  **发送Client Hello：** 发送Client Hello消息。
3. **等待Server Hello:** 等待Server Hello消息，如果连接在Server Hello之前关闭，则退出
4.  **发送恶意心跳请求：**  脚本构造一个恶意的心跳请求，其中指定一个较大的数据长度，但实际发送的数据量很小。这会导致服务器尝试读取超出实际数据长度的内存。
5.  **接收响应并提取数据：**  服务器在处理恶意心跳请求后，会返回一块内存区域。脚本接收服务器的响应，并从中提取泄露的内存数据。提取的数据会被以十六进制格式打印出来，供分析人员进一步分析。

**项目地址:** [Songul-Kizilay/CVE-2014-0346-](https://github.com/Songul-Kizilay/CVE-2014-0346-)

**漏洞详情:** [CVE-2014-0346](https://nvd.nist.gov/vuln/detail/CVE-2014-0346)