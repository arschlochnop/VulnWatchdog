## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)