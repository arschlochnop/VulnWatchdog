## CVE-2020-13777-GnuTLS-会话票证加密漏洞

**漏洞编号:** CVE-2020-13777

**漏洞类型:** TLS会话票证加密漏洞

**影响应用:** GnuTLS

**危害等级:** 高危，TLS 1.2中可能导致信息泄露，TLS 1.3中可能导致身份验证绕过

**影响版本:** 3.6.x (3.6.4 - 3.6.13)

**利用条件:** 服务器使用受影响的GnuTLS版本，且尚未进行密钥轮换

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13777是GnuTLS 3.6.4到3.6.13版本中的一个漏洞，由于使用了错误的密码学方法加密会话票证，导致TLS 1.2连接的机密性受损，以及TLS 1.3连接的身份验证绕过。漏洞原因是服务器在首次密钥轮换之前，使用错误的数据代替从应用程序派生的加密密钥。

**有效性：**
根据搜索结果，该漏洞影响GnuTLS 3.6.4至3.6.13版本。提供的PoC代码和相关的README文件表明该PoC用于技术验证，解析pcap文件，模拟离线环境中的攻击，而不是针对真实服务器的攻击，用于验证捕获的数据包。该PoC着重于理解 TLS 1.3 的重连机制并进行离线验证，因此可以认为是有效的，至少在离线分析数据包的场景下。

**投毒风险：**
检视提供的文件列表（LICENSE、README.md）和代码，未发现任何恶意代码或后门。`hkdf.py`是从`aioquic`项目中复制的HKDF函数，并附带了原始的License信息。`README.md`文件中也明确声明了PoC的用途和免责声明。因此，评估认为该PoC的投毒风险为0%。

**利用方式：**
利用方式主要是针对使用了存在漏洞的GnuTLS版本（3.6.4到3.6.13）的服务器。攻击者可以捕获服务器发送的会话票证，并利用该票证在TLS 1.3中绕过身份验证。由于会话票证使用全零密钥加密，因此可以轻易地解密并重用。利用Zeek等工具也可以检测网络流量中存在的该漏洞。简单的来说，攻击者可以监听网络流量，获得加密错误的session ticket，然后伪造身份，重新连接服务器。

**项目地址:** [prprhyt/PoC_TLS1_3_CVE-2020-13777](https://github.com/prprhyt/PoC_TLS1_3_CVE-2020-13777)

**漏洞详情:** [CVE-2020-13777](https://nvd.nist.gov/vuln/detail/CVE-2020-13777)