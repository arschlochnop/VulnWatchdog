## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)