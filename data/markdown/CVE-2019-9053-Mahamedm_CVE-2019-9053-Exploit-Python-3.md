## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 2.2.9

**利用条件:** 需要目标系统安装了CMS Made Simple，并且News模块可用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-9053 是 CMS Made Simple (CMSMS) 软件中发现的一个基于时间的盲注 SQL 注入漏洞。攻击者可以通过精心构造的 URL，利用 News 模块中的 m1_idlist 参数实现未经身份验证的攻击。提供的 Python 脚本旨在从数据库中提取数据，然后有选择地使用提供的字典和不同的编码来破解提取的哈希值。

**有效性：**
漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞存在且有效。搜索引擎结果中包含指向 Exploit-DB 的链接 (46635)，其中包含利用此漏洞的PoC。GitHub 上的仓库 (Mahamedm/CVE-2019-9053-Exploit-Python-3) 也提供了可用于利用该漏洞的 Python 3 脚本。

**投毒风险：**
检查提供的Python脚本`csm_made_simple_injection.py`，虽然代码存在修改历史，但是逻辑比较清晰，主要就是构造payload，发送请求，根据时间判断是否存在注入。脚本中的参数功能也比较明确，没有发现恶意代码，只是一个比较常规的SQL注入脚本，因此投毒风险较低。存在的风险点是编码问题可能导致脚本无法正常执行或者结果错误，但这不是投毒。
因此，评估的投毒风险为1%。这个百分比是因为代码经过修改，且从外部仓库获取，存在极小的被篡改的可能性，但内容本身未发现明显的投毒行为。

**利用方式：**
1.  **漏洞定位：** 该漏洞位于 CMS Made Simple 的 News 模块的 moduleinterface.php 文件中，具体是通过 m1_idlist 参数进行注入。
2.  **利用过程：** 攻击者首先需要确定目标 CMS Made Simple 站点是否存在此漏洞（版本 <= 2.2.9）。
3.  **构造Payload：** 攻击者构造包含恶意 SQL 代码的 URL，该 URL 通过 m1_idlist 参数传递给 moduleinterface.php。由于是盲注，攻击者无法直接看到 SQL 查询的结果。
4.  **时间盲注：** 攻击者使用时间盲注技术来推断数据库内容。通过在 SQL 查询中引入 `sleep()` 函数，攻击者可以根据服务器响应时间来判断条件是否为真。例如，如果 `sleep(5)` 被执行，服务器将延迟 5 秒响应，否则立即响应。
5.  **数据提取：** 攻击者可以通过重复上述步骤，逐步提取数据库中的敏感信息，例如用户名、密码哈希等。
6.  **密码破解（可选）：** 获取到密码哈希后，攻击者可以使用字典攻击或彩虹表等方法来破解密码。
7.  **利用代码使用：** 使用提供的 csm_made_simple_injection.py 脚本，指定目标 URL，可以选择是否使用字典破解密码，并可以设置时间延迟来适应网络状况。

**项目地址:** [Mahamedm/CVE-2019-9053-Exploit-Python-3](https://github.com/Mahamedm/CVE-2019-9053-Exploit-Python-3)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)