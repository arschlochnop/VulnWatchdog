## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)