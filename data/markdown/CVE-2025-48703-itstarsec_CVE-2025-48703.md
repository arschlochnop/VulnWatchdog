## CVE-2025-48703 - CentOS Web Panel 未授权远程代码执行

**漏洞编号:** CVE-2025-48703

**漏洞类型:** 远程代码执行

**影响应用:** CentOS Web Panel (CWP)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.9.8.1204

**利用条件:** 需要目标服务器开放web服务端口，通常是80或443

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据搜索结果和提供的漏洞利用代码，CVE-2025-48703是CentOS Web Panel (CWP)中的一个未授权远程代码执行漏洞。该漏洞影响CWP 0.9.8.1204及更早版本。根据NVD的描述(网页2)，漏洞存在于`/admin/menu_save.php`文件中，通过操纵`menu`参数可导致SQL注入，但PoC代码显示漏洞位于`/admin/index.php?module=filemanager&acc=changePerm`，通过`user`参数进行命令执行。利用方式是发送一个POST请求到目标URL，其中`user`参数包含恶意代码，例如'`id`'。如果响应中包含"uid="，则表示命令已成功执行，目标服务器存在漏洞。

**有效性：** 根据github issue 和 exploit 网站，POC代码是有效的，可以在目标服务器上执行任意命令。

**投毒风险：** 提供的PoC代码本身看起来比较直接，没有明显的恶意行为或后门。但是，任何未经审核的代码都存在潜在的风险。风险主要来自于：

1.  **第三方依赖：** PoC使用了`requests`和`urllib3`库，如果这些库本身被投毒，可能导致安全问题。
2.  **执行环境：** 在生产环境中执行未经充分测试的PoC可能导致意外的系统故障或数据丢失。
3.  **日志和监控：** 攻击者的行为可能会被记录，如果PoC包含不明显的恶意代码，可能会被用于后续的攻击。
4.  **个人判断：** 虽然PoC本身可能没有后门，但任何代码都可能被修改或替换。因此，需要谨慎对待任何下载的代码。

因此，投毒风险评估为10%。主要原因是代码比较简短，功能单一，逻辑清晰，但是无法保证作者或者其他人不会在原始代码的基础上进行修改，从而植入恶意代码。

**利用方式：**

1.  确定目标CWP版本小于等于0.9.8.1204。
2.  构造包含恶意命令的POST请求，发送到`/admin/index.php?module=filemanager&acc=changePerm`，并设置`user`参数为`'` + 命令 + `'` (使用反引号将命令包裹，使其在SQL注入上下文中执行)。
3.  检查响应，如果响应中包含"uid="，则表示命令已成功执行。

**项目地址:** [itstarsec/CVE-2025-48703](https://github.com/itstarsec/CVE-2025-48703)

**漏洞详情:** [CVE-2025-48703](https://nvd.nist.gov/vuln/detail/CVE-2025-48703)