## CVE-2025-54988 - Apache Tika PDF parser module XXE

**漏洞编号:** CVE-2025-54988

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Apache Tika (tika-parser-pdf-module)

**危害等级:** 高危，可能导致敏感数据泄露、访问内部资源、触发第三方服务器恶意请求。

**影响版本:** 1.13 <= version <= 3.2.1

**利用条件:** 目标系统使用存在漏洞的 Apache Tika 版本，且允许处理恶意构造的 PDF 文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54988 是 Apache Tika PDF parser module 中的一个严重的 XXE 漏洞。攻击者可以构造包含恶意 XFA 表单的 PDF 文件，利用漏洞读取服务器上的敏感数据，或者发起对内网或其他服务器的恶意请求。

**漏洞利用方式：**

1.  攻击者构造一个恶意的 PDF 文件，其中包含一个恶意的 XFA 表单。
2.  恶意 XFA 表单中包含 XXE payload，例如读取本地文件或发起 HTTP 请求。
3.  目标系统使用 Apache Tika 解析该 PDF 文件，Tika 的 PDF parser module 在处理 XFA 表单时，没有正确地禁用外部实体引用，导致 XXE 漏洞。
4.  XXE payload 被执行，攻击者可以读取敏感文件或发起恶意请求。

**POC 代码分析：**

提供的 POC 代码 `xfa_xxe_poc_gen.py` 用于生成包含恶意 XFA 表单的 PDF 文件。该脚本支持两种模式：

*   `file` 模式：用于读取本地文件，通过 `file:///` 协议指定目标文件路径。
*   `oob` 模式：用于发起带外 (OOB) 数据泄露，需要攻击者搭建一个 HTTP 服务器来接收泄露的数据。

**投毒风险评估：**

POC 代码本身的主要功能是生成XXE payload。投毒风险较低，风险评估为10%。

**搜索引擎结果分析：**

搜索结果确认了漏洞的存在，并提供了漏洞的详细信息，包括受影响的版本、攻击方式和修复建议。部分搜索结果还提到存在可利用此漏洞的exp。

**建议：**

*   升级 Apache Tika 到 3.2.2 或更高版本。
*   如果无法升级，可以考虑禁用 PDF parser module 或配置 Tika 以禁用外部实体引用。

**项目地址:** [mgthuramoemyint/POC-CVE-2025-54988](https://github.com/mgthuramoemyint/POC-CVE-2025-54988)

**漏洞详情:** [CVE-2025-54988](https://nvd.nist.gov/vuln/detail/CVE-2025-54988)