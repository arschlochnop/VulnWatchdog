## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)