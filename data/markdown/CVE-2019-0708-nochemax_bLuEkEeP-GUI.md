## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)