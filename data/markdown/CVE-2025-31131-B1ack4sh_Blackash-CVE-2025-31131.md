## CVE-2025-31131-YesWiki-路径遍历

**漏洞编号:** CVE-2025-31131

**漏洞类型:** 路径遍历

**影响应用:** YesWiki

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 4.5.2

**利用条件:** 需要网络访问，目标YesWiki版本低于4.5.2

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31131是YesWiki 4.5.2之前的版本中存在的一个路径遍历漏洞。攻击者可以利用`squelette`参数，通过构造包含`../`的恶意路径，读取服务器上的任意文件。该漏洞无需身份验证即可利用。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞利用是有效的。多个来源都确认了该漏洞的存在，并提供了利用的思路。POC代码也验证了这一点。

**投毒风险：**
提供的POC代码经过分析，主要功能是发送HTTP请求来利用路径遍历漏洞，读取目标服务器上的文件。代码中没有发现任何明显的恶意代码或后门，例如执行系统命令、上传文件等。因此，投毒风险较低，可以评估为0%。

**利用方式：**
利用方式是通过向YesWiki服务器发送特制的HTTP GET请求，在URL中包含`squelette`参数，并赋予其包含`../`的恶意值，从而实现路径遍历。具体步骤如下：

1.  构造URL：`{url}/?UrkCEO/edit&theme=margot&squelette={path}&style=margot.css`，其中`{url}`是YesWiki的URL，`{path}`是包含`../`的路径，用于指定要读取的文件。
2.  对路径进行URL编码：使用`urllib.parse.quote`对构造的路径进行URL编码，防止特殊字符干扰。
3.  发送HTTP GET请求：使用`requests.get`发送包含恶意路径的GET请求。
4.  检查响应：如果成功读取到文件，响应中会包含文件内容。POC代码会检查响应中是否包含`/etc/passwd`文件的典型内容，例如`root:x:0:0:`或`bin/bash`，从而判断漏洞是否存在。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-31131](https://github.com/B1ack4sh/Blackash-CVE-2025-31131)

**漏洞详情:** [CVE-2025-31131](https://nvd.nist.gov/vuln/detail/CVE-2025-31131)