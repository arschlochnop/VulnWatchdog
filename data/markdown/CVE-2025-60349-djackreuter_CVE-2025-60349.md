## CVE-2025-60349: Pxscan Arbitrary Process Termination

**漏洞编号:** CVE-2025-60349

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Prevx v3.0.5.220 (pxscan.sys)

**危害等级:** 中危/高危，取决于被终止进程的重要性。可能导致系统不稳定或功能失效。

**影响版本:** v3.0.5.220

**利用条件:** 需要本地访问，目标系统安装了Prevx v3.0.5.220，并且注册表中`HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\pxscan\Files` 存在需要被终止的进程。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Prevx v3.0.5.220的`pxscan.sys`驱动中。攻击者可以通过发送特定的IO控制代码 `0x22E044` 到设备 `\\.\pxscan` 来触发漏洞。该操作会导致注册表 `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\pxscan\Files`  下注册的进程被终止，从而造成拒绝服务。 

**有效性：** 
提供的PoC代码似乎是有效的。它首先尝试打开 `\\.\pxscan` 设备句柄，然后创建一个注册表项 `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\pxscan\Files`，然后通过`DeviceIoControl`发送`IOCTL_CODE`。由于没有实际发送IOCTL请求的代码,所以判断PoC的完整度较低。

**投毒风险：** 
PoC代码中存在一定的投毒风险，但是根据LICENSE和作者信息，这种风险应该较低。代码的投毒点可能在于注册表项的创建和进程终止逻辑。攻击者可能会修改注册表项的名称或者添加额外的恶意进程到注册表中，从而影响其他进程。风险评判为10%的原因是，代码依赖Windows API，相对安全，但仍有可能被修改。

**利用方式：** 
1.  打开 `\\.\pxscan` 设备的句柄。
2.  创建或修改注册表项 `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\pxscan\Files`，将要终止的进程的可执行文件路径添加到该注册表项的值中。
3.  通过 `DeviceIoControl` 函数，向打开的设备句柄发送 IO 控制代码 `0x22E044`。
4.  `pxscan.sys` 驱动接收到该 IO 控制代码后，会遍历注册表 `HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\pxscan\Files` 下的进程，并终止它们。

**注意：**
*   此漏洞需要在本地以管理员权限运行。
*   成功利用此漏洞可以导致被攻击进程的终止，从而造成拒绝服务。

**项目地址:** [djackreuter/CVE-2025-60349](https://github.com/djackreuter/CVE-2025-60349)

**漏洞详情:** [CVE-2025-60349](https://nvd.nist.gov/vuln/detail/CVE-2025-60349)