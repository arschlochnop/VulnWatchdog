## CVE-2025-32462-Sudo-主机权限绕过

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危，可能导致用户在不应有的主机上执行命令

**影响版本:** < 1.9.17p1

**利用条件:** Sudo版本低于1.9.17p1，sudoers文件配置不当，在多台机器上使用同一份sudoers文件，且sudoers文件中存在针对特定主机名的规则。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32462 允许用户在使用 -h 参数时，绕过 sudoers 文件中定义的主机限制，从而在不应允许的主机上执行命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞库信息明确指出该漏洞存在于 Sudo 1.9.17p1 之前的版本，并且漏洞描述与搜索引擎结果中的描述一致，即允许用户绕过基于主机名的访问限制。提供的Dockerfile 构建环境，安装了存在漏洞的 sudo 版本 1.9.15p5, 并提供了一个示例 sudoers 配置，模拟了受影响的环境。

**投毒风险分析：**

提供的Dockerfile和README.md 文件中没有发现明显的恶意代码。Dockerfile 的作用是构建一个包含漏洞版本的 Sudo 的环境，README.md 描述了漏洞原理和复现步骤。代码主要用于搭建漏洞环境和演示漏洞，没有发现植入后门的迹象。因此，投毒风险较低。

**利用方式分析：**

1.  **漏洞存在条件：**
    *   Sudo 版本低于 1.9.17p1。
    *   sudoers 文件中包含针对特定主机名的规则，例如 `Alice hostA = (root) commandA`。
    *   用户尝试在另一台主机（例如 hostB）上使用 `sudo -h hostA commandA` 命令。

2.  **利用过程：**
    *   用户在主机 hostB 上登录。
    *   用户执行 `sudo -h hostA commandA` 命令。
    *   由于漏洞，Sudo 没有正确验证主机名，导致用户成功在 hostB 上以 root 权限执行了 commandA，即使 sudoers 文件中只允许 Alice 在 hostA 上执行 commandA。

3.  **影响：**
    *   攻击者可以利用该漏洞在不应允许的主机上执行命令，可能导致权限提升和系统安全问题。

**项目地址:** [SpongeBob-369/cve-2025-32462](https://github.com/SpongeBob-369/cve-2025-32462)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)