## CVE-2025-29927 - Next.js Middleware 授权绕过漏洞

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行授权检查，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是一个 Next.js 中间件授权绕过漏洞。攻击者可以通过发送包含 `x-middleware-subrequest` 头的恶意请求，绕过中间件中的身份验证和授权检查，从而访问受保护的资源。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛报道。提供的POC代码包含一个完整的测试环境，包括易受攻击的Next.js应用、测试脚本和详细的文档。这些脚本通过发送带有特定header的请求来验证漏洞的存在，因此POC代码是有效的。

**投毒风险：**
POC代码旨在测试和演示漏洞，而非进行恶意活动。不过，任何代码库都存在潜在的风险。考虑到该项目的主要目的是安全测试，作者隐藏恶意代码的可能性较低，但仍不能完全排除。风险主要在于使用者可能错误地理解或恶意地使用这些代码，例如，在生产环境中进行未经授权的渗透测试。代码仓库的检测逻辑主要通过header来绕过验证，属于对漏洞的正常利用，不视为投毒。综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者构造一个HTTP请求，并在请求头中包含 `x-middleware-subrequest: middleware` 。
2.  将该请求发送到受保护的Next.js路由或API端点。
3.  如果Next.js应用的版本在受影响范围内，中间件将错误地认为该请求是内部子请求，从而跳过身份验证和授权检查。
4.  攻击者成功绕过授权，访问受保护的资源。

**项目地址:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)