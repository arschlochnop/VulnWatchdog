## CVE-2012-2982 - Webmin file/show.cgi 远程命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 1.590

**利用条件:** 需要Webmin的有效用户名和密码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2982 漏洞存在于 Webmin 1.590 及更早版本的 file/show.cgi 中。经过身份验证的远程用户可以通过在路径名中使用无效字符（如 | 管道符）来执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞**有效**。Exploit-DB 和 Metasploit 都有相关的利用，并且提供的Python脚本也实现了该漏洞的利用。

**投毒风险：**

分析提供的Python脚本 `CVE-2012-2982.py` 后，**没有发现明显的投毒代码**。代码逻辑清晰，主要是模拟登录Webmin，然后利用 `file/show.cgi` 漏洞执行命令。它使用 `argparse` 处理参数，使用 `requests` 发送HTTP请求。随机字符串生成用于避免某些过滤规则，命令通过URL编码后传递，没有发现隐藏恶意行为。因此，投毒风险评估为 **0%**。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要有效的Webmin用户名和密码。通过 `session_login.cgi` 进行身份验证。
2.  **构造恶意请求：** 成功登录后，攻击者构造一个包含管道符 `|` 的恶意请求发送到 `file/show.cgi`。例如： `/file/show.cgi/bin/<random_string>|<command>|`。
3.  **命令执行：** Webmin会将管道符后面的命令作为系统命令执行，从而实现远程命令执行。

提供的PoC代码通过以下步骤利用此漏洞：

*   获取目标Webmin服务器的地址、端口、用户名、密码和要执行的命令。
*   使用提供的用户名和密码登录到Webmin。
*   构造包含管道命令的URL，并使用经过身份验证的会话发送GET请求。
*   目标服务器执行该命令。

**项目地址:** [JohnHammond/CVE-2012-2982](https://github.com/JohnHammond/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)