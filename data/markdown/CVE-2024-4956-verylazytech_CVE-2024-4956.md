## CVE-2024-4956-Sonatype Nexus Repository 3-路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，允许未经身份验证的攻击者读取系统文件

**影响版本:** <= 3.68.0

**利用条件:** 目标系统运行受影响的Sonatype Nexus Repository Manager 3版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 3 中的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过构造包含路径遍历序列的 URL 来读取服务器上的任意文件。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。搜索引擎结果中多个来源确认了该漏洞的存在以及未经身份验证的读取系统文件的能力。提供的 Python POC 代码通过发送带有特殊构造的 URL 尝试读取 `/etc/passwd` 和 `/etc/shadow` 文件来验证漏洞。

**投毒风险：**
分析提供的 POC 代码，未发现明显的投毒代码。该脚本的主要功能是发送 HTTP 请求并检查响应内容，以确认漏洞是否存在。脚本逻辑比较直接，没有发现任何试图在目标系统上安装后门或者进行其他恶意操作的代码。

**利用方式：**
1.  攻击者构造包含路径遍历序列（例如 `../`）的恶意 URL。
2.  攻击者将构造的 URL 发送到受影响的 Sonatype Nexus Repository Manager 3 服务器。
3.  服务器未正确验证 URL 中的路径，导致攻击者可以访问受限目录之外的文件。
4.  攻击者读取到服务器上的敏感文件，例如 `/etc/passwd` 或 `/etc/shadow`。

例如，POC 代码中使用的 URL 如下：
`http://<ip_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F../etc/passwd`

此 URL 尝试通过路径遍历读取 `/etc/passwd` 文件。成功利用此漏洞可以允许攻击者在目标服务器上读取敏感信息，从而可能导致进一步的攻击。

**项目地址:** [verylazytech/CVE-2024-4956](https://github.com/verylazytech/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)