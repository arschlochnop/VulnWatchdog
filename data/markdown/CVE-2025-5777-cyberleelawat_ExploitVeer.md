## CVE-2025-5777 Citrix NetScaler Memory Disclosure (CitrixBleed 2)

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存信息泄露

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露，如session tokens。

**影响版本:** 13.1 < 58.32, 14.1 < 43.56 (受影响版本)

**利用条件:** NetScaler配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) OR AAA virtual server

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5777，又名CitrixBleed 2，是一个NetScaler ADC和Gateway中的内存信息泄露漏洞。由于对输入的验证不足，攻击者可以通过发送特制的HTTP请求（POST /p/u/doAuthentication.do）来读取服务器内存，从而泄露敏感数据，例如会话cookie。漏洞利用代码（CVE-2025-5777.yaml）使用nuclei扫描器，通过发送包含`login`的POST请求到`/p/u/doAuthentication.do`路径，如果返回状态码为200且响应头包含`application/vnd.citrix.authenticateresponse`，则尝试提取`<InitialValue>`标签内的内容。如果提取到的内容长度大于0，且不包含`false`、`true`或空标签，则判定目标存在漏洞。检测脚本（CVE-2025-5777.bcheck）使用相同的方法进行检测。漏洞利用方式是通过构造特殊的身份验证请求，触发内存过读，从而获取敏感信息。投毒风险较低(10%)，主要基于以下考虑：

1.  **许可证和作者信息：** 提供了MIT许可证和作者信息，这增加了一定的可信度，降低了恶意投毒的可能性。
2.  **代码内容：**  代码的主要功能是发送特定的HTTP请求，并根据响应内容进行判断，以检测漏洞的存在。代码逻辑相对简单，不容易隐藏恶意代码。
3.  **文件结构：**  包含了`README.md`、`.yaml`、`.bcheck`和`LICENSE`文件，文件结构比较规范，表明作者可能注重代码质量和可维护性。

尽管如此，仍然存在一定的风险，因为恶意代码可能被隐藏在看似无害的字符串或逻辑中。由于内存读取漏洞本身的性质，任何能够控制输入并读取响应的攻击者都可以利用该漏洞，无需特定凭据。

**项目地址:** [cyberleelawat/ExploitVeer](https://github.com/cyberleelawat/ExploitVeer)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)