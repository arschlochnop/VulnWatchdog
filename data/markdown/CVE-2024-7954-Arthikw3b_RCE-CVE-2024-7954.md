## CVE-2024-7954 SPIP porte_plume插件远程代码执行漏洞

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统安装了受影响版本的SPIP，并且启用了porte_plume插件，攻击者需要能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中。未经验证的远程攻击者可以通过发送特制的HTTP请求来执行任意PHP代码。提供的POC代码展示了如何利用该漏洞。利用方式为：

1.  发送一个POST请求到`/index.php?action=porte_plume_previsu`。
2.  在POST请求的`data`参数中，包含一个嵌入了PHP代码的payload，例如`data=AA_[->URL<?php system('cat /etc/passwd'); ?>]_BB`。
3. 服务器执行`system()`函数中的命令。

**关于投毒风险：**
虽然提供的Exploit部分看起来是直接的漏洞利用代码，但是nuclei扫描命令需要下载nuclei-templates-main, 这存在一定的风险， 如果nuclei-templates-main这个仓库本身被投毒，则可能会导致间接的投毒攻击，所以有10%的风险。同时需要注意，不要把POC验证时执行的后门代码误判为投毒代码，本分析已将这种情况排除。

**项目地址:** [Arthikw3b/RCE-CVE-2024-7954](https://github.com/Arthikw3b/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)