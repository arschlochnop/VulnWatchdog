## CVE-2025-2539 - File Away <= 3.9.9.0.1 - Unauthenticated Arbitrary File Read

**漏洞编号:** CVE-2025-2539

**漏洞类型:** 任意文件读取

**影响应用:** File Away WordPress 插件

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 3.9.9.0.1

**利用条件:** 目标网站安装了受影响版本的 File Away 插件，且 WordPress 的 admin-ajax.php 可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2539 漏洞存在于 File Away WordPress 插件中，版本小于等于 3.9.9.0.1。该漏洞由于 `ajax()` 函数缺少权限验证，允许未经身份验证的攻击者利用弱加密算法读取服务器上的任意文件。\n\n**漏洞利用方式：**\n1.  **寻找目标：** 使用 Fofa 等搜索引擎，通过 dork `(body="/wp-content/plugins/file-away/" || (body="http://gmpg.org/xfn/11" && body="/wp-content/plugins/sparklethemes-shortcodes") && icon_hash="1198047028")` 查找安装了 File Away 插件的 WordPress 站点。\n2.  **获取 Nonce：** 访问目标网站首页，提取 `fileaway_stats` 变量中的 `nonce` 值。\n3.  **利用漏洞：** 使用 PoC 脚本（如提供的 `cve-2025-2539.sh`）发送 POST 请求到 `wp-admin/admin-ajax.php`，其中包含 `action=fileaway-stats`，`nonce`，以及要读取的文件名 `file`。\n4.  **获取文件内容：** 从响应中提取文件 URL，下载文件内容。\n\n**有效性：**\n提供的 PoC 代码 `cve-2025-2539.sh` 看起来有效，它通过模拟攻击者发送包含恶意参数的请求，来读取指定文件。 根据描述，利用步骤清晰，且代码逻辑完整。\n\n**投毒风险：**\n虽然 PoC 仓库的README.md中明确声明了免责声明，指出仅用于教育和道德测试目的。代码本身主要功能是发送网络请求和处理响应，没有明显的恶意代码。脚本本身没有直接执行系统命令或修改系统配置的代码。\n但是考虑到以下几点潜在风险：\n*   **依赖外部命令：** 脚本依赖于 `curl`、`grep`、`sed` 等外部命令。如果这些命令被篡改或替换为恶意版本，可能会导致安全问题。\n*   **保存文件：** 脚本会将读取的文件保存到本地。如果目标文件包含恶意代码，可能会感染攻击者的系统。\n*   **个人习惯风险：** 开发者的其他项目可能存在风险，由于本次只分析当前给定的 PoC 代码，所以不考虑此风险。\n\n因此，综合判断，投毒风险较低，估计为 10%。风险主要来源于对外部命令的依赖和保存文件可能带来的潜在威胁。

**项目地址:** [verylazytech/CVE-2025-2539](https://github.com/verylazytech/CVE-2025-2539)

**漏洞详情:** [CVE-2025-2539](https://nvd.nist.gov/vuln/detail/CVE-2025-2539)