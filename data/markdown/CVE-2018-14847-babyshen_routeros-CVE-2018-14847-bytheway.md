## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)