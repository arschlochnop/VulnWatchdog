## CVE-2025-30208-Vite文件读取漏洞

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 受影响版本：< 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite dev server 需要显式暴露到网络 (使用 `--host` 或 `server.host` 配置选项)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30208 是 Vite 中存在的一个文件读取漏洞。攻击者可以通过构造包含 `?raw??` 或 `?import&raw??` 的特殊 URL，绕过 `server.fs.deny` 限制，读取 Vite 服务允许列表之外的文件内容。该漏洞的利用方式如下：

1.  **漏洞描述：** Vite 在处理 URL 时，未正确处理查询字符串中的 trailing separators，导致可以绕过文件系统访问限制。
2.  **影响：** 攻击者可以读取服务器上的任意文件，包括配置文件、源代码、凭据等敏感信息。
3.  **利用条件：** 需要 Vite dev server 暴露到网络，并且使用受影响的版本。
4.  **利用方式：** 攻击者构造包含恶意 payload 的 URL，例如 `http://target_url/@fs/etc/passwd?raw??`。
5.  **缓解措施：** 升级到 Vite 的修复版本 (>= 4.5.10, >= 5.4.15, >= 6.0.12, >= 6.1.2, >= 6.2.3)。

**POC有效性：** 提供的 shell 脚本 `CVE-2025-30208.sh` 通过尝试不同的 payload 和文件路径，来利用该漏洞。脚本接受目标 URL 作为参数，并可以选择指定要读取的特定文件。脚本通过发送包含恶意 payload 的 HTTP 请求来尝试读取文件。

**投毒风险分析：** 脚本本身主要是尝试利用漏洞进行文件读取，并未发现直接的恶意代码或后门。脚本中包含大量可能泄露敏感信息的常用文件路径，作者可能是为了最大化漏洞利用的可能性。考虑到脚本的主要目的是漏洞利用，以及代码的直接性，投毒风险较低。判断投毒的概率较低，约为1%。如果`TARGET` 参数可控，并被恶意用户控制，存在一定的风险。


**项目地址:** [gonn4cry/CVE-2025-30208](https://github.com/gonn4cry/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)