## CVE-2025-30772 - WordPress WPC Smart Upsell Funnel for WooCommerce Privilege Escalation

**漏洞编号:** CVE-2025-30772

**漏洞类型:** 权限提升

**影响应用:** WPC Smart Upsell Funnel for WooCommerce

**危害等级:** 高危，允许低权限用户提升为管理员权限

**影响版本:** <= 3.0.4

**利用条件:** 需要已安装存在漏洞版本的WPC Smart Upsell Funnel for WooCommerce插件的WordPress站点，以及一个低权限的WordPress用户账户。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30772 存在于 WordPress WPC Smart Upsell Funnel for WooCommerce 插件中，允许已通过身份验证的低权限用户通过修改 `default_role` 选项将新注册用户默认为管理员，从而实现权限提升。

**有效性分析：**

*   根据漏洞库信息，该漏洞是由于缺少授权验证导致任意选项更新。
*   提供的PoC代码的利用方式是：首先，使用提供的用户名和密码登录 WordPress 站点；然后，从插件的管理页面提取 nonce 值；最后，通过 `admin-ajax.php` 接口，利用 `wpcuf_import_export_save` action 修改 `default_role` 选项的值为 `administrator`。
*   根据漏洞库和PoC代码描述，利用流程清晰，利用逻辑合理，且CVSS评分较高，因此PoC有效。

**投毒风险分析：**

*   PoC 代码本身比较简单，主要功能是登录、获取 Nonce 和发送修改 `default_role` 选项的请求。
*   PoC 中没有任何可疑的后门或恶意代码。
*   README.md 文件内容与 PoC 代码的功能一致，描述了漏洞的原理、利用方法和修复建议。
*  风险主要集中在依赖项和执行环境的安全上,以及软件源站点的安全,此POC代码投毒风险较低。
*  综合分析，该仓库的投毒风险极低。

**利用方式：**

1.  攻击者需要拥有一个低权限（例如，订阅者）的 WordPress 用户帐户。
2.  攻击者使用该帐户登录 WordPress 站点。
3.  攻击者利用 PoC 代码，通过 `admin-ajax.php` 接口，将 `default_role` 选项修改为 `administrator`。
4.  之后，任何新注册的用户都将自动成为管理员。

**搜索引擎分析：**

*   搜索结果中 `webpage 8` 和 `webpage 9` 提到了 `CVE-2025-30772`，并且描述与漏洞库中的信息一致，进一步验证了漏洞的存在。
*   其他的搜索结果与此漏洞无关。

**项目地址:** [Nxploited/CVE-2025-30772](https://github.com/Nxploited/CVE-2025-30772)

**漏洞详情:** [CVE-2025-30772](https://nvd.nist.gov/vuln/detail/CVE-2025-30772)