## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者创建Confluence管理员帐户并访问Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于 Broken Access Control 类型。根据漏洞信息，未经身份验证的远程攻击者可以通过利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制 Confluence 实例。

**漏洞利用方式：**

1.  **检查安装状态：**  攻击者首先发送一个GET请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 以确定Confluence是否尚未完成设置。
2.  **创建管理员帐户：** 如果步骤 1 返回 `setupComplete=false`，表明Confluence尚未设置管理员帐户。然后，攻击者发送一个POST请求到 `/setup/setupadministrator.action`，其中包含用于创建管理员帐户的用户名、全名、电子邮件地址、密码和确认密码等信息。攻击者可以指定他们想要的任何凭据。
3.  **完成设置（可选）：** 攻击者可以选择发送一个POST请求到`/setup/finishsetup.action`来完成设置向导。

**有效性：**

提供的 POC 代码描述了利用此漏洞的步骤，并且根据搜索结果显示，该漏洞已被积极利用，因此POC代码是有效的。

**投毒风险：**

提供的POC代码非常简单，仅包含利用漏洞的步骤。该仓库只包含了README.md和payload文件，内容是漏洞利用的步骤，并无其他可疑代码。虽然不能完全排除投毒风险，但存在的可能性很低。判断投毒风险为 5%.

**总结：**

此漏洞利用简单，风险极高。攻击者可以无需任何身份验证，直接创建一个管理员账户，从而完全控制 Confluence 服务器。强烈建议受影响的用户尽快升级到不受影响的版本。

**项目地址:** [Vulnmachines/confluence-cve-2023-22515](https://github.com/Vulnmachines/confluence-cve-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)