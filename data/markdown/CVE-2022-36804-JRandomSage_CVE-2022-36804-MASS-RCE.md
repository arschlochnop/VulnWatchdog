## CVE-2022-36804-Bitbucket-命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server 和 Data Center

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 直到 7.6.17, 7.7.0 直到 7.17.10, 7.18.0 直到 7.21.4, 8.0.0 直到 8.0.3, 8.1.0 直到 8.1.3, 8.2.0 直到 8.2.2, 8.3.0 直到 8.3.1

**利用条件:** 需要对公共仓库的访问权限或对私有Bitbucket仓库的读取权限

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2022-36804 是 Atlassian Bitbucket Server 和 Data Center 中的一个命令注入漏洞。根据漏洞库信息，具有公共仓库访问权限或私有Bitbucket仓库读取权限的远程攻击者可以通过发送恶意HTTP请求来执行任意代码。搜索引擎结果表明该漏洞利用相对容易，并且存在公开可用的PoC。

提供的漏洞利用代码包含两个文件：`CVE-2022-36804-mass.py` 和 `README.md`。

*   `CVE-2022-36804-mass.py` 的主要功能是打印一个包含付款链接的字符串，这表明它不是一个实际的漏洞利用程序，而可能是一个诱饵或诈骗。
*   `README.md` 文件描述了漏洞，声称提供了一个Python编写的多功能PoC，但实际的PoC需要通过提供的付款链接获取，并且提及存在包含大量易受攻击服务器的列表。这意味着作者意图通过出售或以其他方式分发所谓的PoC获利，进一步提高了投毒风险。

综合来看，该仓库中的PoC很可能是无效的，或者说是经过精心设计的诱饵。要求付款的行为是一个危险信号，表明作者可能试图传播恶意软件或窃取用户凭据。

**利用方式：** 根据rapid7.com(webpage 1)和assetnote.io(webpage 3)上的描述，该漏洞是由于多个API端点存在命令注入漏洞，攻击者可以利用 `--exec` 参数执行任意命令。攻击者需要对仓库具有读取权限，可以通过构造恶意的HTTP请求来触发该漏洞。

**有效性：** 从提供的文件来看，提供的PoC代码可能无效或者包含恶意内容, 需要进一步验证才能确认其真实功能。根据其他搜索结果，漏洞本身是有效的，并且存在其他的可利用方式。

**投毒风险：** 极高。`CVE-2022-36804-mass.py`只是一个诱饵，引导用户访问付款链接。真正的攻击代码可能隐藏在付款后的下载链接中，并可能包含恶意软件。`README.md` 的声明与实际代码不符，也增加了投毒的可能性。因此，该仓库存在极高的投毒风险(95%)。

**项目地址:** [JRandomSage/CVE-2022-36804-MASS-RCE](https://github.com/JRandomSage/CVE-2022-36804-MASS-RCE)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)