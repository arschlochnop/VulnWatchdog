## CVE-2024-10578-Pubnews-任意插件安装

**漏洞编号:** CVE-2024-10578

**漏洞类型:** 任意插件安装

**影响应用:** Pubnews WordPress Theme

**危害等级:** 高危，可被利用执行任意代码

**影响版本:** <= 1.0.7

**利用条件:** 需要WordPress Subscriber级别或以上权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10578存在于Pubnews主题中，允许已认证的攻击者（Subscriber级别及以上）安装任意插件。由于`pubnews_importer_plugin_action_for_notice()`函数缺少权限检查，攻击者可以通过构造特定的请求，绕过权限验证，安装恶意插件，从而执行任意代码。利用方式如下：

1.  攻击者首先需要拥有一个WordPress账户，权限等级为Subscriber或更高。
2.  攻击者使用提供的Python脚本，输入目标WordPress站点的URL、账户用户名、密码，以及恶意插件的URL。
3.  脚本首先尝试登录WordPress站点。
4.  登录成功后，脚本从`wp-admin/admin.php?page=pubnews-info`页面提取`_wpnonce`值，这是一个用于CSRF保护的令牌。
5.  脚本构造一个POST请求，发送到`wp-admin/admin-ajax.php`，其中包含`action`参数设置为`pubnews_importer_plugin_action`，`_wpnonce`参数设置为提取到的值，以及恶意插件的URL等信息。
6.  服务器端由于缺少权限检查，会直接安装并激活提供的插件。
7.  恶意插件被安装后，攻击者可以利用插件中的恶意代码，例如webshell，来控制整个WordPress站点。

**有效性：**

根据漏洞信息和提供的利用代码，该漏洞利用方法有效。利用代码实现了登录WordPress、提取nonce、发送恶意请求安装插件的完整流程。

**投毒风险：**

该POC代码的主要功能是安装指定的插件。潜在的投毒风险可能存在于以下方面：

*   **恶意插件来源：** 用户必须自行准备包含恶意代码的插件ZIP包。如果用户下载了来源不明的插件，并将其用于POC，可能导致中毒。
*   **脚本本身的隐蔽恶意代码：** 尽管表面上脚本功能清晰，但仍有可能在脚本中隐藏一些不明显的恶意代码，例如信息收集或反向shell等，但是代码量较少且逻辑清晰，风险较低。
*   **依赖风险:**requests库本身的安全问题，可能导致渗透测试环境被污染。

综合考虑，该脚本的投毒风险较低，主要风险在于用户提供的插件。

**利用方式：**

该漏洞的利用方式是，通过Subscriber权限绕过权限校验，安装恶意插件，从而获取服务器的控制权限。攻击者需要准备一个包含恶意代码（例如webshell）的WordPress插件，然后利用该漏洞安装插件，从而在服务器上执行恶意代码。

**项目地址:** [Nxploited/CVE-2024-10578](https://github.com/Nxploited/CVE-2024-10578)

**漏洞详情:** [CVE-2024-10578](https://nvd.nist.gov/vuln/detail/CVE-2024-10578)