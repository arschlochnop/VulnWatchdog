## CVE-2024-52794-Discourse-Stored-XSS

**漏洞编号:** CVE-2024-52794

**漏洞类型:** Stored XSS

**影响应用:** Discourse

**危害等级:** 中危，可能导致账户劫持和恶意脚本执行

**影响版本:** stable: <= 3.3.2, beta: <= 3.4.0.beta3, tests-passed: <= 3.4.0.beta3

**利用条件:** 需要用户交互（点击lightbox thumbnail）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-52794是Discourse的一个存储型XSS漏洞，攻击者可以通过上传包含恶意JavaScript代码的图片，并诱导用户点击lightbox缩略图来触发漏洞。根据漏洞库信息，该漏洞影响Discourse的多个版本，并且已在最新版本中修复。搜索结果表明该漏洞影响系统的机密性、完整性和可用性，但影响程度较低。提供的POC代码（README.md文件）仅说明了漏洞的存在和利用方式，即通过图片文件名进行XSS攻击。该POC本身不包含直接的恶意代码，但攻击者可以利用它构造恶意的图片文件名，例如 `<img src=x onerror=alert(1)>.jpg` ，当用户点击该图片的缩略图时，onerror事件会被触发，执行alert(1)代码。投毒风险较低，因为POC本身不包含复杂的恶意payload或者后门，风险主要在于使用者是否会将该POC用于非法用途。考虑到README.md 文件仅仅提供一个信息说明，没有可执行代码，因此，投毒的可能性较低。 但考虑到恶意文件名XSS的普遍性，仍存在一定的投毒风险。利用方式：上传恶意图片，并诱导其他用户点击lightbox查看该图片。

**项目地址:** [Beesco00/CVE-2024-52794-Discourse-Stored-XSS](https://github.com/Beesco00/CVE-2024-52794-Discourse-Stored-XSS)

**漏洞详情:** [CVE-2024-52794](https://nvd.nist.gov/vuln/detail/CVE-2024-52794)