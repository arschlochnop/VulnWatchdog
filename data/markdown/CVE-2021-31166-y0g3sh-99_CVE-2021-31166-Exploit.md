## CVE-2021-31166-HTTP Protocol Stack Remote Code Execution Vulnerability

**漏洞编号:** CVE-2021-31166

**漏洞类型:** 远程代码执行

**影响应用:** Windows HTTP Protocol Stack

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 2004, Windows Server version 2004, Windows 10 Version 20H2, Windows Server version 20H2 (版本低于 10.0.19041.982 或 10.0.19042.982)

**利用条件:** 目标系统开启HTTP服务且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31166是一个Windows HTTP协议栈的远程代码执行漏洞。攻击者可以通过发送特制的HTTP请求到目标服务器，利用协议栈中的漏洞来执行任意代码。根据漏洞库信息，此漏洞的CVSS评分为9.8，属于严重级别。CISA已将其添加到已知被利用漏洞目录中，表明该漏洞在野外已被积极利用。提供的Python POC脚本通过发送包含特定'Accept-Encoding'头的HTTP请求来尝试触发漏洞。该脚本的有效性较低，因为它仅通过发送带有特定header的请求来检测服务端是否会崩溃，崩溃被认为是利用成功，但无法直接验证代码执行。存在一定的投毒风险，因为脚本相对简单，容易被修改和重新分发，攻击者可能在其中加入恶意代码，例如反弹shell等，但目前代码未发现异常行为。

**项目地址:** [y0g3sh-99/CVE-2021-31166-Exploit](https://github.com/y0g3sh-99/CVE-2021-31166-Exploit)

**漏洞详情:** [CVE-2021-31166](https://nvd.nist.gov/vuln/detail/CVE-2021-31166)