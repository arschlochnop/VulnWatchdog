## CVE-2025-6218 - WinRAR 目录穿越远程代码执行漏洞

**漏洞编号:** CVE-2025-6218

**漏洞类型:** 目录穿越导致远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.11 (64-bit)

**利用条件:** 用户需要访问恶意页面或打开恶意文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6218是 WinRAR 中的一个目录穿越漏洞，允许远程攻击者在受影响的 WinRAR 安装上执行任意代码。利用此漏洞需要用户交互，目标用户必须访问恶意页面或打开恶意文件。漏洞存在于处理存档文件中的文件路径时。精心构造的文件路径可能导致进程遍历到意外目录。攻击者可以利用此漏洞在当前用户的上下文中执行代码。

**有效性：**

提供的POC代码有效，能够创建一个包含恶意路径的RAR文件，当用户解压该文件时，文件会被提取到预期目录之外，造成目录穿越。

**投毒风险：**

仓库中存在作者隐藏的投毒代码的可能性较低。`base.py`中包含类型定义，`cve-2025-6218.py`根据描述生成poc文件。虽然存在潜在风险，但根据现有信息来看，实际投毒的可能性较低。漏洞利用代码的核心逻辑是利用WinRAR路径处理的缺陷，生成特定的RAR文件，从而实现目录穿越。文件本身不包含恶意代码，而是利用WinRAR的自身行为实现攻击。因此，投毒风险较低，但不能完全排除。

**利用方式：**

1.  攻击者创建一个恶意的RAR文件，该文件包含一个或多个带有特殊构造路径的文件条目，利用WinRAR在处理路径时的漏洞（版本7.11及之前），例如，使用包含`..\`序列的路径来尝试跳出提取目录。
2.  攻击者诱骗用户打开这个恶意的RAR文件，例如，通过电子邮件、恶意网站或其他方式。
3.  当WinRAR解压这个RAR文件时，由于路径处理的缺陷，文件会被提取到用户指定目录之外的目录，比如系统目录。
4.  如果攻击者能够将恶意文件（例如，可执行文件或脚本）写入到系统目录，则可以通过多种方式执行该恶意文件，从而实现远程代码执行。
5.  POC代码中说明，虽然目录穿越是实现了，但是任意文件写到RCE的链条在windows系统上是比较简单的。
6.  漏洞的关键在于利用WinRAR对文件路径的验证不严谨，允许`..\`序列跳出预定目录。 7.12版本后，对相关代码进行了修复。

**项目地址:** [ignis-sec/CVE-2025-6218](https://github.com/ignis-sec/CVE-2025-6218)

**漏洞详情:** [CVE-2025-6218](https://nvd.nist.gov/vuln/detail/CVE-2025-6218)