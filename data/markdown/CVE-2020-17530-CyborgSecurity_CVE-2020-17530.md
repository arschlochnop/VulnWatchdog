## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts，并且存在可利用的tag属性接收用户输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17530 是 Apache Struts 框架中的一个远程代码执行漏洞，由于对用户输入到tag属性中的OGNL表达式进行了强制二次解析。攻击者可以通过构造恶意的OGNL表达式，利用Struts2的tag属性漏洞，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞是真实存在的，且POC代码已经被公开，经验证有效。

**投毒风险：**

分析提供的POC代码，主要包含以下文件：
* `CVE-2020-17530.py`:  这是POC的主体，负责构造Payload并发送请求。
* `README.md`:  提供漏洞描述和POC的使用方法。
* `requirements.txt`:  列出POC运行所需的Python依赖。

代码中没有发现任何可疑的恶意行为或后门代码。该POC只是利用漏洞执行指定的命令。因此，投毒风险评估为0%。

**利用方式：**

利用方式总结如下：

1.  **确定目标：** 确认目标服务器运行的Apache Struts版本在受影响范围内 (2.0.0 - 2.5.25)。
2.  **构造Payload：** 使用提供的Python脚本 (`CVE-2020-17530.py`) 生成包含恶意OGNL表达式的Payload。该脚本允许指定要执行的命令，以及包含漏洞的表单字段名称。
3.  **发送请求：** 将Payload作为POST请求的数据发送到目标服务器的URI。POC通过files参数传递payload，模拟上传文件。
4.  **执行命令：** 如果服务器存在漏洞，并且Payload构造正确，服务器将执行Payload中包含的命令。
5.  **获取结果：** POC脚本会解析服务器的响应，提取命令执行的结果并打印到控制台。

**项目地址:** [CyborgSecurity/CVE-2020-17530](https://github.com/CyborgSecurity/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)