## CVE-2025-11371-Gladinet CentreStack and TrioFox-LFI

**漏洞编号:** CVE-2025-11371

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Gladinet CentreStack and TrioFox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 16.7.10368.56560

**利用条件:** 默认安装和配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-11371 描述的是 Gladinet CentreStack 和 TrioFox 中存在的未经身份验证的本地文件包含 (LFI) 漏洞。该漏洞允许未经授权的攻击者读取服务器上的敏感文件。利用方式如下：

1.  **信息收集:** 攻击者通过LFI读取`web.config`文件，提取其中的`decryptionKey`和`validationKey`。 
2.  **Payload生成:** 攻击者使用`ysoserial.net`工具，基于提取的`decryptionKey`和`validationKey`生成`ViewState` payload，该payload包含要执行的恶意命令。
3.  **漏洞利用:** 攻击者将生成的`ViewState` payload 注入到 `loginpage.aspx` 页面的 `__VIEWSTATE` 参数中，从而执行任意命令。

**有效性评估：**
根据漏洞描述和利用代码，此POC代码是有效的。该POC利用了未经身份验证的LFI来获取加密密钥，然后利用这些密钥来伪造ViewState并执行任意命令，从而实现远程代码执行。

**投毒风险评估：**
该代码库的投毒风险较低（0%）。 `README.md` 文件明确声明该项目仅用于教育和研究目的，并警告用户不要在未经授权的情况下使用该代码。 `cve-2025-11371.py` 脚本执行的操作与漏洞描述和利用方法相符，未发现任何恶意代码或后门。 该脚本使用 `wine` 运行 `ysoserial.net`，表明环境依赖。虽然使用未知的第三方工具总是存在风险，但 `ysoserial.net` 是一个广泛使用的工具，用于生成 .NET 反序列化 payload。

**利用方式总结：**
该漏洞利用方式是首先通过LFI泄露`web.config`中的密钥，然后使用泄露的密钥生成恶意的`ViewState` payload，最后将该payload发送到`loginpage.aspx`页面，从而实现远程代码执行。这个过程不需要任何身份验证。


**项目地址:** [lap1nou/CVE-2025-11371](https://github.com/lap1nou/CVE-2025-11371)

**漏洞详情:** [CVE-2025-11371](https://nvd.nist.gov/vuln/detail/CVE-2025-11371)