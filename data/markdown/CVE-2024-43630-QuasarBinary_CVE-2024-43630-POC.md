## CVE-2024-43630 Windows Kernel 权限提升漏洞

**漏洞编号:** CVE-2024-43630

**漏洞类型:** 权限提升

**影响应用:** Windows Kernel

**危害等级:** 高危，可能导致系统权限提升

**影响版本:** 受影响版本请参考漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-43630是一个Windows Kernel的权限提升漏洞，攻击者可以利用此漏洞获得更高的系统权限。根据漏洞库信息，该漏洞是栈溢出漏洞（CWE-121: Stack-based Buffer Overflow）。

**有效性评估：**
提供的POC代码（CVE-2024-43630-POC.cpp）尝试利用 `NtCopyFileChunk` 函数中的栈溢出漏洞。代码首先获取当前进程的NT路径，然后尝试在当前目录下创建一个目标文件（dest.txt），后续操作可能触发漏洞。

根据搜索结果，多家安全厂商（如Wiz.io, Qualys, Rapid7等）都提到了该漏洞，并且微软已经在2024年11月的补丁星期二修复了此漏洞。CVEdetails网站表明攻击向量是本地的，攻击复杂度低，需要低权限。Qualys的博客指出，成功利用该漏洞可能导致攻击者获得SYSTEM权限。综合这些信息，可以认为该POC代码在未打补丁的受影响系统上是有效的。

**投毒风险评估：**
分析提供的POC代码，发现其主要目的是演示漏洞利用，并未发现明显的恶意代码或后门。代码逻辑较为清晰，主要集中在文件操作和NT API调用上。虽然代码本身没有明显的投毒特征，但任何漏洞利用代码都可能被恶意修改以包含恶意功能。因此，存在一定的投毒风险。这里评估的10%是基于代码本身的分析结果，实际风险还取决于代码的来源和使用环境。

**利用方式分析：**
根据漏洞库信息和POC代码，漏洞利用方式如下：
1.  利用栈溢出漏洞，覆盖函数返回地址或栈上的其他关键数据。
2.  控制程序执行流程，跳转到攻击者指定的代码。
3.  攻击者指定的代码可以执行任意操作，例如创建具有SYSTEM权限的进程，或者修改系统配置。
4.  通过以上步骤，攻击者可以提升自己的权限。

简而言之，利用方式是通过精心构造的数据，覆盖栈上的重要信息，劫持程序执行流程，最终获得SYSTEM权限。

**项目地址:** [QuasarBinary/CVE-2024-43630-POC](https://github.com/QuasarBinary/CVE-2024-43630-POC)

**漏洞详情:** [CVE-2024-43630](https://nvd.nist.gov/vuln/detail/CVE-2024-43630)