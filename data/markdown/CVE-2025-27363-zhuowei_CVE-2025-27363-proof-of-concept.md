## CVE-2025-27363-FreeType-堆缓冲区溢出

**漏洞编号:** CVE-2025-27363

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FreeType

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 2.13.0

**利用条件:** 需要处理特制的恶意字体文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-27363是FreeType 2.13.0及更低版本中存在的堆缓冲区溢出漏洞。当FreeType尝试解析TrueType GX和可变字体文件中与字体subglyph结构相关的错误时，可能触发此漏洞。根据漏洞描述，存在一个有符号short类型的值被赋值给无符号long类型，然后加上一个静态值，导致环绕，从而分配了一个过小的堆缓冲区。随后，代码将最多6个有符号long类型整数写入到相对于此缓冲区的边界之外，从而可能导致任意代码执行。提供的POC代码修改了Roboto Flex字体，使'%'字符（glyph 8）成为一个包含0xfffd个subglyph的组合glyph。在FreeType 2.13.0中渲染修改后的字体会导致崩溃，ASAN检测到load_truetype_glyph函数中的堆缓冲区溢出。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断POC代码有效。代码中提供了触发崩溃的详细步骤和ASAN的错误报告，表明成功利用该漏洞导致了堆缓冲区溢出。

**投毒风险：**
该POC代码主要通过修改字体文件来触发漏洞，目的是为了证明漏洞的存在。代码本身看起来是直接利用漏洞，没有明显的投毒代码。虽然无法完全排除投毒的可能性，但是从代码功能角度来看，投毒的可能性较低,判断投毒风险为1%。

**利用方式：**
1.  准备特制的恶意字体文件：该字体文件包含畸形的glyph数据，尤其是大量的subglyph。
2.  使用受影响的FreeType版本（<=2.13.0）加载并渲染该字体文件。
3.  当FreeType解析该字体文件时，由于整数溢出和缓冲区大小计算错误，会在堆上分配一个过小的缓冲区。
4.  后续的写入操作会超出该缓冲区边界，导致堆缓冲区溢出。
5.  通过精心构造溢出的数据，可以覆盖堆上的其他数据，甚至实现任意代码执行。

总之，该漏洞的利用方式主要是通过构造恶意的字体文件，诱使FreeType在解析过程中发生堆缓冲区溢出，从而达到攻击目的。

**项目地址:** [zhuowei/CVE-2025-27363-proof-of-concept](https://github.com/zhuowei/CVE-2025-27363-proof-of-concept)

**漏洞详情:** [CVE-2025-27363](https://nvd.nist.gov/vuln/detail/CVE-2025-27363)