## CVE-2024-52375 - WordPress Datasets Manager Plugin - 任意文件上传

**漏洞编号:** CVE-2024-52375

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Datasets Manager by Arttia Creative

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.5

**利用条件:** 需要能够访问WordPress站点，且插件版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-52375 存在于 WordPress Datasets Manager 插件 1.5 及更早版本中。该漏洞是由于插件没有正确验证上传的文件类型，允许未授权的攻击者上传任意文件，包括 PHP webshell，从而导致远程代码执行。

**有效性：**

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性非常高。漏洞库信息明确指出该漏洞允许上传具有危险类型的文件，搜索引擎结果也证实了这一点。提供的 POC 代码描述了如何利用此漏洞，包括提取 nonce 值、上传 webshell 以及测试 webshell 是否可用。因此，提供的 POC 代码很可能是有效的。

**投毒风险：**

在提供的 POC 代码中，投毒风险较低。代码的主要功能是上传 webshell，这本身就是漏洞利用的一部分，而不是额外添加恶意功能。以下是风险评估：

*   **低风险操作：** 代码专注于实现文件上传漏洞。webshell 的功能取决于攻击者的意图，该代码本身不包含额外的后门或者恶意逻辑。
*   **可审查性：** Python 脚本较为简单，逻辑清晰，易于审查，不太可能隐藏恶意代码。
*   **免责声明：** 脚本包含免责声明，表明其仅用于教育和授权测试目的。尽管这不能完全排除投毒风险，但表明作者可能不希望添加恶意代码。

因此，综合来看，该漏洞利用代码的投毒风险估计为1%。尽管无法完全排除风险，但证据表明该代码的主要目的是利用已知漏洞，而不是传播恶意软件。

**利用方式：**

漏洞的利用方式如下：

1.  **目标确定：** 确定安装了受影响版本（<= 1.5）的 WordPress Datasets Manager 插件的网站。
2.  **Nonce 获取（如果需要）：** 某些情况下，可能需要从前端页面获取 `_wpnonce` 值。
3.  **Payload 构造：** 创建一个包含恶意 PHP 代码的 webshell 文件 (例如 `nxploit.php`)。
4.  **文件上传：** 使用 POST 请求将 webshell 文件上传到目标网站。利用漏洞绕过文件类型验证。
5.  **Webshell 访问：** 访问上传的 webshell 文件 (例如 `http://target.com/wordpress/wp-content/uploads/2025/03/nxploit.php`)。
6.  **命令执行：** 通过 webshell 执行任意命令 (例如 `http://target.com/wordpress/wp-content/uploads/2025/03/nxploit.php?cmd=id`)，从而控制目标服务器。

**项目地址:** [Nxploited/CVE-2024-52375](https://github.com/Nxploited/CVE-2024-52375)

**漏洞详情:** [CVE-2024-52375](https://nvd.nist.gov/vuln/detail/CVE-2024-52375)