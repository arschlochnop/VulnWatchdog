## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 严重，允许本地用户获取root权限

**影响版本:** 1.9.14 - 1.9.17

**利用条件:** 目标系统运行受影响的Sudo版本，当前用户具有sudo权限，sudoers配置允许chroot操作，存在gcc编译器和可写临时目录。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个Sudo的本地权限提升漏洞，存在于1.9.14到1.9.17版本。该漏洞允许本地用户通过利用chroot选项中的设计缺陷来获取root权限。攻击者创建一个受控的chroot环境，其中包含恶意的`nsswitch.conf`文件，并注入一个恶意的NSS库。当Sudo加载这个恶意的库时，它会以root权限执行其中的代码，从而导致权限提升。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意`nsswitch.conf`文件的chroot环境。
2.  攻击者将恶意的NSS库放置在该chroot环境中。
3.  攻击者运行Sudo命令，并指定该chroot环境。
4.  Sudo加载恶意的NSS库，并以root权限执行。
5.  攻击者获得root shell访问权限。

**投毒风险分析：**

代码中存在一定的投毒风险。具体来说，虽然主要目的是利用漏洞提升权限，但攻击者可能会在`kai_ht.c`文件中加入额外的恶意代码，例如植入后门、窃取敏感信息等。尽管该POC的主要功能是创建suid的bash，已经赋予了用户root权限，但是在`kai_ht.c`文件中仍然可以插入其他恶意行为。例如，可以添加代码来收集系统信息并通过网络发送给攻击者。所以，如果直接使用该POC，而不进行详细的代码审计，存在一定的风险。

**风险评估：**

尽管POC的主要目的是权限提升，但`kai_ht.c`文件中存在植入恶意代码的可能性。建议在使用前仔细审查代码，确保没有隐藏的恶意行为。


**项目地址:** [KaiHT-Ladiant/CVE-2025-32463](https://github.com/KaiHT-Ladiant/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)