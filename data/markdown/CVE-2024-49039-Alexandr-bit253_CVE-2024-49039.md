## CVE-2024-49039 Windows Task Scheduler Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-49039

**漏洞类型:** 权限提升

**影响应用:** Windows Task Scheduler

**危害等级:** 高危，可导致本地权限提升

**影响版本:** 见CVE描述中的受影响版本范围

**利用条件:** 本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，对CVE-2024-49039 Windows Task Scheduler权限提升漏洞进行评估如下：

**有效性：**

根据搜索结果，CVE-2024-49039是一个已经被积极利用的漏洞。POC代码的存在进一步表明了该漏洞的可利用性。
根据`Readme.md`的内容, 漏洞利用能够绕过受限token沙箱和子进程限制，并提升到中等完整性级别。`WPTaskScheduler.dll`组件是利用的关键。

**投毒风险：**

代码中存在一定投毒风险，评估为10%。
*   `Readme.md`提到了该工具可能是一个后门工具。
*   `Readme.md`建议了多种测试方法，包括使用donut shellcode在不受信任的沙箱进程中执行，这可能被恶意利用。
*   虽然作者似乎提供了漏洞利用和测试工具，但这些工具也可能被用于恶意目的。

**利用方式：**

利用方式主要涉及以下几个步骤：
1.  **RPC连接：** 建立到Task Scheduler的RPC连接，利用`WPTaskScheduler.dll`组件。
2.  **绕过限制：** 绕过受限Token沙箱、子进程限制和AppContainer。
3.  **权限提升：** 通过利用Task Scheduler中的漏洞，将权限提升到Medium Integrity或更高。
4.  **代码执行：** 在提升的权限下执行恶意代码，实现权限提升。

**总结：**

CVE-2024-49039是一个高危漏洞，攻击者可以利用该漏洞提升权限。提供的POC代码可能存在一定的投毒风险，使用时需要谨慎。该漏洞的利用方式涉及RPC连接、绕过安全限制和执行恶意代码。

**项目地址:** [Alexandr-bit253/CVE-2024-49039](https://github.com/Alexandr-bit253/CVE-2024-49039)

**漏洞详情:** [CVE-2024-49039](https://nvd.nist.gov/vuln/detail/CVE-2024-49039)