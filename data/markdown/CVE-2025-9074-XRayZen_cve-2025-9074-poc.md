## CVE-2025-9074 - Docker Desktop API未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** API未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危，可能导致主机文件系统读写、敏感信息泄露、系统配置篡改、恶意软件植入、横向渗透和权限提升

**影响版本:** < 4.44.3

**利用条件:** 运行受影响版本的Docker Desktop，且容器能够访问Docker Engine API (默认192.168.65.7:2375)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-9074 漏洞存在于 Docker Desktop 中，允许本地运行的 Linux 容器通过配置的 Docker 子网（默认为 192.168.65.7:2375）访问 Docker Engine API。此漏洞的利用不需要启用增强容器隔离 (ECI)，也不需要启用 "Expose daemon on tcp://localhost:2375 without TLS" 选项。

**有效性分析：**
提供的 PoC 代码旨在演示 CVE-2025-9074 漏洞的利用。它通过以下步骤进行：

1.  **连接到 Docker API：** 尝试连接到 Docker Engine API 默认地址 (192.168.65.7:2375) 的 `/version` 端点，验证连通性。
2.  **查找或拉取镜像：** 检查可用的 Docker 镜像，如果找不到，则尝试拉取 `alpine:latest` 镜像。
3.  **利用漏洞：** 创建一个特权容器，并将宿主机的某个目录挂载到容器内部。然后在容器内部向宿主机目录写入文件，从而证明可以控制宿主机的文件系统。

搜索引擎结果也表明该漏洞是真实存在的，并且已经被广泛报道。

综上所述，该 PoC 代码是有效的，可以用来演示 CVE-2025-9074 漏洞。

**投毒风险分析：**
仔细检查 PoC 代码，虽然整体目标是演示漏洞，但仍然存在一些潜在的投毒风险。

*   **依赖下载风险：** PoC 代码依赖于 `net/http` 和 `encoding/json` 等标准库，本身没有发现直接引入恶意依赖的代码。但是编译环境仍然存在被污染的可能性。
*   **文件写入风险：**  PoC 代码会在宿主机文件系统上创建文件，用于验证漏洞。恶意修改这部分代码，可能会导致 PoC 在目标系统上创建恶意文件，或者覆盖重要文件。
*   **镜像拉取风险：** PoC 代码会自动拉取 `alpine:latest` 镜像，如果该镜像被篡改，可能会导致安全问题。不过，这种风险与漏洞本身无关，而是 Docker 镜像供应链固有的风险。
* **默认配置写死:** 如果将192.168.65.7:2375写死,在一些特殊环境可能会失效导致无法正常运行,影响漏洞使用者判断

综合来看，该 PoC 代码的投毒风险较低，大约为 5%。 主要风险在于编译环境以及镜像的安全性问题，以及代码本身是否做了细微的恶意修改。

**利用方式：**
1.  **漏洞发现：** 攻击者首先需要发现目标系统上运行着存在 CVE-2025-9074 漏洞的 Docker Desktop 版本。
2.  **容器访问：** 攻击者需要在与 Docker Desktop 运行在同一网络上的容器中执行恶意代码。 这可以通过多种方式实现，例如：
    *   利用已有的容器漏洞。
    *   诱骗用户运行恶意容器。
3.  **API 利用：** 在容器中，攻击者可以利用 PoC 代码或者其他类似工具，通过 Docker Engine API 创建特权容器，并挂载宿主机的文件系统。
4.  **权限提升：** 一旦能够读写宿主机的文件系统，攻击者就可以进行各种恶意活动，例如窃取敏感信息、篡改系统配置、植入恶意软件等。

该漏洞利用的根本原因是 Docker Engine API 暴露在容器网络中，并且没有进行适当的身份验证。

**项目地址:** [XRayZen/cve-2025-9074-poc](https://github.com/XRayZen/cve-2025-9074-poc)

**漏洞详情:** [CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)