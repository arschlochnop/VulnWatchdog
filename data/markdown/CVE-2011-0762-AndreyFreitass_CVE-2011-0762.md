## CVE-2011-0762-vsftpd-DoS

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，可能导致服务器崩溃

**影响版本:** < 2.3.3

**利用条件:** 需要已认证的FTP用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2011-0762是vsftpd 2.3.3之前版本中ls.c文件的vsf_filename_passes_filter函数中存在的一个漏洞。远程认证用户可以通过多个FTP会话中的STAT命令里构造的glob表达式，造成拒绝服务（CPU消耗和进程槽耗尽）。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的PoC代码。该PoC利用了STAT命令和恶意的glob表达式来触发DoS。搜索结果中的链接指向了多个漏洞数据库和安全公告，都证实了该漏洞的存在。

**投毒风险：**

提供的PoC代码（cve-2011-0762.c）主要功能是连接FTP服务器，使用提供的用户名和密码（或匿名凭据）进行身份验证，然后发送包含大量嵌套花括号的STAT命令。该代码没有明显的恶意功能，例如文件上传、命令执行或任何尝试在服务器上植入后门的尝试。所有操作都集中于触发DoS漏洞。因此，投毒风险较低。
根据我对POC代码的分析，我没有发现任何投毒代码，因此我认为投毒风险为0%。

**利用方式：**

1.  **身份验证：** 使用有效的FTP用户名和密码登录目标vsftpd服务器。如果允许匿名登录，则使用匿名凭据。
2.  **发送恶意STAT命令：** 登录后，发送一个STAT命令，其中包含精心构造的glob表达式。该表达式包含大量嵌套的花括号，例如`STAT {{*},{{*},...}}`。这个嵌套的结构会导致vsftpd服务器在处理文件过滤时消耗大量CPU资源，最终导致拒绝服务。
3.  **重复利用：** 为了更有效地利用该漏洞，攻击者可以同时建立多个FTP连接，并从每个连接发送恶意STAT命令。这将加速资源耗尽并更快地导致DoS。
4.  **停止服务:** 服务器CPU资源耗尽或者进程槽耗尽导致服务器停止服务,达到拒绝服务攻击的目的。

**项目地址:** [AndreyFreitass/CVE-2011-0762](https://github.com/AndreyFreitass/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)