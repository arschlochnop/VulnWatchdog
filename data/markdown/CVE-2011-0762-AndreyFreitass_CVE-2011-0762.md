## CVE-2011-0762-vsftpd-拒绝服务

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致CPU资源耗尽和进程槽耗尽

**影响版本:** < 2.3.3

**利用条件:** 需要FTP服务开启，匿名或有效用户登录。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2011-0762 是 vsftpd 2.3.3之前版本中的一个漏洞，位于 ls.c 文件的 vsf_filename_passes_filter 函数中。远程经过身份验证的用户可以通过多个FTP会话中的STAT命令中精心设计的glob表达式，导致拒绝服务（CPU消耗和进程槽耗尽）。

**有效性分析:**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的POC代码（Exploit-DB ID: 16270, 以及http://cxib.net/stuff/vspoc232.c）。POC代码通过发送包含大量嵌套花括号的STAT命令来触发漏洞，导致服务器CPU资源耗尽。漏洞利用的有效性较高，因为多个来源证实了漏洞的存在和可利用性。

**投毒风险分析:**

提供的POC代码（cve-2011-0762.c）主要功能是连接到FTP服务器，使用给定的用户名和密码进行身份验证（如果未提供，则使用默认的匿名用户），然后发送一个格式化的STAT命令，其中包含大量的嵌套花括号。该嵌套结构旨在触发 vsf_filename_passes_filter 函数中的漏洞，导致CPU消耗。

代码中没有明显的后门或恶意行为。它执行的操作与其描述的功能一致，即发送一个特殊的STAT命令以触发漏洞。

*   **代码行为分析：** 代码主要实现了Socket连接、FTP登录以及发送恶意STAT命令。
*   **可疑代码识别：** 没有发现任何可疑的函数调用或隐藏的逻辑。
*   **数据流分析：**  数据流主要集中在构建和发送STAT命令上，没有涉及敏感信息泄露或执行任意代码的操作。
*   **作者信誉评估：** 通过搜索代码中的用户相关信息，没有发现该作者有恶意行为记录。

因此，基于对POC代码的分析，该代码中存在投毒代码的风险较低，判断为0%。

**利用方式总结:**

1.  攻击者使用FTP客户端连接到目标vsftpd服务器。
2.  攻击者提供有效的用户名和密码进行身份验证（或使用匿名登录）。
3.  攻击者发送一个包含大量嵌套花括号的STAT命令，例如 `STAT {{*},{{*},...}}`。
4.  vsftpd服务器在处理该命令时，由于vsf_filename_passes_filter函数中的缺陷，会消耗大量的CPU资源，最终导致拒绝服务。通过并发多次利用，可以更有效地消耗服务器资源。

此漏洞的利用依赖于服务器处理glob表达式时存在效率问题，攻击者通过发送精心构造的输入来触发该问题，导致拒绝服务。

**项目地址:** [AndreyFreitass/CVE-2011-0762](https://github.com/AndreyFreitass/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)