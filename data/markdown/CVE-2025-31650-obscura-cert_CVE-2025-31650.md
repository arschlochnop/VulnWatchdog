## CVE-2025-31650-Apache Tomcat-DoS

**漏洞编号:** CVE-2025-31650

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务中断

**影响版本:** 9.0.76 <= version <= 9.0.102, 10.1.10 <= version <= 10.1.39, 11.0.0-M2 <= version <= 11.0.5

**利用条件:** 需要网络访问，目标Tomcat服务器开启HTTP/2支持

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31650 是 Apache Tomcat 中的一个拒绝服务漏洞。由于对 HTTP 优先级标头的不正确输入验证，导致内存泄漏。大量此类请求可能触发 OutOfMemoryException，从而导致拒绝服务。

**漏洞利用方式：**

1.  **利用HTTP/2协议：** 该漏洞依赖于 Tomcat 的 HTTP/2 实现。
2.  **发送畸形的Priority标头：**  发送包含各种无效或不正确的格式的 'priority' HTTP 标头的请求。
3.  **高并发请求：**  通过高并发地发送这些畸形请求，使 Tomcat 服务器消耗大量内存。
4.  **触发OutOfMemoryException：** 最终导致服务器内存耗尽，抛出 `OutOfMemoryException` 并导致服务崩溃或无响应。

**POC有效性：**

提供的POC代码是一个Python脚本，它使用 `httpx` 库来发送大量包含畸形 `priority` 标头的 HTTP/2 请求。脚本还包括对目标服务器的可用性监控。

根据漏洞描述，搜索引擎结果和POC代码，该POC很可能有效。它模拟了攻击者利用该漏洞所需的步骤。

**投毒风险：**

对提供的代码进行分析，发现投毒风险较低，大约为5%。

*   代码主要功能是发送 HTTP/2 请求，逻辑相对简单直接。
*   存在一个 `monitor` 函数，定期检查目标服务器的连通性，但这属于正常的漏洞验证行为，不构成投毒。
*  random.choice(self.headers_list) 属于正常的漏洞利用。从headers_list中随机选择恶意header。 同样不构成投毒

尽管如此，任何来自非官方来源的代码都应谨慎对待。 在运行之前，需要对代码进行彻底的审查和理解。

总而言之，提供的POC代码很可能有效，能够触发 CVE-2025-31650 漏洞，但应在受控环境中进行测试。

**项目地址:** [obscura-cert/CVE-2025-31650](https://github.com/obscura-cert/CVE-2025-31650)

**漏洞详情:** [CVE-2025-31650](https://nvd.nist.gov/vuln/detail/CVE-2025-31650)