## CVE-2018-11762-Apache Tika-Zip Slip

**漏洞编号:** CVE-2018-11762

**漏洞类型:** Zip Slip

**影响应用:** Apache Tika

**危害等级:** 中危，可能导致任意文件覆盖

**影响版本:** 0.9 to 1.18

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Tika的tika-app，并且在命令行执行时未指定--extract-dir参数，同时需要上传包含恶意构造的zip文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11762 是 Apache Tika 中存在的一个 Zip Slip 漏洞。具体来说，在 Apache Tika 0.9 到 1.18 版本中，如果用户在使用 tika-app 命令行工具时没有指定提取目录（即未使用 `--extract-dir=` 参数），并且上传的压缩文件中包含带有绝对路径的文件（例如 `C:/evil.bat`），那么 Tika 将会覆盖目标系统上的该文件。 

**有效性：** 提供的漏洞库信息、搜索引擎结果都确认了漏洞的存在。根据描述，漏洞利用比较依赖于特定的条件，但如果条件满足，是可以成功利用的。

**投毒风险：**  提供的代码片段是Apache Tika的`CHANGES.txt`文件，记录了版本更新日志。虽然这个文件本身不包含恶意代码，但版本控制仓库可能会被篡改或提交恶意补丁，因此存在潜在的投毒风险。 但是对于提供的代码来看，是历史版本，所以投毒风险极低，0%.

**利用方式：** 攻击者需要构造一个恶意的 ZIP 文件，该文件包含带有绝对路径的文件条目。当受害者使用存在漏洞的 Tika 版本处理该 ZIP 文件，并且没有指定提取目录时，Tika 会尝试将 ZIP 文件中的文件提取到 ZIP 文件中指定的绝对路径，从而导致任意文件覆盖。攻击者通常会覆盖一些关键的系统文件或者可执行文件，以达到进一步控制系统的目的。

利用的关键步骤如下：

1.  构造恶意的 ZIP 文件，其中包含带有绝对路径的文件，例如 `C:/evil.bat`。
2.  使用存在漏洞的 Apache Tika 版本（0.9 到 1.18）的 tika-app 命令行工具处理该 ZIP 文件，**并且不使用 `--extract-dir` 参数指定提取目录。**
3.  如果目标系统上存在 `C:/evil.bat` 文件，该文件将被 ZIP 文件中的恶意文件覆盖。

**关于搜索引擎结果：** 搜索引擎结果提供了有关该漏洞的一些额外信息，例如RedHat 和 SUSE 评估了该漏洞的影响，并将其评为 "重要" 级别。 但搜索引擎结果没有提供额外poc或者利用方式。


**项目地址:** [shoucheng3/apache__tika_CVE-2018-11762_1-18](https://github.com/shoucheng3/apache__tika_CVE-2018-11762_1-18)

**漏洞详情:** [CVE-2018-11762](https://nvd.nist.gov/vuln/detail/CVE-2018-11762)