## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升为root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-5195，也被称为Dirty COW，是一个Linux内核中的竞争条件漏洞。该漏洞存在于`mm/gup.c`文件中，允许本地用户利用copy-on-write(COW)机制中的不正确处理，写入只读内存映射，从而获得提升的权限。

**有效性:**
漏洞库信息和搜索结果表明，Dirty COW漏洞是一个真实存在且已被广泛利用的漏洞。漏洞利用代码包含了一个虚拟机镜像，其中包含用户名密码，用于复现该漏洞，这意味着POC是存在的。

**投毒风险:**
提供的漏洞利用代码主要是虚拟机镜像的下载链接和用户名密码。代码本身不包含明显的恶意代码。 但是，从安全角度考虑，仍然存在一定的投毒风险，原因如下：

*   **虚拟机镜像：** 虽然作者声明镜像无病毒，但无法完全信任，需要用户自行验证。镜像可能包含预先配置的后门程序或者其他恶意软件。下载链接可能被篡改，指向恶意镜像。
*   **依赖外部链接：** 代码依赖Google Drive链接下载镜像，如果链接被劫持或失效，可能导致下载到恶意文件。
*   **个人声明：** 作者的声明不能完全保证安全性，需要用户自行评估风险。

考虑到以上风险，虽然代码本身看起来没有明显的投毒行为，但仍有潜在的风险，所以投毒风险评估为5%。

**利用方式:**
1.  **环境准备：** 攻击者需要在受影响的Linux系统上运行POC代码。
2.  **利用竞争条件：** POC代码会利用`/proc/self/mem`尝试并发修改只读内存区域。线程1将目标内存区域映射为只读，线程2通过`/proc/self/mem`打开该内存区域并写入数据。
3.  **权限提升：** 如果竞争成功，攻击者就可以修改原本只读的文件，例如`/etc/passwd`，从而添加具有root权限的用户，实现权限提升。

**总结:**
Dirty COW漏洞是一个本地提权漏洞，允许低权限用户提升为root权限。提供的代码存在一定的投毒风险，用户需要谨慎使用。

**项目地址:** [sakilahamed/Linux-Kernel-Exploit-LAB](https://github.com/sakilahamed/Linux-Kernel-Exploit-LAB)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)