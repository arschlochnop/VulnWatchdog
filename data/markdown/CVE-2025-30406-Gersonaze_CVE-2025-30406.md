## CVE-2025-30406-Gladinet CentreStack-反序列化

**漏洞编号:** CVE-2025-30406

**漏洞类型:** 反序列化

**影响应用:** Gladinet CentreStack

**危害等级:** 高危，远程代码执行

**影响版本:** < 16.4.10315.56368

**利用条件:** 需要知道 machineKey

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30406 是 Gladinet CentreStack 中的一个反序列化漏洞。由于 CentreStack portal 使用硬编码的 machineKey，攻击者如果已知该 machineKey，就可以构造恶意的序列化 payload，导致服务器端反序列化，从而实现远程代码执行。

**有效性：**
根据漏洞信息、搜索结果和提供的 PoC 代码，此漏洞利用是有效的。漏洞库信息表明此漏洞已在野外被利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。搜索结果也证实了这一点。PoC 代码提供了一个利用 ViewState 反序列化漏洞的脚本，可以通过 ysoserial.exe 生成 payload 并发送给目标服务器。

**投毒风险：**
PoC 代码本身看起来像是直接利用漏洞。但是，仍然存在一些小的投毒风险：

1.  **ysoserial依赖:**  `exploit.py`脚本依赖外部工具 ysoserial.exe， 如果用户下载了恶意版本的 ysoserial.exe，则可能引入恶意代码。
2.  **Callback URL:** 脚本中包含一个 `callback_url` 参数，用于将命令的输出回传给攻击者。虽然这本身不是投毒，但可能被用于收集受害者信息。
3.  **示例代码中的风险:** Readme中存在 example.com的链接，有潜在风险。

综合评估，投毒风险约为 10%。主要风险在于用户可能使用的恶意ysoserial.exe，以及callback url泄露信息。

**利用方式：**
1.  **获取 machineKey：** 攻击者需要获取 CentreStack portal 的 machineKey。虽然 CVE 描述说明了这个key是硬编码的，实际环境中可能需要通过其他方式获取。
2.  **生成 Payload：** 使用 ysoserial.exe 工具，根据目标 .NET Framework 版本，生成一个包含恶意命令的 ViewState payload。
3.  **发送 Payload：** 将生成的 payload 作为 ViewState 的一部分发送到 CentreStack portal。当 portal 反序列化 ViewState 时，恶意命令将被执行。
4.  **远程代码执行：** 成功利用漏洞后，攻击者可以在服务器上执行任意代码。

**项目地址:** [Gersonaze/CVE-2025-30406](https://github.com/Gersonaze/CVE-2025-30406)

**漏洞详情:** [CVE-2025-30406](https://nvd.nist.gov/vuln/detail/CVE-2025-30406)