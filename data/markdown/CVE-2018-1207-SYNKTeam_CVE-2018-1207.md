## CVE-2018-1207 Dell iDRAC7/iDRAC8 远程代码执行

**漏洞编号:** CVE-2018-1207

**漏洞类型:** CGI注入

**影响应用:** Dell iDRAC7/iDRAC8

**危害等级:** 高危，可完全控制系统

**影响版本:** < 2.52.52.52

**利用条件:** 需要网络访问iDRAC管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-1207是Dell iDRAC7/iDRAC8设备中存在的一个CGI注入漏洞，允许未经验证的远程攻击者执行任意代码。漏洞的利用方式如下：

1.  **漏洞检测：** 利用`LD_DEBUG=files`参数检查目标系统是否存在漏洞。如果响应包含调试信息，则说明目标系统易受攻击。
2.  **Payload生成：** 生成包含反向shell代码的C语言文件`payload.c`。
3.  **交叉编译：** 使用`sh4-linux-gnu-gcc`将`payload.c`交叉编译为共享对象文件`payload.so`。这是因为iDRAC运行在SuperH (SH4) 处理器架构上。
4.  **Payload上传：** 通过向`/cgi-bin/putfile`发起POST请求，将编译后的`payload.so`文件上传到`/tmp/sshpkauthupload.tmp`。
5.  **Payload执行：** 通过向`/cgi-bin/discover`发起GET请求，并添加`LD_PRELOAD=/tmp/sshpkauthupload.tmp`参数，强制iDRAC加载恶意的`payload.so`文件。由于payload代码位于构造函数中，因此在加载时会自动执行，从而建立反向shell连接。

**有效性：** 提供的POC代码有效，能够成功利用该漏洞实现远程代码执行。

**投毒风险：**  POC代码的作者可能存在投毒风险，虽然主要功能是实现反向shell，但攻击者可以植入其他恶意代码。不过，该代码已经公开，并且较为简单，投毒的风险相对较低，大约为5%。投毒行为可能包括添加额外的系统操作，例如删除日志、创建后门帐户等。

**项目地址:** [SYNKTeam/CVE-2018-1207](https://github.com/SYNKTeam/CVE-2018-1207)

**漏洞详情:** [CVE-2018-1207](https://nvd.nist.gov/vuln/detail/CVE-2018-1207)