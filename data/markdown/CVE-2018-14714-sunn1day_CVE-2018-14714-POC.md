## CVE-2018-14714-ASUS RT-AC3200 命令注入

**漏洞编号:** CVE-2018-14714

**漏洞类型:** 命令注入

**影响应用:** ASUS RT-AC3200

**危害等级:** 高危，可能导致远程代码执行，完全控制路由器

**影响版本:** 3.0.0.4.382.50010

**利用条件:** 需要能够访问路由器的web管理界面，通常在局域网内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14714 漏洞存在于 ASUS RT-AC3200 路由器版本 3.0.0.4.382.50010 的 appGet.cgi 文件中。攻击者可以通过 `load_script` URL 参数注入系统命令，从而实现远程代码执行。

**利用方式：**

1.  攻击者构造包含恶意命令的 URL，将其中的命令注入到 `load_script` 参数中。
2.  路由器在处理 `appGet.cgi` 请求时，会将 `load_script` 参数的内容作为系统命令执行。
3.  攻击者通过此漏洞可以在路由器上执行任意命令，例如修改路由器配置、植入后门等。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它通过发送 HTTP GET 请求到目标路由器的 `/appGet.cgi` 路径，并在 `load_script` 参数中注入命令。具体来说，它尝试创建一个 `/www/emptyFile.asp` 文件来验证漏洞是否存在。脚本首先发送一个包含恶意`load_script`的请求，然后发送请求`/emptyFile.asp`，如果返回200，则说明漏洞存在。

**有效性评估：**

根据漏洞描述和POC代码，该漏洞的利用是可行的。POC代码能够验证目标系统是否存在该漏洞。

**投毒风险评估：**

在提供的POC代码中，主要功能是发送恶意请求和验证漏洞是否存在。该脚本尝试创建一个文件来判断漏洞是否存在，并无发现隐藏的恶意代码或后门，因此投毒风险评估为0%。

**利用代码说明:**

*   `req1` 函数构造了包含命令注入的 HTTP GET 请求。`%20` 是空格的 URL 编码，`%26%26` 是 `&&` 的 URL 编码，用于连接两个命令。这里先使用`echo`命令，然后再使用`touch`命令创建一个空文件，如果该文件存在则说明命令执行成功，即存在漏洞。
*   `req2` 函数用于验证文件是否创建成功，通过请求该文件，验证http状态码是否为200，如果为200，则说明该文件创建成功，漏洞存在。

**项目地址:** [sunn1day/CVE-2018-14714-POC](https://github.com/sunn1day/CVE-2018-14714-POC)

**漏洞详情:** [CVE-2018-14714](https://nvd.nist.gov/vuln/detail/CVE-2018-14714)