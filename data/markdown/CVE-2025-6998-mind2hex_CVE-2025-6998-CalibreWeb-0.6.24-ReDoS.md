## CVE-2025-6998-Calibre Web/Autocaliweb-ReDoS

**漏洞编号:** CVE-2025-6998

**漏洞类型:** ReDoS（正则表达式拒绝服务）

**影响应用:** Calibre Web/Autocaliweb

**危害等级:** 高危，可能导致服务拒绝

**影响版本:** Calibre Web 0.6.24, Autocaliweb 0.7.0 (excluding 0.7.1)

**利用条件:** 无需身份验证，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Calibre Web 和 Autocaliweb 的 `cps/string_helper.py` 文件中的 `strip_whitespaces()` 函数中。未经身份验证的远程攻击者可以通过构造特制的用户名参数，触发灾难性回溯，导致正则表达式拒绝服务（ReDoS）。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经公开。许多来源都提到了可以通过恶意构造的用户名触发 DoS。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证。虽然不能完全排除投毒的可能性，但仅凭此许可证文件无法判断是否存在恶意代码。因此，投毒风险较低，估计为 10%。真正的POC代码应该包含构造恶意用户名并发送到目标服务器的逻辑。

**利用方式：**
1.  确定目标系统运行着受影响的 Calibre Web 或 Autocaliweb 版本。
2.  构造一个恶意的用户名字符串，该字符串能够触发 `strip_whitespaces()` 函数中的正则表达式的灾难性回溯。恶意用户名通常包含大量的重复字符，这些重复字符能够使正则表达式引擎进入无限循环。
3.  通过登录页面或其他接受用户名输入的接口，将构造的恶意用户名发送到目标系统。
4.  服务器在处理恶意用户名时，会消耗大量的 CPU 资源，最终导致服务拒绝（DoS）。

**项目地址:** [mind2hex/CVE-2025-6998-CalibreWeb-0.6.24-ReDoS](https://github.com/mind2hex/CVE-2025-6998-CalibreWeb-0.6.24-ReDoS)

**漏洞详情:** [CVE-2025-6998](https://nvd.nist.gov/vuln/detail/CVE-2025-6998)