## CVE-2022-41352-Zimbra Collaboration Suite Arbitrary File Upload (RCE)

**漏洞编号:** CVE-2022-41352

**漏洞类型:** 任意文件上传导致RCE

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可导致远程代码执行和数据泄露

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要网络访问Zimbra服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41352是Zimbra Collaboration Suite中的一个任意文件上传漏洞。攻击者可以通过向`/service/upload`端点发送特制的multipart/form-data请求，上传包含恶意代码的tar文件（或使用cpio loophole）。

**利用方式:**

1.  攻击者构造一个包含恶意JSP webshell的tar压缩包，例如命名为`test.tar`。
2.  通过POST请求，向`/service/upload?fmt=raw`端点上传该tar文件。
3.  该tar文件会被Amavis组件使用存在漏洞的cpio程序进行解压，由于路径遍历漏洞，攻击者可以将webshell写入`/opt/zimbra/jetty/webapps/zimbra/public`目录，该目录是Zimbra Web UI的静态资源目录。
4.  攻击者可以通过访问`https://<Zimbra服务器>/zimbra/public/<webshell名称>.jsp`来执行webshell中的代码，从而实现远程代码执行。

**有效性:**

根据提供的漏洞信息、搜索结果和POC代码，该漏洞的利用是有效的。搜索结果表明，该漏洞在野外已被积极利用。

**投毒风险:**

分析POC代码，主要风险点在于`payload-content`的内容。 如果该部分内容包含恶意代码（例如，尝试删除文件或执行系统命令），则存在投毒风险。该POC代码主要用于检测，但如果攻击者修改`payload-content`，则可能包含投毒代码。由于poc的最终目的是上传webshell,因此存在一定的投毒风险，评估为10%。

**总结:**
该漏洞是一个严重的安全问题，允许未经身份验证的攻击者在Zimbra服务器上执行任意代码。应尽快应用官方补丁或缓解措施。

**项目地址:** [MuhammadWaseem29/cve-2022-41352](https://github.com/MuhammadWaseem29/cve-2022-41352)

**漏洞详情:** [CVE-2022-41352](https://nvd.nist.gov/vuln/detail/CVE-2022-41352)