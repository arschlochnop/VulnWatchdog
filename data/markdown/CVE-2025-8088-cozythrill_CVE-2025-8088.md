## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可导致任意代码执行

**影响版本:** <= 7.12 (Windows版本)

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-8088是一个影响WinRAR Windows版本的路径遍历漏洞。攻击者可以制作恶意RAR压缩包，利用该漏洞将恶意文件复制到敏感目录，例如Windows启动文件夹，从而实现任意代码执行。

**有效性:**
提供的POC代码看起来是有效的。它通过生成包含精心构造的路径的RAR文件来利用该漏洞。这些路径包含相对路径（例如 `..\`），允许将文件写入任意位置（特别是启动文件夹）。搜索引擎结果也表明该漏洞已被野外利用。

**投毒风险:**
仔细分析了提供的Python脚本(`CVE-2025-8088.py`)、README.md、config.py 和extract.py。我注意到以下几点：

*   `CVE-2025-8088.py`: 该脚本的主要功能是创建利用WinRAR路径遍历漏洞的恶意RAR文件。它生成包含相对路径的RAR文件，以便将payload放入启动目录。 其中cache_register.exe下载远程url,并执行,然后删除。 这段代码相对来说是存在一定风险的，下载未知程序并执行。
*   `README.md`: 该文件提供了脚本的描述、需求和使用说明。它还包含一个免责声明，指出该工具仅用于教育目的。
*   `config.py`: 该文件包含一些配置选项，例如payload内容和目标路径。`PAYLOAD = "@echo off\nstart /B C:\Users\Public\file.exe\n"` 允许攻击者指定执行的命令，这是恶意行为的核心。
*  `extract.py`: 这段代码没有完成，存在语法错误，且没有在`CVE-2025-8088.py`中被调用。所以判断为无效代码

虽然这个脚本的主要意图是利用WinRAR漏洞进行攻击，但我认为`cache_register.exe`从远程url下载并执行存在潜在风险，因为它可能会下载并执行任何程序。因此，我认为代码中存在轻微的投毒风险，大约为1%。

**利用方式:**
1.  脚本`CVE-2025-8088.py` 生成一个包含恶意结构的RAR压缩文件(`exploit.rar`)。
2.  这个RAR文件包含带有特殊构造的文件名，文件名中包含路径遍历字符序列(例如 `..\`)。
3.  当受害者使用易受攻击的WinRAR版本解压该RAR文件时，这些路径遍历序列允许将payload写入到文件系统上的任意位置，如启动文件夹。
4.  一旦Payload放置在启动文件夹中，系统重启时将自动执行Payload，从而允许攻击者在受害者系统上执行任意代码。

攻击通常涉及社会工程学，诱使用户解压恶意RAR压缩包。搜索引擎结果表明，攻击者利用该漏洞传播RomCom恶意软件。

**项目地址:** [cozythrill/CVE-2025-8088](https://github.com/cozythrill/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)