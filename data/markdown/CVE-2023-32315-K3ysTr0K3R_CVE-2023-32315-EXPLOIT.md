## CVE-2023-32315-Openfire身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致的身份验证绕过

**影响应用:** Openfire

**危害等级:** 高危，未经身份验证的攻击者可以创建管理员账户。

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** 目标系统运行受影响版本的Openfire，并且攻击者能够通过网络访问Openfire的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 管理控制台身份验证绕过漏洞。由于存在路径遍历漏洞，未经身份验证的攻击者可以利用 Openfire 安装环境访问受限页面，从而在已配置的 Openfire 环境中创建管理员用户。漏洞利用方式如下：

1.  **漏洞原理：** 该漏洞利用了Openfire安装设置过程中的路径遍历缺陷，允许攻击者绕过身份验证，访问通常需要管理员权限才能访问的页面。
2.  **POC 代码分析：** 提供的Python脚本首先尝试从`/login.jsp`获取CSRF token。然后，它构造一个包含路径遍历的URL (`/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`)，以及要创建的管理员用户的用户名和密码。脚本使用`requests`库发送包含精心构造的URL的GET请求，并使用CSRF token绕过身份验证，从而创建新的管理员用户。
3.  **利用方式：**
    *   攻击者首先访问Openfire服务器的Web管理界面。
    *   攻击者使用包含路径遍历的恶意URL，绕过身份验证。
    *   攻击者通过构造的URL，创建一个新的管理员用户，从而获得对Openfire服务器的完全控制权。
4.  **投毒风险分析：** 该脚本的功能相对直接，主要用于利用漏洞创建管理员帐户。 脚本中使用了 `subprocess.Popen` 执行 curl 命令，如果目标服务器上 curl 被恶意修改，可能存在安全风险。此外，`mass_exploit` 函数从文件中读取目标 URL，如果该文件被篡改，可能导致脚本尝试攻击非预期目标。总体而言，投毒风险较低，约为10%， 主要集中在对外部命令的依赖以及批量攻击的目标文件。

**项目地址:** [K3ysTr0K3R/CVE-2023-32315-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2023-32315-EXPLOIT)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)