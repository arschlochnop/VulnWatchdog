## CVE-2023-44487 HTTP/2 Rapid Reset 拒绝服务漏洞

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2 协议实现

**危害等级:** 高危，可能导致服务器资源耗尽，服务不可用

**影响版本:** 所有受影响的 HTTP/2 协议实现

**利用条件:** 目标服务器必须支持 HTTP/2 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-44487 漏洞是 HTTP/2 协议中的一个拒绝服务漏洞，被称为 Rapid Reset 攻击。攻击者通过快速建立和重置大量的 HTTP/2 流，导致服务器资源被迅速消耗，最终导致拒绝服务。\n\n**有效性：**\n根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式是有效的。漏洞库信息中明确指出此漏洞已在野外被利用。搜索引擎结果中也多次提到该漏洞及其影响。提供的漏洞利用代码描述了利用方式，并提供了一个工具来检测服务器是否易受攻击。\n\n**投毒风险：**\n该代码库的主要目的是演示和测试 CVE-2023-44487 漏洞。虽然直接的恶意代码（如反向shell）不太可能存在，但仍然存在一些潜在的风险，例如：\n\n*   **资源耗尽：** 运行此 PoC 代码可能会对目标服务器造成拒绝服务，如果滥用或未经授权使用，可能导致法律问题。\n*   **监控数据操纵：** `monitor.log` 文件的写入可能会被修改以隐藏攻击的真实影响，虽然可能性较低。\n*   **依赖风险：** 如果代码依赖于外部库，这些库可能存在漏洞或被恶意修改。\n\n总体而言，代码库本身的投毒风险较低，但滥用该工具进行攻击的风险较高，以及存在一些潜在的、隐藏影响分析结果的风险。因此，投毒风险评估为 10%。\n\n**利用方式：**\n1.  攻击者与目标服务器建立一个或多个 HTTP/2 连接。\n2.  攻击者在每个连接上快速创建新的 HTTP/2 流，并立即发送 `HEADERS` 帧来发起请求。\n3.  在发送 `HEADERS` 帧后，立即发送 `RST_STREAM` 帧来重置该流。这会取消请求，但服务器可能已经开始处理该请求。\n4.  重复步骤 2 和 3 大量次数，使得服务器疲于处理大量的流创建和重置操作，最终耗尽资源并导致拒绝服务。\n5.  该漏洞利用代码提供了配置选项，例如并发连接数、每个流的 HEADERS 和 RST_STREAM 帧的数量以及发送 HEADERS 和 RST_STREAM 帧之间的时间延迟，从而允许攻击者根据目标服务器的配置和性能调整攻击强度。

**项目地址:** [ndrscodes/http2-rst-stream-attacker](https://github.com/ndrscodes/http2-rst-stream-attacker)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)