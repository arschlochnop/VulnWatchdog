## CVE-2024-8682 - JNews WordPress Theme Unauthorized User Registration

**漏洞编号:** CVE-2024-8682

**漏洞类型:** 未授权用户注册

**影响应用:** JNews - WordPress Newspaper Magazine Blog AMP Theme

**危害等级:** 中危，可能允许未经授权的用户访问系统

**影响版本:** <= 11.6.6

**利用条件:** 需要目标WordPress站点安装并启用 JNews 主题，且未采取其他安全措施。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 JNews WordPress 主题中，允许未经身份验证的攻击者注册新用户，即使 WordPress 的用户注册选项已禁用。攻击者首先通过 `jnews_refresh_nonce` 操作检索有效的 `jnews_nonce`，然后使用该 nonce 通过 `register_handler` 注册新用户。PoC 代码通过发送 POST 请求到 `/?ajax-request=jnews` 端点来实现这一点。

**有效性：** 根据漏洞描述和 PoC 代码，该 PoC 有效，可以绕过用户注册限制。

**投毒风险：** 提供的 PoC 代码未发现任何投毒行为。代码逻辑清晰，仅包含获取 nonce 和注册用户的操作。虽然任何代码都存在潜在的隐患，但在此例中，风险较低。

**利用方式：**
1.  构造包含 `action=jnews_refresh_nonce` 和 `refresh_action_nonce=jnews_nonce` 的 POST 请求，发送到目标 WordPress 站点的 `/?ajax-request=jnews` 端点，以获取有效的 `jnews_nonce`。
2.  构造包含 `action=register_handler`、`username`、`email` 和 `jnews_nonce` 的 POST 请求，发送到相同的 `/?ajax-request=jnews` 端点，以注册新用户。
3.  成功注册后，攻击者可以使用新注册的用户帐户登录 WordPress 站点。

**项目地址:** [4minx/CVE-2024-8682](https://github.com/4minx/CVE-2024-8682)

**漏洞详情:** [CVE-2024-8682](https://nvd.nist.gov/vuln/detail/CVE-2024-8682)