## CVE-2023-24489-ShareFile Storage Zones Controller-远程代码执行

**漏洞编号:** CVE-2023-24489

**漏洞类型:** 远程代码执行

**影响应用:** Citrix ShareFile Storage Zones Controller

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 5.11.24

**利用条件:** 目标服务器运行受影响版本的ShareFile Storage Zones Controller，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-24489是一个存在于Citrix ShareFile Storage Zones Controller中的远程代码执行漏洞。未授权的攻击者可以通过利用此漏洞远程控制ShareFile Storage Zones Controller。根据搜索引擎结果，该漏洞已经被CISA列入已知被利用的漏洞目录（KEV）。

**有效性：**
提供的PoC代码看起来是有效的，它通过向目标服务器的`/documentum/upload.aspx`端点发送包含恶意C#代码的POST请求，利用了未授权的文件上传和路径遍历漏洞。上传的文件会被保存在`cifs`目录下，然后攻击者可以通过访问上传的`aspx`文件来执行任意命令。PoC代码首先上传一个包含`whoami`命令的webshell, 然后通过访问webshell确定是否成功。

**投毒风险：**
查看提供的bash脚本和README.md文件,没有发现任何作者隐藏的恶意代码, 该仓库用于验证漏洞，而非传播恶意软件。因此，投毒风险评估为0%。

**利用方式：**
1.  攻击者准备一个包含C#代码的POST请求，该代码会在服务器上执行任意命令。
2.  攻击者向目标ShareFile Storage Zones Controller的`/documentum/upload.aspx`端点发送POST请求，利用`parentid`，`raw`，`unzip`和`uploadid`参数绕过身份验证和文件上传限制。`uploadid`参数包含一个路径遍历序列，将文件上传到`cifs`目录下。
3.  服务器接受POST请求并将包含C#代码的aspx文件上传到`cifs`目录。
4.  攻击者通过访问上传的aspx文件来执行C#代码，从而在服务器上执行任意命令，实现远程代码执行。
5.  通过执行`whoami`指令，来验证命令执行的成功性。

**项目地址:** [whalebone7/CVE-2023-24489-poc](https://github.com/whalebone7/CVE-2023-24489-poc)

**漏洞详情:** [CVE-2023-24489](https://nvd.nist.gov/vuln/detail/CVE-2023-24489)