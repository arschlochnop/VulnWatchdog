## CVE-2020-10199-Sonatype Nexus Repository-JavaEL注入

**漏洞编号:** CVE-2020-10199

**漏洞类型:** JavaEL注入

**影响应用:** Sonatype Nexus Repository

**危害等级:** 高危，可远程代码执行

**影响版本:** < 3.21.2

**利用条件:** 需要低权限用户账号，需要网络访问Nexus Repository服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-10199是Sonatype Nexus Repository 3.21.2之前的版本中存在的一个JavaEL注入漏洞。攻击者利用此漏洞可以在Nexus Repository服务器上执行任意代码。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为8.8，属于高危漏洞，并且已被CISA列入已知被利用的漏洞目录。该漏洞影响所有Nexus Repository 3.x OSS/Pro版本直到3.21.1。Packetstormsecurity和Exploit-DB上都有公开的漏洞利用代码。

**有效性：**

提供的POC代码看起来是有效的。它利用了JavaEL注入漏洞，允许通过提供特定的输入来执行任意代码。代码首先使用提供的用户名和密码进行身份验证，然后构造一个包含恶意JavaEL表达式的JSON请求，从而实现远程代码执行。

**投毒风险：**

通过分析提供的POC代码，没有发现明显的投毒行为。该代码主要用于利用JavaEL注入漏洞执行命令。`ExecuteCommand`函数从命令行获取目标URL、用户名和密码，然后构造并发送包含payload的HTTP POST请求。其中payload中的BCEL代码是用于执行命令的关键部分。虽然BCEL代码本身可能比较复杂，但其目的是明确的，即通过JavaEL注入执行指定的命令。

**利用方式：**

1.  **身份验证：** 使用提供的用户名和密码（base64编码后）向`/service/rapture/session`端点发送POST请求以获取会话。
2.  **构造恶意请求：** 构造一个包含JavaEL表达式的JSON请求。此表达式的目标是利用`com.sun.org.apache.bcel.internal.util.ClassLoader`类加载器，并通过BCEL（Byte Code Engineering Library）定义的字节码在服务器上执行命令。
3.  **发送请求：** 将构造的JSON数据作为请求体发送到目标Nexus Repository服务器，触发JavaEL注入。
4.  **远程代码执行：** Nexus Repository服务器在处理包含JavaEL表达式的请求时，会执行该表达式，从而执行攻击者注入的恶意代码。
5. 获得反弹shell或其他后门。

**项目地址:** [aleenzz/CVE-2020-10199](https://github.com/aleenzz/CVE-2020-10199)

**漏洞详情:** [CVE-2020-10199](https://nvd.nist.gov/vuln/detail/CVE-2020-10199)