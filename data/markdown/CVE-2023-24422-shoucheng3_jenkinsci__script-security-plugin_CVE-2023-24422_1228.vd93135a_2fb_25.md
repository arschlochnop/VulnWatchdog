## CVE-2023-24422 - Jenkins Script Security Plugin Sandbox Bypass

**漏洞编号:** CVE-2023-24422

**漏洞类型:** Sandbox Bypass

**影响应用:** Jenkins Script Security Plugin

**危害等级:** 高危，允许攻击者绕过沙箱保护并在Jenkins控制器JVM的上下文中执行任意代码。

**影响版本:** <= 1228.vd93135a_2fb_25

**利用条件:** 需要具有定义和运行沙盒脚本的权限，包括Pipeline。

**POC 可用性:** 未直接提供，但漏洞描述明确，可利用。

**投毒风险:** 10%

## 详情

CVE-2023-24422是Jenkins Script Security Plugin中的一个沙箱绕过漏洞。攻击者如果拥有定义和运行沙盒脚本的权限（包括Pipeline脚本），就可以利用map构造函数绕过沙箱保护，进而在Jenkins控制器JVM的上下文中执行任意代码。

**有效性：**
该漏洞描述明确，且存在多个信息来源确认其影响和可利用性。虽然没有直接提供POC代码，但根据漏洞描述，可以构造利用代码。

**投毒风险：**
提供的“漏洞利用代码”实际上是 `CHANGELOG.md` 文件，其中包含了插件的历史版本更新信息，以及修复的漏洞。该文件本身不包含恶意代码，但如果攻击者能够篡改该文件并将其部署到受害者环境中，可能会造成信息混淆或引发其他攻击。但直接从该文件进行投毒的可能性较低,因此投毒风险较低。

**利用方式：**
根据漏洞描述，利用方式涉及构造恶意的沙盒脚本，利用map构造函数绕过沙箱限制，最终在Jenkins控制器JVM的上下文中执行任意代码。 具体细节需要进一步研究相关map构造函数的特性和沙箱的实现机制。由于需要绕过沙箱，利用方式可能较为复杂。

**项目地址:** [shoucheng3/jenkinsci__script-security-plugin_CVE-2023-24422_1228.vd93135a_2fb_25](https://github.com/shoucheng3/jenkinsci__script-security-plugin_CVE-2023-24422_1228.vd93135a_2fb_25)

**漏洞详情:** [CVE-2023-24422](https://nvd.nist.gov/vuln/detail/CVE-2023-24422)