## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未授权远程代码执行

**影响版本:** BIG-IP 16.1.x < 16.1.2.2, 15.1.x < 15.1.5.1, 14.1.x < 14.1.4.6, 13.1.x < 13.1.5, 12.1.x <= 12.1.6, 11.6.x <= 11.6.5

**利用条件:** 目标系统存在漏洞版本，且可通过网络访问iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者通过 iControl REST API 发送特制的请求，绕过身份验证并执行任意命令。该漏洞利用方式是通过构造特定的HTTP头部，例如 Host: 127.0.0.1, X-F5-Auth-Token: a 等，从而绕过认证。提供的Python POC 脚本通过向 /mgmt/tm/util/bash 接口发送包含命令的 JSON 数据包来实现远程代码执行。脚本中使用了 requests 库发送 POST 请求，执行用户指定的命令。 投毒风险分析：POC 代码本身看起来比较直接，没有明显的恶意代码。但考虑到批量扫描的性质，攻击者可能利用此脚本植入后门，所以存在一定的投毒风险。headers中的 User-Agent 字段存在可疑字符，虽然不构成直接的投毒，但是属于不规范的 User-Agent。

**项目地址:** [Chocapikk/CVE-2022-1388](https://github.com/Chocapikk/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)