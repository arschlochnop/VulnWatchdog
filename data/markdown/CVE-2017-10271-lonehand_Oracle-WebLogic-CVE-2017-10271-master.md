## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)