## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)