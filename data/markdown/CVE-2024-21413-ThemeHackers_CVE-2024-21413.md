## CVE-2024-21413-Microsoft Outlook远程代码执行

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，攻击者无需用户交互即可在目标系统上执行任意代码。

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021 (版本低于 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要能够向受害者发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也称为“MonikerLink”漏洞。根据漏洞库信息和搜索引擎结果显示，该漏洞允许攻击者在受害者的计算机上执行任意代码，而无需任何用户交互。这个漏洞是由于对输入验证不当造成的(CWE-20)。

**利用方式：**

1.  攻击者创建一个特制的电子邮件，其中包含恶意的链接或嵌入的内容。
2.  当受害者收到并打开此电子邮件时，Outlook 会尝试解析该链接。
3.  由于漏洞存在于 Outlook 的链接处理机制中，攻击者可以利用此漏洞绕过安全检查，从而执行任意代码。

**POC代码分析：**

提供的POC代码是一个Python脚本，用于发送包含HTML内容的电子邮件。该脚本从 `config.ini` 文件中读取发件人邮箱地址、密码、SMTP服务器和端口。然后它使用模板 `template/Stripo.html` 构造电子邮件的内容，并将收件人的邮箱地址和链接内容插入到HTML代码中。最后，该脚本使用smtplib库发送电子邮件。

**有效性评估：**

根据搜索引擎的结果 (特别是github链接: ThemeHackers/CVE-2024-21413) 和漏洞描述, 此POC是可用的,可以用于漏洞验证的.

**投毒风险分析：**

代码中存在一定的投毒风险，主要体现在以下几个方面：

*   **config.ini文件：** POC依赖于 `config.ini` 文件,需要用户配置邮箱账户和密码。 如果恶意攻击者提供了一个修改后的 `config.ini` 文件，其中包含错误的SMTP配置或恶意代码，可能导致用户的信息泄露或者执行未知的操作。
*   **template/Stripo.html模板：** HTML模板允许插入任意HTML代码，如果攻击者篡改了HTML模板, 就可以嵌入恶意的JavaScript或其他类型的脚本，在用户打开邮件时执行。
*   **依赖的外部库:** colorama, bgtask, configparser， 攻击者可能修改这些依赖，在用户本地执行恶意命令

总体而言，该POC的投毒风险大约为30%。 这个评估是基于对代码的分析以及对潜在攻击向量的理解。需要注意的是，具体的风险程度取决于攻击者的能力和目标用户的安全意识。

**项目地址:** [ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)