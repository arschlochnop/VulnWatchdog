## CVE-2025-9776 — CatFolders WordPress Plugin: Authenticated SQL Injection via CSV Import

**漏洞编号:** CVE-2025-9776

**漏洞类型:** SQL注入

**影响应用:** CatFolders WordPress Plugin

**危害等级:** 中危，可能导致数据泄露和数据操纵

**影响版本:** <= 2.5.2

**利用条件:** 需要Author或更高权限的WordPress用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和提供的POC代码，该漏洞是CatFolders WordPress插件中的一个经过身份验证的SQL注入漏洞。攻击者需要具备Author或更高权限的账户才能利用此漏洞。漏洞存在于CSV导入功能中，`attachments`列的数据未经过充分的过滤直接拼接到SQL查询语句中，导致攻击者可以通过构造恶意的CSV文件注入SQL代码。搜索引擎结果也证实了该漏洞的存在。

**有效性：** 提供的POC代码有效。它提供了一个恶意CSV文件和相应的curl命令，可以成功触发SQL注入。

**投毒风险：**
  *   **声明文件 (DISCLAIMER.md):** 声明该代码仅用于防御性安全研究和教育目的，禁止用于未经授权的系统。
  *   **许可证 (LICENSE):** MIT许可证允许自由使用、修改和分发代码。
  *   **自述文件 (README.md):** 提供了漏洞的详细描述，利用方法以及修复建议，无任何恶意代码的迹象。
  *   **PoC脚本 (poc/catf_inject.csv、poc/catfolders_sql_poc.py):** 主要用于验证和演示漏洞，用于触发SQL注入。

分析POC代码，投毒风险较低，约为10%。这主要基于以下几点：PoC包含SQLite模拟，用于本地安全演示，减轻了在真实环境测试的必要。尽管如此，仍然存在用户恶意使用PoC的可能性，存在一定风险。

**利用方式：**

1.  **发现REST API endpoint：** 使用curl命令发现`/import-csv`的REST namespace。
2.  **构造恶意CSV文件：** 创建一个包含恶意SQL注入payload的CSV文件，该payload位于`attachments`列中。例如：`1) OR 1=1--`
3.  **发送请求：** 使用具备Author权限的账户，通过curl命令上传构造的CSV文件到`/import-csv` endpoint。
4.  **触发SQL注入：** 服务器解析CSV文件，并将恶意payload拼接到SQL查询语句中，执行注入。

通过以上步骤，攻击者可以执行任意SQL查询，从而提取敏感信息或操纵数据库内容。根据Wordfence的报告，成功利用该漏洞可能导致大量删除或操纵文件夹-附件映射，数据泄露取决于有效载荷/数据库。


**项目地址:** [SnailSploit/CVE-2025-9776](https://github.com/SnailSploit/CVE-2025-9776)

**漏洞详情:** [CVE-2025-9776](https://nvd.nist.gov/vuln/detail/CVE-2025-9776)