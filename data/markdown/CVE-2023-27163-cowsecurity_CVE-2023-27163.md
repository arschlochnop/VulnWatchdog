## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网访问

**影响版本:** <= 1.2.1

**利用条件:** 需要Request Baskets服务可用，攻击者需要知道目标Request Baskets服务的URL

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27163是Request Baskets 1.2.1及之前版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件来访问内部网络资源和敏感信息。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的存在已被确认，并且有多个PoC代码可用。提供的PoC代码通过创建一个新的basket，并将`forward_url`设置为攻击者的服务器，来触发SSRF漏洞。当有人访问新创建的basket时，Request Baskets服务器将向攻击者的服务器发起请求。

**投毒风险：**

查看PoC代码，该代码主要功能是利用SSRF漏洞，没有发现明显的恶意代码或后门。`requirements.txt`文件只包含`requests`和`pyfiglet`两个常用的库，没有发现异常依赖。`README.md`文件提供的是关于漏洞的描述，安装方法和使用方法，也没有包含恶意代码。但考虑到任何代码都存在潜在风险，此处判定存在极低的投毒风险，约为1%。

**利用方式：**

1.  **部署Request Baskets:** 首先，需要部署一个存在漏洞的Request Baskets实例（版本<= 1.2.1）。
2.  **运行PoC脚本:** 运行提供的Python脚本`CVE-2023-27163.py`，指定目标Request Baskets服务的URL和攻击者的服务器URL。
3.  **创建恶意Basket:** 脚本会创建一个新的basket，并将`forward_url`设置为攻击者的服务器。
4.  **触发SSRF:** 任何访问新创建的basket的用户都会导致Request Baskets服务器向攻击者的服务器发起请求。攻击者可以在其服务器上捕获这些请求，并获取敏感信息，或者利用这些请求访问内部网络资源。

例如，攻击者可以将`attack_server`设置为内部服务的地址，例如`http://169.254.169.254/latest/meta-data`来获取云服务器的元数据。


**项目地址:** [cowsecurity/CVE-2023-27163](https://github.com/cowsecurity/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)