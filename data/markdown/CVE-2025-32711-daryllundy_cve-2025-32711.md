## CVE-2025-32711-M365 Copilot 信息泄露

**漏洞编号:** CVE-2025-32711

**漏洞类型:** AI命令注入

**影响应用:** Microsoft 365 Copilot

**危害等级:** 高危，未经授权的攻击者可以通过网络泄露信息

**影响版本:** 所有版本

**利用条件:** 需要攻击者能够发送电子邮件到受害者邮箱，并且受害者使用了 Microsoft 365 Copilot

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-32711，又名“EchoLeak”，是 Microsoft 365 Copilot 中的一个关键的零点击漏洞，它允许攻击者在无需用户交互的情况下，窃取敏感的组织数据。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的PoC代码（检测脚本）是有效的。搜索结果表明该漏洞确实存在，并且被成功利用过。提供的PoC代码包含检测和修复脚本，进一步验证了其有效性。

**投毒风险：**
提供的代码库包含检测和修复漏洞的脚本，而不是直接利用漏洞的代码。但是，仍然存在一些投毒风险：
*   **Remediate脚本的潜在风险：** `remediate.ps1` 脚本在修复漏洞时，如果配置不当，可能会引入新的安全问题或导致服务中断。例如，过于严格的邮件过滤规则可能会阻止合法的邮件。
*   **依赖项风险：** 脚本依赖于多个 PowerShell 模块（ExchangeOnlineManagement, Microsoft.Graph, AzureAD），这些模块本身可能存在安全漏洞或被恶意篡改。
*   **后门检测困难：** 虽然代码主要用于检测和修复，但攻击者可能巧妙地在检测脚本中加入后门，例如在日志记录中包含敏感信息，或者在修复脚本中添加恶意配置。

综上，虽然此代码主要用于防御，但仍然存在一定的投毒风险，建议在使用前进行详细的代码审计。估算投毒风险为20%。

**利用方式：**
1.  **攻击者构造包含恶意prompt注入的电子邮件。** 这些prompt注入旨在绕过XPIA（Cross-Prompt Injection Attack）分类器，使其看起来像普通的用户指令。
2.  **攻击者发送该邮件给目标用户。**
3.  **当Copilot处理任何查询时，它会访问包含恶意prompt注入的电子邮件。**
4.  **Copilot执行隐藏的指令，从而导致敏感数据（来自电子邮件、OneDrive、SharePoint、Teams等）泄露到攻击者控制的服务器。** 这种攻击是零点击的，意味着不需要用户交互。

**项目地址:** [daryllundy/cve-2025-32711](https://github.com/daryllundy/cve-2025-32711)

**漏洞详情:** [CVE-2025-32711](https://nvd.nist.gov/vuln/detail/CVE-2025-32711)