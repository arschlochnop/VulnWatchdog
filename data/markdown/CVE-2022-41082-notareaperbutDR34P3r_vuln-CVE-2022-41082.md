## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Exchange Server 2013 Cumulative Update 23 (版本 < 15.00.1497.044), Exchange Server 2016 Cumulative Update 22 (版本 < 15.01.2375.037), Exchange Server 2019 Cumulative Update 11 (版本 < 15.02.0986.036), Exchange Server 2019 Cumulative Update 12 (版本 < 15.02.1118.020), Exchange Server 2016 Cumulative Update 23 (版本 < 15.01.2507.016)

**利用条件:** 需要 Exchange PowerShell 可被攻击者访问，可能需要身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。根据搜索引擎结果，该漏洞通常与 CVE-2022-41040 (SSRF) 结合利用，形成 ProxyNotShell 攻击链或 OWASSRF。攻击者首先利用 CVE-2022-41040 获得对 Exchange 服务器的访问权限，然后利用 CVE-2022-41082 执行任意代码。漏洞利用代码中的 `exchange-vuln-check.nse` 脚本旨在检测目标 Exchange 服务器是否存在此漏洞，它通过发送特制的 HTTP 请求到 `autodiscover/autodiscover.json` 路径进行检测。如果服务器返回特定的 HTTP 状态码和头部信息，则表明可能存在漏洞。此代码本身主要是检测，而非直接利用 RCE。因此，投毒风险较低，主要体现在 nmap 脚本的可靠性和可能存在的误报上。但如果此脚本被用于自动化扫描，并根据扫描结果进行进一步的攻击尝试，则可能被滥用。综上，判断该仓库存在 10% 的投毒风险，主要在于误报的可能性和脚本滥用的潜在风险。

**项目地址:** [notareaperbutDR34P3r/vuln-CVE-2022-41082](https://github.com/notareaperbutDR34P3r/vuln-CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)