## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)