## CVE-2025-49125-ApacheTomcat-身份验证绕过

**漏洞编号:** CVE-2025-49125

**漏洞类型:** 身份验证绕过

**影响应用:** Apache Tomcat

**危害等级:** 中危，可能导致未经授权的访问

**影响版本:** 11.0.0-M1 <= 11.0.7, 10.1.0-M1 <= 10.1.41, 9.0.0.M1 <= 9.0.105

**利用条件:** 需要Tomcat配置了PreResources或PostResources，且挂载点不在根目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49125是Apache Tomcat中的一个身份验证绕过漏洞，影响版本11.0.0-M1到11.0.7，10.1.0-M1到10.1.41以及9.0.0.M1到9.0.105。当Tomcat配置了PreResources或PostResources，且这些资源挂载在非根目录时，攻击者可以通过访问一个未预期的路径来绕过安全约束，从而访问受保护的资源。

**有效性：** 提供的代码片段是Apache License 2.0的许可证文本，并非漏洞利用代码本身。 但是，根据漏洞描述和搜索结果（特别是 cybersecuritynews.com 和 gbhackers.com 的相关描述），可以推断出漏洞利用是可行的，通过构造特定的URL来访问受保护的资源。

**投毒风险：** 提供的代码片段是标准的开源许可证，不包含任何恶意代码或投毒风险。因此，投毒风险评估为0%。

**利用方式：** 

1.  **前提条件：** Tomcat服务器需要配置了PreResources或PostResources，并且这些资源不是挂载在Web应用程序的根目录下。
2.  **漏洞原理：** 漏洞在于Tomcat在处理PreResources或PostResources时，存在路径处理的缺陷。 攻击者可以通过构造特定的URL，绕过预期路径上的安全约束。
3.  **攻击步骤：** 攻击者需要找到PreResources或PostResources挂载的非根目录，然后尝试通过构造畸形的URL访问这些资源。畸形的URL会绕过原有的安全检查，直接访问到受保护的资源。
4.  **示例：** 假设PreResources挂载在`/static`目录下，并且该目录下包含一个受保护的`admin.jsp`文件。正常情况下，访问` /static/admin.jsp` 需要身份验证。攻击者可能会尝试使用`../` 绕过路径，例如 `/static/../admin.jsp`或者其他类似的变体。

**修复建议：** 升级到Apache Tomcat 11.0.8, 10.1.42 或 9.0.106。

**项目地址:** [gregk4sec/CVE-2025-49125](https://github.com/gregk4sec/CVE-2025-49125)

**漏洞详情:** [CVE-2025-49125](https://nvd.nist.gov/vuln/detail/CVE-2025-49125)