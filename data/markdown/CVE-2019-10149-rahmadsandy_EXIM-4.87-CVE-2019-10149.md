## CVE-2019-10149 Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，且攻击者能够发送邮件到目标服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是一个存在于Exim 4.87到4.91版本的远程命令执行漏洞。漏洞位于`/src/deliver.c`文件的`deliver_message()`函数中，由于对收件人地址验证不当导致。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和已知的漏洞利用情况，该漏洞利用是有效的。搜索引擎结果中多个来源确认了该漏洞的存在以及被利用的事实，包括安全公司和微软的报告。

**投毒风险：**
提供的POC代码仓库只包含了一个`README.md`文件，该文件描述了如何搭建用于教育目的的漏洞环境，本身没有包含任何可执行代码或恶意指令。因此，直接的投毒风险较低，但依然存在一定的潜在风险：

1.  **误导性利用方式：**  即使`README.md`文件本身没有恶意代码，但如果该文件描述的漏洞利用方式不准确或包含误导信息，可能导致用户在真实环境中错误配置，从而引入新的安全风险。
2.  **供应链攻击：**  如果攻击者能够控制该代码仓库，则可以修改`README.md`或其他相关文件，加入恶意链接、恶意命令或者指向其他恶意仓库，诱导用户下载并执行恶意代码。

综合考虑，该POC代码仓库的直接投毒风险较低，大约为10%，主要来自于潜在的误导性利用方式和供应链攻击风险。

**利用方式：**
根据漏洞描述，该漏洞的利用方式通常涉及以下步骤：

1.  **构造恶意邮件：** 攻击者需要构造一封包含特殊收件人地址的邮件，该地址中嵌入了要执行的命令。具体的构造方式可能涉及对`deliver_message()`函数中收件人地址解析逻辑的分析。
2.  **发送恶意邮件：**  攻击者将构造好的恶意邮件发送到目标Exim服务器。
3.  **触发漏洞：**  当Exim服务器处理该邮件时，由于收件人地址验证不当，会执行嵌入在地址中的命令。
4.  **远程命令执行：**  成功利用漏洞后，攻击者可以在目标服务器上执行任意命令，例如安装后门、窃取敏感数据或进行其他恶意活动。

**项目地址:** [rahmadsandy/EXIM-4.87-CVE-2019-10149](https://github.com/rahmadsandy/EXIM-4.87-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)