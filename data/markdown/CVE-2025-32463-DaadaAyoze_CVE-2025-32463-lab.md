## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，需要sudo命令且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 中一个严重的本地权限提升漏洞，允许本地用户通过 `--chroot` 选项获得 root 权限。漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之间。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞确认为有效，CVSS 评分为 9.3，属于 Critical 级别。多个安全厂商和社区都发布了相关的安全公告和分析文章，证实了该漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码是一个 Docker 环境的搭建，用于复现和测试 CVE-2025-32463 漏洞。该代码主要包含 Dockerfile、docker-compose.yml 等文件，用于构建包含漏洞版本的 Sudo 的容器。虽然该代码本身的目的不是直接的漏洞利用，而是为了方便学习和研究漏洞原理，但仍然存在一定的投毒风险：

1.  **依赖镜像安全：** Dockerfile 中可能依赖一些基础镜像，这些镜像如果被恶意篡改，可能导致构建的容器包含恶意代码。
2.  **构建脚本恶意修改：** 攻击者可能在构建脚本中插入恶意代码，例如安装后门程序、收集敏感信息等。
3.  **诱导执行恶意命令：** README.md 中可能包含诱导用户执行恶意命令的说明，例如使用不安全的配置或参数运行容器。

因此，在使用该漏洞利用代码时，需要仔细检查 Dockerfile 和其他相关文件，确保没有恶意代码，并从可信的来源获取代码。建议仔细审查 `docker-compose up` 命令。因此投毒风险评估为 10%。

**利用方式：**
1.  **用户控制的 /etc/nsswitch.conf：**  漏洞利用的核心在于 Sudo 使用了用户控制的目录中的 `/etc/nsswitch.conf` 文件。通常情况下，`nsswitch.conf` 文件用于配置系统如何查找用户名、密码、组和其他系统信息。通过控制此文件，攻击者可以影响 Sudo 的行为。
2.  **`--chroot` 选项：** `--chroot` 选项用于改变进程的根目录。攻击者可以创建一个包含恶意 `nsswitch.conf` 文件的目录，并使用 `--chroot` 选项将 Sudo 的根目录切换到该目录。
3.  **权限提升：**  通过修改 `nsswitch.conf` 文件，攻击者可以欺骗 Sudo，使其加载恶意的共享库或执行任意代码，从而获得 root 权限。

简单来说，攻击者需要构建一个包含恶意 `nsswitch.conf` 文件的目录，然后使用 `sudo --chroot=/path/to/evil/dir command` 运行 Sudo，从而利用漏洞获得 root 权限。

**项目地址:** [DaadaAyoze/CVE-2025-32463-lab](https://github.com/DaadaAyoze/CVE-2025-32463-lab)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)