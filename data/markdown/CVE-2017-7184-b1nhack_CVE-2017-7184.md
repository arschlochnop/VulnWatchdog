## CVE-2017-7184-Linux Kernel-XFRM heap out-of-bounds access

**漏洞编号:** CVE-2017-7184

**漏洞类型:** Heap out-of-bounds access

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地提权或拒绝服务

**影响版本:** <= 4.10.6

**利用条件:** 需要 CAP_NET_ADMIN capability

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7184 是 Linux 内核 XFRM 模块中的一个堆越界访问漏洞。该漏洞存在于 `xfrm_replay_verify_len` 函数中，由于在处理 `XFRM_MSG_NEWAE` 消息更新后，未正确验证某些大小数据，导致本地用户通过拥有 `CAP_NET_ADMIN` capability 的权限，可能利用此漏洞获得 root 权限或造成拒绝服务（基于堆的越界访问）。

**有效性：**
漏洞库信息和搜索结果表明该漏洞是真实存在的，并且在 Pwn2Own 2017 大赛上已被成功利用。

**投毒风险：**
提供的漏洞利用代码中只包含了一个 MIT 协议的 LICENSE 文件。该许可协议允许任何人使用、复制、修改和分发该软件。因此，在这个代码仓库中，不存在明显的投毒代码。投毒风险为 0%。

**利用方式：**
1.  攻击者需要拥有 `CAP_NET_ADMIN` capability。
2.  攻击者构造一个恶意的 `XFRM_MSG_NEWAE` 消息，其中包含无效的大小数据。
3.  当内核处理该消息时，`xfrm_replay_verify_len` 函数未能正确验证大小数据，导致堆越界访问。
4.  攻击者可以利用堆越界访问，覆盖相邻的堆对象，从而控制内核的执行流程，最终获得 root 权限或造成拒绝服务。

**项目地址:** [b1nhack/CVE-2017-7184](https://github.com/b1nhack/CVE-2017-7184)

**漏洞详情:** [CVE-2017-7184](https://nvd.nist.gov/vuln/detail/CVE-2017-7184)