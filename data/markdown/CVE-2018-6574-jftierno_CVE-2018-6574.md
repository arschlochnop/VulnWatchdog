## CVE-2018-6574-Go-远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 目标机器需要安装受影响版本的Go，并且执行`go get`命令拉取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6574漏洞允许攻击者在`go get`命令执行期间，通过gcc或clang插件功能执行任意命令。攻击者可以创建一个包含恶意C代码的Go项目，该C代码在编译时被执行。 

**漏洞利用方式：**
1.  攻击者创建一个包含`attack.c`和`main.go`的恶意Go项目。
2.  `attack.c`包含将在编译时执行的恶意代码，例如，利用`system`函数执行任意命令。
3.  `main.go`使用`// #cgo CFLAGS: -fplugin=./attack.so`指示Go编译器使用`attack.so`作为gcc/clang插件。
4.  当用户使用`go get`命令下载并构建该恶意项目时，`attack.c`会被编译成`attack.so`，并作为插件加载，其中的恶意代码将被执行。

**有效性：**
提供的PoC代码是有效的。`attack.c`中的`malicious()`函数使用`system()`函数执行命令`/usr/local/bin/score a321915f-37a6-465f-be95-ce9602f6a9e1`。`main.go`中的`// #cgo CFLAGS: -fplugin=./attack.so`指令使得在构建时加载`attack.so`，从而执行恶意代码。

**投毒风险：**
存在一定的投毒风险，风险占比约10%。虽然PoC的主要功能是演示漏洞利用，但攻击者可能在`attack.c`中添加额外的恶意代码，例如，植入后门、窃取敏感信息等。当前的PoC代码中`/usr/local/bin/score a321915f-37a6-465f-be95-ce9602f6a9e1` 命令比较可疑，如果`score` 命令的功能未知，那么存在潜在的风险。 此外攻击者可能在其他地方加入隐蔽的后门代码，增加了投毒的风险，所以评估投毒风险占比为10%。

**项目地址:** [jftierno/CVE-2018-6574](https://github.com/jftierno/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)