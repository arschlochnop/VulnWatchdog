## CVE-2021-41773 - Apache HTTP Server Path Traversal and File Disclosure

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like配置，并允许CGI脚本执行(在RCE场景下)。需要能通过网络访问目标服务器的HTTP服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如URL编码的双点）的URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器同时启用了CGI脚本执行，则攻击者可能进一步利用此漏洞执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码分析，可以确认此漏洞POC的有效性。漏洞库信息明确指出该漏洞已被在野利用。搜索引擎结果中也包含大量关于该漏洞的分析和POC。

**投毒风险：**
提供的代码片段是GNU通用公共许可证的文本，并非实际的漏洞利用代码。因此，无法评估其是否包含恶意代码或投毒风险。投毒的可能性为0%。该漏洞的常见利用方式是通过构造包含`..%2f`或类似编码的URL来绕过路径检查，从而访问服务器上的敏感文件，或者如果开启了CGI，甚至可以执行任意代码。 

**利用方式：**
1.  **路径遍历：** 攻击者构造包含路径遍历字符的URL，例如：`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的`/etc/passwd`文件或其他敏感文件。
2.  **远程代码执行 (RCE):**  如果服务器启用了CGI，攻击者可以将路径遍历与CGI结合，上传恶意CGI脚本，然后通过路径遍历访问该脚本，从而执行任意代码。 例如 `/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh` 

**项目地址:** [MrCl0wnLab/SimplesApachePathTraversal](https://github.com/MrCl0wnLab/SimplesApachePathTraversal)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)