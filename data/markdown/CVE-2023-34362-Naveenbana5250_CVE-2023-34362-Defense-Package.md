## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，未经身份验证的攻击者可以访问数据库，可能导致信息泄露，修改或删除数据库元素，最终实现远程代码执行。

**影响版本:** 所有版本（例如2020.0和2019x）在五个明确提到的版本之前都受到影响，包括较旧的不受支持的版本。具体受影响版本包括：MOVEit Transfer before 2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), and 2023.0.1 (15.0.1)

**利用条件:** 需要MOVEit Transfer应用程序可通过HTTP或HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34362 是 MOVEit Transfer Web应用程序中发现的 SQL 注入漏洞。未经身份验证的攻击者可以利用此漏洞访问 MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可以推断有关数据库结构和内容的信息，并执行SQL语句来更改或删除数据库元素。漏洞利用通常通过构造恶意的 HTTP POST 请求，目标是 `/moveitisapi.dll?action=m2` 接口，并在 `X-siLock-SessVar` header 中注入 SQL 代码。

**有效性：**
根据漏洞描述和已公开的漏洞利用报告，该漏洞的POC代码有效。大量的实际攻击事件也证实了这一点。

**投毒风险：**
提供的代码仓库主要包含防御规则和IOCs。Suricata规则和Sigma规则用于检测SQL注入攻击和Webshell访问，未发现恶意代码。IOCs列表可以帮助安全分析人员识别受影响的系统。虽然主要目的是防御，但仍然存在一定的投毒风险。例如，Suricata 和 Sigma 规则可能存在误报，导致不必要的警报。此外，IOCs 可能不完整或不准确，导致遗漏真正的攻击。综合考虑，投毒风险较低，大约为10%。

**利用方式：**
1.  **SQL 注入：** 攻击者向 `/moveitisapi.dll?action=m2` 发送带有恶意构造的 `X-siLock-SessVar` header 的 HTTP POST 请求，利用SQL注入漏洞。
2.  **Webshell 部署：** 成功利用SQL注入后，攻击者可以部署Webshell（例如 `human2.aspx`），从而实现远程代码执行。
3.  **数据窃取和持久化：** 攻击者使用Webshell窃取敏感数据，并通过创建后门账户等方式实现持久化访问。

**项目地址:** [Naveenbana5250/CVE-2023-34362-Defense-Package](https://github.com/Naveenbana5250/CVE-2023-34362-Defense-Package)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)