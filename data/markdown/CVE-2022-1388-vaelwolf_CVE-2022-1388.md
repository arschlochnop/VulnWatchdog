## CVE-2022-1388-F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本: 16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (低于或等于 12.1.6), 11.6.x (低于或等于 11.6.5)

**利用条件:** 需要网络可达，目标系统开启iControl REST服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞允许未经身份验证的攻击者通过访问`/mgmt/tm/util/bash`端点，利用特制的POST请求绕过iControl REST身份验证并执行任意命令。根据漏洞库信息和搜索引擎结果，这是一个严重漏洞，已被积极利用。POC代码有效，因为它利用了未授权访问`/mgmt/tm/util/bash` URI 的漏洞点，允许执行bash命令。代码中存在tcpdump抓包功能，攻击者能够捕获自身攻击流量，方便分析和检测，但同时也存在被溯源的风险。Reverse Shell代码段会打开目标机器的反向连接，如果被恶意修改，可能会连接到恶意服务器，但是整体代码逻辑较为清晰，投毒风险较低。该脚本提供了执行单个命令或启动交互式shell的选项。投毒风险较低（5%），因为代码相对简单且功能明确，但使用者仍然需要仔细审查代码，以防作者留下后门。

**项目地址:** [vaelwolf/CVE-2022-1388](https://github.com/vaelwolf/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)