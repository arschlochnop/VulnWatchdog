## CVE-2024-4956-Sonatype Nexus Repository Manager-路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问目标Nexus Repository Manager实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造包含特殊字符（例如 `%2F` 和 `..`）的 URL，读取 Nexus Repository Manager 服务器上的任意文件。提供的PoC代码包含 Python 和 Bash 两种实现，都利用了 URL 编码的路径遍历序列来访问目标文件。

**有效性评估：**

根据漏洞描述和搜索引擎结果，该漏洞允许未授权访问系统文件，PoC 代码的目的是通过构造恶意 URL 读取服务器文件。PoC代码给出了Python3和Bash两种利用方式，并且提供了使用示例，验证了其有效性。

**投毒风险评估：**

PoC 代码（`exploitBash.sh` 和 `exploitPython.py`）的主要功能是发送 HTTP GET 请求以利用路径遍历漏洞。代码中没有发现任何尝试执行恶意操作（例如，写入文件、执行命令）的后门或恶意代码。脚本的行为符合漏洞描述，旨在读取指定文件内容。因此，投毒风险评估为 0%。

**利用方式：**

1.  **确定目标Nexus Repository Manager实例的URL和端口：**  例如`http://127.0.0.1:8081`。
2.  **构造包含路径遍历序列的恶意URL：**  PoC代码中使用了`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..{targetFile}`，其中`{targetFile}`是要读取的目标文件的路径。
3.  **发送HTTP GET请求：**  使用PoC代码提供的Python脚本或Bash脚本，指定目标URL、端口和要读取的文件。
4.  **分析响应：**  如果漏洞利用成功，服务器将返回目标文件的内容。如果利用失败，服务器可能会返回错误代码或消息。

**防范措施：**

*   升级到 Sonatype Nexus Repository Manager 3.68.1 或更高版本。
*   参考 Sonatype 官方文档，实施适当的缓解措施。

**项目地址:** [Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager](https://github.com/Praison001/CVE-2024-4956-Sonatype-Nexus-Repository-Manager)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)