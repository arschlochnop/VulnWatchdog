## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)