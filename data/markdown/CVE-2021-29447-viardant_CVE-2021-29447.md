## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露和SSRF

**影响版本:** >= 5.6.0, < 5.7.1

**利用条件:** 需要PHP 8环境，具有上传文件权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是 WordPress 5.6.0 到 5.7.1 版本中存在的一个 XML 外部实体注入 (XXE) 漏洞。该漏洞位于媒体库中，当 WordPress 运行在 PHP 8 环境下时，具有上传文件权限（例如，作者角色）的用户可以通过上传包含恶意 XML 代码的文件（如修改后的音频文件），利用 XML 解析过程中的漏洞读取服务器上的敏感文件或进行服务器端请求伪造 (SSRF) 攻击。

**有效性：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC（https://github.com/0xRar/CVE-2021-29447-PoC）。因此，漏洞利用是有效的。

**投毒风险：** 提供的代码段是GNU通用公共许可证，并非漏洞利用代码本身，因此无法直接评估投毒风险。但是，如果从不可信的来源获取漏洞利用代码，则始终存在投毒风险。由于提供的license文件没有发现任何恶意代码，因此投毒风险判定为0%。

**利用方式：**

1.  攻击者需要具有 WordPress 网站的 Author 或更高权限，即能够上传文件的权限。
2.  攻击者构造包含恶意 XML 实体声明的特殊文件（例如，修改后的 MP3 或 WAV 文件）。该 XML 实体声明指向要读取的本地文件或外部服务器。
3.  攻击者将该恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，XML 解析器会尝试解析外部实体，从而导致读取本地文件或向外部服务器发起请求。
5.  攻击者可以从 WordPress 网站上获取读取的文件内容，或利用 SSRF 漏洞进行进一步攻击。

**项目地址:** [viardant/CVE-2021-29447](https://github.com/viardant/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)