## CVE-2025-29927-Next.js-权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据或执行未授权操作

**影响版本:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**利用条件:** 目标应用使用了受影响版本的Next.js，并且权限校验逻辑位于中间件中，能通过发送带有'x-middleware-subrequest'的请求绕过。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件的一个权限绕过漏洞。漏洞原因是 Next.js 在处理带有 `x-middleware-subrequest` header 的请求时存在缺陷，导致中间件中的权限校验逻辑失效。攻击者可以通过构造带有特定 `x-middleware-subrequest` header 的恶意请求，绕过身份验证和授权，访问原本受保护的资源或执行未授权的操作。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，可以实现权限绕过。

**投毒风险：**
提供的漏洞利用代码是一个 KQL (Kusto Query Language) 查询语句，用于在 Azure Diagnostics 中查找与此漏洞相关的可疑行为。它查找包含特定路径（例如`/api/auth`, `/middleware-bypass`, `/unauthorized-access`）的请求，来自特定IP地址或具有特定用户代理（例如 `curl`, `wget`, `python-requests`）的请求。此代码本身不是漏洞利用代码，而是用于检测攻击的日志分析查询。因此，该代码不包含任何恶意payload，没有投毒风险。

**利用方式：**
1.  攻击者构造一个 HTTP 请求，并在请求头中包含 `x-middleware-subrequest: true` (或其他类似的值)。
2.  攻击者将构造的请求发送到 Next.js 应用。
3.  Next.js 应用的中间件在处理请求时，由于漏洞的影响，无法正确执行权限检查。
4.  攻击者成功绕过权限验证，访问受保护的资源或执行未授权的操作。

总体而言，该漏洞利用方法简单，危害性高，修复方法为升级Next.js至安全版本或过滤包含 `x-middleware-subrequest` header 的外部用户请求。

**项目地址:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)