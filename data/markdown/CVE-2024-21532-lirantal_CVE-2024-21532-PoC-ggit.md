## CVE-2024-21532-ggit-命令注入

**漏洞编号:** CVE-2024-21532

**漏洞类型:** 命令注入

**影响应用:** ggit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.4.12

**利用条件:** 需要能够执行JavaScript代码的环境，并调用受影响的ggit函数。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21532 存在于 ggit 包的所有版本中，这是一个命令注入漏洞。该漏洞位于 `fetchTags(branch)` API 中，它允许用户输入来指定要获取的分支，然后将此字符串与 git 命令连接，并将其传递给不安全的 `exec()` Node.js 子进程 API。利用方式是，攻击者可以通过构造恶意的 branch 参数，注入额外的命令，例如 POC 中使用 `; touch /tmp/3cpo #`，在执行 git 命令的同时执行 `touch /tmp/3cpo`，创建一个文件。由于 `ggit` 包的功能是提供本地 git 命令的封装，因此这个漏洞可能导致远程代码执行，如果攻击者能够控制 `ggit` 的调用参数。

**有效性：**
提供的POC代码有效，可以成功触发命令注入。

**投毒风险：**
此仓库的投毒风险较低，约 5%。 主要理由如下：
*   提供的代码主要是演示漏洞利用，其核心逻辑在于构造恶意的输入参数触发命令注入。
*   没有发现隐藏的、非必要的文件读写、网络请求等可疑行为。
*   但仍然存在轻微的投毒风险，因为攻击者可能稍作修改，将漏洞利用代码伪装成正常功能代码，混淆视听。

**利用方式：**
利用方式是通过控制`fetchTags(branch)`函数的`branch`参数，注入恶意命令。攻击者需要在branch参数中添加`; command #`来实现命令注入。攻击者需要能够控制调用 `fetchTags` 函数时的参数。 该漏洞不需要任何认证信息，是一个远程命令注入漏洞。

**项目地址:** [lirantal/CVE-2024-21532-PoC-ggit](https://github.com/lirantal/CVE-2024-21532-PoC-ggit)

**漏洞详情:** [CVE-2024-21532](https://nvd.nist.gov/vuln/detail/CVE-2024-21532)