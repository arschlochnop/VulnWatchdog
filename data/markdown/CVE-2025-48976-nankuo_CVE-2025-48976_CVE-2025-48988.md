## CVE-2025-48976 Apache Commons FileUpload DoS

**漏洞编号:** CVE-2025-48976

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache Commons FileUpload

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 1.0 before 1.6; 2.0.0-M1 before 2.0.0-M4

**利用条件:** 需要能够向存在漏洞的服务器发送multipart请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞源于Apache Commons FileUpload在处理multipart请求时，对multipart头部资源分配没有做足够的限制。攻击者可以发送包含大量头部信息的multipart请求，导致服务器资源耗尽，从而造成拒绝服务。

**有效性分析：**

提供的POC代码尝试通过发送包含大量分片（100个）以及每个分片包含大量头部（50个，每个1024字节）的multipart请求来触发DoS。代码循环发送这些请求，直到发生异常。
根据漏洞描述，POC代码利用了服务器对multipart头部处理的资源分配不足的缺陷，通过发送大量multipart分片和头部信息，服务器需要分配大量的内存，如果头部数量或大小没有限制, 就会耗尽服务器资源导致拒绝服务。该POC代码大概率是有效的。

**投毒风险分析：**

查看提供的两个文件内容`1.py`和`README.md`，`README.md` 只是简单的描述了`CVE-2025-48976_CVE-2025-48988` 漏洞和POC，并没有任何可疑代码。
查看Python代码 `1.py`,该代码主要功能是构造multipart请求，通过循环发送大量带有大量header分片来复现DoS漏洞。 代码中并没有发现任何执行恶意操作的后门或者恶意代码。因此，该仓库中存在作者隐藏的投毒代码的可能性较低。

**利用方式：**

1.  攻击者构造恶意的multipart请求，请求中包含大量的multipart分片和头部信息。
2.  攻击者将构造的multipart请求发送到存在漏洞的服务器。
3.  服务器在处理multipart请求时，由于对头部资源分配没有足够的限制，会分配大量的内存。
4.  大量的内存分配最终会导致服务器资源耗尽，从而造成拒绝服务。

**项目地址:** [nankuo/CVE-2025-48976_CVE-2025-48988](https://github.com/nankuo/CVE-2025-48976_CVE-2025-48988)

**漏洞详情:** [CVE-2025-48976](https://nvd.nist.gov/vuln/detail/CVE-2025-48976)