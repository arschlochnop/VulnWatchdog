## CVE-2025-32463 Sudo 本地提权漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 严重，本地用户可获取root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 需要本地用户权限，目标系统运行受影响版本的 Sudo

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞允许本地用户利用 Sudo 的 `--chroot` 选项，通过指定用户可控的 `/etc/nsswitch.conf` 文件，来获取 root 权限。漏洞利用代码提供了一个 Dockerfile，用于构建一个包含易受攻击的 Sudo 版本的环境(1.9.16p2)。

**漏洞利用方式：**

1.  **环境准备：** 使用提供的 Dockerfile 构建一个包含存在漏洞的 Sudo 版本的 Docker 镜像。
2.  **利用触发：** 在 Docker 容器中，以普通用户身份运行 PoC 脚本（sudo-chwoot.sh，未提供具体内容）。该脚本利用 Sudo 的 `--chroot` 选项，结合用户控制的 `/etc/nsswitch.conf` 文件，导致权限提升。
3.  **权限提升：** 成功利用后，普通用户可以获得 root 权限。

**有效性评估：**

根据漏洞描述和提供的 Dockerfile，该 PoC 代码是有效的。它提供了一个可复现漏洞的环境，并且漏洞利用方式与漏洞描述相符。

**投毒风险评估：**

*   **Dockerfile 分析：** Dockerfile 主要用于构建漏洞环境，安装必要的依赖，下载并编译存在漏洞的 Sudo 版本，并创建一个普通用户 `pwn`。没有发现明显的恶意行为。
*   **sudo-chwoot.sh 分析：** PoC 脚本内容未知，但根据描述，其主要功能是利用 `--chroot` 选项来触发漏洞。如果脚本被修改为执行恶意代码，则可能存在投毒风险。未提供脚本内容，假设其按照描述实现漏洞利用，则投毒风险较低。
*   **其他文件分析：** LICENSE 和 README.md 文件内容正常，没有发现恶意代码。

综合评估，投毒风险较低，预估为 10%。主要风险点在于 `sudo-chwoot.sh` 脚本可能包含恶意代码，但目前无法确认。

**项目地址:** [ashardev002/CVE-2025-32463_chwoot](https://github.com/ashardev002/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)