## CVE-2018-0114 - Node-jose Library JWT 签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT 签名伪造

**影响应用:** Node-jose Library

**危害等级:** 高危，允许未授权的远程攻击者伪造 JWT 令牌

**影响版本:** < 0.11.0

**利用条件:** 目标系统使用存在漏洞版本的Node-jose库，并且JWT验证逻辑信任内嵌的JWK。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-0114 漏洞存在于 Node-jose 0.11.0 之前的版本中。该漏洞允许攻击者通过在 JWT 头部嵌入一个包含攻击者公钥的 JWK (JSON Web Key) 并使用攻击者私钥重新签名 JWT 来伪造 JWT 令牌。由于 Node-jose 库在验证 JWT 时信任头部中的 JWK，因此攻击者可以绕过签名验证，从而冒充任何用户或获得未授权的访问权限。

**有效性评估：**

根据漏洞描述、搜索引擎结果以及提供的 POC 代码，该漏洞是有效的。POC 代码演示了如何生成 RSA 密钥对，构造包含攻击者公钥的 JWK，将 JWK 嵌入 JWT 头部，并使用攻击者私钥重新签名 JWT。

**投毒风险评估：**

提供的 POC 代码主要功能是生成密钥对，创建包含公钥信息的头部，构造payload，并使用私钥对JWT进行签名。代码中没有发现任何尝试连接外部服务器、执行恶意代码或篡改系统配置的行为。`README.md`文件只是对漏洞的简单描述，也没有包含任何恶意代码。

**利用方式：**

1.  **构造恶意 JWT 头部：**  攻击者生成一个 RSA 密钥对，并将公钥信息（模数 n 和指数 e）以 JWK 的形式添加到 JWT 头部。
2.  **修改 JWT 负载（Payload）：** 攻击者可以修改 JWT 的负载以包含攻击者想要伪造的信息，例如用户名或权限。
3.  **移除原始签名：** 移除 JWT 令牌中原始的签名信息。
4.  **重新签名：**  使用攻击者的私钥对修改后的 JWT 头部和负载进行签名。
5.  **发送恶意 JWT：**  将伪造的 JWT 令牌发送到目标应用程序。由于目标应用程序信任头部中的 JWK，因此会将攻击者伪造的签名视为有效，从而允许攻击者绕过身份验证并获得未授权的访问权限。

**项目地址:** [Starry-lord/CVE-2018-0114](https://github.com/Starry-lord/CVE-2018-0114)

**漏洞详情:** [CVE-2018-0114](https://nvd.nist.gov/vuln/detail/CVE-2018-0114)