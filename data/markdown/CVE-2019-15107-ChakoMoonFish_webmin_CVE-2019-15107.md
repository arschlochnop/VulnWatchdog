## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要目标Webmin开启了 'Password expiry policy set to Prompt users with expired passwords to enter a new one' 选项，且能访问`password_change.cgi`页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107 是Webmin <= 1.920 版本中 password_change.cgi 文件中存在的命令注入漏洞。该漏洞位于 `old` 参数中。根据漏洞利用代码，利用方式如下：

1.  **漏洞条件：** 目标Webmin必须启用了“密码过期策略”，即“Prompt users with expired passwords to enter a new one”。 这是利用此漏洞的前提条件。
2.  **攻击步骤：** 攻击者通过向`password_change.cgi`发送POST请求，并在`old`参数中构造恶意命令。该POST请求包含 `user`、`pam`、`expired`、`old`、`new1`、`new2` 等参数。 其中关键是 `old` 参数，用于注入操作系统命令。
3.  **命令执行：** Webmin服务器收到请求后，由于未对`old`参数进行充分的过滤，导致其中的命令被执行，从而实现远程代码执行。
4.  **利用工具：** 提供的Python脚本`webmin_CVE-2019-15107.py`实现了该漏洞的利用。脚本首先获取目标IP，然后允许用户输入要执行的命令，并将其注入到POST请求的`old`参数中。
5.  **有效性分析：** 搜索引擎结果和漏洞库信息均表明该漏洞存在且高危。提供的POC代码可利用此漏洞。
6.  **投毒风险分析：** 经过对提供的Python脚本进行分析，未发现任何隐藏的恶意代码或后门，因此投毒风险较低，评估为0%。该脚本仅实现了漏洞利用的功能，没有其他恶意行为。

**项目地址:** [ChakoMoonFish/webmin_CVE-2019-15107](https://github.com/ChakoMoonFish/webmin_CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)