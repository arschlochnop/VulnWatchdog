## CVE-2025-56379 - ERPNext/Frappe Stored XSS

**漏洞编号:** CVE-2025-56379

**漏洞类型:** Stored Cross-Site Scripting (XSS)

**影响应用:** ERPNext/Frappe

**危害等级:** 高危，可能导致数据泄露、会话劫持、恶意操作执行和拒绝服务。

**影响版本:** Frappe 15.72.4 / ERPNext 15.67.0

**利用条件:** 需要认证用户，并具有创建/编辑博客文章的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ERPNext/Frappe的博客模块中。攻击者可以利用具有博客文章创建/编辑权限的已认证用户，在博客文章的`content`字段中注入恶意的HTML/JavaScript代码。当其他用户（包括管理员）访问包含恶意代码的博客文章时，这些代码将在他们的浏览器中执行。利用方式如下：

1.  攻击者以具有博客文章创建/编辑权限的用户身份登录ERPNext/Frappe实例。
2.  攻击者导航到博客文章创建/编辑页面（例如`/app/blog-post/<blog_name>`）。
3.  攻击者在`content`字段中插入XSS payload，例如`<img src=x onerror=alert("xss")>`，并保存文章。
4.  当其他用户访问该博客文章时，该payload会在用户的浏览器中执行。

**有效性：** 根据提供的PoC代码，该漏洞是有效的。 PoC 提供了重现步骤，并明确指出能够在受害者浏览器中执行任意脚本。

**投毒风险：** 仓库本身主要包含漏洞描述和PoC代码，直接的恶意代码嵌入风险较低。但仍存在一定风险（大约10%），因为攻击者可能通过以下方式引入投毒：

*   **依赖项投毒：** 虽然未明确提及，但ERPNext和Frappe本身依赖于其他库。攻击者可能通过供应链攻击，篡改这些依赖项，从而间接影响ERPNext/Frappe。
*   **后续代码修改：** 即使初始PoC是干净的，攻击者也可能在稍后的提交中添加恶意代码。

**利用方式：** 该漏洞是一种存储型XSS。攻击者利用博客模块的输入验证不足，将恶意脚本存储在数据库中。当其他用户访问该博客文章时，恶意脚本会从服务器加载并在客户端执行。攻击者可以利用此漏洞执行各种攻击，例如：

*   **窃取敏感信息：** 攻击者可以窃取用户的cookies，从而劫持用户的会话。
*   **执行恶意操作：** 攻击者可以冒充用户执行各种操作，例如更改密码、删除数据等。
*   **传播恶意软件：** 攻击者可以诱导用户下载恶意软件。
*   **拒绝服务：** 攻击者可以注入导致客户端崩溃的脚本，从而导致拒绝服务。

**项目地址:** [MoAlali/CVE-2025-56379](https://github.com/MoAlali/CVE-2025-56379)

**漏洞详情:** [CVE-2025-56379](https://nvd.nist.gov/vuln/detail/CVE-2025-56379)