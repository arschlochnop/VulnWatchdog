## CVE-2023-21768 - Windows Ancillary Function Driver for WinSock Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-21768

**漏洞类型:** 权限提升

**影响应用:** Windows Ancillary Function Driver (AFD)

**危害等级:** 高危，本地权限提升到SYSTEM

**影响版本:** Windows Server 2022 (版本低于 10.0.20348.1487), Windows 11 21H2 (版本低于 10.0.22000.1455), Windows 11 22H2 (版本低于 10.0.22621.1105)

**利用条件:** 需要本地低权限账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21768 是一个Windows AFD驱动中的权限提升漏洞。根据漏洞库信息，攻击者可以利用此漏洞将权限从低权限用户提升到SYSTEM权限。搜索引擎结果显示，该漏洞已被公开披露，并且存在可用的POC。提供的漏洞利用代码包含一个编译后的版本，并在 Windows 11 22H2 22621.963 上进行了测试，并且链接到了原始代码的GitHub仓库（xforcered/Windows_LPE_AFD_CVE-2023-21768）。利用方式是通过向AFD驱动发送精心构造的请求，触发未受信任的指针解引用（CWE-822），从而实现任意代码执行。虽然提供的代码仓库中只有一个README文件和编译后的exe文件，直接运行编译后的文件有一定风险，存在投毒的可能性，但考虑到它引用了另一个代码仓库，且该漏洞已经公开，投毒风险相对较低，约为10%。建议从原始代码仓库编译，或者在虚拟机环境中测试该POC。

**项目地址:** [cl4ym0re/cve-2023-21768-compiled](https://github.com/cl4ym0re/cve-2023-21768-compiled)

**漏洞详情:** [CVE-2023-21768](https://nvd.nist.gov/vuln/detail/CVE-2023-21768)