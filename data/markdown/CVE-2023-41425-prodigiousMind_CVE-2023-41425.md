## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本（XSS）

**影响应用:** WonderCMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 3.2.0 到 3.4.2

**利用条件:** 需要管理员用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 WonderCMS 的模块安装功能中，攻击者可以通过构造恶意的 JavaScript 代码，诱导管理员点击恶意链接，从而在服务器上执行任意代码。

**利用方式：**

1.  攻击者首先需要找到 WonderCMS 实例的登录 URL。
2.  攻击者运行提供的 `exploit.py` 脚本，并提供登录 URL、攻击者的 IP 地址和端口号作为参数。
3.  脚本会生成一个包含恶意 JavaScript 代码的 `xss.js` 文件，同时启动一个 HTTP 服务器来托管该文件，并生成一个包含恶意 XSS 代码的 URL。
4.  攻击者将生成的恶意链接发送给 WonderCMS 的管理员用户。
5.  如果管理员用户点击了这个恶意链接，恶意 JavaScript 代码将在管理员的浏览器中执行。
6.  恶意代码会利用 WonderCMS 的模块安装功能，从攻击者指定的 GitHub 仓库（prodigiousMind/revshell）下载并安装一个名为 `revshell-main` 的主题。
7.  安装完成后，恶意代码会访问 `rev.php` 文件，该文件包含反向 shell 代码。
8.  最后，恶意代码会通过 `rev.php` 文件，连接攻击者指定的 IP 地址和端口，从而在服务器上建立反向 shell 连接，攻击者即可远程控制服务器。

**投毒风险分析：**

该POC中主要的风险在于`revshell-main`这个主题，如果攻击者替换掉这个主题的内容，就可以实现投毒。POC代码本身直接写死了利用的仓库为`https://github.com/prodigiousMind/revshell/archive/refs/heads/main.zip`, 如果作者后续修改了该仓库的内容,则存在一定的投毒风险。目前POC中主要代码都是在客户端执行,可以分析xss.js的内容来判断是否存在后门,但是由于利用了github仓库的主题安装功能，github上的代码如果被修改则有可能会投毒。考虑到作者明确指定了利用的仓库，并且代码逻辑比较清晰，因此投毒的概率较低，评估为10%。

**项目地址:** [prodigiousMind/CVE-2023-41425](https://github.com/prodigiousMind/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)