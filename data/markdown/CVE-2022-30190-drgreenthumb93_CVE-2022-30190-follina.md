## CVE-2022-30190-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许远程代码执行，可完全控制受害者系统

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序（如Word），需要用户交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30190（Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过诱使用户打开恶意构造的Word文档或其他支持URL协议的应用程序来利用此漏洞。该文档会利用Word的远程模板功能从远程Web服务器检索HTML文件，HTML文件中包含恶意的JavaScript代码。该JavaScript代码使用`ms-msdt:` URL协议调用MSDT，并传递恶意的命令参数，导致MSDT执行任意代码。PoC代码通过修改`word\rels\document.xml.rels`文件中的目标IP来指定恶意HTML文件的位置。`bad.html`文件包含大量的填充字符，之后是恶意JavaScript代码。攻击者需要确保在`window.location.href`之前至少有3541个字符，并且这些字符必须在`<script>`标签内。PoC的README提到Windows Defender可能会检测到此漏洞（Trojan:Win32/Mesdetty.D），因此可能需要编辑PoC文件以绕过检测。根据提供的代码和信息，没有发现作者有意添加的投毒代码。

**项目地址:** [drgreenthumb93/CVE-2022-30190-follina](https://github.com/drgreenthumb93/CVE-2022-30190-follina)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)