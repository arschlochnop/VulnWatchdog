## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)