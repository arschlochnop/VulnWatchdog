## CVE-2025-49132-Pterodactyl Panel-远程代码执行

**漏洞编号:** CVE-2025-49132

**漏洞类型:** 远程代码执行

**影响应用:** Pterodactyl Panel

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 1.11.11

**利用条件:** 需要暴露的Redis服务器以及Panel URL，并能获取到Panel的配置信息(APP_KEY, Redis密码等)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49132 漏洞允许未经身份验证的攻击者执行任意代码。攻击者可以通过`locale.json`端点，利用`locale`和`namespace`参数进行攻击。PoC 代码显示了如何利用已知 APP_KEY 来伪造 `pterodactyl_session` cookie，从而绕过身份验证并访问 API。攻击步骤如下：

1.  **获取配置信息：** 首先，需要获取 Pterodactyl Panel 的配置文件，其中包含 APP_KEY 和 Redis 数据库的密码和IP地址。
2.  **伪造 Cookie：** 使用 `forge_cookie.py` 脚本，根据 APP_KEY 和已知的session_id（脚本里是xxxx, 实际应该替换为真实的），生成一个有效的 `pterodactyl_session` cookie。此脚本利用了 Laravel 框架的 cookie 加密机制。
3.  **访问 API：** 使用伪造的 cookie 访问 Pterodactyl API。由于该漏洞允许执行任意代码，攻击者可以获取服务器的访问权限、读取配置信息、从数据库中提取敏感信息或访问服务器管理的文件。

**有效性分析：**
根据漏洞库信息和PoC描述，该漏洞利用链较长，需要泄露redis信息，但是远程代码执行的危害巨大，利用的有效性较高。

**投毒风险分析：**
PoC代码本身的功能是生成cookie和解密cookie,目的是为了访问API，实现远程代码执行，总体代码逻辑清晰，没有发现明显的恶意代码或后门。但是考虑到代码的复杂性和攻击者可以利用该漏洞的严重后果，依然存在一定的投毒风险，例如作者植入隐蔽的后门，利用伪造的cookie访问恶意API，但总体概率较低。
从LICENSE和README来看，作者申明仅用于教育目的，降低了投毒的概率，但是安全无小事，投毒风险依然存在。
综合分析，投毒风险约为10%。

**搜索引擎结果分析：**
搜索结果中存在一些不相关的CVE，例如 CVE-2024-49132 和 CVE-2025-4918。虽然有CVE-2025-49133，CVE-2025-31324，但是与本次的漏洞无关，所以没有过多分析搜索引擎结果。


**项目地址:** [typicalsmc/CVE-2025-49132-PoC](https://github.com/typicalsmc/CVE-2025-49132-PoC)

**漏洞详情:** [CVE-2025-49132](https://nvd.nist.gov/vuln/detail/CVE-2025-49132)