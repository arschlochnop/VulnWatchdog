## CVE-2020-16898-Windows TCP/IP远程代码执行

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行和系统崩溃（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004, Windows Server 2019, Windows Server version 1903, 1909, 2004

**利用条件:** 目标系统需要启用IPv6，且攻击者需要位于与目标系统相同的网络段或能够发送ICMPv6 Router Advertisement 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898是一个Windows TCP/IP栈中的远程代码执行漏洞。当Windows TCP/IP栈不正确地处理ICMPv6 Router Advertisement数据包时，存在此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。 

**利用方式：**

1.  **发送恶意ICMPv6 RA数据包：** 攻击者构造包含特制选项类型25的ICMPv6 Router Advertisement (RA) 数据包。根据搜索引擎返回的信息，该数据包是利用Option Type 25。从PoC代码来看，它使用了类型18和19的选项，并结合了IPv6扩展头部的分片功能。
2.  **触发栈溢出：** 恶意数据包中的错误处理会导致栈溢出。
3.  **远程代码执行或拒绝服务：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码（RCE），或导致系统崩溃（蓝屏）。PoC 代码旨在触发蓝屏死机 (BSOD)，这意味着它主要关注拒绝服务。

**POC代码分析：**

*   该PoC使用`scapy`库来构建和发送ICMPv6数据包。
*   它首先构造一个IPv6头部，设置目标IPv6地址和跳数限制。
*   然后，它创建一个ICMPv6 Router Advertisement数据包。
*   该PoC包含两个ICMPv6NDOptRDNSS选项，用于利用漏洞。第一个数据包设置长度，第二个数据包触发溢出。
*   `overwrite`变量包含用于覆盖堆栈的字符。
*   该PoC使用IPv6分片来绕过某些限制并触发漏洞。
*   最后，它将数据包分片并通过网络发送。

**有效性：**

根据PoC的描述和相关搜索结果，该PoC代码能够触发Windows 10 version 2004的蓝屏死机，表明其具有一定的有效性。PoC代码针对性较强，依赖于特定的payload和触发方式，因此可能在不同版本的Windows上有效性有所不同。漏洞库信息也显示漏洞影响多个Windows版本。

**投毒风险：**

PoC代码中存在投毒的风险较低，约为10%。主要基于以下几点：

*   该代码的目的是触发蓝屏，这本身就是一种破坏行为，但并非隐蔽的后门植入。
*   代码比较清晰，主要由scapy库的调用组成，用于构造和发送网络数据包，功能单一，专注于漏洞利用。
*   虽然可能存在隐藏恶意代码的空间（例如在`overwrite`变量中插入shellcode），但当前PoC并未发现此类行为，主要目的是系统崩溃。
*   README.md文件描述了PoC的目的和测试环境，没有迹象表明作者有意隐藏恶意功能。

然而，仍然存在一定的风险，例如：

*   攻击者可能修改PoC代码，添加恶意功能，例如植入后门，然后传播修改后的PoC。
*   即使是蓝屏攻击也可能被滥用，例如用于勒索或破坏系统。

因此，虽然直接投毒的风险较低，但仍需警惕PoC代码被恶意修改和滥用的可能性。

**项目地址:** [0xeb-bp/cve-2020-16898](https://github.com/0xeb-bp/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)