## CVE-2025-48621-Smart Contract Reentrancy Attack

**漏洞编号:** CVE-2025-48621

**漏洞类型:** 智能合约重入攻击

**影响应用:** 以太坊智能合约 VulnerableBank

**危害等级:** 高危，可能导致资金被盗

**影响版本:** 使用 Solidity ^0.8.0 编译的合约

**利用条件:** 需要部署 VulnerableBank 合约并向其中存入一定数量的 Ether

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该POC代码演示了智能合约中的重入攻击漏洞。VulnerableBank 合约的 withdraw 函数在更新用户余额之前发送 Ether，允许攻击者（Attacker 合约）递归调用 withdraw 函数，从而耗尽 VulnerableBank 合约的 Ether。攻击者首先向 VulnerableBank 合约存入一些 Ether，然后调用 attack 函数触发重入攻击。receive 函数作为回退函数，会递归调用 withdraw 直到合约余额不足。最后调用withdrawFunds函数将资金转移到攻击者的地址。

投毒风险分析：

1.  **License:**  MIT 许可允许修改和分发代码，这本身并不构成投毒，但意味着攻击者可能会利用此代码创建恶意变体。
2.  **README.md:** 描述了重入攻击的原理和PoC的使用方法。虽然详细解释了漏洞利用方式，但代码中可能存在隐蔽的恶意行为。
3.  **VulnerableBank.sol:**  这是一个明确标记为“VulnerableBank”的合约，其代码本身就存在重入漏洞，并非恶意投毒，而是用于演示漏洞。
4.  **Attacker.sol:** 攻击合约利用了 VulnerableBank 合约的漏洞。receive 函数递归调用withdraw，可能存在gas消耗限制的问题，导致攻击失败。此外，withdrawFunds函数中的 `payable(msg.sender).transfer(address(t` 存在截断，缺少了完整的地址，因此存在潜在的攻击失败或者转账到错误地址的风险. 这可能是作者故意留下的陷阱。

总体而言，该PoC的主要目的是演示重入攻击，而非直接投毒。但是Attacker.sol合约中转账代码的不完整性以及可能的gas消耗限制是潜在的风险因素, 需要在使用时进行验证，因此有一定的投毒风险的可能性。


**项目地址:** [Layer1-Artist/POC-CVE-2025-48621](https://github.com/Layer1-Artist/POC-CVE-2025-48621)

**漏洞详情:** [CVE-2025-48621](https://nvd.nist.gov/vuln/detail/CVE-2025-48621)