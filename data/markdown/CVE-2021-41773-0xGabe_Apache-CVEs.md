## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符（如 `%2e`，即 URL 编码的点 `.`）的恶意 URL，绕过服务器配置的 Alias 指令限制，访问服务器上受限目录之外的文件。如果目标服务器同时启用了 CGI 脚本的执行，攻击者还可以通过类似的路径遍历方式，执行任意命令。

**有效性评估：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以判定此漏洞的 POC 代码具有较高的有效性。漏洞库信息明确指出此漏洞已被在野利用，搜索引擎结果也提供了相关的利用案例和分析。POC 代码 `cve-2021-41773.py` 提供了路径遍历读取文件以及远程命令执行两种利用方式，并对 Apache 服务器版本进行了简单的指纹识别。

**投毒风险评估：**

分析提供的 POC 代码，`LICENSE` 文件采用标准的 MIT 许可，`README.md` 文件描述了漏洞和利用方法，`cve-2021-41773.py` 文件实现了漏洞利用。代码逻辑相对简单，主要利用 `urllib` 和 `requests` 库发送 HTTP 请求，没有发现明显的恶意代码或者后门。存在极低的投毒风险，例如细微的编码错误或依赖项问题，因此评估投毒风险为 5%。

**利用方式分析：**

利用方式主要有两种：

1.  **路径遍历文件读取：** 攻击者构造包含 URL 编码的路径遍历字符的 URL，例如 `/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试读取服务器上的敏感文件。POC 代码中的 `pathTraversal` 函数实现了该功能。

2.  **远程命令执行：**  攻击者利用路径遍历漏洞访问 CGI 脚本目录，并向该目录下的 `sh` (或其他 shell 解释器) 传递要执行的命令。POC 代码中的 `remoteCommandExecution` 函数模拟了这一过程，构造包含命令的 POST 请求，发送到目标服务器。注意，利用此方法需要目标服务器配置允许执行 CGI 脚本。

**项目地址:** [0xGabe/Apache-CVEs](https://github.com/0xGabe/Apache-CVEs)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)