## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户信息泄露和恶意脚本执行

**影响版本:** <= 7.2.0

**利用条件:** 需要用户访问恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212 漏洞存在于 OURPHP 7.2.0 及更早版本中，是一个反射型跨站脚本漏洞。该漏洞位于 `/client/manage/ourphp_out.php` 文件。攻击者可以通过构造包含恶意 JavaScript 代码的 URL 参数（例如 `ourphp_admin=logout&out=<script>alert(`xss`)</script>`）并诱骗用户点击，从而在用户浏览器中执行恶意脚本，窃取用户 cookie 或执行其他恶意操作。

**有效性分析：**
提供的 POC 代码指向 `/client/manage/ourphp_out.php`，且 URL 中包含恶意脚本，符合 CVE 描述。搜索引擎结果中也有关于该漏洞的验证和利用的讨论，包括 Docker 环境搭建，表明该漏洞可以被成功利用。

**投毒风险分析：**
提供的代码主要为Docker环境搭建说明和漏洞利用的URL，并没有发现明显的恶意投毒代码。GRANT ALL PRIVILEGES ON . TO ' user account'@'localhost' IDENTIFIED BY 'user password' WITH GRANT OPTION;  只是一种数据库配置的说明，如果直接应用到生产环境，会有风险，但是该代码本身是为了搭建POC环境。虽然存在一些潜在的风险，例如利用Docker环境传播恶意软件，但直接在提供的代码中添加后门的概率较低，因此投毒风险评估为 10%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 URL。例如：`http://localhost:8080/client/manage/ourphp_out.php?ourphp_admin=logout&out=<script>alert(`xss`)</script>`
2.  攻击者将此 URL 发送给目标用户。
3.  如果目标用户点击该 URL，恶意 JavaScript 代码将在用户的浏览器中执行。
4.  攻击者可以利用执行的 JavaScript 代码窃取用户 Cookie、重定向用户到恶意网站或者进行其他恶意操作。

**项目地址:** [libasmon/-create-a-vulnerable-Docker-environment-that-is-susceptible-to-CVE-2023-30212](https://github.com/libasmon/-create-a-vulnerable-Docker-environment-that-is-susceptible-to-CVE-2023-30212)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)