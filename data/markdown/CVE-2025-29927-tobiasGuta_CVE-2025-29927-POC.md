## CVE-2025-29927-Next.js-中间件认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** < 14.2.25, < 15.2.3

**利用条件:** 应用程序使用Next.js中间件进行身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927是一个Next.js中间件认证绕过漏洞。攻击者可以通过在请求头中添加`x-middleware-subrequest: middleware`来绕过中间件的身份验证。根据漏洞库信息，受影响的版本包括Next.js 11.1.4 到 13.5.6，大于 14.0.0 小于 14.2.25, 大于 15.0.0 小于 15.2.3。搜索引擎结果显示该漏洞已公开，并有多个安全厂商进行了分析。提供的漏洞利用代码是一个Nuclei模板，它通过发送带有恶意header的GET请求来检测漏洞。如果服务器返回200状态码，且响应内容包含"Protected Page Content"，则表示漏洞存在。该POC的有效性较高，因为它直接利用了漏洞的根本原因（即`x-middleware-subrequest`头的处理不当）。

**关于投毒风险：**
查看POC代码，该仓库主要包含一个YAML格式的Nuclei模板和一个README.md文件。Nuclei模板定义了漏洞的检测逻辑，即发送带有`x-middleware-subrequest`头的HTTP请求并验证响应。README.md文件提供了漏洞的描述和使用说明。整个代码库的功能集中于漏洞的检测，没有发现任何可疑的或后门代码。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标识别:** 确定目标Next.js应用程序是否使用了中间件进行身份验证，且版本是否在受影响范围内。
2.  **构造请求:** 构造一个HTTP GET请求，并在请求头中添加`x-middleware-subrequest: middleware`。
3.  **发送请求:** 将构造好的请求发送到目标应用程序。
4.  **验证结果:** 如果目标应用程序返回未经授权的页面的内容（例如，本应需要登录才能访问的页面），则表示漏洞利用成功。

**项目地址:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)