## CVE-2020-36847-Simple File List-RCE

**漏洞编号:** CVE-2020-36847

**漏洞类型:** 远程代码执行

**影响应用:** Simple File List

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.2.3

**利用条件:** Simple File List插件版本低于4.2.3，并且允许文件上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Simple File List插件中，允许未经身份验证的攻击者通过上传恶意文件（伪装成图片）并使用重命名功能将其扩展名更改为.php来执行任意代码。  

**利用方式：**
1.  上传一个包含PHP代码的文件，该文件伪装成PNG图片 (例如 `pwn.png`)。
2.  利用插件的`ee-file-engine.php`接口的重命名功能，将上传的文件从`pwn.png` 重命名为 `pwn.php`。
3.  访问重命名后的PHP文件，执行其中的恶意代码。

**有效性：**
POC代码有效，能够利用漏洞实现RCE。漏洞库信息、搜索引擎结果和POC代码均证实了该漏洞的存在和利用方式。

**投毒风险：**
POC代码中可能存在投毒风险，风险占比10%。主要体现在以下几点：
1.  虽然作者声明代码仅用于学习和研究，但免责声明不能完全排除恶意使用的可能性。
2.  POC代码使用`requests`库，存在中间人攻击的风险。攻击者可能篡改`requests`库，从而执行恶意代码。
3.  默认情况下，不验证SSL证书 ( `verify=False` )，这使得攻击更容易实施。
4.  虽然代码看起来直观，但攻击者可能会在代码中添加不易察觉的恶意功能，例如秘密上传webshell或窃取敏感信息。
5.  作者的联系方式表明他/她可能参与了其他恶意活动，虽然这不能直接证明POC代码有毒，但增加了这种可能性。

尽管存在上述风险，但从代码本身来看，并没有明显的恶意行为，例如下载和执行其他文件，或者尝试进行横向移动等。因此，投毒风险评估为较低（10%）。


**项目地址:** [137f/PoC-CVE-2020-36847-WordPress-Plugin-4.2.2-RCE](https://github.com/137f/PoC-CVE-2020-36847-WordPress-Plugin-4.2.2-RCE)

**漏洞详情:** [CVE-2020-36847](https://nvd.nist.gov/vuln/detail/CVE-2020-36847)