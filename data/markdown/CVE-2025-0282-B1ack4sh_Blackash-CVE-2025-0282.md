## CVE-2025-0282-Ivanti Connect Secure-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要目标系统开启HTTPS(443端口)，且存在漏洞版本的Ivanti Connect Secure等产品。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 中的一个栈溢出漏洞。攻击者可以通过发送特制的HTTP请求利用该漏洞，实现在目标系统上执行任意代码。根据搜索引擎结果和漏洞库信息，该漏洞已被积极利用。

**有效性:**
提供的Python POC代码尝试利用栈溢出漏洞。代码首先创建带有shell命令的恶意payload,然后通过HTTPS连接发送POST请求到 `/dana-na/auth/url_default/welcome.cgi` 接口。利用成功与否取决于payload的偏移量(offset)、system函数地址(system_address)和命令地址(command_address)是否正确，以及目标环境是否符合漏洞触发条件。 根据CISA KEV信息,该漏洞已被积极利用，因此提供的POC具有一定的有效性。

**投毒风险:**
代码中存在一定的投毒风险，尽管整体上实现的功能是利用漏洞上传webshell并执行命令，但仍有一些地方可能被利用执行恶意操作：
*   **默认参数:**  `offset=500, system_address=0x0804a360, command_address=0x0804b008` 这些硬编码的地址如果直接使用在不匹配的系统上，可能导致拒绝服务或者crash，从而干扰分析和利用。
*   **webshell上传和权限:** 上传webshell `/shell.php`本身就是一个高风险操作，如果攻击者控制了目标，webshell可以被用于长期控制和横向移动。
*   **利用痕迹清理:** 代码包含删除日志（`remove_log_entries`）和禁用更新（`disable_updates`）等操作，虽然看起来是消除利用痕迹，但也可能被滥用，例如阻止系统更新安全补丁。

综合来看，投毒风险主要来自于POC使用中可能存在的恶意利用，以及一些默认参数可能导致的不稳定行为。 因此，将投毒风险评估为 10%。

**利用方式:**
1.  **构建Payload:**  `create_exploit_payload` 函数用于构建溢出payload，该payload覆盖返回地址，使其跳转到`system()` 函数，并将执行的命令作为参数传递给`system()`。
2.  **发送请求:**  `send_payload` 函数通过 HTTPS 连接发送包含恶意payload的POST请求到目标系统的特定URI (`/dana-na/auth/url_default/welcome.cgi`)。
3.  **远程代码执行:** 如果漏洞利用成功，`system()`函数将执行payload中嵌入的命令，从而实现远程代码执行。
4.  **webshell上传和利用:**  通过`upload_web_shell`函数上传一个webshell，然后通过`execute_shell_command`函数执行任意命令。
5.  **持久化和隐藏:** 通过修改系统配置、删除日志等方式尝试在目标系统上建立持久存在，并隐藏攻击痕迹。 

**项目地址:** [B1ack4sh/Blackash-CVE-2025-0282](https://github.com/B1ack4sh/Blackash-CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)