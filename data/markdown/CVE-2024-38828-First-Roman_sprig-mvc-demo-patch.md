## CVE-2024-38828 - Spring MVC @RequestBody byte[] DoS

**漏洞编号:** CVE-2024-38828

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Spring Framework

**危害等级:** 中危，可能导致服务不可用

**影响版本:** < 5.3.42

**利用条件:** 需要网络访问，目标应用使用了Spring MVC，且存在接收 @RequestBody byte[] 参数的Controller方法。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38828 漏洞存在于 Spring Framework 中，具体是当 Spring MVC Controller 方法使用 `@RequestBody byte[]` 作为参数时，未经合理限制的请求体大小可能导致服务器资源耗尽，从而引发拒绝服务攻击。

**有效性:**
根据提供的漏洞库信息和搜索结果，该漏洞的POC是有效的。多个来源确认了此漏洞的存在，并描述了利用方式。

**利用方式:**
攻击者可以通过发送大量数据或构造特殊的数据包到使用了 `@RequestBody byte[]` 参数的 Controller 方法，导致服务器内存溢出或CPU资源耗尽，从而使服务不可用。POC代码尝试通过自定义转换器限制上传大小来缓解此问题，但未涉及Servlet超时设置和优化 multipart/form-data 处理，可能无法完全防御该漏洞。

**投毒风险:**
POC代码包含一个自定义的 `ByteArrayConverter`，该转换器尝试限制接收到的字节数组的大小。虽然这个转换器本身是为了缓解 DoS 漏洞，但是如果攻击者找到绕过该限制的方法，或者该转换器存在其他缺陷，可能会被利用。例如，如果限制大小的逻辑存在错误，可能导致程序崩溃或其他不可预测的行为。此外，README提到，为完全覆盖该漏洞需要安装 servlet 超时，如果用户未安装，则可能存在部分风险。POM.xml中使用的是spring-boot-starter-parent 2.3.3.RELEASE版本，存在一定的安全风险，因为该版本比较老旧。所以评估投毒风险为10%。

**项目地址:** [First-Roman/sprig-mvc-demo-patch](https://github.com/First-Roman/sprig-mvc-demo-patch)

**漏洞详情:** [CVE-2024-38828](https://nvd.nist.gov/vuln/detail/CVE-2024-38828)