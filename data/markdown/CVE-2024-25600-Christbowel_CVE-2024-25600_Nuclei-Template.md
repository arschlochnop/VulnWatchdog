## CVE-2024-25600 - WordPress Bricks Builder RCE

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WordPress Bricks Builder

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.9.6

**利用条件:** Bricks Builder插件版本小于等于1.9.6，并且服务器允许执行PHP代码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600 是一个存在于 WordPress Bricks Builder 插件中的未经身份验证的远程代码执行漏洞。攻击者可以利用此漏洞在受影响的服务器上执行任意代码，从而完全控制该服务器。

**有效性：**
提供的 Nuclei YAML 模板是有效的，可以用来检测和利用该漏洞。模板通过发送特制的 HTTP 请求到 `/wp-json/bricks/v1/render_element` 端点，利用了插件对用户输入的不当处理，实现了代码注入。

**投毒风险：**
虽然提供的 Nuclei 模板本身似乎没有明显的投毒代码，但仍然存在一定的风险。Nuclei 模板通过执行 `curl {{interactsh-url}}`来验证漏洞，如果攻击者控制了 interactsh 服务，他们可能会记录目标服务器的信息。此外，任何允许远程代码执行的漏洞利用都存在潜在的风险，即在成功利用后，攻击者可能会植入恶意代码。代码中唯一的风险是与 interactsh 服务的潜在交互，但其主要目的是验证漏洞，而非直接植入后门。

**利用方式：**
1.  **获取Nonce值：** 首先，攻击者发送一个 GET 请求到目标网站的主页，用于后续请求中需要提供的nonce值。
2.  **发送恶意POST请求：** 攻击者构造一个恶意的 POST 请求到 `/wp-json/bricks/v1/render_element` 端点。该请求的 body 中包含一个 JSON 对象，其中包含了要注入的 PHP 代码。通过 `queryEditor` 参数，攻击者可以插入任意 PHP 代码。
3.  **代码执行：** 当 Bricks Builder 插件处理该请求时，它会执行攻击者注入的 PHP 代码。在提供的POC中，第一种方法是执行系统命令`id`。第二种方法是使用 `curl {{interactsh-url}}`，通过与 interactsh 服务的交互来确认漏洞是否存在。

简而言之，攻击者通过精心构造包含恶意 PHP 代码的 POST 请求，利用 Bricks Builder 插件的代码注入漏洞，最终实现远程代码执行。

**参考链接：**
*   [https://nvd.nist.gov/vuln/detail/CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)
*   [https://github.com/K3ysTr0K3R/CVE-2024-25600-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2024-25600-EXPLOIT)
*   [https://github.com/Chocapikk/CVE-2024-25600](https://github.com/Chocapikk/CVE-2024-25600)

**项目地址:** [Christbowel/CVE-2024-25600_Nuclei-Template](https://github.com/Christbowel/CVE-2024-25600_Nuclei-Template)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)