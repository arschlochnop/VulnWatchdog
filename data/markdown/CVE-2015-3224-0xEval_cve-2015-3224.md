## CVE-2015-3224 Ruby on Rails Web Console IP Whitelist Bypass

**漏洞编号:** CVE-2015-3224

**漏洞类型:** IP Whitelist Bypass

**影响应用:** Ruby on Rails Web Console

**危害等级:** 高危，可能导致远程代码执行（RCE）

**影响版本:** Web Console < 2.1.3, Ruby on Rails 3.x/4.x

**利用条件:** 需要目标系统运行存在漏洞版本的Web Console，且攻击者能够发送带有恶意构造的X-Forwarded-For头的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3224 漏洞存在于 Ruby on Rails Web Console 中，由于 `request.rb` 文件没有正确限制 X-Forwarded-For 头的使用，导致攻击者可以通过构造恶意的 X-Forwarded-For 头绕过 IP 白名单验证。攻击者可以通过操纵 X-Forwarded-For 头，将恶意 IP 地址添加到请求中，从而欺骗 Web Console 允许未经授权的访问，进一步可能导致远程代码执行。提供的漏洞利用代码是一个GPL v3的license文件, 不包含任何可执行代码，因此可以认为不存在投毒风险。

**利用方式：**

1.  攻击者发送 HTTP 请求到存在漏洞的 Ruby on Rails 应用。
2.  在请求头中，攻击者添加或修改 `X-Forwarded-For` 头，包含一个或多个伪造的 IP 地址，其中至少包含一个被 Web Console 信任的 IP 地址（例如，白名单中的地址），以及攻击者想要使用的恶意 IP 地址。
3.  Web Console 在检查客户端 IP 地址时，错误地信任了 X-Forwarded-For 头中的恶意 IP 地址。
4.  攻击者绕过 IP 白名单的限制，可以执行 Web Console 提供的调试功能，包括执行任意 Ruby 代码，导致远程代码执行（RCE）。

**项目地址:** [0xEval/cve-2015-3224](https://github.com/0xEval/cve-2015-3224)

**漏洞详情:** [CVE-2015-3224](https://nvd.nist.gov/vuln/detail/CVE-2015-3224)