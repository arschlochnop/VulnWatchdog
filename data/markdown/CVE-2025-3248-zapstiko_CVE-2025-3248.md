## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <= 1.2.0

**利用条件:** 目标服务器运行Langflow并且能通过网络访问其/api/v1/validate/code接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞评估：**

CVE-2025-3248是Langflow中一个严重的安全漏洞，允许未经身份验证的远程攻击者执行任意代码。漏洞存在于`/api/v1/validate/code`接口，版本低于1.3.0的Langflow受到影响。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞是真实存在的，并且已经有公开的PoC。搜索引擎结果显示，该漏洞已经被积极利用，用于传播Flodrix僵尸网络，这进一步表明了该漏洞的有效性。漏洞利用代码中的`LangflowExploit` 类实现了利用漏洞的关键步骤，构造包含恶意代码的JSON payload，并发送到目标服务器的 `/api/v1/validate/code`接口。服务器会执行payload中的代码，导致RCE。

**投毒风险：**

漏洞利用代码主要功能是发送恶意请求利用漏洞，但在代码中存在一些潜在的风险：

*   **依赖风险：** 代码依赖`requests`和`colorama`库。 虽然这些库本身是常用的，但如果这些库的安装源被篡改，则存在引入恶意依赖的风险，虽然这个风险很低。

*   **代码审查难度：** exploit 使用了`exec`函数。虽然`exec`是漏洞利用的必要部分，但是也容易被利用于隐藏其他恶意代码。

*   **作者可信度：** 虽然作者在代码中署名，但无法完全保证作者的意图是完全良性的。

综合来看，代码本身的功能符合漏洞利用的需求，但考虑到以上风险，投毒的可能性不能排除。综合评估，判定投毒风险为10%。

**利用方式：**

利用方式主要分为以下几个步骤：

1.  **目标确定：** 确定运行Langflow的服务器，并且版本低于1.3.0。
2.  **发送恶意请求：** 使用PoC脚本，构造包含恶意Python代码的JSON payload，发送到目标服务器的`/api/v1/validate/code`接口。
3.  **命令执行：** Langflow服务器在接收到恶意payload后，会执行其中的Python代码，从而实现远程命令执行。
4.  **结果获取：** PoC脚本会尝试获取命令执行的结果并输出。

总而言之，漏洞利用非常简单，只需要发送一个精心构造的HTTP POST请求即可实现远程命令执行。

**项目地址:** [zapstiko/CVE-2025-3248](https://github.com/zapstiko/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)