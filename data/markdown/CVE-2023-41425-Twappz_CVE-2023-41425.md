## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** WonderCMS

**危害等级:** 高危，可导致远程代码执行 (RCE)

**影响版本:** 3.2.0 <= version <= 3.4.2

**利用条件:** 需要目标WonderCMS实例运行于受影响版本，且攻击者能够通过网络访问该实例。需要用户访问恶意构造的链接或页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425 是一个存在于 WonderCMS v3.2.0 到 v3.4.2 版本的跨站脚本漏洞，攻击者可以通过上传包含恶意脚本的模块来触发此漏洞，从而导致远程代码执行。根据漏洞利用代码，攻击者首先需要找到 WonderCMS 的登录页面，然后利用 XSS 漏洞上传一个恶意模块。此模块实际上是一个PHP反向shell。该漏洞利用代码通过构造特定的 URL，诱使用户点击，从而触发 XSS。XSS代码从指定的remote-host下载包含反向shell的zip文件（默认地址为github的zip压缩包），然后安装，最后通过访问安装的反向shell，从而执行任意代码。虽然默认的 zip 文件地址指向一个 github 仓库，但攻击者可以指定任意远程主机托管恶意 zip 文件，存在一定的投毒风险。投毒风险主要来自两个方面：一是攻击者可以替换 revshell-main/rev.php 中的反向 shell 代码，植入恶意代码；二是攻击者可以替换压缩包里的其他文件，达到恶意目的。 该漏洞利用代码中的XSS利用部分相对简单，是将恶意JS代码注入到页面中。Poison Risk是10%，主要考虑到默认情况下，脚本会从Github下载一个预定义的revshell，这个revshell本身可能是安全的，但攻击者修改下载链接到他们自己的恶意payload，这是一个潜在的风险。

**项目地址:** [Twappz/CVE-2023-41425](https://github.com/Twappz/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)