## CVE-2022-24434-dicer-DoS

**漏洞编号:** CVE-2022-24434

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** dicer

**危害等级:** 高危，可能导致服务中断

**影响版本:** <= 0.3.1 (根据PoC)

**利用条件:** 需要网络访问，目标服务使用dicer处理multipart/form-data请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-24434 漏洞存在于 dicer npm 包中，允许攻击者通过发送特制的 multipart/form-data 请求造成拒绝服务。根据漏洞库信息和搜索引擎结果，该漏洞的根本原因是 dicer 在解析不完整的或畸形的 HTTP 头部时，由于未正确处理异常，导致程序崩溃。

**POC 有效性：** 提供的 PoC 代码针对 dicer v0.3.1 版本，包含多个测试用例，覆盖了不同的畸形 multipart/form-data 结构，包括未闭合的 part、格式错误的 boundary、空的 body 和不正确的行尾符等。这些测试用例旨在触发 dicer 的解析错误，从而验证漏洞的存在。PoC 代码的有效性取决于目标服务器是否使用了存在漏洞的 dicer 版本，以及 PoC 的请求是否能够到达目标服务器并被 dicer 处理。

**投毒风险：** PoC 代码主要由 `dicer_poc.js` 和 `server.js` 组成。`dicer_poc.js` 用于发送恶意请求，`server.js` 模拟一个存在漏洞的服务器。虽然 `server.js` 看起来无害，主要用于演示目的，但仍然存在微小的投毒风险。

- 风险分析：`server.js` 引入了 `dicer` 和 `node-fetch` 两个依赖项。虽然 PoC 本身是为了利用 `dicer` 的漏洞，但恶意作者可能会修改 `server.js`，添加后门或恶意逻辑。例如，记录所有收到的请求数据，然后将其发送到外部服务器。或者，在特定条件下执行恶意代码。尽管这种可能性很小，但依然存在。

- 评估： 考虑到 PoC 的目标是拒绝服务，添加复杂的后门会增加 PoC 的复杂性和被发现的风险，因此实际投毒的可能性较低。此外，readme中包含了免责声明。

**利用方式：**

1.  攻击者构造一个包含畸形或不完整的 multipart/form-data 数据的 HTTP POST 请求。
2.  将该请求发送到使用 dicer 处理 multipart/form-data 的服务器。
3.  dicer 在解析该请求时，由于漏洞未修复，会触发未处理的异常。
4.  Node.js 进程崩溃，导致拒绝服务。
5.  攻击者可以重复发送恶意请求，持续攻击目标服务器。

**项目地址:** [nayankadamm/CVE-2022-24434_POC](https://github.com/nayankadamm/CVE-2022-24434_POC)

**漏洞详情:** [CVE-2022-24434](https://nvd.nist.gov/vuln/detail/CVE-2022-24434)