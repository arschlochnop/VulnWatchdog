## CVE-2017-7921 Hikvision Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** Improper Authentication

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升，获取敏感信息，远程代码执行（取决于具体配置）

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的固件版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是一个Hikvision摄像头的身份验证绕过漏洞。攻击者可以未经授权访问摄像头的敏感信息，甚至可以修改摄像头的配置。

**有效性：**
提供的POC代码看起来是有效的。它利用了CVE-2017-7921漏洞，允许攻击者下载和解密配置文件（包含管理员密码），下载图像，并将图像转换为视频。利用代码包括使用`openssl`解密配置文件的功能，这表明该漏洞可能允许未经身份验证地访问配置文件。 搜索引擎结果也表明存在可用的EXP，进一步佐证了有效性。

**投毒风险：**
虽然代码的功能与漏洞描述相符，且包含必要的警告信息，但仍然存在一定的投毒风险。 主要风险点在于：
1.  **依赖包安全：** 脚本依赖多个第三方Python库（requests, opencv-python, numpy, scikit-image）。如果这些库被恶意篡改（供应链攻击），可能会导致执行恶意代码。虽然`requirements.txt`文件本身没有直接的投毒代码，但不能保证这些库在PyPI上的安全性。
2.  **外部命令执行：** 脚本使用`openssl`命令进行解密。如果系统上的`openssl`命令被替换为恶意程序，可能导致安全问题。
3.  **`find_user_credentials` 函数：** 虽然代码片段不完整，但其目标是从解密数据中提取用户名和密码。 如果此过程设计不当，可能会引入漏洞或为后续攻击铺平道路。

综合来看，投毒风险较低，大概为10%。因为POC代码主要依赖已知漏洞和标准库，没有明显的恶意代码。 但是，使用者仍然需要谨慎，确保依赖项的安全性，并仔细审查代码。

**利用方式：**
1.  **配置信息泄露：** 攻击者使用脚本下载并解密摄像头的配置文件，获取管理员密码。
2.  **图像抓取：** 攻击者可以连续下载摄像头的图像，进行监视或收集证据。
3.  **视频生成：** 攻击者可以将下载的图像转换为视频，方便查看和分析。
4.  **权限提升：** 通过泄露的管理员密码，攻击者可以登录摄像头并获得管理员权限，从而完全控制摄像头。

**项目地址:** [GabrielAvls/CVE-2017-7921](https://github.com/GabrielAvls/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)