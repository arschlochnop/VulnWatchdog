## CVE-2025-31161 - CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.0.0 <= version < 10.8.4 和 11.0.0 <= version < 11.3.1

**利用条件:** 目标CrushFTP服务器未部署DMZ代理，并且HTTP(S)端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码 (CVE-2025-2825.yaml)，可以评估此漏洞利用的有效性并分析利用方式。首先，CVE-2025-31161 允许未经身份验证的攻击者绕过身份验证，接管 crushadmin 帐户，从而完全控制 CrushFTP 服务器。提供的漏洞利用代码针对 CVE-2025-2825，虽然编号不同，但描述和影响的组件与 CVE-2025-31161 相同，根据securityweek.com的描述，这两个CVE针对的是同一个漏洞。该漏洞利用代码通过发送特制的 HTTP 请求，利用 AWS4-HMAC 认证过程中的缺陷。具体来说，通过在 Authorization 头部中只提供用户名（例如 crushadmin/）来绕过身份验证。服务器在验证用户存在时，会因为缺少 SignedHeaders 条目而发生 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以指定用户身份进行身份验证。该漏洞利用代码通过发送包含恶意 Authorization 头的 GET 请求来尝试获取用户列表，以此验证身份绕过是否成功。如果返回的 XML 包含 crushadmin 用户，则表明身份绕过成功。

**有效性：**根据多个信息来源表明，该漏洞已被积极利用，且漏洞利用代码能够有效绕过身份验证。提供的漏洞利用代码通过构造特定的HTTP请求，模拟未经授权的身份验证过程，从而验证目标是否存在漏洞。因此，该POC有效。

**投毒风险：** 在提供的漏洞利用代码中，没有明显的投毒代码。该YAML文件定义了HTTP请求的结构和匹配规则，没有发现任何执行恶意操作的后门或隐藏指令。所以，投毒风险为0%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者向目标 CrushFTP 服务器发送特制的 HTTP 请求。
2.  该请求的 Authorization 头部包含 AWS4-HMAC-SHA256 Credential，但只包含用户名，例如 crushadmin/。
3.  由于服务器代码中的缺陷，攻击者可以绕过身份验证。
4.  攻击者可以执行管理员操作，例如获取用户列表，甚至接管整个服务器。

**排序优先级说明：**
在此次分析中，搜索引擎结果提供了关于漏洞已被利用的证据，以及受影响服务器的大致数量，优先级较高。漏洞利用代码本身提供了漏洞利用的技术细节，其次是漏洞库信息，它提供了漏洞的基本描述和受影响的版本信息。

**项目地址:** [SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825](https://github.com/SUPRAAA-1337/Nuclei_CVE-2025-31161_CVE-2025-2825)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)