## CVE-2025-28915-ThemeEgg ToolKit-任意文件上传

**漏洞编号:** CVE-2025-28915

**漏洞类型:** 任意文件上传

**影响应用:** ThemeEgg ToolKit

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.2.9

**利用条件:** 需要WordPress后台具有themes.php权限的用户

**POC 可用性:** 是

**投毒风险:** 90%

## 详情

CVE-2025-28915 存在于 WordPress ThemeEgg ToolKit 插件 1.2.9 及之前版本中。该漏洞允许经过身份验证的具有足够权限的用户（如管理员）上传任意文件，包括 Web Shell。漏洞利用方式如下：

1.  **身份验证:** 首先，攻击者需要使用有效的用户名和密码登录 WordPress 后台。
2.  **获取 Nonce:** 登录后，攻击者访问主题设置页面（`themes.php?page=themeegg-toolkit`），从中提取安全 nonce 值。这个 nonce 用于绕过一些安全检查。
3.  **文件上传:** 攻击者构造一个 POST 请求，将包含恶意代码的 PHP 文件（Web Shell）上传到 `admin-ajax.php` 端点。请求中包含 action 参数 (`TETK_import_demo_data`)、security 参数（nonce 值）以及 customizer_file 参数（包含 PHP Web Shell 的文件）。
4.  **代码执行:** 成功上传后，攻击者可以通过访问上传的文件来执行任意代码。POC 中建议访问 `/wp-content/uploads/2025/03/shell.php?cmd=id` 来测试 Web Shell 是否正常工作。

**有效性：** 提供的 POC 代码是有效的，它演示了如何利用该漏洞上传 Web Shell 并执行命令。

**投毒风险：** POC 代码存在较高的投毒风险。 恶意攻击者可以修改 shell_code 的内容，例如添加后门、恶意链接或篡改网站内容，从而在用户不知情的情况下执行恶意操作。此外，直接将用户名密码写在代码中，如果代码被泄露，会导致网站被恶意控制。

**项目地址:** [Pei4AN/CVE-2025-28915](https://github.com/Pei4AN/CVE-2025-28915)

**漏洞详情:** [CVE-2025-28915](https://nvd.nist.gov/vuln/detail/CVE-2025-28915)