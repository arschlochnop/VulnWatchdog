## CVE-2021-42694-Unicode 欺骗

**漏洞编号:** CVE-2021-42694

**漏洞类型:** Unicode 欺骗/Trojan Source

**影响应用:** 多种编程语言/Unicode 标准

**危害等级:** 高危，可能导致代码注入和供应链攻击

**影响版本:** <= Unicode 14.0

**利用条件:** 需要目标代码编辑器/编译器支持 Unicode 且未做相应安全限制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-42694 漏洞源于 Unicode 标准允许使用视觉上相似但实际不同的字符（同形字/homoglyphs）创建标识符。攻击者可以利用这一点，在源代码中创建与现有函数或变量名称相似的恶意标识符，从而欺骗代码审查者和开发者，将恶意代码注入到项目中。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（实际上只是 Apache License），该漏洞是有效的。搜索引擎结果表明该漏洞已经被广泛讨论，并且存在公开的 PoC 代码（参见 [webpage 6]）。虽然提供的代码不是漏洞利用代码，但是通过搜索引擎结果，我们可以确认漏洞利用代码的存在性。

**投毒风险：**

提供的代码本身是 Apache License，并非漏洞利用代码，因此不存在直接的投毒代码。但是，根据漏洞的性质，攻击者可以通过在开源项目中提交包含恶意 Unicode 字符的代码来实施供应链投毒攻击。审查者很难发现这些视觉上与正常代码相同的恶意代码。 由于提供的license代码中不包含任何可执行的代码或恶意内容, 因此投毒风险评估为0%。

**利用方式：**

利用方式主要包括以下步骤：

1.  **选择目标：** 选择一个开源项目或者依赖库作为攻击目标。
2.  **创建恶意代码：** 使用 Unicode 同形字或者双向文本覆盖字符创建视觉上与正常代码相似的恶意代码，例如，创建一个与 `authenticate()` 函数名称相似但实际执行恶意操作的 `аuthentісаtе()` 函数(使用了西里尔字母'а'代替了拉丁字母'a')。
3.  **提交恶意代码：** 将包含恶意代码的补丁或者提交合并到目标项目中。
4.  **等待传播：** 等待恶意代码被其他开发者使用，从而扩大攻击范围。

**缓解措施：**

*   使用支持 Unicode 安全机制的代码编辑器和编译器。
*   对代码进行严格的代码审查，注意检查是否存在 Unicode 欺骗字符。
*   使用静态分析工具来检测 Unicode 欺骗字符。
*   限制项目中使用 Unicode 字符。
*   升级到修复了此漏洞的软件版本。

**项目地址:** [k271266/CVE-2021-42694](https://github.com/k271266/CVE-2021-42694)

**漏洞详情:** [CVE-2021-42694](https://nvd.nist.gov/vuln/detail/CVE-2021-42694)