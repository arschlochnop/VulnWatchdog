## CVE-2020-16012-Chrome-侧信道信息泄露

**漏洞编号:** CVE-2020-16012

**漏洞类型:** 侧信道信息泄露

**影响应用:** Chrome

**危害等级:** 中危，可能导致跨域数据泄露

**影响版本:** < 87.0.4280.66

**利用条件:** 需要用户访问恶意构造的HTML页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16012 是 Google Chrome 浏览器中存在的一个侧信道信息泄露漏洞。该漏洞存在于图形处理过程中，允许远程攻击者通过精心设计的 HTML 页面泄露跨域数据。

**有效性评估：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了指向GitHub存储库的链接，该存储库专门用于演示此漏洞，并提供了可用于测量操作定时的基准测试代码，以及一个利用此漏洞来恢复跨域图像轮廓的利用示例。Mozilla Attack & Defense 博客上有一篇关于此漏洞的详细文章，进一步证实了其有效性。

**投毒风险分析：**

提供的代码主要由基准测试代码 (`benchmark/benchmark.html`, `benchmark/chromium.tsv`) 和利用示例组成 (`exploit` 目录，未提供完整代码)。基准测试代码用于测量 `drawImage()` 函数的执行时间，利用示例则利用该时间差异来推断图像信息。目前看来，主要的风险在于利用代码的复杂性和潜在的恶意修改。例如，攻击者可能会修改 `exploit` 目录下的代码（如果提供的话）以收集其他敏感信息，或者创建更具破坏性的攻击。在 `benchmark/benchmark.html` 中，虽然没有发现明显的恶意代码，但如果攻击者修改了该文件，将其部署在用户浏览器中，并收集用户的基准测试数据，也可能存在隐私风险。总的来说，虽然直接的投毒代码并不明显，但修改和重新利用代码的风险仍然存在，大约评估投毒风险为10%。

**利用方式分析：**

1.  **漏洞原理：** 该漏洞利用了 `CanvasRenderingContext2D.drawImage()` 函数在处理不同内容时的时间差异。通过测量绘制不同内容的图像所需的时间，攻击者可以推断出有关图像内容的信息。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意 JavaScript 代码的 HTML 页面。
    *   该 JavaScript 代码使用 `drawImage()` 函数绘制跨域图像。
    *   通过 `performance.now()` 等 API 测量 `drawImage()` 函数的执行时间。
    *   根据执行时间的差异，推断出图像的内容，例如图像的轮廓或颜色分布。
    *   将推断出的信息发送到攻击者的服务器。
3.  **攻击场景：** 攻击者可以将恶意 HTML 页面托管在自己的服务器上，并通过社交工程等手段诱骗用户访问该页面。当用户使用受影响的 Chrome 浏览器访问该页面时，攻击者就可以利用该漏洞泄露用户的跨域数据。

**项目地址:** [aleksejspopovs/cve-2020-16012](https://github.com/aleksejspopovs/cve-2020-16012)

**漏洞详情:** [CVE-2020-16012](https://nvd.nist.gov/vuln/detail/CVE-2020-16012)