## CVE-2019-10078-Apache JSPWiki-XSS

**漏洞编号:** CVE-2019-10078

**漏洞类型:** XSS

**影响应用:** Apache JSPWiki

**危害等级:** 中危，可能导致会话劫持

**影响版本:** 2.9.0 to 2.11.0.M3

**利用条件:** 需要能够修改或创建JSPWiki页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10078 是 Apache JSPWiki 2.9.0 到 2.11.0.M3 版本中的一个跨站脚本 (XSS) 漏洞。根据漏洞描述，精心构造的插件链接调用可以触发此漏洞，从而导致会话劫持。最初的报告指出 ReferredPagesPlugin 是存在漏洞的插件，但进一步的分析表明多个插件都存在漏洞。 

**有效性：** 从漏洞描述和搜索结果来看，该漏洞确实存在，并且可以通过构造恶意的插件链接来触发。提供的“漏洞利用代码”实际上是ChangeLog，记录了修复此漏洞的相关提交信息，以及其他一些更新和修复。ChangeLog提到了[JSPWIKI-1109] ReferredPagesPlugin with illegal characters in parameters causes XSS vulnerability 和 [JSPWIKI-1107] Fixing XSS vulnerability in various plugins. 可见XSS漏洞存在于多个插件中，通过非法字符构造参数触发。因此，可以通过构造包含恶意JavaScript代码的插件链接来利用此漏洞。

**投毒风险：** 提供的ChangeLog信息本身不包含任何可以直接执行的代码，因此不存在直接的“投毒”代码。ChangeLog 仅仅是记录了漏洞修复的流程以及开发者信息，但仍然存在潜在风险，例如，攻击者可以利用ChangeLog中的信息，伪装成开发者提交恶意代码，或者利用开发者的身份信息进行社会工程学攻击。所以说存在一定的风险，但风险较低。

**利用方式：** 攻击者需要构造一个包含恶意JavaScript代码的特殊链接或插件调用，然后诱骗用户点击该链接，或者将包含恶意代码的页面发布到JSPWiki上。当用户访问包含恶意代码的页面时，恶意脚本将在用户的浏览器中执行，攻击者可以利用该脚本窃取用户的会话cookie，从而劫持用户的会话。


**项目地址:** [shoucheng3/apache__jspwiki_CVE-2019-10078_2_11_0_M4_fixed](https://github.com/shoucheng3/apache__jspwiki_CVE-2019-10078_2_11_0_M4_fixed)

**漏洞详情:** [CVE-2019-10078](https://nvd.nist.gov/vuln/detail/CVE-2019-10078)