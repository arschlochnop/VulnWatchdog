## CVE-2024-36991 - Splunk Enterprise on Windows 路径遍历漏洞

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**利用条件:** Splunk Enterprise 部署在Windows服务器上，且目标版本受影响。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-36991 是 Splunk Enterprise on Windows 版本中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造恶意的URL，读取服务器上的任意文件，包括配置文件、密码文件等敏感信息。漏洞位于 `/modules/messaging/` 端点。\n\n**有效性分析：**\n根据搜索引擎结果（如webpage 5和8）以及提供的POC代码，该漏洞的POC已经公开，并且可以成功利用。多个安全厂商和研究人员证实了该漏洞的存在和利用方式。POC代码通过构造包含`C:../`的URL，绕过路径限制，读取指定文件。\n\n**投毒风险分析：**\n阅读了POC代码，此代码的主要功能是发送HTTP请求以利用路径遍历漏洞。代码本身相对简单，主要执行以下操作：\n1.  定义了颜色代码，用于控制台输出显示效果。\n2.  包含了一个简单的参数解析器，用于接收目标URL和要读取的文件路径。\n3.  `make_request` 函数用于发送GET请求。\n4.  `check_if_target_is_vulnerable` 函数用于检测目标是否存在漏洞，通过读取`/etc/passwd`文件来判断。\n5.  `exploit` 函数用于利用漏洞，读取指定的文件。\n\n代码中没有发现明显的恶意代码或后门。但是，任何代码都存在潜在的风险，例如：\n*   该脚本的设计用途是漏洞利用，本身具有一定的攻击性。\n*   攻击者可能修改此脚本，添加恶意功能，例如数据回传、植入后门等。\n\n考虑到以上风险，将投毒风险评定为5%。主要是因为该代码的潜在恶意使用，而非代码本身存在后门。\n\n**利用方式分析：**\n1.  攻击者需要知道目标 Splunk Enterprise 服务器的URL。\n2.  攻击者需要构造包含路径遍历字符的URL，例如：`http://example.com:8000/en_us/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`。根据是否读取系统文件，payload中`C:../`的数量会有所不同。\n3.  攻击者发送构造好的HTTP GET请求。\n4.  如果目标服务器存在漏洞，且用户权限足够，服务器将返回指定文件的内容。

**项目地址:** [gunzf0x/CVE-2024-36991](https://github.com/gunzf0x/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)