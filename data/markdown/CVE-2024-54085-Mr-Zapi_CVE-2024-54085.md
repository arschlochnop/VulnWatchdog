## CVE-2024-54085 - AMI MegaRAC SPx Redfish 认证绕过

**漏洞编号:** CVE-2024-54085

**漏洞类型:** 认证绕过

**影响应用:** AMI MegaRAC SPx

**危害等级:** 高危，可能导致服务器完全控制，包括远程代码执行、固件修改和物理损坏

**影响版本:** MegaRAC SPx 12.0-12.7, 13.0-13.5

**利用条件:** 目标服务器需要运行受影响版本的AMI MegaRAC SPx，并且Redfish接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-54085 允许未经身份验证的远程攻击者通过 Redfish Host Interface 绕过身份验证，从而获得对 BMC 的完全控制权。根据提供的 POC 代码，利用方式是攻击者构造一个恶意的 POST 请求，通过修改 HTTP Header `X-Server-Addr` 绕过认证，在目标服务器上创建一个新的管理员账户。虽然POC本身目的是创建管理员账号，但恶意使用者也可以修改固件或执行其他恶意操作。该仓库存在轻微的投毒风险，原因是POC代码中使用了硬编码的用户名(`pwned2`)和密码(`password123`)。如果攻击者直接使用此POC，可能会被安全人员检测到。虽然是默认密码降低安全性，但是也可以认为是轻微的投毒，降低POC的有效性，增加被发现的概率。

根据CISA的已知被利用漏洞目录，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **发送恶意请求：** 攻击者发送特制的 POST 请求到受影响的 Redfish 接口，请求中包含 `X-Server-Addr` 头，以及用于创建新管理员账户的 JSON 数据。
2.  **绕过身份验证：** `X-Server-Addr`头允许攻击者绕过正常的身份验证机制。
3.  **创建管理员账户：**  成功绕过身份验证后，攻击者可以在 BMC 上创建一个具有管理员权限的新账户。
4.  **完全控制：**  使用新创建的管理员账户，攻击者可以完全控制 BMC，执行包括远程重启、固件修改和恶意软件部署等操作。

**项目地址:** [Mr-Zapi/CVE-2024-54085](https://github.com/Mr-Zapi/CVE-2024-54085)

**漏洞详情:** [CVE-2024-54085](https://nvd.nist.gov/vuln/detail/CVE-2024-54085)