## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制受影响的Exchange服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要OWA或ECP的访问权限，并且已知ValidationKey和DecryptionKey。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是一个Microsoft Exchange Server中的远程代码执行漏洞。该漏洞是由于Exchange在安装时未能正确创建唯一的密钥导致的，攻击者可以利用已知的ValidationKey和DecryptionKey对ViewState进行反序列化，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（GUI工具），可以判断该漏洞的POC代码是有效的。搜索引擎结果中多次提及该漏洞被野外利用，并且存在公开的POC和利用工具。

**投毒风险：**

分析提供的POC代码，主要是一个Visual Studio解决方案，包含C# GUI界面，用于简化漏洞利用过程，可以执行命令或加载shellcode。

*   **CVE-2020-0688-GUI.sln, CVE-2020-0688-GUI.csproj:** 正常的项目文件，定义了项目结构和依赖项。
*   **README.md:** 描述了项目目的、使用方法和作者信息。正常。
*   **App.xaml, App.xaml.cs:** 应用程序入口点和相关逻辑。正常。
*   **AssemblyInfo.cs:** 程序集信息。正常。
*   **资源文件:** 包含logo.ico和profile.png。正常。

总体来看，提供的代码主要是为了方便利用该漏洞，但并不能完全排除投毒的风险。可能存在的风险点在于：

1.  **Shellcode加载功能:** 如果攻击者提供包含恶意功能的shellcode，那么GUI工具仅仅是提供了一个执行的载体。用户如果使用了不可信来源的shellcode，则存在被攻击的风险。
2. **作者本身**：作者可能在编译好的二进制文件中加入恶意代码，但从提供的源码来看，没有发现明显的恶意代码。GUI工具本身的存在也可能误导使用者进行未授权的渗透测试，从而导致法律风险。

因此，投毒风险评估为10%。

**利用方式：**

利用CVE-2020-0688漏洞的典型方式如下：

1.  **获取ValidationKey和DecryptionKey：** 这是利用该漏洞的首要条件。可以通过多种方式获取，例如通过不安全的配置管理或密钥泄露。
2.  **构造恶意ViewState：** 攻击者使用已知的密钥构造恶意的ViewState，其中包含要执行的命令或shellcode。
3.  **发送请求：** 将构造的ViewState作为请求的一部分（通常是针对OWA或ECP）发送到目标Exchange服务器。
4.  **远程代码执行：** Exchange服务器在处理请求时，会反序列化ViewState，从而执行攻击者预先设定的代码。

**项目地址:** [W01fh4cker/CVE-2020-0688-GUI](https://github.com/W01fh4cker/CVE-2020-0688-GUI)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)