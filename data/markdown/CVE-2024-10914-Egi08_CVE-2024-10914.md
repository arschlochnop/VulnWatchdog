## CVE-2024-10914-D-Link NAS-OS命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS命令注入

**影响应用:** D-Link DNS-320/DNS-320LW/DNS-325/DNS-340L

**危害等级:** 高危，可能导致远程代码执行和设备控制

**影响版本:** <= 20241028

**利用条件:** 需要网络访问目标设备的Web管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10914 是 D-Link NAS 设备中 account_mgr.cgi 文件的 cgi_user_add 函数存在的操作系统命令注入漏洞。攻击者可以通过操纵 `name` 参数，在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码通过 Burp Suite 手动测试验证漏洞，描述清晰，步骤详细，可有效验证漏洞的存在。

**投毒风险评估：**

该 POC 主要提供的是漏洞验证方法，而非直接可执行的后门代码。虽然提供了执行命令的示例，但风险在于使用者是否会植入恶意命令，风险评估为较低，占比10%。

**利用方式：**

1.  **查找目标：** 使用 FOFA 或 Shodan 等搜索引擎，利用提供的 dork 搜索易受攻击的 D-Link NAS 设备。
2.  **拦截请求：** 使用 Burp Suite 拦截发往 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 的 HTTP 请求。
3.  **注入命令：** 修改 `name` 参数，插入恶意命令。例如，`name=%27;id;%27` 会执行 `id` 命令。
4.  **分析响应：** 检查服务器响应，确认命令是否成功执行。如果成功，响应中会包含命令的输出。
5.  **自动化（可选）：** 使用 Burp Suite Intruder 工具批量测试不同的命令。

**风险提示：**

利用此漏洞可能导致未经授权的远程代码执行，从而完全控制受影响的 D-Link NAS 设备。请在授权环境下进行测试，避免非法入侵他人设备。

根据搜索结果，存在大量暴露在公网上的脆弱设备，且厂商可能不会提供修复补丁，因此该漏洞利用价值较高，请务必加强安全防范。

**项目地址:** [Egi08/CVE-2024-10914](https://github.com/Egi08/CVE-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)