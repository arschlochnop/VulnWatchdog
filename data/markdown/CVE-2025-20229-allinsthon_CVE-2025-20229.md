## CVE-2025-20229-Splunk-RCE

**漏洞编号:** CVE-2025-20229

**漏洞类型:** 远程代码执行

**影响应用:** Splunk Enterprise/Cloud Platform

**危害等级:** 高危，可完全控制受影响的Splunk实例

**影响版本:** Splunk Enterprise (低于 9.3.3, 9.2.5, 9.1.8); Splunk Cloud Platform (低于 9.3.2408.104, 9.2.2406.108, 9.2.2403.114, 9.1.2312.208)

**利用条件:** 需要低权限Splunk账户的有效认证Token

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-20229 存在于 Splunk Enterprise 和 Splunk Cloud Platform 中，允许低权限用户通过上传文件到 `$SPLUNK_HOME/var/run/splunk/apptemp` 目录来执行远程代码。漏洞原因是缺少授权检查。

**有效性评估：**
根据漏洞信息和搜索结果，此漏洞是一个高危的 RCE 漏洞，并且已经有公开的POC。提供的POC代码看起来完整，描述了利用步骤，包括安装依赖，执行脚本，以及必要的参数 (target_url, malicious_file, auth_token)。因此，POC 有效的可能性较高。

**投毒风险分析：**
POC 代码的 `README.md` 文件中包含了一个指向 `https://tinyurl.com/2ct2kp73` 的短链接。这个短链接是潜在的风险点。虽然说明文件中没有直接展示恶意代码，但该链接可能重定向到包含恶意代码的资源，例如，下载一个被篡改过的exploit脚本，或者连接到一个恶意服务器。因此，需要非常谨慎对待。 投毒的风险评估为80%，这是因为链接不可信，同时此链接没有放到代码中而是放到了readme中。

**利用方式：**
1.  攻击者需要一个低权限的 Splunk 账户，获取该账户的有效认证Token。
2.  攻击者准备一个恶意的可执行文件 (例如，`malicious.sh`)，该文件包含攻击者想要在目标系统上执行的命令。
3.  攻击者使用提供的 exploit 脚本，指定目标 Splunk 实例的 URL，恶意文件路径，以及认证 token。
4.  Exploit 脚本会将恶意文件上传到 `$SPLUNK_HOME/var/run/splunk/apptemp` 目录。
5.  由于漏洞存在，Splunk 没有正确地进行授权检查，上传的文件可以被执行，导致远程代码执行。


**项目地址:** [allinsthon/CVE-2025-20229](https://github.com/allinsthon/CVE-2025-20229)

**漏洞详情:** [CVE-2025-20229](https://nvd.nist.gov/vuln/detail/CVE-2025-20229)