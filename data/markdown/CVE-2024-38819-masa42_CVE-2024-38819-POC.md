## CVE-2024-38819-SpringFramework-路径遍历

**漏洞编号:** CVE-2024-38819

**漏洞类型:** 路径遍历

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** Spring Framework 5.3.0 - 5.3.40, 6.0.0 - 6.0.24, 6.1.0 - 6.1.13

**利用条件:** 应用程序使用WebMvc.fn或WebFlux.fn提供静态资源，且使用了类似软链接或符号链接的配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38819是Spring Framework中一个路径遍历漏洞，影响使用WebMvc.fn或WebFlux.fn来提供静态资源的应用程序。攻击者可以通过构造包含`../`的恶意HTTP请求，绕过访问控制，读取服务器上任意文件。

**有效性：**
提供的PoC代码是有效的，它演示了如何利用该漏洞读取`/etc/passwd`文件。PoC通过创建一个符号链接，并结合URL编码的`../`来实现路径遍历。

**投毒风险：**
该PoC代码的主要功能是演示漏洞利用，没有发现恶意代码，如反弹shell、植入后门等。代码结构清晰，功能单一。因此，投毒风险评估为0%。

**利用方式：**
1.  应用程序必须使用Spring Framework，并且使用WebMvc.fn或WebFlux.fn来提供静态资源。
2.  应用程序需要存在类似Dockerfile中`RUN ln -s /static /app/static/link`的软链接配置。如果应用程序直接使用`FileSystemResource`来映射静态资源目录，那么攻击可能会失败。
3.  攻击者构造包含`../`的HTTP请求，例如：`curl http://localhost:8080/static/link/%2e%2e/etc/passwd`。其中`%2e%2e`是`../`的URL编码，用于绕过一些过滤。
4.  服务器解析请求中的路径，由于符号链接的存在，攻击者可以跳出静态资源目录，访问服务器上的其他文件。
5.  成功利用漏洞后，攻击者可以读取服务器上的任意文件，例如配置文件、密钥等，从而获取敏感信息。

**项目地址:** [masa42/CVE-2024-38819-POC](https://github.com/masa42/CVE-2024-38819-POC)

**漏洞详情:** [CVE-2024-38819](https://nvd.nist.gov/vuln/detail/CVE-2024-38819)