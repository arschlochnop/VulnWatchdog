## CVE-2024-21754-FortiOS/FortiProxy-密码哈希漏洞

**漏洞编号:** CVE-2024-21754

**漏洞类型:** 密码哈希算法强度不足

**影响应用:** FortiOS/FortiProxy

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** FortiOS: <= 7.4.3, 7.2 所有版本, 7.0 所有版本, 6.4 所有版本; FortiProxy: <= 7.4.2, 7.2 所有版本, 7.0 所有版本, 2.0 所有版本

**利用条件:** 需要目标系统存在受影响的版本，攻击者需具有超级管理员权限和CLI访问权限。

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2024-21754 存在于 FortiOS 和 FortiProxy 中，是由于使用的密码哈希算法的计算强度不足引起的。攻击者利用此漏洞需要具备超级管理员权限以及 CLI 访问权限，才能解密备份文件，从而获取敏感信息。漏洞利用代码的README.md文件给出了利用方法，显示了运行指令， 但EXP的下载地址是`https://tinyurl.com/yfamk3mc`, 高度怀疑存在投毒代码, 从github中提供的图片来看,攻击方式为通过CLI执行命令。

**有效性评估：**
从漏洞描述和利用代码来看，该漏洞利用的有效性较高，如果满足利用条件（超级管理员权限和 CLI 访问权限），攻击者可以解密备份文件。

**投毒风险评估：**
从 README.md 文件提供的exploit下载链接来看，使用了短链接 `tinyurl.com`, 这存在很高的投毒风险。因为无法直接确定短链接指向的文件的安全性，攻击者可能在其中植入恶意代码，例如后门程序。即使初始漏洞利用成功，后续也可能被植入的后门控制系统。因此，投毒风险非常高，估计为 80%。

**利用方式：**
1.  攻击者需要获得目标 FortiOS 或 FortiProxy 系统的超级管理员权限。
2.  攻击者需要通过 CLI 访问目标系统。
3.  攻击者使用 exploit 下载链接获取exp, 并且执行。
4.  利用exp执行命令，如果备份文件解密成功，攻击者可以从中提取敏感信息。

**项目地址:** [hacktidexp/CVE-2024-21754-FORTI-RCE](https://github.com/hacktidexp/CVE-2024-21754-FORTI-RCE)

**漏洞详情:** [CVE-2024-21754](https://nvd.nist.gov/vuln/detail/CVE-2024-21754)