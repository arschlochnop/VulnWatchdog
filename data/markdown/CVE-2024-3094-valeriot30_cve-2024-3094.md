## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极高危，可能导致SSH认证绕过，远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，并且sshd链接了被篡改的liblzma

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 描述了在 XZ Utils 5.6.0 和 5.6.1 版本中发现的恶意代码。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中，从源代码中伪装的测试文件中提取预构建的目标文件，用于修改 liblzma 的特定函数。受影响的 liblzma 库随后会被链接到其他软件，例如 sshd，从而拦截和修改与其交互的数据。这可能导致 SSH 认证绕过，使得攻击者可以在未经授权的情况下访问系统。 

**有效性：** 根据漏洞库信息和搜索结果，此漏洞影响 XZ Utils 的特定版本，并已经确认存在后门。提供的 POC 代码是一个 README.md 文件，仅用于描述项目目的，本身不包含漏洞利用代码。因此，提供的POC代码本身无效，但CVE-2024-3094漏洞本身是有效的。

**投毒风险：**提供的 POC 代码（README.md）主要用于描述该漏洞，本身不包含任何可执行代码或恶意payload。因此，文件本身不存在投毒风险。但是，从供应链攻击的角度来看，整个事件本身就是一种投毒行为，开发者在XZ Utils的构建过程中植入了恶意代码。因此，从这个角度看，存在极高的投毒风险。
这个风险评估是基于对提供的信息（README.md）的分析。恶意作者可能在仓库的其他地方隐藏了恶意代码，但是仅凭此文件无法确定。总体上，认为存在一定潜在风险，比例为10%。

**利用方式：**
1.  **供应链攻击：** 攻击者首先需要获得对 XZ Utils 项目的贡献权限，或者通过某种方式提交恶意代码到官方仓库。
2.  **代码注入：** 恶意代码通过一系列复杂的混淆手段被隐藏在源代码中，并在构建过程中被提取和执行。
3.  **liblzma 篡改：** 恶意代码修改 liblzma 库，使其能够拦截和修改 sshd 的数据。
4.  **SSH 认证绕过：** 被篡改的 liblzma 库允许攻击者绕过 SSH 认证，从而远程访问系统。

综上所述，CVE-2024-3094 是一种严重的供应链攻击，利用方式复杂，影响范围广。需要立即采取措施来检测和移除受感染的 XZ Utils 版本。

**项目地址:** [valeriot30/cve-2024-3094](https://github.com/valeriot30/cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)