## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution (RCE)

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件或执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。该漏洞源于对路径规范化的更改，使得攻击者可以使用路径遍历攻击将URL映射到Alias-like指令配置的目录之外的文件。如果这些目录之外的文件没有受到默认配置"require all denied"的保护，请求可能会成功。如果CGI脚本对这些别名路径启用，则可能导致远程代码执行。

**利用方式：**
攻击者可以构造包含编码后的路径遍历字符（例如`.%2e`）的HTTP请求，绕过服务器的安全检查，访问服务器文件系统上的任意文件。如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意脚本并执行来实现远程代码执行。

**有效性：**
提供的PoC代码`exploit.sh`看起来是有效的。它使用`curl`命令发送包含路径遍历序列的请求，并尝试执行指定的命令。Dockerfile和httpd-path-traversal.conf文件配置了一个易受攻击的Apache服务器环境，用于测试路径遍历。

**投毒风险：**
检查提供的文件，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/README.md`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/exploit.sh`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/Dockerfile`，`/tmp/59e48ccb9412bd5b9a153d1926dd8eca/Path Traversal/httpd-path-traversal.conf`。这些文件看起来主要用于演示和利用CVE-2021-41773漏洞。其中，`exploit.sh`脚本存在一定的风险，攻击者可以利用此脚本执行恶意命令。`httpd-path-traversal.conf` 配置，如果被攻击者修改，会导致服务器存在后门，但是从目前的代码来看，投毒风险较低。只有 `exploit.sh`存在可被利用的风险，但这不是作者主动投毒，所以投毒风险很低。

**项目地址:** [dileepdkumar/LayarKacaSiber-CVE-2021-41773](https://github.com/dileepdkumar/LayarKacaSiber-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)