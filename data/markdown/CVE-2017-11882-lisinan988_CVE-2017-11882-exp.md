## CVE-2017-11882-Microsoft Office Memory Corruption Vulnerability

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存破坏漏洞

**影响应用:** Microsoft Office

**危害等级:** 高危，远程代码执行

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 用户需要打开恶意的Office文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-11882 是一个 Microsoft Office 的内存破坏漏洞，存在于 Equation Editor 中。攻击者可以利用此漏洞在当前用户的上下文中执行任意代码。从漏洞库信息和搜索结果来看，该漏洞被广泛利用，并且即使在发布多年后仍然活跃。提供的POC代码是一个Python脚本，用于生成包含恶意Equation Editor对象的RTF文档。该脚本通过构造特定的`objdata`字段，利用Equation Editor的漏洞执行命令。由于提供的POC代码只是一个利用脚本，用于生成恶意文档，并没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。

**漏洞利用方式：**

1.  **构造恶意RTF文档：** 使用提供的Python脚本（或其他类似的工具）生成包含特制的Equation Editor对象的RTF文档。关键在于`objdata`字段，它包含用于触发漏洞和执行Payload的恶意数据。
2.  **诱骗用户打开文档：** 将恶意RTF文档发送给目标用户，并诱骗他们使用受影响的Microsoft Office版本打开文档。
3.  **执行Payload：** 当用户打开文档时，Equation Editor会尝试解析`objdata`中的数据，由于存在内存破坏漏洞，恶意Payload会被执行。Payload通常包含执行任意命令的shellcode，例如下载并执行恶意程序。

从搜索结果来看，此漏洞经常被用于传播恶意软件，例如Agent Tesla、Infostealer等。攻击者通常会将恶意RTF文档伪装成看似无害的文件，例如发票、合同等，通过电子邮件或其他方式发送给目标用户。

**项目地址:** [lisinan988/CVE-2017-11882-exp](https://github.com/lisinan988/CVE-2017-11882-exp)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)