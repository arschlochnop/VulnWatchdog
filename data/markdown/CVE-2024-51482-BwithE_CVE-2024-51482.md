## CVE-2024-51482 - ZoneMinder Boolean-based SQL 注入

**漏洞编号:** CVE-2024-51482

**漏洞类型:** SQL 注入

**影响应用:** ZoneMinder

**危害等级:** 高危，可能导致数据泄露和系统控制

**影响版本:** v1.37.* <= 1.37.64

**利用条件:** 需要具有较低权限的用户账户才能进行利用

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2024-51482 存在于 ZoneMinder v1.37.* <= 1.37.64 的 web/ajax/event.php 函数中，是一个基于布尔的 SQL 注入漏洞。漏洞利用代码 (poc.py) 通过发送特制的 HTTP 请求，利用 SQL 注入漏洞从数据库中提取敏感信息，如用户名和密码哈希。从代码分析来看，poc.py主要功能是利用boolean-based SQL注入来枚举数据库、表和列，然后dump数据。代码本身没有明显的恶意行为，例如修改系统文件或执行恶意命令。但是，由于该脚本能够提取数据库信息，恶意攻击者可能利用提取的信息进行进一步的攻击。风险主要在于使用者的恶意使用，而非代码本身存在后门。风险评估主要依据以下几点：

1.  **有效性：** 根据提供的漏洞信息和漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出该漏洞是 Boolean-based SQL 注入，并且提供了受影响的版本范围。搜索结果中的多个网页也确认了该漏洞的存在以及其可能造成的严重后果，例如数据泄露和潜在的系统控制。

2.  **投毒风险：** 代码没有明显的投毒特征。主要是利用 SQL 注入读取数据，没发现明显的后门代码。

3.  **利用方式：** 攻击者通过构造恶意的 SQL 查询，利用 web/ajax/event.php 中的 tagId 参数注入点。通过 Boolean-based SQL 注入，攻击者可以逐位猜测数据库中的信息。POC 代码演示了如何枚举数据库名称、表名和列名，并最终提取用户凭据。默认情况下，该脚本尝试从 'zm' 数据库的 'Users' 表中提取 'Username' 和 'Password' 列。

总而言之，此漏洞的利用方式是标准的 Boolean-based SQL 注入，利用有效，但投毒风险较低，主要风险在于被恶意使用者利用。

**项目地址:** [BwithE/CVE-2024-51482](https://github.com/BwithE/CVE-2024-51482)

**漏洞详情:** [CVE-2024-51482](https://nvd.nist.gov/vuln/detail/CVE-2024-51482)