## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)