## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)