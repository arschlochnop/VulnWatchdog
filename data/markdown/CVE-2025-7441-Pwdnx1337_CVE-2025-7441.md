## CVE-2025-7441-StoryChief-Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-7441

**漏洞类型:** 任意文件上传

**影响应用:** StoryChief

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0.42

**利用条件:** 目标WordPress站点安装了StoryChief插件且版本低于或等于1.0.42，且REST-API endpoint /wp-json/storychief/webhook 可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于StoryChief WordPress插件中，允许未授权的攻击者通过/wp-json/storychief/webhook REST-API接口上传任意文件，由于缺少充分的文件类型验证。利用方式为：
1.  构造包含恶意文件URL的JSON payload。
2.  计算payload的HMAC签名(默认key为空)。
3.  向目标站点的/wp-json/storychief/webhook 发送POST请求，包含构造的payload和HMAC签名。
4.  检查上传路径，确认恶意文件是否成功上传。

**有效性：**
提供的POC代码旨在利用CVE-2025-7441漏洞。POC代码逻辑是构造一个包含恶意文件URL的JSON payload，并将其发送到易受攻击的StoryChief插件的Webhook端点。代码使用requests库或curl来发送POST请求。POC验证过程会通过发送构造的URL到指定的wordpress的API，如果API没有做验证则会把URL当成有效文件上传到服务器上。

**投毒风险：**
该POC脚本本身不包含明显的恶意代码。然而，它从外部URL（DEFAULT_FILE_URL = "https://raw.githubusercontent.com/Pwdnx1337/ZIP/refs/heads/main/ZIP.php"）下载文件，并指示目标服务器获取该URL。这意味着如果该URL指向的文件包含恶意代码（例如webshell），那么运行此POC可能会在目标系统上引入webshell。所以存在一定的投毒风险, 仓库的作者（Pwdnx1337）可能会在`ZIP.php`文件中包含恶意代码。鉴于此，保守估计存在10%的投毒风险。

**利用方式：**
1.  **准备恶意文件：** 攻击者需要准备一个恶意文件，例如包含webshell的PHP文件，并将其托管在一个可公开访问的URL上。
2.  **构造Payload：** 使用提供的POC脚本，指定目标站点的URL和恶意文件URL。脚本会生成一个包含文件URL的JSON payload。
3.  **发送POST请求：**  POC脚本使用requests库或curl命令向目标站点的/wp-json/storychief/webhook REST-API端点发送POST请求，其中包含构造的payload。
4.  **验证上传：** 脚本会尝试访问上传的文件，以验证是否成功上传。如果文件可以访问，则表示漏洞利用成功。

由于没有搜索引擎结果, 漏洞利用代码优先级高于漏洞库信息，所以根据提供的POC代码分析得出上述结论。

**项目地址:** [Pwdnx1337/CVE-2025-7441](https://github.com/Pwdnx1337/CVE-2025-7441)

**漏洞详情:** [CVE-2025-7441](https://nvd.nist.gov/vuln/detail/CVE-2025-7441)