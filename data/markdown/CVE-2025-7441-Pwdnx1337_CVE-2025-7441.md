## CVE-2025-7441-StoryChief-Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-7441

**漏洞类型:** Arbitrary File Upload

**影响应用:** StoryChief

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0.42

**利用条件:** 目标 WordPress 站点安装了 StoryChief 插件且版本小于等于 1.0.42，无需认证即可访问 /wp-json/storychief/webhook REST-API 接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-7441 是 StoryChief WordPress 插件中的一个未经身份验证的任意文件上传漏洞。攻击者可以通过向 /wp-json/storychief/webhook REST-API 接口发送恶意请求，上传任意文件到服务器。由于缺乏充分的文件类型验证，攻击者可以上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**利用方式：**

1.  **构造 Payload：**  PoC 代码中，`make_payload` 函数创建包含指向远程文件的 URL 的 payload。该 URL 用于欺骗目标站点从攻击者控制的服务器上拉取文件。
2.  **计算 HMAC：**  `compute_hmac_over_json` 函数计算 payload 的 HMAC 签名。虽然漏洞描述中没有明确提及 HMAC 验证，但 PoC 包含了这个函数，可能用于绕过某些安全机制。
3.  **发送 POST 请求：**  PoC 代码使用 `requests` 或 `curl` 向 `/wp-json/storychief/webhook` 端点发送 POST 请求，其中包含构造的 payload 和计算的 HMAC 签名。
4.  **检查上传路径：**  `check_uploaded_path` 函数尝试访问上传的文件，以验证漏洞是否成功利用。

**有效性：**

根据漏洞信息和 PoC 代码，此漏洞利用代码具有较高的有效性。PoC 代码实现了漏洞利用的关键步骤，包括构造 payload、计算 HMAC 签名和发送 POST 请求。只要目标站点满足漏洞利用条件，攻击者就可以成功上传任意文件并实现远程代码执行。

**投毒风险：**

PoC 代码的主要功能是利用漏洞上传文件，但其中存在一定投毒风险。风险主要在于：

1.  **默认文件 URL：**  PoC 代码使用 `DEFAULT_FILE_URL` 指定要上传的远程文件 URL。默认情况下，该 URL 指向 `https://raw.githubusercontent.com/Pwdnx1337/ZIP/refs/heads/main/ZIP.php`。如果攻击者修改了这个 URL，指向包含恶意代码的文件，则可能在用户不知情的情况下，诱导用户执行恶意操作。
2.  **依赖远程文件：** PoC 本身依赖于远程文件 ZIP.php , 如果作者修改该文件内容,会导致恶意代码注入到目标机器上,导致投毒。

综合来看，投毒风险较低，约为 10%。用户可以通过修改 `file_url` 参数来指定要上传的文件，从而避免使用默认的远程文件。但如果用户不小心使用了包含恶意代码的文件，则可能导致安全问题。


**项目地址:** [Pwdnx1337/CVE-2025-7441](https://github.com/Pwdnx1337/CVE-2025-7441)

**漏洞详情:** [CVE-2025-7441](https://nvd.nist.gov/vuln/detail/CVE-2025-7441)