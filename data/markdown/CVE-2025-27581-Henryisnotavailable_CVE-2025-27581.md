## CVE-2025-27581-NIH BRICS-直接请求访问敏感模块

**漏洞编号:** CVE-2025-27581

**漏洞类型:** 权限绕过/强制浏览

**影响应用:** NIH BRICS

**危害等级:** 中危，可能导致敏感信息泄露或篡改

**影响版本:** <= 14.0.0-67

**利用条件:** 需要对BRICS系统具有网络访问权限和至少一个已认证用户的凭据

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-27581 允许未经授权的用户通过直接请求已知端点访问 BRICS 系统的 InET 模块。 根据提供的 POC 代码分析：

1.  **有效性：**

    *   漏洞库信息表明，未经授权的用户可以通过直接请求访问 InET 模块。
    *   POC 代码 `BasicExploit.sh` 旨在通过符号链接将目标文件链接到 `/var/log/below/error_root.log`，然后使用 `below debug dump-store --time 1` 命令触发漏洞，该命令会将日志信息写入链接的文件。 如果`below`工具存在权限问题（例如，以root权限运行），则可能导致目标文件权限被修改为0666。 漏洞库描述和 POC 代码的功能相符，因此判断 POC 代码可能有效。
    *   POC 代码 `CreateFakeRoot.sh` 的目标是修改 `/etc/passwd` 文件，添加一个伪造的 root 账户。它同样通过创建符号链接和使用 `below debug dump-store` 命令来实现。该脚本会将新的账户信息追加到 `/etc/passwd` 文件中，从而允许攻击者使用新创建的账户登录系统。

2.  **投毒风险：**

    *   该仓库的主要目的是演示漏洞利用，未发现明显的恶意代码。
    *   `CreateFakeRoot.sh` 脚本包含警告信息，提示用户密码可能会在日志或进程中泄露，并且警告用户密码哈希存储在 `/etc/passwd` 中，存在安全风险。但这属于漏洞利用的副作用，而非刻意投毒。
    *   虽然代码本身没有恶意行为，但脚本的功能（例如修改 `/etc/passwd`）具有很高的破坏性，如果被恶意使用，可能会对系统造成严重损害。
    *   **投毒风险评估：5%。** 该仓库的投毒风险较低，但用户需要谨慎使用，避免误操作或被恶意利用。

3.  **利用方式：**

    *   该漏洞的利用方式是，攻击者通过直接构造 URL 或 API 请求，访问未经授权的模块或功能。利用方式是强制浏览。
    *   `BasicExploit.sh` 利用了 `below` 工具的日志记录功能，通过符号链接将目标文件与日志文件关联，从而修改目标文件的权限。
    *   `CreateFakeRoot.sh` 同样利用了 `below` 工具的日志记录功能，通过修改 `/etc/passwd` 文件来创建后门账户。攻击者可以使用该后门账户登录系统，获得管理员权限。

**项目地址:** [Henryisnotavailable/CVE-2025-27581](https://github.com/Henryisnotavailable/CVE-2025-27581)

**漏洞详情:** [CVE-2025-27581](https://nvd.nist.gov/vuln/detail/CVE-2025-27581)