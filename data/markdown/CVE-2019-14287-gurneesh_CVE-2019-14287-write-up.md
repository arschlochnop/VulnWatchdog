## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)