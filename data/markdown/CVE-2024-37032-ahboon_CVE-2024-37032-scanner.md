## CVE-2024-37032 - Ollama Path Traversal

**漏洞编号:** CVE-2024-37032

**漏洞类型:** 路径遍历/远程代码执行 (RCE)

**影响应用:** Ollama

**危害等级:** 高危，可能导致文件读取、写入甚至远程代码执行

**影响版本:** < 0.1.34

**利用条件:** 需要低权限用户能访问 Ollama API 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-37032 是 Ollama 0.1.34 之前版本中的一个路径遍历漏洞。漏洞原因是 Ollama 在处理模型路径时，没有充分验证摘要（SHA256）的格式。攻击者可以构造包含路径遍历字符（如`../`）的恶意摘要，从而绕过访问控制，读取或写入服务器上的任意文件。由于 Ollama 经常用于执行机器学习模型，写入任意文件可能会导致 RCE。

**利用方式：**

1.  攻击者需要构造包含恶意路径的摘要。例如，`../` 可以用来跳出模型目录，访问其他敏感文件或目录。
2.  然后，攻击者使用这个恶意摘要来请求模型路径。由于 Ollama 没有正确验证摘要格式，路径遍历攻击将成功。
3.  根据具体的利用方式，攻击者可以读取敏感文件，覆盖配置文件，或者上传恶意代码到服务器上，从而实现远程代码执行。

**有效性评估：**

提供的 Python 脚本 (`CVE-2024-37032-scan.py`) 并非利用代码，而是漏洞扫描器。 它通过检查 `/api/version` 接口返回的版本号来判断 Ollama 实例是否易受攻击。如果版本号低于 0.1.34，则认为存在漏洞。这个脚本的有效性取决于 Ollama 实例是否开启了 API 接口，并且能够正确返回版本信息。

**投毒风险评估：**

分析了提供的 `CVE-2024-37032-scan.py` 和 `README.md` 文件。该扫描器本身不包含任何恶意代码。它只是用于检测指定子网中是否存在存在漏洞的 Ollama 服务。投毒风险为 0%。如果存在恶意利用代码，投毒风险评估需要重新考虑，重点关注利用代码是否会篡改系统配置，植入后门程序等。

**项目地址:** [ahboon/CVE-2024-37032-scanner](https://github.com/ahboon/CVE-2024-37032-scanner)

**漏洞详情:** [CVE-2024-37032](https://nvd.nist.gov/vuln/detail/CVE-2024-37032)