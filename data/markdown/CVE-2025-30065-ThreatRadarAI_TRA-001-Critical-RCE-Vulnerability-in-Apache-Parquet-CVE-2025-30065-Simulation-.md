## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)