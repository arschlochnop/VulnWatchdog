## CVE-2024-7954 - SPIP Porte Plume Plugin - Remote Code Execution

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程攻击者可执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行SPIP，且安装了受影响版本的 porte_plume 插件，服务器允许POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。远程未授权的攻击者可以通过发送精心制作的HTTP请求来执行任意PHP代码。 

**漏洞利用方式：**

攻击者发送包含恶意 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`。恶意代码嵌入在 `data` 参数中，利用了 SPIP 对 URL 的处理机制，将 PHP 代码作为 URL 的一部分进行解析和执行。YAML 文件中提供的 POC 代码展示了如何利用 `system('cat /etc/passwd')` 命令读取服务器上的 `/etc/passwd` 文件。

**有效性：**

根据漏洞描述和 POC 代码，可以判断该 POC 代码是有效的。POC 验证显示可以直接执行操作系统命令。

**投毒风险：**

提供的漏洞利用代码（YAML文件和README中的bash命令）本身旨在利用漏洞，并没有明显的投毒行为。代码的目的在于验证漏洞的存在，并通过 `system()` 函数执行指定的命令。仓库的 `README.md` 文件提供了漏洞的描述、PoC 利用方式、使用方法和参考链接。其中虽然有执行系统命令，但这是 RCE 漏洞利用的正常表现，并非植入后门或恶意代码。

**综上，投毒风险较低，约 1%。风险主要来自于使用者利用该 POC 进行非授权的渗透测试或其他恶意行为，而非 POC 本身包含恶意代码。**

**项目地址:** [gh-ost00/CVE-2024-7954-RCE](https://github.com/gh-ost00/CVE-2024-7954-RCE)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)