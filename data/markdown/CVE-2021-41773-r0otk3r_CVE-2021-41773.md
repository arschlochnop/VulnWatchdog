## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49 和 2.4.50 (CVE-2021-42013是对CVE-2021-41773的不完全修复)

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，可能需要CGI模块启用，以及Alias配置不当。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，绕过Alias等指令的限制，访问服务器上的任意文件。如果服务器同时启用了CGI，则可能进一步导致远程代码执行。漏洞利用代码`exploit.py`提供LFI(本地文件包含)和RCE(远程代码执行)两种攻击模式。LFI模式通过构造包含`/.%2e`序列的URL，读取服务器上的文件。RCE模式利用CGI执行命令，通过POST请求发送包含命令的Payload。

**漏洞利用方式：**

1.  **路径遍历 (LFI)：** 攻击者构造包含`/.%2e/%2e%2e`序列的URL，尝试访问受限目录之外的文件，例如`/etc/passwd`。  该漏洞利用代码中的payload1和payload2就是用于此目的，通过拼接路径来尝试读取目标文件。
2.  **远程代码执行 (RCE)：** 如果目标服务器启用了CGI，攻击者可以利用路径遍历漏洞，访问CGI脚本目录，并通过POST请求执行任意命令。漏洞利用代码中的payload3就是用于指定CGI脚本的位置，然后通过构造POST请求，在data中包含要执行的命令。

**关于投毒风险：**
该漏洞利用代码 `exploit.py` 本身看起来比较直接，目的是利用该漏洞。存在投毒的可能性较低，但仍不能完全排除，比如作者可以在交互式shell部分加入一些后门代码,或者在payload中加入恶意指令。经过分析，判断存在10%的投毒风险。`README.md`文件看起来也比较标准，风险较低。

**搜索引擎结果：**
搜索引擎结果表明该漏洞确实存在，且已被广泛利用。多个文章指出该漏洞可以导致敏感信息泄露和远程代码执行。

**项目地址:** [r0otk3r/CVE-2021-41773](https://github.com/r0otk3r/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)