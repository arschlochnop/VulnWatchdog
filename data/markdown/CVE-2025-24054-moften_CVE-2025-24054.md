## CVE-2025-24054-NTLM Hash Disclosure Spoofing Vulnerability

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM Hash Disclosure Spoofing

**影响应用:** Windows NTLM

**危害等级:** 中危，可能导致身份冒充和权限提升

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标用户访问攻击者控制的SMB共享

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24054是一个Windows NTLM哈希泄露欺骗漏洞。攻击者可以诱使用户访问一个恶意的.library-ms文件，该文件指向攻击者控制的SMB共享。当用户访问该共享时，他们的NTLM哈希会被发送到攻击者控制的服务器，从而允许攻击者冒充用户。根据搜索引擎结果，此漏洞已被积极利用。

**有效性评估：**

提供的POC代码是一个.library-ms文件生成器，用于创建指向攻击者控制的SMB共享的恶意文件。这种攻击方式与漏洞描述相符，因此该POC代码被认为是有效的。

**投毒风险评估：**

审查提供的Python脚本代码，该脚本的主要功能是生成library-ms文件，该文件包含指向恶意SMB服务器的URL。代码本身比较简单，没有发现明显的恶意代码或后门。但是，生成的library-ms文件本身是恶意的，因为它会导致受害者机器向攻击者控制的SMB服务器发送NTLM哈希。考虑到该脚本的目的是漏洞利用，因此将脚本本身标记为投毒是不准确的。但使用此脚本进行攻击活动显然是恶意行为。经过代码审计，没有发现明显的投毒代码，因此投毒风险评估为0%。

**利用方式：**

1.  攻击者搭建一个SMB服务器，用于接收受害者的NTLM哈希。
2.  攻击者使用POC代码生成一个恶意的.library-ms文件，该文件指向攻击者控制的SMB共享。
3.  攻击者诱骗目标用户打开该.library-ms文件（例如，通过电子邮件、社交媒体或其他方式）。
4.  当用户打开该文件时，Windows资源管理器会尝试访问该SMB共享，并将用户的NTLM哈希发送到攻击者的服务器。
5.  攻击者捕获用户的NTLM哈希，并可以使用该哈希进行后续攻击，例如Pass-the-Hash攻击。

**项目地址:** [moften/CVE-2025-24054](https://github.com/moften/CVE-2025-24054)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)