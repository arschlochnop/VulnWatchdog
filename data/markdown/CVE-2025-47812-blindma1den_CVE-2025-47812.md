## CVE-2025-47812 - Wing FTP Server 远程代码执行

**漏洞编号:** CVE-2025-47812

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Wing FTP Server

**危害等级:** 严重，可导致完全服务器入侵

**影响版本:** < 7.4.4

**利用条件:** 需要网络访问，匿名FTP账户可能也可利用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-47812 影响 Wing FTP Server 7.4.4 之前的版本。该漏洞源于 user 和 admin web 界面对 '\0' 字节的处理不当，导致可以注入任意 Lua 代码到用户会话文件中。攻击者可以通过发送包含恶意 Lua 代码的请求，利用此漏洞以 FTP 服务的权限（默认情况下为 root 或 SYSTEM）执行任意系统命令，从而完全控制服务器。漏洞利用方式如下：

1.  **获取 UID Cookie：** 通过向 `/loginok.html` 发送包含恶意 Lua 代码的 POST 请求，触发漏洞。Payload 构造的关键在于在用户名中注入 null 字节（`%00`）截断用户名，并在后面拼接 Lua 代码，该 Lua 代码会被执行。例如，可以执行系统命令并将结果返回。
2.  **执行命令或获取反向 Shell：** 如果成功获取 UID Cookie，则向 `/dir.html` 发送 POST 请求，并通过设置 Cookie 头来传递 UID，触发执行之前注入的 Lua 代码，从而执行任意命令或建立反向 shell。

**漏洞利用有效性：**

根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码实现了获取 UID Cookie 和发送 `/dir.html` 请求的完整流程，可以执行任意命令或建立反向 shell。搜索结果也表明该漏洞已被实际利用。

**投毒风险分析：**

仔细检查了提供的 POC 代码，未发现任何明显的投毒代码。代码逻辑清晰，主要功能是利用漏洞执行命令或建立反向 shell。代码中使用的 payload 都是常见的反向 shell 命令，没有发现隐藏的恶意行为。因此，投毒风险评估为 0%。

**漏洞利用方式总结：**

1.  **目标识别：** 识别运行易受攻击的 Wing FTP Server 版本的服务器。
2.  **Payload 构造：** 构造包含恶意 Lua 代码的 Payload，利用 null 字节截断用户名。
3.  **UID 获取：** 向 `/loginok.html` 发送 Payload，利用漏洞执行注入的 Lua 代码，并获取服务器返回的 UID Cookie。
4.  **命令执行/反向 Shell：** 向 `/dir.html` 发送包含 UID Cookie 的请求，触发之前注入的 Lua 代码，执行任意命令或建立反向 shell。


**项目地址:** [blindma1den/CVE-2025-47812](https://github.com/blindma1den/CVE-2025-47812)

**漏洞详情:** [CVE-2025-47812](https://nvd.nist.gov/vuln/detail/CVE-2025-47812)