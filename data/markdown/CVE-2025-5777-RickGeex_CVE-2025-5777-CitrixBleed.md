## CVE-2025-5777-NetScaler ADC/Gateway 内存泄露

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存泄露/信息泄露

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可能导致会话劫持、身份验证绕过和敏感数据泄露

**影响版本:** 受影响版本：NetScaler ADC and NetScaler Gateway 14.1 < 14.1-43.56；NetScaler ADC and NetScaler Gateway 13.1 < 13.1-58.32；NetScaler ADC 13.1-FIPS and 13.1-NDcPP < 13.1-37.235；NetScaler ADC 12.1-FIPS < 12.1-55.328

**利用条件:** NetScaler配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) OR AAA virtual server

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5777 是一个存在于 Citrix NetScaler ADC/Gateway 中的未经身份验证的越界读取漏洞（内存泄露）。通过构造恶意请求，攻击者可以转储内存，其中可能包含会话令牌，从而实现完全的身份验证绕过，因此被称为 “CitrixBleed 2”。

**有效性评估：**

根据漏洞库信息、搜索结果（特别是 doublepulsar.com 的“CitrixBleed 2: Electric Boogaloo”文章和 watchtowr 的文章）以及提供的 PoC 代码，该漏洞利用的有效性较高。PoC 代码专门用于利用此漏洞，并且搜索结果表明该漏洞已被积极利用。

**投毒风险分析：**

提供的 PoC 代码包含两个文件：

1.  `README.md`：这是一个说明文件，描述了漏洞、受影响的版本、免责声明、使用方法、日志分析和检测方法。该文件本身不包含任何可疑代码。
2.  `ns_log_scanner.py`：此脚本用于扫描 NetScaler 日志文件 (`ns.log`) 中是否存在非文本（二进制）字节。其目的是为了检测可能由攻击或其他异常活动引起的日志损坏。该脚本本身的功能是良性的，用于安全分析和检测，而非进行攻击或植入后门。
3. `CVE-2025-5777-CitrixBleed.py`: (缺失). 根据README.md的描述, 此脚本为漏洞利用脚本.需要用户提供hostname参数.

综上所述，投毒风险较低。虽然存在恶意使用漏洞利用脚本的可能，但是提供的代码（尤其是日志扫描器）本身不包含任何恶意或隐藏的功能。作者在免责声明中也强调了安全使用和合法授权。

**利用方式分析：**

1.  **漏洞触发：** 攻击者向存在漏洞的 NetScaler ADC/Gateway 发送特制的 HTTP 请求。
2.  **内存读取：** 由于输入验证不足，设备会读取超出分配缓冲区之外的内存。
3.  **信息泄露：** 从泄露的内存中提取敏感信息，例如会话令牌、cookie 或其他凭据。
4.  **身份验证绕过：** 使用泄露的会话令牌来冒充合法用户，绕过身份验证并访问受保护的资源。

简而言之，攻击者利用输入验证漏洞读取服务器内存，获取会话凭据，从而绕过身份验证。需要注意的是，目标系统必须配置为 Gateway 或 AAA virtual server 才能被利用。

**项目地址:** [RickGeex/CVE-2025-5777-CitrixBleed](https://github.com/RickGeex/CVE-2025-5777-CitrixBleed)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)