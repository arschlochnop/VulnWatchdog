## CVE-2025-49113 - Roundcube Webmail PHP Object Deserialization

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP Object Deserialization

**影响应用:** Roundcube Webmail

**危害等级:** 高危，远程代码执行

**影响版本:** < 1.5.10 和 1.6.0 <= version < 1.6.11

**利用条件:** 需要经过身份验证的用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113 漏洞存在于 Roundcube Webmail 的 settings/upload.php 文件中，由于 _from 参数未经过充分验证，导致经过身份验证的用户可以通过构造恶意的 PHP 对象，利用 PHP Object Deserialization 漏洞执行任意代码。

**利用方式：**

1.  攻击者需要首先通过有效的用户名和密码登录 Roundcube Webmail。
2.  登录后，攻击者构造一个包含恶意 PHP 对象的序列化字符串，该对象在反序列化时会执行任意代码。`exploit.py` 脚本通过 `CryptGPGEngine` 类和 `gadget()` 方法生成包含恶意代码的序列化字符串，并通过 base64 编码，将命令注入到 `_gpgconf` 属性中。
3.  攻击者将该序列化字符串作为 `_from` 参数的值，通过修改 URL，例如 `/?_task=settings&_framed=1&_remote=1&_from=edit-[gadget]`，发送到 Roundcube Webmail 服务器的 settings/upload.php 页面。
4.  当 Roundcube Webmail 服务器处理该请求时，由于 `_from` 参数未经过充分验证，服务器会对恶意 PHP 对象进行反序列化，从而导致攻击者执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果中多个链接确认了该漏洞的存在和严重性，并提供了相应的缓解措施。POC代码实现了登录认证，版本检测和漏洞利用的功能。代码结构清晰，利用了 `CryptGPGEngine` 类来构造恶意的序列化对象，并通过修改 `_from` 参数的方式触发漏洞。

**投毒风险：**

尽管漏洞利用代码看起来像是为了演示和测试目的而设计的，但仍然存在一定的投毒风险。

*   **命令注入：**  `exploit.py` 脚本允许攻击者通过命令行参数指定要执行的命令。如果攻击者使用该脚本攻击其他系统，则可以在目标系统上执行恶意命令。该脚本将命令进行 base64 编码，但解码后的命令会被打印到控制台,增加了分析的难度
*   **依赖项：**  该脚本依赖于 `requests`、`re`、`base64`、`sys`、`uuid` 和 `urllib.parse` 等 Python 库。如果攻击者修改了该脚本，添加了额外的依赖项，并且这些依赖项包含恶意代码，则可能会对用户的系统造成损害。
*   **隐蔽性：**  攻击者可能会修改该脚本，使其更加隐蔽，例如，通过隐藏恶意代码或使用混淆技术来避免被检测到。

综合来看，投毒风险大约为10%。因为代码逻辑比较简单，容易理解，也没有发现明显的恶意行为。主要风险来自于对脚本的修改和滥用。

**项目地址:** [AC8999/CVE-2025-49113](https://github.com/AC8999/CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)