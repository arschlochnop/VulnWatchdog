## CVE-2018-14498-libjpeg-turbo/MozJPEG-堆溢出

**漏洞编号:** CVE-2018-14498

**漏洞类型:** 堆缓冲区过读

**影响应用:** libjpeg-turbo/MozJPEG

**危害等级:** 高危，可导致拒绝服务（应用程序崩溃）

**影响版本:** libjpeg-turbo <= 1.5.90, MozJPEG <= 3.3.1

**利用条件:** 需要处理特制的8位BMP图像

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14498 漏洞存在于 libjpeg-turbo 和 MozJPEG 的 `rdbmp.c` 文件中的 `get_8bit_row` 函数中。攻击者可以通过构造一个包含超出调色板条目范围的颜色索引的恶意 8 位 BMP 图像，触发堆缓冲区过读，导致拒绝服务。利用方式为：

1.  **构造恶意 BMP 文件：** 创建一个 8 位 BMP 图像，其中包含一个或多个超出调色板大小范围的颜色索引。
2.  **触发漏洞：** 使用受影响的 libjpeg-turbo 或 MozJPEG 版本打开该 BMP 文件。当 `get_8bit_row` 函数读取像素数据时，会访问超出堆缓冲区范围的内存，导致应用程序崩溃。

**有效性：** 漏洞利用代码（构建libjpeg-turbo说明）表明可以构建和测试libjpeg-turbo，从而验证漏洞存在。相关漏洞信息页面也证实了该漏洞的存在以及利用方式。

**投毒风险：** 提供的代码段 `BUILDING.md` 是 libjpeg-turbo 的构建说明文档，本身不包含任何可执行代码，因此直接投毒的可能性较低。但是，如果攻击者能够篡改构建过程，例如通过修改 CMake 文件或替换源代码文件，则可能引入恶意代码。文档本身被利用的可能性较低，风险估计为10%。

**项目地址:** [h31md4llr/libjpeg_cve-2018-14498](https://github.com/h31md4llr/libjpeg_cve-2018-14498)

**漏洞详情:** [CVE-2018-14498](https://nvd.nist.gov/vuln/detail/CVE-2018-14498)