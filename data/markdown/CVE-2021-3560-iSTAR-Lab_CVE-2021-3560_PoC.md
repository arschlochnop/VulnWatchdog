## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** polkit 0.119

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许本地非特权用户通过欺骗 polkit 的 D-Bus 请求的凭据检查，从而将权限提升为 root 用户。该漏洞的利用方式是：

1.  **漏洞原理：** polkit 在处理 D-Bus 请求时，存在认证绕过缺陷，导致可以绕过授权检查。
2.  **利用方式：** PoC 脚本通过 D-Bus 接口尝试创建用户 `polkitroot`，并设置密码。利用时间竞争漏洞，在创建用户的过程中，尝试设置密码，从而绕过权限验证，最终成功创建一个具有 root 权限的用户。
3.  **有效性：** 从漏洞描述和搜索引擎结果来看，该漏洞存在且危害较大。提供的 PoC 代码针对特定版本（如 Ubuntu 20.04）有效，但可能需要在其他 Linux 发行版上进行调整。
4.  **投毒风险：** 脚本本身尝试创建一个名为 `polkitroot` 的用户并赋予其 root 权限。这本身就是利用漏洞的目的，但也可以被认为是后门。潜在的投毒风险在于脚本中的睡眠时间 (`sleep 0${half}s`) 和创建用户的重试机制。虽然脚本试图通过这些机制来提高利用成功率，但恶意攻击者可能会修改这些参数，使其在特定环境下执行恶意操作。例如，修改睡眠时间可能会导致拒绝服务攻击。脚本中的错误处理可能存在缺陷，导致在利用失败的情况下留下未清理的临时文件或异常状态，为后续攻击提供便利。

综合考虑，PoC 脚本主要用于演示漏洞，但存在一定的投毒风险，需要谨慎使用。

*投毒风险估算依据：*
*   90%代码是利用漏洞的代码，功能明确。
*   10%的代码可能存在隐藏风险，例如时间竞争相关的参数调整，可能被用于特定环境下的恶意行为。

**项目地址:** [iSTAR-Lab/CVE-2021-3560_PoC](https://github.com/iSTAR-Lab/CVE-2021-3560_PoC)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)