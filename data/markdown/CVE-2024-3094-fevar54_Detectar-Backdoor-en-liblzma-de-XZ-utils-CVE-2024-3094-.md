## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils (liblzma)

**危害等级:** 极危，可导致远程代码执行和未授权访问

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响的XZ Utils版本，且OpenSSH等服务链接了被篡改的liblzma库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个存在于 XZ Utils 5.6.0 和 5.6.1 版本中的供应链后门。攻击者通过复杂的混淆手段，在 liblzma 的构建过程中植入恶意代码，该代码修改了 liblzma 的特定功能。受影响的 liblzma 库被 OpenSSH 等软件链接后，攻击者可以拦截并修改与该库的数据交互，从而实现未授权的远程 SSH 访问。

提供的漏洞利用代码是一个 YARA 规则，用于检测系统中是否存在被后门篡改的 liblzma 库。该规则通过搜索特定的字节序列来识别恶意代码，如果系统匹配到该规则，则表明存在潜在的风险。YARA 规则本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者首先需要将恶意代码注入到 XZ Utils 的源代码中，并通过某种方式使其进入受信任的软件发布渠道（例如，通过有意的投毒行为，长时间取得开发者信任，逐步引入恶意代码）。
2.  用户下载并安装了受感染的 XZ Utils 版本。
3.  当 OpenSSH 等服务链接了受感染的 liblzma 库时，后门代码会被激活。
4.  攻击者可以通过特定的 SSH 连接触发后门，从而绕过身份验证并执行任意代码。

根据漏洞库信息和搜索结果，该漏洞影响范围广泛，危害程度极高。及时检测和修复受影响的系统至关重要。

**项目地址:** [fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-](https://github.com/fevar54/Detectar-Backdoor-en-liblzma-de-XZ-utils-CVE-2024-3094-)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)