## CVE-2018-10933 - libssh 认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问

**影响版本:** 0.6.0 - 0.7.5, 0.8.0 - 0.8.3

**利用条件:** 目标系统运行存在漏洞的libssh服务器，并且端口（通常是22）对外开放。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-10933 漏洞存在于libssh服务器端的状态机中，允许未经身份验证的客户端创建通道，从而绕过身份验证并获得未授权的访问权限。根据漏洞库信息和搜索引擎结果，受影响的版本包括0.6到0.7.5以及0.8到0.8.3。利用方式是发送`SSH2_MSG_USERAUTH_SUCCESS`消息，欺骗服务器进入已认证状态。提供的POC代码（CVE-2018-10933_Scanner.py）是一个扫描器，用于检测目标系统是否运行着存在漏洞的libssh版本。该脚本通过连接目标端口，发送一个空字节（\0）并尝试接收服务器的banner信息，如果banner信息中包含'0.6.0'，则判定为存在漏洞。这个scanner脚本本身风险较低,可能存在的风险在于利用socket连接进行未授权探测,在某些未授权渗透测试中可能存在争议。投毒风险评估为5%，主要是指在代码托管平台上，作者有可能在后续版本中添加恶意代码。POC的有效性较高，因为该漏洞原理简单，利用方式直接。根据搜索结果，Rapid7也发布了针对此漏洞的利用代码。

**项目地址:** [JoSecMx/CVE-2018-10933_Scanner](https://github.com/JoSecMx/CVE-2018-10933_Scanner)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)