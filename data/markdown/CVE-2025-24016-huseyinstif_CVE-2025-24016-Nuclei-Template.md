## CVE-2025-24016-Wazuh-反序列化RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化RCE

**影响应用:** Wazuh

**危害等级:** 高危，可导致远程代码执行，完全系统控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问（可能需要较低权限），某些配置下agent可触发

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24016是Wazuh服务器中的一个反序列化远程代码执行漏洞。攻击者可以通过向 DistributedAPI 发送特制的JSON请求，利用 `as_wazuh_object` 函数中的不安全反序列化机制，执行任意Python代码。POC代码通过构造包含 `__unhandled_exc__` 字段的JSON数据，并设置一个不存在的类`NotARealClass`，触发`NameError`，如果服务器返回500状态码且body中包含"NameError"，则表明存在漏洞。尽管该POC旨在检测漏洞而非利用，但如果将`NotARealClass`替换为可以利用的反序列化gadget，则可实现RCE。投毒风险较低，主要集中在作者在其他地方公布了恶意利用方式的可能性，或者未来修改模板增加恶意代码，因此投毒风险评估为5%。漏洞利用方式为：

1.  **攻击者** 需要能够访问Wazuh API，可能是通过Web界面、集群中的其他服务器，或者在特定配置下甚至是受损的agent。
2.  **攻击者** 构造包含恶意序列化数据的JSON请求，将其发送到 DistributedAPI。
3.  **Wazuh服务器** 使用 `as_wazuh_object` 反序列化JSON数据。
4.  **攻击者注入的恶意对象** 被实例化，导致执行任意Python代码。

**项目地址:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)