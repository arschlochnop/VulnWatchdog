## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)