## CVE-2018-10001

**漏洞编号:** CVE-2018-10001

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** FFmpeg

**危害等级:** 中危，可能导致服务中断

**影响版本:** <= 3.4.2

**利用条件:** 需要处理特制的 AVI 文件

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2018-10001是FFmpeg 3.4.2及之前版本中libavcodec/utvideodec.c文件的decode_init函数存在的一个漏洞。远程攻击者可以通过特制的AVI文件导致拒绝服务（数组越界读取）。

**有效性：**
漏洞库信息和搜索结果都表明此漏洞存在。但是，提供的漏洞利用代码(来自/tmp/460d027802f826bcc062996734960717目录下的文件)针对的是 CVE-2018-1000117 (注意末尾的117)， 这是 Python 在 Windows 上 os.symlink() 函数中的缓冲区溢出漏洞，与FFmpeg漏洞无关。因此，提供的POC代码**无效**。

**投毒风险：**
虽然提供的POC代码本身无效，但是仓库本身存在潜在的投毒风险。Readme文件声称是CVE-2018-1000117的POC, 但实际上代码是创建符号链接，简单验证没有发现明显的后门代码。但是，考虑到其与CVE-2018-10001无关，极有可能是一个障眼法，用来迷惑安全研究人员，从而将真正的恶意代码隐藏在其他位置。因此，投毒风险较高，估计为95%。

**利用方式：**
真正的CVE-2018-10001利用方式是构造恶意的AVI文件。攻击者需要创建一个包含特定数据，能够触发libavcodec/utvideodec.c中的decode_init函数的数组越界读取的AVI文件。当FFmpeg处理此文件时，会导致程序崩溃，从而造成拒绝服务。需要注意的是，这个是拒绝服务漏洞，不是代码执行漏洞。

总结：提供的POC代码与描述的FFmpeg漏洞无关，针对的是Python的符号链接漏洞。虽然目前提供的python代码没有发现恶意代码，仍然存在投毒风险。

**项目地址:** [u0pattern/CVE-2018-1000117-Exploit](https://github.com/u0pattern/CVE-2018-1000117-Exploit)

**漏洞详情:** [CVE-2018-10001](https://nvd.nist.gov/vuln/detail/CVE-2018-10001)