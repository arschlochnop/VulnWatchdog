## CVE-2022-30190 (Follina) MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考漏洞库信息

**利用条件:** 用户需要打开恶意构造的文档（如Word文档），或者点击恶意链接。调用程序（如Word）需要存在漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。当 MSDT 被调用应用程序（如 Word）使用 URL 协议调用时，就会出现此漏洞。攻击者可以构造恶意的 Word 文档，该文档利用 Word 的远程模板功能从远程 Web 服务器检索 HTML 文件。此 HTML 文件包含一个使用 `ms-msdt` 协议处理方案的恶意 JavaScript 代码，可以执行任意代码。

**漏洞利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  受害者打开该文档。
3.  Word尝试从远程服务器加载HTML模板。
4.  远程HTML利用`ms-msdt`协议调用MSDT。
5.  MSDT执行HTML中嵌入的恶意代码，从而在受害者系统上执行任意命令。

**有效性:**
提供的代码是一个扫描器，用于检测文件中是否存在 Follina 漏洞。 它不是漏洞利用代码，而是用于分析文件是否包含该漏洞的特征。

**投毒风险:**
提供的 Go 代码主要功能是扫描文件，检测是否存在 CVE-2022-30190 (Follina) 漏洞的特征。代码本身包含一定的投毒风险的可能性，因为扫描器本身可能被利用来传播恶意文件，虽然扫描器本身功能没有直接执行恶意代码，但仍然存在潜在的风险：

1.  **依赖包风险:** 检查 `go.mod` 和 `go.sum` 文件，确认所有依赖包的来源是否可信，以及版本是否安全。恶意依赖包可能会引入漏洞或后门。
2.  **扫描逻辑缺陷:** 扫描逻辑中可能存在缺陷，导致误报或漏报。攻击者可能利用这些缺陷来隐藏恶意代码，绕过扫描器的检测。
3.  **供应链攻击:** 攻击者可能篡改代码仓库，在扫描器中植入恶意代码。用户下载并运行被篡改的扫描器后，可能会受到攻击。
4.  **代码执行环境风险:** 运行扫描器的环境可能存在安全漏洞。攻击者可能利用这些漏洞来提升权限，执行恶意代码。

虽然代码的主要目的是安全扫描，但由于软件开发和分发的复杂性，仍然存在一定的风险。使用者应当保持警惕，确保从可信的来源获取代码，并进行充分的安全审查。

风险评估：10% 风险可能性体现在扫描器可能被恶意利用或包含隐藏的漏洞，但主要功能是扫描而非攻击，因此投毒风险较低。

**项目地址:** [shri142/ZipScan](https://github.com/shri142/ZipScan)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)