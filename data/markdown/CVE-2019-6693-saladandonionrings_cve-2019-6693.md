## CVE-2019-6693 - FortiOS 硬编码密钥信息泄露

**漏洞编号:** CVE-2019-6693

**漏洞类型:** 信息泄露

**影响应用:** FortiOS

**危害等级:** 中危，可泄露用户密码、私钥密码和高可用密码

**影响版本:** 5.6.9 及以下, 6.0.5 及以下, 6.2.0

**利用条件:** 需要访问FortiOS配置备份文件或者通过CLI Console命令获取相关数据

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-6693 漏洞是 FortiOS 在加密配置文件备份时使用硬编码的密钥，使得攻击者如果能够获得备份文件，就可以使用该密钥解密其中的敏感信息，包括用户密码（除了管理员密码）、私钥的密码以及高可用性（HA）密码。漏洞利用方式是通过获取 FortiOS 的配置文件或者通过 CLI Console命令`show user local`或`show system ha`获取用户和HA配置数据，然后使用提供的 Python 脚本 `fortigate-decrypt.py`，该脚本使用硬编码的密钥对加密的密码进行解密。该脚本从 data.txt 和 ha_config.txt 读取加密的用户和HA配置数据，分别进行解析，并使用硬编码的密钥进行解密，最后输出解密后的密码信息。根据代码分析，未发现存在明显的投毒代码，因此投毒风险评估为0%。根据搜索结果，CISA已将此漏洞添加到已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**项目地址:** [saladandonionrings/cve-2019-6693](https://github.com/saladandonionrings/cve-2019-6693)

**漏洞详情:** [CVE-2019-6693](https://nvd.nist.gov/vuln/detail/CVE-2019-6693)