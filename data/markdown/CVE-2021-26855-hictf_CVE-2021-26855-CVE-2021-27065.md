## CVE-2021-26855 Microsoft Exchange Server SSRF 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** SSRF (服务器端请求伪造) -> 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器对外开放，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个 SSRF 漏洞。根据搜索结果，攻击者可以利用此漏洞发送任意 HTTP 请求并伪装成 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链中的一部分，攻击者利用该漏洞可以绕过身份验证，并结合其他漏洞实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855 漏洞发送恶意构造的 HTTP 请求到 Exchange 服务器。
2.  通过 SSRF 漏洞，攻击者可以伪装成 Exchange 服务器进行身份验证，绕过身份验证机制。
3.  绕过身份验证后，攻击者可以利用其他漏洞（例如 CVE-2021-27065，反序列化漏洞）在 Exchange 服务器上执行任意代码。

**POC有效性分析：**

提供的 POC 代码包含一个简单的 PHP 文件（hello world），一个 README 文件，一个简单的 Node.js 服务器 (demo.js) 和一个 package.json 文件。这些代码片段本身并不能直接利用 CVE-2021-26855。它们更像是用于搭建一个基础的web服务器环境，可能用于验证漏洞利用的某些步骤或作为最终执行的payload的一部分。因此，单独来看，提供的POC代码**无效**，它只是利用整个漏洞链中的一小部分。

**投毒风险分析：**

提供的 POC 代码较为简单，没有明显的恶意代码。`demo.js` 只是一个简单的 HTTP 服务器，`1.php` 只是输出 "hello world"。但是，考虑到这是一个 Exchange 漏洞的 POC，攻击者可能会在更复杂的利用链中利用这些文件，例如将 `1.php` 作为 Webshell 上传到服务器，或者利用 `demo.js` 搭建一个用于接收反弹 shell 的服务器。 因此，存在一定的投毒风险，但风险主要在于利用方式的组合，而非代码本身存在后门。

**投毒风险评估：**

由于代码功能简单，直接投毒的可能性较低，但作为漏洞利用链的一部分，可能被用于执行恶意操作，因此投毒风险评定为 **20%**。

**项目地址:** [hictf/CVE-2021-26855-CVE-2021-27065](https://github.com/hictf/CVE-2021-26855-CVE-2021-27065)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)