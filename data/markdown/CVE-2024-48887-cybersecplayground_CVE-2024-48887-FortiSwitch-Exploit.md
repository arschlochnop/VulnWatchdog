## CVE-2024-48887-FortiSwitch-Unauthenticated Password Change

**漏洞编号:** CVE-2024-48887

**漏洞类型:** 未经验证的密码更改

**影响应用:** Fortinet FortiSwitch GUI

**危害等级:** 极危，允许未经身份验证的远程攻击者更改管理员密码。

**影响版本:** FortiSwitch 6.4.0 - 7.6.0

**利用条件:** 目标FortiSwitch GUI可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-48887 漏洞存在于 Fortinet FortiSwitch GUI 中，允许未经身份验证的远程攻击者通过构造特定的 HTTP POST 请求到 `/change_pass` 端点来更改管理员密码。根据提供的漏洞利用代码，攻击者只需向目标 IP 地址的 `/change_pass` 端点发送包含新密码的 JSON 数据，即可修改管理员密码。 

**有效性：**
提供的 PoC 代码是有效的，因为它模拟了未经身份验证的密码更改请求。 根据搜索结果，该漏洞影响多个 FortiSwitch 版本（6.4.0 到 7.6.0）。

**投毒风险：**
PoC 代码本身非常简单，直接明了地展示了如何利用漏洞。但是，github仓库存在风险，但几率较低。投毒风险估计为 10%，主要考虑潜在的供应链攻击：作者可能在代码库的其他部分（例如，构建脚本或依赖项）中隐藏恶意代码，这些代码在用户下载和使用 PoC 时执行。或者后期作者可能会修改代码。

**利用方式：**
1.  攻击者识别运行着受影响的 FortiSwitch 版本的设备。
2.  攻击者构造一个 HTTP POST 请求，其中包含以下 JSON 数据：
    ```json
    {
      "username": "admin",
      "newpass": "pwned123",
      "confirm": "pwned123"
    }
    ```
3.  攻击者将此请求发送到 `http://target-ip/change_pass` 端点，将 `target-ip` 替换为目标设备的 IP 地址。
4.  如果漏洞存在，管理员密码将被更改为 `pwned123`。
5.  攻击者现在可以使用新密码登录到 FortiSwitch GUI，并完全控制设备。

根据 CVSS 评分，此漏洞属于“极危”级别，未经授权的攻击者能够完全控制受影响的设备。


**项目地址:** [cybersecplayground/CVE-2024-48887-FortiSwitch-Exploit](https://github.com/cybersecplayground/CVE-2024-48887-FortiSwitch-Exploit)

**漏洞详情:** [CVE-2024-48887](https://nvd.nist.gov/vuln/detail/CVE-2024-48887)