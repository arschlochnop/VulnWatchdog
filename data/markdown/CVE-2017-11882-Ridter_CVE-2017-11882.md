## CVE-2017-11882-Microsoft Office Memory Corruption Vulnerability

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存破坏漏洞，导致远程代码执行

**影响应用:** Microsoft Office (Equation Editor)

**危害等级:** 高危，允许攻击者在当前用户上下文中执行任意代码

**影响版本:** Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016

**利用条件:** 用户需要打开包含恶意Equation Editor对象的Office文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-11882是Microsoft Office Equation Editor中的一个内存破坏漏洞。该漏洞允许攻击者通过构造特殊的Equation Editor对象，在用户打开包含该对象的Office文档时，在当前用户的上下文中执行任意代码。漏洞利用无需启用宏，增加了攻击的隐蔽性。提供的POC代码通过构造特定的RTF文件，嵌入包含恶意数据的Equation.3对象，触发漏洞。 

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞的POC是有效的。搜索引擎结果显示该漏洞被广泛利用于恶意软件传播，如Agent Tesla等。漏洞已被添加到CISA KEV目录，表明其在野利用的活跃性。 

**投毒风险：** 分析POC代码，主要功能是生成利用CVE-2017-11882漏洞的恶意RTF文档。代码本身相对简单，主要由RTF头部、包含漏洞利用数据的对象类组成。代码中包含一个限制，即命令长度不能超过109字节，这迫使攻击者使用诸如regsvr32加载远程SCT文件等技术来执行更复杂的payload。 并没有发现明显的恶意或后门代码，但不能排除作者在代码中植入细微的漏洞利用变种或信息收集功能的可能性。 因此，投毒风险较低，估计在5%左右。这主要是因为代码逻辑较为清晰，但仍需谨慎使用。 

**利用方式：** 
1.  攻击者创建一个恶意的RTF文档，该文档包含一个特殊的Equation Editor对象。
2.  该Equation Editor对象被精心构造，包含能够触发内存破坏漏洞的恶意数据。
3.  当受害者使用受影响的Microsoft Office版本打开该RTF文档时，Equation Editor会尝试解析该对象。
4.  由于对象中的恶意数据，Equation Editor中的内存损坏漏洞会被触发。
5.  攻击者利用此漏洞执行任意代码，例如下载并执行恶意软件。

由于命令长度限制，攻击者通常使用regsvr32来加载远程SCT文件，SCT文件可以包含更复杂的恶意代码，从而绕过长度限制。这种利用方式属于“fileless attack”，恶意代码并不直接落地到受害者磁盘上，提高了攻击的隐蔽性。

**项目地址:** [Ridter/CVE-2017-11882](https://github.com/Ridter/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)