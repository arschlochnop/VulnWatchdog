## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 服务器启用了`follow_symlinks=True`选项，且存在静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp库中的一个目录遍历漏洞。当`aiohttp.web.static`配置了`follow_symlinks=True`时，攻击者可以通过构造包含`../`的URL来访问静态文件目录之外的文件。PoC代码通过启动一个简单的aiohttp服务器，并使用`exploit.sh`脚本来尝试访问`/etc/passwd`文件来验证漏洞。`exploit.sh`脚本循环构造包含多个`../`的payload，并使用`curl`命令发送请求，直到服务器返回状态码200，表示成功读取到目标文件。通过分析PoC的代码，没有发现任何隐藏的投毒代码。该PoC只是利用目录遍历漏洞读取文件，不涉及任何恶意操作。

**漏洞利用方式：**

1.  服务器必须使用`aiohttp.web.static`提供静态文件服务。
2.  必须设置`follow_symlinks=True`。
3.  攻击者构造包含`../`的URL，例如`/static/../../../../etc/passwd`。
4.  服务器会将请求的文件返回给攻击者，从而导致敏感信息泄露。

**项目地址:** [z3rObyte/CVE-2024-23334-PoC](https://github.com/z3rObyte/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)