## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本范围广泛，具体参考CVE描述。

**利用条件:** 需要攻击者位于网络中，且目标系统未安装相应的补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。该漏洞绕过了NTLM反射缓解措施，允许经过身份验证的攻击者通过网络提升权限。根据搜索引擎结果和提供的PoC代码，利用方式如下：

1.  **DNS注入：** 使用`samba-tool`向DNS服务器中注入一条A记录，将一个子域名指向攻击者的IP地址。
2.  **NTLM Relay启动：** 启动`impacket-ntlmrelayx`工具，监听NTLM认证请求，并将这些请求转发到目标服务器。
3.  **强制认证：** 使用`rpcping`工具触发受害者机器向攻击者控制的地址发起认证请求。具体来说，利用MS-RPRN协议的强制认证。
4.  **权限提升：** 成功中继认证后，攻击者可以利用中继的凭据在目标服务器上执行操作，从而提升权限。

**有效性：** 提供的PoC代码看起来是有效的，因为它使用了已知的工具（如`samba-tool`、`impacket-ntlmrelayx`和`rpcping`）来实现漏洞利用的各个步骤。搜索结果也表明存在公开的PoC利用代码。

**投毒风险：** PoC代码本身结构清晰，主要功能是DNS注入、NTLM中继触发和RPC强制认证。潜在的投毒风险可能存在于以下几个方面：

*   **默认密码：** PoC代码中`--username=Administrator`和`--password=YourPassword`，如果用户不修改密码，可能导致不安全。
*   **依赖项风险：** PoC依赖于`samba-tool`和`impacket-ntlmrelayx`，这些工具本身可能存在安全问题。虽然不是PoC的直接投毒，但依赖项的安全性会影响PoC的安全性。
*   **网络流量监控：** 该PoC会产生大量的网络流量，可能会被IDS/IPS系统检测到。

综合来看，PoC代码本身存在投毒的可能性较低，但用户在使用时应该注意修改默认密码和监控网络流量，以降低风险。投毒风险评估为10%。

**项目地址:** [obscura-cert/CVE-2025-33073](https://github.com/obscura-cert/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)