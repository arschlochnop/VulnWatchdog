## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息。

**利用条件:** 目标系统启用IPv6，攻击者需要能够发送特制的IPv6数据包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP协议栈中，由于IPv6 Neighbor Discovery (ND) 数据包处理不当导致。攻击者可以通过发送特制的IPv6数据包触发漏洞，造成系统崩溃（BSOD），甚至执行任意代码。

**有效性评估：**
根据搜索结果和提供的POC代码，该漏洞的利用是有效的。搜索结果中多个链接提到该漏洞可导致远程代码执行，并且存在PoC。
提供的PoC代码（`exploit.py`）使用Shodan搜索易受攻击的Windows系统，然后使用Scapy库构造和发送恶意的IPv6数据包。

**投毒风险评估：**
PoC 代码本身主要由以下几部分组成：

1.  **Shodan 集成:**  使用 Shodan API 搜索存在漏洞的 Windows 系统。
2.  **Scapy 库:**  使用 Scapy 构造恶意的 IPv6 数据包。
3.  **参数配置:**  通过命令行参数灵活配置目标操作系统、版本、攻击强度等。
4.  **日志记录:**  使用 logging 模块记录关键操作，便于调试和审计。

代码中存在以下潜在的风险，但不能完全断定为投毒代码：

1.  **依赖外部服务：**依赖 Shodan API，如果 API Key 被滥用，可能会导致账户被封禁或者产生额外的费用。
2.  **错误处理不完善：**在 Shodan 搜索失败时，可能没有进行充分的错误处理，导致程序异常退出。
3.  **缺乏输入验证：**对于命令行参数的验证可能不足，恶意用户可能通过构造特殊的参数导致程序崩溃或者执行意外的操作。
4. **时间延迟:**`exploit.py`文件中存在循环扫描,攻击频率过高可能导致目标拒绝服务或触发入侵检测系统。

基于以上分析，仓库中存在作者隐藏的恶意代码的可能性较低，但仍然存在一定的风险，所以投毒风险评估为10%。

**利用方式：**
1.  **信息收集：** 使用Shodan API 搜索暴露在公网且存在漏洞的Windows主机（需要有效的Shodan API Key）。
2.  **数据包构造：** 使用Scapy 库构造畸形的IPv6 Neighbor Discovery (ND) 数据包，该数据包能够触发目标系统中的漏洞。
3.  **漏洞触发：** 向目标系统发送构造好的恶意IPv6数据包。
4.  **结果验证：** 观察目标系统是否崩溃（BSOD），验证漏洞是否成功利用。


**项目地址:** [jip-0-0-0-0-0/CVE-2024-38063-scanner](https://github.com/jip-0-0-0-0-0/CVE-2024-38063-scanner)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)