## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要目标系统存在漏洞版本且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。漏洞位于处理特定类型的 HTTP 请求时，攻击者可以覆盖堆栈上的返回地址并劫持程序控制流。

**漏洞利用分析：**

1.  **漏洞成因：**  漏洞是由于程序在栈上分配的缓冲区大小不足以容纳输入数据，导致数据溢出覆盖了栈上的其他数据，包括返回地址。
2.  **利用方式：**  攻击者构造包含恶意代码的特殊请求，该请求会导致栈溢出，覆盖返回地址，使其指向攻击者控制的代码（例如，ROP链）。
3.  **POC有效性：** 提供的ruby脚本是一个有效的POC，它实现了利用该漏洞的步骤。 该脚本首先获取目标 Ivanti 设备的 productversion。 然后根据该版本，使用预定义的偏移量和gadget地址，来精心构造溢出数据，覆盖返回地址，执行远程代码。 该脚本使用 HTTP 请求发送恶意数据。 该 POC 包含 brute force libdsplibs.so 的地址功能, 提高漏洞利用的成功概率。
4.  **投毒风险评估：** 该代码的主要目的是利用漏洞，而非进行恶意投毒。脚本尝试建立反向shell连接到攻击者的机器，实现远程代码执行，这是漏洞利用的常见手法，并非后门代码。但依然需要注意，任何未经验证的第三方代码都存在潜在风险。综合评估，投毒风险较低，约为1%。主要风险可能来源于攻击者利用该POC进行攻击活动，而非POC本身包含恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)