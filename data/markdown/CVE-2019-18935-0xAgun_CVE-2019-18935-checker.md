## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**漏洞编号:** CVE-2019-18935

**漏洞类型:** .NET Deserialization

**影响应用:** Progress Telerik UI for ASP.NET AJAX

**危害等级:** 高危，远程代码执行

**影响版本:** <= 2019.3.1023

**利用条件:** 1. 目标系统使用存在漏洞的Telerik UI版本。
2. 需要已知加密密钥（通过CVE-2017-11317或CVE-2017-11357或其他方式获取）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18935 是一个存在于Progress Telerik UI for ASP.NET AJAX中的.NET反序列化漏洞。该漏洞位于RadAsyncUpload功能中。成功利用此漏洞可以导致远程代码执行。利用条件是攻击者需要已知加密密钥，这可以通过利用相关的CVE-2017-11317或CVE-2017-11357漏洞来达成，或者使用其他方式获取密钥。

**有效性：**
根据漏洞描述、搜索引擎结果（尤其是CISA KEV条目）和提供的PoC代码来看，该漏洞是有效的，并且已经在野外被利用。

提供的 `exploit.py` 脚本旨在检测目标URL是否存在CVE-2019-18935漏洞。该脚本通过发送一个HTTP GET请求到目标URL的 `/Telerik.Web.UI.WebResource.axd?type=rau` 路径，检查响应内容中是否包含字符串 "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." 。如果存在，则判断目标URL存在漏洞，并将该URL保存到 `exploitable.txt` 文件中。此脚本只做检测，不能直接利用。

**投毒风险：**
检查提供的PoC代码 `exploit.py` 和 `README.md`，没有发现任何潜在的投毒代码。代码的功能相对简单，主要用于检测漏洞是否存在，而非执行恶意操作。文件操作仅限于创建和写入 `exploitable.txt`，风险较低。因此，投毒风险评估为0%。

**利用方式：**
1.  **密钥获取:** 首先，攻击者需要获得用于加密Telerik UI组件的密钥。这可以通过利用CVE-2017-11317或CVE-2017-11357等漏洞来获取，或者通过其他途径，例如密钥泄露。
2.  **构造恶意Payload:** 攻击者使用获得的密钥来构造一个恶意的.NET序列化对象Payload。这个Payload可以执行任意命令。
3.  **发送Payload:** 攻击者将构造的恶意Payload通过RadAsyncUpload组件发送到目标服务器。
4.  **执行代码:** 目标服务器反序列化Payload，从而执行Payload中包含的恶意代码，最终导致远程代码执行。

**项目地址:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)