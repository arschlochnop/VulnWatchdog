## CVE-2025-6218-WinRAR目录遍历远程代码执行

**漏洞编号:** CVE-2025-6218

**漏洞类型:** 目录遍历导致的远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在受害者计算机上执行任意代码

**影响版本:** 7.11 (64-bit)

**利用条件:** 用户需要打开恶意RAR压缩文件或访问恶意页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6218是一个存在于RARLAB WinRAR中的目录遍历远程代码执行漏洞。该漏洞允许远程攻击者在受影响的WinRAR安装上执行任意代码。 利用方式： 

1.  **漏洞描述：** WinRAR在处理压缩文件中的文件路径时存在缺陷，允许攻击者通过构造恶意压缩文件，利用目录遍历序列（`..\`）将文件解压到目标系统上的任意目录。
2.  **攻击向量：** 攻击者创建一个包含恶意构造文件路径的ZIP压缩文件。该压缩文件包含一个payload，目的是写入Windows的启动文件夹，以便在下次用户登录时执行。
3.  **PoC代码分析：**  提供的Python脚本`zip_payload_generator.py`用于生成包含恶意路径的ZIP压缩文件。脚本接受payload文件（例如，一个批处理脚本）作为输入，并生成一个ZIP文件，该文件包含多个包含不同深度目录遍历的条目。当用户使用存在漏洞的WinRAR版本解压该ZIP文件时，其中的payload将被解压到Windows Startup目录，从而实现远程代码执行。
4.  **有效性评估：** 根据漏洞描述和PoC代码，该漏洞是有效的。受害者只需要解压恶意构造的ZIP压缩文件，攻击者就可以在受害者计算机上执行任意代码。
5.  **投毒风险评估：** 提供的PoC代码的主要功能是生成利用该漏洞的恶意压缩文件。代码本身没有发现任何隐藏的恶意行为或后门。经过对代码的分析,没有发现额外的网络请求,文件读取,或者系统命令执行.投毒风险概率为0%。
6.  **利用缓解措施：** 使用最新版本的WinRAR，该版本已修复此漏洞。避免打开来源不明的RAR压缩文件。

**项目地址:** [mulwareX/CVE-2025-6218-POC](https://github.com/mulwareX/CVE-2025-6218-POC)

**漏洞详情:** [CVE-2025-6218](https://nvd.nist.gov/vuln/detail/CVE-2025-6218)