## CVE-2025-24016-Wazuh-反序列化RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限（可能通过控制面板、集群中的Wazuh服务器或受损的代理实现）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24016 是一个存在于 Wazuh 服务器中的反序列化远程代码执行漏洞。该漏洞影响 Wazuh 4.4.0 到 4.9.0 版本。由于 DistributedAPI 组件中存在不安全的反序列化缺陷，攻击者可以通过注入恶意构造的 JSON 数据，利用 `as_wazuh_object` 函数执行任意 Python 代码。根据搜索引擎结果，此漏洞已被 Mirai 僵尸网络利用，进行 DDoS 攻击和感染 IoT 设备。提供的 Nuclei 模板通过检查 Wazuh Web 界面的版本来检测是否存在此漏洞。检测逻辑为通过正则匹配页面中的wazuhVersion，同时需要满足页面返回200状态码并且body中包含`<title>Wazuh</title>` 和 `wazuhVersion`。如果版本在 4.4.0 和 4.9.0 之间，则判定为存在漏洞。投毒风险分析：提供的Nuclei模板主要用于漏洞检测，而非漏洞利用。该模板仅通过发送HTTP GET请求并分析响应来判断目标系统是否存在漏洞，不会主动执行恶意代码。考虑到作者可能会在域名检测规则中加入恶意域名，或者在版本检测规则中加入陷阱，因此存在极低的投毒风险，大约1%。利用方式：攻击者需要首先获得 Wazuh API 的访问权限，然后发送包含恶意序列化数据的请求，触发 `__unhandled_exc__` 异常，从而执行任意 Python 代码。攻击途径可能包括：
1.  **攻击控制面板：**如果攻击者可以访问或控制 Wazuh 控制面板，他们就可以通过 API 发送恶意请求。
2.  **攻击集群中的 Wazuh 服务器：**如果攻击者控制了集群中的一台 Wazuh 服务器，他们就可以利用该服务器向其他服务器发送恶意请求。
3.  **攻击受损的代理：**在某些配置中，受损的代理也可以被用来触发此漏洞。
成功利用此漏洞可能导致攻击者完全控制受影响的 Wazuh 服务器。

**项目地址:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)