## CVE-2025-49113-Roundcube-RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化导致远程代码执行

**影响应用:** Roundcube Webmail

**危害等级:** 严重，可能导致完全控制受影响的服务器

**影响版本:** < 1.5.10 和 1.6.0 <= version < 1.6.11

**利用条件:** 需要有效的Roundcube用户帐户，并开启文件上传功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49113 存在于 Roundcube Webmail 的文件上传功能中。经过身份验证的用户可以通过向URL中的`_from`参数传递恶意构造的PHP序列化对象来触发反序列化漏洞。该对象会被反序列化，如果利用链存在，则允许攻击者在服务器上执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码展示了如何利用`_from`参数，上传包含恶意PHP序列化对象的图像文件，从而执行命令。

**投毒风险分析：**

漏洞利用代码本身结构清晰，主要功能是利用漏洞，未发现明显的恶意代码。但仍然存在极小的投毒风险，具体分析如下：

*   **Payload_GPG类：** 该类用于生成包含命令执行的GPG配置的序列化PHP对象。理论上，攻击者可以在`gpgconf`参数中注入恶意代码，但是当前脚本中`gpgconf`参数来自用户的输入，所以很难判定存在恶意行为。
*   **请求处理部分：** `login` 函数用于登录 Roundcube，并在后续请求中使用 session。这段代码相对标准，没有发现可疑之处。
*   **其他部分：** 漏洞利用脚本的其他部分（例如，参数解析、错误处理等）看起来是良性的。

总体而言，该漏洞利用代码专注于漏洞利用，没有明显的恶意行为。作者可能通过精心构造的`gpgconf`参数执行恶意操作，但是概率较低，因此投毒风险评估为5%。

**利用方式：**

1.  **身份验证：** 使用提供的用户名和密码登录 Roundcube Webmail。
2.  **获取会话信息：** 从登录响应中提取会话 cookie 和 CSRF token。
3.  **构造恶意负载：** 创建一个包含恶意命令的PHP序列化对象。该对象利用了`Crypt_GPG_Engine`类的反序列化漏洞。
4.  **上传文件：** 将序列化的PHP对象作为文件名上传文件，并通过篡改URL中的`_from`参数，触发反序列化。
5.  **远程代码执行：** 服务器在处理上传的文件时，会反序列化文件名，执行恶意代码。

**项目地址:** [Joelp03/CVE-2025-49113](https://github.com/Joelp03/CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)