## CVE-2019-4716 - IBM Planning Analytics 远程代码执行

**漏洞编号:** CVE-2019-4716

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** IBM Planning Analytics

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 2.0.0 - 2.0.8

**利用条件:** 目标系统运行存在漏洞的IBM Planning Analytics版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-4716 允许未经身份验证的攻击者通过覆盖配置来绕过身份验证，以 'admin' 身份登录，然后通过 TM1 脚本以 root 或 SYSTEM 身份执行代码。

**有效性评估：**

*   漏洞库信息显示该漏洞存在于 IBM Planning Analytics 2.0.0 到 2.0.8 版本，未经身份验证的用户可以覆盖配置并以 admin 身份登录，然后执行代码。
*   搜索引擎结果提供了关于该漏洞的各种信息，包括 NVD 漏洞详情、IBM 安全公告、漏洞利用报告等，确认了漏洞的存在和严重性。
*   提供的漏洞利用代码包含一个完整的测试环境，用于验证 Nuclei 模板。该环境包括一个 Docker Compose 文件，一个 Python Flask mock 服务器，一个测试脚本和一个自动化测试脚本。该代码库的主要目的是为了提供一个POC环境，帮助用户验证Nuclei检测规则的有效性，以及理解漏洞的原理和利用方式。

根据这些信息，可以判断提供的 POC 代码是有效的，能够模拟和验证 CVE-2019-4716 漏洞。

**投毒风险评估：**

*   对提供的 POC 代码进行了分析，发现该代码的主要目的是为了模拟漏洞环境并进行验证，没有发现明显的恶意代码或后门。
*   `docker-compose-cve-2019-4716.yml` 文件用于创建 Docker 容器，使用 `nginx:alpine` 作为基础镜像，并将 mock 服务器的文件挂载到容器中。`mock_ibm_pa.py` 文件包含模拟的 IBM Planning Analytics 服务器的逻辑，包括漏洞利用所需的端点。
*   `test-cve-2019-4716.sh` 文件包含自动化测试脚本，用于启动 Docker 容器，测试 mock 服务器和 Nuclei 模板。
*   虽然代码库本身看起来是安全的，但仍然存在一定的风险。攻击者可能会修改代码库中的文件，例如 `mock_ibm_pa.py` 文件，以添加恶意代码。此外，如果用户从不受信任的来源下载代码库，则可能会下载包含恶意代码的修改版本。
*   因此，在下载和使用 POC 代码时，务必从可信的来源获取，并仔细检查代码，确保没有恶意代码。

综合考虑，认为此仓库中存在作者隐藏的投毒代码的可能性较低，但仍需保持警惕，小心使用。投毒风险评估为 5%。

**利用方式分析：**

1.  **配置覆盖：** 攻击者首先利用未经身份验证的配置覆盖漏洞，修改 IBM Planning Analytics 的配置。
2.  **身份验证绕过：** 通过覆盖配置，攻击者可以绕过身份验证，以 'admin' 身份登录系统。
3.  **远程代码执行：** 成功登录后，攻击者可以利用 TM1 脚本执行任意代码，从而控制整个系统。

该漏洞利用过程简单，无需身份验证，攻击者可以轻松地利用该漏洞获取系统控制权限。

**项目地址:** [Pranjal6955/CVE-2019-4716-Test-Environment](https://github.com/Pranjal6955/CVE-2019-4716-Test-Environment)

**漏洞详情:** [CVE-2019-4716](https://nvd.nist.gov/vuln/detail/CVE-2019-4716)