## CVE-2025-6934-Opal Estate Pro-权限提升

**漏洞编号:** CVE-2025-6934

**漏洞类型:** 权限提升

**影响应用:** Opal Estate Pro

**危害等级:** 高危，可导致管理员权限被恶意用户获取，进而控制整个WordPress站点。

**影响版本:** <= 1.7.5

**利用条件:** 无需认证，可直接通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Opal Estate Pro插件中，由于在用户注册时的`on_regiser_user`函数中缺乏角色限制，未经身份验证的攻击者可以通过发送包含`role=administrator`的注册请求，将新注册的用户角色设置为管理员。PoC代码通过构造不同的POST请求数据变种来利用此漏洞，尝试绕过可能的过滤或验证机制。该代码首先尝试从目标URL获取nonce值，然后使用此nonce值和精心构造的参数向`wp-admin/admin-ajax.php`发送POST请求，以注册一个管理员用户。检查了代码,未发现隐藏的投毒代码。

**利用方式：**

1.  **查找目标站点：** 确定安装了易受攻击的Opal Estate Pro插件（版本<= 1.7.5）的WordPress站点。
2.  **获取Nonce：** 使用PoC代码中的`get_nonce`函数从目标站点的主页或其他页面获取注册所需的nonce值。该函数通过解析HTML页面或其中的JavaScript代码来查找nonce。
3.  **构造恶意注册请求：** 使用获取的nonce值，以及用户名、邮箱、密码等信息，构造一个包含`role=administrator`的POST请求，将其发送到目标站点的`wp-admin/admin-ajax.php`。
4.  **利用漏洞：** 如果请求成功，攻击者将成功注册一个具有管理员权限的新用户。
5.  **登录和控制：** 攻击者可以使用新注册的管理员帐户登录WordPress站点，并获得完全控制权限。

**项目地址:** [Jenderal92/WP-CVE-2025-6934](https://github.com/Jenderal92/WP-CVE-2025-6934)

**漏洞详情:** [CVE-2025-6934](https://nvd.nist.gov/vuln/detail/CVE-2025-6934)