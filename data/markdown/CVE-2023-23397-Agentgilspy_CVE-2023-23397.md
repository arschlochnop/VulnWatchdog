## CVE-2023-23397 - Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM哈希泄露，进而提升权限

**影响版本:** 受影响版本包括：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise (详见漏洞库信息)

**利用条件:** 攻击者需要能够向受害者发送包含特制属性的邮件或日历邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送特制的电子邮件消息，特别是日历邀请，来利用此漏洞。该漏洞允许攻击者窃取受害者的 Net-NTLM 哈希。漏洞利用方式如下：

1.  **攻击者构建包含恶意`ReminderSoundFile`属性的日历邀请或邮件**。该属性指向攻击者控制的SMB服务器（例如 `\\192.168.1.7\nonexistent\sound.wav`）。
2.  **当Outlook客户端处理该邮件时**，即使受害者没有打开邮件，Outlook也会尝试访问该SMB共享以播放提醒声音。
3.  **此访问会触发NTLM身份验证**，将受害者的Net-NTLM哈希发送到攻击者的SMB服务器。
4.  **攻击者捕获Net-NTLM哈希**，并可以使用该哈希进行NTLM中继攻击或离线破解，从而冒充受害者。

**有效性：** 提供的PoC代码尝试通过创建一个新的日历邀请，设置`ReminderSoundFile`属性为攻击者控制的IP地址，并将该邀请发送给目标用户。该PoC代码是有效的，因为它模拟了攻击者可以利用此漏洞的方式。

**投毒风险：** 提供的代码仅包含用于演示漏洞的PoC代码和一个MIT许可协议。它旨在创建一个包含特定属性的Outlook日历项，该属性指向攻击者控制的服务器。没有发现任何作者隐藏的恶意或后门代码，因此投毒风险为0%。该LICENSE文件声明的Copyright (c) 2025 Gilchrist 也无实际意义，因为该漏洞在2023年就被披露。

**利用方式：** 漏洞的利用方式是通过构造包含恶意`ReminderSoundFile`属性的日历邀请或邮件，当受害者的Outlook客户端处理该邮件时，会自动向攻击者控制的SMB服务器发起NTLM认证，从而泄露受害者的Net-NTLM哈希。

**项目地址:** [Agentgilspy/CVE-2023-23397](https://github.com/Agentgilspy/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)