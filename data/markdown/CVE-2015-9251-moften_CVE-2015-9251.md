## CVE-2015-9251-jQuery-XSS

**漏洞编号:** CVE-2015-9251

**漏洞类型:** XSS

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户cookie泄露、页面篡改等

**影响版本:** < 3.0.0

**利用条件:** 需要目标网站使用受影响的jQuery版本，且存在跨域AJAX请求未设置dataType选项

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于jQuery 3.0.0之前的版本中，当发起跨域AJAX请求时，如果没有指定 `dataType` 选项，且服务器返回 `text/javascript` 类型的数据，jQuery会将返回的数据作为JavaScript代码执行，从而导致XSS漏洞。

**有效性：** 提供的PoC代码是有效的。它模拟了一个跨域AJAX请求，没有设置 `dataType` 选项，并构造了一个包含恶意JavaScript代码的URL。当服务器返回包含 `alert(document.cookie)` 的响应时，这段代码会被jQuery执行，显示用户的cookie。

**投毒风险：** 经过分析，提供的PoC代码和README.md文件没有发现明显的投毒代码。PoC的目的是演示漏洞，而不是进行恶意攻击。代码功能清晰，没有隐藏的恶意逻辑。作者邮箱是protonmail，更注重隐私，因此投毒风险较低，概率为0%。

**利用方式：**
1.  **寻找目标：** 寻找使用jQuery 3.0.0之前版本的网站。
2.  **构造恶意链接：** 构造一个包含恶意JavaScript代码的URL，该URL指向一个可控的服务器，服务器返回 `text/javascript` 类型的数据，数据中包含攻击代码。例如：`https://example.com/api?callback=alert(document.cookie)`。
3.  **诱骗用户访问：** 将恶意链接发送给用户，诱骗其点击。
4.  **XSS攻击：** 用户访问恶意链接后，如果目标网站存在未设置 `dataType` 选项的跨域AJAX请求，并且请求的URL是可控的，jQuery会将恶意代码作为JavaScript代码执行，从而实现XSS攻击。

**项目地址:** [moften/CVE-2015-9251](https://github.com/moften/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)