## CVE-2025-53770-Microsoft SharePoint Server Remote Code Execution

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 需要目标SharePoint服务器能够被访问，且未应用相关补丁或缓解措施。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53770是一个存在于Microsoft SharePoint Server中的反序列化漏洞。攻击者可以利用此漏洞，通过向目标服务器发送特制的请求，实现在服务器上执行任意代码。根据漏洞描述和搜索结果，该漏洞是未经身份验证的远程代码执行漏洞，属于高危漏洞，目前已被大规模利用。

**有效性：**
提供的Python脚本(`scanner.py`)尝试通过发送包含特制Payload的POST请求到 `/ToolPane.aspx` 路径来检测目标SharePoint服务器是否存在漏洞。Payload中包含恶意的`Scorecard:ExcelDataSet`标记，该标记可能触发反序列化漏洞。脚本会检查响应状态码和响应内容，如果状态码为200且响应内容包含"Scorecard"，则认为目标服务器存在漏洞。脚本的逻辑相对简单，但能够有效检测目标服务器是否存在漏洞利用点。因此，提供的POC代码在检测漏洞方面是有效的。

**投毒风险：**
查看`scanner.py` 脚本，发现其主要功能是发送精心构造的 HTTP POST 请求，然后通过检查 HTTP 响应的状态码和内容来判断目标主机是否容易受到攻击。脚本本身主要由网络功能组成，没有发现任何可疑的恶意代码，例如试图在目标系统上写入文件、执行命令或建立反向 shell 的代码。其中`PAYLOAD`变量中的CompressedDataTable的值是经过base64压缩的DataTable对象。虽然该对象可能被用于RCE，但是并非投毒代码。

`README.md` 文件只包含脚本的使用说明，也未发现恶意代码。

总体风险较低，但始终存在这样一种可能性，即攻击者可能会尝试通过使用更复杂的有效负载或与扫描程序集成的其他漏洞利用技术来添加隐藏功能。基于对当前代码的分析，估算投毒风险为 5%。

**利用方式：**
1.  **攻击者构造恶意的序列化数据。** 该数据通常嵌入在HTTP POST请求的参数中，例如在 `PAYLOAD` 中的 `CompressedDataTable` 字段，利用 `Scorecard:ExcelDataSet` 标签触发漏洞。
2.  **攻击者发送包含恶意序列化数据的HTTP请求到SharePoint服务器的特定端点。** 根据POC代码，目标端点为 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx`。
3.  **SharePoint服务器反序列化恶意数据，从而执行攻击者预设的恶意代码。** 利用`ToolPane`的功能，当SharePoint服务器尝试处理这个恶意的序列化数据时，会触发反序列化漏洞，从而执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **通过RCE执行系统命令，控制服务器。** 攻击者成功利用漏洞后，可以在SharePoint服务器上执行任意系统命令，从而控制服务器，进行数据窃取、恶意软件植入等恶意活动。

**项目地址:** [ZephrFish/CVE-2025-53770-Scanner](https://github.com/ZephrFish/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)