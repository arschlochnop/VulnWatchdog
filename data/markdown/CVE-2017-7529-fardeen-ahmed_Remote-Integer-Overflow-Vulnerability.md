## CVE-2017-7529 - Nginx Range Filter Integer Overflow

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 整数溢出

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2 (不包括1.12)

**利用条件:** 目标服务器启用了 Range Filter 模块且存在可访问的文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7529 是一个 Nginx Range Filter 模块中的整数溢出漏洞。当 Nginx 服务器处理包含恶意构造的 Range 头的 HTTP 请求时，可能导致整数溢出，进而泄露服务器内存中的敏感信息，如缓存文件头或内部 IP 地址。

**有效性分析：**
提供的 `vulnchecker.py` 脚本通过发送带有特制 Range 头的请求来探测目标服务器是否存在此漏洞。如果服务器返回状态码 206 (Partial Content) 且响应头包含 Content-Range，则表明服务器可能存在漏洞。`exploit.py` 脚本则尝试利用此漏洞，通过构造特殊的 Range 请求来读取服务器内存中的数据。

根据漏洞描述和搜索引擎结果，此漏洞利用方式是有效的，尤其是在受影响的 Nginx 版本上。

**投毒风险分析：**
查看仓库内容：
*   `README.md`: 描述了漏洞和利用脚本的使用方法。
*   `exploit.py`: 利用脚本，通过构造畸形的 Range 请求尝试泄露信息。
*   `vulnchecker.py`: 漏洞检测脚本，用于判断目标是否存在漏洞。

分析脚本代码，`exploit.py` 中 `headers['Range'] = "bytes=-%d,-%d" % (n, 0x8000000000000000 - n)` 构造的 Range 头的确是利用整数溢出的关键。`vulnchecker.py` 中同样通过构造类似的 Range 头检测漏洞。

**潜在投毒风险：**
1.  **误导性的偏移量：** `exploit.py` 脚本中使用了固定的偏移量 (offset = 605)，这个偏移量可能不适用于所有情况，可能导致利用失败或泄露不正确的信息。虽然这不是明显的恶意代码，但如果用户盲目使用此脚本，可能会产生误导。
2.  **依赖外部库：** 脚本依赖 `requests` 库。如果用户从不可信的源安装此库，可能会引入恶意代码。
3.  **信息收集：** 脚本会打印 `server` 和 `status` 等信息，可能收集目标服务器的信息。

综合考虑，风险点主要在于脚本的可用性和潜在的误用，以及对外部库的依赖。因此，投毒风险评定为 10%。没有发现明显的、恶意的后门代码，只是利用脚本的有效性受到目标环境的限制，且存在依赖风险。

**利用方式总结：**
1.  使用 `vulnchecker.py` 脚本检测目标服务器是否存在 CVE-2017-7529 漏洞。
2.  如果目标服务器存在漏洞，则使用 `exploit.py` 脚本构造特殊的 Range 请求。
3.  服务器处理 Range 请求时，由于整数溢出，可能返回超出预期范围的数据，导致敏感信息泄露。

**项目地址:** [fardeen-ahmed/Remote-Integer-Overflow-Vulnerability](https://github.com/fardeen-ahmed/Remote-Integer-Overflow-Vulnerability)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)