## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)