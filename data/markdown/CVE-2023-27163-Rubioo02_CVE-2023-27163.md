## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露，甚至通过间接方式进行攻击。

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中存在的服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造特定的API请求，利用/api/baskets/{name}组件来访问内部网络资源或敏感信息。 

**利用方式：**

1.  攻击者使用提供的POC脚本，指定目标Request-Baskets服务器的URL和攻击者控制的URL。
2.  脚本会在Request-Baskets服务器上创建一个新的basket，并将`forward_url`设置为攻击者指定的URL。
3.  `proxy_response`设置为`true`，表示Request-Baskets会将从攻击者URL收到的响应返回给发起原始请求的客户端。
4.  攻击者随后向创建的basket发送请求。Request-Baskets服务器会将该请求转发到攻击者指定的URL。
5.  攻击者可以利用这一点来扫描内部网络，或访问受保护的资源。

**有效性：**

根据漏洞库信息和搜索结果，以及提供的POC代码，该漏洞是有效的。多个来源都提供了PoC，证明了漏洞的可利用性。

**投毒风险：**

提供的脚本主要功能是创建basket并设置forward_url，以实现SSRF攻击。检查了脚本内容，没有明显的恶意代码或后门，诸如反弹shell，植入挖矿程序等行为。但是，该脚本可能会被修改为包含恶意功能，因此存在一定的投毒风险，初步判断该仓库存在投毒代码的概率约为5%。使用该脚本的人员应仔细审查代码，确保其安全性。

**项目地址:** [Rubioo02/CVE-2023-27163](https://github.com/Rubioo02/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)