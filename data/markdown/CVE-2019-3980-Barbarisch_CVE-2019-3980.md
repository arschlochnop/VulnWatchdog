## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service 未授权远程代码执行

**漏洞编号:** CVE-2019-3980

**漏洞类型:** 未授权远程代码执行

**影响应用:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**危害等级:** 高危，允许未授权远程代码执行，以Local System权限运行任意代码

**影响版本:** <= 12.1.0.89

**利用条件:** 目标系统运行受影响版本的Dameware Mini Remote Client Agent，且攻击者可以建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-3980 漏洞存在于 SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 及更早版本中。该漏洞允许未经身份验证的远程攻击者通过智能卡认证过程上传可执行文件并在 DWRCS.exe 主机上执行，从而实现远程代码执行，权限为Local System。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已经公开披露的、存在有效POC的未授权远程代码执行漏洞。

**投毒风险：**
提供的POC代码主要包含以下部分：
1.  README.md：包含漏洞描述、编译和使用说明，以及关于修改 OpenSSL 以允许使用较短密钥长度的警告。这部分存在一定风险，因为修改加密库可能引入安全问题。
2.  OpenSSL 头文件：用于加密通信。
3.  POC代码：C++代码，利用该漏洞上传并执行可执行文件。

由于 README 明确指出修改了 OpenSSL 库以允许使用不安全的密钥长度 (512 bits -> 128 bits)，这本身就是一种潜在的风险。虽然说明目的是为了PoC的成功，但如果在实际环境中使用了修改后的 OpenSSL 库，可能会导致其他安全问题。 

此外，C++代码需要编译，这意味着攻击者需要在目标系统上编译或上传预编译的二进制文件。 上传二进制文件的行为本身就存在风险，如果攻击者替换了原始的二进制文件，可能会导致后门。

总体而言，该仓库中存在一定程度的投毒风险，主要体现在修改OpenSSL库的必要性，以及对二进制文件的依赖上。 投毒的可能性评分为10%。

**利用方式：**
1.  攻击者与目标 Dameware Mini Remote Client Agent Service 建立网络连接。
2.  攻击者模拟智能卡认证过程，利用漏洞上传恶意可执行文件。
3.  Agent Service 执行上传的可执行文件，从而实现远程代码执行，权限为Local System。
4.  攻击者可利用此权限控制整个系统。

**项目地址:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**漏洞详情:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)