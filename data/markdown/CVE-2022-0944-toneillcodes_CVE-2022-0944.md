## CVE-2022-0944-sqlpad-RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** sqlpad

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** < 6.10.1

**利用条件:** 需要目标实例存在/api/test-connection接口, 需要较高权限才能访问该接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0944是SQLPad 6.10.1之前版本中存在的一个模板注入漏洞。攻击者可以通过向`/api/test-connection`端点发送特制的请求，在服务器上执行任意代码，从而完全控制服务器。根据漏洞库信息和搜索结果，该漏洞危害巨大，易于利用。漏洞利用代码中的Python脚本通过构造包含恶意payload的JSON数据，并将其发送到目标服务器的`/api/test-connection`端点，从而触发远程代码执行。Payload使用 `child_process.exec` 函数来执行操作系统命令，并建立反向shell连接到攻击者的机器。 检查漏洞利用代码，没有发现明显的投毒迹象。Payload部分是标准的反向shell，没有其他恶意行为。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要访问SQLPad实例的`/api/test-connection`接口。
2.  攻击者构造一个包含恶意模板注入payload的JSON请求。Payload使用JavaScript代码调用`child_process.exec`函数来执行任意命令。
3.  攻击者将构造的JSON请求发送到`/api/test-connection`端点。
4.  SQLPad服务器处理该请求时，模板引擎会解析恶意payload，导致执行攻击者指定的命令。
5.  攻击者可以在服务器上执行任意代码，例如创建反向shell连接，从而完全控制服务器。

**项目地址:** [toneillcodes/CVE-2022-0944](https://github.com/toneillcodes/CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)