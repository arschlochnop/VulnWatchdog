## CVE-2024-0012 PAN-OS 身份验证绕过

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，允许未经身份验证的攻击者获得管理员权限，执行任意管理操作，篡改配置，或利用其他已认证的权限提升漏洞。

**影响版本:** PAN-OS 10.2, PAN-OS 11.0, PAN-OS 11.1, and PAN-OS 11.2软件。

**利用条件:** 需要目标PAN-OS管理Web界面可以通过网络访问，且未采取缓解措施（如限制管理界面访问仅限受信任的内部IP地址）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果可以访问管理Web界面，便能够获得PAN-OS管理员权限。根据 Palo Alto Networks 官方公告和搜索结果，该漏洞已经被观察到在野利用。

**利用方式：**

1.  攻击者发送特制的HTTP请求到目标PAN-OS设备的管理Web界面，绕过身份验证。
2.  POC代码通过`createRemoteAppwebSession.php`端点写入包含`netstat -ano`命令执行结果的PHP文件到`/var/appweb/htdocs/unauth/test.php`路径下。
3.  然后利用index.php/.js.map文件访问，并复用cookie访问生成的php文件，如果能够成功查看到`netstat -ano`命令执行结果，则证明漏洞存在。
4.  成功利用该漏洞后，攻击者可以执行任意管理操作，包括篡改配置和进一步利用其他漏洞。

**有效性：**

POC代码有效。该代码尝试利用漏洞，通过构造特定的请求来验证漏洞是否存在。代码首先发送POST请求到`/php/utils/createRemoteAppwebSession.php/rce.js.map` 写入payload，然后发起GET请求，如果返回包含预期结果，则判断漏洞存在。

**投毒风险：**

POC代码存在轻微的投毒风险（10%）。

*   **风险点:**  虽然主要功能是验证漏洞，但是代码中涉及将`netstat -ano`命令的结果写入到`/var/appweb/htdocs/unauth/test.php`。虽然这主要用于验证，但如果攻击者直接使用该代码，可能会留下一些信息在目标系统上，虽然影响不大，但构成一种潜在的风险。另外README.md中存在引导用户访问钓鱼网站的风险。

总而言之，主要代码的功能是利用漏洞，而并非明显的恶意行为，但存在轻微的、可被利用的风险。建议使用者仔细审查代码，并确保在授权环境下使用。

**项目地址:** [iSee857/CVE-2024-0012-poc](https://github.com/iSee857/CVE-2024-0012-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)