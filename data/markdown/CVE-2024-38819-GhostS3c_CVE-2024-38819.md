## CVE-2024-38819-Spring Framework-路径遍历

**漏洞编号:** CVE-2024-38819

**漏洞类型:** 路径遍历

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Spring Framework 5.3.0 - 5.3.40, 6.0.0 - 6.0.24, 6.1.0 - 6.1.13

**利用条件:** 应用程序使用WebMvc.fn或WebFlux.fn提供静态资源服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38819是Spring Framework中的一个路径遍历漏洞，影响使用WebMvc.fn或WebFlux.fn功能性web框架提供静态资源的应用程序。攻击者可以构造恶意HTTP请求，访问文件系统中应用程序有权访问的任何文件。

**有效性：**
提供的POC代码是有效的。它通过发送包含`..`序列的HTTP请求来尝试访问`/etc/passwd`文件。如果应用程序存在漏洞，并且攻击者能够访问该文件，则POC将被视为成功。

**投毒风险：**
POC代码本身似乎没有明显的投毒风险。它只是一个简单的HTTP请求，旨在利用路径遍历漏洞。但是，重要的是要审查下载POC代码的来源，以确保该来源是可信的。在这个特定的例子中，提供的YAML文件只包含一个GET请求，用于尝试读取/etc/passwd文件。不存在任何恶意代码或旨在修改系统的指令。因此，投毒风险为0%。

**利用方式：**
利用方式是构造包含路径遍历序列（例如`..`）的恶意HTTP请求。这些序列允许攻击者绕过服务器的目录限制，并访问服务器文件系统上的任意文件。漏洞存在于Spring Framework的WebMvc.fn或WebFlux.fn处理静态资源请求的方式中。攻击者通过发送包含`GET /static/link/%2e%2e/etc/passwd HTTP/1.1` 类似的请求来利用此漏洞。如果服务器没有正确验证和清理用户提供的路径，它将允许攻击者读取诸如`/etc/passwd`之类的敏感文件。

**项目地址:** [GhostS3c/CVE-2024-38819](https://github.com/GhostS3c/CVE-2024-38819)

**漏洞详情:** [CVE-2024-38819](https://nvd.nist.gov/vuln/detail/CVE-2024-38819)