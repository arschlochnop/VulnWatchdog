## CVE-2011-2523-vsftpd 2.3.4 Backdoor Command Execution

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可直接获取服务器控制权限

**影响版本:** 2.3.4 (仅限于20110630至20110703期间下载的版本)

**利用条件:** 目标系统运行受影响的vsftpd 2.3.4版本，并且攻击者可以访问目标服务器的21端口(FTP)和6200端口(后门shell)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523 是 vsftpd 2.3.4 的一个后门漏洞。该后门存在于 2011 年 6 月 30 日至 2011 年 7 月 3 日期间下载的 vsftpd 2.3.4 版本中。该漏洞允许攻击者通过发送包含 ":)" 的用户名来触发后门，然后在目标服务器的 6200 端口上打开一个 shell。 

**利用方式：**

1.  **连接FTP服务:** 攻击者首先连接到目标服务器的 FTP 服务（通常是 21 端口）。
2.  **触发后门:** 攻击者使用特殊的用户名 "USER friend:)" 尝试登录。这个用户名中的 ":)" 字符串会触发 vsftpd 中的后门。
3.  **连接后门端口:**  后门被触发后，vsftpd 会在目标服务器的 6200 端口上打开一个监听的 shell。
4.  **执行命令:** 攻击者连接到 6200 端口，即可执行任意命令，从而控制服务器。

**POC有效性分析：**

提供的 Python 脚本利用了这一漏洞。它首先连接到 FTP 服务器，发送包含 ":)" 的用户名，然后尝试使用 `nc` 连接到 6200 端口执行base64编码后的reverse shell Payload。脚本中使用了 `timeout 5 nc` 命令，限制了连接时间。如果目标服务器存在漏洞，脚本应能成功建立反向 shell。

**投毒风险分析：**

该脚本的主要目的是利用已知的后门漏洞，本身功能明确，但仍然存在一定投毒风险的可能性：

*   **Reverse Shell Payload:** 脚本中包含一个 reverse shell payload。虽然这是漏洞利用的一部分，但如果用户不小心使用了指向恶意服务器的 IP 地址和端口，可能会导致自身被攻击。因此，使用前需要仔细检查 `localaddress` 和 `localport` 参数。
*   **Base64 编码：** 使用 base64 编码对payload进行编码，增加了代码的可读性，减少了被安全软件检测到的可能性。
*  **subprocess模块:** 使用subprocess模块有执行系统命令的风险,攻击者可以通过修改payload来执行恶意代码.

虽然该脚本看起来主要功能是漏洞利用，但潜在的投毒风险在于，攻击者可能通过修改脚本中的 reverse shell payload 来实现其他恶意目的。**投毒风险评估为10%**。



**项目地址:** [lghost256/vsftpd234-exploit](https://github.com/lghost256/vsftpd234-exploit)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)