## CVE-2021-41773 – Apache HTTP Server 2.4.49 远程代码执行

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历导致远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未授权的攻击者读取任意文件并执行任意代码

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache 2.4.49，并且开启了CGI支持，对Alias配置的目录没有做严格的权限限制（例如 require all denied）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于对路径规范化处理不当导致。攻击者可以利用 `%2e` 等编码字符进行路径遍历攻击，访问受限目录之外的文件。如果服务器启用了 CGI，则可以通过构造包含恶意命令的 HTTP 请求来执行任意代码。

**漏洞利用方式：**

1.  **路径遍历：** 利用 `/.%2e` 序列绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 访问 `cgi-bin` 目录下的文件（或其他配置为 CGI 处理的目录），并在 POST 数据中注入命令，让服务器执行。
3.  **远程代码执行：** 通过执行 `/bin/bash` 或其他 shell 程序，执行任意系统命令。

**POC有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（README.md），该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用，搜索结果也证实了这一点。提供的 README.md 详细描述了漏洞的原理、利用方法和演示，并给出了可用的 `curl` 命令示例。

**投毒风险分析：**

分析提供的 README.md 文件， 其中包含的curl命令，本质上是利用漏洞执行bash命令，这个本身是漏洞利用的正常方式，不能算作投毒行为，图片文件没有发现可疑代码.

虽然直接可识别的投毒代码的可能性较低，但仍存在以下潜在风险：

*   **依赖性风险：** 如果 exploit 依赖于外部资源（例如，下载脚本或库），则这些资源可能被篡改，从而引入恶意代码。
*   **隐蔽的 Payload：** 恶意代码可能隐藏在看似无害的注释、变量名或字符串中，需要更深入的代码分析才能发现。
*   **误导性信息：** README.md 文件中的信息可能具有误导性，导致使用者在不知情的情况下执行恶意操作。

综合以上因素，我估计存在10%的投毒风险，主要是考虑到潜在的隐蔽Payload和对外部资源的依赖风险。

为了降低风险，建议：

*   仔细审查所有代码，包括注释和变量名。
*   在隔离的环境中运行 POC 代码。
*   使用最新的安全工具检测潜在的恶意代码。
*   关注与此漏洞相关的安全信息和更新。

**项目地址:** [CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE](https://github.com/CyberQuestor-infosec/CVE-2021-41773-Apache_2.4.49-Path-traversal-to-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)