## CVE-2023-4357-Chrome-XXE

**漏洞编号:** CVE-2023-4357

**漏洞类型:** XXE

**影响应用:** Google Chrome, Chromium, Electron, 微信Mac版

**危害等级:** 高危，可能导致本地文件泄露

**影响版本:** < 116.0.5845.96 (Chrome, Chromium), < 26.1.0 (Electron), < 3.8.5.17 (微信Mac版)

**利用条件:** 需要用户使用受影响版本的浏览器访问恶意构造的HTML页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4357 是一个存在于 Google Chrome 和 Chromium 中的 XXE 漏洞。该漏洞源于对 XML 输入的验证不足，攻击者可以通过构造恶意的 HTML 页面，利用 `document()` 函数包含外部 XML 文档时 Chromium 不进行跨域校验的缺陷，读取用户的本地文件。

**有效性：**
提供的 POC 代码有效。根据 README.md 中的复现步骤和截图，该 POC 能够在 Linux、Windows 和 MacOS 系统上利用 Chromium 或微信 Mac 版读取本地文件。

**投毒风险：**
该仓库存在一定的投毒风险，可能性为10%。主要考虑以下几点：
1.  **单文件漏洞利用的思路：** 自我包含的绕过方式较为巧妙，但代码相对复杂，存在隐藏恶意代码的可能性。
2.  **脚本代码：** d.svg文件包含javascript代码，虽然这段代码的功能是显示读取到的文件内容，但理论上可以被修改为执行其他恶意操作，例如将文件内容发送到远程服务器。
3.  **复现步骤：** 复现步骤中需要运行Web服务，如果攻击者篡改了Web服务提供的文件，也可能造成投毒。因此，用户在使用该 POC 时应仔细检查代码，确保其安全性。

**利用方式：**
1.  攻击者创建一个恶意的 SVG 文件（d.svg），其中包含一个指向自身的 XSL 样式表。
2.  XSL 样式表利用 `document()` 函数包含外部 XML 文档，绕过同源策略。
3.  XSL 样式表中的实体声明尝试读取本地文件（例如 /etc/passwd 或 c:/windows/system.ini）。
4.  用户使用受影响的 Chrome 或 Chromium 版本访问该 SVG 文件。
5.  浏览器解析 SVG 文件，执行 XSL 样式表，从而读取用户本地文件。
6.  读取到的文件内容通过 JavaScript 显示在页面上，或被发送到攻击者的服务器。

**项目地址:** [xcanwin/CVE-2023-4357-Chrome-XXE](https://github.com/xcanwin/CVE-2023-4357-Chrome-XXE)

**漏洞详情:** [CVE-2023-4357](https://nvd.nist.gov/vuln/detail/CVE-2023-4357)