## CVE-2024-4367-PDF.js-任意JavaScript代码执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** 任意JavaScript代码执行

**影响应用:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**利用条件:** 需要用户打开恶意PDF文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4367是Mozilla PDF.js中的一个漏洞，由于处理字体时缺少类型检查，允许在PDF.js上下文中执行任意JavaScript代码。攻击者可以构造恶意的PDF文件，当受害者使用存在漏洞的Firefox、Firefox ESR或Thunderbird打开该文件时，即可执行嵌入的JavaScript代码。

**有效性：**
提供的POC代码利用了该漏洞。`CVE-2024-4367.py`脚本能够生成包含恶意JavaScript代码的PDF文件，这段代码被嵌入到PDF的字体定义中。搜索结果中`exfil0/WEAPONIZING-CVE-2024-4367`也印证了该漏洞的可利用性。

**投毒风险：**
查看提供的代码，`CVE-2024-4367.py`脚本的功能是生成包含用户指定payload的PDF文件，没有发现恶意代码或后门。`win_calc.pdf`文件直接包含执行`calc`程序的 JavaScript 代码，功能明确。`xss.pdf` 文件内容不完整，无法分析。因此，该仓库的投毒风险较低。

**利用方式：**
1.  攻击者使用`CVE-2024-4367.py`脚本，通过命令行参数指定要执行的JavaScript代码，生成恶意的PDF文件。
2.  攻击者诱使用户打开该PDF文件，例如通过电子邮件、网站等方式。
3.  当用户使用存在漏洞的Firefox、Firefox ESR或Thunderbird打开该PDF文件时，PDF.js解析器会执行PDF文件中嵌入的恶意JavaScript代码。
4.  该JavaScript代码可以执行任意操作，例如窃取用户信息、安装恶意软件等。

总之，此漏洞的CVSS评分为Medium（5.6），但是通过修改NVD数据可以看到，该漏洞可能造成的危害程度是很高的。攻击者可以通过构造恶意PDF文件，诱骗用户打开，从而执行任意JavaScript代码，导致严重的后果。提供的PoC的有效性较高，且当前代码未发现存在投毒风险。

**项目地址:** [VVeakee/CVE-2024-4367](https://github.com/VVeakee/CVE-2024-4367)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)