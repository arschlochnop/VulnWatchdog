## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感信息和执行未授权操作

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。该漏洞源于 Next.js 处理 `x-middleware-subrequest` header 的方式存在设计缺陷。攻击者可以利用该 header 绕过中间件中的授权检查，从而访问受保护的资源。根据搜索引擎的结果，多个安全厂商都关注并分析了该漏洞，确认其影响和利用方式。提供的POC代码包含了一个简单的 Next.js 应用，该应用使用中间件进行身份验证。漏洞利用的方式是构造包含特定 `x-middleware-subrequest` header 的请求，绕过中间件的授权检查，从而访问 `/dashboard` 页面，即使没有有效的 token。投毒风险较低，因为代码量较少，主要逻辑集中在 `middleware.js` 文件中，其中包含验证逻辑和路由重定向。尽管可能性较低，`package-lock.json` 中可能存在依赖投毒的风险，或者作者通过其他不明显的方式添加恶意代码。`lib/auth.js`（未提供）也可能存在后门或漏洞。因此，总体投毒风险估计为 10% 。

**项目地址:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)