## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (requires PHP 8)

**利用条件:** 需要 WordPress 运行在 PHP 8 环境，且攻击者需要具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞。该漏洞允许具有上传文件权限的用户（例如，作者）通过上传包含恶意 XML 内容的文件（如特制的 WAVE 文件）来执行 XXE 攻击。

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息、搜索引擎结果和 POC 代码的 README.md 文件均描述了该漏洞的利用方式和影响。

**投毒风险分析：**
提供的漏洞利用代码（README.md）主要描述了漏洞的原理、利用方法和修复方案，并未发现明显的恶意代码或后门。其核心步骤包括：

1.  创建一个包含恶意 XML 内容的 WAVE 文件。
2.  搭建一个 HTTP 服务器，用于接收 XXE 攻击泄露的数据。
3.  将恶意 WAVE 文件上传到 WordPress 的媒体库。
4.  从 HTTP 服务器的日志中获取泄露的敏感信息（例如，wp-config.php 中的数据库凭据）。

虽然代码本身没有直接的投毒行为，但攻击者可能利用泄露的数据库凭据进一步入侵系统。因此，投毒风险较低，估计为 5%。

**利用方式分析：**
该漏洞的利用方式主要分为以下几个步骤：

1.  **权限获取：** 攻击者需要具备 WordPress 中上传文件的权限（如 Author 角色）。
2.  **恶意文件制作：** 攻击者需要构造一个恶意的 WAVE 文件，该文件包含指向外部实体的 XML 内容，用于触发 XXE 漏洞。DTD文件包含需要泄露的文件路径，例如 wp-config.php。
3.  **HTTP服务器搭建：** 攻击者需要搭建一个 HTTP 服务器，用于接收来自 WordPress 服务器的请求，这些请求包含通过 XXE 漏洞泄露的敏感信息。Zlib解码用于有效的提取数据
4.  **文件上传：** 攻击者将制作好的恶意 WAVE 文件上传到 WordPress 的媒体库。
5.  **信息泄露：** 当 WordPress 解析上传的 WAVE 文件时，会触发 XXE 漏洞，导致服务器向攻击者的 HTTP 服务器发送包含敏感信息的请求。
6.  **数据提取：** 攻击者从 HTTP 服务器的日志中提取泄露的敏感信息，例如 wp-config.php 文件中的数据库凭据。
7.  **后续利用：** 攻击者可以利用泄露的数据库凭据登录数据库，并进一步获取管理员权限，甚至控制整个 WordPress 网站。

**项目地址:** [Abdulazizalsewedy/CVE-2021-29447](https://github.com/Abdulazizalsewedy/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)