## CVE-2022-24706 - Apache CouchDB 远程代码执行

**漏洞编号:** CVE-2022-24706

**漏洞类型:** 远程代码执行

**影响应用:** Apache CouchDB

**危害等级:** 高危，未经身份验证的攻击者可获取管理员权限并执行任意代码

**影响版本:** <= 3.2.1

**利用条件:** CouchDB服务器未正确配置，默认安装且未更改默认Erlang cookie

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-24706是Apache CouchDB中存在的一个远程代码执行漏洞。漏洞的根本原因是CouchDB在默认配置下使用不安全的 Erlang cookie。如果 CouchDB 未进行安全配置（例如，使用防火墙或更改默认 Erlang cookie），未经身份验证的攻击者可以通过利用这个漏洞获得管理员权限并在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。多个来源证实了漏洞的存在和严重性，并有公开可用的漏洞利用代码。提供的POC代码（README.md）本身不包含利用代码，但表明存在利用该漏洞的PoC。

**投毒风险：**
提供的POC代码（README.md）非常简单，仅包含漏洞名称和 POC 描述，没有发现明显的恶意代码。但是，不排除其他相关的利用代码中存在投毒的可能性。风险评估为10%，因为仅仅是readme文件，无法进行利用。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用默认的、不安全的 Erlang cookie 绕过身份验证。
2.  **获取管理员权限：** 成功绕过身份验证后，攻击者获得 CouchDB 的管理员权限。
3.  **远程代码执行：** 利用管理员权限，攻击者可以执行任意代码，控制 CouchDB 服务器。通常会利用CouchDB的API接口执行恶意操作。

**防范措施：**
*   升级到 CouchDB 3.2.2 或更高版本。
*   更改默认的 Erlang cookie。
*   使用防火墙限制对 CouchDB 服务器的访问。
*   参考 CouchDB 官方文档进行安全配置。

**项目地址:** [superzerosec/CVE-2022-24706](https://github.com/superzerosec/CVE-2022-24706)

**漏洞详情:** [CVE-2022-24706](https://nvd.nist.gov/vuln/detail/CVE-2022-24706)