## CVE-2017-7921-Hikvision-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致未授权访问、信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备在受影响的版本范围内，且允许网络访问HTTP(默认80端口)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision相机中存在的一个不当身份验证漏洞。攻击者可以通过构造特殊的HTTP请求绕过身份验证，获取敏感信息，例如用户名和密码，或者提升权限。

**漏洞利用方式：**
1.  攻击者发送一个包含特定`auth`参数的HTTP GET请求到`/Security/users`和`/System/configurationFile`这两个URL。例如：`http://<IP>:<PORT>/Security/users?auth=YWRtaW46MTEK` 和 `http://<IP>:<PORT>/System/configurationFile?auth=YWRtaW46MTEK`
2.  如果设备存在漏洞，服务器会返回包含用户信息的XML或配置文件。
3.  利用脚本中的`config_decryptor`函数解密配置文件中的用户名和密码。

**有效性评估：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码的有效性较高。搜索结果显示，多个来源证实了该漏洞的存在，并且有公开的漏洞利用方法。

**投毒风险评估：**
代码分析表明存在轻微的投毒风险。`exploit_detect.py` 主要功能是检测漏洞和提取凭据。然而，`save_to_file` 函数的存在可能被滥用。攻击者如果控制了该脚本的使用环境，可能会通过修改脚本，将扫描结果发送到攻击者控制的服务器，或者植入其他恶意代码。因此，投毒风险评估为10%。脚本本身利用了已知的漏洞，但其结果收集和处理部分存在潜在的风险。


**项目地址:** [b3pwn3d/CVE-2017-7921](https://github.com/b3pwn3d/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)