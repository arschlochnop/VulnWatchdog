## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)