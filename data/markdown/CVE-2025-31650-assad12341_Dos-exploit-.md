## CVE-2025-31650-Apache Tomcat-DoS

**漏洞编号:** CVE-2025-31650

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache Tomcat

**危害等级:** 高危，导致服务不可用

**影响版本:** 9.0.76 <= version <= 9.0.102, 10.1.10 <= version <= 10.1.39, 11.0.0-M2 <= version <= 11.0.5

**利用条件:** 需要目标服务器支持HTTP/2并且端口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31650是Apache Tomcat中的一个不当输入验证漏洞。 由于对某些无效的HTTP优先级标头的错误处理导致未完全清理失败的请求，从而导致内存泄漏。 大量此类请求可能会触发OutOfMemoryException，从而导致拒绝服务。

**利用方式:**

1.  **目标确认:** 确认目标服务器运行的Apache Tomcat版本受此漏洞影响，并且开启了HTTP/2。
2.  **发送恶意请求:**  利用POC代码，发送包含大量无效HTTP/2 priority标头的请求。
3.  **资源耗尽:**  服务器在处理这些恶意请求时，由于内存泄漏，资源逐渐耗尽。
4.  **拒绝服务:**  最终导致服务器内存溢出，无法正常响应请求，实现拒绝服务攻击。

**有效性分析:**

从漏洞描述和搜索引擎结果来看，该漏洞的原理是由于Tomcat在处理畸形的HTTP/2 Priority Header时，没有正确的释放资源，导致内存泄漏。PoC代码模拟了发送大量带有畸形Priority Header的HTTP/2请求，可以触发该漏洞。
从POC代码中，可以看到以下关键点：
*   使用了`httpx`库发送HTTP/2请求。
*   定义了`invalid_priorities`列表，包含了各种畸形的Priority Header值。
*   循环发送带有随机选择的畸形Priority Header的请求。
*   提供了简单的监控功能，检测目标服务器是否崩溃。

综合来看，POC代码具备利用此漏洞的能力。

**投毒风险分析:**

仔细检查了POC代码，未发现明显的恶意代码。代码主要功能是发送HTTP请求以触发漏洞，并没有执行本地文件操作、网络扫描或其他可疑行为。代码中存在对URL的校验，验证URL的可用性，代码中包含监控目标服务是否可用的代码，一旦服务不可用，则直接停止程序。可以判断投毒风险较低.代码中可能会引入一些额外的依赖，比如`colorama`仅仅是为了美化输出，并不会引入安全问题。虽然代码本身没有发现明显的投毒行为，但依然需要注意下载的来源，防止被替换为恶意版本，增加评估的安全性。


**项目地址:** [assad12341/Dos-exploit-](https://github.com/assad12341/Dos-exploit-)

**漏洞详情:** [CVE-2025-31650](https://nvd.nist.gov/vuln/detail/CVE-2025-31650)