## CVE-2019-17572 - Apache RocketMQ 目录遍历

**漏洞编号:** CVE-2019-17572

**漏洞类型:** 目录遍历

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读取

**影响版本:** 4.2.0 to 4.6.0

**利用条件:** 自动创建Topic功能开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Apache RocketMQ 4.2.0到4.6.0版本中，当Broker的自动创建Topic功能默认开启时，攻击者可以通过发送包含目录遍历payload（如“../../../../topic2020”）的恶意Topic名称，导致Broker在父目录中创建Topic文件夹，从而实现目录遍历。 

**有效性评估：**
根据漏洞描述，漏洞利用的关键在于自动创建Topic功能是否开启，以及目标Broker是否运行在受影响的版本范围内。如果满足这两个条件，该漏洞利用是有效的。

**投毒风险评估：**
提供的代码片段是构建说明，贡献指南和许可协议，不包含实际漏洞利用的Payload。因此，直接从这些代码片段判断是否存在投毒代码是不可能的。 考虑到这些文件来自官方仓库，并且主要是构建和贡献相关的辅助文件，投毒的可能性极低，约为1%。

**漏洞利用方式：**
1.  确认目标RocketMQ Broker版本在4.2.0到4.6.0之间。
2.  确认目标Broker的`autoCreateTopicEnable`配置项开启(默认开启)。
3.  使用RocketMQ客户端，创建一个包含目录遍历Payload的Topic，例如“../../../../任意目录/topic”。
4.  Broker将会在指定目录创建Topic相关的文件夹，从而可能导致越权访问或信息泄露。

根据搜索结果，漏洞信息与NVD等权威漏洞库一致，确认了该漏洞的存在和影响。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2019-17572_4-6-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2019-17572_4-6-0)

**漏洞详情:** [CVE-2019-17572](https://nvd.nist.gov/vuln/detail/CVE-2019-17572)