## CVE-2024-27388-Linux Kernel-SUNRPC内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= version < 4.19.311, 3.10 <= version < 5.4.273, 3.10 <= version < 5.10.214, 3.10 <= version < 5.15.153, 3.10 <= version < 6.1.83, 3.10 <= version < 6.6.23, 3.10 <= version < 6.7.11, 3.10 <= version < 6.8.2, 3.10 <= version < 6.9

**利用条件:** 需要启用SUNRPC和GSS认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27388 是 Linux 内核 SUNRPC 子系统中的一个内存泄漏漏洞，位于 `gssx_dec_option_array` 函数中。当解析 GSS 安全选项数组时，如果发生错误，代码可能无法释放已分配的内存（`creds` 和 `oa->data`）。

**有效性：**
提供的代码是补丁修复前的 `gss_rpc_xdr.c` 文件的一部分，可以用来重现漏洞触发的代码环境。漏洞库信息和搜索引擎结果都证实了此漏洞的存在，并指出该漏洞会导致内存泄漏。

**投毒风险：**
仔细检查提供的 `gss_rpc_xdr.c` 代码，没有发现任何恶意代码或后门。代码逻辑是标准的 XDR 编解码操作，专注于 GSS 选项的处理。该漏洞是由于错误处理不当造成的内存泄漏，而不是故意设计的恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  攻击者需要能够触发 SUNRPC 协议，并且使用 GSS 安全认证。
2.  攻击者构造恶意的 GSS 协商请求，包含大量的或者格式错误的 GSS 选项数组。
3.  当内核解析这些恶意选项时，由于错误处理的缺陷，会发生内存泄漏。
4.  通过重复发送恶意请求，攻击者可以耗尽系统内存，导致拒绝服务。

漏洞利用的根本在于构造特殊的输入，使得 `gssx_dec_option_array` 函数在出错时未能正确释放内存。通过持续发送此类恶意请求来放大内存泄漏的影响。

**项目地址:** [Mahesh-970/CVE-2024-27388_beforPatch](https://github.com/Mahesh-970/CVE-2024-27388_beforPatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)