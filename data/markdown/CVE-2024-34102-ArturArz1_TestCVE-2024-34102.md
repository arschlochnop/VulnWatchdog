## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互或身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的 XML 文档来利用该漏洞。该漏洞的严重性在于攻击者可以通过读取服务器上的任意文件（例如 `/etc/hosts`）和潜在地执行任意代码来泄露敏感信息，比如数据库配置信息或加密密钥。提供的 POC 代码包含一个 DTD 文件 (`poc.dtd`)，该文件定义了两个实体：`%d` 用于读取 `/etc/hosts` 文件并进行 Base64 编码，`%c` 用于通过 HTTP 请求将数据发送到外部服务器 `y87clnrljqo51xfgj1gzn5iznqthhf54.oastify.com`。攻击者需要构造一个 XML 文件，该文件引用此 DTD 文件，并触发 XML 解析器执行这些实体。利用方式是发送恶意 XML 请求，触发服务器解析 XML 中的外部实体引用。服务器会尝试解析外部实体，从而泄露文件内容或建立外部连接，造成信息泄露甚至远程代码执行。投毒风险评估：虽然 POC 代码主要目的是验证漏洞，读取`/etc/hosts`，并通过oastify域名与外部服务器建立连接来显示验证结果，但`%c`实体中存在与外部服务器建立连接的部分。如果攻击者的oastify域名解析到了一个包含恶意代码的服务器，存在一定风险，因此判定投毒风险为10%。

**项目地址:** [ArturArz1/TestCVE-2024-34102](https://github.com/ArturArz1/TestCVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)