## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)