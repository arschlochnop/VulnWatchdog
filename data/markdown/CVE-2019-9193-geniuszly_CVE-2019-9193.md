## CVE-2019-9193 - PostgreSQL 9.3-11.2 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许攻击者在数据库服务器上执行任意操作系统命令

**影响版本:** 9.3 到 11.2 (据其他搜索结果显示可能到12.3)

**利用条件:** 需要PostgreSQL数据库的有效凭据（例如，用户名和密码），以及对数据库的网络访问。需要具备 `pg_execute_server_program` 权限或者超级用户权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许具有足够权限（`pg_execute_server_program` 组或超级用户）的 PostgreSQL 用户利用 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。虽然PostgreSQL官方认为这不是一个漏洞而是预期功能，但攻击者可以通过它来提升权限或控制数据库服务器。该漏洞利用方式是利用 `COPY FROM PROGRAM` 命令执行操作系统命令。提供的POC代码通过创建临时表，然后使用 `COPY` 命令从程序中读取数据，从而执行指定的命令。该脚本通过命令行参数接收数据库连接信息和要执行的命令。  

**关于有效性：** 提供的POC代码有效，它利用了 `COPY FROM PROGRAM` 功能执行系统命令。

**关于投毒风险：**  代码本身的功能是利用已知漏洞进行攻击，主要功能是连接到PostgreSQL数据库并执行指定的命令。 代码虽然有MIT开源协议，但是代码量少，逻辑简单。因此，投毒的可能性较低，假设为5%。

**关于利用方式：**
1.  攻击者需要具有有效的 PostgreSQL 数据库凭据。
2.  攻击者需要拥有 `pg_execute_server_program` 权限组的成员资格，或拥有超级用户权限。
3.  攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。
4.  POC 代码自动化了这些步骤，通过命令行参数指定连接信息和要执行的命令。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)