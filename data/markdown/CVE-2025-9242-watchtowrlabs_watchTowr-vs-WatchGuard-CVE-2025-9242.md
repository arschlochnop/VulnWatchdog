## CVE-2025-9242 WatchGuard Firebox iked Out of Bounds Write Vulnerability

**漏洞编号:** CVE-2025-9242

**漏洞类型:** Out-of-bounds Write

**影响应用:** WatchGuard Fireware OS

**危害等级:** Critical，远程代码执行

**影响版本:** 11.10.2 <= version <= 11.12.4_Update1, 12.0 <= version <= 12.11.3, 2025.1 < version < 2025.1.1

**利用条件:** 需要目标设备配置Mobile User VPN with IKEv2或Branch Office VPN using IKEv2，且配置了动态网关对等体，需要网络可达。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-9242是WatchGuard Fireware OS中的一个越界写入漏洞，存在于iked服务中。未经身份验证的远程攻击者可以通过利用此漏洞执行任意代码。漏洞影响配置了使用IKEv2的Mobile User VPN和Branch Office VPN且使用动态网关对等体的设备。提供的PoC代码（watchTowr-vs-WatchGuard-CVE-2025-9242.py）利用该漏洞在目标设备上实现远程代码执行。脚本首先检查目标WatchGuard设备的Fireware OS版本，如果版本在受影响范围内，则继续利用漏洞。脚本通过发送特制的IKEv2数据包，触发越界写入，覆盖内存中的关键数据，并最终执行攻击者提供的shellcode。PoC代码包含版本检测和漏洞利用模块，并构建了ROP链以绕过安全机制。风险方面，由于是远程代码执行漏洞，且无需身份验证，风险等级被评为Critical。PoC代码本身主要是验证漏洞的存在，并尝试执行shellcode，没有发现明显的投毒代码,少量风险来源于依赖的第三方库。投毒的风险较低，因为PoC主要目的是验证和利用漏洞，而不是进行恶意活动。

**项目地址:** [watchtowrlabs/watchTowr-vs-WatchGuard-CVE-2025-9242](https://github.com/watchtowrlabs/watchTowr-vs-WatchGuard-CVE-2025-9242)

**漏洞详情:** [CVE-2025-9242](https://nvd.nist.gov/vuln/detail/CVE-2025-9242)