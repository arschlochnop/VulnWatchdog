## CVE-2024-23113 - Fortinet Format String Vulnerability

**漏洞编号:** CVE-2024-23113

**漏洞类型:** 格式化字符串漏洞

**影响应用:** FortiOS, FortiProxy, FortiPAM, FortiSwitchManager

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS (<=7.4.2, <=7.2.6, <=7.0.13), FortiProxy (<=7.4.2, <=7.2.8, <=7.0.15), FortiPAM (1.2.0, <=1.1.2, <=1.0.3), FortiSwitchManager (<=7.2.3, <=7.0.3)

**利用条件:** 需要网络访问端口541

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23113 是 Fortinet 产品中的一个格式化字符串漏洞。攻击者可以通过构造特殊的报文，利用此漏洞在目标系统上执行未授权的代码或命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已经被实际利用。提供的PoC代码通过发送包含格式化字符串 `authip=%n` 的恶意请求，利用 FortiGate FGFM 服务 (TCP 端口 541)中的格式化字符串漏洞。如果目标设备易受攻击，服务器可能会由于格式化字符串漏洞保护机制（例如 glibc 中的 `_FORTIFY_SOURCE`）而终止连接，从而表明该设备可能存在漏洞。

**投毒风险:**
PoC 代码本身的主要功能是检测漏洞的存在，而不是直接执行恶意操作。代码首先尝试建立SSL连接，然后发送格式化字符串有效载荷。根据服务器的响应，脚本推断目标是否容易受到攻击。主要风险是误报，如果网络条件或服务器配置导致连接意外关闭，则可能会发生这种情况。PoC代码中存在细微的投毒风险，脚本只做了漏洞验证，攻击者可以复用脚本进行修改造成更大危害, 本身代码量较小，安全风险较低，因此投毒风险评估为 5%。

**利用方式:**
1.  攻击者向目标设备的 541 端口发送特制的报文。
2.  该报文包含一个格式化字符串，例如`%n`，允许攻击者写入内存地址。
3.  通过精巧地构造格式化字符串，攻击者可以覆盖内存中的函数指针或其他关键数据。
4.  一旦函数指针被覆盖，攻击者就可以控制程序的执行流程，从而执行任意代码。
5.  攻击者最终获得目标系统的控制权。

**项目地址:** [p33d/CVE-2024-23113](https://github.com/p33d/CVE-2024-23113)

**漏洞详情:** [CVE-2024-23113](https://nvd.nist.gov/vuln/detail/CVE-2024-23113)