## CVE-2018-10933 - libssh 认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，未经授权的访问

**影响版本:** 0.7.6 和 0.8.4 之前版本

**利用条件:** 目标系统运行存在漏洞版本的libssh服务且允许网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-10933是libssh服务器端状态机中的一个漏洞，存在于0.7.6和0.8.4之前的版本。恶意客户端可以在未进行身份验证的情况下创建通道，从而导致未经授权的访问。根据搜索引擎结果，该漏洞允许攻击者通过向服务器发送SSH2_MSG_USERAUTH_SUCCESS消息绕过身份验证。提供的漏洞利用代码仅包含GPL协议声明，没有发现明显的可执行代码，但可能存在通过其他方式植入恶意代码的风险，因此存在极低的投毒风险。该漏洞利用方式是发送特定的SSH消息绕过身份验证，从而获得对目标系统的访问权限。

**有效性评估：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC利用代码（虽然这里没有给出直接可用的exploit，但exploit-db链接指向了可用的exp）。所以利用是有效的，风险极高。

**投毒风险分析：** 提供的“漏洞利用代码”实际上只是一个GNU通用公共许可证，虽然许可证本身没有危害，但可能通过与其他恶意文件捆绑或作为下载恶意软件的链接存在潜在的投毒风险，但可能性极小。此许可证本身是开源协议，通常不会被用于直接的恶意目的，因此投毒风险极低。

**利用方式分析：** 攻击者通过发送一个伪造的SSH2_MSG_USERAUTH_SUCCESS消息给服务器，欺骗服务器认为已经成功通过身份验证，从而绕过正常的身份验证流程，直接建立会话并执行未授权操作。核心在于利用libssh在身份验证状态处理上的缺陷。

**项目地址:** [bidaoui4905/CVE-2018-10933](https://github.com/bidaoui4905/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)