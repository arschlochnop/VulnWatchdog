## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)