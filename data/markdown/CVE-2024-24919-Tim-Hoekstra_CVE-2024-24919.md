## CVE-2024-24919-CheckPoint-信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network); R81.10, R80.20 (Spark Gateway)

**利用条件:** 需要目标设备已连接互联网并启用了远程接入VPN或移动接入软件功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-24919是一个Check Point安全网关的信息泄露漏洞。根据漏洞信息和搜索结果，攻击者可以通过发送特制的HTTP请求，读取目标设备上的任意文件。漏洞利用代码 `exploit.py` 模拟了这一过程，它通过向目标IP地址发送POST请求，并在请求体中包含经过路径遍历处理的文件路径，从而尝试读取目标文件内容。

**有效性分析：**
根据CISA KEV，该漏洞已被积极利用。漏洞利用代码通过构造包含路径遍历的URL，尝试读取敏感文件，如`/etc/passwd`、`/etc/apache2/apache2.conf`等。如果目标设备存在漏洞且未采取缓解措施，该PoC代码很可能有效。

**投毒风险分析：**
`exploit.py` 主要功能是发送HTTP请求，没有发现明显的恶意代码。代码使用了`requests`库发送请求，并使用了`urllib3.disable_warnings(InsecureRequestWarning)` 忽略了SSL证书验证的警告。 存在一定的风险，例如：攻击者可能通过精心构造的路径，利用读取到的配置文件中的凭据、密钥等进一步攻击内网。

投毒风险较低，评估为5%。

**利用方式：**
1.  攻击者需要拥有目标Check Point安全网关的IP地址。
2.  攻击者运行`exploit.py`脚本，指定包含目标IP地址的文本文件。
3.  脚本会尝试利用路径遍历漏洞读取目标设备上的多个敏感文件。
4.  读取到的文件内容会打印到屏幕上，并可以选择保存到指定的输出文件中。

**项目地址:** [Tim-Hoekstra/CVE-2024-24919](https://github.com/Tim-Hoekstra/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)