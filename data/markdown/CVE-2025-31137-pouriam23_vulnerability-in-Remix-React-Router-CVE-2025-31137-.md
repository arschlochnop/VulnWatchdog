## CVE-2025-31137-RemixReactRouter-URL欺骗

**漏洞编号:** CVE-2025-31137

**漏洞类型:** URL欺骗

**影响应用:** Remix/React Router

**危害等级:** 高危，可能导致缓存投毒、WAF绕过，甚至权限提升。

**影响版本:** 受影响版本：Remix 2 (>= 2.11.1, < 2.16.3)，React Router 7 (>= 7.0.0, < 7.4.1)

**利用条件:** 目标应用使用Express适配器，并且使用了受影响版本的Remix或React Router。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2025-31137存在于Remix和React Router中，允许攻击者通过操纵Host或X-Forwarded-Host请求头来欺骗应用程序使用的URL。具体来说，攻击者可以将恶意URL路径名放置在Host或X-Forwarded-Host头中的端口部分，导致应用程序错误地解析URL。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已经有公开的PoC。提供的代码仓库是一个Remix应用的示例，包含了package.json声明依赖的版本，server.js配置express中间件。该示例模拟了可能存在漏洞的Remix应用，可以作为验证漏洞的基础。

**投毒风险:**
分析提供的POC代码，该代码主要包含以下文件：
*   README.md: 描述了漏洞。
*   package.json: 定义了项目依赖，包括@remix-run/express, @remix-run/node, @remix-run/react，express等。
*   postcss.config.js: PostCSS配置文件。
*   server.js: Express服务器启动文件，使用了`@remix-run/express`来处理Remix请求。
*   tailwind.config.ts: Tailwind CSS配置文件。
*   tsconfig.json: TypeScript配置文件。

通过检查这些文件，没有发现任何可疑或恶意的代码。所有依赖项看起来都是常用的、官方的库。server.js 文件主要是初始化 Express 服务器，集成 Remix 运行时环境，并处理静态资源和 SSR 请求。没有发现任何会引入恶意行为的代码。因此，**投毒风险为0%**。

**利用方式:**
1.  **构造恶意请求头：** 攻击者需要构造包含恶意URL的`Host`或`X-Forwarded-Host`请求头。URL中的端口部分包含要欺骗的路径，例如：`Host: example.com:80/malicious/path`。
2.  **发送请求：** 将构造的请求发送到使用受影响版本的Remix/React Router的应用程序。
3.  **URL欺骗：** 应用程序的路由处理逻辑会错误地解析URL，将其识别为`/malicious/path`，而不是预期的路径。
4.  **攻击后果：**
    *   **缓存投毒：** 恶意URL可能导致应用程序缓存了错误的内容，影响后续用户的访问。
    *   **WAF绕过：** 攻击者可能利用此漏洞绕过Web应用程序防火墙的URL过滤规则。
    *   **权限提升：** 在某些情况下，错误的URL解析可能导致权限验证失败，从而允许攻击者访问未经授权的资源或执行未经授权的操作。

总之，利用方式是通过构造包含恶意URL的特定请求头来欺骗应用程序，导致URL解析错误，从而达到攻击的目的。

**项目地址:** [pouriam23/vulnerability-in-Remix-React-Router-CVE-2025-31137-](https://github.com/pouriam23/vulnerability-in-Remix-React-Router-CVE-2025-31137-)

**漏洞详情:** [CVE-2025-31137](https://nvd.nist.gov/vuln/detail/CVE-2025-31137)