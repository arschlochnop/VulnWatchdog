## CVE-2025-6058 WPBookit <= 1.0.4 - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-6058

**漏洞类型:** 任意文件上传

**影响应用:** WPBookit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0.4

**利用条件:** 目标 WordPress 站点安装了 WPBookit 插件，且版本不高于 1.0.4，攻击者可以无需认证即可访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 WPBookit 插件的 `image_upload_handle()` 函数中，该函数缺少文件类型验证，允许未经身份验证的攻击者上传任意文件。攻击者可以通过发送包含恶意 PHP 代码的文件到 `/wp-admin/admin-ajax.php` 接口，并设置 `action` 参数为 `wpb_ajax_post`，`route_name` 参数为 `add_booking_type`。上传成功后，可以通过访问上传的文件（shell.php），执行任意代码。漏洞利用代码首先检查插件版本是否在受影响范围内，如果存在漏洞，则生成一个包含 PHP 命令执行代码的 shell.php 文件，然后通过 POST 请求上传该文件，并尝试访问该文件。如果成功访问，则说明漏洞利用成功。分析POC代码，该脚本相对简单，主要目的是利用漏洞上传webshell，没有发现明显的恶意投毒代码，但仍需谨慎，因为任何webshell都可能被用于恶意目的。投毒风险低是因为代码比较清晰，功能单一。

**项目地址:** [Nxploited/CVE-2025-6058](https://github.com/Nxploited/CVE-2025-6058)

**漏洞详情:** [CVE-2025-6058](https://nvd.nist.gov/vuln/detail/CVE-2025-6058)