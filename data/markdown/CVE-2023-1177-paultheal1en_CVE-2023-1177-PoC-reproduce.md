## CVE-2023-1177-MLflow-Path Traversal

**漏洞编号:** CVE-2023-1177

**漏洞类型:** Path Traversal/Local File Inclusion (LFI)

**影响应用:** MLflow

**危害等级:** 高危，可能导致敏感信息泄露和部分完整性破坏

**影响版本:** <= 2.1.1 (根据 PoC), <= 2.2.0 (根据 CVE 库), 实际修复可能在 2.3.1 之后

**利用条件:** 需要能够访问MLflow服务，并能创建model version

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1177 是 MLflow 中的一个路径遍历漏洞，允许攻击者读取服务器上的任意文件。漏洞存在于 `GET /model-versions/get-artifact` endpoint 对路径的处理中。攻击者可以通过以下步骤利用该漏洞：

1.  创建一个恶意 model version，将其 `source` 字段设置为 `file:///` 开头的本地文件系统路径。
2.  调用 `get-artifact` endpoint，并提供一个 `path` 参数，该参数相对于 `source` 指定的文件路径。例如，如果 `source` 是 `file:///etc/`, 并且 `path` 是 `passwd`, 则攻击者可以读取 `/etc/passwd` 文件的内容。

根据提供的 PoC 代码，该漏洞利用方式有效。搜索结果也确认了该漏洞的存在和影响。PoC通过构造恶意的 model version 并访问相应的 artifact 来读取文件。environment.yml文件定义了PoC所需的依赖，主要是mlflow旧版本，pandas，requests等。

**关于投毒风险：**

该仓库包含一个用于重现漏洞的PoC和环境设置文件，主要的风险在于environment.yml，其中定义了需要安装的依赖包。理论上存在投毒的可能性，攻击者可以在依赖项中引入恶意代码，或者直接修改PoC代码。但是从代码内容来看，环境设置文件看起来比较正常，没有明显的恶意行为。虽然存在风险，但是相对较小。
从安全角度出发，建议在受控环境中运行PoC，并仔细检查environment.yml文件和任何其他的代码文件, 同时注意MLflow服务的权限。

根据漏洞库信息，攻击复杂度较低，攻击向量为网络，无需权限，用户无需交互，但影响范围是改变了，造成高机密性影响和低完整性影响。

**项目地址:** [paultheal1en/CVE-2023-1177-PoC-reproduce](https://github.com/paultheal1en/CVE-2023-1177-PoC-reproduce)

**漏洞详情:** [CVE-2023-1177](https://nvd.nist.gov/vuln/detail/CVE-2023-1177)