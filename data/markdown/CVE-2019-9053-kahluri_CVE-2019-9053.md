## CVE-2019-9053 - CMS Made Simple SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露

**影响版本:** 2.2.8 (受影响); < 2.2.10 (已修复)

**利用条件:** 需要能够访问存在漏洞的CMS Made Simple站点，并且News模块已启用。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.8版本中存在的一个时间盲注SQL注入漏洞。该漏洞位于News模块，攻击者可以通过构造包含恶意SQL语句的URL的`m1_idlist`参数，来执行未经验证的SQL注入攻击。由于是时间盲注，攻击者通过观察服务器响应时间来推断SQL查询的结果，从而提取数据库中的敏感信息，例如用户名、密码哈希以及salt。

**漏洞利用方式：**

1.  **确定目标：** 找到运行CMS Made Simple 2.2.8 (或其他受影响版本) 并且安装了News模块的网站。
2.  **构造恶意URL：** 构造包含恶意SQL语句的URL，主要利用了`moduleinterface.php`文件和`m1_idlist`参数。POC代码中可见，注入的payload会使用`sleep()`函数来造成时间延迟。
3.  **信息提取：** 通过脚本自动化地发送请求，并根据响应时间判断SQL查询的结果，逐步提取数据库中的信息，例如salt、用户名和密码哈希。
4.  **密码破解：** 获得salt和密码哈希后，可以使用字典攻击或彩虹表等方法破解管理员密码。

**POC代码分析：**

提供的Python脚本(CVE-2019-9053.py)实现了上述攻击过程。脚本包含以下关键功能：

*   **参数解析：** 使用`optparse`模块解析命令行参数，例如目标URL、字典文件路径等。
*   **会话管理：** 使用`requests.Session()`创建会话，以保持连接。
*   **SQL注入：** 构造包含`sleep()`函数的时间盲注payload，并通过`m1_idlist`参数发送到目标服务器。
*   **信息提取：** 通过比较请求的响应时间与预设的阈值`TIME`，判断SQL查询的结果，从而提取salt、用户名和密码哈希。
*   **密码破解：** 如果提供了字典文件，脚本会尝试使用salt和字典中的密码进行哈希计算，与提取的密码哈希进行比较，从而破解密码。

**投毒风险分析：**

虽然POC代码的作者信息存在，但仍需要评估潜在的投毒风险。检查了POC代码，发现存在潜在的风险,主要集中在代码的可读性和潜在的恶意行为。

*   **不明显的恶意行为：**代码主要功能是利用SQL注入漏洞，并没有明显的后门或恶意代码。但是，攻击脚本的本质决定了其具有潜在的恶意用途。

综合分析，可以判断此仓库中作者隐藏的投毒代码的可能性较低，估计在1%左右。主要是作者直接上传了漏洞利用的源代码，目标明确。

**项目地址:** [kahluri/CVE-2019-9053](https://github.com/kahluri/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)