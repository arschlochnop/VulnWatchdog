## CVE-2024-21413 - Microsoft Outlook Remote Code Execution

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001)，Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021，直到aka.ms/OfficeSecurityReleases上发布的修复版本。

**利用条件:** 需要受害者打开包含恶意链接的电子邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是 Microsoft Outlook 中的一个远程代码执行漏洞。攻击者可以通过发送特制的电子邮件，诱导受害者点击其中的恶意链接，从而在受害者系统上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经被积极利用。提供的POC代码尝试通过发送包含`file://`协议URL的电子邮件，来触发漏洞。这种方法利用了Outlook处理`file://`链接时的不当输入验证。

**投毒风险分析：**
检查提供的Python脚本和README文件，没有发现明显的恶意代码或后门。脚本的主要功能是构建和发送包含恶意链接的电子邮件。风险主要在于：

*   **脚本可能被修改：**  攻击者可能修改该脚本，例如更改默认的IP地址，添加额外的payload等，用以进行更隐蔽或更具破坏性的攻击。
*   **依赖项风险：**  脚本依赖于`smtplib`库，理论上，该库本身也可能存在潜在的安全问题，但这种可能性较低。
*   **密码泄露风险：** 使用脚本时，发送者的电子邮件密码会以明文形式传递，存在泄露的风险。
*  **接收者打开邮件和点击链接:** 接收者需要打开邮件，并且点击邮件中的链接才会触发，一定程度上限制了利用成功率

因此，将该POC代码本身视为投毒的概率较低，大约为5%。

**利用方式分析：**
1.  **攻击者准备：**
    *   攻击者需要一个SMTP服务器来发送电子邮件。
    *   攻击者需要一个可访问的服务器，并监听特定的端口，以便在受害者点击链接后接收连接。
2.  **漏洞利用：**
    *   攻击者使用POC脚本，指定发送者、接收者、SMTP服务器和攻击者监听的IP地址。
    *   脚本构建包含`file://{args.ip}/` URL的电子邮件，并将其发送给受害者。
3.  **受害者交互：**
    *   受害者打开电子邮件，并点击其中的链接。
    *   Outlook尝试访问`file://{args.ip}/` URL，由于输入验证不足，可能导致执行恶意代码。

总而言之，该漏洞的利用方式依赖于发送包含恶意`file://`链接的电子邮件，并诱导受害者点击该链接。成功利用该漏洞，可以导致远程代码执行。


**项目地址:** [th3Hellion/CVE-2024-21413](https://github.com/th3Hellion/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)