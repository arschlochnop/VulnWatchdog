## CVE-2007-6750 - Apache HTTP Server Slowloris DoS

**漏洞编号:** CVE-2007-6750

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致服务中断

**影响版本:** Apache HTTP Server 1.x 和 2.x (2.2.15之前)

**利用条件:** 目标服务器运行受影响的Apache版本，且没有适当的缓解措施（如mod_reqtimeout或连接限制）。需要能够建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-6750 描述的是 Apache HTTP Server 1.x 和 2.x 中存在的拒绝服务漏洞。该漏洞允许远程攻击者通过发送部分 HTTP 请求来耗尽服务器资源，导致服务中断。这种攻击方式被称为 Slowloris。该漏洞是由于服务器缺乏适当的请求超时机制（在2.2.15之前的版本中缺少 mod_reqtimeout 模块）造成的。

**有效性分析：**

根据漏洞描述和搜索引擎结果，提供的 Python 脚本 `slow.py` 是一个 Slowloris 攻击的 PoC 实现。该脚本通过创建大量连接并缓慢发送 HTTP 请求头来耗尽服务器的连接资源。通过搜索引擎结果中`http://ha.ckers.org/slowloris/` 可以确定该poc的有效性。

**投毒风险分析：**

查看`slow.py` 脚本。主要功能是创建socket连接，通过循环发送不完整的HTTP请求，使服务器资源耗尽。
*  `requirements.txt` 依赖库 `pysocks` 和 `argparse` 是常用库，没有发现恶意依赖。
*  `slow.py` 脚本逻辑相对简单，主要包含：socket创建、连接、发送部分请求头。其中使用了 `time.sleep` 来模拟缓慢发送请求。攻击行为本身是已知的 Slowloris 攻击，没有发现隐藏的恶意代码。
*  TOR支持功能是合法的，允许攻击者匿名发起攻击。

尽管脚本本身实现了 Slowloris 攻击，但没有发现明显的投毒代码。`send_payload` 函数中会输出 payload 成功和失败的统计，方便观察攻击效果。 因此，可以认为该仓库存在一定的投毒风险，但可能性较低，主要风险在于使用者可能被利用进行非授权的渗透测试或攻击。

**利用方式：**

1.  **环境准备：** 安装 Python 3 和所需的依赖库 (`pysocks`, `argparse`)。可以使用 `pip install -r requirements.txt` 安装依赖。
2.  **运行脚本：** 使用 `python slow.py <目标主机:端口>` 运行脚本。可以调整线程数 (`-n`) 和连接保持时间 (`-k`) 等参数来优化攻击效果。
3.  **攻击原理：** 脚本会创建多个线程，每个线程创建多个 socket 连接，然后向目标服务器发送部分 HTTP 请求头。由于请求头不完整，服务器会保持连接打开等待剩余的数据，从而占用大量连接资源。当服务器的连接数达到上限时，将无法处理新的请求，导致拒绝服务。
4.  **可选 TOR 匿名：** 可以通过添加 `-t` 参数，使用TOR代理来匿名发起攻击。需要确保本地运行有Tor代理，并且`-sh` 和 `-sp` 参数对应tor代理的地址和端口。

**缓解措施：**

*   升级 Apache HTTP Server 到 2.2.15 或更高版本，这些版本包含了 mod_reqtimeout 模块，可以限制请求的超时时间。
*   使用 Web 应用防火墙 (WAF) 或反向代理来限制连接数和请求速率。
*   调整 Apache HTTP Server 的配置，如 `Timeout` 和 `KeepAliveTimeout`，以减少连接的保持时间。

**项目地址:** [Jeanpseven/slowl0ris](https://github.com/Jeanpseven/slowl0ris)

**漏洞详情:** [CVE-2007-6750](https://nvd.nist.gov/vuln/detail/CVE-2007-6750)