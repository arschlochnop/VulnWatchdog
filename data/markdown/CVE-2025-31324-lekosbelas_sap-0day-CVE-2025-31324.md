## CVE-2025-31324-SAP NetWeaver Visual Composer Metadata Uploader-任意文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 任意文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 需要网络访问目标SAP系统的/developmentserver/metadatauploader接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-31324 存在于 SAP NetWeaver Visual Composer Metadata Uploader 中，由于缺少适当的授权检查，未经身份验证的攻击者可以上传恶意可执行二进制文件，从而严重损害主机系统。此漏洞的 CVSS 3.1 评分为 10.0，表明其具有极高的风险。搜索结果表明该漏洞已被积极利用，甚至被与中国相关的 APT 组织利用。漏洞利用代码 (sap7.4poc.py) 使用 Python 编写，通过构造包含恶意 payload 的 zip 文件并通过 HTTP POST 请求将其发送到 /developmentserver/metadatauploader 接口来利用此漏洞。代码中包含一个随机文件名生成器，用于生成 jsp shell 的文件名。代码尝试通过替换序列化 ID 来兼容不同版本的 SAP NetWeaver。

**有效性：**
POC代码有效。该代码可以上传任意文件到目标服务器，并包含绕过某些版本检测的逻辑。

**投毒风险：**
POC代码包含大量 "MADE BY SCATTERED LAPSUS$ HUNTERS ---- SHINYHUNTERS ---- fuck da CCP man dey stole our 0day frfr ---- MADE BY SCATTERED LAPSUS$ HUNTERS ---- SHINYHUNTERS ----" 这样的字符串，从代码质量和可读性角度来说比较可疑。但是，这些字符串本身不构成恶意代码。另外，代码中使用 `requests` 库发送 HTTP 请求，存在中间人攻击的风险，如果攻击者能够篡改请求，则可能注入恶意代码。总体来说，存在一定的投毒风险，主要体现在代码的混乱性和可能的中间人攻击风险上，但没有明显的后门或者恶意逻辑。

**利用方式：**
1.  攻击者构造包含恶意 JSP shell 的 .properties 文件。
2.  POC脚本将该文件压缩为 zip 文件。
3.  POC脚本通过 HTTP POST 请求将 zip 文件上传到 SAP NetWeaver Visual Composer 的 /developmentserver/metadatauploader 接口，CONTENTTYPE=MODEL&CLIENT=1。
4.  由于缺少身份验证，上传的文件会被服务器接受。
5.  攻击者可以通过访问上传的 JSP shell 执行任意命令。

**项目地址:** [lekosbelas/sap-0day-CVE-2025-31324](https://github.com/lekosbelas/sap-0day-CVE-2025-31324)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)