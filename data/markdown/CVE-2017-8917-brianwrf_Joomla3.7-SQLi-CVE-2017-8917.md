## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)