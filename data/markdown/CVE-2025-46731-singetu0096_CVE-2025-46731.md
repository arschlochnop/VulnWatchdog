## CVE-2025-46731 - Craft CMS Twig SSTI RCE

**漏洞编号:** CVE-2025-46731

**漏洞类型:** Twig SSTI (服务器端模板注入)

**影响应用:** Craft CMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 4.x < 4.14.13, 5.x < 5.6.16

**利用条件:** 需要管理员权限和ALLOW_ADMIN_CHANGES设置为true

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2025-46731 存在于 Craft CMS 中，是一个 Twig SSTI 漏洞，允许经过身份验证的攻击者（需要管理员权限并启用 ALLOW_ADMIN_CHANGES）执行任意代码。漏洞存在于 Craft CMS 4.x 版本低于 4.14.13 和 5.x 版本低于 5.6.16。提供的 POC 代码 `/tmp/4f9d71cf8b2bb7de0a61eb95c7118803/README.md` 仅包含 CVE 编号，本身不具备任何利用功能，所以有效性很低，只是一个标记。仓库中没有发现隐藏的投毒代码，所以投毒风险为0%。

**利用方式：**

1.  攻击者必须拥有 Craft CMS 的管理员权限。
2.  `ALLOW_ADMIN_CHANGES` 配置项必须设置为 `true`，这通常是为了允许在生产环境中进行管理员更改，但会增加安全风险。
3.  利用 Twig 模板引擎的 SSTI 漏洞，通过构造恶意的 Twig 表达式，执行任意代码。

**缓解措施：**

1.  将 Craft CMS 升级到 4.14.13 或 5.6.16 或更高版本。
2.  在生产环境中，将 `ALLOW_ADMIN_CHANGES` 设置为 `false`，除非有充分的理由需要启用它。参见：[https://craftcms.com/knowledge-base/securing-craft#set-allowAdminChanges-to-false-in-production](https://craftcms.com/knowledge-base/securing-craft#set-allowAdminChanges-to-false-in-production)

**项目地址:** [singetu0096/CVE-2025-46731](https://github.com/singetu0096/CVE-2025-46731)

**漏洞详情:** [CVE-2025-46731](https://nvd.nist.gov/vuln/detail/CVE-2025-46731)