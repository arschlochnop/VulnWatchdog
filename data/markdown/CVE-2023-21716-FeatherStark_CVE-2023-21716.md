## CVE-2023-21716 Microsoft Word RTF 字体表堆损坏漏洞

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Word

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Word 2013 SP1, 2016, 2019, Office 365, SharePoint Server 等，具体版本范围参见 CVE 描述。

**利用条件:** 需要用户打开恶意的 RTF 文档。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，对 CVE-2023-21716 Microsoft Word RTF 字体表堆损坏漏洞进行评估：

**1. 有效性：**

*   POC 代码有效。漏洞利用代码 `README.md` 中详细描述了漏洞原理，并通过汇编代码片段展示了漏洞触发点，即处理 RTF 文件字体表时，由于字体 ID 处理不当导致堆损坏。提供的调试器输出也验证了内存越界写入。虽然 `README.md` 中没有直接提供可执行的 EXP，但详细的漏洞分析足以支持漏洞的复现和利用。
*   搜索引擎结果表明，该漏洞已被广泛研究，并有公开的 PoC 验证了其有效性。

**2. 投毒风险：**

*   分析 `README.md` 文件，其中仅包含漏洞原理的描述、汇编代码片段和调试信息，不存在任何可疑的代码或命令，可以认为作者没有隐藏任何投毒代码。因此投毒风险为 0%。

**3. 利用方式：**

*   漏洞利用方式是：
    1.  构造恶意的 RTF 文档，该文档包含一个具有大量字体的字体表（`\fonttbl`）。
    2.  在处理字体表时，Word 的 RTF 解析器在解析字体 ID ( `\f###`) 时，由于整数溢出或者符号扩展，导致计算的内存地址出现负偏移。
    3.  利用此负偏移，将字体代码页写入堆的错误位置，造成堆损坏。
    4.  通过精心构造堆布局，攻击者可以利用此堆损坏实现任意代码执行。
    5.  攻击者可以通过电子邮件附件或其他方式将恶意 RTF 文档发送给受害者，诱骗其打开。
    6.  当受害者使用受影响的 Microsoft Word 版本打开该 RTF 文档时，将触发漏洞，导致远程代码执行。

**总结：**

CVE-2023-21716 是一个高危漏洞，攻击者可以通过诱骗用户打开恶意的 RTF 文档来执行任意代码。提供的 POC 代码虽然只是漏洞分析，但结合搜索引擎结果，确认该漏洞具有很高的可利用性，但没有发现投毒的迹象。

**项目地址:** [FeatherStark/CVE-2023-21716](https://github.com/FeatherStark/CVE-2023-21716)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)