## CVE-2025-54313-eslint-config-prettier-供应链攻击

**漏洞编号:** CVE-2025-54313

**漏洞类型:** 供应链攻击/嵌入恶意代码

**影响应用:** eslint-config-prettier

**危害等级:** 高危，可能导致Windows系统执行恶意代码，供应链污染

**影响版本:** 8.10.1, 9.1.1, 10.1.6, 10.1.7

**利用条件:** 安装受影响的eslint-config-prettier版本在Windows环境下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54313 是一个供应链攻击漏洞，影响 eslint-config-prettier 的多个版本。攻击者通过 npm 包投毒，将恶意代码嵌入到受影响的 eslint-config-prettier 版本中。当用户在 Windows 系统上安装这些受污染的包时，恶意代码会被执行，具体是通过 install.js 脚本启动 node-gyp.dll 木马。漏洞利用方式：

1.  **安装受污染的包：** 开发者不慎安装了 eslint-config-prettier 的 8.10.1, 9.1.1, 10.1.6 或 10.1.7 版本。
2.  **执行 install 脚本：** 在 npm install 过程中，受污染包的 install.js 脚本会被执行。
3.  **释放和执行恶意 DLL：** install.js 脚本会释放 node-gyp.dll (或其他恶意 DLL)，并使用 rundll32.exe 执行该 DLL 中的恶意代码。

提供的 PowerShell 脚本 (CVE-2025-54313-Scanner.ps1) 是一个 IOC 扫描器，用于检测系统中是否存在 CVE-2025-54313 攻击的痕迹。它主要通过以下方式进行检测：

*   **检查 node_modules 目录：** 扫描器会检查项目中的 node_modules 目录，查找是否存在受污染的 eslint-config-prettier 版本。
*   **搜索 install.js 文件：** 扫描器会搜索项目中是否存在包含恶意代码特征的 install.js 文件，例如包含 `logDiskSpace()`，`os.platform() === 'win32'`，`child_process.spawn`，`rundll32`，`node-gyp.dll` 等字符串。
*   **搜索 DLL 文件：** 扫描器会搜索系统中是否存在可疑的 DLL 文件，例如 node-gyp.dll。
*   **SHA256 Hash校验:** 通过已知的恶意文件HASH与本地文件进行校验。

**有效性：** 提供的 IOC 扫描器代码主要用于检测，而不是进行漏洞利用，主要确认受害者是否安装了恶意包。根据漏洞信息，安装受污染的包就会触发漏洞利用，因此利用方式明确且有效。

**投毒风险：** 提供的 PowerShell 扫描脚本本身存在投毒风险的可能性较低，因为其主要功能是扫描系统中的恶意文件和代码模式，而非执行恶意操作。虽然扫描器可以被滥用，例如修改扫描器以植入恶意代码，但从代码本身来看，作者隐藏恶意代码的可能性为10%，主要考虑点是报告路径可能会被滥用。

**搜索引擎结果支持：** 搜索结果验证了漏洞的存在，并提供了关于漏洞的详细信息，包括受影响的版本、利用方式和修复建议。

**项目地址:** [ShinP451/scavenger_scanner](https://github.com/ShinP451/scavenger_scanner)

**漏洞详情:** [CVE-2025-54313](https://nvd.nist.gov/vuln/detail/CVE-2025-54313)