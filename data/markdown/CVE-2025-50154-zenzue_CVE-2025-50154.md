## CVE-2025-50154 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-50154

**漏洞类型:** NTLM Relay/Spoofing

**影响应用:** Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** 受影响的Windows版本（详见CVE描述）

**利用条件:** 攻击者需要位于与目标系统相同的网络或能够进行中间人攻击，目标用户需要访问攻击者控制的资源。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-50154是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息，根据搜索结果，该漏洞可能与NTLM身份验证相关。漏洞利用方式通常涉及诱骗用户访问恶意构造的网络共享或文件，从而触发NTLM身份验证并可能被中继攻击者捕获。 

提供的PowerShell脚本 `NTLM_SMB_HardeningToolkit.ps1` 并非直接的漏洞利用代码，而是用于审核和加固NTLM/SMB安全配置的工具，可以用于缓解此漏洞带来的风险。该脚本的功能包括：

*   审核 NTLM/SMB hardening 配置。
*   强制执行推荐配置（加固模式）或恢复到先前的配置（恢复模式）。
*   支持受信任的 SMB 范围的允许列表。
*   搜索最近的 NTLM 事件和资源管理器发起的 SMB 连接。
*   执行良性的 TCP:445 可达性测试以采样主机。
*   将结果导出到 JSON/CSV。

虽然该脚本本身并非漏洞利用代码，但攻击者可能通过修改或替换该脚本，在其中植入恶意代码，例如记录或窃取NTLM凭据, 所以存在一定的投毒风险。投毒风险评估为10%，因为该脚本主要为防御性质，一般用户会检查代码内容，且代码量大，难以植入隐蔽后门。

**利用方式：**

1.  攻击者搭建一个恶意的SMB服务器或控制一个已有的SMB服务器。
2.  攻击者构造一个特殊的文件或链接，诱骗受害者通过文件资源管理器访问该SMB服务器。
3.  当受害者访问该恶意服务器时，文件资源管理器会尝试使用NTLM身份验证，并将受害者的凭据发送给攻击者。
4.  攻击者可以使用中继技术将这些凭据转发到另一个目标服务器，从而冒充受害者进行身份验证。

**项目地址:** [zenzue/CVE-2025-50154](https://github.com/zenzue/CVE-2025-50154)

**漏洞详情:** [CVE-2025-50154](https://nvd.nist.gov/vuln/detail/CVE-2025-50154)