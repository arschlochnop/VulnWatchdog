## CVE-2025-59287 WSUS RCE

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响的Windows Server版本及范围请参考漏洞库信息

**利用条件:** 目标服务器运行受影响的WSUS版本，攻击者能够通过网络访问WSUS服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个Windows Server Update Service (WSUS)远程代码执行漏洞，由于WSUS在处理数据时存在反序列化漏洞，未经授权的攻击者可以通过网络发送特制的请求来执行任意代码。 

**有效性评估：**
提供的漏洞利用代码 (CVE-2025-59287.py) 看起来比较完整，包含自动下载ysoserial.net依赖、使用硬编码的AES密钥加密 payload等功能，说明该POC具有较高的有效性。POC 代码旨在利用反序列化漏洞在目标 WSUS 服务器上执行任意代码。

**投毒风险评估：**
虽然代码看起来像是有效的漏洞利用程序，但依旧存在一定的投毒风险。由于该漏洞利用程序会自动从外部源下载 ysoserial.net，存在以下潜在风险：
1.  **依赖项篡改：** 如果攻击者能够劫持 ysoserial.net 的下载链接或 GitHub 仓库，他们可以在下载的 zip 文件中植入恶意代码，从而实现供应链攻击。
2.  **Payload 投毒：** 攻击者可能会修改 ysoserial.net 生成的 payload，使其包含恶意行为，例如在目标系统上安装后门或执行其他恶意操作。
3.  **代码逻辑陷阱：** 虽然可能性较低，攻击者可以在代码中添加隐藏的逻辑，例如在特定条件下触发恶意行为。
基于以上分析，我们认为此仓库中的投毒风险为 10%。这个百分比考虑到自动化下载依赖项带来的潜在风险，尽管该代码看起来是合法的漏洞利用程序。

**利用方式分析：**
1.  **确定目标 WSUS 服务器：** 确定目标服务器的 IP 地址和端口。
2.  **检查 WSUS 版本：** 确认目标服务器运行的是受影响的 WSUS 版本。
3.  **下载漏洞利用代码：** 下载 CVE-2025-59287.py 脚本。
4.  **准备恶意 Payload：** 使用 ysoserial.net 生成用于执行任意命令的 payload。该脚本会自动下载。
5.  **配置漏洞利用代码：** 修改脚本中的目标 IP 地址和 payload，指定要在目标系统上执行的命令。
6.  **运行漏洞利用代码：** 运行 CVE-2025-59287.py 脚本，它将利用反序列化漏洞在目标服务器上执行代码。

**项目地址:** [garvitv14/CVE-2025-59287](https://github.com/garvitv14/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)