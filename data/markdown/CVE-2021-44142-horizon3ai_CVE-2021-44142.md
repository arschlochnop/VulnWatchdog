## CVE-2021-44142-Samba-vfs_fruit-堆溢出

**漏洞编号:** CVE-2021-44142

**漏洞类型:** 堆溢出

**影响应用:** Samba

**危害等级:** 高危，远程代码执行

**影响版本:** Samba versions prior to 4.13.17, 4.14.12 and 4.15.5

**利用条件:** 需要启用 vfs_fruit 模块，并且攻击者需要对共享目录有写入扩展属性的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44142 是 Samba vfs_fruit 模块中的一个堆溢出漏洞。该模块用于提供与 Apple SMB 客户端的兼容性。攻击者通过精心构造的扩展文件属性，可以进行越界堆读写，最终导致远程代码执行。POC 代码通过 SMB 协议连接到目标 Samba 服务器，并尝试利用该漏洞泄露堆 cookie 和链表指针，以此验证漏洞的存在。由于 Western Digital 的定制补丁会禁用某些 VFS 模块，因此 POC 代码伪装成来自 OSX 的连接。 该 POC 仓库包含 LICENSE, README.md, apple.py, check_vulnerable.py 文件。从代码分析来看，没有明显的投毒迹象，例如执行恶意命令或上传恶意文件。check_vulnerable.py 的功能是检查目标是否存在漏洞，apple.py 包含与 AppleDouble 结构相关的定义，用于构造特定的数据包。 整体代码功能较为清晰，主要是为了验证漏洞是否存在，不存在额外的后门代码。投毒风险极低。

**项目地址:** [horizon3ai/CVE-2021-44142](https://github.com/horizon3ai/CVE-2021-44142)

**漏洞详情:** [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)