## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 <= version <= 7.6.3

**利用条件:** 需要网络访问，FortiWeb GUI组件存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25257是Fortinet FortiWeb中的一个SQL注入漏洞，未经身份验证的攻击者可以通过特制的HTTP/HTTPS请求执行未经授权的SQL代码或命令。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码已经公开，并且有多个安全研究人员和组织验证了该漏洞，并发布了相关的分析和利用方法。搜索结果也表明，该漏洞可被利用实现远程代码执行(RCE)。

**投毒风险：**

PoC代码的投毒风险较低，约为10%。 虽然代码本身看起来直接利用SQL注入来写入webshell和执行命令， 但需要仔细审查代码中的以下几个方面：

*   `self._webshell`：webshell的内容虽然简单，但也需要确保其安全性，例如防止执行任意命令，可以限制执行的命令或进行输入验证。
*   `self._chmod_script`：该脚本用于修改webshell的权限和清理`.pth`文件，需要确保该脚本不会被恶意修改，例如验证执行结果或使用更安全的权限管理方法。
*   SQL注入语句：虽然SQL注入是漏洞本身，但需要确认注入语句的安全性，例如防止写入恶意文件或执行危险操作。

总体来说，PoC代码的风险在于webshell本身和执行命令的安全性，以及SQL注入语句可能带来的其他风险。 仔细审查webshell的内容、执行命令的方式和SQL注入语句可以降低投毒的风险。 可以通过限制webshell的功能、验证执行结果和使用安全的SQL注入方法来降低风险。需要对代码进行安全审计，确认其行为符合预期，并且不会引入其他安全风险。

**利用方式：**

1.  **SQL注入：** 利用 `Authorization` 头中的 `Bearer` 字段，通过构造恶意的SQL语句注入到易受攻击的API接口 `/api/fabric/device/status`。
2.  **写入Webshell：** 通过SQL注入，将一个简单的webshell（例如，从User-Agent头执行命令的CGI脚本）写入到服务器的可访问目录 `/migadmin/cgi-bin/x.cgi`。
3.  **权限修改和清理：** 通过SQL注入，写入一个Python脚本到`/var/log/lib/python3.10/pylab.py`，利用Python的`.pth`文件机制，在访问`/cgi-bin/ml-draw.py`时触发该Python脚本的执行，该脚本用于修改webshell的执行权限 (`chmod +x`) 并删除`.pth`文件。
4.  **远程代码执行：**  通过访问webshell的URL，并在HTTP请求的 `User-Agent` 头中包含要执行的命令，实现远程代码执行。

**项目地址:** [TheStingR/CVE-2025-25257](https://github.com/TheStingR/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)