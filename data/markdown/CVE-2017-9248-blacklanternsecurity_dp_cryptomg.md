## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密密钥泄露/远程代码执行/XSS/ViewState 泄露

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露和完全控制服务器

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用存在漏洞的 Telerik UI for ASP.NET AJAX 组件，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件在保护 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 时存在缺陷。攻击者通过利用此漏洞，可获取加密密钥，从而导致多种攻击，例如：

*   **MachineKey 泄露：** 泄露 MachineKey 后，攻击者可以解密 ViewState，伪造身份验证票据等。
*   **任意文件上传/下载：** 攻击者可以利用 MachineKey 来绕过文件上传限制，上传恶意文件或下载敏感文件。
*   **XSS（跨站脚本攻击）：** 攻击者可以利用 MachineKey 来构造恶意的 URL 或请求，从而注入恶意脚本。
*   **ASP.NET ViewState 泄露：** 攻击者可以解密 ViewState，获取敏感信息或篡改 ViewState 数据。

**利用方式：**

1.  **密钥泄露：** 通过特定的 URL 或请求，尝试获取 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey`。
2.  **利用泄露的密钥：** 利用泄露的密钥进行后续攻击，例如：
    *   解密和篡改 ViewState。
    *   构造恶意的 HTTP 请求。
    *   上传恶意文件。

**漏洞利用代码分析：**

提供的漏洞利用代码为一个 `GNU AFFERO GENERAL PUBLIC LICENSE` 文件，它本身并不是一个漏洞利用代码，而是用于开源软件的许可协议。因此，可以判定此仓库中不存在作者隐藏的投毒代码。

**有效性：**

由于提供的代码只是一个License，无法直接评估POC的有效性。需要其他辅助的利用脚本进行评估。但是从搜索结果来看，此漏洞已经有公开的EXP且被积极利用，因此可以推断漏洞是有效的。

**投毒风险：**
提供的代码为开源许可协议，不包含任何恶意代码。因此投毒风险为0%。

**项目地址:** [blacklanternsecurity/dp_cryptomg](https://github.com/blacklanternsecurity/dp_cryptomg)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)