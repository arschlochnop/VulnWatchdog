## CVE-2025-39601 - WordPress Custom CSS, JS & PHP plugin CSRF to RCE

**漏洞编号:** CVE-2025-39601

**漏洞类型:** CSRF to RCE

**影响应用:** WordPress Custom CSS, JS & PHP plugin

**危害等级:** 高危，允许远程代码执行

**影响版本:** <= 2.4.1

**利用条件:** 需要管理员用户已登录，受害者访问恶意页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-39601是一个存在于WordPress Custom CSS, JS & PHP插件<=2.4.1版本中的跨站请求伪造(CSRF)漏洞，攻击者可以通过诱骗已登录的管理员访问恶意HTML页面来利用此漏洞，从而在目标WordPress站点上执行任意PHP代码。 

**有效性：**
提供的PoC代码是有效的，它利用CSRF漏洞，通过POST请求修改插件设置，注入恶意的PHP代码，该代码会执行通过GET参数`cmd`传递的系统命令。一旦管理员访问包含此PoC代码的页面，恶意代码就会被注入到插件配置中，并通过`plugins_loaded`钩子在每个页面加载时执行。

**投毒风险：**
仓库中的PoC代码主要目的是展示漏洞利用，本身并无明显恶意投毒代码。但是，**任何在线获取的代码都存在潜在的风险**。评估投毒风险为10%的原因如下：
*   **潜在的隐藏后门：** 作者可能在其他文件中或通过更隐蔽的方式（例如，对某些变量进行编码或使用字符串操作）添加后门，这些后门可能不立即显现，而是在特定条件下触发。
*   **依赖项风险：** 如果该PoC依赖任何外部资源或脚本，这些资源可能被篡改以包含恶意代码。
*   **未来更新：** 作者可能在未来更新中引入恶意代码。即使当前版本安全，也无法保证后续版本没有问题。

因此，尽管PoC代码本身看起来没有恶意，但考虑到软件供应链的安全风险，不能完全排除投毒的可能性。

**利用方式：**
1.  **诱导管理员访问：** 攻击者需要创建一个包含CSRF PoC代码的HTML页面，并诱导已登录的WordPress管理员访问该页面。
2.  **提交恶意请求：** 当管理员访问该页面时，页面上的JavaScript代码会自动提交一个POST请求到WordPress站点的`tools.php`页面，修改`alg_custom_css_php`选项，注入恶意PHP代码。
3.  **远程代码执行：** 注入的PHP代码使用`system($_GET['cmd'])`来执行通过GET参数`cmd`传递的系统命令。因此，攻击者可以通过访问`http://target-site.com/?cmd=whoami`之类的URL来执行任意系统命令。
4.  **利用链：** 漏洞利用的核心在于，利用CSRF，修改插件配置，植入恶意代码，然后借助`plugins_loaded`钩子，实现RCE。

**项目地址:** [Nxploited/CVE-2025-39601](https://github.com/Nxploited/CVE-2025-39601)

**漏洞详情:** [CVE-2025-39601](https://nvd.nist.gov/vuln/detail/CVE-2025-39601)