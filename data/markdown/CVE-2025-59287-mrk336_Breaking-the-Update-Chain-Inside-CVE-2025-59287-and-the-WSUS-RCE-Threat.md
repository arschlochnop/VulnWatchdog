## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码。

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025, 23H2 (查看漏洞库信息中的详细版本范围)

**利用条件:** 需要网络访问WSUS服务器，且WSUS服务器未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个 Windows Server Update Services (WSUS) 中的远程代码执行漏洞，由不安全的反序列化导致。攻击者通过向 WSUS 服务器发送特制的 XML 文件（UpdateStream.xml）来利用此漏洞。WSUS 在处理 UpdateStream.xml 文件时，会反序列化其中的数据，由于没有充分的验证，攻击者可以在 `<SourcePath>` 中指定任意文件路径，并在 `<Command>` 标签中包含 PowerShell 命令。当 WSUS 处理该 XML 文件时，会执行攻击者指定的 PowerShell 命令，从而导致远程代码执行。

**有效性：**
提供的 POC 代码看起来有效，因为它描述了利用漏洞所需的步骤，并提供了一个示例 XML payload 和 PowerShell 脚本。该脚本旨在生成恶意的 UpdateStream.xml 文件，并通过 HTTP PUT 请求将其上传到 WSUS 服务器，从而触发漏洞。

**投毒风险：**
该漏洞利用代码本身主要功能是上传自定义的XML，存在一定风险。
1.  **恶意命令执行：** 攻击者可以在 `<Command>` 标签中嵌入任意的 PowerShell 命令。虽然提供的示例中使用 `cmd.exe`，但实际攻击中可以替换为更隐蔽或更具破坏性的代码，例如下载和执行恶意软件，修改系统配置，或者窃取敏感信息。
2.  **供应链攻击：** 如果该漏洞利用代码被集成到其他工具或脚本中，并且被广泛分发，那么攻击者可以通过修改原始代码来传播恶意payload，从而发起供应链攻击。
3.  **权限提升：** 尽管攻击者通过 WSUS 服务的权限执行代码，但如果 WSUS 服务本身具有较高的权限，那么攻击者也可以利用此漏洞提升权限，从而获得更高的系统控制权。
   总的来说，投毒风险较低，估计在10%左右，主要风险在于使用者替换恶意代码。

**利用方式：**
1.  攻击者构造恶意的 UpdateStream.xml 文件，其中包含指向 `cmd.exe`或其他可执行文件的 `<SourcePath>`，以及包含 PowerShell 命令的 `<Command>` 标签。
2.  攻击者使用 HTTP PUT 请求将恶意的 UpdateStream.xml 文件上传到 WSUS 服务器。
3.  WSUS 服务器处理 UpdateStream.xml 文件，反序列化其中的数据，并执行 `<Command>` 标签中包含的 PowerShell 命令，从而导致远程代码执行。

**项目地址:** [mrk336/Breaking-the-Update-Chain-Inside-CVE-2025-59287-and-the-WSUS-RCE-Threat](https://github.com/mrk336/Breaking-the-Update-Chain-Inside-CVE-2025-59287-and-the-WSUS-RCE-Threat)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)