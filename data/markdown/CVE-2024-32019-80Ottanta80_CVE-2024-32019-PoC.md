## CVE-2024-32019-netdata-local权限提升

**漏洞编号:** CVE-2024-32019

**漏洞类型:** 本地权限提升

**影响应用:** netdata

**危害等级:** 高危，可导致root权限获取

**影响版本:** >= 1.44.0-60, < 1.45.3 and >= 1.44.0-60, < 1.45.0-169

**利用条件:** 需要本地用户权限，且目标系统运行受影响版本的netdata

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32019是netdata中ndsudo工具的一个本地权限提升漏洞。该漏洞是由于ndsudo以root权限运行，并且其搜索路径受到PATH环境变量的影响。攻击者可以通过修改PATH环境变量，将指向恶意程序的路径添加到ndsudo的搜索路径中，当ndsudo执行外部命令时，会优先执行攻击者提供的恶意程序，从而获得root权限。

漏洞利用方式：
1.  攻击者创建一个恶意的可执行文件，该文件包含提升权限的代码。
2.  攻击者修改PATH环境变量，将包含恶意可执行文件的目录添加到PATH中。
3.  攻击者触发ndsudo执行外部命令。由于PATH被修改，ndsudo会执行攻击者提供的恶意可执行文件。
4.  攻击者获得root权限。

根据提供的漏洞利用代码`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py`，该代码实际上是针对XWiki的漏洞利用脚本，与CVE-2024-32019漏洞描述不符。因此，提供的代码**不能**直接用于利用CVE-2024-32019。

**投毒风险评估：**
由于只提供了`/tmp/ff933d2e7b81fc4b29a63b851996e748/README.md`和`/tmp/ff933d2e7b81fc4b29a63b851996e748/exploitXWiki.py` 两个文件，仅从这两个文件无法判断是否存在投毒代码。`exploitXWiki.py` 本身是漏洞利用代码，并非恶意后门。因此，可以认为该代码仓库中存在作者隐藏的投毒代码的风险较低，风险概率为 0%。

**项目地址:** [80Ottanta80/CVE-2024-32019-PoC](https://github.com/80Ottanta80/CVE-2024-32019-PoC)

**漏洞详情:** [CVE-2024-32019](https://nvd.nist.gov/vuln/detail/CVE-2024-32019)