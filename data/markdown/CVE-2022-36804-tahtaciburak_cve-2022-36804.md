## CVE-2022-36804 - Bitbucket 命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server 和 Data Center

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 <= version < 7.6.17, 7.7.0 <= version < 7.17.10, 7.18.0 <= version < 7.21.4, 8.0.0 <= version < 8.0.3, 8.1.0 <= version < 8.1.3, 8.2.0 <= version < 8.2.2, 8.3.0 <= version < 8.3.1

**利用条件:** 需要对公共仓库具有访问权限，或对私有仓库具有读取权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-36804 是 Atlassian Bitbucket Server 和 Data Center 中存在的命令注入漏洞。 具有读取权限的远程攻击者可以通过发送恶意 HTTP 请求来执行任意代码。 该漏洞的利用方式是利用 Git 的 `--exec` 参数进行命令注入。PoC 代码首先获取 Bitbucket 实例中的所有项目和仓库，然后针对每个仓库，构造包含恶意命令的 URL 发送请求。 如果服务器存在漏洞，服务器会执行注入的命令，PoC 通过检查响应中是否包含 `/etc/passwd` 的内容来判断漏洞是否存在。该漏洞利用代码未发现作者植入恶意代码的嫌疑。

**项目地址:** [tahtaciburak/cve-2022-36804](https://github.com/tahtaciburak/cve-2022-36804)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)