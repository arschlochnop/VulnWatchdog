## CVE-2025-47981 Windows SPNEGO Extended Negotiation RCE

**漏洞编号:** CVE-2025-47981

**漏洞类型:** 远程代码执行

**影响应用:** Windows SPNEGO Extended Negotiation Security Mechanism

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** 见受影响版本列表

**利用条件:** 需要目标系统开放SMB(445端口), HTTP/HTTPS(80/443端口), 或Kerberos(88端口)服务，并能够建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-47981是一个Windows SPNEGO扩展协商中的堆缓冲区溢出漏洞，允许远程攻击者执行任意代码。根据提供的漏洞利用代码信息，攻击者可以通过发送多个超大`SPNEGO_TOKEN`结构来碎片化堆，然后通过精心构造的`MechTypeList`元素触发溢出，覆盖`SECURITY_CONTEXT`函数指针，最终将执行重定向到部署shellcode的ROP链。漏洞影响多个Windows版本。PoC使用python脚本，允许指定目标IP、端口和要执行的命令。该漏洞被描述为“wormable”，这意味着它有可能在网络中自动传播。投毒风险评估为10%，原因是下载链接为tinyurl短链接，存在被替换为恶意文件的可能性。此外，PoC代码本身需要进一步审计才能确定是否存在隐藏的恶意行为，但根据描述和使用方式来看，直接的投毒可能性较低。

**项目地址:** [detectrespondrepeat/CVE-2025-47981](https://github.com/detectrespondrepeat/CVE-2025-47981)

**漏洞详情:** [CVE-2025-47981](https://nvd.nist.gov/vuln/detail/CVE-2025-47981)