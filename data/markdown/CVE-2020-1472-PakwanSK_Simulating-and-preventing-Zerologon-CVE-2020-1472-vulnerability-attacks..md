## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者通过建立一个与域控制器的脆弱的Netlogon安全通道连接，可以运行特制的应用程序，最终获得域管理员权限，完全控制域。该漏洞利用方式主要分为以下几个步骤：

1.  **发现目标域控制器：** 攻击者需要确定目标域控制器的IP地址。
2.  **利用MS-NRPC协议漏洞：** 攻击者利用MS-NRPC协议中的加密缺陷，特别是AES-CFB8的实现问题，将域控制器的计算机密码重置为空。
3.  **恢复域控制器密码并获得权限：** 攻击者通常会重置域控制器的密码为空，然后通过其他方式（如DCSync）获取域控制器的账号信息，并获得域管理员权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性非常高。存在公开的POC代码，并且已经被广泛利用。

**投毒风险：** 提供的代码仓库主要是模拟和预防Zerologon漏洞攻击。该仓库链接到 `https://github.com/VoidSec/CVE-2020-1472` 包含checker 和 exploit 代码。 仓库本身主要是使用说明和演示，投毒风险较低，但是下载的POC代码存在一定的风险，需要仔细检查代码是否包含恶意代码，故投毒风险评估为10%。

**利用方式：**

1.  **未授权访问：**  攻击者无需任何凭据，就可以利用该漏洞。
2.  **密码重置：**  攻击利用的核心在于将域控制器的机器帐户密码设置为0。
3.  **权限提升：**  成功重置密码后，攻击者可以使用其他攻击技术（例如DCSync攻击）来提取域凭据并完全控制域。

**缓解措施：**

1.  **及时安装补丁：**  应用Microsoft发布的针对CVE-2020-1472的补丁。
2.  **强制执行安全通道：**  配置Netlogon安全通道以强制执行签名和加密。
3.  **监控可疑活动：**  监控Netlogon协议的异常活动，例如大量密码重置尝试。

**项目地址:** [PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.](https://github.com/PakwanSK/Simulating-and-preventing-Zerologon-CVE-2020-1472-vulnerability-attacks.)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)