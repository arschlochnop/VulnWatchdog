## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 5.3-milestone-2 <= version < 15.10.11 和 16.0.0-rc-1 <= version < 16.4.1

**利用条件:** 目标XWiki实例运行在受影响的版本范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24893 是 XWiki 平台中的一个远程代码执行漏洞，允许未经身份验证的攻击者通过 `SolrSearch` 请求执行任意代码。漏洞原因是 `SolrSearchMacros` 宏处理不当，导致可以注入 Groovy 代码并执行。 

**漏洞利用方式：**

1.  **构造恶意请求:**  利用提供的 POC 代码，攻击者可以通过构造包含恶意 Groovy 代码的 URL 请求，向 `/xwiki/bin/get/Main/SolrSearch` 发送请求。POC代码使用base64编码绕过检测。
2.  **代码执行:** XWiki 实例解析并执行请求中的 Groovy 代码，从而实现远程代码执行。POC 使用了`!RESST!`和`!RESED!`作为起始和结束标记来定位执行结果。
3.  **获取结果:** POC提取标记之间的字符作为命令执行结果并显示。

**POC 有效性评估：**

根据漏洞库信息和提供的 POC 代码，可以判断此 POC 有效。POC 实现了发送恶意请求并提取执行结果的功能。

**投毒风险评估：**

POC 代码本身主要由利用 XWiki 的 RCE 漏洞执行命令的代码组成。它没有明显的恶意代码，例如安装后门，上传恶意文件或修改系统配置。但是，考虑到任何 RCE 漏洞都可能被利用来植入恶意代码，因此使用任何 RCE 的 POC 都有潜在的投毒风险。风险评估为极低，几乎没有投毒代码(1%)。

**建议：**

强烈建议受影响的用户升级到 XWiki 15.10.11, 16.4.1 或更高版本，以修复此漏洞。如果无法立即升级，可以按照 XWiki 官方提供的缓解措施，修改 `Main.SolrSearchMacros` 文件。

**项目地址:** [Yukik4z3/CVE-2025-24893](https://github.com/Yukik4z3/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)