## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的 URL，读取服务器上受限目录之外的文件。如果服务器上启用了 CGI 脚本执行，则攻击者可以进一步利用此漏洞执行任意代码。

**有效性:**
根据漏洞库信息，搜索引擎结果，以及漏洞利用代码，提供的POC代码是有效的。漏洞库信息和搜索结果都表明此漏洞已被公开利用。

**投毒风险:**
提供的Go语言漏洞利用代码，主要功能是利用路径遍历漏洞读取`/etc/passwd`文件或执行命令。虽然代码本身实现了漏洞验证和利用功能，但仍然存在一定的投毒风险。

1.  **依赖风险:** Go程序需要编译，编译过程中可能引入恶意依赖。但是本项目代码量较小，依赖风险较低。
2.  **后门代码:** 检查代码后，发现其中并没有明显的恶意代码或后门。然而，攻击者可以修改代码以包含恶意功能，例如上传受害服务器的信息或执行其他恶意操作。
3.  **供应链风险:** 代码托管在第三方平台（GitHub），存在被篡改的风险。如果从不可信的来源下载代码，可能会下载到被修改过的恶意版本。

综合考虑，该仓库存在10%的投毒风险，主要来自潜在的依赖污染和代码篡改。

**利用方式:**
该漏洞的利用方式主要分以下几步：

1.  **路径遍历:** 攻击者构造包含`/.%2e`的恶意URL，尝试绕过Apache的路径规范化检查，从而访问服务器上任意文件。
2.  **信息泄露:** 如果路径遍历成功，攻击者可以读取敏感文件，例如`/etc/passwd`，获取系统用户信息。
3.  **远程代码执行:** 如果服务器启用了CGI脚本，攻击者可以通过POST请求将恶意命令传递给`sh`执行，从而实现远程代码执行。 例如，可以发送包含 `echo; <command>` 的POST请求到 `/cgi-bin/.%2e/%2e%2e/%2e%2e/bin/sh`。

**项目地址:** [aqiao-jashell/CVE-2021-41773](https://github.com/aqiao-jashell/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)