## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未授权用户执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 需要目标系统运行Cacti，并且存在至少一个`poller_item`，其`action`类型为`POLLER_ACTION_SCRIPT_PHP` (值为2)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169是Cacti 1.2.23之前版本中的一个未经身份验证的命令注入漏洞。攻击者可以通过操纵`remote_agent.php`文件中的`poller_id`参数来执行任意操作系统命令。漏洞利用主要分为两个阶段：首先，通过设置`X-Forwarded-For`头绕过身份验证，伪造客户端IP地址，使其与Cacti服务器的IP地址匹配。然后，构造包含恶意命令的`poller_id`参数，并将其发送到`remote_agent.php`，最终导致命令注入。该POC代码通过循环尝试不同的`host_id`来发现可以利用的配置。POC代码没有发现明显的投毒行为，主要目的是利用漏洞执行命令。搜索引擎结果也表明该漏洞已被公开利用。

**项目地址:** [sAsPeCt488/CVE-2022-46169](https://github.com/sAsPeCt488/CVE-2022-46169)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)