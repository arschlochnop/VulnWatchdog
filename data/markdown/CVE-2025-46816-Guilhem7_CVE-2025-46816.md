## CVE-2025-46816-goshs-命令执行

**漏洞编号:** CVE-2025-46816

**漏洞类型:** 命令执行

**影响应用:** goshs

**危害等级:** 高危，允许未经身份验证的远程命令执行

**影响版本:** >= 0.3.4, < 1.0.5

**利用条件:** 目标goshs服务正在运行，并且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-46816 存在于 goshs (SimpleHTTPServer) 版本 0.3.4 到 1.0.4。该漏洞允许未经身份验证的攻击者通过 WebSocket 连接发送命令，从而在服务器上执行任意代码。该漏洞源于 `dispatchReadPump` 函数没有正确检查 `-c` 命令行参数，允许通过WebSocket接口执行命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果（特别是 wiz.io 的分析，说明可以远程执行命令）和提供的 PoC 代码，此漏洞利用代码非常有效。PoC 代码通过建立 WebSocket 连接并发送包含要执行的命令的 JSON payload 来利用此漏洞。代码结构清晰，包含了参数解析、SSL 上下文处理和命令交互逻辑。利用方式简单，只需提供目标地址，即可执行命令。

**投毒风险分析：**

分析 PoC 代码后，发现代码主要功能是利用漏洞执行命令。其中`get_unsafe_ssl_context`函数跳过了主机名验证和证书验证，存在一定风险，不建议在生产环境中直接使用。PoC代码中未发现明显的恶意代码或者后门，但是不排除作者在payload构造，或者结果处理的逻辑里，埋藏隐蔽的后门。总体投毒风险较低，估计为 10%。主要风险来自代码本身的安全上下文配置以及潜在的隐蔽payload。

**利用方式分析：**

1.  目标goshs服务需要运行在受影响的版本 (>= 0.3.4, < 1.0.5)。
2.  攻击者需要知道目标goshs服务的地址和端口。
3.  运行exp.py脚本，指定目标地址和是否使用安全连接（--target, --secure）。
4.  脚本会建立WebSocket连接到目标服务。
5.  攻击者可以通过命令行输入要执行的命令。
6.  输入的命令会被封装成JSON payload，通过WebSocket发送到服务器。
7.  服务器执行命令并将结果返回。
8.  PoC 代码将服务器返回的结果打印到控制台。

**项目地址:** [Guilhem7/CVE-2025-46816](https://github.com/Guilhem7/CVE-2025-46816)

**漏洞详情:** [CVE-2025-46816](https://nvd.nist.gov/vuln/detail/CVE-2025-46816)