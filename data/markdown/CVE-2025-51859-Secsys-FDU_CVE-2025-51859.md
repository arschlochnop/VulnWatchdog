## CVE-2025-51859-Chaindesk-Stored XSS & IDOR

**漏洞编号:** CVE-2025-51859

**漏洞类型:** Stored XSS & IDOR (Insecure Direct Object Reference)

**影响应用:** Chaindesk

**危害等级:** 高危，可能导致账户劫持，敏感信息泄露

**影响版本:** 未知，但影响 https://www.chaindesk.ai 的用户

**利用条件:** 用户需与恶意AI Agent交互或访问恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-51859 描述了 Chaindesk Web 应用中的存储型跨站脚本 (XSS) 和不安全直接对象引用 (IDOR) 漏洞。

**有效性评估：**

提供的 `README.md` 文件描述了漏洞利用方法，说明了该漏洞是有效的。它展示了如何通过构造恶意 AI Agent，使其回复包含 XSS payload 的内容，从而在用户与该 Agent 交互时触发 XSS。此外，文档还提到了 IDOR 漏洞，攻击者可以构造包含 XSS payload 的恶意链接，诱骗用户点击后触发 XSS。

**投毒风险评估：**

从提供的 `README.md` 和描述来看，主要风险在于利用 AI Agent 和 LLM 本身来传递 XSS payload。虽然攻击利用了LLM的输出,但代码本身没有明显的后门或者恶意代码。`figure1.png` 和 `figure2.png`  可能是攻击演示截图。因此，投毒风险较低，估计为 10%。更高可能性是利用社工方式传播恶意Agent或者包含XSS的Conversation。

**利用方式：**

1.  **Stored XSS：**
    *   攻击者创建一个包含恶意 system prompt 的 AI Agent。该 system prompt 指示 LLM 生成包含 XSS payload（例如，基于 SVG 的 XSS）的回复。
    *   当用户与该恶意 Agent 交互时，LLM 生成的包含 XSS payload 的回复会在用户的浏览器中执行。
    *   XSS payload 可以窃取用户的敏感信息（例如，JWT session tokens），从而导致账户劫持。

2.  **IDOR：**
    *   攻击者构造包含 XSS payload 的 conversation URL (`https://app.chaindesk.ai/agents/<agentID>?tab=chat&conversationId=<conversationID>`)。
    *   由于缺少足够的访问控制检查，攻击者可以将此恶意链接发送给目标用户。
    *   当用户访问该链接时，XSS payload 会在其浏览器中执行。
    *   攻击者可能尝试枚举 `agentID` 和 `conversationID`，以访问其他用户的会话（尽管报告指出 `conversationID` 不容易猜测）。

**结论：**

此漏洞具有高危风险，因为成功利用可能导致账户劫持和敏感信息泄露。利用方式涉及构造恶意 AI Agent 和 conversation URL，利用 XSS 窃取用户的 JWT tokens。虽然LLM在其中扮演了payload传递的角色, 但是payload本身还是构造好的XSS脚本。IDOR漏洞可以帮助恶意链接传播。 需要注意的是, 由于没有实际运行POC进行验证, 此处的风险评估是基于给定的信息, 实际风险可能更高或者更低。

**项目地址:** [Secsys-FDU/CVE-2025-51859](https://github.com/Secsys-FDU/CVE-2025-51859)

**漏洞详情:** [CVE-2025-51859](https://nvd.nist.gov/vuln/detail/CVE-2025-51859)