## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)