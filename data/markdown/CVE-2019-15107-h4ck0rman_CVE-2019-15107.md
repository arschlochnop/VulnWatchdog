## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要网络可访问Webmin服务，默认端口10000

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107是Webmin 1.920及更早版本中发现的一个命令注入漏洞，存在于`password_change.cgi`文件中。攻击者可以通过`old`参数，或利用`expired`参数（从搜索引擎结果得知）注入恶意命令，从而在目标系统上执行任意代码。由于Webmin通常以root权限运行，成功利用此漏洞可能导致完全控制受影响的系统。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC代码是有效的。搜索引擎结果中多个来源都证实了该漏洞的存在和利用。

**投毒风险：** 分析提供的exploit.py代码，未发现明显的恶意投毒代码。该脚本的主要功能是发送包含命令注入的payload到目标服务器，并显示执行结果。脚本的逻辑相对简单，没有隐藏或混淆的代码，因此投毒风险较低。脚本通过`curl`命令发送请求，容易审计其行为。

**利用方式：**
1.  攻击者首先需要确定目标Webmin服务器的URL，通常是`https://<目标IP>:<端口>`，默认端口为10000。
2.  使用提供的exploit.py脚本，运行命令为 `python3 exploit.py https://<目标IP>:<端口>/`
3.  脚本会发送一个POST请求到`/password_change.cgi`，并在`old`或`expired`参数中注入恶意命令。
4.  服务器执行注入的命令，并将结果返回给攻击者。
5.  攻击者可以通过交互式shell执行任意命令。

**优先级排序依据：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。

**项目地址:** [h4ck0rman/CVE-2019-15107](https://github.com/h4ck0rman/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)