## CVE-2025-29927-Next.js-中间件绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用Next.js中间件进行权限验证，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927是Next.js框架中的一个授权绕过漏洞，存在于中间件实现中。该漏洞是由于Next.js对`x-middleware-subrequest`头部处理不当造成的。攻击者可以通过构造包含特定`x-middleware-subrequest`头部的恶意请求，绕过中间件的授权检查，访问受保护的资源。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞的PoC代码是有效的。多个来源证实了该漏洞的存在，并提供了利用方法，即构造包含`X-Middleware-Subrequest`头的请求。提供的PoC代码尝试通过此头部绕过中间件保护。

**投毒风险分析：**
分析提供的PoC代码，未发现明显的恶意投毒代码。该代码主要用于检测目标是否存在漏洞，利用方式相对直接。`exploit_header` 的值看起来像是一系列目录拼接，目的是触发 Next.js 内部的路径解析错误，从而绕过中间件。 该代码的目的是验证漏洞，而不是执行恶意操作。因此，投毒风险评估为0%。

**利用方式：**
1.  确定目标Next.js应用的版本是否在受影响范围内。
2.  目标应用使用了Next.js中间件进行权限验证。
3.  发送带有特制的`X-Middleware-Subrequest`头部的HTTP请求。
4.  如果返回状态码为200，且原本应该被中间件拦截，则表明漏洞存在，授权绕过成功。

**项目地址:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)