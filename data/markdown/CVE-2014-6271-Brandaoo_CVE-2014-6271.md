## CVE-2014-6271-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统需要使用Bash，并且存在允许通过环境变量传递参数的场景，例如CGI脚本，OpenSSH ForceCommand等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过在环境变量中构造恶意的函数定义，从而在Bash执行时注入并执行任意代码。该漏洞的利用方式是：

1.  **漏洞原理：** Bash在处理环境变量时，如果环境变量的值包含函数定义，Bash会先执行函数定义之后的内容。如果函数定义后的字符串包含恶意代码，则会被执行。
2.  **利用方式：** 攻击者构造包含恶意代码的环境变量，例如 `(){ :; }; /usr/bin/id`，然后将该环境变量传递给目标系统。
3.  **触发点：** 目标系统上运行的Bash脚本或程序在执行时，会解析并处理这些环境变量，从而触发漏洞，执行攻击者注入的恶意代码。
4.  **POC分析：** 提供的`shellshock.sh`脚本通过`curl`命令发送带有特殊构造的`User-Agent`头的HTTP请求。`User-Agent`头的内容为 `() { :; }; echo VULNERABLE`。如果目标网站的服务器使用Bash处理HTTP请求头（例如，通过CGI脚本），并且Bash存在Shellshock漏洞，那么`echo VULNERABLE`命令会被执行，并在HTTP响应中返回 "VULNERABLE" 字符串，脚本据此判断目标站点存在漏洞。
5.  **有效性分析：** 该POC代码基本有效，可以用于检测目标服务器是否存在Shellshock漏洞。但是，该脚本的检测方法较为简单，仅通过`User-Agent`头进行检测，可能存在一定的漏报情况。更复杂的利用场景可能需要修改POC代码。
6.  **投毒风险分析：** 该仓库中存在一定的投毒风险。`shellshock.sh`本身的代码较为简单，主要功能是发送HTTP请求并检查响应。潜在的风险在于：
    *   **依赖项风险：** 虽然脚本本身只依赖于`curl`，但是如果攻击者修改脚本，引入其他的外部命令或者脚本，可能会引入恶意代码。
    *   **命令注入风险：** 虽然脚本避免了直接执行用户输入，但是，如果攻击者能够控制`curl`的参数或者其他命令的参数，仍然可能存在命令注入的风险。
    *  **README.md风险:** 有攻击者会修改README.md文件，放入恶意链接，诱导用户点击。
    根据代码的复杂度、依赖项以及潜在的命令注入风险，估计投毒风险为10%。

**项目地址:** [Brandaoo/CVE-2014-6271](https://github.com/Brandaoo/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)