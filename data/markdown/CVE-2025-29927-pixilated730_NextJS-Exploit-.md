## CVE-2025-29927-Next.js-Middleware权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感信息或执行恶意操作

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞版本的Next.js，并且权限校验逻辑位于middleware中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js middleware中存在的权限绕过漏洞。该漏洞是由于Next.js对`x-middleware-subrequest`header处理不当导致的。攻击者可以通过构造包含该header的恶意请求，绕过原本应该在middleware中执行的权限校验。 

**漏洞利用方式：**

1.  攻击者发送包含`x-middleware-subrequest` header的HTTP请求到目标Next.js应用。
2.  如果权限校验逻辑在middleware中，Next.js应用可能错误地处理该请求，从而绕过权限校验。
3.  攻击者可以访问未授权的资源或执行未授权的操作。

**有效性：**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且已经有公开的分析和利用方法。提供的Python脚本`NextSploit.py`看起来是一个通用的Web应用漏洞扫描工具，目前提供的代码片段，没有直接利用CVE-2025-29927漏洞的代码，但是该代码框架具备集成的可能。搜索引擎结果也表明Rapid7、Picus Security等安全厂商已经对此漏洞进行了分析，因此该漏洞是可利用的。

**投毒风险：**

提供的Python脚本片段存在一定的投毒风险。主要表现在以下几个方面：

1.  **自动安装依赖:** 脚本会自动检查并安装一些Python包（例如`wappalyzer`、`requests`、`colorama`、`selenium`）。如果安装源被篡改，或者恶意人员投毒了这些常用package,则可能安装恶意版本，导致代码执行。
2.  **Wappalyzer集成:** 脚本使用`wappalyzer`进行Web应用指纹识别。虽然`wappalyzer`本身是一个合法的工具，但恶意人员可能利用它来收集敏感信息，或为后续攻击做准备。
3. **MIDDLEWARE_VALUE** 全局变量用于存储中间件值，可能存在通过外部输入修改该值的操作，存在风险

综上所述，代码中存在一定的风险，但并非显式的恶意代码，更像是安全工具中可能存在的潜在风险。 因此，投毒风险评估为10%。主要是依赖包安装和第三方工具使用带来的风险。

**建议：**

*   及时更新Next.js到安全版本(>=14.2.25或>=15.2.3)。
*   如果无法更新，按照官方建议，阻止包含`x-middleware-subrequest` header的外部请求。

**项目地址:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)