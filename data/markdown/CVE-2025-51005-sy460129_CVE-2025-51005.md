## CVE-2025-51005 – tcpreplay Heap Buffer Overflow

**漏洞编号:** CVE-2025-51005

**漏洞类型:** Heap Buffer Overflow

**影响应用:** tcpreplay

**危害等级:** 高危，可能导致拒绝服务(DoS)

**影响版本:** 4.5.1

**利用条件:** 需要能够运行tcpreplay并提供特制的pcap文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-51005存在于tcpreplay 4.5.1中，是一个堆缓冲区溢出漏洞。该漏洞源于程序在处理特制的pcap文件时，错误地计算了从IPv4头部导出的剩余数据包长度。这个未经检查的值随后被用于校验和操作，导致内存访问超出已分配的缓冲区，从而造成拒绝服务。漏洞利用方式为：

1.  构建tcpreplay 4.5.1。
2.  使用`sudo ./src/tcpliveplay eth0 ./a.pcap 0.0.0.0 00:00:00:00:00:00 random`命令运行tcpliveplay，其中`a.pcap`是包含恶意payload的pcap文件。

根据github上的issue信息和提供的poc.zip，该漏洞利用代码是有效的。投毒风险评估：虽然提供的README.md文件看起来无害，但由于其包含指向外部poc.zip文件的链接，存在潜在的投毒风险。如果攻击者修改了poc.zip文件，使其包含恶意代码（例如，在溢出发生时执行shellcode），则可能实现更严重的攻击，如远程代码执行。因此，投毒风险设为10%。 仓库中存在投毒风险，主要是通过修改 poc.zip 文件来实现的。因为 README.md 本身不包含可执行的代码，所以风险较低。

**有效性：** 根据提供的描述和PoC链接，此漏洞利用代码是有效的，可以触发堆缓冲区溢出。

**投毒风险：** PoC本身包含了pcap文件，可能存在投毒的风险，恶意修改pcap文件，例如在溢出发生时执行shellcode。因此投毒风险评估为10%。主要风险点在于zip文件，以及运行涉及网络数据包处理的程序时可能存在的风险。

**利用方式：** 漏洞利用方式是通过构建恶意的pcap文件，利用tcpreplay在计算校验和时的缓冲区溢出漏洞，导致程序崩溃或执行恶意代码，从而实现拒绝服务攻击。

**项目地址:** [sy460129/CVE-2025-51005](https://github.com/sy460129/CVE-2025-51005)

**漏洞详情:** [CVE-2025-51005](https://nvd.nist.gov/vuln/detail/CVE-2025-51005)