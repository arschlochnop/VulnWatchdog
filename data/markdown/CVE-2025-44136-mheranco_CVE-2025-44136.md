## CVE-2025-44136 - MapTiler Tileserver-php XSS

**漏洞编号:** CVE-2025-44136

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** MapTiler Tileserver-php

**危害等级:** 中危，可能导致用户凭据泄露和恶意代码执行

**影响版本:** v2.0

**利用条件:** 需要网络访问 Tileserver-php 应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-44136 存在于 MapTiler Tileserver-php v2.0 中。GET 参数 'layer' 在错误消息中未进行 HTML 编码直接输出，导致 XSS 漏洞。未经验证的攻击者可以通过构造包含恶意 JavaScript 代码的 URL，在受害者的浏览器上执行任意 HTML 或 JavaScript 代码。

**有效性：**

提供的 POC 代码 `http://host/tileserver.php/wmts/x/1/1/asd?Request=x&layer=%3csvg+onload=alert(document.domain)%3e`  是有效的，它通过 'layer' 参数注入一个 SVG 标签，该标签的 onload 事件会触发 JavaScript 代码 `alert(document.domain)` 的执行。

**投毒风险：**

该 POC 只是一个简单的 XSS 演示，用来验证漏洞的存在。其中存在的投毒风险较低。投毒代码可能存在的形式包括：

*   指向恶意网站的链接
*   下载并执行恶意文件的代码
*   窃取用户信息的代码

此仓库目前只包含一个README.md文件，其中只包含漏洞描述和POC，暂未发现恶意代码，但是不排除作者后续添加恶意代码，或者通过其它方式投毒的可能性。

**利用方式：**

1.  攻击者构造包含恶意 JavaScript 代码的 URL。
2.  攻击者诱骗用户点击该 URL (例如通过电子邮件、社交媒体等)。
3.  用户访问该 URL，Tileserver-php 将恶意 JavaScript 代码注入到页面中。
4.  用户的浏览器执行恶意 JavaScript 代码，攻击者可以窃取用户凭据、控制用户会话或执行其他恶意操作。

基于目前的证据，可以判断该漏洞是有效的，但投毒风险较低。

考虑到存在远程仓库投毒的可能性，将投毒风险判定为10%

**项目地址:** [mheranco/CVE-2025-44136](https://github.com/mheranco/CVE-2025-44136)

**漏洞详情:** [CVE-2025-44136](https://nvd.nist.gov/vuln/detail/CVE-2025-44136)