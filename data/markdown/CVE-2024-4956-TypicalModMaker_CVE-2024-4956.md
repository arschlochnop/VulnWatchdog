## CVE-2024-4956-Sonatype Nexus Repository 3-Path Traversal

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 3.68.0

**利用条件:** 目标服务器运行受影响版本的Sonatype Nexus Repository Manager 3，且允许未授权网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 3 中的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞读取系统文件。根据提供的漏洞利用代码，攻击者可以使用精心构造的URL来下载任意文件。`README.md`文件中描述了相关的利用脚本，包括检查服务器是否容易受到攻击 (`check-vulnerable-servers.py`)，检查是否以 root 用户身份运行 (`check-root-servers.py`)，以及尝试使用找到的私钥通过 SSH 以 root 用户身份登录 (`check-private_keys.py`)。

**有效性：**根据漏洞信息和搜索结果，该漏洞的利用是有效的，因为多个来源都确认了未经身份验证的攻击者可以读取系统文件。

**投毒风险：** 仓库中存在投毒代码的可能性较低，因为提供的脚本主要用于检测和利用漏洞，而非植入后门。但存在轻微风险，体现在`check-private_keys.py`，可能存在收集私钥用于其他目的，所以判定投毒风险为5%。

**利用方式：**
1.  使用 Shodan 等搜索引擎查找暴露在网络上的 Sonatype Nexus Repository Manager 3 实例。
2.  使用 `check-vulnerable-servers.py` 脚本验证目标服务器是否存在 CVE-2024-4956 漏洞，通过尝试读取 `/etc/passwd` 文件来验证。
3.  （如果目标以 root 身份运行）使用 `check-root-servers.py` 脚本验证目标服务器是否可以读取 `/etc/shadow` 文件。
4.  （如果目标以 root 身份运行）使用 `check-private_keys.py` 脚本查找常见的私钥路径，如果找到，尝试使用这些私钥通过 SSH 以 root 用户身份登录。

**项目地址:** [TypicalModMaker/CVE-2024-4956](https://github.com/TypicalModMaker/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)