## CVE-2024-10924-Really Simple Security-身份验证绕过

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress plugins

**危害等级:** 高危，允许未经身份验证的攻击者以任何现有用户身份登录，包括管理员，可能导致完全控制网站

**影响版本:** 9.0.0 to 9.1.1.1

**利用条件:** 目标WordPress站点安装了受影响版本的Really Simple Security插件，并且启用了“Two-Factor Authentication”设置（尽管默认情况下是禁用的）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924是Really Simple Security WordPress插件中的一个身份验证绕过漏洞。该漏洞源于'check_login_and_get_user'函数中不正确的用户检查错误处理，尤其是在双因素身份验证的REST API操作中。利用此漏洞，未经身份验证的攻击者可以发送特制的请求，绕过双因素身份验证，并以任何现有用户（包括管理员）的身份登录到WordPress站点。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的PoC代码是有效的。PoC代码通过以下步骤进行利用：
1.  **获取会话Cookie:** 向`reallysimplessl/v1/two_fa/skip_onboarding`端点发送HTTP请求，其中包含`user_id`，`login_nonce`和`redirect_to`，以获取有效的会话Cookie。这步绕过了双因素认证的初始检查。
2.  **登录请求:** 使用获得的Cookie，以及用户提供的用户名和密码，向`wp-admin/profile.php`端点发送POST请求，模拟登录操作。
3.  **结果:** 成功绕过双因素身份验证，攻击者可以访问管理员面板。PoC会将管理员仪表板的响应保存为HTML文件并在浏览器中打开。

**投毒风险分析：**
PoC代码主要包含以下功能：
*   网络扫描 (knowIPwordpress.py) 用于发现目标WordPress实例的IP地址。
*   漏洞利用 (bypass-MFA-Wordpress.py) 用于绕过双因素身份验证并获取管理员访问权限。
*   辅助脚本 (endpointWordpress.py) 帮助手动利用漏洞。

分析发现，主要风险在于该项目需要下载一个VMWare镜像文件。尽管提供的google drive链接存在风险，但假设链接指向的是原作者的ubuntu环境，则风险较低。
PoC代码本身包含的功能较为直接，主要为发送特定构造的HTTP请求。但存在以下潜在风险：
*   **依赖外部链接：** README.md中包含指向外部VMWare镜像文件的链接，存在被替换为恶意文件的风险。
*   **信息收集：** knowIPwordpress.py脚本会扫描本地网络，可能收集敏感信息。
*   **不安全的默认凭据：** 虚拟机默认账户密码可能被植入恶意代码，用于扫描或者攻击。

因此，综合判断，投毒风险约为10%。主要风险在于下载的VMWare镜像文件可能被篡改。

**利用方式总结：**
1.  扫描网络，找到目标WordPress站点。
2.  如果站点安装了受影响版本的Really Simple Security插件，并且启用了双因素身份验证，则可以利用该漏洞。
3.  运行bypass-MFA-Wordpress.py脚本，该脚本会自动完成以下操作：
    *   发送特制的HTTP请求到`reallysimplessl/v1/two_fa/skip_onboarding`端点，获取会话Cookie。
    *   使用获得的Cookie和管理员凭据，向`wp-admin/profile.php`端点发送POST请求，模拟登录操作。
    *   如果登录成功，将管理员面板的HTML保存到本地并打开。
4.  攻击者现在可以完全控制WordPress站点。

**项目地址:** [D1se0/CVE-2024-10924-Bypass-MFA-Wordpress-LAB](https://github.com/D1se0/CVE-2024-10924-Bypass-MFA-Wordpress-LAB)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)