## CVE-2023-4911 Glibc 本地提权漏洞

**漏洞编号:** CVE-2023-4911

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，本地权限提升

**影响版本:** 2.34到2.39之间（不含2.39）

**利用条件:** 需要本地访问，目标系统使用存在漏洞的glibc版本，并且运行SUID程序。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4911是一个存在于GNU C Library (glibc)动态链接器ld.so中的缓冲区溢出漏洞。该漏洞源于处理GLIBC_TUNABLES环境变量时出现的问题。攻击者可以利用特制的GLIBC_TUNABLES环境变量，在启动具有SUID权限的二进制文件时执行任意代码，从而提升权限。

**有效性分析：**

根据漏洞信息、搜索结果和提供的PoC代码，该漏洞利用是有效的。
*   漏洞库信息明确指出这是一个缓冲区溢出漏洞，并可能导致权限提升。
*   搜索结果中大量文章和报告都确认了该漏洞的存在和高危性。
*   PoC代码通过构造特定的GLIBC_TUNABLES环境变量来触发缓冲区溢出。

**投毒风险分析：**

分析提供的PoC代码，投毒风险极低。 gen_libc.py的代码目的是生成特定版本的glibc库，以供漏洞利用时使用，而其他文件是为了利用该漏洞来提升权限。
* 漏洞存在投毒的风险较低，约为1%。

**利用方式分析：**

利用方式总结如下：

1.  **环境准备：** 准备存在漏洞的glibc环境，通常是2.34到2.39之间的版本。
2.  **编译PoC代码：** 使用Makefile编译提供的exp.c和gen_libc.py文件。
3.  **构造恶意环境变量：** PoC代码的关键在于构造特定的GLIBC_TUNABLES环境变量。这个环境变量包含精心设计的数据，用于覆盖ld.so中的某些关键内存区域，例如`l_info[DT_RPATH]`。
4.  **利用SUID程序：** 运行一个具有SUID权限的程序，例如/usr/bin/su。SUID程序在执行时会以程序所有者的权限运行，通常是root用户。
5.  **触发漏洞：** 当SUID程序启动时，ld.so会加载并处理GLIBC_TUNABLES环境变量。如果环境变量构造得当，就会触发缓冲区溢出，导致任意代码执行。
6.  **权限提升：** 由于SUID程序以root权限运行，因此通过缓冲区溢出执行的代码也会具有root权限，从而实现本地权限提升。

总而言之，此漏洞的成功利用需要攻击者能够控制目标系统的环境变量，并能够运行具有SUID权限的程序。PoC代码通过精确计算和内存布局，实现了在受控环境下稳定地触发缓冲区溢出，从而达到权限提升的目的。

**项目地址:** [ruycr4ft/CVE-2023-4911](https://github.com/ruycr4ft/CVE-2023-4911)

**漏洞详情:** [CVE-2023-4911](https://nvd.nist.gov/vuln/detail/CVE-2023-4911)