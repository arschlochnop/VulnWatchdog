## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.7.2

**利用条件:** 需要目标系统安装了存在漏洞的pdfkit版本，并且允许通过URL参数控制PDF生成

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于pdfkit中，由于URL未经过充分的安全过滤，攻击者可以通过构造恶意的URL，将shell命令注入到pdfkit的PDF生成过程中，从而实现远程代码执行。POC代码通过curl发送包含恶意URL的POST请求，URL中的name参数包含ruby代码，该ruby代码会反弹shell到攻击者指定的IP地址和端口。 漏洞利用的有效性高，如果目标环境存在漏洞并且满足利用条件，则可以成功利用。投毒风险较低，因为POC代码的功能相对明确，主要是为了反弹shell，不太容易隐藏其他恶意代码。但是仍然需要仔细检查POC代码，防止作者在不易察觉的地方添加恶意逻辑。

利用方式：
1.  攻击者搭建一个HTTP服务器，用于接收反弹shell。
2.  攻击者设置Netcat监听端口，用于接收反弹shell的连接。
3.  攻击者构造包含恶意ruby代码的URL，该ruby代码用于反弹shell。
4.  攻击者通过POST请求将恶意URL发送给目标系统。
5.  目标系统调用pdfkit生成PDF文件，由于URL未经过充分的安全过滤，恶意ruby代码被执行，反弹shell到攻击者的HTTP服务器。
6.  攻击者获得目标系统的shell权限。

**项目地址:** [PurpleWaveIO/CVE-2022-25765-pdfkit-Exploit-Reverse-Shell](https://github.com/PurpleWaveIO/CVE-2022-25765-pdfkit-Exploit-Reverse-Shell)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)