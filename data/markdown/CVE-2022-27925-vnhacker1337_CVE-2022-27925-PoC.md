## CVE-2022-27925-Zimbra-Path Traversal

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2022-27925 允许经过身份验证的 Zimbra 管理员用户通过上传包含恶意路径的 ZIP 档案，将文件写入文件系统上的任意位置。漏洞利用方式如下：

1.  **身份验证：** 首先，攻击者需要获得 Zimbra 管理员帐户的凭据。
2.  **构造恶意 ZIP 档案：** 攻击者创建一个 ZIP 档案，其中包含恶意文件，该文件的名称包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）。该文件实际上是一个Webshell。
3.  **上传 ZIP 档案：** 攻击者使用 `mboximport` 功能上传构造的 ZIP 档案。
4.  **利用路径遍历：** Zimbra 解压缩该档案时，路径遍历序列会将文件写入到目标目录中，覆盖或创建文件。
5.  **远程代码执行：** 如果攻击者成功将webshell写入到Web目录，可以通过访问webshell执行任意代码。

`zimbra-exploit.py` 脚本通过构造包含路径遍历的恶意ZIP文件，并利用 `mboximport` 功能上传到服务器，实现任意文件写入。脚本首先替换了 `exploit_path` 变量中的 email。之后循环遍历 `exploit_path`, 通过 POST 请求，将恶意ZIP文件 (`shell_list` 中的 `.zip` 文件)上传到目标服务器。上传成功后，脚本会尝试访问上传的webshell路径 `/zimbraAdmin/cmd.jsp`，检测webshell是否上传成功。

**有效性：** 根据搜索结果和漏洞利用代码，可以判断该POC代码是有效的，可以利用路径遍历漏洞实现任意文件上传。

**投毒风险：** 分析提供的 `zimbra-exploit.py` 脚本，没有发现明显的恶意代码或者后门。该脚本的功能主要是利用路径遍历漏洞上传webshell。因此，该仓库中存在投毒代码的风险较低。

**项目地址:** [vnhacker1337/CVE-2022-27925-PoC](https://github.com/vnhacker1337/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)