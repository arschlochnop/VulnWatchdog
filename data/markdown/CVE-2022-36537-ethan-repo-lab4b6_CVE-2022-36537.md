## CVE-2022-36537 - ZK Framework AuUploader 信息泄露与RCE

**漏洞编号:** CVE-2022-36537

**漏洞类型:** 信息泄露/远程代码执行

**影响应用:** ZK Framework, R1Soft Server Backup Manager

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** ZK Framework v9.6.1, 9.6.0.1, 9.5.1.3, 9.0.1.2 and 8.6.4.1

**利用条件:** 目标系统运行受影响版本的ZK Framework，且存在AuUploader组件。对于RCE，可能需要特定应用如R1Soft Server Backup Manager。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-36537 漏洞存在于 ZK Framework 的 AuUploader 组件中，允许未经身份验证的攻击者通过构造恶意的 POST 请求来读取任意文件，导致敏感信息泄露。

**有效性：**
从搜索结果和POC代码来看，此漏洞已被广泛利用。POC代码实现了身份验证绕过和文件读取，并尝试部署 JDBC 后门以实现远程代码执行，因此是有效的。

**投毒风险：**
代码中存在一定的投毒风险。具体分析如下：
1. **JDBC 后门部署：** POC代码包含 `deploy_jdbc_backdoor` 函数，该函数会尝试在目标系统上部署一个 JDBC 后门。虽然这本身是漏洞利用的一部分，但攻击者可以在此函数中插入恶意代码，例如执行任意命令或植入持久性后门。
2. **外部依赖:** 代码使用了 `selenium`, `requests_toolbelt`, `urllib3` 等库，在安装这些依赖的时候, 如果作者上传了同名的恶意库, 则会存在风险
3. **硬编码的利用链：** 代码中存在硬编码的URI、参数和正则表达式，这使得攻击者可以轻松地修改代码以执行恶意操作或将目标重定向到受控的服务器。

综合来看，虽然大部分代码用于漏洞利用，但 `deploy_jdbc_backdoor` 函数以及依赖库的使用为攻击者提供了潜在的投毒途径，因此存在一定的投毒风险，评估为 10%。

**利用方式：**
1. **身份验证绕过：** 利用 `bypass_auth2` 函数绕过身份验证，获取 `dtid` 和 `cookie_str`。
2. **信息泄露：** 利用 `forward_request` 函数和构造的 `nextURI` 参数，读取目标系统上的任意文件。例如，读取 `/WEB-INF/zk.xml` 文件以获取敏感配置信息。
3. **远程代码执行 (RCE):** 通过部署 JDBC 后门实现 RCE。具体步骤如下：
    *   调用 `deploy_jdbc_backdoor` 函数。
    *   构建恶意的 JDBC 驱动程序（在 `build_jdbc_backdoor` 函数中）。
    *   通过 `forward_request` 函数和构造的请求，将恶意的 JDBC 驱动程序上传到目标系统。
    *   利用该 JDBC 驱动程序执行任意代码。

**搜索引擎结果补充：**
*   多个来源表明该漏洞已被积极利用，包括 CISA 将其添加到已知被利用漏洞目录 (KEV)。
*   一些报告指出该漏洞可被用于泄露服务器私钥文件和软件许可证。
*   R1Soft Server Backup Manager 受此漏洞影响，可能导致 RCE。

**项目地址:** [ethan-repo-lab4b6/CVE-2022-36537](https://github.com/ethan-repo-lab4b6/CVE-2022-36537)

**漏洞详情:** [CVE-2022-36537](https://nvd.nist.gov/vuln/detail/CVE-2022-36537)