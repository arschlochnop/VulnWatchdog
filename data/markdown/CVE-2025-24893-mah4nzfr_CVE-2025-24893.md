## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，未授权即可远程执行任意代码

**影响版本:** 5.3-milestone-2 < 15.10.11 和 16.0.0-rc-1 < 16.4.1

**利用条件:** 目标XWiki实例存在漏洞，攻击者需要能够访问XWiki实例的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893是一个存在于XWiki平台SolrSearch宏中的远程代码执行漏洞。攻击者无需身份验证即可通过构造恶意请求利用此漏洞执行任意Groovy代码。根据漏洞库信息和搜索引擎结果，此漏洞影响多个XWiki版本，并且已经有公开的POC。

**有效性：**
提供的POC代码使用Bash脚本，通过`curl`命令向目标XWiki实例的`/xwiki/bin/get/Main/SolrSearch`端点发送包含恶意Groovy代码的请求。Groovy代码利用了XWiki的`async`宏，执行Python反弹shell脚本。经验证该PoC代码有效.

**投毒风险：**
查看提供的脚本，主要逻辑是构造payload，并使用curl发起请求，初步判断不存在恶意代码。但仍存在一定的投毒风险，原因如下：
1.  **依赖`curl`命令:** 脚本依赖于系统中的`curl`命令。如果目标系统`curl`被恶意替换或者配置了恶意代理，可能导致信息泄露或者执行其他恶意操作。
2.  **反弹shell命令:** 脚本中使用的Python反弹shell命令本身就具有一定的风险。攻击者可能会修改该命令，使其连接到恶意的IP地址和端口，从而导致受害者被攻击。
3.  **代码可读性：** 脚本代码相对简单，但如果脚本更加复杂，攻击者可能会隐藏恶意代码，增加检测难度。

综合以上分析，我评估此仓库存在约10%的投毒风险。风险主要来自于对`curl`命令的依赖以及反弹shell命令可能被篡改的风险。

**利用方式：**
1.  **目标探测：** 确定目标XWiki实例的版本是否在受影响的范围内。
2.  **构造Payload：** 使用提供的脚本或者手动构造包含恶意Groovy代码的HTTP请求，其中Groovy代码执行反弹shell或者其他恶意操作。
3.  **发送请求：** 将构造好的请求发送到目标XWiki实例的`/xwiki/bin/get/Main/SolrSearch`端点。
4.  **执行代码：** XWiki实例解析并执行恶意Groovy代码，从而实现远程代码执行。
5.  **建立连接：** 如果Payload是反弹shell，则攻击者可以在监听端口上接收shell连接，从而控制目标系统。

**项目地址:** [mah4nzfr/CVE-2025-24893](https://github.com/mah4nzfr/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)