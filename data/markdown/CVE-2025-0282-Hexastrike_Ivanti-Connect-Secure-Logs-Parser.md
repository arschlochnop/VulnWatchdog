## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 产品中的一个栈溢出漏洞。未经身份验证的远程攻击者可以利用此漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（日志解析器），可以确认该漏洞是真实存在的，并且已经被积极利用。

**投毒风险：**
提供的Python脚本 `ics_logs_parser.py` 主要功能是将 Ivanti Secure Connect 的 .vc0 日志文件转换为 CSV 格式，用于数字取证和事件响应。脚本本身的功能是提取和转换日志数据，没有发现直接执行恶意代码的逻辑。存在的风险点包括：

*   **依赖的`logmessages_map.csv`文件：** 如果该文件被篡改，可能导致日志解析结果不准确，影响安全分析。 但是，篡改该文件并不能直接执行任意代码，而只是会影响日志分析的准确性。
*   **代码注入风险：** 虽然代码中没有明显的恶意代码，但如果攻击者能够篡改 `ics_logs_parser.py` 文件，例如通过插入恶意代码到 `process_subline()` 函数中的 `datetime.fromtimestamp(...)` 调用，则可能实现远程代码执行。但是，这需要攻击者先获得对服务器的写入权限。

综合以上分析，考虑到脚本的功能和潜在的风险点，可以判断该仓库存在一定投毒风险，但主要集中在需要先获得系统权限进行篡改才能实现。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** CVE-2025-0282 是一个栈溢出漏洞，位于处理特定类型的网络连接或请求的组件中（例如，IF-T 连接）。
2.  **利用过程：** 攻击者通过构造特制的网络数据包，向目标 Ivanti 设备发送精心设计的恶意数据。由于程序在处理这些数据时没有进行充分的边界检查，导致数据溢出到栈上，覆盖了返回地址或其他关键数据。
3.  **代码执行：** 攻击者通过栈溢出，将返回地址修改为攻击者控制的地址，该地址指向攻击者预先布置好的恶意代码（shellcode）。当程序执行到被覆盖的返回地址时，控制权转移到攻击者的 shellcode，从而实现远程代码执行。
4.  **搜索引擎补充：** 从搜索引擎结果来看，漏洞与 `web` 二进制文件有关，该文件处理 HTTP 连接和 VPN 连接。 

**总结：**
攻击者利用特制的网络请求触发栈溢出，覆盖返回地址，执行 shellcode，最终实现远程代码执行。提供的代码仓库是一个日志解析工具，本身不直接包含漏洞利用代码，但存在被篡改利用的风险。

**项目地址:** [Hexastrike/Ivanti-Connect-Secure-Logs-Parser](https://github.com/Hexastrike/Ivanti-Connect-Secure-Logs-Parser)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)