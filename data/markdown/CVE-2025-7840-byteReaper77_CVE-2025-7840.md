## CVE-2025-7840 - Campcodes Online Movie Theater Seat Reservation System XSS

**漏洞编号:** CVE-2025-7840

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Campcodes Online Movie Theater Seat Reservation System

**危害等级:** 中危，可能导致用户信息泄露、会话劫持或恶意脚本执行

**影响版本:** 1.0

**利用条件:** 需要用户访问受攻击页面，且服务端未对Firstname/Lastname参数进行充分的输入验证和过滤

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-7840 存在于 Campcodes Online Movie Theater Seat Reservation System 1.0 的 `/index.php?page=reserve` 页面，该页面的 Firstname/Lastname 参数存在跨站脚本漏洞。攻击者可以通过构造包含恶意 JavaScript 代码的 Firstname 参数，当受害者访问该页面时，恶意脚本会在受害者的浏览器中执行。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码 `exploit.c` 演示了如何构造带有恶意 payload 的 GET 请求，并提供了自定义 payload、cookie 处理和 verbose 模式等功能。搜索引擎结果也表明该漏洞已被公开披露，并存在可利用的 exploit。

**投毒风险分析：**

虽然 `exploit.c` 代码看起来相对简单，主要功能是发送带有 XSS payload 的 HTTP 请求，但仍存在轻微的投毒风险，评估为 5%。
*   **依赖项风险：** `exploit.c` 依赖于 `argparse.c` 和 `libcurl`。虽然 `libcurl` 是常见的库，但 `argparse.c` 是一个需要审查的本地文件，攻击者可能在 `argparse.c` 中植入恶意代码。
*   **Payload 风险：** 漏洞利用代码中包含一些预定义的 XSS payload，虽然这些 payload 旨在用于概念验证，但如果攻击者使用这些 payload 进行实际攻击，可能会被安全设备检测到。攻击者也可能修改代码，添加隐蔽性更高的 payload，从而绕过安全检测。
*   **行为风险：** 代码中可能存在不明显的后门，例如：在特定条件下执行恶意操作，或收集用户信息发送给攻击者。需要对代码进行更深入的分析才能确定是否存在这些后门。
*   **License 风险**: MIT协议允许使用者任意使用和修改代码，虽然提高了使用的自由度，但也增加了代码被恶意修改的风险。

**利用方式：**

1.  **编译漏洞利用代码：** 使用 `gcc -o exploit exploit.c argparse.c -lcurl` 命令编译 `exploit.c`。
2.  **运行漏洞利用代码：** 使用 `./exploit -u <TARGET_URL> [options]` 命令运行编译后的 exploit。需要替换 `<TARGET_URL>` 为目标应用程序的 URL。
3.  **选择 Payload：** 可以使用 `-b` 选项指定自定义的 XSS payload，或使用 exploit 中内置的 payload。
4.  **发送恶意请求：** exploit 会构造包含恶意 payload 的 GET 请求，并发送到目标应用程序的 `/index.php?page=reserve` 页面。
5.  **触发 XSS：** 当受害者访问包含恶意代码的页面时，XSS 漏洞会被触发，恶意 JavaScript 代码会在受害者的浏览器中执行。

**项目地址:** [byteReaper77/CVE-2025-7840](https://github.com/byteReaper77/CVE-2025-7840)

**漏洞详情:** [CVE-2025-7840](https://nvd.nist.gov/vuln/detail/CVE-2025-7840)