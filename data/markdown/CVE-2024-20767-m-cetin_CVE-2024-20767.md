## CVE-2024-20767-Adobe ColdFusion-任意文件读取

**漏洞编号:** CVE-2024-20767

**漏洞类型:** 任意文件读取

**影响应用:** Adobe ColdFusion

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2023.6, 2021.12 及更早版本

**利用条件:** admin panel (或 Performance Monitoring Toolset /pms) 暴露于互联网

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-20767 是 Adobe ColdFusion 中的一个不当访问控制漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息和搜索引擎结果，该漏洞存在于 ColdFusion 2023.6, 2021.12 及更早版本中。利用条件是 ColdFusion 的管理面板(或 Performance Monitoring Toolset 的 /pms)暴露于互联网。CVSS v3.1 评分为 7.4，属于高危漏洞。

漏洞利用方式：
1.  攻击者首先尝试访问 `/CFIDE/adminapi/_servermanager/servermanager.cfc?method=getHeartBeat` 获取 UUID。
2.  然后，构造包含恶意文件路径的请求，发送到 `/pms?module=logging&file_name=../../../../../../../{command}&number_of_lines=100`，其中 `{command}` 是要读取的文件路径。请求头中需要包含之前获取的 UUID。
3.  如果服务器返回状态码 200，则表明文件读取成功，响应体中包含文件内容。

POC代码分析：
提供的Python POC代码 `get-the-files.py` 实现了上述利用方式。该脚本接受目标URL、端口和要读取的文件路径作为参数，模拟攻击者发送恶意请求，读取服务器上的文件。

投毒风险分析：
POC 代码本身比较简洁，主要功能是发送HTTP请求并读取响应。 代码中使用的 `requests` 库和正则表达式 `re` 库均为常用库，风险较低。但仍存在极小可能作者在代码中添加了隐蔽的恶意代码，比如：
1.  **数据回传：** 将读取的文件内容发送到攻击者控制的服务器。
2.  **恶意篡改：** 虽然主要功能是读取文件，但可能包含尝试写入或修改配置文件的代码。
3.  **隐藏后门：** 在成功利用漏洞后，植入一个 webshell 或其他类型的后门，方便后续访问。
经过分析，认为存在投毒代码的风险为 5%。主要是考虑到漏洞利用代码的功能明确，较为简单，隐藏恶意代码的空间有限。

综合评估：
该漏洞利用的有效性较高，POC代码可以成功读取服务器上的文件。但需要注意POC代码的潜在投毒风险，使用前务必进行代码审计。

**项目地址:** [m-cetin/CVE-2024-20767](https://github.com/m-cetin/CVE-2024-20767)

**漏洞详情:** [CVE-2024-20767](https://nvd.nist.gov/vuln/detail/CVE-2024-20767)