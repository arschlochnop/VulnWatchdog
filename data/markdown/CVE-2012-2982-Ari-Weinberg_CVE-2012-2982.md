## CVE-2012-2982-Webmin-远程命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.590

**利用条件:** 需要Webmin的登录凭据，目标版本低于或等于1.590

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2982 是 Webmin 1.590 及更早版本中 file/show.cgi 存在的一个远程命令执行漏洞。经过身份验证的远程用户可以通过在路径名中使用无效字符（如 | 管道符）来执行任意命令。

**有效性：**
提供的 Python 脚本 POC 看起来有效。它首先尝试使用提供的用户名和密码登录 Webmin。成功登录后，它会构造一个包含恶意路径的请求，该路径包含一个管道符 `|`，允许攻击者执行任意命令。

**投毒风险：**
查看提供的 `CVE-2012-2982.py` 脚本和 `README.md` 文件，没有发现明显的恶意代码或后门。该脚本的功能很明确，即利用 CVE-2012-2982 漏洞执行命令。因此，投毒的概率较低，可以认为是 0%。

**利用方式：**
1.  攻击者需要有效的 Webmin 用户名和密码。
2.  攻击者使用提供的脚本，输入目标主机的 hostname、port，以及 Webmin 的用户名和密码，以及要执行的命令。
3.  脚本首先向 `/session_login.cgi` 发送 POST 请求，尝试登录 Webmin。
4.  如果登录成功，服务器返回 302 重定向。
5.  脚本然后构造一个带有恶意 payload 的 GET 请求发送到 `/file/show.cgi`。payload 中包含管道符 `|`，允许命令执行。例如，`http://<host>:<port>/file/show.cgi/bin/AAAAA|whoami|`
6. Webmin 会将管道符后的命令传递给系统执行，并将结果返回给攻击者。

**项目地址:** [Ari-Weinberg/CVE-2012-2982](https://github.com/Ari-Weinberg/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)