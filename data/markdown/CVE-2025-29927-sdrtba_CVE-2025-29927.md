## CVE-2025-29927-Next.js-授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问、数据泄露和缓存投毒

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用使用了存在漏洞的 Next.js 版本，并且使用 middleware 进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。由于 Next.js 中间件在进行授权决策时，不正确地信任 `x-middleware-subrequest` 内部标志，攻击者可以通过在外部请求中设置该标头来绕过授权检查。该漏洞影响多个版本的 Next.js。利用该漏洞，攻击者可以访问受保护的页面和数据，甚至可能进行缓存投毒攻击（CPDoS），操纵 CDN/边缘缓存，导致拒绝服务或数据泄露。 

**漏洞利用方式：**
1. 应用程序使用 Next.js 中间件进行身份验证/授权。
2. 应用程序使用的 Next.js 版本在受影响范围内。
3. 攻击者发送包含 `x-middleware-subrequest: 1` 标头的 HTTP 请求访问受保护资源。
4. 如果应用程序存在漏洞，中间件会错误地将该请求视为内部子请求，绕过授权检查，并允许攻击者访问受保护的资源。

**投毒风险分析：**
该漏洞利用代码主要提供的是漏洞验证的步骤和方法，例如，如何构建包含特定 header 的请求来测试漏洞是否存在。提供的 Dockerfile 用于快速搭建一个存在漏洞的环境进行测试。虽然在批量验证部分提到了 nuclei 和 Python，但也只是提供了一种扫描检测的思路，并没有直接提供任何可执行的脚本。因此，从总体来看，该漏洞利用代码本身包含恶意投毒代码的可能性较低，但是，在 nuclei 批量扫描检测时，需要注意控制扫描频率，避免对目标造成 DoS 影响。

**风险评估：**
虽然直接投毒风险较低，但仍需谨慎。建议在使用任何自动化工具进行漏洞验证之前，仔细审查代码，并确保在授权环境下进行测试。

**投毒风险百分比：** 10%

**项目地址:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)