## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 - 1.9.17 (不包含1.9.17p1)

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463是Sudo中一个严重的本地权限提升漏洞，存在于1.9.14到1.9.17版本（不包括1.9.17p1）。该漏洞允许本地用户通过`--chroot`选项获得root权限。漏洞原因是当使用用户控制的目录与`--chroot`选项一起使用时，Sudo错误地信任该chroot jail中的`nsswitch.conf`文件。这允许攻击者为名称服务交换（NSS）机制指定一个恶意共享库来加载，从而导致以root权限执行代码。

**漏洞利用方式:**

1.  **创建恶意Chroot环境:** 攻击者首先创建一个包含`etc/nsswitch.conf`文件的目录，该文件指向攻击者控制的恶意共享库。还会复制`/etc/group`到 chroot 环境中保证基本功能。
2.  **编译恶意共享库:** 攻击者编译一个共享库（例如`exploit123.so.2`），其中包含将在加载时执行的恶意代码（提升权限并启动一个root shell）。
3.  **使用Sudo运行恶意Chroot环境:** 攻击者使用`sudo -R <恶意chroot目录> <任意命令>`命令，指示Sudo使用恶意chroot环境。
4.  **触发NSS查找:** 当Sudo需要解析用户名或组名时，它会加载由恶意`nsswitch.conf`文件指定的恶意共享库，从而执行恶意代码并获得root权限。

**投毒风险分析:**

代码主要逻辑是创建 chroot 环境并编译so文件,然后提权，**但请注意，PoC 本身的目的就是提权，因此其中的提权代码不能算是“投毒”代码**。PoC 代码中将 `/bin/bash` 提权后直接运行了， 这是一种较为直接的提权方式, 作者理论上可以在`exploit.c`中添加其他恶意行为，例如植入后门、收集敏感信息或修改系统文件. 但是就提供的代码来看，其核心功能是为了利用漏洞进行提权，没有发现明显的额外恶意行为。

**风险百分比：** 给予5%的投毒风险是考虑到作者可能隐藏了未被发现的细微恶意行为的可能性，例如在提权后执行一些不明显的操作。但是，这种可能性相对较低，因为PoC的主要目的是为了展示漏洞利用，过于隐蔽的恶意行为可能会影响PoC的有效性。

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码清晰地展示了如何构建恶意的chroot环境，编译恶意共享库，并使用`sudo -R`命令触发漏洞，从而实现本地提权。

**项目地址:** [At0mXploit/CVE-2025-32463](https://github.com/At0mXploit/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)