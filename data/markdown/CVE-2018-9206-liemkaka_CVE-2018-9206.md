## CVE-2018-9206-Blueimp jQuery File Upload-任意文件上传

**漏洞编号:** CVE-2018-9206

**漏洞类型:** 任意文件上传

**影响应用:** Blueimp jQuery File Upload

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.22.0

**利用条件:** 目标系统使用了存在漏洞的Blueimp jQuery File Upload组件，且未进行身份验证。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-9206 存在于 Blueimp jQuery File Upload 9.22.0 及更早版本中。这是一个未经身份验证的任意文件上传漏洞，攻击者可以利用此漏洞上传恶意文件（例如，webshell）到服务器，从而获取服务器的远程代码执行权限。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞是一个已知的、公开的任意文件上传漏洞。漏洞利用代码（来自Exploit-DB）和相关的文章表明，该漏洞被广泛利用。提供的Python脚本本身**并非直接的漏洞利用代码**，而是一个**漏洞检测与告警**脚本。它通过抓包分析HTTP响应，如果发现“404 Not Found”并结合HTTP请求进行分析，则可能表明存在尝试利用该文件上传漏洞的行为，然后发送邮件告警。
虽然提供的python脚本没有直接利用漏洞，但是多个搜索结果都指出了此漏洞的存在和利用方法（通过上传恶意文件）。因此，从概念上来说，可以认为存在有效的利用方式。

**投毒风险分析：**

提供的Python脚本的主要功能是网络流量捕获（使用pyshark）和邮件发送（使用smtplib）。

*   流量捕获部分：脚本捕获 `eth0` 网卡的流量，并查找包含 `http` 协议的数据包。然后，检查数据包的内容是否包含 `404 Not Found`。如果找到，它会打印一条警告消息。
*   邮件发送部分：脚本使用 `smtplib` 和 `email.message` 模块来构造和发送电子邮件。它使用指定的电子邮件地址和密码登录到SMTP服务器，然后发送包含警告信息的电子邮件。

从代码逻辑看，主要风险在于：
1.  **硬编码的邮箱账号密码：** 脚本中硬编码了邮箱地址 `nc296962@gmail.com` 和密码 `iqnhmkxxsrdoztuq`。这是一个非常危险的行为，因为攻击者可以利用这些凭据访问该邮箱，从而窃取敏感信息或进行其他恶意活动。
2.  **潜在的中间人攻击风险：** 虽然使用了 `smtplib.SMTP_SSL`，但仍存在中间人攻击的风险，如果服务器的SSL证书未正确验证。
3.  **错误的告警判断：** 仅仅通过 `404 Not Found` 来判断攻击过于简单，容易产生误报。

**是否存在投毒代码：**

该脚本本身就是一个监控脚本，作者硬编码的邮箱账号密码本身就是潜在的投毒。如果攻击者能够入侵到部署此脚本的服务器，就可以利用该邮箱进一步发起攻击。所以，我判定该脚本存在潜在的投毒风险，概率为20%。这个脚本的功能是监控，所以不应该是直接的利用代码，判断为投毒。

**利用方式：**

1.  **上传任意文件：** 攻击者可以绕过身份验证，直接上传恶意文件到服务器。上传的文件类型通常是webshell（例如，PHP、JSP、ASPX等脚本），这些文件包含恶意代码，允许攻击者在服务器上执行任意命令。
2.  **远程代码执行：** 成功上传 webshell 后，攻击者可以通过访问该 webshell 来执行任意命令。这通常通过发送 HTTP 请求到 webshell 的 URL，并在请求中包含要执行的命令来实现。
3.  **控制服务器：** 一旦攻击者能够在服务器上执行任意命令，他们就可以完全控制服务器，包括读取敏感数据、修改系统配置、安装恶意软件等。

总结，此漏洞的利用方式是未授权上传恶意文件，导致远程代码执行。

**项目地址:** [liemkaka/CVE-2018-9206](https://github.com/liemkaka/CVE-2018-9206)

**漏洞详情:** [CVE-2018-9206](https://nvd.nist.gov/vuln/detail/CVE-2018-9206)