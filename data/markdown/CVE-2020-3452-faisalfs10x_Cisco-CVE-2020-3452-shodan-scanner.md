## CVE-2020-3452-Cisco ASA/FTD 路径遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 路径遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可读取敏感文件

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 需要启用WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-3452是Cisco ASA和FTD软件中的一个只读路径遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的HTTP请求，利用目录遍历序列读取目标系统上的敏感文件。该漏洞存在于Web Services界面，由于对HTTP请求中的URL缺乏适当的输入验证导致。

**有效性:** 提供的POC代码(`CVE-2020-3452-checker.sh`)通过发送包含目录遍历字符的HTTP请求，尝试读取`portal_inc.lua`文件来验证目标是否存在漏洞。如果返回包含"Copyright"的响应，则认为目标存在漏洞，因此该POC代码是有效的。

**投毒风险:**  脚本的主要功能是检测漏洞是否存在。投毒的风险较低，但依然存在：
   * **Shodan依赖:** 脚本依赖于Shodan CLI和Shodan的搜索结果。如果Shodan的数据被篡改，或者攻击者能够控制Shodan搜索结果，那么脚本可能会被用于攻击特定的目标。
   * **错误判断:** 脚本通过检查响应中是否包含"Copyright"字符串来判断是否存在漏洞，这种方法可能存在误判，导致对未受影响的系统进行不必要的扫描。
   * **潜在的后门:**  虽然没有明显的后门代码，但是脚本可以通过修改请求的URL，读取其他文件，从而泄露敏感信息，或者在某些情况下，可能会被利用进行进一步的攻击。

   综合来看，投毒风险较低，约为10%，主要集中在依赖外部服务和简单的判断逻辑上。

**利用方式:**
1.  攻击者利用Shodan等搜索引擎查找暴露在互联网上的Cisco ASA/FTD设备，并且启用了WebVPN或AnyConnect功能。
2.  构造包含目录遍历字符的HTTP请求，例如：`https://<目标IP>/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua`
3.  如果目标存在漏洞，则服务器返回`portal_inc.lua`文件的内容，攻击者可以读取其中的敏感信息。
4.  攻击者可以通过修改请求的URL，读取其他Web Services文件系统中的文件，进一步扩大攻击范围。

**项目地址:** [faisalfs10x/Cisco-CVE-2020-3452-shodan-scanner](https://github.com/faisalfs10x/Cisco-CVE-2020-3452-shodan-scanner)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)