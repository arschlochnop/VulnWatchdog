## CVE-2025-26794-Exim-SQL注入

**漏洞编号:** CVE-2025-26794

**漏洞类型:** SQL注入

**影响应用:** Exim

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 4.98 (before 4.98.1)

**利用条件:** 需要Exim使用SQLite hints和ETRN序列化，网络可访问SMTP服务(25端口)，无需认证即可使用ETRN命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26794是Exim 4.98中的一个SQL注入漏洞，当Exim配置为使用SQLite DBM存储并且ETRN命令处理程序处理序列化数据时，会发生此漏洞。由于用户可控输入在SQL查询构造之前未经过充分的清理，攻击者可以利用此漏洞提取敏感数据，执行基于时间的盲SQL注入攻击，并枚举数据库结构（表、列、数据）。

**有效性：**
提供的PoC代码有效。漏洞库信息、搜索引擎结果(虽然为空，但暗示存在相关信息)以及漏洞利用代码的README.md文件都表明了该漏洞的存在和利用方式。

**投毒风险：**
README.md文件本身没有明显的投毒代码，但存在一定的风险。风险点在于:

1.  **依赖缺失风险：** README.md表明无依赖库，但是实际使用时可能会加入恶意的依赖.
2.  **代码混淆风险：** exploit.py可能包含混淆的代码，难以直接判断是否存在恶意行为，增加了安全风险。
3.  **隐蔽后门：** 即使exploit.py不包含直接的恶意代码，它也可能利用SQL注入漏洞在目标系统上植入后门或执行其他恶意操作，例如添加管理员账户，修改系统配置等。

综合考虑，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 通过SMTP协议向目标Exim服务器发送包含恶意SQL注入payload的ETRN命令。
2.  **Payload构造：** SQL注入payload利用了ETRN命令处理程序中对用户输入的未充分清理，将恶意SQL代码注入到SQLite查询中。示例payload：`ETRN #',1); <MALICIOUS_QUERY> /*`
3.  **数据提取/利用：** 攻击者可以使用时间型盲注（通过`SELECT 1 FROM tbl WHERE 1234=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2)))))`等SQLite特定的时间延迟函数）或直接执行SQL查询来提取敏感数据，例如数据库结构、用户凭据等。
4.  **自动化利用：**  PoC代码提供了多种模式，包括自动化数据库dump、交互式SQL查询等，方便攻击者进行漏洞利用。

**项目地址:** [XploitGh0st/CVE-2025-26794-exploit](https://github.com/XploitGh0st/CVE-2025-26794-exploit)

**漏洞详情:** [CVE-2025-26794](https://nvd.nist.gov/vuln/detail/CVE-2025-26794)