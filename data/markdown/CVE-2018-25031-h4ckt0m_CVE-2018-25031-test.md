## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)