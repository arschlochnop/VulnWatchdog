## CVE-2022-38577-ProcessMaker-权限提升

**漏洞编号:** CVE-2022-38577

**漏洞类型:** 权限提升

**影响应用:** ProcessMaker

**危害等级:** 高危，可将普通用户权限提升至管理员权限

**影响版本:** < 3.5.4

**利用条件:** 需要ProcessMaker实例可访问，并且拥有一个普通用户账号

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-38577 漏洞存在于 ProcessMaker 3.5.4 之前的版本中，允许攻击者利用用户配置页面中的不安全权限，将普通用户权限提升至管理员权限。

**有效性评估：**
根据漏洞信息和POC代码，该漏洞的利用是有效的。POC代码中提供了两种利用方式：
    *   **2.5.0 - 3.0 GA:** 修改更新用户信息的POST请求中的“USR_ROLE”参数为“PROCESSMAKER_ADMIN”。
    *   **3.2.1 之前:**  通过API接口获取角色ID和权限ID，然后通过API接口将特定权限分配给用户角色。

**投毒风险分析：**
通读提供的poc代码，代码主要功能是发送特定请求，完成权限提升，并未发现明显的恶意投毒代码。存在投毒的可能性极低,大约为1%。

**漏洞利用方式：**
1.  **登录：** 使用普通用户账户登录 ProcessMaker 系统。
2.  **利用：** 根据ProcessMaker的版本，选择对应的利用方式。
    *   **2.5.0 - 3.0 GA:**  在用户资料修改页面，抓取更新用户资料的 POST 请求，修改 POST 请求中的 `USR_ROLE` 参数的值为 `PROCESSMAKER_ADMIN`，然后发送修改后的请求。
    *   **3.2.1 之前:**  使用 POC 脚本，指定要添加或删除的权限。脚本会首先获取用户的 Role ID，然后根据用户的选择，添加或删除相应的权限。
3.  **验证：** 重新登录系统，验证用户是否已成功提升为管理员权限。

**项目地址:** [sornram9254/CVE-2022-38577-Processmaker](https://github.com/sornram9254/CVE-2022-38577-Processmaker)

**漏洞详情:** [CVE-2022-38577](https://nvd.nist.gov/vuln/detail/CVE-2022-38577)