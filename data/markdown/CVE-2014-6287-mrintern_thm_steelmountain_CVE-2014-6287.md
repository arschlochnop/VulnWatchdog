## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行存在漏洞的Rejetto HFS版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本中，具体是 parserLib.pas 文件中的 `findMacroMarker` 函数。攻击者可以通过在搜索操作中使用 `%00` 序列来执行任意程序。该漏洞的利用方式如下：

1.  **漏洞原理：** `findMacroMarker` 函数在处理搜索请求时，未能正确处理空字节 `%00`，导致程序执行流程出现偏差，攻击者可以利用这一缺陷注入恶意代码。

2.  **利用方式：** 攻击者构造包含 `%00` 序列的恶意搜索请求。请求中包含要执行的命令，服务器在解析请求时，由于空字节的截断作用，会将恶意代码传递给操作系统执行。

3.  **POC分析：** 提供的Python3 POC脚本 `http_fs_exploit.py` 旨在自动化利用该漏洞。脚本通过发送包含 `%00` 和恶意命令的HTTP GET 请求，尝试在目标服务器上执行命令。脚本首先下载 `nc.exe` (Netcat) 到目标服务器，然后使用 `nc.exe` 建立反向shell连接。
    * 脚本分为三个阶段：
        *   `script_create()`：创建 VBScript 脚本，用于下载 netcat。
        *   `execute_script()`：执行下载 netcat 的 VBScript 脚本。
        *   `nc_run()`：运行 netcat 并建立反向 shell 连接。
4.  **有效性：** 根据漏洞库信息和搜索结果，此漏洞确实存在并且有可用的利用代码。该POC代码的原理是利用HFS处理搜索请求时的漏洞，向目标服务器注入并执行恶意代码，从而实现远程代码执行。如果目标服务器满足漏洞利用的条件（存在漏洞版本，并且可以网络访问），那么该POC代码很可能有效。

5.  **投毒风险：** 提供的代码本身是漏洞利用代码，用于在目标系统上执行命令。该代码尝试下载并执行 `nc.exe`，这本身就是一种恶意行为。但是，**从分析来看，该代码的目的明确，不存在隐藏的、与漏洞利用无关的恶意代码，因此投毒风险较低 (0%)**。 需要注意的是，使用此代码会对目标系统造成损害，请在授权的环境下进行测试。

6. **利用过程:**
   1. 修改exploit脚本中的本地IP地址和端口号
   2. 确保攻击机上有一个web服务器，并且netcat(nc.exe)位于web服务器的可访问目录中
   3. 运行exploit脚本，将目标IP地址和端口号作为参数传递
   4. 攻击机监听指定的端口，等待目标机器的反向shell连接

**项目地址:** [mrintern/thm_steelmountain_CVE-2014-6287](https://github.com/mrintern/thm_steelmountain_CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)