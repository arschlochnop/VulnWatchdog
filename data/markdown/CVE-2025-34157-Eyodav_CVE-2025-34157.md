## CVE-2025-34157-Coolify-Stored XSS

**漏洞编号:** CVE-2025-34157

**漏洞类型:** Stored XSS

**影响应用:** Coolify

**危害等级:** 高危，可完全控制Coolify实例

**影响版本:** < v4.0.0-beta.420.7

**利用条件:** 需要低权限用户账号，管理员进行特定操作（删除项目或资源）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-34157存在于Coolify的project creation workflow中，是一个存储型XSS漏洞。低权限用户可以通过创建一个包含恶意JavaScript代码的项目名称来触发该漏洞。当管理员尝试删除该项目或其相关资源时，恶意代码会在管理员的浏览器上下文中执行。这会导致管理员的会话cookie、API token被盗取，甚至可以访问WebSocket终端会话，从而完全控制Coolify实例。PoC代码提供了一些包含HTML标签的payload，这些payload可能被用于XSS攻击。虽然PoC里payloads较多，但基本上都是html标签，存在投毒的概率较低,大部分都是验证xss是否存在。唯一可能的投毒点是iframe标签，但iframe的src属性是www.google.com，并无危害。

**漏洞利用方式：**

1.  **低权限用户创建项目：** 拥有Coolify账号的低权限用户（包括成员）创建一个新的项目，并在项目名称中插入恶意JavaScript代码（例如`<script>alert("XSS");</script>`或者更复杂的payload）。
2.  **等待管理员操作：** 等待管理员登录Coolify并尝试删除该项目或与该项目相关的资源。
3.  **XSS触发：** 当管理员执行删除操作时，Coolify的frontend rendering of Project Name field没有进行充分的输入验证和过滤，导致项目名称中的恶意JavaScript代码被执行。
4.  **获取管理员权限：** 恶意JavaScript代码可以窃取管理员的cookie、API token，或者访问WebSocket终端会话，从而获得对Coolify实例的完全控制。

**有效性评估：**
根据漏洞描述和PoC代码，该漏洞利用的有效性较高。CVSS评分为9.4，表明这是一个严重的安全漏洞。PoC代码中的payload可以触发XSS，并且漏洞影响描述中也表明了漏洞利用的后果。

**投毒风险评估：**
PoC代码中包含大量HTML标签payload，用于验证XSS漏洞。虽然存在`<iframe>`标签，但其`src`属性指向`https://www.google.com`，并无恶意行为。因此，该PoC代码的投毒风险较低，约为1%。

**项目地址:** [Eyodav/CVE-2025-34157](https://github.com/Eyodav/CVE-2025-34157)

**漏洞详情:** [CVE-2025-34157](https://nvd.nist.gov/vuln/detail/CVE-2025-34157)