## CVE-2025-58443 - FOG Project Authentication Bypass

**漏洞编号:** CVE-2025-58443

**漏洞类型:** Authentication Bypass, SSRF, File Listing

**影响应用:** FOG Project

**危害等级:** 高危，可能导致数据库泄露、服务器端请求伪造和敏感信息泄露

**影响版本:** 1.5.10.1673

**利用条件:** 需要网络访问目标FOG Project实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-58443是FOG Project 1.5.10.1673版本中的一个身份验证绕过漏洞。通过利用此漏洞，未经身份验证的攻击者可以转储包含明文密码、用户名和管理员密码哈希的数据库。提供的POC代码包含三个主要功能：

1.  **数据库转储 (EXPDump):** 利用身份验证绕过漏洞，下载包含敏感信息的数据库转储文件。
2.  **服务器端请求伪造 (SSRF):** 允许攻击者从服务器发起请求，可能暴露内部服务或进行端口扫描。 `getversion.php?url={quote(url)}` 存在SSRF漏洞
3.  **文件列表 (listfiles):** 允许攻击者列出服务器上的文件。

**有效性评估：**
根据提供的漏洞利用代码和描述，该漏洞利用似乎有效。图片展示了成功利用各个漏洞的结果。

**投毒风险评估：**
尽管POC代码的主要功能是利用漏洞，但存在少量投毒风险。风险评估如下：
*   `requests.post` 和 `requests.get` 函数本身可能存在被利用的风险，例如通过精心构造的URL或header，导致请求被重定向到恶意站点或执行恶意代码。代码中`verify=False` 关闭了SSL证书验证，增加了中间人攻击的风险. 此外，如果 `output.txt` 文件被用于后续的自动化处理，恶意代码可能被注入到其中。
*   攻击者可能会修改代码，例如添加额外的请求，或将转储的数据库发送到远程服务器。
*   代码中硬编码的`PHPSESSID` 为空，可能存在风险，虽然目前脚本没有利用这个session，但是不排除后续会被利用。
综合评估，投毒风险较低，约为10%。

**利用方式总结：**
利用方式涉及三个步骤，攻击者首先利用身份验证绕过漏洞，然后选择执行数据库转储、服务器端请求伪造或文件列表操作。每种操作都可能导致不同的安全风险。数据库转储泄露敏感信息，SSRF允许攻击者与内部服务交互，文件列表暴露服务器结构。

**项目地址:** [casp3r0x0/CVE-2025-58443](https://github.com/casp3r0x0/CVE-2025-58443)

**漏洞详情:** [CVE-2025-58443](https://nvd.nist.gov/vuln/detail/CVE-2025-58443)