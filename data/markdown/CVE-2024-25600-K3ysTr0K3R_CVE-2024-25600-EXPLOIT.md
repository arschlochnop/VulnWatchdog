## CVE-2024-25600-Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标网站安装了受影响的Bricks Builder插件且允许未授权访问/wp-json/bricks/v1/render_element或/?rest_route=/bricks/v1/render_element端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-25600是一个存在于Bricks Builder <= 1.9.6版本中的未授权远程代码执行漏洞。攻击者可以通过向`/wp-json/bricks/v1/render_element`或`/?rest_route=/bricks/v1/render_element`端点发送特制的POST请求来注入和执行任意PHP代码。

**利用方式：**

1.  **获取Nonce：** 首先，利用代码尝试通过请求目标站点获取一个nonce值。该nonce用于绕过一些安全检查。
2.  **构造恶意数据：**  根据获取的nonce，构造包含恶意PHP代码的JSON数据。该代码会被插入到`queryEditor`或`code`字段中，取决于利用的端点。
3.  **发送POST请求：** 将构造的JSON数据通过POST请求发送到`/wp-json/bricks/v1/render_element`或`/?rest_route=/bricks/v1/render_element`端点。
4.  **代码执行：**  服务器端处理该请求时，由于对用户输入过滤不严，导致恶意PHP代码被执行。
5.  **交互式Shell：** 漏洞利用代码在成功利用漏洞后，会提供一个交互式shell，攻击者可以利用该shell在目标服务器上执行任意命令。

**投毒风险：**

该漏洞利用代码主要通过构造包含恶意PHP代码的POST请求进行攻击。代码本身未发现明显的投毒行为，例如在目标系统上植入后门或执行恶意操作。POC的主要功能是验证漏洞的存在并提供交互式shell。
fetch_nonce函数的功能是从目标站点的HTML中提取nonce值。这个nonce值在Bricks Builder插件中用于做安全验证。这个函数本身没有恶意行为，只是为了配合漏洞利用而存在。
create_element函数和create_vulnerable_data函数用于构造payload, 同样，这两个函数本身没有恶意行为。interactive_shell函数提供了一个交互式shell，攻击者可以通过该shell在目标服务器上执行任意命令。但是，这个shell本身是漏洞利用的副产品，而不是投毒行为。exploit函数主要流程。
因此，本代码中不存在明显的投毒行为，投毒风险评估为0%。

**项目地址:** [K3ysTr0K3R/CVE-2024-25600-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2024-25600-EXPLOIT)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)