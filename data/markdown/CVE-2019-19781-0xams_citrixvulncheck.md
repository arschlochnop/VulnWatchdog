## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)