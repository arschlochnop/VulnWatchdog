## CVE-2012-2982 - Webmin file/show.cgi 远程命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <= 1.590

**利用条件:** 需要Webmin服务运行，攻击者需通过Web认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2982 漏洞存在于 Webmin 1.590 及更早版本的 file/show.cgi 文件中。远程已认证的用户可以通过在路径名中使用无效字符（如 | 管道符）来执行任意命令。

**利用方式分析：**

1.  **身份验证绕过（不存在）：** 该漏洞需要首先通过Webmin的身份认证。
2.  **构造恶意请求：** POC代码首先尝试使用硬编码的用户名和密码（user1/1user）登录Webmin。登录成功后，它会获取session id，然后构造包含恶意命令的 URL。URL的`/file/show.cgi`部分是漏洞触发点。管道符`|`用于命令注入。
3.  **命令执行：** 攻击者通过在file/show.cgi的路径中注入管道符 `|`，将系统命令拼接在文件路径后，利用系统执行该命令。
4.  **反弹shell：** POC代码中的payload部分使用 bash 反弹 shell 到攻击者的指定 IP 地址和端口。

**有效性评估：**

根据漏洞信息和提供的POC代码，该漏洞利用是有效的。POC代码直接利用了该漏洞，通过身份验证后，在`/file/show.cgi`路径中注入命令，达到远程命令执行的目的。

**投毒风险评估：**

对提供的 POC 代码进行了分析，未发现明显的投毒代码。POC代码功能明确，即登录 Webmin 并利用命令注入漏洞执行反弹shell。代码结构简单，没有隐藏的恶意行为。但需要注意，任何未经授权的渗透测试都可能被视为非法行为。
随机字符串用于防止缓存，payload 使用 bash 命令反弹 shell。


**项目地址:** [LeDucKhiem/CVE-2012-2982](https://github.com/LeDucKhiem/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)