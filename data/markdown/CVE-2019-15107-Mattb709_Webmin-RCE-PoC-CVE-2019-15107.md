## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要Webmin服务运行，并且可以通过网络访问到/password_change.cgi页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107是Webmin <= 1.920版本中password_change.cgi文件存在的一个命令注入漏洞。攻击者可以通过在`old`参数中构造恶意命令，实现远程代码执行。

**有效性：**
提供的Python POC代码通过向`/password_change.cgi`发送POST请求，并在`expired`参数中注入`id`命令来检测漏洞。如果返回结果包含`uid=`，则认为目标存在漏洞。这个POC代码是有效的，可以用来检测目标是否存在该漏洞。

**投毒风险：**
分析提供的代码，没有发现作者隐藏的恶意代码或后门。该POC代码的功能明确，即发送包含命令注入的HTTP请求，并根据响应判断漏洞是否存在。所有操作都在代码的可见范围内，不存在任何可疑行为。

**利用方式：**
1.  攻击者构造包含恶意命令的HTTP POST请求，目标URL为`/password_change.cgi`。
2.  恶意命令被注入到`old`或`expired`参数中（根据漏洞描述，`expired`参数也能触发漏洞，POC使用`expired`参数）。
3.  Webmin服务器在处理该请求时，会将恶意命令传递给操作系统执行。
4.  攻击者通过分析服务器的响应，获取命令执行的结果，从而实现远程代码执行。

**项目地址:** [Mattb709/Webmin-RCE-PoC-CVE-2019-15107](https://github.com/Mattb709/Webmin-RCE-PoC-CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)