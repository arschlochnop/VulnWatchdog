## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响版本包括：2.45.0, 2.44.0, 2.43.0 < 2.43.4, 2.42.0 < 2.42.2, 2.41.0, 2.40.0 < 2.40.2, < 2.39.4

**利用条件:** 需要目标系统使用受影响的Git版本，并且开启了submodule功能，文件系统区分大小写，允许创建符号链接，受害者clone包含恶意submodule的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 是 Git 中存在的一个远程代码执行漏洞，利用方式主要通过精心构造包含恶意submodule的 Git 仓库。攻击者可以利用此漏洞，通过诱导受害者递归克隆包含恶意配置的仓库，从而在受害者机器上执行恶意代码。

**漏洞利用方式:**

1.  **创建恶意仓库：** 攻击者创建包含恶意submodule配置的Git仓库，该仓库中的submodule指向一个包含恶意hook的仓库。
2.  **恶意Hook：**  攻击者在submodule的仓库中，设置post-checkout hook，该hook会在`git clone --recursive`命令执行时被触发，从而执行攻击者预设的恶意代码。POC代码中，恶意代码为打开计算器应用。
3.  **符号链接操纵：**  利用Git对submodule处理的缺陷，通过创建指向`.git`目录的符号链接，使得恶意hook被放置在`.git/hooks`目录下，从而绕过安全检查。
4.  **诱导克隆：**  攻击者诱导受害者克隆包含恶意submodule的仓库，使用`git clone --recursive`命令。
5.  **触发RCE：**  当受害者执行`git clone --recursive`命令时，恶意hook被触发，执行攻击者预设的恶意代码，实现远程代码执行。

**POC有效性评估:**

根据提供的漏洞信息和利用代码，该POC代码是有效的。它成功演示了如何利用Git submodule的漏洞，通过创建恶意仓库和hook，在受害者机器上执行任意代码。多个搜索结果，例如webpage 6的[Exploiting git RCE: CVE-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)，也验证了该漏洞的可利用性。

**投毒风险分析:**

尽管提供的代码主要用于演示漏洞利用，但仍然存在一定的投毒风险。风险主要来自以下几个方面：

1.  **Payload替换：**  POC中使用打开计算器作为示例payload，攻击者可以轻易地替换成其他更具危害性的恶意代码，例如植入后门、窃取敏感信息等。
2.  **依赖风险：**  POC脚本依赖于特定的git命令和文件系统操作。如果攻击者修改了脚本，添加了额外的依赖或操作，可能会导致受害者系统出现未知问题。
3.  **远程仓库风险：**  虽然POC中指定了特定的远程仓库，但攻击者可能会修改脚本，指向其他包含更隐蔽或更具危害性的恶意代码的仓库。

评估结果为10%,原因在于当前代码中仅仅提供PoC思路,不存在额外恶意操作。

**项目地址:** [ashutosh0408/Cve-2024-32002-poc](https://github.com/ashutosh0408/Cve-2024-32002-poc)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)