## CVE-2023-4220 - Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传/远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者上传webshell并执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标Chamilo LMS实例的`/main/inc/lib/javascript/bigupload/files`目录存在且Web服务器对该目录具有写入权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个严重的安全漏洞，影响版本小于等于 1.11.24。此漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中，允许未经身份验证的攻击者上传任意文件，包括恶意的 webshell。攻击者可以通过简单的 curl 命令上传 php 文件到 `/main/inc/lib/javascript/bigupload/files` 目录。上传后，攻击者可以通过访问该文件执行任意代码。 

**有效性：**  根据提供的POC代码和搜索结果，此漏洞利用是有效的。POC展示了如何使用 curl 命令上传包含恶意代码的 PHP 文件，并通过访问上传的文件来执行代码。搜索结果中也有很多链接提到了利用此漏洞进行远程代码执行的可能性。

**投毒风险：** 查看提供的漏洞利用代码，主要是演示了如何上传和执行一个简单的 `whoami` 命令的webshell。虽然直接的后门代码没有，但是需要考虑到，如果攻击者将此POC集成到自动化攻击脚本中，大规模利用，则会造成严重危害。 仓库中可能存在的投毒风险大约为10%。这个风险来自于以下可能性：
   * 仓库本身可能包含不明显的恶意代码，旨在在使用者部署或运行漏洞利用时执行其他恶意操作。例如，上传的webshell可能包含更复杂的功能，允许攻击者远程控制受害者服务器。 
   * 该漏洞利用可能会被修改以包含后门，然后重新分发。虽然原始POC可能没有恶意代码，但修改后的版本可能会包含。

**利用方式：** 

1.  **确定目标：**  找到运行 Chamilo LMS 1.11.24 或更早版本的系统。
2.  **上传 Webshell：**  使用 curl 或类似的工具，通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php?action=post-unsupported` 发送包含恶意 PHP 代码的文件来上传 webshell。  文件名为webshell文件名，例如`dollarboysushil.php`。
3.  **执行代码：**  通过访问上传的 webshell 文件，例如 `http://<website>/main/inc/lib/javascript/bigupload/files/dollarboysushil.php`，来执行任意代码。 请先确认`/main/inc/lib/javascript/bigupload/files`路径存在。

总而言之，CVE-2023-4220 是一个严重的漏洞，利用简单，影响广泛。应该立即修补受影响的 Chamilo LMS 实例。即使是看起来无害的PoC代码，也需要进行安全审查后使用。

**项目地址:** [dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220](https://github.com/dollarboysushil/Chamilo-LMS-Unauthenticated-File-Upload-CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)