## CVE-2025-27591 - Below Privilege Escalation

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** Below

**危害等级:** 高危，本地权限提升至root

**影响版本:** < 0.9.0

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-27591是一个`below`工具中存在的本地权限提升漏洞，由于其日志机制中存在不安全的符号链接处理。攻击者可以通过预先创建一个指向敏感文件（例如`/etc/passwd`）的符号链接，当漏洞进程在`sudo`下运行时，可以注入任意内容，从而获得提升的权限。

**有效性:** 提供的POC代码有效。它演示了如何利用不安全的日志处理创建符号链接，并将恶意条目附加到`/etc/passwd`中，从而创建一个新的root权限用户。

**投毒风险:** 检查POC代码内容，未发现明显的投毒代码。该代码直接演示了漏洞利用过程，旨在修改`/etc/passwd`文件。虽然修改`/etc/passwd`本身具有破坏性，但这属于漏洞利用的正常行为，而非隐藏的恶意代码。投毒风险评估为0%。

**利用方式:**

1.  检查`/var/log/below/`目录是否存在。
2.  删除现有的日志文件，并创建一个指向`/etc/passwd`的恶意符号链接：`ln -s /etc/passwd /var/log/below/error_root.log`。
3.  准备一个恶意的passwd条目：`echo 'attacker::0:0:attacker:/root:/bin/bash' > /tmp/attacker`。
4.  使用`sudo`触发漏洞行为：`sudo /usr/bin/below record`。这将导致`below`尝试写入日志，由于符号链接的存在，它会将数据写入`/etc/passwd`。
5.  切换到新创建的root权限用户：`su attacker`。

**项目地址:** [krn966/CVE-2025-27591](https://github.com/krn966/CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)