## CVE-2011-0762-vsftpd-DoS

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，导致CPU资源耗尽和进程槽耗尽

**影响版本:** < 2.3.3

**利用条件:** 需要已认证的FTP用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2011-0762 存在于 vsftpd 2.3.3 之前的版本中。`vsf_filename_passes_filter` 函数在 `ls.c` 文件中存在漏洞。经过身份验证的远程用户可以通过在多个 FTP 会话中的 `STAT` 命令中构造恶意的 glob 表达式，从而导致拒绝服务（CPU 消耗和进程槽耗尽）。

**有效性：**

根据漏洞库信息和搜索结果，POC 代码是有效的。多个来源（如 Exploit-DB）都提供了该漏洞的利用代码，并确认其可用于触发 DoS。

**投毒风险：**

提供的 C 代码片段，用于实现 CVE-2011-0762 的 PoC 利用。PoC 代码本身主要是通过发送大量嵌套的 `{}` 结构的 STAT 命令，消耗服务器资源导致拒绝服务，没有发现包含恶意后门或植入其他恶意功能的代码。代码功能较为简单，主要集中在建立 FTP 连接、身份验证和发送恶意的 STAT 命令上。综上所述，该仓库的投毒风险较低。

**利用方式：**

1.  **建立连接：**  攻击者首先需要通过 FTP 客户端与目标 vsftpd 服务器建立连接。
2.  **身份验证：**  攻击者需要使用有效的用户名和密码进行身份验证。
3.  **发送恶意 STAT 命令：**  身份验证成功后，攻击者会发送一个包含大量嵌套 glob 表达式的 `STAT` 命令。例如：`STAT {{*},{{*},...{*}}}`。这种嵌套结构会导致 `vsf_filename_passes_filter` 函数进行大量的递归调用和计算，从而消耗服务器的 CPU 资源。
4.  **资源耗尽：**  通过重复发送上述恶意 STAT 命令，攻击者可以耗尽服务器的 CPU 资源，最终导致拒绝服务。由于进程槽耗尽，服务器可能无法接受新的连接，从而影响正常用户的 FTP 服务。

**项目地址:** [Andreyfrtz/CVE-2011-0762](https://github.com/Andreyfrtz/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)