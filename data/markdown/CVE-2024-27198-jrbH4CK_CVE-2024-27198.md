## CVE-2024-27198 - JetBrains TeamCity Authentication Bypass

**漏洞编号:** CVE-2024-27198

**漏洞类型:** 身份验证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许攻击者执行管理员操作，包括远程代码执行

**影响版本:** < 2023.11.4

**利用条件:** TeamCity服务器需要运行在受影响的版本且网络可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-27198 是 JetBrains TeamCity 中存在的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的请求，绕过身份验证并获得管理员权限，从而完全控制 TeamCity 服务器。 

**有效性分析：**

根据漏洞库信息和 Rapid7 的分析（README.md中引用），该漏洞允许未经授权的攻击者执行管理员操作。提供的PoC代码（cve-2024-27198.py）利用此漏洞创建一个具有系统管理员权限的新用户。

**利用方式：**

1.  攻击者发送特制的 HTTP 请求到 TeamCity 服务器的 `/hax?jsp=/app/rest/users;XXX.jsp` 端点，绕过身份验证。
2.  利用该端点，攻击者可以通过 POST 请求创建一个新的管理员用户，并在请求体中指定用户名、密码和角色。
3.  成功创建管理员用户后，攻击者可以使用新创建的凭据登录 TeamCity 并完全控制服务器。

**投毒风险分析：**

分析了提供的文件，主要风险点如下：

*   **cve-2024-27198.py：** 此文件包含漏洞利用代码，用于在目标 TeamCity 服务器上创建管理员用户。 代码本身似乎没有直接包含恶意投毒代码，但创建的管理员账户本身即为后门。因此，不能判定为投毒。
*   **README.md：**  此文件包含漏洞描述、利用方法和参考链接，没有发现任何恶意代码。
*   **img/test:** 此文件为空，也没有风险。

虽然没有明显的投毒代码，但是需要注意以下几点潜在的风险：

1.  **依赖库风险：** PoC代码使用 `requests` 和 `json` 库。如果攻击者控制了这些库的源（虽然可能性较低），则可能引入恶意代码。 但根据目前提供的信息，无法判定存在这种风险。
2.  **后门风险：** PoC代码创建的管理员帐户本身就是一个后门，如果该代码被恶意传播，可能被用于未经授权的访问。

综合考虑，此仓库中存在作者隐藏的投毒代码的可能性较低，约为 5%。主要风险在于漏洞利用本身带来的安全风险。

**项目地址:** [jrbH4CK/CVE-2024-27198](https://github.com/jrbH4CK/CVE-2024-27198)

**漏洞详情:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)