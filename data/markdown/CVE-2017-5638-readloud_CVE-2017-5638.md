## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)