## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0 and < 2.44.4, >= 2.45.0-rc0 and < 2.45.4, >= 2.46.0-rc0 and < 2.46.4, >= 2.47.0-rc0 and < 2.47.3, >= 2.48.0-rc0 and < 2.48.2, >= 2.49.0-rc0 and < 2.49.1, >= 2.50.0-rc0 and < 2.50.1

**利用条件:** 需要用户执行恶意Git操作（例如，克隆包含恶意配置的仓库或初始化包含恶意配置的子模块）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384是Git中的一个漏洞，允许通过畸形的配置引用执行任意代码。漏洞的根本原因是Git在处理配置文件中的换行符时存在缺陷。具体来说，当Git写入配置条目时，如果值包含尾部的回车符（CR），则不会被正确引用。当后续读取配置时，尾部的CR会被删除，导致配置路径发生变化。

**利用方式：**

1.  攻击者创建一个包含恶意的`.gitmodules`文件的仓库。在这个文件中，子模块的路径包含一个尾部的回车符。
2.  攻击者设置一个符号链接，将经过修改的（尾部回车符被删除）子模块路径指向`.git/hooks`目录。
3.  攻击者在子模块中放置一个可执行的`post-checkout`钩子。
4.  受害者克隆该仓库并初始化子模块。
5.  当子模块初始化时，由于路径的更改以及符号链接的存在，`post-checkout`钩子会被执行，从而导致任意代码执行。

**POC有效性：**

提供的POC代码是一个`post-checkout`钩子脚本，它会尝试通过`curl`命令从`https://jarvis.webhop.me/pwned`下载并执行内容。这个脚本本身就是漏洞利用的一部分，当上述步骤成功执行时，该脚本将被执行，从而实现远程代码执行。

**投毒风险：**

提供的POC代码本身旨在利用该漏洞，因此不应将其视为潜在的投毒代码。然而，攻击者可以利用此漏洞传播恶意软件或执行其他恶意活动。此处的0%表示该代码片段本身没有隐藏其他恶意逻辑，它仅仅是利用该漏洞实现代码执行的载体。


**项目地址:** [mukesh-610/cve-2025-48384-exploit](https://github.com/mukesh-610/cve-2025-48384-exploit)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)