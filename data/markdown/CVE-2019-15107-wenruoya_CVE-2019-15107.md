## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要网络访问和Webmin服务运行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Webmin <= 1.920的password_change.cgi文件中。参数 'old' 存在命令注入漏洞。攻击者可以通过构造恶意的 'old' 参数，执行任意系统命令。根据提供的漏洞利用代码，该POC利用了perl中`qx/…/` 导致命令执行。需要注意的是，该POC只有在使用一个**假的用户**作为user值才能成功触发，使用真实的root测试不成功。只有在发送的用户参数的值不是已知的Linux用户的情况下，展示进入才会到修改/etc/shadow的地方，从而触发命令注入漏洞。因此反弹shell可能需要编码，这可能需要修改代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码中，虽然主要功能是利用该漏洞，但是存在一定的投毒风险。例如，作者在 `README.md` 中提到“反弹shell可能需要编码，这可能需要修改代码”，攻击者可能会在修改反弹shell代码时，添加恶意代码。此外，GUI界面也可能被用于混淆或隐藏恶意行为。该漏洞本身利用条件比较苛刻，需要假用户才能触发，攻击者可能会利用这一点来隐藏自己的攻击行为。因此，判定存在一定比例的投毒风险，这里判断投毒风险为10%。

**利用方式：**
1.  确定目标Webmin版本小于等于1.920。
2.  构造包含恶意命令的 'old' 参数的HTTP POST请求，发送到/password_change.cgi。
3.  确保POST请求中使用的username参数是一个不存在的Linux用户。
4.  服务器执行'old'参数中的命令。
5.  攻击者可以利用此漏洞执行任意系统命令，例如反弹shell。

**项目地址:** [wenruoya/CVE-2019-15107](https://github.com/wenruoya/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)