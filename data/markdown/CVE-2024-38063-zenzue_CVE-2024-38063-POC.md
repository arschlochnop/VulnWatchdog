## CVE-2024-38063-Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括Windows 10, Windows 11, Windows Server 2008-2022等，具体版本范围参考漏洞库信息。

**利用条件:** 需要目标系统启用IPv6且存在于网络中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38063 是 Windows TCP/IP 协议栈中的一个远程代码执行漏洞。攻击者可以通过发送特制的 IPv6 数据包来触发此漏洞，进而在目标系统上执行任意代码。根据漏洞信息和搜索结果，此漏洞的 CVSS 评分为 9.8，属于危急级别。

**有效性评估：**
根据搜索结果和漏洞利用代码，POC 代码利用 Scapy 库构造恶意 IPv6 数据包，旨在触发 Windows 内核 IPv6 解析器中的漏洞。多个来源表明存在可利用此漏洞的 POC。因此，提供的 POC 代码很可能有效。

**投毒风险评估：**
对提供的 Python 脚本 `cve-2024-38063.py` 进行了分析。代码主要功能是构造并发送恶意的 IPv6 数据包。脚本使用 Scapy 库，根据用户提供的目标 IP 地址、MAC 地址（可选）和网络接口来发送数据包。数据包的结构包含 IPv6 扩展头，特别是 Destination Option 和 Fragment 扩展头，这与漏洞描述中利用 IPv6 扩展头进行攻击的方式相符。仔细检查代码后，未发现任何明显的后门或恶意代码。脚本行为与其描述的功能一致。因此，投毒风险评估为 0%。

**利用方式分析：**
1.  **漏洞触发：** 攻击者发送特制的 IPv6 数据包到目标系统。这些数据包包含特定的 IPv6 扩展头（Destination Option 和 Fragment）。
2.  **整数下溢 (Integer Underflow)：** 漏洞描述中提到了 CWE-191 (整数下溢)。恶意的数据包可能导致 TCP/IP 协议栈在处理这些扩展头时发生整数下溢，从而破坏内存。
3.  **远程代码执行：** 通过精心构造的数据包，攻击者可以覆盖或控制内存中的关键数据，最终实现远程代码执行。根据 MalwareTech 的分析，漏洞存在于 Windows Kernel IPv6 Parser。
4.  **利用代码说明：**  提供的 Python 脚本使用 Scapy 库创建包含恶意 IPv6 头的包。这些包会被发送到目标机器，以触发漏洞。
5.  **缓解措施：** 缓解措施包括应用 Microsoft 提供的补丁、禁用 IPv6（如果不需要）、以及使用网络分段来限制攻击范围。

**项目地址:** [zenzue/CVE-2024-38063-POC](https://github.com/zenzue/CVE-2024-38063-POC)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)