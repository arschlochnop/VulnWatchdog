## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，漏洞存在于未授权的端点。

**POC 可用性:** 是，但提供的代码并非直接的exploit，而是缓解措施

**投毒风险:** 10%

## 详情

CVE-2025-22457是一个Ivanti Connect Secure, Policy Secure, ZTA Gateways中的栈缓冲区溢出漏洞。未经验证的远程攻击者可以利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2025-22457 漏洞是真实存在的，并且已经被积极利用。提供的代码 `ivantiunlocker` 并非漏洞利用代码，而是一种缓解措施，通过在 Ivanti 设备前设置一个简单的 web 认证网关，限制对 Ivanti 设备的访问。原始漏洞利用是通过发送构造的HTTP请求，利用栈缓冲区溢出执行代码。

**投毒风险：**

`unlock_web.py` 本身的功能是做一个简易的web认证，增加了一层访问控制。但是，`PASSWORD = "yoursuperduperpassword"`  默认密码过于简单，如果使用者不修改，存在被绕过的风险。而且，该脚本将日志记录到 `/var/log/ivantiunlocker.log`，可能导致信息泄露，比如IP地址等。此外，如果web服务器本身存在漏洞，则会引入新的安全风险。

总体来说，投毒风险较低，主要是配置不当或web服务器安全问题引起的风险。由于代码较为简单，可以直接审查，存在恶意后门的概率较低。该代码的主要目的是防御，而非攻击。

**利用方式：**

该漏洞的原始利用方式是向存在漏洞的 Ivanti 设备发送特制的 HTTP 请求，其中包含过长的 `X-Forwarded-For` 头部或其他参数，导致栈缓冲区溢出，覆盖返回地址，从而执行攻击者控制的代码。攻击者可以利用它来获得设备上的远程代码执行权限，进而控制整个网络。

**缓解措施：**
1.  及时更新 Ivanti Connect Secure, Policy Secure, ZTA Gateways 到不受影响的版本。
2.  使用防火墙或其他网络安全设备限制对 Ivanti 设备的访问。
3.  审查并加固 Ivanti 设备的配置。
4.  使用提供的 `ivantiunlocker` 脚本作为临时缓解方案，但需要修改默认密码并注意 web 服务器的安全。

**项目地址:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)