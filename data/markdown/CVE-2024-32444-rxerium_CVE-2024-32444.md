## CVE-2024-32444 - WordPress RealHomes Theme Privilege Escalation

**漏洞编号:** CVE-2024-32444

**漏洞类型:** 权限提升

**影响应用:** WordPress RealHomes Theme

**危害等级:** 高危，攻击者可获得管理员权限，控制网站

**影响版本:** <= 4.3.6

**利用条件:** 需要目标网站启用用户注册功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32444 是 WordPress RealHomes 主题 <= 4.3.6 版本的权限提升漏洞。该漏洞允许未经身份验证的攻击者通过`inspiry_ajax_register`函数注册新用户时，绕过身份验证和权限检查，直接将新用户的角色设置为“Administrator”。利用方式如下：

1.  **漏洞描述：** RealHomes主题允许用户通过`inspiry_ajax_register`函数注册新账号，但未进行充分的授权检查或nonce验证。
2.  **漏洞利用：** 如果网站启用了注册功能，攻击者可以通过构造特定的HTTP请求，在注册时将角色设置为“Administrator”，从而获得管理员权限。
3.  **利用后果：** 获得管理员权限后，攻击者可以完全控制WordPress网站，包括修改内容、注入恶意脚本、访问敏感数据等。
4. **POC有效性：** 提供的Nuclei模板并非直接利用漏洞进行权限提升，而是用于检测目标站点是否存在 RealHomes 主题。真正的漏洞利用需要构造特定的 HTTP 请求到 `inspiry_ajax_register` 函数，在请求中指定新用户的角色为 `Administrator`。因此，需要额外编写利用脚本才能真正利用此漏洞。
5.  **投毒风险分析：** 提供的代码包括LICENSE、README.md 和 Nuclei 模板 (template.yaml)。LICENSE 和 README.md 文件没有投毒风险。template.yaml 文件用于检测 RealHomes 主题的存在，本身不包含恶意代码。然而，README.md 文件提及可以通过构造特定的 HTTP 请求提升权限，攻击者可能基于此进行攻击。因此，虽然提供的代码本身没有明显的投毒行为，但其中包含的信息可能被滥用，存在潜在风险。 投毒风险较低，估计为10%。因为主要的风险在于利用漏洞本身，而不是POC代码中包含恶意代码。

**项目地址:** [rxerium/CVE-2024-32444](https://github.com/rxerium/CVE-2024-32444)

**漏洞详情:** [CVE-2024-32444](https://nvd.nist.gov/vuln/detail/CVE-2024-32444)