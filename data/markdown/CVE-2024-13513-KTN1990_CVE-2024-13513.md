## CVE-2024-13513 - Oliver POS 敏感信息泄露导致权限提升

**漏洞编号:** CVE-2024-13513

**漏洞类型:** 敏感信息泄露 / 权限提升

**影响应用:** Oliver POS – A WooCommerce Point of Sale (POS) WordPress 插件

**危害等级:** 高危，可能导致站点完全控制

**影响版本:** <= 2.4.2.3

**利用条件:** 目标站点安装了受影响版本的 Oliver POS 插件，且存在可访问的日志文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-13513 漏洞存在于 Oliver POS WordPress 插件中，允许未经身份验证的攻击者通过访问插件生成的日志文件来获取敏感信息，包括 `clientToken`。该 `clientToken` 可被用于修改用户账户信息，如邮箱和账户类型，最终导致账户密码重置并完全控制站点。

**漏洞利用方式：**

1.  **日志文件发现：** 攻击者通过 `wp-content/plugins/oliver-pos/log/` 路径枚举并访问日志文件。
2.  **`clientToken` 提取：** 在日志文件中搜索 `clientToken`。
3.  **账户信息修改：** 使用获得的 `clientToken` 修改用户账户信息。
4.  **密码重置：** 通过修改后的邮箱重置管理员密码，从而完全控制站点。

**有效性：**

根据漏洞描述和提供的漏洞利用代码，POC 利用代码有效。

**投毒风险分析：**

代码中存在通过Telegram联系作者的内容，以及推广Megatron工具，虽然这本身不算恶意代码，但可能引导用户安装或使用其他包含恶意代码的工具。`exploit.py` 功能较为完整，实现了漏洞利用的整个流程。`oliver.py` 包含了查找并提取token的关键逻辑，可以发现log地址并进行token提取。许可证文件为MIT许可。README.md 也详细描述了漏洞信息及POC的用法。

综合来看，投毒的风险较低，主要体现在推广其他工具上，因此评估投毒风险为10%。

**项目地址:** [KTN1990/CVE-2024-13513](https://github.com/KTN1990/CVE-2024-13513)

**漏洞详情:** [CVE-2024-13513](https://nvd.nist.gov/vuln/detail/CVE-2024-13513)