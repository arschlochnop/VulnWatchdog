## CVE-2020-14882 - Oracle WebLogic Server 远程代码执行

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，允许未授权的攻击者完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问 WebLogic Server 的 Administration Console，无需认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-14882 是 Oracle WebLogic Server Administration Console 中的一个未授权远程代码执行漏洞。攻击者可以通过发送特制的 HTTP 请求，利用双重 URL 编码绕过身份验证，访问内部服务器功能，从而执行任意代码，完全控制 WebLogic 服务器。

**有效性：**
提供的 POC 代码有效。它展示了如何利用双重 URL 编码的目录遍历来访问 `console.portal`，并使用 `com.tangosol.coherence.mvel2.sh.ShellSession` 执行任意命令。请求示例清晰地展示了攻击向量。

**投毒风险：**
代码本身主要关注漏洞利用，没有明显的恶意或隐藏的后门代码。`README.md` 文件的目的是解释漏洞和提供利用方法，文件中的图片是为了演示效果。投毒风险较低，大约为10%。如果作者有意投毒，可能会在命令执行的payload中加入恶意行为。

**利用方式：**
1.  攻击者构造包含双重 URL 编码目录遍历序列的 HTTP POST 请求，例如 `/console/images/%252E%252E%252Fconsole.portal`。
2.  该请求发送到目标 WebLogic Server 的 Administration Console。
3.  双重 URL 编码绕过身份验证，允许访问受保护的资源。
4.  在请求体中，`handle` 参数包含一个 MVEL 表达式，该表达式使用 `java.lang.Runtime.getRuntime().exec()` 执行任意系统命令。示例中使用的是 `ipconfig`，但可以替换为任何其他命令。
5.  服务器执行该命令，攻击者可以获得服务器的控制权。

**项目地址:** [AshrafZaryouh/CVE-2020-14882](https://github.com/AshrafZaryouh/CVE-2020-14882)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)