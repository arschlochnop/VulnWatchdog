## CVE-2016-15042 - WordPress Frontend File Manager & N-Media Post Front-end Form Unauthenticated File Upload

**漏洞编号:** CVE-2016-15042

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Frontend File Manager & N-Media Post Front-end Form插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Frontend File Manager < 4.0, N-Media Post Front-end Form < 1.1

**利用条件:** 目标WordPress站点安装了受影响版本的插件，且攻击者无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress的Frontend File Manager和N-Media Post Front-end Form插件中，由于缺少文件类型验证，攻击者可以上传任意文件，包括恶意PHP脚本，从而实现远程代码执行。

**有效性：**

提供的PoC代码是一个Dockerized的实验环境，可以一键部署包含漏洞的WordPress站点以及相应版本的插件。PoC中还提供了使用Nuclei进行漏洞验证的方法，通过发送特定的HTTP请求，可以上传任意文件到服务器。因此，PoC代码可以有效验证该漏洞的存在。

**投毒风险：**

分析了提供的docker-compose.yml 和 setup.sh 脚本，发现该代码的主要目的是为了快速搭建一个存在漏洞的WordPress环境，以便于漏洞验证和演示。虽然脚本会自动下载并安装存在漏洞的插件，以及配置WordPress相关参数，但并未发现明显的恶意代码或后门。但是，需要注意以下几点：

1.  **依赖外部资源：** 脚本依赖于外部的WordPress镜像和插件的下载地址。如果这些资源被篡改，可能会引入恶意代码。
2.  **权限问题：** Docker容器的权限配置不当可能会导致安全问题。
3.  **自动化执行：** 自动化执行脚本可能会隐藏一些潜在的风险。例如，如果脚本中包含未知的命令或操作，可能会对系统造成损害。

综合来看，该PoC代码存在一定的投毒风险，主要是由于其依赖的外部资源可能被篡改，以及自动化执行脚本可能隐藏潜在风险。因此，在运行该PoC代码时，需要仔细检查脚本的内容，并确保下载的资源来源可靠。考虑到这些潜在风险，评估投毒风险为10%。这个数值是在考虑了脚本的整体行为和潜在风险之后给出的一个主观估计。

**利用方式：**

1.  **确定目标站点是否安装了受影响版本的插件。**
2.  **构造恶意的HTTP请求，绕过文件类型验证。** 具体来说，就是利用`nm_filemanager_upload_file`和`nm_postfront_upload_file`这两个AJAX actions进行文件上传。
3.  **上传包含恶意代码的PHP脚本。**
4.  **通过访问上传的PHP脚本，执行恶意代码，从而控制服务器。**

根据搜索引擎结果，多个链接都提到了该漏洞可以导致任意文件上传，进而导致远程代码执行。这与漏洞库信息和PoC代码的描述相符。

**项目地址:** [ImBIOS/lab-cve-2016-15042](https://github.com/ImBIOS/lab-cve-2016-15042)

**漏洞详情:** [CVE-2016-15042](https://nvd.nist.gov/vuln/detail/CVE-2016-15042)