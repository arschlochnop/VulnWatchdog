## CVE-2022-36804-Bitbucket-命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server 和 Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <7.6.17, <7.17.10, <7.21.4, <8.0.3, <8.1.3, <8.2.2, <8.3.1

**利用条件:** 需要对公开或私有Bitbucket仓库具有读取权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-36804是Atlassian Bitbucket Server和Data Center中的一个命令注入漏洞。攻击者利用具有读取权限的账号，向存在漏洞的API端点发送恶意HTTP请求，通过`git archive`命令的`--exec`参数注入恶意代码，最终实现远程命令执行。利用方式包括发送特制的URL，其中包含经过URL编码的命令。例如`url+'/rest/api/latest/projects/'+project_key+'/repos/'+repo_name+'/archive?filename=kiE0h&at=refs%2`，此POC代码的目的是验证漏洞存在以及执行命令，未发现明显的投毒代码。

**项目地址:** [imbas007/Atlassian-Bitbucket-CVE-2022-36804](https://github.com/imbas007/Atlassian-Bitbucket-CVE-2022-36804)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)