## CVE-2021-4034 Polkit pkexec 本地提权漏洞

**漏洞编号:** CVE-2021-4034

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，允许低权限用户提升到root权限

**影响版本:** all (受影响版本)

**利用条件:** 本地用户访问，pkexec程序存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-4034是Polkit的pkexec实用程序中的一个本地权限提升漏洞。pkexec是一个setuid工具，允许非特权用户根据预定义的策略以特权用户身份运行命令。此漏洞源于pkexec未正确处理调用参数计数，导致其尝试将环境变量作为命令执行。攻击者可以通过精心设计的环境变量诱使pkexec执行任意代码，从而导致本地权限提升，使非特权用户获得目标机器上的管理员权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞真实存在且影响广泛，多个Linux发行版都受影响。公开的漏洞利用代码表明该漏洞可以被成功利用。

**投毒风险：** 提供的POC代码 `README.md` 文件内容过于简单，仅包含CVE编号，无法直接用于漏洞利用。因此，无法基于此文件本身来评估投毒风险。一般漏洞利用代码会包含恶意的后门代码，执行后可以获得机器的控制权。但此`README.md`文件仅仅是指示该漏洞。考虑到从其他来源获取漏洞利用代码的可能性，存在下载的代码中被植入恶意代码的风险。因此，评估投毒风险为10%考虑到readme文件的特殊性，风险较低。

**利用方式：** 漏洞利用方式通常涉及构造特定的环境变量，这些变量会被pkexec错误地解析并执行。攻击者可以利用此行为执行任意命令，通常用于提升到root权限。例如，攻击者可以创建一个环境变量，指向一个包含shell命令的文件，然后运行pkexec，使其执行该文件中的命令。

**项目地址:** [lsclsclsc/CVE-2021-4034](https://github.com/lsclsclsc/CVE-2021-4034)

**漏洞详情:** [CVE-2021-4034](https://nvd.nist.gov/vuln/detail/CVE-2021-4034)