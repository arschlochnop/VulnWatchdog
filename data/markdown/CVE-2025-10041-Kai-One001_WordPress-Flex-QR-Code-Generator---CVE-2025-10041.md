## CVE-2025-10041：Flex QR Code Generator 插件任意文件上传漏洞

**漏洞编号:** CVE-2025-10041

**漏洞类型:** 任意文件上传

**影响应用:** Flex QR Code Generator

**危害等级:** 高危，允许未授权用户上传恶意文件并可能导致远程代码执行

**影响版本:** <= 1.2.5

**利用条件:** 无需身份验证，需要目标 WordPress 站点安装并启用了受影响的 Flex QR Code Generator 插件，且允许上传目录可访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

漏洞利用的有效性分析：

根据漏洞库信息，Flex QR Code Generator 插件存在一个未授权的任意文件上传漏洞（CVE-2025-10041）。该漏洞存在于 `save_qr_code_to_db()` 函数中，由于缺少对上传文件类型的验证，攻击者可以上传任意文件，包括恶意的 PHP 文件，从而可能导致远程代码执行。

提供的漏洞利用代码（POC）展示了两种利用方式：

1.  **信息泄露+更新钩子实现RCE**：首先通过 `flexqr_fetch_qr_code` 获取现有的QR Code的ID以及对应的logo路径，然后通过 `flexqr_update_qr` 接口上传 webshell，最终通过访问上传的webshell触发RCE
2.  **未授权文件上传+实现RCE**： 直接调用 `flexqr_save_qr` 接口上传包含恶意代码的 PHP 文件，然后通过访问上传的文件执行命令。

两种方式都验证了漏洞的可利用性，未经身份验证的攻击者可以利用这些方法在目标服务器上执行任意代码。

投毒风险分析：

检查提供的 POC 代码，没有明显的恶意代码或后门。主要操作是上传webshell，目的是为了验证漏洞的存在和执行任意命令。`AiErBuDe`仅为webshell中的内容,不属于投毒代码。因此，投毒风险较低，大约为 1%。

漏洞利用方式总结：

1.  **利用 `flexqr_save_qr` 接口:**
    *   构造一个包含 `action=flexqr_save_qr` 的 POST 请求，并设置 `Content-Type` 为 `multipart/form-data`。
    *   在请求中包含一个名为 `logo` 的文件上传字段，文件名为恶意的 PHP 文件（例如 `webshell.php`），文件内容为 PHP 代码（例如 `<?php system($_GET['cmd']); ?>`）。
    *   通过 `qrData` 字段设置 QR 码的相关数据。
    *   发送请求到 `/wp-admin/admin-ajax.php`。
    *   如果上传成功，访问上传的文件（例如 `/wp-content/uploads/2025/10/webshell_10.php?cmd=id`）来执行命令。
2.  **利用 `flexqr_update_qr` 接口:**
    *   首先利用`flexqr_fetch_qr_code` 获取现有的QR Code的ID以及对应的logo路径
    *   构造一个包含 `action=flexqr_update_qr` 的 POST 请求，并设置 `Content-Type` 为 `multipart/form-data`。
    *   在请求中包含一个名为 `logo` 的文件上传字段，文件名为恶意的 PHP 文件（例如 `webshell.php`），文件内容为 PHP 代码（例如 `<?php system($_GET['cmd']); ?>`）。
    *   发送请求到 `/wp-admin/admin-ajax.php`。
    *   如果上传成功，访问上传的文件（例如 `/wp-content/uploads/2025/10/webshell_9.php?cmd=id`）来执行命令。

此漏洞是一个严重的安全问题，应尽快修复。建议更新插件到最新版本。

**项目地址:** [Kai-One001/WordPress-Flex-QR-Code-Generator---CVE-2025-10041](https://github.com/Kai-One001/WordPress-Flex-QR-Code-Generator---CVE-2025-10041)

**漏洞详情:** [CVE-2025-10041](https://nvd.nist.gov/vuln/detail/CVE-2025-10041)