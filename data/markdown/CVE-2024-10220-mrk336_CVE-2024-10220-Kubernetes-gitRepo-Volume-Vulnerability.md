## CVE-2024-10220-Kubernetes-gitRepo-Volume-任意命令执行

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** Kubernetes Kubelet

**危害等级:** 高危，允许低权限用户在主机节点上执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 攻击者需要能够创建Pod并指定gitRepo卷。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞允许攻击者通过特制的 gitRepo 卷在 Kubernetes kubelet 组件上执行任意命令。漏洞利用涉及创建一个包含恶意 .hooks 目录的 Git 仓库，当 kubelet 尝试拉取该仓库时，.hooks 目录中的恶意脚本会在主机节点上以 root 权限执行。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。漏洞描述明确指出通过 gitRepo 卷可以执行任意命令。搜索引擎结果中的多个链接证实了该漏洞的存在和高危性。提供的 Python POC 代码模拟了利用该漏洞的过程，通过向 kubelet 发送包含恶意 gitRepo 卷配置的 Pod 清单来实现。

**投毒风险：**
提供的代码主要包含 MIT 许可证、README.md 文件和一个 Python 脚本。该 Python 脚本旨在触发 CVE-2024-10220 漏洞，通过向 kubelet 发送精心构造的 Pod 清单，从而执行 Git 仓库中的恶意钩子脚本。检查了提供的 LICENSE、README.md 和 Python 脚本，未发现任何可疑的后门或恶意代码。代码的功能明确，旨在利用 CVE-2024-10220 漏洞。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者需要具有在受影响的 Kubernetes 集群中创建 Pod 的权限。
2.  攻击者创建一个包含恶意 Git 仓库，该仓库的 `.git/hooks` 目录包含要执行的恶意脚本。
3.  攻击者创建一个 Pod 清单，其中指定使用 `gitRepo` 卷，并指向恶意 Git 仓库。
4.  攻击者将 Pod 清单提交到 Kubernetes 集群。
5.  Kubelet 尝试拉取 Git 仓库时，会执行 `.git/hooks` 目录中的恶意脚本，从而在主机节点上执行任意命令。

**项目地址:** [mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability](https://github.com/mrk336/CVE-2024-10220-Kubernetes-gitRepo-Volume-Vulnerability)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)