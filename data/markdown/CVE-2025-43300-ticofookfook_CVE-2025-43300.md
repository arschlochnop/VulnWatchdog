## CVE-2025-43300-macOS/iOS-图像处理内存破坏

**漏洞编号:** CVE-2025-43300

**漏洞类型:** 内存破坏 (Out-of-bounds Write)

**影响应用:** macOS, iOS, iPadOS (ImageIO)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < macOS Sonoma 14.7.8, macOS Ventura 13.7.8, iPadOS 17.7.10, macOS Sequoia 15.6.1, iOS 18.6.2 and iPadOS 18.6.2

**利用条件:** 处理恶意构造的DNG图像文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-43300 是一个存在于 Apple ImageIO 框架中的 out-of-bounds write 漏洞。该漏洞源于 DNG 图像文件中 TIFF 元数据和 JPEG 数据之间的不一致性。具体来说，TIFF 头的 `SamplesPerPixel` 标记声明的颜色分量数量与 JPEG 数据 (SOF0 帧头) 中实际的颜色分量数量不匹配。如果 JPEG 数据中声明的分量数大于 TIFF 头中声明的分量数，则 ImageIO 框架在处理图像时会发生缓冲区溢出，从而导致内存损坏。 根据搜索结果和漏洞利用代码分析： 

*   **有效性：** 提供的PoC代码是有效的。`create-dng_poc_exec.js` 脚本创建了一个恶意 DNG 文件，其中 TIFF 头的 `SamplesPerPixel` 设置为 2，而嵌入的 JPEG 数据的分量数量设置为 3。当易受攻击的 ImageIO 框架处理此文件时，将发生缓冲区溢出。 
*   **利用方式：** 攻击者通过诱使用户打开恶意 DNG 图像文件来利用此漏洞。图像文件可以通过多种方式传播，例如通过电子邮件、网页或消息传递应用程序。成功利用此漏洞可能允许攻击者执行任意代码。在提供的漏洞利用代码中，通过`create-dng_poc_exec.js`脚本,创建了存在TIFF和JPEG分量差异的DNG文件,以此触发漏洞。
*   **投毒风险：** 投毒风险较低(5%)。 脚本的功能是创建PoC，主要关注漏洞触发，恶意行为几乎没有。脚本依赖于Node.js环境，也没有包含连接外部服务器或者执行其他恶意操作的部分. 风险主要集中在滥用此PoC进行攻击，而不是代码本身被恶意篡改。

**项目地址:** [ticofookfook/CVE-2025-43300](https://github.com/ticofookfook/CVE-2025-43300)

**漏洞详情:** [CVE-2025-43300](https://nvd.nist.gov/vuln/detail/CVE-2025-43300)