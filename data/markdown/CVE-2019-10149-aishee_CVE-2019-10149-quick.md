## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)