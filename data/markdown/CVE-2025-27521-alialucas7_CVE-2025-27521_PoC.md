## CVE-2025-27521-HarmonyOS-权限提升

**漏洞编号:** CVE-2025-27521

**漏洞类型:** 权限提升

**影响应用:** HarmonyOS

**危害等级:** 中危，可能影响服务机密性

**影响版本:** 5.0.0

**利用条件:** 需要本地访问，`/var/log/below` 目录存在且世界可写, `/usr/bin/below` 二进制文件存在.

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-27521是HarmonyOS 5.0.0中进程管理模块的一个不当访问权限漏洞。攻击者可以利用该漏洞，通过以下步骤提升权限：

1.  **检查漏洞存在性：** 检查`/var/log/below`目录是否存在且是否世界可写。检查`/var/log/below/error_root.log`是否存在，如果存在则移除。
2.  **创建符号链接：** 创建从`/var/log/below/error_root.log`到`/etc/passwd`的符号链接。
3.  **写入恶意用户：** 执行`sudo below record`命令（假设存在且允许sudo），该命令会将日志写入到`/var/log/below/error_root.log`，由于该文件是指向`/etc/passwd`的符号链接，因此会将日志写入`/etc/passwd`，从而添加恶意用户。
4.  **切换用户：** 通过`su attacker`切换到新添加的attacker用户，获取root权限。

**有效性：** 提供的PoC代码在满足前提条件的情况下，应该是有效的。它利用了日志文件可写和符号链接的特性，通过`below record`命令间接修改了`/etc/passwd`文件，从而添加新的用户。

**投毒风险：** 该PoC代码存在极低的投毒风险。 虽然PoC添加了用户到/etc/passwd，但这是漏洞利用的必要步骤，不能判定为作者隐藏的恶意投毒代码。

**利用方式：** 该漏洞利用方式是利用了world-writable日志目录和`below`工具的日志记录功能，以及符号链接，将恶意用户添加到`/etc/passwd`中，从而达到权限提升的目的。

**项目地址:** [alialucas7/CVE-2025-27521_PoC](https://github.com/alialucas7/CVE-2025-27521_PoC)

**漏洞详情:** [CVE-2025-27521](https://nvd.nist.gov/vuln/detail/CVE-2025-27521)