## CVE-2024-13513 - Oliver POS 敏感信息泄露导致权限提升

**漏洞编号:** CVE-2024-13513

**漏洞类型:** 敏感信息泄露导致权限提升

**影响应用:** Oliver POS – A WooCommerce Point of Sale (POS) WordPress插件

**危害等级:** 高危，可能导致敏感信息泄露和站点完全控制

**影响版本:** <= 2.4.2.3

**利用条件:** 目标站点安装了受影响版本的Oliver POS插件，且日志功能未被禁用，存在可访问的日志文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Oliver POS WordPress插件中，版本小于等于2.4.2.3。未经身份验证的攻击者可以通过访问插件的日志文件来提取敏感数据，包括clientToken。该clientToken可以用于修改用户账户信息，包括电子邮件和账户类型。攻击者可以更改帐户密码，从而完全控制网站。

**利用方式：**

1.  **信息泄露：** 攻击者直接访问`wp-content/plugins/oliver-pos/log/`目录，寻找包含`clientToken`的日志文件。
2.  **权限提升：** 获取`clientToken`后，攻击者使用该token在请求头中，通过`pos-bridge/update-user/`接口修改用户邮箱，然后通过重置密码流程完全接管账户。

**POC代码分析：**

POC代码首先尝试从目标URL的`wp-content/plugins/oliver-pos/log/`目录中提取日志文件列表，然后从这些日志文件中提取`clientToken`。提取到token后，它会构造一个POST请求到`wp-json/pos-bridge/update-user/`端点，尝试使用提取的token来更新用户的电子邮件地址。如果更新成功，则认为该漏洞可利用。

**投毒风险分析：**

POC代码本身看起来比较直接，主要功能是利用漏洞，没有明显的恶意行为。但是，任何代码都可能存在隐藏的风险。例如，`save_result`函数理论上可以被修改，写入恶意内容，或者在提取`clientToken`后，在未授权的情况下直接创建管理员账户。由于`save_result`的参数是用户可控的，因此存在一定风险。但是代码整体的风险较低，预估的投毒风险为10%。

**项目地址:** [0axz-tools/CVE-2024-13513.py](https://github.com/0axz-tools/CVE-2024-13513.py)

**漏洞详情:** [CVE-2024-13513](https://nvd.nist.gov/vuln/detail/CVE-2024-13513)