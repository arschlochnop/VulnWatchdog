## CVE-2025-59287 - Windows Server Update Service (WSUS) Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025 以及 23H2 版本的受影响版本

**利用条件:** 需要能够访问目标WSUS服务器的/ClientWebService/Client.asmx端点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个Windows Server Update Services (WSUS)中的远程代码执行漏洞。该漏洞是由于WSUS在处理不可信数据时存在反序列化漏洞，未经身份验证的攻击者可以通过网络利用此漏洞执行任意代码。利用方式如下：

1.  **漏洞原理：** 漏洞存在于`GetCookie()` 端点，利用不安全的反序列化。
2.  **攻击步骤：**
    *   攻击者构造包含恶意代码的序列化对象。
    *   使用AES-128-CBC加密该序列化对象。
    *   将加密后的数据进行Base64编码。
    *   将Base64编码后的数据嵌入SOAP信封的 `AuthorizationCookie` 字段中。
    *   将SOAP请求发送到目标 WSUS 服务器的 `GetCookie` 端点。
    *   服务器解密并反序列化数据，从而执行恶意代码，获取SYSTEM权限的reverse shell。

3.  **有效性评估：** 提供的POC代码旨在利用此漏洞。代码包含生成ysoserial.net payload、加密和构建SOAP请求的功能，看起来是有效的。漏洞库信息中CISA ADP的Vulnrichment也表明该漏洞存在可利用的PoC。
4.  **投毒风险：** 检查POC代码发现没有明显的恶意代码植入。投毒的风险在于，攻击者可能会修改反序列化的payload，使其在目标机器上执行除了reverse shell以外的其他恶意操作，或者通过某种方式利用reverse shell的机制在目标机器上安装后门。需要人工进行代码审计，来发现细微的代码缺陷或后门,判定为10%的风险。

**项目地址:** [QurtiDev/WSUS-CVE-2025-59287-RCE](https://github.com/QurtiDev/WSUS-CVE-2025-59287-RCE)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)