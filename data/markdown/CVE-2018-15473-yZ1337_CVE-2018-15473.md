## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)