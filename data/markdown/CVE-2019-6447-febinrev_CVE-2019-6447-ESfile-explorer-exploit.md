## CVE-2019-6447-ES File Explorer 任意文件读取/应用执行

**漏洞编号:** CVE-2019-6447

**漏洞类型:** 任意文件读取/应用执行

**影响应用:** ES File Explorer

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 4.1.9.7.4

**利用条件:** 攻击者需要与受害者在同一Wi-Fi网络下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-6447是ES File Explorer文件管理器应用程序（版本至4.1.9.7.4）中的一个漏洞，允许远程攻击者通过本地Wi-Fi网络上的TCP端口59777请求读取任意文件或执行应用程序。该TCP端口在ES应用程序启动后保持打开状态，并通过HTTP响应未经身份验证的application/json数据。

**有效性：**

根据漏洞描述、搜索引擎结果（例如exploit-db、cvedetails、vuldb、avast blog等）和提供的POC代码，该漏洞的利用是有效的。POC代码 `exploit.sh` 演示了如何通过向目标Android设备的59777端口发送包含特定命令的HTTP POST请求来利用此漏洞。

**利用方式：**

1.  **确定目标IP地址：** 首先，攻击者需要知道运行易受攻击的ES File Explorer的Android设备的IP地址（在同一Wi-Fi网络中）。
2.  **发送恶意请求：** 使用 `exploit.sh` 脚本，攻击者可以指定目标IP地址、命令（例如 `listFiles`, `getFile`, `getDeviceInfo` 等）和路径（例如要读取的文件的路径）。
3.  **端口59777：** 脚本向目标设备的59777端口发送包含JSON数据的HTTP POST请求。
4.  **文件读取/命令执行：** ES File Explorer应用程序上的开放端口会处理这些请求，允许攻击者读取文件内容（例如通过 `getFile` 命令）或执行其他操作（例如列出目录内容）。

**投毒风险：**

尽管提供的POC代码看起来很直接，但仍然存在潜在的投毒风险。以下是一些考虑因素：

*   **代码审查：** 仔细检查 `exploit.sh` 脚本是否存在任何可疑的或意外的行为。虽然目前的代码没有明显的后门，但需要彻底审查，因为代码可能包含作者隐藏的恶意代码。
*   **依赖项：** 该脚本依赖于 `curl` 和 `sed` 等工具。确保这些工具是从受信任的源安装的，并且没有被篡改。
*   **远程代码执行风险：**  如果漏洞被利用，攻击者可以读取任意文件，甚至可能执行某些应用，这本身就构成了高风险。虽然POC没有直接植入恶意代码，但是读取敏感信息，然后通过其他手段利用是一个潜在的攻击链。

基于目前的代码分析和理解， 投毒风险评估为 10%。主要是考虑到脚本本身的功能与漏洞描述一致，没有发现直接的恶意代码，但仍需警惕其潜在的风险，以及被攻击者利用进行后续恶意行为的可能性。

**项目地址:** [febinrev/CVE-2019-6447-ESfile-explorer-exploit](https://github.com/febinrev/CVE-2019-6447-ESfile-explorer-exploit)

**漏洞详情:** [CVE-2019-6447](https://nvd.nist.gov/vuln/detail/CVE-2019-6447)