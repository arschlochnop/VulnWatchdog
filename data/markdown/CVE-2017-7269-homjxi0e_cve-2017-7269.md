## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并启用了WebDAV服务。攻击者需要能够发送HTTP PROPFIND请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是一个存在于 Microsoft IIS 6.0 WebDAV 服务 ScStoragePathFromUrl 函数中的缓冲区溢出漏洞。攻击者可以通过发送一个包含过长 'If: <http://' 头部的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。从搜索引擎结果来看，此漏洞在野外被广泛利用，包括用于挖矿恶意软件的传播。提供的漏洞利用代码仅为漏洞描述文件，本身不包含可执行的利用代码，因此投毒风险较低。利用方式是构造特制的HTTP PROPFIND请求，在'If'头部包含超长字符串，溢出ScStoragePathFromUrl函数的缓冲区，覆盖内存中的重要数据，最终实现远程代码执行。

**项目地址:** [homjxi0e/cve-2017-7269](https://github.com/homjxi0e/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)