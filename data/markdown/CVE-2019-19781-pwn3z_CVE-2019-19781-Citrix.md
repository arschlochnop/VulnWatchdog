## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)