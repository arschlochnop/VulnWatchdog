## CVE-2025-34028-Commvault-路径遍历导致RCE

**漏洞编号:** CVE-2025-34028

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Commvault Command Center Innovation Release

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 11.38

**利用条件:** 网络可达Commvault Command Center服务，无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-34028是Commvault Command Center Innovation Release 11.38版本中存在的路径遍历漏洞。未经身份验证的攻击者可以通过上传包含恶意路径的ZIP文件，利用服务器解压功能，最终实现远程代码执行。

**有效性分析：** 根据漏洞描述和搜索结果，此漏洞的严重性评分为10.0，表明其影响极大。搜索结果中提到“PoC available”也说明漏洞的有效性较高。

**利用方式分析：**

1.  **未授权ZIP文件上传:** 攻击者无需身份验证即可上传ZIP文件。
2.  **路径遍历:** ZIP文件中包含利用路径遍历的恶意文件。例如，文件名可能是`../../../tmp/evil.sh`。
3.  **服务器解压:** Commvault服务器会自动解压上传的ZIP文件。
4.  **远程代码执行:** 由于路径遍历，恶意文件被解压到任意位置，如果该位置允许执行代码，则攻击者可以执行恶意代码，例如`evil.sh`。

提供的代码`infra-monitor.nse`是一个Nmap NSE脚本，用于检测web基础设施的响应一致性，**并不是此漏洞的直接PoC代码**。它通过比较正常路径和包含`../../../..`路径的响应，以及检查特定部署端点的访问情况来发现潜在的异常行为，可以作为辅助手段来检测 Commvault 服务是否存在潜在的漏洞或者配置不当问题。但它本身不执行利用，不构成RCE。

**投毒风险分析：**

提供的`infra-monitor.nse` Nmap脚本目的是进行网络诊断和评估，功能相对独立，旨在检测Web服务器的异常行为。脚本主要通过发送HTTP请求并分析响应来判断是否存在潜在的安全问题。代码中没有发现明显的后门或恶意代码，只是用来辅助扫描，没有直接执行系统命令或者进行文件操作的部分。因此，投毒的概率为0%。脚本功能是诊断和检测，而不是利用，没有发现恶意行为。

**项目地址:** [tinkerlev/commvault-cve2025-34028-check](https://github.com/tinkerlev/commvault-cve2025-34028-check)

**漏洞详情:** [CVE-2025-34028](https://nvd.nist.gov/vuln/detail/CVE-2025-34028)