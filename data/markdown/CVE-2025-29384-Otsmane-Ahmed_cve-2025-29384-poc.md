## CVE-2025-29384-Tenda AC9-/goform/AdvSetMacMtuWan 栈溢出

**漏洞编号:** CVE-2025-29384

**漏洞类型:** 栈溢出

**影响应用:** Tenda AC9

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** V15.03.05.14_multi

**利用条件:** 需要与目标路由器在同一网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29384 是 Tenda AC9 路由器 /goform/AdvSetMacMtuWan 接口的 wanMTU 参数存在栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP POST 请求，利用此漏洞导致拒绝服务（DoS）或潜在的远程代码执行（RCE）。

**有效性评估：**

*   漏洞库信息和搜索引擎结果均确认了该漏洞的存在以及受影响的版本。
*   提供的 PoC 代码描述了漏洞的利用方式，并提供了相应的 Python 脚本，增加了漏洞利用的有效性。
*   PoC 代码包含详细的使用说明，参数说明和预期结果，可以验证该漏洞的存在

**投毒风险分析：**

*   PoC 代码主要功能是发送大量数据到 `wanMTU` 参数，目的是触发栈溢出，导致设备崩溃。代码本身功能较为简单。
*  PoC代码存在投毒风险的概率较低，主要是为了验证漏洞的存在性。
*  需要人工审计 `poc.py` 中的网络请求相关代码是否存在恶意行为。

**利用方式分析：**

1.  **确定目标：** 攻击者需要知道目标 Tenda AC9 路由器的 IP 地址。
2.  **发送恶意请求：** 攻击者构造一个包含超长 `wanMTU` 参数的 HTTP POST 请求，发送到 `/goform/AdvSetMacMtuWan` 接口。
3.  **触发溢出：** 路由器接收到请求后，由于没有进行充分的边界检查，将超长数据复制到栈上的缓冲区，覆盖返回地址等关键数据。
4.  **导致 DoS 或 RCE：** 如果只是为了 DoS，覆盖返回地址为无效地址即可。如果想要 RCE，则需要精心构造 payload，将返回地址覆盖为攻击者 shellcode 的地址。

**项目地址:** [Otsmane-Ahmed/cve-2025-29384-poc](https://github.com/Otsmane-Ahmed/cve-2025-29384-poc)

**漏洞详情:** [CVE-2025-29384](https://nvd.nist.gov/vuln/detail/CVE-2025-29384)