## CVE-2017-7269-IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务启用。攻击者需要能够向目标服务器发送HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的一个缓冲区溢出漏洞。该漏洞存在于`ScStoragePathFromUrl`函数中，允许远程攻击者通过发送包含特制 `If:` 头的 `PROPFIND` 请求来执行任意代码。PoC 利用代码通过构造一个超长的 `If:` 头，导致缓冲区溢出，覆盖内存中的重要区域，从而实现代码执行。

**有效性：**
从漏洞描述和搜索引擎结果来看，该漏洞影响 IIS 6.0，并且有公开的 PoC。提供的代码看起来是可用的 PoC 的修改版本。因此，可以认为该 PoC 在目标环境满足漏洞利用条件的情况下是有效的。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意投毒代码。虽然代码本身可以用于攻击目的，但没有发现任何试图在受害者系统上植入后门或执行其他恶意行为的迹象。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP `PROPFIND` 请求，其中包含一个超长的 `If:` 头。
2.  超长的 `If:` 头会触发 `ScStoragePathFromUrl` 函数中的缓冲区溢出。
3.  溢出允许攻击者覆盖内存中的重要区域，例如函数返回地址。
4.  攻击者可以使用溢出来控制程序执行流程，执行任意代码。
5.  PoC 提供的代码计算一些值并通过字符转义嵌入到`If:`头中,以此绕过某些检测,实现执行命令。
6.  该exp执行命令长度有限,最多8个字符。

**项目地址:** [caicai1355/CVE-2017-7269-exploit](https://github.com/caicai1355/CVE-2017-7269-exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)