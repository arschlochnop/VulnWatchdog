## CVE-2025-32433-Erlang/OTP-SSH未授权RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 未授权远程代码执行

**影响应用:** Erlang/OTP

**危害等级:** 高危，可导致完全控制目标系统

**影响版本:** < OTP-25.3.2.20, >= OTP-26.0-rc1, < OTP-26.2.5.11, >= OTP-27.0-rc1, < OTP-27.3.3

**利用条件:** 目标系统运行受影响版本的 Erlang/OTP SSH 服务，且攻击者可以进行网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32433 是 Erlang/OTP SSH 服务中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。根据漏洞描述和搜索结果，攻击者可以通过构造恶意的 SSH 协议消息，绕过身份验证，并在目标系统上执行任意命令。提供的 POC 代码 `CVE-2025-32433.py` 模拟了这一攻击过程。该脚本首先与目标 SSH 服务建立连接，然后发送精心构造的 `SSH_MSG_KEXINIT`、`SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 消息。关键在于，`SSH_MSG_CHANNEL_REQUEST` 消息允许攻击者在未经身份验证的情况下发送执行命令的请求。POC 中默认的命令是在目标系统上创建 `/lab.txt` 文件并写入 "pwned" 内容。Dockerfile 用于构建一个包含易受攻击 Erlang/OTP 版本的环境。`ssh_server.erl`启动了一个存在漏洞的 SSH 服务。在投毒风险方面，POC代码主要功能是模拟攻击，没有发现明显的恶意代码或者后门，但也不能排除存在隐蔽的投毒代码的可能。相对来说Dockerfile 和 ssh_server.erl 存在潜在风险，因为可以修改构建过程或 SSH 服务本身来引入恶意行为。但从现有信息来看投毒的可能性较低，仅存在一些隐蔽的风险。所以，我给出的判断是5%。

**利用方式：**

1.  **连接目标：** 使用 socket 库建立到目标 Erlang/OTP SSH 服务的 TCP 连接。
2.  **协议交互：** 按照 SSH 协议，首先进行 banner 交换，然后发送 `SSH_MSG_KEXINIT` 消息，协商密钥交换算法等。
3.  **绕过认证：** 漏洞的关键在于可以在未经身份验证的情况下，发送 `SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 消息。
4.  **执行命令：** 通过 `SSH_MSG_CHANNEL_REQUEST` 消息中的 `exec` 请求，指定要执行的命令。
5.  **验证利用：** 检查目标系统上是否成功执行了指定的命令（例如，创建了 `/lab.txt` 文件）。

**项目地址:** [ProDefense/CVE-2025-32433](https://github.com/ProDefense/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)