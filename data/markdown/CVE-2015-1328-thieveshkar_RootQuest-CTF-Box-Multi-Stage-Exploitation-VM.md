## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)