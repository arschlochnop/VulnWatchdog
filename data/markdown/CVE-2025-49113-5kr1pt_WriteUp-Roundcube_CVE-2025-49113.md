## CVE-2025-49113 - Roundcube Webmail PHP 对象反序列化 RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP 对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** <= 1.5.10 / 1.6.10

**利用条件:** 需要已认证的用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Roundcube Webmail 中 program/actions/settings/upload.php 文件，由于未对 _from 参数进行充分验证，导致已认证的用户可以通过构造恶意的 PHP 对象并将其作为 _from 参数传递，触发 PHP 对象反序列化漏洞，从而实现远程代码执行。

**有效性分析：**

提供的漏洞利用代码（README.md）描述了完整的漏洞利用过程，包括漏洞原理、时间线、受影响版本、修复方案，以及一个 TryHackMe 靶场的 WriteUp。WriteUp 详细说明了如何使用给定的 PoC 脚本进行攻击，包括克隆 PoC 仓库，准备 Payload（bind shell），执行 PoC 脚本，以及连接到反弹 Shell。因此，可以判定提供的 PoC 代码是有效的。

**投毒风险分析：**

提供的文件主要是 README.md，用于描述漏洞和利用方法，提供的是漏洞利用方法，而不是直接可执行的payload。PoC链接指向 fearsoff-org/CVE-2025-49113 仓库。虽然 README.md 中没有发现直接的恶意代码，但是该仓库的真实PoC脚本是否存在后门或恶意代码是需要进一步验证的。假设PoC脚本存在投毒风险，这个风险主要来源于脚本执行任意命令的能力，如果被篡改，可能执行恶意操作，例如植入后门、窃取数据等。综合考虑，考虑到提供的文件主要是说明文档，且github代码库可以进行代码审查，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **身份验证：** 攻击者需要拥有一个有效的 Roundcube Webmail 用户账户。
2.  **构造恶意 Payload：** 攻击者需要构造一个包含恶意代码的 PHP 对象，该对象在反序列化时会执行攻击者指定的命令。（例如，使用 `proc_open` 函数执行任意系统命令）。
3.  **利用 _from 参数：** 将构造的恶意 PHP 对象进行序列化，然后将其作为 `_from` GET 参数的值传递给 `program/actions/settings/upload.php`。
4.  **触发反序列化：** 访问 `upload.php`，Roundcube 将从 GET 参数中获取 `_from` 的值，并对其进行处理，然后调用 `session_decode()` 触发反序列化操作，从而执行恶意代码。
5.  **获取 Shell：** 如果 Payload 成功执行，攻击者将获得在服务器上执行命令的权限，从而可以控制服务器。

总的来说，该漏洞是一个典型的 PHP 对象反序列化漏洞，攻击利用链较为清晰，但需要一定的 PHP 代码审计和 Payload 构造能力。需要已认证用户身份是利用此漏洞的先决条件。

**项目地址:** [5kr1pt/WriteUp-Roundcube_CVE-2025-49113](https://github.com/5kr1pt/WriteUp-Roundcube_CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)