## CVE-2024-9047-WordPress File Upload-Path Traversal

**漏洞编号:** CVE-2024-9047

**漏洞类型:** 路径遍历

**影响应用:** WordPress File Upload

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** <= 4.24.11

**利用条件:** PHP版本 <= 7.4

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-9047 是 WordPress File Upload 插件中的一个路径遍历漏洞。未经身份验证的攻击者可以通过 `wfu_file_downloader.php` 访问任意文件。漏洞利用方式如下：

1.  **漏洞文件：**  `wfu_file_downloader.php`
2.  **漏洞参数：**  `file`、`ticket`、`handler`、`session_legacy`、`dboption_base`、`dboption_useold`、`wfu_cookie`
3.  **利用过程：**
    *   攻击者构造包含路径遍历的 `wfu_cookie` 参数，例如 `wfu_storage_pQ1DyzbQp5hBxQpW=/../../../../../etc/passwd[[name]];`
    *   攻击者发送精心设计的HTTP请求到 `wfu_file_downloader.php`。
    *   服务器读取并返回目标文件（例如 `/etc/passwd`）的内容。
4.  **POC有效性：**  提供的Python脚本尝试利用此漏洞读取 `/etc/passwd` 文件。脚本首先尝试从 `release_notes.txt` 文件中获取插件版本，如果版本小于等于 4.24.11，则发送包含恶意cookie的请求。 如果返回包含`/bin/bash`和`root:x:0:0`证明漏洞存在
5.  **投毒风险：**  代码未发现明显的恶意行为或后门。该脚本主要功能是发送HTTP请求并检查响应，属于常规漏洞利用模式。代码中检测版本号，以及读取特定文件内容来判断漏洞是否存在，并无向目标主机写入文件的行为。因此判定投毒风险较低。
6.  **利用前提：** 目标WordPress站点安装了存在漏洞的 WordPress File Upload 插件，且PHP版本为7.4或更低。

**项目地址:** [iSee857/CVE-2024-9047-PoC](https://github.com/iSee857/CVE-2024-9047-PoC)

**漏洞详情:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)