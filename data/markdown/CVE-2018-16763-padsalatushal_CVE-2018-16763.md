## CVE-2018-16763-Fuel CMS-RCE

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行

**影响应用:** Fuel CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.4.1

**利用条件:** 目标服务器运行存在漏洞的Fuel CMS 1.4.1版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-16763是Fuel CMS 1.4.1版本中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过`pages/select/`的`filter`参数或`preview/`的`data`参数执行任意PHP代码。漏洞利用方式是构造包含PHP代码的恶意请求发送到目标服务器，服务器解析该请求，执行其中的PHP代码，从而实现远程代码执行。

**有效性：**
根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。漏洞描述明确指出可以通过特定的参数执行PHP代码，且提供的exploit.py脚本也正是利用了这一点，通过构造包含PHP代码的URL请求，来执行任意命令。多个搜索结果也验证了此漏洞的存在以及利用方式。

**投毒风险：**
提供的代码主要包含LICENSE、README.md、exploit.py以及requirements.txt。LICENSE声明了许可协议，README.md描述了漏洞信息和利用方法，exploit.py是漏洞利用脚本，requirements.txt包含了脚本依赖的库（colorama、argparse）。

经过分析，该仓库中**存在投毒代码的风险较低，约为5%**。尽管不能完全排除作者在代码中隐藏恶意代码的可能性，但从整体来看，代码结构清晰，功能明确，没有发现明显的异常行为。
*   `exploit.py`脚本的功能是构造包含恶意PHP代码的URL，然后发送GET请求，提取返回结果。脚本中使用了`urllib.parse.quote`对命令进行URL编码，这本身是为了确保命令能够正确地被服务器解析，并非恶意行为。
*   脚本使用了`colorama`库，用于在终端输出彩色文本，这只是为了提高用户体验，没有安全风险。
*   脚本使用了`argparse`库，用于解析命令行参数，方便用户指定目标URL。这同样是一个正常的功能，没有安全风险。

**利用方式：**
1.  克隆包含漏洞利用代码的Git仓库：`git clone https://github.com/Trushal2004/CVE-2018-16763.git`
2.  进入克隆的目录：`cd CVE-2018-16763/`
3.  安装所需的Python依赖：`python3 -m pip install -r requirements.txt`
4.  授予执行权限：`chmod +x exploit.py`
5.  运行漏洞利用脚本，并指定目标URL：`./exploit.py -u <目标URL>`
6.  脚本会提示输入要执行的命令，输入后脚本会构造恶意URL并发送请求，然后输出命令执行的结果。输入`exit`退出。

**项目地址:** [padsalatushal/CVE-2018-16763](https://github.com/padsalatushal/CVE-2018-16763)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)