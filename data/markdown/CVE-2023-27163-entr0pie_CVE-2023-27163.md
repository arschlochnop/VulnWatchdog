## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** request-baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的request-baskets实例，且攻击者能够向其发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 request-baskets 1.2.1 及更早版本中发现的服务器端请求伪造 (SSRF) 漏洞。它位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造特制的 API 请求，利用此漏洞访问网络资源和敏感信息。

**有效性：**

提供的 PoC 代码（`CVE-2023-27163.sh`）有效。它通过创建一个包含恶意 `forward_url` 的 basket 来利用该漏洞。这个 URL 指向攻击者的服务器，导致受害服务器向攻击者的服务器发出请求，从而实现 SSRF。

**投毒风险：**

该仓库的投毒风险较低，约为 5%。理由如下：

*   PoC 代码相对简单，功能明确，主要用于演示 SSRF 漏洞的利用。代码主要是bash脚本，用于发送HTTP请求和创建特定配置的basket。
*   `LICENSE` 文件表明这是一个公共领域软件，作者放弃了所有版权，这意味着任何人都可以自由使用、修改和分发该软件，这在一定程度上降低了作者植入恶意代码的动机。
*   `README.md` 文件提供了详细的漏洞描述、使用方法和测试步骤，方便用户理解和验证漏洞。
*   主要的风险在于，攻击者可能修改该脚本，添加恶意功能，例如在成功利用 SSRF 后，自动下载和执行恶意程序。但就目前提供的代码来看，作者没有明显的投毒行为。

**利用方式：**

1.  攻击者运行 `CVE-2023-27163.sh` 脚本，并提供目标 request-baskets 服务器的 URL 和攻击者控制的服务器的 URL。
2.  脚本会创建一个新的 basket，并将 `forward_url` 设置为攻击者的服务器。
3.  当有人访问新创建的 basket 时，request-baskets 服务器会将请求转发到攻击者的服务器。
4.  攻击者可以利用此 SSRF 漏洞，让受害服务器访问内部网络资源、执行任意 HTTP 请求，甚至读取敏感文件。

**补充说明：**

*   `jq` 命令用于解析 JSON 响应。如果目标系统上没有安装 `jq`，脚本仍然可以运行，但会直接输出完整的响应体。
*   PoC 主要目的是演示漏洞，实际攻击中，攻击者可能会使用更复杂的 payload 和技巧来最大化漏洞利用的影响。

**项目地址:** [entr0pie/CVE-2023-27163](https://github.com/entr0pie/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)