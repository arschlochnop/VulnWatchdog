## CVE-2025-5394-Alone主题-任意文件上传导致RCE

**漏洞编号:** CVE-2025-5394

**漏洞类型:** 任意文件上传

**影响应用:** Alone WordPress Theme

**危害等级:** 高危，可能导致远程代码执行，完全控制网站

**影响版本:** <= 7.8.3

**利用条件:** 目标网站安装了Alone主题，且版本低于或等于7.8.3，允许未授权访问wp-admin/admin-ajax.php接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-5394漏洞存在于Alone WordPress主题中，允许未经身份验证的攻击者上传任意文件。利用方式如下：

1.  **漏洞描述：** 该漏洞由于`alone_import_pack_install_plugin()`函数缺少权限验证，导致攻击者可以通过上传包含恶意代码的ZIP文件（伪装成插件）来实现远程代码执行。
2.  **漏洞影响：** 攻击者可以完全控制受影响的网站，包括但不限于篡改网站内容、窃取敏感数据、安装恶意软件等。
3.  **漏洞利用：**
    *   攻击者首先创建一个包含恶意PHP代码（webshell）的ZIP文件。`exploit.py`脚本完成了webshell生成，并打包成zip。
    *   然后，攻击者通过向`wp-admin/admin-ajax.php?action=alone_import_pack_install_plugin`端点发送POST请求来上传恶意ZIP文件。
    *   一旦ZIP文件上传成功，恶意PHP文件将被解压到WordPress插件目录，攻击者可以通过访问该文件来执行任意代码。`exploit.py` 脚本通过访问webshell路径，并执行`id`命令来验证漏洞是否成功。
4.  **漏洞缓解：** 将Alone主题升级到高于7.8.3的版本。
5.  **风险评估：**  根据搜索结果，该漏洞已被积极利用，构成严重威胁。
6.  **投毒风险评估：**代码逻辑主要为生成webshell zip包，然后上传webshell，测试webshell。虽然存在一定的风险，即如果webshell的内容被替换为恶意代码，可能造成投毒。但是考虑到代码的目的是生成webshell，即使存在投毒，也很容易被发现。 因此判断投毒的概率较低。可以认为投毒风险较低，约为1%。

**项目地址:** [fokda-prodz/CVE-2025-5394](https://github.com/fokda-prodz/CVE-2025-5394)

**漏洞详情:** [CVE-2025-5394](https://nvd.nist.gov/vuln/detail/CVE-2025-5394)