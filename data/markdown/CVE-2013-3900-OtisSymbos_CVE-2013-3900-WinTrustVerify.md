## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)