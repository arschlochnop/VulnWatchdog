## CVE-2023-2255 - LibreOffice 远程资源加载

**漏洞编号:** CVE-2023-2255

**漏洞类型:** 权限、特权和访问控制

**影响应用:** LibreOffice

**危害等级:** 中危，可能导致信息泄露和有限的远程代码执行

**影响版本:** 7.4 版本 < 7.4.7; 7.5 版本 < 7.5.3

**利用条件:** 需要用户打开恶意的 LibreOffice 文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-2255 漏洞是 LibreOffice 在处理浮动框架时存在不正确的访问控制问题。攻击者可以构造一个包含指向外部资源的浮动框架的恶意文档，当用户打开该文档时，LibreOffice 会在未经用户提示的情况下加载这些外部资源。这与 LibreOffice 处理其他链接内容的方式不一致，可能导致潜在的安全风险。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC代码。PoC代码通过修改 ODT (LibreOffice 文档) 的 `content.xml` 文件，将命令注入到外部资源链接中。当 LibreOffice 打开该文档时，会尝试加载外部资源，从而执行注入的命令。

**投毒风险分析：**

检查提供的PoC代码，代码主要功能是生成恶意ODT文档，并没有发现明显的恶意行为或隐藏后门。`webshell.php` 是一个简单的webshell，用于接收GET参数并执行系统命令，并非投毒代码，而是PoC的一部分，用于验证漏洞利用。

因此，投毒风险评估为 0%。

**利用方式：**

1.  **构造恶意文档：** 攻击者创建一个包含浮动框架的 LibreOffice 文档（通常是 ODT 格式）。
2.  **修改 content.xml：** 使用 PoC 脚本，修改文档中的 `content.xml` 文件，将浮动框架指向攻击者控制的外部资源，并在 URL 中注入恶意命令。
3.  **诱骗用户打开文档：** 攻击者通过电子邮件、社交媒体或其他方式诱骗用户打开该恶意文档。
4.  **执行恶意命令：** 当用户打开文档时，LibreOffice 会自动加载外部资源，从而执行攻击者注入的命令。在PoC例子中，是下载一个webshell文件到当前目录。
5.  **控制目标系统：** 如果攻击成功，攻击者可以在目标系统上执行任意命令，甚至完全控制系统。（取决于 LibreOffice 进程的权限和安全配置）。

**缓解措施：**

*   升级 LibreOffice 到受影响版本之后的版本（>=7.4.7 或 >=7.5.3）。
*   谨慎打开来源不明的 LibreOffice 文档。
*   配置 LibreOffice 的安全设置，禁止自动加载外部资源。

**项目地址:** [elweth-sec/CVE-2023-2255](https://github.com/elweth-sec/CVE-2023-2255)

**漏洞详情:** [CVE-2023-2255](https://nvd.nist.gov/vuln/detail/CVE-2023-2255)