## CVE-2020-17530 Apache Struts OGNL 远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许未经身份验证的用户访问存在漏洞的页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Apache Struts框架在处理标签属性中的用户输入时，强制执行了OGNL表达式，且未对输入进行充分验证，导致攻击者可以通过构造恶意的OGNL表达式，执行任意代码。利用方式包括发送包含恶意OGNL表达式的POST请求，该表达式可以执行系统命令、SSRF或计算器程序等。

**有效性：**根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断POC代码有效。多个来源都证实了CVE-2020-17530漏洞的存在，并提供了利用方法。POC代码中包含了构造恶意OGNL表达式的示例，可以直接用于执行系统命令或触发SSRF。

**投毒风险：**POC代码本身主要展示漏洞的利用方法，没有发现明显的恶意代码。项目文件中存在一些图片资源，但这些资源似乎只是为了演示漏洞利用效果，不具备潜在的投毒性。`/CVE-2020-17530/SimpleStruts.iml` 和 `/CVE-2020-17530/pom.xml`，这些Maven依赖和IDEA项目文件本身不具备投毒性，但是有可能被作者利用，添加恶意的依赖,例如包含反序列化漏洞的依赖,或者包含webshell注入的jar包, 但是从代码本身以及仓库结构来看, 这种可能性较低。 投毒风险评估为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP POST请求到存在漏洞的Struts应用程序的某个Action，例如`S2061.action`。
2.  恶意OGNL表达式通过`id`参数传递。
3.  Struts框架在处理`id`参数时，会对OGNL表达式进行求值，从而执行攻击者预先设定的恶意代码。
4.  恶意代码可以包括执行系统命令（如`whoami`），触发SSRF攻击（ping外部域名），或者执行任意Java代码（如启动计算器）。

总体而言，该漏洞利用方法较为直接，且影响严重，可导致远程代码执行。提供的POC代码可以帮助开发者理解漏洞原理，并进行安全测试。

**项目地址:** [Al1ex/CVE-2020-17530](https://github.com/Al1ex/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)