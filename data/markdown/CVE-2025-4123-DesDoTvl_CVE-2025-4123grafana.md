## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)