## CVE-2024-10924 - Really Simple Security Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (WordPress plugin)

**危害等级:** 高危，未经身份验证的攻击者可以以任何现有用户身份登录，包括管理员

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标WordPress站点安装了受影响版本的Really Simple Security插件，并且启用了“Two-Factor Authentication”设置 (即使默认是禁用)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10924 是 Really Simple Security (Free, Pro, and Pro Multisite) WordPress 插件中的身份验证绕过漏洞。该漏洞源于 `check_login_and_get_user` 函数中不正确的用户检查错误处理，位于 two-factor REST API actions 中。未经身份验证的攻击者可以通过向 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送包含目标用户 ID 的 POST 请求，绕过身份验证并以该用户身份登录。提供的PoC代码利用此漏洞，通过构造特定的 POST 请求，模拟跳过双因素身份验证流程，从而获得目标用户的Cookie，达到身份仿冒的目的。

**有效性：**
PoC代码有效，因为它直接利用了漏洞描述中提到的REST API端点和参数，发送构造好的数据包来绕过身份验证。

**投毒风险：**
经过对提供的PoC代码进行分析，没有发现任何作者隐藏的恶意代码。该脚本的功能明确，即发送一个带有特定参数的POST请求，以利用身份验证绕过漏洞。脚本没有进行任何文件写入、系统命令执行或未经授权的网络连接，因此可以认为不存在投毒风险。

**利用方式：**
1.  攻击者首先确定目标WordPress网站是否安装了受影响版本的Really Simple Security插件。
2.  攻击者需要知道要冒充的用户的user_id，这可以通过枚举或其他方式获取。
3.  攻击者使用提供的PoC脚本，指定目标网站的URL和目标用户的user_id。
4.  脚本构造一个包含user_id、“invalid_nonce”和“/wp-admin/”的POST请求，发送到`/reallysimplessl/v1/two_fa/skip_onboarding`端点。
5.  如果请求成功，服务器会返回包含身份验证cookie的响应。
6.  攻击者可以使用返回的cookie来访问WordPress管理后台，从而获得目标用户的权限。

**项目地址:** [OliveiraaX/-CVE-2024-10924](https://github.com/OliveiraaX/-CVE-2024-10924)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)