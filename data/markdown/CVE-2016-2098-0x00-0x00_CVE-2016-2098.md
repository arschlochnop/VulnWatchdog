## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.x (< 3.2.22.2), 4.0.x, 4.1.x (< 4.1.14.2), 4.2.x (< 4.2.5.2)

**利用条件:** 应用程序使用了`render`方法并且允许用户可控的数据传递到该方法中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。该漏洞源于应用程序不安全地使用 `render` 方法处理用户提供的输入。攻击者可以通过构造包含恶意 Ruby 代码的请求参数，利用`render`方法执行任意命令。 

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用的有效性非常高。大量的安全公告和漏洞报告证实了该漏洞的存在和危害。

**投毒风险分析：**

提供的POC代码主要包含一个Go语言编写的漏洞利用程序。代码的功能是构造包含恶意 Ruby 代码的URL，并发送HTTP请求。该程序的主要功能是利用漏洞，并未发现明显的投毒代码。需要注意的是，该漏洞本身允许执行任意命令，攻击者完全可以使用该漏洞植入后门。

**关于`img/1.JPG` 和 `img/2.JPG`：**虽然提供了截图, 但不能直接分析是否是后门，应该关注代码本身，图片只是展示作用.

**关于漏洞本身带来的投毒风险：**利用此漏洞可以执行任意代码，这意味着攻击者可以修改服务器上的文件，包括 Rails 应用程序代码。例如，攻击者可以向 Rails 应用程序添加一个后门，从而在将来获得未经授权的访问权限。这种投毒行为不是POC代码本身带来的，而是漏洞允许攻击者进行攻击的结果。

**利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 Ruby on Rails 应用程序的服务器。
2.  **构造Payload：**  构造包含恶意 Ruby 代码的 HTTP 请求参数。根据POC代码，可以使用 `id[inline]=<%= %x(SHELLCOMMANDHERE) %>` 的形式，将要执行的shell命令嵌入到参数中。
3.  **发送请求：** 将构造好的请求发送到目标服务器。
4.  **获取结果：**  如果漏洞利用成功，服务器将执行恶意 Ruby 代码，并将结果返回给攻击者。攻击者可以在HTTP响应中查看命令执行的结果。

**综上所述，POC代码本身的投毒风险较低（5%），但该漏洞允许攻击者执行任意代码，存在较高的漏洞利用风险，攻击者可以利用该漏洞植入后门或进行其他恶意活动。**

**项目地址:** [0x00-0x00/CVE-2016-2098](https://github.com/0x00-0x00/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)