## CVE-2024-25180-pdfmake-远程代码执行

**漏洞编号:** CVE-2024-25180

**漏洞类型:** 远程代码执行

**影响应用:** pdfmake

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 0.2.9

**利用条件:** 目标服务器安装了包含/pdf端点的测试框架，且该端点对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25180是pdfmake 0.2.9版本中的一个远程代码执行漏洞。根据漏洞信息，攻击者可以通过向`/pdf`端点发送特制的POST请求来执行任意代码。搜索结果表明这是一个严重的安全漏洞，可能影响使用pdfmake的应用程序，甚至IBM Spectrum Control。尽管漏洞信息中存在争议，认为`/pdf`端点只在安装测试框架后可用，且使用者有责任确保其安全性，但是PoC的存在证明了漏洞的可利用性。PoC代码通过向`/pdf`端点发送包含恶意JavaScript代码的JSON数据，利用`child_process.execSync`函数执行系统命令，从而反弹shell。投毒风险分析：PoC中使用了反弹shell的常见方式，但如果攻击者将恶意代码嵌入到PDF生成过程中，例如在生成的PDF中插入恶意JavaScript，则可能存在投毒风险。风险评估为10%，主要原因是PoC代码本身的目标是证明漏洞存在，而不是实施大规模的投毒攻击。利用方式：1. 目标系统必须安装pdfmake 0.2.9版本。 2. 目标系统必须安装包含`/pdf`端点的测试框架。3. 攻击者需要构造一个包含恶意JavaScript代码的POST请求，发送到目标系统的`/pdf`端点，利用`child_process.execSync`在服务器端执行任意命令，例如反弹shell。

**项目地址:** [dustblessnotdust/CVE-2024-25180](https://github.com/dustblessnotdust/CVE-2024-25180)

**漏洞详情:** [CVE-2024-25180](https://nvd.nist.gov/vuln/detail/CVE-2024-25180)