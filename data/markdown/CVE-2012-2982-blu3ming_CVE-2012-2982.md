## CVE-2012-2982-Webmin-命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.590

**利用条件:** 需要目标Webmin服务开启，且攻击者需要有效的Webmin用户凭据（已认证的用户）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2982 漏洞存在于 Webmin 1.590 及更早版本的 `file/show.cgi` 文件中。该漏洞允许远程认证的用户通过在路径名中使用无效字符来执行任意命令，例如使用 `|`（管道符）。

**漏洞利用方式：**

1.  **认证：** 攻击者需要拥有Webmin的有效用户名和密码，利用 `session_login.cgi` 脚本进行认证。
2.  **构造Payload：** 攻击者构造包含管道符的恶意路径名，将其作为 `file/show.cgi` 的参数。管道符允许攻击者将命令注入到文件路径中。
3.  **命令执行：** Webmin 在处理包含管道符的路径时，会将管道符后面的内容当作命令执行，从而导致任意命令执行。
4.  **反弹shell (POC代码)：** 提供的 POC 代码使用 netcat 反弹 shell。它首先尝试登录 Webmin，成功后，构造一个包含命令注入的 URL，然后通过 `file/show.cgi` 触发漏洞。攻击者需要指定目标 IP 地址、端口、Webmin 用户名、密码、反弹 shell 的 LHOST 和 LPORT。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。POC 代码已经实现了利用该漏洞来执行任意命令的功能。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。POC 代码的主要功能是利用漏洞执行命令，而不是在目标系统上植入恶意代码或后门。requirements.txt 中的 `secrets` 库是用于生成随机字符串，用于绕过某些安全检查，不属于投毒代码。代码逻辑看起来合理，符合漏洞利用的预期。因此，投毒风险评估为 0%。需要注意的是，任何漏洞利用代码都应该在受控环境中进行测试，以避免意外情况。


**项目地址:** [blu3ming/CVE-2012-2982](https://github.com/blu3ming/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)