## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞允许本地用户通过利用 `sudo` 的 `--chroot` 选项和用户可控的 `/etc/nsswitch.conf` 文件获取 root 权限。 

**有效性：**
提供的 PoC 代码看起来有效。它通过以下步骤利用该漏洞：

1.  创建一个恶意的 C 程序 (`woot1337.c`)，该程序在执行时会设置 uid 和 gid 为 0 (root)，然后执行 `/bin/bash`，从而获得 root shell。
2.  创建一个目录结构 `woot/etc`，模拟 chroot 环境。
3.  将 `/etc/group` 复制到 `woot/etc`。
4.  创建一个自定义的 `woot/etc/nsswitch.conf` 文件，其中包含 `passwd: /woot1337`，这指示系统从 `/woot1337` 文件中查找密码信息。由于 `/woot1337` 是一个共享库，它将被加载执行.
5.  编译 C 程序为一个共享库 (`libnss_/woot1337.so.2`)。
6.  使用 `sudo -R woot woot` 命令，以 chroot 环境 `woot` 运行 `woot` (这个woot实际上并不存在，但是会触发nsswitch.conf的解析，最终加载并执行libnss_/woot1337.so.2)。`-R`选项结合恶意的`nsswitch.conf`使得sudo加载用户控制的共享对象。

**投毒风险：**
考虑到作者声明和代码结构，投毒风险较低，估计为 10%。可能存在的风险包括：

*   **不明显的依赖：** PoC 依赖于特定的系统配置或库，如果环境不满足这些条件，可能会导致 PoC 失败，但这不是投毒。
*   **条件竞争：** PoC 中可能存在条件竞争，导致提权失败或系统不稳定，但这不是投毒。

**利用方式：**

1.  本地用户创建一个包含恶意配置的目录，包括 `nsswitch.conf` 和恶意共享库。
2.  本地用户使用 `sudo -R` 选项，指定该目录作为 chroot 环境。
3.  当 `sudo` 尝试解析用户和组信息时，会加载用户控制的 `nsswitch.conf`，从而加载恶意的共享库。
4.  恶意的共享库执行特权操作，例如，设置 uid 和 gid 为 0，并启动 root shell。

**项目地址:** [muhammedkayag/CVE-2025-32463](https://github.com/muhammedkayag/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)