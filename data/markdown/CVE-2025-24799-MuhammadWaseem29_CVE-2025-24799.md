## CVE-2025-24799 GLPI SQL注入

**漏洞编号:** CVE-2025-24799

**漏洞类型:** SQL注入

**影响应用:** GLPI

**危害等级:** 高危，可能导致数据泄露

**影响版本:** >= 10.0.0, < 10.0.18

**利用条件:** 需要网络访问GLPI的inventory endpoint

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24799是GLPI中存在的一个SQL注入漏洞，位于inventory endpoint。未经身份验证的攻击者可以通过操纵`deviceid`参数，在XML数据中注入恶意SQL代码。从提供的漏洞利用代码`exploit.py`来看，它通过向`/index.php/ajax/`端点发送特制的XML请求，并使用`sleep()`函数来检测是否存在SQL注入。具体来说，它发送两个请求：一个没有延迟，另一个有延迟。如果延迟请求的时间明显长于没有延迟的请求，则表明存在SQL注入漏洞。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用的有效性较高。搜索结果中多个来源确认了该漏洞的存在，并表明它允许未经身份验证的SQL注入。POC代码通过时间延迟注入的方式验证了漏洞的存在。

**投毒风险：**

尽管代码的主要功能是漏洞扫描，但仍然存在一定的投毒风险，风险评估为10%。主要基于以下几点：

1.  **作者信誉：** 作者“Noob-Wasi”的信誉未知。虽然GitHub上存在该作者，但是无法确定其是否值得信任。
2.  **代码审查难度：** SQL注入漏洞利用代码本身比较复杂，即使有经验的开发者也需要仔细审查才能发现潜在的恶意代码。
3.  **依赖项风险：**  虽然POC使用的requests和colorama库本身风险较低，但是任何依赖都存在被供应链攻击的风险。
4. **无明显后门，** 目前的代码未发现存在明显植入后门的行为，例如反弹shell，文件上传等。

**利用方式：**

1.  **确定目标：** 找到运行GLPI 10.0.0到10.0.17版本的服务器。
2.  **发送特制的XML请求：** 使用提供的`exploit.py`脚本，或者手动构造包含恶意SQL代码的XML请求，发送到`/index.php/ajax/`端点。
3.  **时间延迟注入：** 通过观察服务器响应时间来判断是否存在SQL注入漏洞。如果响应时间异常长，则表示存在漏洞。
4.  **数据提取/修改：**  一旦确认存在SQL注入漏洞，攻击者就可以利用该漏洞执行任意SQL查询，例如提取敏感数据、修改数据库内容甚至执行任意代码（如果数据库用户权限足够）。

**项目地址:** [MuhammadWaseem29/CVE-2025-24799](https://github.com/MuhammadWaseem29/CVE-2025-24799)

**漏洞详情:** [CVE-2025-24799](https://nvd.nist.gov/vuln/detail/CVE-2025-24799)