## CVE-2021-44667-Nacos-XSS

**漏洞编号:** CVE-2021-44667

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** Nacos

**危害等级:** 中危，可能导致用户凭据泄露或执行恶意脚本

**影响版本:** 2.0.3

**利用条件:** 需要用户访问受影响的auth/users页面，并且需要具备修改pageSize和pageNo参数的权限

**POC 可用性:** 否

**投毒风险:** 5%

## 详情

CVE-2021-44667是Nacos 2.0.3版本中存在的一个跨站脚本漏洞。该漏洞位于auth/users页面，攻击者可以通过修改pageSize和pageNo参数，注入恶意JavaScript代码。当其他用户访问包含恶意代码的页面时，恶意代码将在用户的浏览器中执行。 

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞是存在的，并且影响Nacos 2.0.3版本。虽然没有直接提供可用的PoC代码，但是可以参考XSS漏洞的通用利用方式进行验证。

提供的代码片段主要是构建NACOS相关的说明文档以及历史版本更新的记录,不包含任何漏洞验证代码，因此，这里评估 POC 不可用

**投毒风险：**
提供的代码片段是Nacos的构建说明和更新日志，**并非漏洞利用代码**。因此，直接分析其投毒风险意义不大。但从安全角度来说，任何开源项目的代码都可能存在被植入恶意代码的风险。这里的投毒风险评估较低，因为这些文件主要是文档性质的，即使被修改，也很难直接导致严重的安全问题。但是用户如果依赖这些文档构建存在漏洞的依赖，一样存在风险。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，恶意代码作为pageSize或pageNo参数的值。
2.  攻击者诱使用户点击该URL，或者将该URL嵌入到其他网页中。
3.  当用户访问该URL时，恶意代码将在用户的浏览器中执行。
4.  恶意代码可以窃取用户的Cookie，或者执行其他恶意操作，例如重定向到钓鱼网站。

**缓解措施：**
*   升级到Nacos 2.0.4或更高版本，该版本修复了此漏洞。
*   对pageSize和pageNo参数进行输入验证和过滤，防止恶意代码注入。
*   实施内容安全策略（CSP），限制浏览器可以加载的资源类型，防止XSS攻击。

**项目地址:** [shoucheng3/alibaba__nacos_CVE-2021-44667_2-0-3](https://github.com/shoucheng3/alibaba__nacos_CVE-2021-44667_2-0-3)

**漏洞详情:** [CVE-2021-44667](https://nvd.nist.gov/vuln/detail/CVE-2021-44667)