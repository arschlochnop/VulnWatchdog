## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (参考漏洞库信息)

**利用条件:** 需要网络访问到BIG-IP的管理接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的 HTTP 请求头来绕过身份验证，从而执行未经授权的操作，包括执行任意命令。漏洞利用代码 `exploit.py` 通过设置特定的 `Host`, `Authorization`, `X-F5-Auth-Token`, 和 `Connection` 头来绕过身份验证。该脚本向 `/mgmt/tm/util/bash` 端点发送 POST 请求，并在 JSON 负载中包含要执行的命令。搜索引擎结果和漏洞库信息均表明该漏洞影响多个 BIG-IP 版本，且已被积极利用。

**有效性:**

根据搜索结果和漏洞描述，提供的POC代码的利用方式是有效的。该POC通过构造畸形请求头绕过身份验证，从而在目标系统上执行任意命令。多个来源证实了此漏洞的存在以及被利用的可能性。

**投毒风险:**

代码本身没有明显的投毒行为。`exploit.py` 的功能是利用漏洞执行用户指定的命令。`README.md` 文件只包含简单的说明。但考虑到代码托管在第三方平台，并且攻击者可能修改代码，存在一定的风险。因此评估投毒风险为10%。此处的投毒风险是指仓库本身被恶意篡改的风险，而非利用漏洞植入后门。

**利用方式:**

1.  攻击者构造包含特定Header的HTTP POST请求，目标URL为`/mgmt/tm/util/bash`。
2.  关键Header包括：
    *   `Host: 127.0.0.1` (绕过Host验证)
    *   `Authorization: Basic YWRtaW46aG9yaXpvbjM=` (提供一个假的认证信息)
    *   `X-F5-Auth-Token: asdf` (提供一个假的Token)
    *   `Connection: X-F5-Auth-Token` (关键，利用BIG-IP的处理逻辑绕过认证)
    *   `Content-Type: application/json`
3.  在请求的JSON Body中，指定要执行的命令，例如：`{"command":"run","utilCmdArgs":"-c 'id'"}`。
4.  BIG-IP在未进行正确身份验证的情况下，执行该命令，并将结果返回给攻击者。


**项目地址:** [nvk0x/CVE-2022-1388-exploit](https://github.com/nvk0x/CVE-2022-1388-exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)