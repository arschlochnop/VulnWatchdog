## CVE-2025-53770 Microsoft SharePoint Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经身份验证的攻击者通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 目标系统需要运行受影响版本的 SharePoint Server，且攻击者需要能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中的远程代码执行漏洞，源于对不可信数据的反序列化。漏洞利用方式如下：

1.  **获取必要信息：** 攻击者需要从 SharePoint 页面获取`__VIEWSTATE`、`__VIEWSTATEGENERATOR`和`__EVENTVALIDATION`。这些值可以通过查看页面源代码获得。
2.  **上传 Webshell：**  POC代码使用这些参数通过ToolPane.aspx上传一个名为`spinstall0.aspx`的webshell。
3.  **执行命令：**  上传webshell后，攻击者可以通过访问该webshell（`/_layouts/15/spinstall0.aspx`）并传递 `cmd` 参数来执行任意命令。POC代码支持直接执行命令，或者利用PowerShell反弹shell。

**有效性：**  根据漏洞库信息、搜索结果（提到该漏洞已在野外被利用）以及提供的POC代码，可以判断此POC**有效**，能够实现远程代码执行。

**投毒风险：**
*   虽然提供的代码可以直接利用漏洞执行命令，但从代码层面看，其主要功能集中于漏洞利用本身。 
*  webshell文件(`/spinstall0.aspx`)被上传后，如果权限配置不当，可能被其他攻击者利用，从而扩大攻击面。
*   该POC中`rev_ps_payload`函数用于生成PowerShell反弹shell的payload，如果被滥用，会造成大量恶意连接，但这不是POC的投毒，是使用者的滥用。

综合判断，该POC的投毒风险较低，约为**10%**。风险主要来源于webshell被滥用。

**利用方式总结：**

1.  攻击者利用反序列化漏洞，通过`ToolPane.aspx`页面上传webshell(`spinstall0.aspx`)。
2.  攻击者通过访问webshell，并在URL参数中指定要执行的命令，实现远程代码执行。
3.  POC代码支持执行简单命令、反弹shell、或者绑定shell。

**项目地址:** [GreenForceNetwork/Toolshell_CVE-2025-53770](https://github.com/GreenForceNetwork/Toolshell_CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)