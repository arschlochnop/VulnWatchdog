## CVE-2022-24086-Magento-RCE

**漏洞编号:** CVE-2022-24086

**漏洞类型:** 远程代码执行

**影响应用:** Magento Commerce

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** <= 2.4.3-p1 和 <= 2.3.7-p2

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-24086是Adobe Commerce（Magento）中的一个严重漏洞，由于在结账过程中存在不正确的输入验证，未经身份验证的远程攻击者可以通过构造恶意请求执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果，特别是[webpage 3]和[webpage 8]，已经确认该漏洞可以被利用，并且已经有实际攻击案例。提供的PoC代码（README.md中的图片）展示了成功执行任意代码的结果，表明PoC是有效的。

**投毒风险：**
提供的漏洞利用代码仅包含一个README.md文件，其中包含漏洞描述、PoC利用的截图和RCE结果的截图。风险点可能在于PoC的实际实现（代码未提供）。由于只提供了截图，没有实际可执行的Payload代码，可以初步判断投毒的可能性较低，但不能完全排除精心构造的图片链接本身包含恶意代码的可能。因为没有可执行的payload代码，所以即使存在投毒也无法造成实质性的影响，风险较低。推测投毒风险比例为10%。

**利用方式：**
1.  **漏洞触发点：** 漏洞存在于Magento的结账流程中，未经身份验证的攻击者可以利用该漏洞。
2.  **输入验证缺陷：** 由于Magento在结账流程中对输入数据验证不足，攻击者可以注入恶意代码。
3.  **远程代码执行：** 注入的恶意代码可以被Magento服务器执行，从而实现远程代码执行。
4.  **利用方式总结：** 攻击者通过构造恶意的HTTP请求，在结账过程中注入恶意代码，由于输入验证的缺失，该恶意代码被Magento服务器执行，最终导致远程代码执行。

**搜索引擎结果优先级分析：**
搜索引擎结果表明此漏洞是关键且广泛讨论的。漏洞细节、PoC创建以及实际攻击案例都已经公开，使得漏洞的利用更加容易。

**项目地址:** [nanaao/CVE-2022-24086-RCE](https://github.com/nanaao/CVE-2022-24086-RCE)

**漏洞详情:** [CVE-2022-24086](https://nvd.nist.gov/vuln/detail/CVE-2022-24086)