## CVE-2018-1002202 - zip4j Path Traversal

**漏洞编号:** CVE-2018-10022

**漏洞类型:** 路径遍历

**影响应用:** zip4j

**危害等级:** 高危，允许攻击者写入任意文件。

**影响版本:** < 1.3.3

**利用条件:** 需要能够控制zip文件的内容，例如上传zip文件到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-1002202 是 zip4j 库中版本低于 1.3.3 的一个路径遍历漏洞。根据提供的搜索引擎结果，该漏洞允许攻击者通过在 zip 压缩文件中包含 `../` 字符来写入任意文件。提供的漏洞利用代码包含 zip4j 1.3.2（易受攻击）和 1.3.3（已修复）的源代码，以及相关的构建文件（pom.xml）和许可证信息。通过对比1.3.2和1.3.3版本代码，可以验证该漏洞的存在。

**有效性：**根据提供的代码，此POC是有效的，因为它提供了易受攻击的zip4j 1.3.2源代码。

**投毒风险：**该仓库包含zip4j的decompiled代码以及maven配置。攻击者理论上可能修改这些代码，然后在不知情的用户使用这个仓库的代码进行构建时，引入恶意代码。虽然仓库提供了vulnerable和fixed两个tag，但如果攻击者修改了fixed版本的代码，并在用户构建时替换成修改后的版本，就可能造成投毒。因此，存在一定的投毒风险，约为10%。

**利用方式：**攻击者创建一个恶意的 zip 文件，其中包含带有 `../` 路径的文件条目。当应用程序使用易受攻击的 zip4j 版本解压此 zip 文件时，zip4j 没有正确地清理文件名，导致攻击者可以控制解压后的文件写入位置，从而写入任意文件。

**项目地址:** [shoucheng3/srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2](https://github.com/shoucheng3/srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2)

**漏洞详情:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)