## CVE-2024-10220

**漏洞编号:** CVE-2024-10220

**漏洞类型:** 任意命令执行

**影响应用:** kubelet

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 1.28.11, 1.29.0 <= version <= 1.29.6, 1.30.0 <= version <= 1.30.2

**利用条件:** 需要能够创建包含恶意gitRepo卷的Pod

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10220 漏洞存在于 Kubernetes kubelet 组件中，允许攻击者通过特制的 gitRepo 卷执行任意命令。

**漏洞利用方式：**
攻击者可以创建一个包含 gitRepo 卷的 Pod，并在该卷的初始化过程中执行恶意代码。利用的关键在于 gitRepo 卷会执行 `.git/hooks/post-checkout` 脚本。

**POC 分析：**
POC 代码包含两个文件：
1.  `README.md`:  提供 POC 的基本信息。
2.  `hooks/post-checkout`:  这是一个 shell 脚本，会在 `git checkout` 操作后执行。该脚本将 `id` 命令的输出写入 `/tmp/poc` 文件。

**有效性：**
该 POC 代码是有效的，只要 kubelet 的版本在受影响的范围内，并且攻击者能够创建包含恶意 gitRepo 卷的 Pod，就能成功执行任意命令。

**投毒风险：**
提供的 POC 代码非常简单，仅仅执行 `id` 命令并将输出写入文件，没有发现任何隐藏的恶意代码。因此，投毒风险为 0%。

**总结：**
攻击者创建一个包含gitRepo卷的pod，并指定一个包含恶意`.git/hooks/post-checkout`脚本的Git仓库，当kubelet拉取代码时，会执行此脚本，从而造成任意命令执行。

**项目地址:** [candranapits/poc-CVE-2024-10220](https://github.com/candranapits/poc-CVE-2024-10220)

**漏洞详情:** [CVE-2024-10220](https://nvd.nist.gov/vuln/detail/CVE-2024-10220)