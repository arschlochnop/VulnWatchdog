## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，为进一步攻击提供信息

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中存在的一个功能，该功能会将参数中以'@'字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  攻击者通过HTTP、WebSocket或SSH与Jenkins CLI接口进行交互。
2.  攻击者构造包含`@/path/to/target/file`的命令参数，其中`/path/to/target/file`是目标文件在Jenkins服务器上的路径。
3.  Jenkins CLI解析器将`@/path/to/target/file`替换为目标文件的内容。
4.  Jenkins服务器将目标文件的内容返回给攻击者。

**POC有效性：**

提供的Python POC代码有效。它包含以下关键功能：

*   参数解析：使用`argparse`模块解析命令行参数，如目标URL、文件路径、代理设置等。
*   版本检测：通过检查HTTP响应头中的`X-Jenkins`字段来确定Jenkins的版本，并判断目标是否在受影响的版本范围内。
*   漏洞利用：构造包含`@/path/to/target/file`的payload，并通过HTTP请求发送到Jenkins服务器。
*   结果解析：从服务器响应中提取目标文件的内容，并进行展示。

**投毒风险分析：**

该POC代码主要目的是验证和利用漏洞，并未发现明显的恶意代码或后门。代码结构清晰，功能明确，主要操作是发送HTTP请求并解析响应。风险点在于，运行此脚本需要提供Jenkins服务器的URL和要读取的文件路径。如果恶意用户使用此脚本读取敏感文件，则可能造成信息泄露。

投毒风险评估：1%

*   **代码逻辑：** 代码执行的是读取任意文件的功能，并没有植入后门的操作。 *   **目的性：** 脚本作者的目的是为了实现漏洞利用，而不是植入恶意代码。 *   **第三方库：** 代码使用了一些常见的第三方库，如`requests`、`urllib3`和`packaging`，这些库本身没有明显的安全问题。即使这些库存在潜在的安全问题，也与投毒无关。 *  **依赖风险:** 依赖的第三方库可能会存在安全隐患,但该风险与投毒风险不同. 

**项目地址:** [cc3305/CVE-2024-23897](https://github.com/cc3305/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)