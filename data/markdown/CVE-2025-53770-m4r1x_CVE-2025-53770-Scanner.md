## CVE-2025-53770-SharePoint-反序列化RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化RCE

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要目标SharePoint服务器可访问，利用代码需根据具体反序列化链构造。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，源于对不可信数据的反序列化。根据漏洞信息，该漏洞已被在野利用，并且CISA已将其添加到已知被利用的漏洞目录中。该漏洞影响 SharePoint Server 2016, SharePoint Server 2019 和 SharePoint Server Subscription Edition（版本低于 16.0.18526.20508）。

**有效性分析：**
提供的PoC代码是一个扫描器，主要用于检测目标SharePoint实例是否存在CVE-2025-53770漏洞，通过发送特制的HTTP请求并分析响应来判断。虽然该代码本身不是完整的利用代码，但它可以帮助安全专业人员识别潜在的漏洞暴露面，为后续的漏洞利用提供依据。根据搜索结果，该漏洞已被积极利用，因此，如果扫描器能准确识别漏洞，则可以认为PoC具有一定的有效性。但是，需要注意的是，仅仅识别漏洞存在是不够的，还需要进一步利用才能实现远程代码执行。

**投毒风险分析：**
检查提供的代码，尤其是 `spScanner.py`，发现其导入了一些库，如 `requests`, `urllib3`, `subprocess` 等。`requirements.txt` 文件列出了 `rich`, `requests`, `sublist3r`。  虽然 `requests` 是常用的 HTTP 客户端库，但 `sublist3r` 主要用于子域名枚举。  虽然这些库本身没有明显的恶意行为，但如果 `spScanner.py` 中存在以下情况，则存在投毒的可能：

1.  **恶意代码注入：**  在扫描器逻辑中，如果代码会执行外部命令（例如，通过 `subprocess` 模块），且命令的参数受到用户输入的影响，则可能存在命令注入漏洞。攻击者可以利用此漏洞执行任意命令。
2.  **数据回传：**  扫描器可能会收集目标 SharePoint 实例的信息，如果未经授权将这些信息发送到外部服务器，则可能存在隐私泄露风险。
3.  **依赖项劫持：** 虽然提供的依赖项看起来没问题，但如果仓库所有者在其他地方提供恶意依赖项（例如，通过 PyPI），诱导用户安装，则存在供应链攻击的风险。

基于以上分析，虽然目前提供的代码段没有发现明显的投毒行为，但仍需仔细审查 `spScanner.py` 的全部逻辑，特别是与网络请求、命令执行和数据处理相关的部分。 同时需要警惕仓库维护者在其他地方（如PyPI）是否存在恶意行为。考虑到漏洞扫描器可能收集敏感信息并存在潜在的命令执行风险，因此判断投毒风险为 30%。

**利用方式分析：**
根据漏洞库信息和搜索结果，CVE-2025-53770是由于SharePoint Server在处理不可信数据反序列化时存在缺陷导致的远程代码执行漏洞。攻击者可以通过构造恶意的序列化数据，诱使SharePoint Server进行反序列化操作，从而在服务器上执行任意代码。具体的利用方式可能涉及以下步骤：

1.  **识别漏洞入口点：** 找到SharePoint Server中处理序列化数据的接口或组件。
2.  **构造恶意序列化数据：** 使用特定的序列化格式（例如，.NET BinaryFormatter）构造包含恶意代码的序列化数据。该恶意代码可以执行任意系统命令，例如，下载并执行恶意程序。
3.  **发送恶意请求：** 将构造的恶意序列化数据作为请求的一部分发送到SharePoint Server的漏洞入口点。
4.  **触发反序列化：** 触发SharePoint Server对接收到的序列化数据进行反序列化操作。
5.  **执行恶意代码：** 反序列化过程会导致恶意代码在服务器上执行，从而实现远程代码执行。

由于该漏洞是反序列化漏洞，因此可能需要深入了解SharePoint Server的内部结构和使用的序列化机制，才能成功构造出可利用的payload。

**项目地址:** [m4r1x/CVE-2025-53770-Scanner](https://github.com/m4r1x/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)