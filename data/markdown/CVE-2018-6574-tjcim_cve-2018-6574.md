## CVE-2018-6574-Go远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 受害者需要使用存在漏洞的Go版本，并通过`go get`命令获取包含恶意代码的包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 允许在源代码构建期间执行远程命令。这是因为 Go 在处理 gcc 或 clang 插件功能时，未阻止 `-fplugin=` 和 `-plugin=` 参数。攻击者可以创建一个包含恶意代码的 Go 包，该代码利用这些参数在构建时执行任意命令。提供的 POC 代码通过创建一个共享对象 (`attack.so`)，其中包含一个在加载时执行 `sleep 10` 命令的构造函数。`main.go` 文件使用 `#cgo CFLAGS: -fplugin=./attack.so` 指令，在构建时加载该共享对象，从而触发恶意代码的执行。漏洞利用方式是诱使用户使用易受攻击的 Go 版本 `go get` 命令下载并构建包含恶意 `#cgo` 指令的包。由于POC代码明确定义了执行的命令和利用方式，没有发现隐藏的恶意代码，因此投毒风险评估为0%。

**项目地址:** [tjcim/cve-2018-6574](https://github.com/tjcim/cve-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)