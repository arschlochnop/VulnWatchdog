## CVE-2020-17519 - Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink JobManager的REST接口对外开放且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519是Apache Flink 1.11.0到1.11.2版本中的一个目录遍历漏洞。攻击者可以通过构造特殊的URL，利用JobManager的REST接口读取JobManager进程有权访问的本地文件系统上的任意文件。该漏洞无需身份验证即可利用。利用方式如下：

1.  确定目标Flink JobManager的REST接口地址和端口。
2.  构造包含目录遍历字符的URL，例如`http://<flink_jobmanager_host>:<flink_jobmanager_port>/jobmanager/logs/..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`，其中`..%2F`用于向上遍历目录。
3.  发送HTTP GET请求到构造的URL。
4.  如果目标存在漏洞，服务器将返回请求的文件内容。

根据提供的Metasploit模块`auxiliary/scanner/http/apache_flink_file_read`，攻击者可以通过设置`RHOSTS`（目标主机）、`RPORT`（目标端口）、`FILEPATH`（要读取的文件路径）和`DEPTH`（目录遍历深度）来利用该漏洞。提供的代码示例演示了如何读取`/etc/passwd`文件。

分析提供的POC代码，没有发现明显的投毒代码。该代码的功能仅限于扫描和利用已知的目录遍历漏洞来读取文件。所有操作都旨在利用漏洞，不存在额外植入后门或恶意行为的逻辑。

**项目地址:** [dev-team-12x/CVE-2020-17519](https://github.com/dev-team-12x/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)