## CVE-2020-3452 Cisco ASA/FTD 路径遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 路径遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用 WebVPN 或 AnyConnect 功能，且存在可访问的web服务接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-3452 是一个存在于 Cisco ASA 和 FTD 软件中的路径遍历漏洞。由于对 HTTP 请求中的 URL 缺乏适当的输入验证，未经身份验证的远程攻击者可以利用此漏洞读取设备上的敏感文件。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的 POC 代码，可以判断该漏洞是有效的。CISA的已知漏洞利用目录中也包含此漏洞。

**投毒风险分析：**
提供的 POC 代码主要功能是利用路径遍历漏洞下载指定的文件列表。代码中存在少量投毒风险的可能性，比如：
*   **文件列表：** 攻击者可能会修改`files`列表，添加一些原本不应该被读取的、更敏感的文件路径，但这种修改只是为了扩大攻击范围，不属于传统意义上的投毒。
*   **输出文件处理：** 代码将下载的文件直接写入磁盘，如果磁盘空间不足，可能导致拒绝服务。或者，如果攻击者修改代码，将下载的文件发送到外部服务器，则可能造成数据泄露。
*   **异常处理：** `try...except` 块捕获所有异常，可能隐藏了某些错误信息，不利于调试和发现潜在问题。

综合评估，该POC代码的主要目的是利用漏洞进行信息泄露，而非进行恶意投毒攻击。 但考虑到代码的开源性质，任何人都可以修改并添加恶意功能，因此仍然存在一定的投毒风险，但这种风险主要来源于使用者而非作者。 将 `poison` 值设为 5% 考虑到了人为修改恶意代码的可能性,代码本身更多的是验证漏洞,如果人为修改,则存在投毒的可能性. 

**利用方式：**
1.  **目标确认：** 确认目标 Cisco ASA/FTD 设备启用了 WebVPN 或 AnyConnect 功能。
2.  **版本判断：** 确认目标设备的 ASA/FTD 软件版本在受影响的范围内。
3.  **发送恶意 HTTP 请求：** 使用 POC 代码，向目标设备的 web 服务接口发送包含路径遍历字符序列的特制 HTTP 请求。
4.  **读取敏感文件：** 成功利用漏洞后，攻击者可以读取 web 服务文件系统中的任意文件，例如配置文件、日志文件等。

**缓解措施：**
*   升级到不受影响的 ASA/FTD 软件版本。
*   禁用 WebVPN 或 AnyConnect 功能（如果不需要）。
*   配置适当的访问控制策略，限制对 web 服务接口的访问。

**项目地址:** [cygenta/CVE-2020-3452](https://github.com/cygenta/CVE-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)