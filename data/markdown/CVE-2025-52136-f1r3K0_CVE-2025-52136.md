## CVE-2025-52136-EMQX-插件安装RCE

**漏洞编号:** CVE-2025-52136

**漏洞类型:** 远程代码执行

**影响应用:** EMQX

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.8.6

**利用条件:** 需要管理员权限访问EMQX Dashboard Web界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-52136 允许 EMQX 管理员通过 Dashboard Web 界面安装任意插件。在 5.8.6 之前的版本中，EMQX 没有对插件的来源和内容进行充分的验证，这意味着恶意攻击者可以创建一个包含恶意代码的插件，并诱导管理员安装它。安装后，恶意代码即可在 EMQX 服务器上执行。

**有效性分析：**

根据提供的漏洞信息和利用代码，该漏洞的利用方式是通过 EMQX Dashboard 安装恶意插件实现远程代码执行。提供的代码包含了一个 MQTT 代理，这个代理的功能是订阅一个 MQTT topic (`rx/cmd`)，收到消息后，执行消息内容作为 shell 命令，并将命令执行结果通过另一个 topic (`tx/cmd`) 发布出去。该代理程序本身并没有直接利用 CVE-2025-52136 漏洞，但可以作为恶意插件的一部分，在插件被安装后执行任意命令。由于漏洞描述表明在 EMQX 5.8.6 之前版本中，未经授权的插件可以被安装，因此提供的 MQTT 代理可以被打包进恶意插件，并在 EMQX 服务器上部署和运行。

**投毒风险分析：**

查看提供的文件列表，主要包含以下内容：

*   `LICENSE`：MIT 许可证，表明代码是开源的。
*   `README.md`：包含漏洞 CVE 编号和简单描述“不出网EMQX利用”，描述信息表明此POC不需要出网。
*   `mqtt_agent/agent.go`：Go 语言编写的 MQTT 代理，订阅 `rx/cmd` 主题，执行收到的命令，并将结果发布到 `tx/cmd` 主题。
*   `mqtt_agent/go.mod` 和 `mqtt_agent/go.sum`：Go 模块依赖管理文件。

分析代码后，没有发现明显的恶意代码或后门。MQTT 代理本身只是一个命令执行器，它的安全性完全取决于通过 MQTT 发送的命令。虽然存在被滥用的可能，但不能将其本身视为投毒代码。综上所述，此仓库中作者隐藏投毒代码的可能性较低。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 EMQX 插件，该插件包含 `mqtt_agent/agent.go`编译后的二进制文件。
2.  攻击者利用 CVE-2025-52136 漏洞，通过 EMQX Dashboard Web 界面上传并安装恶意插件。
3.  插件安装后，MQTT 代理开始运行，并连接到 EMQX MQTT Broker。
4.  攻击者向 `rx/cmd` 主题发送包含恶意命令的消息。
5.  MQTT 代理执行恶意命令，并将结果通过 `tx/cmd` 主题发送给攻击者。

此利用方式可以在 EMQX 服务器上实现远程代码执行。

**项目地址:** [f1r3K0/CVE-2025-52136](https://github.com/f1r3K0/CVE-2025-52136)

**漏洞详情:** [CVE-2025-52136](https://nvd.nist.gov/vuln/detail/CVE-2025-52136)