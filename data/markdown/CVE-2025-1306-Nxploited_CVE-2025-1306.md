## CVE-2025-1306-Newscrunch-CSRF to Arbitrary File Upload

**漏洞编号:** CVE-2025-1306

**漏洞类型:** CSRF to Arbitrary File Upload

**影响应用:** Newscrunch WordPress Theme

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.8.4

**利用条件:** 需要诱骗已登录的管理员点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1306是Newscrunch WordPress主题中的一个跨站请求伪造（CSRF）漏洞，影响版本<= 1.8.4。漏洞存在于`newscrunch_install_and_activate_plugin()`函数中，由于缺少nonce验证，未经身份验证的攻击者可以诱骗已登录的管理员访问恶意链接，从而上传任意文件到服务器。攻击者可以通过上传包含恶意代码的ZIP文件（例如webshell）来实现远程代码执行。

**漏洞利用方式：**
1.  攻击者构造包含恶意请求的HTML页面。该页面包含一个自动提交的form，目标是WordPress站点的`admin-ajax.php`，并设置`action=newscrunch_install_activate_plugin`。
2.  攻击者将`plugin_url`参数设置为指向托管在攻击者服务器上的恶意ZIP文件（webshell）。
3.  攻击者诱骗已登录的WordPress管理员访问此HTML页面。
4.  当管理员访问该页面时，页面会自动向WordPress站点发送POST请求，指示其安装并激活指定的插件（恶意ZIP文件）。
5.  WordPress站点会从攻击者服务器下载恶意ZIP文件，并将其解压到`wp-content/plugins/`目录下。
6.  攻击者可以通过访问上传的webshell来执行任意代码，例如`http://target.com/wp-content/plugins/shell.php?cmd=whoami`。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此POC代码是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，POC代码提供了可行的利用方法。

**投毒风险：**
该漏洞利用代码主要由一个HTML文件和一个简单的PHP webshell组成。HTML文件用于构造CSRF攻击，PHP webshell用于远程代码执行。代码本身看起来比较简单，主要风险在于`http://attacker.com/shell.zip`指向的恶意ZIP文件的内容。虽然目前提供的webshell是直接执行`$_GET['cmd']`，但攻击者可以替换成更隐蔽和更具破坏性的代码。此外，HTML文件中自动提交表单的操作也可能被利用，例如，可以加入定时操作或其他恶意的JavaScript代码。因此，存在较低的投毒风险（5%）。风险点在于被上传的ZIP文件可能包含更隐蔽的后门代码，以及HTML页面可能存在其他恶意JavaScript行为。

**项目地址:** [Nxploited/CVE-2025-1306](https://github.com/Nxploited/CVE-2025-1306)

**漏洞详情:** [CVE-2025-1306](https://nvd.nist.gov/vuln/detail/CVE-2025-1306)