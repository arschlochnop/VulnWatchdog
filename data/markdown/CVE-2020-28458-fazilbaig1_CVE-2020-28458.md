## CVE-2020-28458-datatables.net-Prototype Pollution

**漏洞编号:** CVE-2020-28458

**漏洞类型:** Prototype Pollution

**影响应用:** datatables.net

**危害等级:** 中危，可能导致拒绝服务和客户端代码执行

**影响版本:** All versions

**利用条件:** 需要目标网站使用受影响的 datatables.net 库，并且允许用户输入影响库的行为。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 datatables.net 库中，由于对之前的漏洞修复不完全导致Prototype Pollution。攻击者可以通过发送恶意的参数污染 JavaScript 原型链，可能导致拒绝服务或客户端代码执行。

**有效性分析：**
提供的漏洞扫描器 (`CVE-2020-28458_scanner_.py`) 旨在检测目标 URL 上是否使用了 DataTables 库，并确定其版本。如果检测到的版本低于 1.10.23，则认为易受攻击。此脚本可以帮助确认漏洞是否存在。
提供的 `exploit.py` 尝试通过向目标 URL 发送带有特定 payload 的 POST 请求来利用原型污染漏洞。该 payload 旨在污染 `__proto__` 对象的 `constructor` 属性，并定义一个名为 `polluted` 的新属性。

根据漏洞库信息和搜索结果，此漏洞确实存在并且已经被广泛研究。`_fnSetObjectDataFn` 函数存在漏洞。

**投毒风险分析：**
此仓库存在少量投毒风险 (10%)。`exploit.py` 中利用 Prototype Pollution 的方式比较直接，风险较低。主要风险在于：

*   `exploit.py` 中的 payload，如果目标网站存在其他漏洞或者使用了不安全的模板引擎，payload本身有可能造成其他的安全问题。
*   理论上仓库维护者可以在扫描脚本或利用脚本中添加恶意代码，例如回连服务器，搜集信息等。但这需要人为分析脚本才能判断。

总体而言，该仓库投毒的可能性较低，主要是一些潜在的利用脚本可能存在风险。

**利用方式：**
1.  使用 `CVE-2020-28458_scanner_.py` 脚本检测目标网站是否使用了存在漏洞的 datatables.net 库。
2.  如果确认目标使用了受影响的版本，使用 `exploit.py` 脚本发送包含恶意 payload 的 POST 请求。Payload 会尝试污染 JavaScript 原型链。
3.  如果利用成功，攻击者可以在客户端执行任意 JavaScript 代码或导致拒绝服务。

**项目地址:** [fazilbaig1/CVE-2020-28458](https://github.com/fazilbaig1/CVE-2020-28458)

**漏洞详情:** [CVE-2020-28458](https://nvd.nist.gov/vuln/detail/CVE-2020-28458)