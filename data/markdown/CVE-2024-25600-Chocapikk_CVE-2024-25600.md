## CVE-2024-25600-Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 需要目标站点安装了Bricks Builder插件并且版本低于或等于1.9.6,无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600是WordPress Bricks Builder插件中的一个代码注入漏洞，允许未经身份验证的攻击者执行任意代码。漏洞存在于插件处理用户输入的方式中，攻击者可以通过构造恶意的请求，向`wp-json/bricks/v1/render_element`端点发送包含恶意PHP代码的POST请求，从而在目标服务器上执行任意代码。提供的漏洞利用代码包含多种payload类型（generic, carousel, container, code），并支持交互模式和批量模式，可以自动化利用该漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开披露。提供的漏洞利用代码基于公开的POC，可以有效利用该漏洞。

**投毒风险：**
分析`exploit.py`脚本, 发现以下潜在风险:
1. 脚本通过requests库发送HTTP请求，存在中间人攻击的风险。
2. 脚本支持执行任意命令，如果被恶意修改，可能导致攻击者在目标服务器上执行恶意代码。
3. 脚本依赖第三方库，这些库可能存在安全漏洞。

综上所述，该漏洞利用代码存在一定的投毒风险，概率为10%。用户在使用该代码时，应仔细审查代码，确保其安全性。

**利用方式：**
1.  **获取Nonce：** 攻击者首先需要从目标网站获取一个nonce值。Nonce用于验证请求的合法性，但可以通过查看页面源代码等方式获取。
2.  **构造恶意请求：** 攻击者构造一个POST请求，发送到`/wp-json/bricks/v1/render_element`端点。请求的body包含一个JSON对象，其中包含`postId`，`nonce`，和`element`字段。
3.  **代码注入：** `element`字段的`settings`中包含恶意的PHP代码。例如，在`queryEditor`或`code`字段中插入`<?php system($_GET['cmd']); ?>`之类的代码。
4.  **执行代码：** 当Bricks Builder插件处理这个请求时，会执行注入的PHP代码，从而允许攻击者在目标服务器上执行任意命令。

总体来说，利用方式简单，无需身份验证，危害性高。

**项目地址:** [Chocapikk/CVE-2024-25600](https://github.com/Chocapikk/CVE-2024-25600)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)