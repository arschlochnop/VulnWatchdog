## CVE-2023-25690-Apache HTTP Server-HTTP Request Smuggling

**漏洞编号:** CVE-2023-25690

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致绕过访问控制、代理到非预期URL以及缓存投毒

**影响版本:** 2.4.0 <= version <= 2.4.55

**利用条件:** mod_proxy启用，同时存在RewriteRule或ProxyPassMatch，且规则中包含非特定模式匹配用户提供的URL数据，并使用变量替换将数据重新插入代理的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25690 漏洞是 Apache HTTP Server 2.4.0 到 2.4.55 版本中的一个 HTTP 请求走私漏洞。该漏洞出现在 `mod_proxy` 模块的配置中，当启用 `mod_proxy` 并且配置了 `RewriteRule` 或 `ProxyPassMatch` 指令时，如果这些指令使用非特定的模式匹配用户提供的 URL 数据，并且将匹配到的数据通过变量替换的方式重新插入到代理的 URL 中，就可能导致 HTTP 请求走私。

**有效性：**
提供的 POC 代码看起来是有效的。它展示了如何设置一个存在漏洞的 Apache 环境，并且描述了如何通过构造恶意的 HTTP 请求来触发请求走私。

**投毒风险：**
此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。

理由：

*   代码主要集中在漏洞的复现和演示上，没有明显的恶意代码。
*   `docker-compose.yml` 文件描述了服务的构建方式，可以进行安全审查。
*   `httpd.conf` 配置文件定义了 Apache 的行为，可以检查是否存在恶意配置。
*   `categories.php` 和 `index.php` 是后端示例代码，需要仔细检查是否存在后门。
*    README.md主要解释漏洞和搭建步骤，投毒者可能利用dockerfile进行投毒，添加恶意的指令，以及修改php文件加入恶意代码。

需要注意的是，虽然目前看来投毒风险较低，但在实际使用任何第三方代码时，都应该进行彻底的安全审查。

**利用方式：**
1.  **配置 vulnerable 的 Apache 环境：** 需要满足漏洞描述中的条件，即启用 `mod_proxy`，并配置存在漏洞的 `RewriteRule` 或 `ProxyPassMatch`。
2.  **构造恶意的 HTTP 请求：**  利用 CRLF 注入，将多个 HTTP 请求组合成一个请求发送给代理服务器。
3.  **请求走私：**  代理服务器由于解析错误，会将一个请求的一部分错误地当成是另一个请求，从而实现请求走私。
4.  **攻击目标：**  通过请求走私，可以绕过访问控制，代理到非预期的 URL，或者进行缓存投毒。

**项目地址:** [oOCyginXOo/CVE-2023-25690-POC](https://github.com/oOCyginXOo/CVE-2023-25690-POC)

**漏洞详情:** [CVE-2023-25690](https://nvd.nist.gov/vuln/detail/CVE-2023-25690)