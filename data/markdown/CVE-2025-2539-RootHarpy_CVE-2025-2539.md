## CVE-2025-2539 - File Away WordPress插件未授权任意文件读取

**漏洞编号:** CVE-2025-2539

**漏洞类型:** 任意文件读取

**影响应用:** File Away WordPress插件

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 3.9.9.0.1

**利用条件:** 目标网站安装了File Away插件，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-2539存在于File Away WordPress插件中，由于ajax()函数缺少权限检查，导致未经身份验证的攻击者可以读取服务器上的任意文件。 

**利用方式：**

1.  攻击者首先通过访问目标网站获取nonce值。 PoC代码中的`get_nonce`函数通过正则匹配网页源代码中的`fileaway_stats`变量，提取nonce值。
2.  攻击者构造一个包含`action`、`nonce`和`file`参数的POST请求，发送到`wp-admin/admin-ajax.php`。其中，`action`设置为`fileaway-stats`，`nonce`为第一步获取的值，`file`为要读取的文件路径。PoC代码中的`exploit`函数构造并发送了这个请求。
3.  如果nonce有效，服务器将返回包含文件URL的响应。 PoC代码会提取并打印返回的URL。

**有效性：**

根据漏洞描述和提供的POC代码，该漏洞利用是有效的。漏洞库信息明确指出该插件存在未授权的任意文件读取漏洞，POC代码实现了利用该漏洞读取任意文件的功能。

**投毒风险：**

该仓库中的投毒风险较低，约为5%。

*   **恶意代码：**虽然整体代码的目的是为了实现漏洞利用，但存在潜在的植入恶意后门代码的可能性。
*   **请求劫持风险：** PoC使用了requests库发送HTTP请求，requests库本身不存在明显恶意行为，但理论上存在中间人攻击的风险，攻击者可能通过篡改请求或响应来获取敏感信息或植入恶意代码（依赖使用者网络环境）。
*   **第三方库风险：** requests库存在版本更新，版本更新可能因为兼容性或者其他问题导致PoC无法使用, 无法验证的风险。

总体而言，该POC的主要风险在于其自身的利用能力，而非作者植入的恶意代码。但仍然需要保持警惕，确保从可信来源获取代码，并在受控环境中运行。

**项目地址:** [RootHarpy/CVE-2025-2539](https://github.com/RootHarpy/CVE-2025-2539)

**漏洞详情:** [CVE-2025-2539](https://nvd.nist.gov/vuln/detail/CVE-2025-2539)