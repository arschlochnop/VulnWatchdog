## CVE-2025-21692-Linux内核ETS qdisc OOB索引漏洞

**漏洞编号:** CVE-2025-21692

**漏洞类型:** 越界读取/写入

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux kernel 5.6 直到修复版本 (不包括 5.10.234, 5.15.178, 6.1.128, 6.6.75, 6.12.12, 6.13.1, 6.14)

**利用条件:** 本地用户，需要能够配置网络流量控制（tc）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21692是Linux内核中ETS（Enhanced Transmission Selection）qdisc（queueing discipline）组件中的一个越界索引漏洞。当传递clid为0时，ets_class_from_arg()函数可以索引ets_class数组之外的内存，导致越界读取或写入。这可能导致本地权限提升。

**漏洞利用方式:**

1.  利用该漏洞需要使用`tc`命令配置ETS qdisc。具体来说，攻击者可以构造一个特殊的`tc`命令，该命令传递一个`clid`值为0。这个值随后被传递到`ets_class_from_arg`函数。
2.  `ets_class_from_arg`函数使用`clid`值作为索引来访问`ets_class`数组。由于没有正确的验证，当`clid`是0时，它可能导致索引到数组范围之外的位置。
3.  越界访问允许攻击者读取或写入内核内存，从而可能导致权限提升。

**有效性评估:**

根据漏洞信息和搜索引擎结果，该漏洞是一个真实存在的本地权限提升漏洞，PoC代码已经可用，说明该漏洞利用具有可行性。

**投毒风险分析:**

PoC代码本身的主要目的是演示漏洞的利用。但是，PoC代码包含以下文件：

*   `README.md`: 描述了漏洞和利用方式，并提供了相关链接。
*   `compress.sh`: 一个用于创建initramfs的脚本。这个脚本本身没有明显的恶意行为，但恶意修改该脚本可以用于将后门程序注入到initramfs中。比如替换`gcc`命令执行恶意代码。
*   `config-vsock`: 看起来是一个内核配置，用于构建测试内核。同样恶意修改配置可以增加内核后门。

虽然核心利用代码看起来是良性的，但是`compress.sh`和`config-vsock`脚本存在被投毒的风险，比如向编译后的`initramfs`镜像中植入恶意代码。综合评估，投毒风险为10%。

**项目地址:** [volticks/CVE-2025-21692-poc](https://github.com/volticks/CVE-2025-21692-poc)

**漏洞详情:** [CVE-2025-21692](https://nvd.nist.gov/vuln/detail/CVE-2025-21692)