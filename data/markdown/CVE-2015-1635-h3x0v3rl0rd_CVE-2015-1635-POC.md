## CVE-2015-1635 - HTTP.sys 远程代码执行漏洞

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft HTTP.sys

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2

**利用条件:** 目标服务器运行受影响版本的Windows，并且开启了HTTP服务（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-1635 是一个存在于 Microsoft Windows HTTP.sys 中的远程代码执行漏洞。攻击者可以通过发送特制的 HTTP 请求到目标服务器来触发此漏洞。根据漏洞库信息，该漏洞影响 Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, 和 Windows Server 2012 Gold and R2。提供的漏洞利用代码（36773.c）是一个 PoC，它首先检查目标是否为 IIS 服务器，然后发送一个包含恶意 Range 头的 HTTP 请求。这个 Range 头包含一个非常大的字节范围，可能导致整数溢出，从而触发漏洞。如果服务器返回 "Requested Range Not Satisfiable"，则表明服务器存在漏洞。 

**有效性：**
PoC 代码看起来是有效的。它首先检查服务器是否是 Microsoft IIS，然后发送特制的 HTTP 请求来触发漏洞。根据返回的信息判断是否存在漏洞。

**投毒风险：**
查看提供的C代码，主要功能是建立socket连接，然后发送特定的http请求头。经过对漏洞验证代码的分析，未发现任何后门和恶意代码，因此投毒风险非常低。README.md只是对漏洞的说明和截图，没有可执行代码，投毒风险为0%。

**利用方式：**
1.  连接到目标服务器的 80 端口。
2.  发送一个 HTTP 请求，包含一个非法的 `Range` 头，`Range: bytes=0-18446744073709551615`。
3.  如果服务器没有打补丁，则会返回 "Requested Range Not Satisfiable"，某些情况下可能导致蓝屏或远程代码执行，但是给出的POC仅仅是探测是否存在该漏洞。

**项目地址:** [h3x0v3rl0rd/CVE-2015-1635-POC](https://github.com/h3x0v3rl0rd/CVE-2015-1635-POC)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)