## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者窃取 Net-NTLM 哈希，模拟受害者身份

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送特制的邮件，不需要用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以构造包含恶意的 `PidLidReminderFileParameter` 属性的电子邮件，当 Outlook 客户端处理这封邮件时，会尝试连接到攻击者控制的 UNC 路径，从而泄露用户的 Net-NTLMv2 哈希。由于 Outlook 会自动处理邮件，因此无需用户交互。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。漏洞利用的有效性较高。

**投毒风险：**
提供的代码是一个用于修补 CVE-2023-23397 的 PowerShell 脚本。脚本会检查系统上是否已安装相关的安全更新（KB5023696, KB5023706, KB5023702），如果未安装，则从 Microsoft Update Catalog 下载并安装。该脚本相对简单，主要用于自动安装补丁。但仍存在轻微投毒风险，例如脚本可能下载错误或恶意的更新文件（即使可能性较低），或者在特定系统配置下导致意外错误。因此，投毒风险评估为5%。

**利用方式：**
1.  **攻击者构造恶意邮件：** 攻击者创建一个包含恶意 `PidLidReminderFileParameter` 属性的电子邮件。该属性指向攻击者控制的 SMB 服务器。
2.  **受害者接收邮件：** 受害者使用受影响版本的 Microsoft Outlook 接收邮件。
3.  **Outlook 尝试连接：** Outlook 客户端自动处理邮件，并尝试连接到恶意邮件中指定的 UNC 路径。
4.  **NTLM 哈希泄露：** 受害者的 Net-NTLMv2 哈希被发送到攻击者控制的 SMB 服务器。
5.  **攻击者利用哈希：** 攻击者可以使用窃取的 NTLM 哈希进行 NTLM 中继攻击，从而模拟受害者身份并访问网络资源。

**项目地址:** [Zeppperoni/CVE-2023-23397-Patch](https://github.com/Zeppperoni/CVE-2023-23397-Patch)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)