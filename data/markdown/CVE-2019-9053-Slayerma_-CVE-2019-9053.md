## CVE-2019-9053 - CMS Made Simple SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入 (Blind Time-Based)

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和权限提升

**影响版本:** <= 2.2.9

**利用条件:** 需要能够访问存在漏洞的CMS Made Simple实例，并且News模块已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.8及之前版本中的一个未经身份验证的盲注Time-Based SQL注入漏洞。攻击者可以利用News模块，通过构造特制的URL，特别是`m1_idlist`参数，来执行SQL注入攻击。由于是Time-Based盲注，攻击者无法直接获取SQL查询结果，而是通过观察服务器响应时间来推断信息。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有可用的PoC代码。提供的PoC代码（exploit_2019.py）是一个Python脚本，旨在利用此漏洞。脚本通过构造包含`sleep()`函数的SQL注入payload来探测数据库内容，并根据响应时间判断注入是否成功。该脚本的作者也参考了Exploit-DB中的信息，增加了使用字典破解管理员密码的功能，进一步提高了漏洞的危害性。

**投毒风险：**

代码中存在一定的投毒风险，但可能性较低（10%）。主要基于以下几点考虑：

*   **依赖第三方库：** 脚本依赖`requests`和`termcolor`库，如果这些库被篡改，可能导致恶意行为。
*   **密码破解部分：** 虽然脚本包含密码破解功能，但这是漏洞利用的一部分，而非隐藏的恶意代码。密码破解依赖于用户提供的字典文件，如果用户使用恶意字典，可能会导致安全问题。
*   **作者信息和License：** 代码包含了作者信息和MIT License，这表明作者试图以开放和透明的方式分享代码。但是，不能完全排除作者在其他地方隐藏了恶意代码的可能性，虽然可能性较低。

**利用方式：**

1.  **目标确定：** 确定目标CMS Made Simple网站，并确认其版本小于等于2.2.9，并且News模块已启用。
2.  **漏洞触发：** 通过构造包含SQL注入payload的URL，访问`moduleinterface.php`，并修改`m1_idlist`参数。Payload中通常包含`sleep()`函数，用于进行Time-Based盲注。
3.  **数据提取：** 根据服务器响应时间，逐步提取数据库信息，如数据库名、用户名、密码哈希等。PoC代码自动化了这个过程。
4.  **密码破解（可选）：** 如果获取到密码哈希，可以使用字典破解工具（如John the Ripper或Hashcat）进行破解，或者使用PoC代码中提供的密码破解功能。
5.  **权限提升：** 成功获取管理员权限后，可以执行任意操作，如修改网站内容、上传恶意代码、甚至控制整个服务器。

**项目地址:** [Slayerma/-CVE-2019-9053](https://github.com/Slayerma/-CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)