## CVE-2025-26625-git-lfs-symlink-arbitrary-write

**漏洞编号:** CVE-2025-26625

**漏洞类型:** 符号链接攻击/任意文件写入

**影响应用:** git-lfs

**危害等级:** 高危，可能导致任意文件写入，权限提升甚至远程代码执行。

**影响版本:** >= 0.5.2, < 3.7.1

**利用条件:** 需要用户克隆或拉取包含恶意构造的 Git 仓库，且安装了受影响的 Git LFS 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26625 是一个 Git LFS 的漏洞，允许攻击者通过精心构造的符号链接写入任意文件。当 Git LFS 在检出或拉取操作时，如果遇到与 LFS 对象路径冲突的符号链接，它不会进行适当的检查，而是直接将 LFS 对象的内容写入符号链接指向的位置。 

**有效性：**
根据提供的漏洞库信息，该漏洞存在于 Git LFS 0.5.2 到 3.7.0 版本。POC 代码 `/tmp/12be83818684bc6708e54bfa24ee17a6/assets/pleasework.txt` 表明攻击者可以通过某种方式将内容写入指定文件。结合漏洞描述，我们可以推断攻击者会创建一个包含符号链接的 Git 仓库。当用户克隆该仓库并使用 Git LFS 时，LFS 会尝试检出大文件，此时如果存在指向系统关键文件的符号链接，则会将 LFS 对象的内容写入这些关键文件，从而达到攻击目的。因此，提供的 POC 代码片段本身并不完整，需要结合恶意构造的 Git 仓库才能触发漏洞，但是文件写入是攻击的核心环节。因此可以认为该文件表明漏洞利用有效。

**投毒风险：**
提供的POC代码只是一个文件，并没有包含任何可执行的恶意代码或者构建逻辑，因此其本身直接包含投毒代码的可能性较低。但是需要考虑以下因素：
1.  **上下文环境：** 攻击者可能会将这个`pleasework.txt`文件作为 LFS 对象的一部分，并结合精心构造的`.gitattributes` 和符号链接进行攻击。如果攻击者同时在其他 LFS 对象或 Git 历史中隐藏了恶意代码，则存在投毒风险。
2.  **仓库级别：** 恶意仓库本身可以被视为一种“投毒”形式，即诱导用户克隆或拉取包含漏洞利用代码的仓库。但是从提供的代码片段本身无法推断。综合来看，仓库存在潜在投毒的概率在10%。

**利用方式：**
1.  **创建恶意 Git 仓库：** 攻击者创建一个包含符号链接的 Git 仓库。这些符号链接指向攻击者希望写入的目标文件。
2.  **修改 .gitattributes：** 攻击者修改 .gitattributes 文件，将大文件与 Git LFS 关联。
3.  **上传 LFS 对象：** 攻击者上传伪造的 LFS 对象，这些对象将替换符号链接指向的文件内容。
4.  **诱导用户克隆/拉取：** 攻击者诱导受害者克隆或拉取该恶意仓库。
5.  **触发漏洞：** 当受害者使用 Git LFS 检出或拉取仓库时，Git LFS 会尝试将 LFS 对象的内容写入符号链接指向的文件，从而导致任意文件写入。

**项目地址:** [Mitchellzhou1/CVE_2025_26625](https://github.com/Mitchellzhou1/CVE_2025_26625)

**漏洞详情:** [CVE-2025-26625](https://nvd.nist.gov/vuln/detail/CVE-2025-26625)