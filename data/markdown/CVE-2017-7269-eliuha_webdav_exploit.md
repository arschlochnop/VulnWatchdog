## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的 ScStoragePathFromUrl 函数存在缓冲区溢出漏洞。攻击者可以通过发送特制的 PROPFIND 请求，并在请求头中包含一个以 “If: <http://” 开头的超长字符串，触发漏洞，导致缓冲区溢出，从而执行任意代码。提供的 exploit.py 脚本基于已公开的漏洞利用代码，通过构造包含大量 Unicode 字符的长 “If:” 头部的 PROPFIND 请求，发送到目标服务器的 WebDAV 服务，触发缓冲区溢出。由于缓冲区溢出发生在服务进程中，攻击者可以利用溢出覆盖内存中的返回地址，将程序执行流程重定向到攻击者控制的代码区域，从而实现远程代码执行。搜索引擎结果表明，该漏洞在野外被广泛利用，例如用于挖矿等恶意活动。该代码存在投毒风险较低，主要风险在于目标服务器必须存在漏洞。

**项目地址:** [eliuha/webdav_exploit](https://github.com/eliuha/webdav_exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)