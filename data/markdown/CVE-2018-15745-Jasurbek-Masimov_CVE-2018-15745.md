## CVE-2018-15745 - Argus Surveillance DVR 4.0.0.0 - Directory Traversal

**漏洞编号:** CVE-2018-15745

**漏洞类型:** 目录遍历/文件包含

**影响应用:** Argus Surveillance DVR

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 4.0.0.0

**利用条件:** 需要目标设备开启WEB服务，且漏洞存在于WEBACCOUNT.CGI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15745漏洞存在于Argus Surveillance DVR 4.0.0.0设备中，由于WEBACCOUNT.CGI处理RESULTPAGE参数时存在缺陷，攻击者可以通过在RESULTPAGE参数中使用`..%2F`进行目录遍历，从而读取任意文件。根据搜索引擎结果，该漏洞已经被积极利用。

**有效性分析：**
提供的POC代码是一个bash脚本，它接受目标IP地址、端口以及目标文件路径作为输入。脚本会对输入的路径进行URL编码，并通过构造包含目录遍历字符`..%2F`的GET请求，尝试读取目标文件。该POC代码直接利用了漏洞描述中提到的RESULTPAGE参数，利用方式简单直接，因此判断为有效。

**投毒风险分析：**
脚本本身的功能是发送HTTP请求并打印响应。脚本主要逻辑是处理用户输入的目录，对其进行编码，并构造payload。检查脚本内容，可以判断以下部分存在潜在风险：
*   **网络请求：**虽然curl命令是标准命令，但如果目标服务器存在恶意代码或配置不当，读取的文件可能包含恶意内容，从而间接对攻击者主机造成影响（例如，读取到的配置文件包含恶意脚本，被攻击者解析执行）。
*   **编码逻辑：**编码函数`ENCODED_DIRECTORY`，部分直接使用硬编码，其余的都采用字符的十六进制，但对于用户输入依然存在风险，例如用户输入了未编码的特殊字符，可能会导致命令执行错误。

总体来看，该脚本主要功能为文件读取，本身不具备恶意代码植入或执行能力。用户需要手动执行该脚本，并且可以查看脚本的全部代码。因此，可以判断该仓库存在一定投毒风险，但风险较低，判断投毒风险为10%。

**利用方式总结：**
1.  攻击者需要知道目标Argus Surveillance DVR设备的IP地址和端口。
2.  攻击者运行提供的exploit.sh脚本，输入目标IP地址、端口和目标文件路径。
3.  脚本会对目标文件路径进行URL编码，并构造包含目录遍历字符`..%2F`的GET请求。
4.  攻击者发送构造好的GET请求到目标设备的WEBACCOUNT.CGI接口。
5.  如果漏洞存在，目标设备会将目标文件的内容返回给攻击者。

**项目地址:** [Jasurbek-Masimov/CVE-2018-15745](https://github.com/Jasurbek-Masimov/CVE-2018-15745)

**漏洞详情:** [CVE-2018-15745](https://nvd.nist.gov/vuln/detail/CVE-2018-15745)