## CVE-2020-26217-XStream-远程代码执行

**漏洞编号:** CVE-2020-26217

**漏洞类型:** 远程代码执行

**影响应用:** XStream

**危害等级:** 高危，允许远程攻击者执行任意shell命令

**影响版本:** < 1.4.14

**利用条件:** 依赖于XStream处理恶意构造的XML输入流。用户依赖于黑名单而不是白名单时受影响，需要目标系统使用存在漏洞的XStream版本，并处理来自不受信任来源的XML数据。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-26217是XStream中的一个远程代码执行漏洞。攻击者可以通过构造恶意的XML数据，利用XStream反序列化漏洞执行任意shell命令。漏洞利用的关键在于XStream使用了黑名单机制来防御反序列化攻击，但是黑名单不完整，导致攻击者可以绕过黑名单，从而执行恶意代码。

**漏洞利用方式：**

1.  攻击者构造包含恶意代码的XML数据。
2.  目标应用程序使用存在漏洞的XStream版本解析该XML数据。
3.  XStream尝试反序列化XML数据中的对象。
4.  由于黑名单不完整，恶意类可以被实例化。
5.  恶意类的构造函数或方法被调用，执行任意shell命令。

**有效性：**

提供的文件BUILD.txt, LICENSE.txt, README.md, README.txt和SECURITY.md 看起来是XStream项目的基础文件，但没有提供直接的漏洞利用代码。考虑到搜索引擎结果描述了远程代码执行，且漏洞库信息也指出了通过操纵输入流可以执行任意shell命令，可以推断该漏洞是可利用的，POC是存在的。需要找到利用特定gadget chain的POC。

**投毒风险：**
提供的文件是XStream项目的构建说明，许可协议，readme和安全策略文档，这些文件本身不包含恶意代码。因此，当前信息无法判断是否存在投毒代码。但是，从软件供应链安全的角度来看，任何开源项目都存在被植入恶意代码的风险，需要进行代码审计才能确认是否存在投毒行为。这里给予1%的风险评估。

**项目地址:** [shoucheng3/x-stream__xstream_CVE-2020-26217_1-4-14-java7](https://github.com/shoucheng3/x-stream__xstream_CVE-2020-26217_1-4-14-java7)

**漏洞详情:** [CVE-2020-26217](https://nvd.nist.gov/vuln/detail/CVE-2020-26217)