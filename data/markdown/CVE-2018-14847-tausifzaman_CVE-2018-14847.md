## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)