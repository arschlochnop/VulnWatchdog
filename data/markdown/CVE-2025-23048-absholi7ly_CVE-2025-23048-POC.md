## CVE-2025-23048: Apache mod_ssl TLS 1.3 Session Resumption Client Certificate Bypass

**漏洞编号:** CVE-2025-23048

**漏洞类型:** 访问控制绕过

**影响应用:** Apache HTTP Server (mod_ssl)

**危害等级:** 高危，可能导致未经授权的访问敏感资源

**影响版本:** 2.4.35 <= version <= 2.4.63

**利用条件:** 需要Apache HTTP Server配置了多个虚拟主机，并且这些虚拟主机使用不同的客户端证书进行身份验证，同时没有启用SSLStrictSNIVHostCheck。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-23048漏洞存在于Apache HTTP Server的mod_ssl模块中。当配置了多个虚拟主机，每个虚拟主机使用不同的客户端证书进行身份验证时，攻击者可以通过TLS 1.3会话恢复绕过访问控制。如果客户端拥有访问一个虚拟主机的有效客户端证书，那么该客户端可以通过恢复TLS 1.3会话来访问另一个虚拟主机，即使该虚拟主机需要不同的证书颁发机构（CA）签发的证书。该漏洞的利用依赖于未启用`SSLStrictSNIVHostCheck`，这使得服务器无法正确验证SNI与客户端证书之间的关系。

**有效性：**
提供的PoC代码看起来是有效的。它详细描述了如何设置易受攻击的环境（Apache 2.4.57，但漏洞影响范围是2.4.35-2.4.63），并提供了分步说明来重现漏洞。

**投毒风险：**
PoC代码本身似乎不包含任何明显的投毒代码。它专注于演示漏洞利用。但是，始终存在风险：
*   **依赖项风险：** 指令要求从外部下载Apache，若下载源被篡改，下载的程序有可能被植入后门。
*   **配置风险：** 配置文件的细微更改可能导致安全风险，如果用户不仔细检查配置，可能会引入意外的漏洞。
因此，尽管PoC本身看起来干净，但环境搭建过程中仍然存在潜在的投毒风险，这里给出 10% 的投毒风险可能性。

**利用方式：**
1.  **环境设置：** 设置Apache HTTP Server 2.4.35到2.4.63之间的版本，并配置多个虚拟主机。确保每个虚拟主机使用不同的`SSLCACertificateFile`或`SSLCACertificatePath`来限制客户端证书。
2.  **禁用SSLStrictSNIVHostCheck：** 确保`SSLStrictSNIVHostCheck`未启用，或者设置为`off`。
3.  **获取有效证书：** 获取对其中一个虚拟主机有效的客户端证书。
4.  **建立TLS 1.3会话：** 使用有效证书与第一个虚拟主机建立TLS 1.3会话，并保存会话信息（session ticket）。
5.  **会话恢复：** 使用保存的会话信息尝试访问第二个虚拟主机。由于会话恢复绕过了证书验证，客户端将能够访问第二个虚拟主机，即使它没有第二个虚拟主机所需的有效证书。

简而言之，攻击者利用TLS 1.3会话恢复机制，绕过对虚拟主机证书的验证，从而获得未经授权的访问。

**项目地址:** [absholi7ly/CVE-2025-23048-POC](https://github.com/absholi7ly/CVE-2025-23048-POC)

**漏洞详情:** [CVE-2025-23048](https://nvd.nist.gov/vuln/detail/CVE-2025-23048)