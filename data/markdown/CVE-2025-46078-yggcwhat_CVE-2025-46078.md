## CVE-2025-46078-HuoCMS-任意文件写入

**漏洞编号:** CVE-2025-46078

**漏洞类型:** 任意文件写入

**影响应用:** HuoCMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <=V3.5.1

**利用条件:** 需要登录后台获取token

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于HuoCMS <=V3.5.1版本的附件上传功能中。攻击者可以通过`resource_temp_path`参数进行目录穿越，结合`chunk_index`参数控制文件名后缀，最终写入任意文件到服务器任意位置。利用需要先登录后台，获得有效的token，并在上传时设置`resource_temp_path`为包含目录穿越的路径，如`../../../public/storage/image/20250415/`。`chunk_index`设置为`.php`，`resource_chunk`随意填写内容，最终会在目标目录写入一个php文件，导致远程代码执行。虽然漏洞利用代码中没有明显的恶意代码，但存在一定的投毒风险，例如作者可能故意引导攻击者上传包含恶意代码的文件，或者服务器返回的URL包含后门程序。因此判断存在10%的投毒风险。

**项目地址:** [yggcwhat/CVE-2025-46078](https://github.com/yggcwhat/CVE-2025-46078)

**漏洞详情:** [CVE-2025-46078](https://nvd.nist.gov/vuln/detail/CVE-2025-46078)