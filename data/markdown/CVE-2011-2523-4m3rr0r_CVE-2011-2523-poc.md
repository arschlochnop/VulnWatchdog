## CVE-2011-2523-vsftpd-后门命令执行

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.4 (特定版本，20110630至20110703期间下载)

**利用条件:** 目标服务器运行受影响的vsftpd 2.3.4版本，并且端口21和6200开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523 漏洞是 vsftpd 2.3.4 版本中存在的一个后门，该版本在 2011 年 6 月 30 日至 2011 年 7 月 3 日期间被下载。该后门会在 6200/tcp 端口上打开一个 shell，允许未经授权的远程访问和命令执行。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用代码（`exploit.py`）的有效性较高。POC 代码首先验证目标服务器是否运行易受攻击的 vsftpd 2.3.4 版本，然后通过发送特制的用户名（`USER hello:)`）和密码（`PASS hello123`）来触发后门。成功触发后，它会尝试连接到目标计算机上的 6200 端口，从而获得 shell 访问权限。

**投毒风险：** 代码本身看起来直接利用已知的后门。但是，存在一些轻微的风险，可能存在投毒代码：
1.  **依赖项风险：**  `README.md` 文件中建议使用 `sudo python3 -m pip install pwntools` 安装 `pwntools`。 虽然 `pwntools` 是一个常用的渗透测试工具包，但从不受信任的来源安装依赖项始终存在风险。恶意作者可能会使用修改后的 `pwntools` 版本，其中包含额外的后门或恶意功能。 2.  **休眠后门：** 即使当前代码没有明显的恶意行为，作者也有可能添加将来可以激活的休眠后门或触发器。 这需要更深入的代码分析。

因此，虽然直接的利用代码看起来是干净的，但考虑到依赖关系和潜在的隐藏恶意代码，我将投毒风险评估为 10%。

**利用方式：**
1.  **版本验证：** 检查目标服务器上运行的 vsftpd 版本是否为易受攻击的 2.3.4 版本（特定时间段下载的版本）。
2.  **后门触发：** 向 FTP 服务器发送包含 `:)` 的用户名，例如 `USER hello:)`，然后再发送任意密码。
3.  **连接后门 Shell：** 连接到目标服务器的 6200 端口以获得 shell 访问权限。
4.  **命令执行：** 在获得的 shell 中执行任意命令。

**项目地址:** [4m3rr0r/CVE-2011-2523-poc](https://github.com/4m3rr0r/CVE-2011-2523-poc)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)