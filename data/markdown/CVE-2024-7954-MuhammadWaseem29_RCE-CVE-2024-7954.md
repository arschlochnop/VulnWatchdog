## CVE-2024-7954 - SPIP porte_plume 插件远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许远程未授权用户执行任意PHP代码

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本并安装了porte_plume插件，且允许POST请求到index.php?action=porte_plume_previsu

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 漏洞存在于 SPIP 的 porte_plume 插件中。未经身份验证的远程攻击者可以通过向 `index.php?action=porte_plume_previsu` 发送特制的 HTTP POST 请求来执行任意 PHP 代码。该漏洞允许攻击者在受影响的服务器上以 SPIP 用户的身份执行任意命令。 

**利用方式：**

攻击者发送一个包含恶意 `data` 参数的 POST 请求，该参数包含了要执行的 PHP 代码。POC 中提供的例子使用 `system()` 函数来执行系统命令。攻击者可以通过修改 `system()` 函数中的命令来执行任何 PHP 代码。

**投毒风险分析：**

提供的 POC 代码主要包含漏洞描述、利用方法和 Shodan 搜索语句。其中 `nuclei` 扫描工具配置和一个HTTP POST请求的例子,POST请求的data参数中包含PHP代码，此PHP代码功能为执行`cat /etc/passwd`命令。虽然利用本身具有一定风险，但就提供的代码本身而言，投毒风险较低。`nuclei` 本身需要先安装配置到目标系统。风险主要在于，如果攻击者修改了 HTTP 请求中的 PHP 代码，例如，将命令改为写入 webshell，则可能存在潜在的恶意行为。此 README 文件本身被篡改的可能性较低，判定存在 10% 的投毒风险，主要来自于恶意使用者可能会修改利用代码。


**项目地址:** [MuhammadWaseem29/RCE-CVE-2024-7954](https://github.com/MuhammadWaseem29/RCE-CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)