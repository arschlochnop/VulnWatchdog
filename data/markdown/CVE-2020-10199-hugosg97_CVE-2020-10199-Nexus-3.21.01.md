## CVE-2020-10199-Sonatype Nexus Repository-JavaEL注入

**漏洞编号:** CVE-2020-10199

**漏洞类型:** JavaEL注入

**影响应用:** Sonatype Nexus Repository

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 3.21.2

**利用条件:** 需要有效的用户账号和密码，并且能够访问Nexus Repository服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-10199是Sonatype Nexus Repository在3.21.2之前的版本中存在的一个JavaEL注入漏洞。攻击者可以通过构造恶意的JavaEL表达式，在Nexus Repository服务器上执行任意代码。

**有效性:**

根据漏洞库信息和搜索引擎结果，该漏洞已被公开披露且存在可利用的POC代码。提供的`exploit.py`脚本正是利用此漏洞的POC。该脚本首先对用户进行身份验证，然后构造包含恶意JavaEL表达式的请求，发送到Nexus Repository的API端点 `/service/rest/beta/repositories/go/group`，从而触发远程代码执行。

**投毒风险:**

分析提供的`exploit.py`脚本，主要功能是利用漏洞执行命令，并未发现明显的恶意投毒代码。脚本从指定的URL下载`try.sh`脚本并执行，这部分存在潜在的风险。如果攻击者控制了`http://192.168.45.223:445/try.sh`的内容，就可以通过此漏洞传播恶意软件，或者进行其他恶意活动。**但脚本本身仅负责发起攻击，下载和执行命令取决于外部的脚本，因此，该仓库本身不具备直接的投毒行为。投毒的风险取决于被下载和执行的脚本的内容，并非POC本身。**

**利用方式:**

1.  **身份验证:** 使用提供的用户名和密码（或者通过其他方式获取的凭据）登录到Nexus Repository。
2.  **构造恶意请求:**  `exploit.py`脚本构造一个包含恶意JavaEL表达式的JSON请求体。这个表达式利用Java反射机制来执行系统命令。
3.  **发送请求:** 将构造好的JSON请求发送到Nexus Repository的 `/service/rest/beta/repositories/go/group` API端点。
4.  **远程代码执行:** Nexus Repository在处理请求时，会解析JavaEL表达式，从而执行攻击者指定的命令。

**总结:**

该漏洞利用的有效性较高，POC代码可以直接使用。投毒风险较低，主要取决于攻击者执行的命令或下载的脚本的内容。漏洞利用方式相对简单，只需要具备一定的网络知识和编程能力即可。

**项目地址:** [hugosg97/CVE-2020-10199-Nexus-3.21.01](https://github.com/hugosg97/CVE-2020-10199-Nexus-3.21.01)

**漏洞详情:** [CVE-2020-10199](https://nvd.nist.gov/vuln/detail/CVE-2020-10199)