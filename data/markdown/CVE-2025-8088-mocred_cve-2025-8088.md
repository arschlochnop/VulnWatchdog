## CVE-2025-8088 WinRAR path traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** Path Traversal

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意构造的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2025-8088是WinRAR中存在的路径遍历漏洞。该漏洞允许攻击者通过构造恶意RAR压缩包，将恶意文件写入任意目录，最终达到执行任意代码的目的。提供的POC代码利用了这一漏洞，通过创建包含路径遍历字符的压缩包，将Payload写入Windows启动目录实现持久化。

**有效性：**

POC代码的有效性较高，因为漏洞库信息表明该漏洞已被在野利用，并且POC代码详细描述了利用过程，包括创建诱饵文件，嵌入Payload，修改压缩包结构以及重计算CRC值等步骤。POC针对Windows操作系统，利用WinRAR的路径遍历漏洞将payload写入启动目录。

**投毒风险：**

分析POC代码内容后，发现`/tmp/ba5d741e6517dc792c75e18e35bfba24/extract.py`文件存在高风险的投毒代码。主要表现在：

1.  **动态URL生成：** `bu()`函数通过随机字符串拼接和字符替换生成URL，增加了分析难度，并且URL的逻辑复杂，可能包含隐藏的恶意逻辑。
2.  **远程代码执行：** `extract.checkUpdates()`函数（未提供具体代码）可能存在未经授权的更新机制，下载并执行远程代码。
3.  **混淆和加密：** 代码使用了`gzip`和`base64`等编码，增加了代码可读性，可能是为了隐藏恶意行为。
4.  **动态脚本执行：** 从URL下载内容后，写入`archive.py`并执行，允许攻击者远程控制受害者系统。
5. **核心代码缺失：** 主要的攻击载荷位于没有提供的`extract.checkUpdates()`，以及URL指向的远程资源中，因此本地分析存在较大困难。

`/tmp/ba5d741e6517dc792c75e18e35bfba24/main.py`文件也存在恶意行为, 包含恶意域名。

因此，综合分析，此仓库中存在作者隐藏的投毒代码的可能性高达95%。

**利用方式：**

1.  **恶意RAR压缩包制作：** 攻击者使用提供的POC代码（特别是`main.py`）生成恶意RAR压缩包。这个压缩包包含Payload，例如`payload.bat`，以及利用路径遍历的结构。
2.  **诱骗用户解压：** 攻击者通过各种手段（例如钓鱼邮件、社交工程）诱骗用户下载并解压该RAR压缩包。
3.  **Payload执行：** 当用户使用受影响版本的WinRAR解压恶意压缩包时，路径遍历漏洞允许Payload被写入到Windows启动目录。下次系统启动时，`payload.bat`会被执行。
4.  **持久化控制：** `payload.bat`中的命令（例如`start /B C:\Users\Public\file.exe`）会启动攻击者预先放置的恶意程序（`file.exe`），从而实现对受害者系统的持久化控制。

**项目地址:** [mocred/cve-2025-8088](https://github.com/mocred/cve-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)