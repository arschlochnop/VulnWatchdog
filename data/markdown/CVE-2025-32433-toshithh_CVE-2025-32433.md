## CVE-2025-32433-Erlang/OTP-SSH-Pre-Authentication RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行

**影响应用:** Erlang/OTP SSH

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** OTP-27.0-rc1 < OTP-27.3.3, OTP-26.0-rc1 < OTP-26.2.5.11, < OTP-25.3.2.20

**利用条件:** 目标系统运行受影响版本的 Erlang/OTP 并且 SSH 服务监听在网络端口上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32433 存在于 Erlang/OTP 的 SSH 实现中，允许攻击者在无需身份验证的情况下执行远程代码。该漏洞源于 SSH 协议消息处理中的缺陷。提供的 exploit.py 脚本模拟了 SSH 握手过程，发送特制的 SSH_MSG_KEXINIT 和 SSH_MSG_CHANNEL_OPEN 消息，然后发送 SSH_MSG_CHANNEL_REQUEST 消息，其中包含要执行的命令。该命令被构造为执行反向 shell，从而允许攻击者控制受害系统。

**漏洞利用有效性：**
根据提供的漏洞库信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库明确指出存在未经身份验证的远程代码执行漏洞，并提供了受影响的版本范围。漏洞利用代码尝试发送特制的 SSH 消息，以触发漏洞并执行任意命令。如果目标系统运行的是漏洞库中列出的受影响版本，并且漏洞利用代码成功发送了特制的 SSH 消息，则该漏洞利用很可能成功。

**投毒风险：**
代码本身没有明显的投毒迹象。攻击脚本直接构造SSH协议数据包，并发送反向shell命令。脚本的目的明确，就是利用漏洞来获取目标系统的控制权。该脚本没有尝试安装后门、窃取信息或进行任何其他恶意活动。

**利用方式：**
1.  **建立连接:** 脚本首先建立与目标 SSH 服务器的 TCP 连接。
2.  **发送SSH版本信息:** 发送 SSH 版本标识字符串。
3.  **KEXINIT交换:** 发送 SSH_MSG_KEXINIT 消息以启动密钥交换过程。此消息包含客户端支持的加密算法列表。
4.  **打开通道:** 发送 SSH_MSG_CHANNEL_OPEN 消息以请求打开一个会话通道。
5.  **发送频道请求:** 发送 SSH_MSG_CHANNEL_REQUEST 消息，该消息包含要执行的命令。在提供的脚本中，该命令是一个反向 shell，它会在目标系统上启动一个 shell，并将其连接到攻击者控制的系统。
6.  **执行命令:** 如果服务器存在漏洞，它将执行 SSH_MSG_CHANNEL_REQUEST 消息中包含的命令，从而允许攻击者控制受害系统。

**项目地址:** [toshithh/CVE-2025-32433](https://github.com/toshithh/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)