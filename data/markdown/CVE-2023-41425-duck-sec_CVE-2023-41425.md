## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击 (XSS) 导致远程代码执行 (RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可导致服务器被控制

**影响版本:** 3.2.0 到 3.4.2

**利用条件:** 需要管理员用户访问恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 WonderCMS 的 installModule 组件中。攻击者可以通过上传包含恶意 JavaScript 代码的模块（main.zip及内部的rev.php），诱导管理员访问包含恶意代码的URL，从而执行任意代码。

**利用方式：**

1.  攻击者准备好包含恶意 JavaScript 代码的 `xss.js` 文件，该文件用于下载和执行包含反向shell的 `main.zip` 文件。 其中反向shell的php代码在`rev.php`。
2.  攻击者构造一个 URL，该 URL 利用 XSS 漏洞，将恶意 JavaScript 注入到页面中, 该js下载main.zip到服务器themes目录, 并执行内部的php文件。
3.  攻击者诱骗 WonderCMS 管理员点击此恶意 URL。
4.  管理员访问恶意 URL 后，恶意 JavaScript 代码执行，下载 `main.zip` 并解压到themes目录。该压缩包通常包含一个 `rev.php` 文件。
5.  `rev.php` 文件尝试建立一个反向 shell 连接到攻击者的服务器，从而使攻击者获得服务器的控制权。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞利用是有效的。多个来源 (NVD, Recorded Future, cvedetails, Medium 文章, GitHub) 确认了该漏洞的存在，并描述了其利用方式。提供的漏洞利用代码 (`exploit.py`) 提供了一个自动化利用该漏洞的工具。该漏洞利用代码的 README.md 文件中也包含了漏洞利用的步骤和成功利用的示例。

**投毒风险：**

分析提供的 `exploit.py` 脚本，脚本本身的主要功能是：

*   生成 `xss.js` 文件，其中包含用于下载 `main.zip` 的 JavaScript 代码。
*   启动一个 HTTP 服务器来提供 `xss.js` 和 `main.zip` 文件。
*   输出构造好的恶意 URL，诱骗管理员点击。

该脚本的主要功能看起来是合理的，符合 XSS 漏洞利用的预期行为。

但是，需要仔细检查以下几个方面：

*   `xss.js` 的生成逻辑：确保生成的 JavaScript 代码只包含必要的功能，例如下载 `main.zip`，没有添加额外的恶意代码。
*   `main.zip` 的内容：虽然脚本没有直接生成 `main.zip`，但它依赖于 `main.zip` 的存在。需要确保提供的 `main.zip` 文件是干净的，只包含预期的反向 shell 代码，没有其他恶意代码。
*   脚本的依赖项：确保脚本使用的所有依赖项都是来自可信的来源，没有被篡改。

鉴于以上分析，投毒风险较低，估计为10%。 风险主要来自于人工检查 `xss.js` 和 `main.zip` 内容的疏忽，以及对第三方依赖包的安全评估不足。

**项目地址:** [duck-sec/CVE-2023-41425](https://github.com/duck-sec/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)