## CVE-2023-38831-WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的恶意ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，它允许攻击者通过构造特殊的ZIP文件来执行任意代码。攻击者创建一个ZIP文件，其中包含一个良性文件（例如，JPG图片）和一个与该良性文件同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看该良性文件时，WinRAR会错误地执行该文件夹中的恶意代码，从而导致远程代码执行。

**有效性：** 提供的POC代码是有效的。根据漏洞库信息和搜索结果，该漏洞在野外被广泛利用。POC代码通过创建包含良性文件和同名文件夹的恶意ZIP文件，并利用WinRAR处理文件时的缺陷来执行代码。POC代码结构清晰，易于理解和使用。

**投毒风险：** 提供的POC代码本身主要是利用漏洞生成EXP，但仔细检查代码，在`exploit.py`文件的zip文件内容操作部分被截断，没有展示修改zip文件内容的关键代码，作者可能在`Read and manipulate the zip file content`部分添加恶意代码，执行修改zip文件过程中的任何恶意行为。因此存在一定的投毒风险，根据代码完整度，我给出10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意ZIP文件，其中包含一个看似无害的文件（例如，一个图片或PDF）。
2.  在ZIP文件中，攻击者同时创建一个与该无害文件同名的文件夹。
3.  该文件夹包含攻击者想要执行的恶意代码，通常是一个可执行文件或脚本。
4.  攻击者诱使用户使用存在漏洞的WinRAR版本打开该ZIP文件。
5.  当用户尝试访问ZIP文件中的“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意代码。

**项目地址:** [VictoriousKnight/CVE-2023-38831_Exploit](https://github.com/VictoriousKnight/CVE-2023-38831_Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)