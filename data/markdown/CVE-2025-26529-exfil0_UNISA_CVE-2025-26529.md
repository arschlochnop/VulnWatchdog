## CVE-2025-26529-Moodle-Stored XSS

**漏洞编号:** CVE-2025-26529

**漏洞类型:** Stored XSS

**影响应用:** Moodle

**危害等级:** 高危，可能导致账户劫持、权限提升、恶意代码执行。

**影响版本:** 4.5.0 to 4.5.1, 4.4.0 to 4.4.5, 4.3.0 to 4.3.9, 4.1.0 to 4.1.15, 4.2.*, 4.0.*

**利用条件:** 需要用户交互，可能需要较低权限的用户发布包含恶意脚本的内容。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26529 是 Moodle 的管理实时日志中存在的存储型跨站脚本 (XSS) 漏洞。根据漏洞描述，漏洞是由于站点管理实时日志中显示的信息需要额外的清理以防止存储的 XSS 风险。攻击者可以利用此漏洞在 Moodle 网站上存储恶意 JavaScript 代码。当其他用户（包括管理员）查看包含恶意代码的日志时，脚本会在他们的浏览器中执行，从而可能导致会话劫持、cookie窃取或执行其他恶意操作。

**有效性：**
提供的PoC代码似乎有效，因为它包含检测和利用CVE-2025-26529漏洞所需的必要组件。该代码包括一个扫描器（xss_checker.py），该扫描器使用各种XSS有效负载来测试Moodle实例是否存在漏洞。它还包含用于演示DOM XSS攻击和clickjacking攻击的PoC HTML文件。

PoC脚本xss_checker.py针对UNISA Moodle门户网站，并通过检查暴露文件、有效负载反射和管理面板可访问性来确认漏洞的存在。此外，该脚本使用Selenium在无头浏览器中自动加载DOM XSS PoC，从而进一步验证了DOM XSS漏洞。

**投毒风险：**
分析PoC代码，发现以下潜在的投毒风险：

*   **目标明确：**  该PoC明确针对`mymodules.dtls.unisa.ac.za`，其他Moodle实例的测试可能会产生未预期的结果。
*   **依赖外部资源：**  PoC依赖于`requirements.txt`中指定的外部Python库。虽然这些库本身很常用，但供应链攻击可能导致这些库被恶意版本替换。
*   **日志记录：**  PoC会将扫描结果写入日志文件`cve2025_full_scan.log`。如果日志记录功能被滥用，可能会泄露敏感信息。
*   **无头浏览器：** 使用Selenium运行无头浏览器增加了复杂性，并且引入了与浏览器本身相关的潜在风险。

考虑到以上因素，我估计该PoC存在10%的投毒风险。主要的风险在于PoC的目标限定以及潜在的依赖项问题。

**利用方式：**
1.  **未经身份验证的攻击：**
    *   攻击者将恶意代码注入到可以写入管理实时日志的任何未经过滤的字段中。这可能涉及利用另一个漏洞或利用Moodle配置中的缺陷。
2.  **存储型XSS：**
    *   恶意代码被存储在数据库中，并显示在管理实时日志中。
3.  **管理员交互：**
    *   当管理员查看包含恶意代码的日志时，JavaScript 代码将在其浏览器中执行。
4.  **攻击后果：**
    *   攻击者可以劫持管理员会话，从而完全控制 Moodle 网站。
    *   攻击者可以更改网站配置、创建新帐户或注入其他恶意代码。

**项目地址:** [exfil0/UNISA_CVE-2025-26529](https://github.com/exfil0/UNISA_CVE-2025-26529)

**漏洞详情:** [CVE-2025-26529](https://nvd.nist.gov/vuln/detail/CVE-2025-26529)