## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标应用开启静态文件服务，且follow_symlinks设置为True

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果'follow_symlinks'选项设置为True，则可能允许攻击者访问静态根目录之外的文件。 

**有效性:**

根据漏洞信息和搜索引擎结果，该漏洞真实存在且影响aiohttp 3.9.2之前的版本。 提供的PoC代码 `lfi.sh` 脚本旨在利用此漏洞。脚本通过构造包含多个`../`的payload，尝试访问目标服务器上的任意文件。如果服务器配置存在漏洞，且目标文件存在，攻击者可以通过此PoC读取文件内容。

**投毒风险:**

分析提供的PoC代码，没有发现明显的投毒代码。该脚本主要功能是发送包含目录遍历payload的HTTP请求并显示响应。因此，投毒风险为0%。

**利用方式:**

1.  **配置易受攻击的aiohttp应用:** 设置静态路由，开启`follow_symlinks=True`，指定静态文件根目录。
2.  **构造恶意请求:** 使用PoC脚本，指定目标URL（`-u` 参数）和要读取的文件路径（`-f` 参数）。
3.  **发送请求:** 脚本会生成包含多个`../`的payload，并发送HTTP请求。
4.  **读取文件:** 如果服务器存在漏洞，攻击者可以读取任意文件内容。

**示例：**

攻击者可以使用如下命令尝试读取`/etc/passwd`文件：

```bash
bash lfi.sh -u http://target_server/static/ -f /etc/passwd
```

如果服务器返回`/etc/passwd`文件的内容，则表示漏洞利用成功。

**项目地址:** [s4botai/CVE-2024-23334-PoC](https://github.com/s4botai/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)