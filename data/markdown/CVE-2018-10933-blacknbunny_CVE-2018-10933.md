## CVE-2018-10933 - libssh Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** Authentication Bypass

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 0.6 - 0.7.5, 0.8.0 - 0.8.3

**利用条件:** 目标系统运行存在漏洞的libssh版本，且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-10933是libssh库中存在的一个身份验证绕过漏洞。攻击者可以在未经身份验证的情况下，通过发送`SSH2_MSG_USERAUTH_SUCCESS`消息来欺骗服务器，从而创建通道并执行任意命令。

**有效性：**
提供的POC代码是有效的，它可以模拟一个恶意客户端，绕过libssh服务器的身份验证。

**投毒风险：**
仔细检查了提供的POC代码，包括`libsshauthbypass.py`、`checkversionofserver.py`和`requirements.txt`。没有发现明显的恶意代码或后门。

*   `libsshauthbypass.py`：利用paramiko库发送伪造的`SSH2_MSG_USERAUTH_SUCCESS`消息，绕过身份验证，然后执行命令。代码逻辑清晰，没有发现可疑之处。
*   `checkversionofserver.py`：用于检查目标服务器的libssh版本，以确定其是否易受攻击。代码功能单一，没有发现可疑之处。
*   `requirements.txt`：指定了paramiko的版本，没有包含任何恶意依赖项。

虽然代码本身看起来安全，但仍然存在一些潜在的风险：

*   **依赖项投毒：** 即使`requirements.txt`中指定的paramiko版本是安全的，但攻击者可能已经入侵了PyPI或其他包管理服务器，并替换了paramiko的源代码。这种风险是存在的，但与特定的POC代码无关。
*   **供应链攻击：** 代码作者本身可能受到威胁，恶意代码可能被悄悄地注入到代码库中。这种风险也很难评估，但可以通过代码审查和来源验证来降低。

总体而言，代码本身看起来是安全的，但仍然存在一些潜在的供应链风险。我给出的投毒风险评估是5%。

**利用方式：**

1.  **确定目标：** 扫描网络或互联网，查找运行易受攻击的libssh版本的服务器。可以使用`checkversionofserver.py`脚本来检查目标服务器的版本。
2.  **绕过身份验证：** 使用`libsshauthbypass.py`脚本连接到目标服务器，并发送伪造的`SSH2_MSG_USERAUTH_SUCCESS`消息。
3.  **执行命令：** 成功绕过身份验证后，`libsshauthbypass.py`脚本会执行指定的命令。

**缓解措施：**

*   将libssh升级到0.7.6或0.8.4及更高版本。
*   启用SSH身份验证。
*   使用防火墙限制对SSH端口的访问。
*   监控SSH连接，检测异常活动。

**项目地址:** [blacknbunny/CVE-2018-10933](https://github.com/blacknbunny/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)