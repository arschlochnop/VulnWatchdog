## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了受影响的Next.js版本，并且授权检查位于中间件中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中存在的授权绕过漏洞。攻击者可以通过操纵 `x-middleware-subrequest` 请求头来绕过中间件中的身份验证检查，从而访问受保护的资源。漏洞存在于版本 >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3。提供的PoC脚本通过发送包含特制 `x-middleware-subrequest` 头的请求来验证漏洞是否存在。脚本首先获取目标URL的baseline响应，然后发送带有payload的测试请求。如果两个响应不同，则认为存在漏洞。该脚本会尝试一些常见的管理页面和登录页面。投毒风险较低，主要是因为代码功能相对清晰，用于漏洞验证，但不能完全排除作者恶意添加的细微后门代码的可能性，例如不明显的请求头修改或条件判断。主要风险点在于PoC代码的生成方式是基于OpenAI GPT-3，这可能引入一些不可预测的行为,以及依赖库的安全性。 漏洞的利用方式是向目标服务器发送带有特定 `x-middleware-subrequest` 头的HTTP请求，绕过中间件的授权检查。为了缓解此漏洞，建议升级到Next.js的修复版本(>=14.2.25 或 >=15.2.3)，或者阻止包含 `x-middleware-subrequest` 头的外部用户请求。

**项目地址:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)