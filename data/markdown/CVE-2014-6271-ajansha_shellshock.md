## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 通过 4.3

**利用条件:** 需要目标系统存在Bash环境并且存在可以设置环境变量的利用入口，例如：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid等

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的命令注入漏洞。攻击者可以通过在环境变量中嵌入恶意代码，当Bash解析这些变量时，恶意代码会被执行，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2014-6271是一个真实存在且影响广泛的漏洞。提供的shelly.sh脚本是一个漏洞扫描器，用于检测目标系统是否存在Shellshock漏洞。由于它旨在 *检测* 而非 *利用* 漏洞，因此可以判断poc有效。

**投毒风险：**
分析提供的shelly.sh脚本，主要功能是检测目标系统是否存在Shellshock漏洞。脚本本身包含恶意代码的可能性较低，其主要通过发送包含特定payload的环境变量来触发漏洞，因此投毒的风险主要来自于脚本作者是否在检测Payload之外添加了额外的恶意逻辑。

尽管代码看起来比较直接，但仍然存在一定的低概率投毒风险，例如：
*   在漏洞检测逻辑之外，添加额外的命令执行代码，例如，扫描到存在漏洞后执行特定操作，上传信息等。
*   通过精心构造的payload，在检测漏洞的同时，悄悄地在目标系统上留下后门。

综合考虑代码量和功能，评估投毒风险为10%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统。
2.  **寻找入口点：** 确定可以通过设置环境变量来与目标系统交互的入口点。常见的入口点包括：
    *   **HTTP CGI脚本：** 通过修改HTTP请求头中的User-Agent等字段，设置环境变量。
    *   **OpenSSH ForceCommand：**  通过SSH连接时设置环境变量。
    *   **DHCP客户端：** 某些DHCP客户端脚本在执行时会受到环境变量的影响。
3.  **构造Payload：** 构造包含恶意代码的环境变量。Payload的基本形式为`(){ :; }; command`，其中`command`是要执行的命令。
4.  **发送Payload：** 通过选择的入口点将构造的Payload发送给目标系统。
5.  **执行恶意代码：**  当目标系统中的Bash解析包含恶意代码的环境变量时，恶意代码将被执行，攻击者从而控制目标系统。

**项目地址:** [ajansha/shellshock](https://github.com/ajansha/shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)