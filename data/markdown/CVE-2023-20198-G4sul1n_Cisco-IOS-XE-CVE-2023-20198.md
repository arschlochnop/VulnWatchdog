## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，结合CVE-2023-20273可提升至root权限并植入后门。

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他相关版本，具体参见漏洞库信息。

**利用条件:** 需要目标系统启用Web UI功能，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。Cisco的公告指出，攻击者首先利用此漏洞获得初始访问权限，然后执行特权 15 命令以创建本地用户和密码组合。随后，攻击者利用 CVE-2023-20273 将权限提升到 root 并将植入程序写入文件系统。根据提供的漏洞利用代码，该 PoC 包含以下功能：

*   **漏洞检查**：通过执行 `uname -a` 命令来验证漏洞是否存在。
*   **获取 Cisco 配置**：执行 `sh run` 命令来提取运行配置。
*   **执行命令**：允许执行任意 Cisco IOS 命令，但警告需要谨慎使用，因为没有输入验证。
*   **添加用户**：创建一个新的特权 15 用户帐户，可以选择指定用户名和密码。
*   **删除用户**：从设备中删除用户帐户。

**有效性：**

该 PoC 代码的有效性较高，因为漏洞库信息和搜索结果都表明该漏洞已被 активно используется。此外，该 PoC 提供了多种利用方式，包括漏洞检查、信息收集和权限提升。

**投毒风险：**

尽管 PoC 代码主要用于利用已知的漏洞，但仍存在一定的投毒风险，估计为10%。风险点包括：

*   **命令执行**：通过 `-e` 选项执行任意命令，攻击者可能利用此功能执行恶意操作。
*   **用户管理**：虽然提供了添加和删除用户的选项，但如果被滥用，可能导致拒绝服务或系统损坏。

虽然PoC代码本身看起来是为了复现漏洞，但不能完全排除代码作者在其中隐藏恶意功能的可能性，例如植入后门、收集敏感信息等。因此，在使用 PoC 代码时，需要进行仔细审查和安全评估。

**利用方式：**

1.  **未经身份验证的访问**：利用 CVE-2023-20198 绕过身份验证，访问 `webui_wsma_http` Web 端点。
2.  **创建特权用户**：使用 `cisco:wsma-config` SOAP 端点创建一个具有特权 15 的新用户帐户。
3.  **执行任意命令**：使用 `cisco:wsma-exec` SOAP 端点执行任意 Cisco IOS 命令。
4.  **权限提升 (结合 CVE-2023-20273)**：利用新创建的特权用户，结合 CVE-2023-20273 将权限提升到 root，并在系统上植入后门。

总而言之，CVE-2023-20198 是一个严重的安全漏洞，需要立即采取措施进行修复。在使用 PoC 代码时，需要谨慎评估风险，并确保在受控环境中进行测试。

**项目地址:** [G4sul1n/Cisco-IOS-XE-CVE-2023-20198](https://github.com/G4sul1n/Cisco-IOS-XE-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)