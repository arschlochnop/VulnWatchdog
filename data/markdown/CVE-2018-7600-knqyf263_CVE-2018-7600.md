## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)