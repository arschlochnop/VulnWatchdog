## CVE-2020-5410 Spring Cloud Config 目录遍历漏洞

**漏洞编号:** CVE-2020-5410

**漏洞类型:** 目录遍历

**影响应用:** Spring Cloud Config

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.1.x (小于 2.1.9), 2.2.x (小于 2.2.3), 以及更早的不受支持版本

**利用条件:** 需要目标系统运行存在漏洞的Spring Cloud Config Server，并且对外开放端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5410是一个Spring Cloud Config Server的目录遍历漏洞。攻击者可以通过构造特殊的URL，利用`..%252F`绕过路径检查，读取服务器上的任意文件，例如`/etc/passwd`。PoC代码通过curl命令发送包含目录遍历的请求，来验证漏洞的存在。例如：`curl "vulnerablemachine:port/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fpasswd%23foo/development"`。 

**有效性：** PoC代码有效，可以通过构造包含`..%252F`的URL读取目标文件。搜索引擎结果也证明了该漏洞的存在，并指出恶意用户可以使用精心设计的URL发起目录遍历攻击。

**投毒风险：** 此处“投毒风险”特指作者在PoC代码仓库中可能隐藏的恶意代码。该仓库主要提供了漏洞描述、分析以及PoC利用代码。PoC本身是漏洞的验证，如果验证成功，则代表目标存在漏洞，这并非投毒行为。虽然PoC验证目标存在漏洞，但是也存在一定风险，比如恶意用户可以直接使用该docker环境进行攻击测试。风险评估为10%。

**利用方式：**

1.  **确定目标：** 找到运行Spring Cloud Config Server且版本在受影响范围内的目标。
2.  **发送恶意请求：** 使用构造好的URL，URL中包含`..%252F`序列，用于进行目录遍历。
3.  **读取文件：** 如果漏洞存在，服务器将返回被请求的文件内容。注意URL编码 `%252F` 是 `/%2F` 的双重URL编码，目的是绕过一些服务器的单次URL解码机制。`#foo` 用于避免某些文件扩展名检查。

**搜索引擎结果优先级：** 搜索引擎结果证实了漏洞的存在和利用方式，并提供了更全面的信息。结合漏洞利用代码，可以更快速验证漏洞是否存在。因此，搜索引擎结果的优先级高于漏洞利用代码和漏洞库信息。

**项目地址:** [osamahamad/CVE-2020-5410-POC](https://github.com/osamahamad/CVE-2020-5410-POC)

**漏洞详情:** [CVE-2020-5410](https://nvd.nist.gov/vuln/detail/CVE-2020-5410)