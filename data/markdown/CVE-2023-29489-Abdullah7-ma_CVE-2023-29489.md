## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** XSS

**影响应用:** cPanel

**危害等级:** 中危，可能导致账户劫持和恶意脚本执行

**影响版本:** before 11.109.9999.116

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2023-29489 是 cPanel 中发现的一个跨站脚本 (XSS) 漏洞。攻击者可以通过构造包含恶意 JavaScript 代码的链接来利用此漏洞。当用户点击该链接时，恶意代码将在用户的浏览器中执行。

**有效性：**
根据漏洞描述和搜索结果，该漏洞是一个反射型 XSS，可以通过 `cpanelwebcall` 参数注入恶意代码。提供的漏洞利用代码与该漏洞无关，它是一个 VBScript，似乎尝试在受害者机器上建立反向 shell 并添加计划任务以实现持久性。因此，给定的漏洞利用代码不能直接利用 CVE-2023-29489。

**投毒风险：**
提供的 VBScript 代码具有很高的投毒风险。它会尝试执行以下操作：

1.  创建一个隐藏的控制台窗口。
2.  添加一个 authtoken。
3.  尝试建立一个反向 TCP 连接到 3389 端口，这通常用于 RDP（远程桌面协议）。这意味着攻击者可能试图远程访问受害者的机器。
4.  创建一个计划任务，在系统启动时以及网络状态改变时运行 VBScript。这确保了恶意代码的持久性。
5.  循环ping google.com，如果成功则尝试执行反向tcp连接。

脚本中的 `conf` 命令值得怀疑，因为正常情况下，cPanel 环境中不会存在这个命令。更有可能 `conf.exe` 是攻击者植入的后门程序, 或者是一个被混淆的恶意程序。

因此，此 POC 代码具有极高的投毒风险。它试图在受害者机器上安装后门，而不是利用 XSS 漏洞。

**利用方式：**
该漏洞是一个反射型 XSS，通常的利用方式是：

1.  攻击者构造一个包含恶意 JavaScript 代码的 URL，该 URL 指向受影响的 cPanel 错误页面，并包含一个无效的 webcall ID。
2.  攻击者诱骗用户点击该 URL（例如，通过电子邮件、社交媒体或其他方式）。
3.  当用户点击该 URL 时，cPanel 会显示一个错误页面，其中包含攻击者注入的恶意 JavaScript 代码。
4.  恶意 JavaScript 代码在用户的浏览器中执行，可以执行各种恶意操作，例如窃取用户的 cookie、重定向用户到恶意网站、或在用户的浏览器中执行其他恶意代码。

总之，虽然 CVE-2023-29489 是一个 XSS 漏洞，但提供的代码试图通过建立反向 shell 和添加计划任务在受害者机器上安装后门。因此，该代码极有可能包含恶意功能，属于高风险投毒样本。

**项目地址:** [Abdullah7-ma/CVE-2023-29489](https://github.com/Abdullah7-ma/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)