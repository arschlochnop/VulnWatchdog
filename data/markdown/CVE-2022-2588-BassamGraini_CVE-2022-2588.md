## CVE-2022-2588-Linux Kernel Use-After-Free

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588是一个Linux内核中的Use-After-Free漏洞，存在于`cls_route`过滤器实现中。当过滤器句柄值为0时，旧的过滤器在释放之前不会从哈希表中删除，导致UAF。根据搜索结果和漏洞利用代码，该漏洞可被本地用户利用，以崩溃系统或提升权限。该漏洞利用代码通过创建用户命名空间，并利用`cls_route`的逻辑错误来触发UAF。代码中`README.md`提到可以注释掉某些行来防止漏洞利用，这进一步验证了POC的有效性。作者在README.md中对如何修复也做了说明, 增加了可信度。该代码利用了公开的漏洞信息，并提供了一个可用的漏洞利用程序，并没有发现明显的恶意代码，例如额外的后门或未记录的功能。但仍然存在一定的风险，因为攻击者可能会修改该代码以达到其他恶意目的。因为该漏洞涉及到提权，攻击者可能会利用它来安装后门程序或进行其他恶意活动。 因此投毒风险评估为低。

**利用方式：**

1.  **环境准备：** 准备一个受影响的Linux内核版本（< 6.0~rc1）且支持User Namespaces的环境。
2.  **编译漏洞利用代码：** 使用gcc编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 执行编译后的漏洞利用程序。
4.  **权限提升：** 漏洞利用成功后，攻击者可以获得root权限。

**项目地址:** [BassamGraini/CVE-2022-2588](https://github.com/BassamGraini/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)