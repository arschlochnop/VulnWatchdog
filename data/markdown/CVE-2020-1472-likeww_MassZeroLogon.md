## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未认证的攻击者获取域管理员权限，完全控制域。

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络，能够通过MS-NRPC协议与域控制器通信。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的特权提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的凭据中的多个字节设置为零来利用此漏洞。成功利用此漏洞后，攻击者可以冒充域控制器并获取域管理员权限。

**漏洞利用有效性：**

提供的POC代码（`MassZeroLogon.py`）旨在检测目标域控制器是否存在CVE-2020-1472漏洞。它通过尝试使用全零的凭据进行身份验证来利用漏洞。如果身份验证成功，则表示目标容易受到攻击。

根据搜索结果和漏洞信息，该漏洞利用是有效的，并且有公开可用的PoC。

**投毒风险：**

对提供的POC代码进行了分析，发现以下潜在的投毒风险：

*   该脚本依赖于多个第三方库（例如 `impacket`, `nmb`, `termcolor`），这些库本身可能包含漏洞或恶意代码。但这是代码依赖，不是投毒。
*   该脚本从 GitHub 下载，这意味着代码可能已被修改或包含后门。
*   脚本的目的是验证漏洞，因此它本质上不是恶意软件。然而，任何能被利用的工具都可能被滥用。

综合评估，投毒风险较低，主要来自于代码依赖和潜在的供应链攻击。

**利用方式：**

漏洞利用方式如下：

1.  攻击者使用`MassZeroLogon.py`脚本，指定目标域控制器的IP地址和计算机名。
2.  脚本尝试通过Netlogon协议与域控制器建立连接。
3.  脚本发送一个包含全零凭据的身份验证请求。
4.  如果域控制器存在漏洞，它将接受全零凭据，从而允许攻击者绕过身份验证。
5.  成功利用漏洞后，攻击者可以使用`impacket-secretsdump`工具从域控制器中提取敏感信息（例如，NTLM哈希）。
6.  攻击者可以使用提取的NTLM哈希来冒充域管理员并完全控制域。

**项目地址:** [likeww/MassZeroLogon](https://github.com/likeww/MassZeroLogon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)