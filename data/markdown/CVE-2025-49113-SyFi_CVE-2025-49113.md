## CVE-2025-49113-Roundcube-PHP对象反序列化导致RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，允许认证后的远程代码执行

**影响版本:** 1.5.x (< 1.5.10), 1.6.x (>= 1.6.0, < 1.6.11)

**利用条件:** 需要Roundcube Webmail的有效用户账户和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113是Roundcube Webmail中存在的一个PHP对象反序列化漏洞。攻击者需要拥有一个有效的Roundcube账号并成功登录，通过构造包含恶意PHP对象的`_from`参数，发送到`program/actions/settings/upload.php`，即可触发PHP对象反序列化，从而执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，高危的RCE漏洞，CVSS评分为9.9。多个来源证实了该漏洞的存在，并且有公开的POC代码和利用方法。给定的POC代码看起来完整，涵盖了获取CSRF token，登录，以及发送恶意反序列化payload的步骤。因此，提供的POC代码**大概率有效**。

**投毒风险分析：**
查看提供的代码，发现`EvilObject`类，其构造函数接收文件名，`__destruct`函数会执行命令。 Webshell 的payload 在 `$this->content = '<?php system($_GET["cmd"]);?>';` 定义. 这段代码本身就是利用此漏洞所需要的后门代码, 不是投毒代码.

`file_put_contents('exploit_config.json', json_encode($config, JSON_PRETTY_PRINT));`
`$token_file = fopen('token_initial.txt', 'w');`
`$session_file = fopen('session_authenticated.txt', 'w');`
上述代码会将token和cookie写入文件中,可能会暴露用户敏感信息, 但这部分不是恶意代码, 而是PoC的功能代码.

代码的末尾被截断，完整的 PoC 代码是否会添加其他恶意代码无法确认，因此存在一定的投毒风险，但根据目前提供的代码，投毒的可能性较低，风险系数估计为 10%。

**利用方式：**
1.  **获取CSRF Token和Session:** 利用`get_csrf_token`函数从Roundcube Webmail获取初始的CSRF token和session cookie。
2.  **用户登录:** 使用`perform_login`函数，提供用户名、密码和CSRF token，通过POST请求登录Roundcube。
3.  **验证Session:** 使用`verify_session`验证登录session的有效性。
4.  **构造恶意Payload:** 创建一个`EvilObject`类的实例，其中`filename`参数为webshell的路径，`content`参数包含PHP webshell代码。  
5.  **发送Payload:** 将序列化后的`EvilObject`作为`_from`参数的值，通过GET请求发送到`program/actions/settings/upload.php`，触发PHP对象反序列化。
6.  **执行命令:** 成功利用漏洞后，可以通过webshell执行任意系统命令，例如`http://mail.example.com/shell.php?cmd=whoami`。


**项目地址:** [SyFi/CVE-2025-49113](https://github.com/SyFi/CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)