## CVE-2023-38831-WinRAR-远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的恶意ZIP压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以创建一个恶意的ZIP压缩文件，其中包含一个良性文件（例如.jpg）和一个同名的文件夹。当用户尝试在 WinRAR 中查看该良性文件时，WinRAR 会错误地执行该文件夹中的内容，从而导致任意代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果表明该漏洞已被广泛利用，POC代码的存在进一步证实了其有效性。

**投毒风险：**

根据对POC代码的分析，存在一定的投毒风险。`script.bat`脚本从github下载`Alert.exe`文件，这本身就存在一定的安全隐患，无法确保下载的文件一定是安全的。此外，脚本同时执行 `alert.exe` 和 `gtaleak.mp4`，而 `gtaleak.mp4` 在 README 中说明是 “zeros without ones”, 可以确定这是一个障眼法，实际的恶意行为是由 `alert.exe` 执行。 因此，作者可能隐藏了投毒代码。

**利用方式：**

1.  攻击者创建一个恶意的ZIP压缩文件，其中包含一个良性文件 (例如 `gtaleak.mp4`) 和一个同名的文件夹。
2.  该文件夹包含一个批处理脚本 (`script.bat`)，该脚本将从远程服务器下载并执行恶意程序 (`Alert.exe`)。
3.  当用户尝试使用 WinRAR 打开压缩文件并查看良性文件 (`gtaleak.mp4`) 时，WinRAR 会错误地执行批处理脚本。
4.  批处理脚本下载并执行恶意程序，从而允许攻击者在受害者的系统上执行任意代码。

**项目地址:** [MyStuffYT/CVE-2023-38831-POC](https://github.com/MyStuffYT/CVE-2023-38831-POC)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)