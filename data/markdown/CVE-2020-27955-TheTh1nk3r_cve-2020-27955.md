## CVE-2020-27955 - Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，且攻击者可以push包含恶意配置的仓库到目标机器上或者诱导目标机器clone恶意仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，攻击者可以通过创建一个包含恶意配置的Git仓库，诱导受害者克隆该仓库，从而在受害者机器上执行任意代码。具体利用方式如下：

1.  **创建恶意仓库:** 攻击者首先创建一个Git仓库，并初始化Git LFS。
2.  **配置`.gitattributes`:**  攻击者需要在`.gitattributes`文件中配置一个或多个文件类型，将其与一个自定义的Git LFS命令关联。这个命令可以是任意可执行文件，例如`git.cmd`。
3.  **创建恶意`git.cmd`:** 攻击者创建一个名为`git.cmd`的文件，该文件包含要执行的恶意代码。示例中，`git.cmd`的内容为`calc.exe`，用于启动计算器程序。
4.  **跟踪大文件:** 使用`git lfs track`命令跟踪一个或多个大文件类型（例如`*.dat`）。
5.  **添加并提交文件:**  将所有文件（包括`.gitattributes`、`git.cmd`、以及被跟踪的大文件）添加到Git仓库并提交。
6.  **推送仓库:** 攻击者将恶意仓库推送到远程服务器。当受害者克隆该仓库时，Git LFS会尝试处理被跟踪的文件，并执行`.gitattributes`中配置的自定义命令，从而触发RCE。

**POC有效性:**  根据提供的POC代码，该漏洞利用方式是有效的。它通过精心构造的`.gitattributes`文件和`git.cmd`文件，实现了在克隆仓库时执行任意代码的目的。

**投毒风险分析:**  提供的POC代码本身是直接的RCE利用，没有发现明显的投毒代码。`large.dat`文件仅包含"test"字符串，`git.cmd`文件仅包含`calc.exe`，这些都不属于投毒行为。因此，仓库中存在隐藏的投毒代码的可能性较低，判定为 0%。

**利用方式总结:** 攻击者通过创建包含恶意`.gitattributes`文件的Git仓库，诱导受害者克隆该仓库。当受害者机器上的Git LFS处理被跟踪的文件时，会执行`.gitattributes`文件中配置的恶意命令，从而导致RCE。

**项目地址:** [TheTh1nk3r/cve-2020-27955](https://github.com/TheTh1nk3r/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)