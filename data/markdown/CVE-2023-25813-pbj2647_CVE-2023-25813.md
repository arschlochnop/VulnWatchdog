## CVE-2023-25813-Sequelize-SQL注入

**漏洞编号:** CVE-2023-25813

**漏洞类型:** SQL注入

**影响应用:** Sequelize

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 6.19.1

**利用条件:** 目标应用使用了受影响版本的Sequelize，并且使用了`replacements`参数，同时满足攻击者能够控制输入参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Sequelize ORM库中，由于对`replacements`参数处理不当，导致SQL注入。攻击者可以通过构造恶意的SQL语句，利用`replacements`参数注入恶意代码。 

**有效性分析：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构建特殊的`payload`，利用`replacements`参数执行SQL注入，从而获取数据库信息，包括数据库名、表名、列名和数据。

**投毒风险分析：**

提供的Python PoC代码主要是用于利用该SQL注入漏洞进行信息收集，例如提取数据库名称、表名、列名等。它尝试连接到目标URL，并根据响应内容判断注入是否成功。`app.js` 文件看起来只是一个标准的 Express.js 应用框架，并没有发现任何可疑的或者后门代码。
评估的投毒风险较低，约为10%。 虽然代码本身旨在利用漏洞，但没有迹象表明存在故意引入的恶意功能（例如，持久性后门、数据破坏）。 

**利用方式分析：**

1.  **漏洞点：** Sequelize ORM库中，使用`replacements`参数时，未对用户输入进行充分的转义或过滤，导致SQL注入。
2.  **攻击流程：** 攻击者构造包含恶意SQL代码的输入，通过`replacements`参数传递给Sequelize的查询方法。由于未进行安全处理，恶意SQL代码被直接拼接到SQL查询语句中执行，从而实现SQL注入。
3.  **PoC利用：** PoC代码首先通过二分查找确定目标数据库中相关信息的长度，然后逐个字符地提取信息。它构造SQL查询语句，例如获取数据库名、表名、列名等，并使用`replacements`参数执行这些查询。通过判断响应内容是否包含特定的成功消息，来确定注入是否成功，进而提取所需的信息。
4.  **影响：** 攻击者可以利用此漏洞执行任意SQL查询，从而窃取敏感数据、修改数据，甚至执行系统命令（如果数据库用户具有相应的权限）。

**总结：**

CVE-2023-25813是一个严重的SQL注入漏洞，存在于Sequelize ORM库的特定版本中。攻击者可以利用该漏洞执行任意SQL查询，对应用程序和数据库造成严重威胁。提供的PoC代码可以有效验证该漏洞的存在，并提取数据库信息。应该及时升级Sequelize版本到6.19.1或更高版本，或者避免同时使用`replacements`和`where`选项，以防止SQL注入攻击。

**项目地址:** [pbj2647/CVE-2023-25813](https://github.com/pbj2647/CVE-2023-25813)

**漏洞详情:** [CVE-2023-25813](https://nvd.nist.gov/vuln/detail/CVE-2023-25813)