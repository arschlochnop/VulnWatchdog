## CVE-2022-41082 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，攻击者可以利用此漏洞在受影响的Exchange服务器上执行任意代码。

**影响版本:** 受影响版本包括Exchange Server 2013 Cumulative Update 23, Exchange Server 2016 Cumulative Update 22 和 23, Exchange Server 2019 Cumulative Update 11 和 12。具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问受影响的Exchange服务器，通常通过ProxyNotShell漏洞链利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41082 是一个 Microsoft Exchange Server 远程代码执行漏洞。 从搜索结果和漏洞库信息来看，该漏洞与 CVE-2022-41040 (ProxyNotShell) 经常一起被提及，表明它们可能构成一个攻击链。 从漏洞利用代码来看，攻击者发送包含特定格式的URL请求，该URL包含PowerShell相关的关键字，尝试在服务器端执行PowerShell命令， 漏洞利用代码的Request URL示例：`/autodiscover/autodiscover.json?@evil.com/owa/&Email=autodiscover/autodiscover.json%3f@evil.com&Protocol=XYZ&FooProtocol=Powershell` 。

**有效性分析：** 根据搜索结果，该漏洞已经被公开利用。 提供的POC代码展示了利用该漏洞的请求URL示例，表明该POC代码是有效的。

**投毒风险分析：** 提供的漏洞利用代码只是一个 README.md 文件，其中包含攻击事件的报告。 该文件仅描述了攻击尝试，并没有包含任何可执行的代码，因此不存在投毒风险。

**利用方式：**  利用方式通常是与ProxyNotShell漏洞（CVE-2022-41040）结合，先通过ProxyNotShell获得访问权限，然后利用CVE-2022-41082在Exchange服务器上执行任意代码。攻击者通过构造恶意的URL请求，利用Exchange服务器的 autodiscover 功能，并注入 PowerShell 代码，最终实现远程代码执行。


**项目地址:** [CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt](https://github.com/CyprianAtsyor/LetsDefend-CVE-2022-41082-Exploitation-Attempt)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)