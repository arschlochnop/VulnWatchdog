## CVE-2024-46256-NginxProxyManager-命令注入

**漏洞编号:** CVE-2024-46256

**漏洞类型:** 命令注入

**影响应用:** NginxProxyManager

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.11.3

**利用条件:** 需要可以访问NginxProxyManager实例,需要有效的用户名密码进行登陆

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于NginxProxyManager 2.11.3版本的requestLetsEncryptSsl功能中，通过“Add Let's Encrypt Certificate”功能点，可以在domain_names字段中进行命令注入。攻击者首先需要通过身份验证获取token，然后构造包含恶意命令的JSON数据，发送到/api/nginx/certificates端点。POC代码中通过注入shell命令来下载nc并执行，最终实现反弹shell。POC 代码的投毒风险较低，主要风险点在于从githubusercontent下载nc文件的行为，如果githubusercontent被劫持，则可能下载恶意nc文件，但是考虑到github的信誉，风险较低。README.md文件中提到CVE-2024-46256 和 CVE-2024-46257是相同的POC，只是修改了provider参数，需要引起注意。

**项目地址:** [barttran2k/POC_CVE-2024-46256](https://github.com/barttran2k/POC_CVE-2024-46256)

**漏洞详情:** [CVE-2024-46256](https://nvd.nist.gov/vuln/detail/CVE-2024-46256)