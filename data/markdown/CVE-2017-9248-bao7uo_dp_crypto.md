## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)