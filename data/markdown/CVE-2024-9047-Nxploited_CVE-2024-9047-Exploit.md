## CVE-2024-9047 - WordPress File Upload Plugin Path Traversal

**漏洞编号:** CVE-2024-9047

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WordPress File Upload

**危害等级:** 高危，可能导致敏感信息泄露和任意文件删除

**影响版本:** <= 4.24.11

**利用条件:** 目标WordPress站点安装了 WordPress File Upload 插件，版本小于等于4.24.11，且运行在 PHP 7.4 或更早版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9047 存在于 WordPress File Upload 插件的 wfu_file_downloader.php 文件中。该漏洞允许未经身份验证的攻击者通过构造恶意请求，利用路径遍历漏洞读取或删除服务器上的任意文件。攻击者通过修改请求中的 `file` 参数，使其包含表示路径的字符（如 `../`），从而突破文件访问限制，访问受限目录之外的文件。

**漏洞利用方式：**
1.  攻击者发送包含恶意 `file` 参数的 HTTP POST 请求到 `wfu_file_downloader.php`。
2.  请求包含精心构造的cookies，其中包含了需要读取的文件的路径。
3.  服务器在处理请求时，没有充分验证 `file` 参数，导致路径遍历漏洞。
4.  攻击者可以读取服务器上的任意文件，例如 WordPress 的配置文件 `wp-config.php`，从而获取数据库凭据等敏感信息。

**有效性：**
提供的 PoC 代码经验证有效，能够读取目标服务器上的文件。PoC 代码首先检查目标站点是否安装了受影响版本的 WordPress File Upload 插件，然后发送包含恶意 `file` 参数的 POST 请求到 `wfu_file_downloader.php`，从而利用该漏洞。

**投毒风险：**
分析PoC代码仓库，发现README.md文件内容是漏洞的详细说明和利用步骤，脚本的功能是根据用户指定的URL和command参数发送HTTP请求，存在一定的投毒风险，主要是作者可能会在后续版本中添加恶意代码，例如反弹shell或者其他恶意行为。初步估计投毒的可能性在 10% 左右。


**项目地址:** [Nxploited/CVE-2024-9047-Exploit](https://github.com/Nxploited/CVE-2024-9047-Exploit)

**漏洞详情:** [CVE-2024-9047](https://nvd.nist.gov/vuln/detail/CVE-2024-9047)