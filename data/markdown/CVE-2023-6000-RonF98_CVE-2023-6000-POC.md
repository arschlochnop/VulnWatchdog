## CVE-2023-6000 - Popup Builder 未授权存储型XSS

**漏洞编号:** CVE-2023-6000

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** Popup Builder WordPress 插件

**危害等级:** 中危，可能导致用户会话劫持，信息泄露，恶意重定向等

**影响版本:** < 4.2.3

**利用条件:** 目标网站安装了受影响版本的 Popup Builder 插件，且允许未授权用户访问并更新 Popup

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-6000 漏洞存在于 Popup Builder WordPress 插件 4.2.3 之前的版本中。未授权的攻击者可以通过更新已存在的 Popup，注入恶意的 JavaScript 代码，从而实现存储型 XSS 攻击。

**利用方式：**
1.  **环境准备：** 搭建 WordPress 环境，安装存在漏洞的 Popup Builder 插件（版本低于 4.2.3）。
2.  **查找 Popup ID：** 访问存在 Popup 的页面，通过浏览器开发者工具（Network）捕获 admin-ajax.php 请求，从中提取 Popup ID。
3.  **构造 Payload：** 构造包含恶意 JavaScript 代码的 HTTP POST 请求，发送到 WordPress 服务器。请求的 URL 为 WordPress 站点地址，请求体包含 sgpb-is-preview=1, post_ID=目标Popup ID, sgpb-type=html, sgpb-WillOpen=alert('XSS') 等参数，其中 sgpb-WillOpen 参数的值为要执行的 JavaScript 代码。
4.  **触发 XSS：** 当其他用户访问包含该 Popup 的页面时，恶意 JavaScript 代码将在用户的浏览器中执行。

**有效性：**
提供的 POC 代码是有效的。它演示了如何找到 Popup ID 并使用 POST 请求将恶意 JavaScript 注入到 Popup 中，从而实现存储型 XSS。

**投毒风险：**
虽然 POC 仓库提供了环境设置和利用步骤，但仍存在一定投毒风险，主要体现在以下几个方面：

1.  **依赖项风险：** 环境搭建依赖于 XAMPP 和 Wordpress 的下载，如果下载源被篡改，可能导致下载到包含恶意代码的版本。
2.  **Payload 修改：**  攻击者可能修改 `Exploit.md` 中的 POST 请求 Payload，例如，将 `alert('Stored XSS Executed Successfully')` 替换为更具危害性的代码，如窃取 Cookie 或重定向用户到恶意网站。
3.  **自定义JS/CSS设置风险：**  Exploit.md 文件中提到了“Custom JS or CSS”的选项，这个选项本身可能被利用来隐藏更复杂的恶意代码，例如，通过动态加载远程脚本或使用混淆技术来逃避检测。

由于该 POC 主要提供的是漏洞利用的演示，而非完整的攻击框架，作者隐藏恶意代码的可能性较低。 综合判断投毒风险为 10%。主要是环境搭建和依赖库可能存在风险。


**项目地址:** [RonF98/CVE-2023-6000-POC](https://github.com/RonF98/CVE-2023-6000-POC)

**漏洞详情:** [CVE-2023-6000](https://nvd.nist.gov/vuln/detail/CVE-2023-6000)