## CVE-2025-5777-NetScaler-内存信息泄露

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存信息泄露

**影响应用:** NetScaler ADC 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露，会话劫持

**影响版本:** NetScaler ADC 和 Gateway 14.1 < 43.56, 13.1 < 58.32

**利用条件:** 需要NetScaler配置为Gateway (VPN虚拟服务器, ICA Proxy, CVPN, RDP Proxy) OR AAA虚拟服务器, 且目标存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5777 是一个 NetScaler ADC 和 Gateway 中的内存信息泄露漏洞，也称为 CitrixBleed 2。该漏洞是由于输入验证不足导致内存越界读取造成的。攻击者可以通过发送特制的HTTP请求，从服务器内存中提取敏感信息，例如会话令牌、密码、或其他敏感数据。根据搜索结果和POC代码,此漏洞已经被积极利用。利用方式为：

1.  **漏洞触发：** 攻击者发送特制的HTTP POST请求到`/p/u/doAuthentication.do`路径。
2.  **内存越界读取：** NetScaler在处理该请求时，由于输入验证不足，导致内存越界读取。
3.  **信息泄露：**  内存越界读取的内容包含在响应中返回给攻击者。
4.  **利用：**  攻击者从泄露的信息中提取敏感数据，例如会话令牌，从而进行会话劫持或其他恶意活动。

POC代码分析：

*   该POC使用Python3编写，依赖`aiohttp`、`asyncio`和`colorama`库。
*   它通过异步方式发送大量POST请求到目标URL，尝试触发漏洞。
*   POC代码使用正则表达式从响应中提取`<InitialValue>`标签中的内容，并进行十六进制转储显示。
*   代码包含Verbose选项，方便用户查看请求和响应的详细信息，可以判断漏洞是否成功触发。

关于投毒风险：

虽然POC代码主要功能是利用漏洞进行内存泄露，但仍存在一定的投毒风险：

*   **依赖包风险：**  `aiohttp`等第三方库可能存在恶意代码，虽然可能性较小，但仍然存在。
*   **代码修改风险：**  攻击者可能修改POC代码，例如添加反向shell或植入其他恶意代码。代码中存在Proxy设置,如果被篡改为恶意Proxy，可能会记录或篡改受害者的流量。
*   **资源耗尽：**  POC代码通过大量并发请求触发漏洞，可能导致目标服务器资源耗尽，造成拒绝服务。

风险评估： 鉴于 POC 代码仅从响应体中寻找`<InitialValue>` 并打印出来，并未发现任何明显的后门或恶意代码。 风险较低。 并非完全排除，仍存在第三方依赖以及代码被篡改的可能。

**项目地址:** [rootxsushant/Citrix-NetScaler-Memory-Leak-CVE-2025-5777](https://github.com/rootxsushant/Citrix-NetScaler-Memory-Leak-CVE-2025-5777)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)