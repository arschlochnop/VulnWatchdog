## CVE-2023-32571-Dynamic Linq RCE

**漏洞编号:** CVE-2023-32571

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Dynamic Linq

**危害等级:** 高危，允许攻击者执行任意代码和命令。

**影响版本:** 1.0.7.10 through 1.2.25 (before 1.3.0)

**利用条件:** 需要应用程序使用 Dynamic Linq 并且允许用户输入影响 Dynamic Linq 的查询参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32571 存在于 Dynamic Linq 库中，由于对用户提供的输入（特别是用于 Where、Select、OrderBy 等方法的输入）未进行充分的验证和清理，导致 Linq 注入漏洞。攻击者可以利用此漏洞注入恶意的 Linq 表达式，从而执行任意 C# 代码。提供的 POC 代码展示了如何利用 `System.AppDomain.CreateInstanceAndUnwrap` 和 `System.Diagnostics.Process.Start` 方法来执行系统命令。利用方式是通过构造特定的字符串，这些字符串被 Dynamic Linq 解析并执行，最终调用 `System.Diagnostics.Process.Start` 启动恶意进程。由于POC需要连接docker环境，环境本身有一定风险。作者为了演示漏洞需要，可能会植入测试后门，所以投毒风险占10%。

**项目地址:** [Tris0n/CVE-2023-32571-POC](https://github.com/Tris0n/CVE-2023-32571-POC)

**漏洞详情:** [CVE-2023-32571](https://nvd.nist.gov/vuln/detail/CVE-2023-32571)