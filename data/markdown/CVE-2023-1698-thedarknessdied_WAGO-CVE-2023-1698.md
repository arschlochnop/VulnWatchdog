## CVE-2023-1698-WAGO产品远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，导致拒绝服务和完全系统入侵

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备存在漏洞且网络可达，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**  提供的POC代码（WAGO-CVE-2023-1698.py）是一个Python脚本，旨在利用CVE-2023-1698漏洞。 搜索结果表明，存在公开可用的漏洞利用工具和脚本，进一步支持了POC的有效性。该脚本允许通过指定URL或文件列表来利用漏洞，并支持执行远程命令、包含远程或本地文件等功能。因此，提供的POC代码是有效的。

2.  **投毒风险：**  查看提供的POC代码，主要功能是发送恶意请求，并没有发现明显的后门或者恶意代码。主要代码包括参数解析，发送HTTP请求，从远程拉取文件执行命令等功能，这些都是正常的漏洞利用方式，因此，投毒风险较低，可以认为投毒风险为0%。脚本本身功能即为漏洞利用，需要使用者具有一定风险意识。

3.  **利用方式：**  漏洞的利用方式是通过发送特制的HTTP请求，利用WAGO设备Web管理界面中存在的命令注入漏洞。攻击者可以利用该漏洞执行以下操作：
    *   创建新用户
    *   更改设备配置
    *   执行任意系统命令
    *   包含远程或本地文件（可能导致代码执行）

    POC代码提供了多种利用方式，包括：
    *   `--remote-file-include`: 指定远程文件URL，通过`curl`或`wget`将文件上传到`/tmp`或当前目录，然后在目标系统上执行。
    *   `--local-file-include`: 解析本地的shell脚本文件并在远端执行。
    *   `--remote-command`: 执行一条系统命令。

    攻击者可以通过这些方式在目标系统上执行任意代码，从而完全控制设备。

**项目地址:** [thedarknessdied/WAGO-CVE-2023-1698](https://github.com/thedarknessdied/WAGO-CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)