## CVE-2025-47827 - IGEL OS Secure Boot Bypass

**漏洞编号:** CVE-2025-47827

**漏洞类型:** 安全启动绕过

**影响应用:** IGEL OS

**危害等级:** 高危，允许未经授权的代码执行和操作系统替换

**影响版本:** < v11

**利用条件:** 需要物理访问或现有系统访问来替换或修改启动介质上的文件系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-47827 是 IGEL OS v11 之前版本中的一个安全启动绕过漏洞。漏洞存在于 `igel-flash-driver` 模块中，该模块未能正确验证加密签名。攻击者可以利用此漏洞加载恶意 root 文件系统，绕过安全启动机制。利用方式如下：

1.  **漏洞描述：**`igel-flash-driver` 模块未能正确验证 SquashFS 镜像的签名，允许加载未经验证的 root 文件系统。
2.  **利用过程：**攻击者可以使用 Microsoft 签名的 Shim 启动 GRUB 和存在漏洞的内核。内核加载后，可以挂载恶意 SquashFS 镜像，从而完全控制系统。
3.  **Kexec 利用：**该漏洞还可以用于 `kexec_load` 系统调用，替换当前运行的内核，加载恶意内核或修改内核参数，从而实现持久化控制。
4.  **影响：**成功利用此漏洞可能导致代码执行、权限提升、拒绝服务和信息泄露。

**有效性：**

根据提供的漏洞利用代码（`README.md` 和 `LICENSE`），该漏洞的 POC 已经发布，并且提供了详细的漏洞描述、利用过程和影响，因此判断提供的POC代码有效。

**投毒风险：**

从提供的代码来看，主要是漏洞的描述和利用说明，以及 MIT 许可证。虽然没有明显的恶意代码，但存在以下几点潜在风险：

*   **供应链风险：** 依赖外部资源，如图片链接，如果链接被篡改，可能引入恶意内容。
*   **误导性信息：** 漏洞描述可能存在偏差，引导用户采取错误的操作。
*   **代码执行风险：** 虽然提供的代码本身不是可执行的，但利用说明中包含的命令可能被篡改，导致用户执行恶意操作。
*   **社会工程学风险：**诱导用户执行额外的恶意脚本。

由于漏洞利用本身需要对启动介质进行修改，并且利用代码本身只是漏洞的描述，所以投毒风险较低。但是，仍然需要注意潜在的供应链风险和误导性信息。因此，评估投毒风险为10%。

**利用方式：**

利用方式主要包括以下几个步骤：

1.  **准备恶意 SquashFS 镜像：** 创建包含恶意代码的 root 文件系统镜像。
2.  **替换启动介质上的文件系统：** 将原始的 root 文件系统替换为恶意镜像。
3.  **重启系统：** 系统将从恶意镜像启动，绕过安全启动机制。
4.  **Kexec 利用（可选）：** 使用 `kexec_load` 替换当前内核或修改内核参数，实现更高级的攻击。

该漏洞允许攻击者在系统启动前或启动后获得完全控制权，因此危害极大。

**项目地址:** [Zedeldi/CVE-2025-47827](https://github.com/Zedeldi/CVE-2025-47827)

**漏洞详情:** [CVE-2025-47827](https://nvd.nist.gov/vuln/detail/CVE-2025-47827)