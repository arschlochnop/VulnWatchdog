## CVE-2023-23752-Joomla-信息泄露

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 信息泄露

**影响应用:** Joomla!

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 4.0.0-4.2.7

**利用条件:** 目标Joomla!站点开启了webservice endpoints且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23752 是 Joomla! 4.0.0 到 4.2.7 版本中存在的一个不当访问控制漏洞，允许未经授权的访问者访问 webservice endpoints，从而可能泄露敏感信息，例如用户名、邮箱地址、上次访问日期和用户组等。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，并且已经有公开的PoC代码 (webpage 6)。提供的 PoC 代码 (CVE-2023-23752.py) 实现了利用该漏洞获取用户数据和配置信息的功能。代码通过构造特定的URL (例如 `/api/index.php/v1/users?public=true` 和 `/api/index.php/v1/config/application?public=true`) 来访问未经授权保护的webservice endpoints。`vulnCheck` 函数通过检查 `/administrator/manifests/files/joomla.xml` 的存在来初步判断目标是否为Joomla站点，但是这个检查比较简陋。

**投毒风险分析：**
PoC代码主要功能是发送 HTTP 请求并解析响应中的 JSON 数据。代码本身没有明显的恶意行为，例如执行系统命令或修改文件。但是，需要注意的是，任何未经授权的信息泄露都可能被攻击者利用进行进一步的攻击。`LICENSE`文件是一个标准的GPL v3协议，与投毒无关。初步判断投毒风险较低，但是仍然需要谨慎使用，并仔细审查代码后再执行。`poison` 百分比为5%，主要是考虑到即使不是直接的投毒代码，利用此漏洞获得的信息也可能被用于进一步的恶意行为。

**漏洞利用方式：**
1.  **确定目标 Joomla! 站点：** 通过 URL 访问目标站点。
2.  **验证漏洞存在性：** (PoC代码中的 `vulnCheck` 函数) 访问 `/administrator/manifests/files/joomla.xml` 确认是Joomla站点，并推测版本。
3.  **利用 PoC 代码：** 运行 PoC 脚本，指定目标 URL 作为参数。
4.  **获取敏感信息：** PoC 脚本会发送请求到 `/api/index.php/v1/users?public=true` 和 `/api/index.php/v1/config/application?public=true`，获取用户数据（用户名、邮箱地址等）和配置信息，并打印到控制台。

**项目地址:** [0xVoodoo/CVE-2023-23752](https://github.com/0xVoodoo/CVE-2023-23752)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)