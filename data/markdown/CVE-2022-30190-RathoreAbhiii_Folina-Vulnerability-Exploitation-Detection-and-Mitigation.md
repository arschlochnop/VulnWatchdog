## CVE-2022-30190 - Microsoft MSDT RCE (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可以利用此漏洞在受害者系统上执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022 (请参考漏洞库信息中的详细版本)

**利用条件:** 需要用户打开恶意文档（例如Word文档）或点击恶意链接。调用应用程序（如Word）需要允许使用 URL 协议调用 MSDT。

**POC 可用性:** 是，虽然提供的代码只是一个README.md，但其他搜索结果表明有可用的PoC。

**投毒风险:** 20%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过构造恶意的Word文档，利用Word的远程模板功能从远程Web服务器检索HTML文件，最终通过MSDT执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞真实存在且影响广泛。虽然提供的POC代码（README.md）本身不包含任何漏洞利用代码，但是搜索引擎结果表明该漏洞存在公开的POC，因此可以判断该漏洞是可利用的。

**投毒风险：**
提供的代码仓库只包含一个README.md文件，文件内容是关于Follina漏洞的利用、检测和缓解的说明，没有发现任何恶意代码。因此，直接从这个仓库判断是否存在投毒代码的可能性较低。但是，由于攻击者通常会修改POC代码以达到自己的目的，因此用户在使用互联网上找到的任何POC代码时，都需要保持警惕并进行安全审查，才能防止被植入恶意代码。

**利用方式：**
1.  攻击者创建一个恶意的文档，例如 Word 文档。
2.  该文档利用 Word 的远程模板功能，从攻击者控制的服务器上下载 HTML 文件。
3.  HTML 文件包含特定的 JavaScript 代码，该代码通过 `ms-msdt:/` 协议调用 MSDT。
4.  MSDT 接收到精心构造的参数后，会在受害者的机器上执行攻击者预先设定的恶意代码，从而实现远程代码执行。

**修复方案：**
*   及时更新Windows操作系统到最新版本。
*   禁用MSDT URL协议处理程序 (作为临时缓解措施)。
*   在 Defender 中添加规则阻止相关攻击。

**项目地址:** [RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation](https://github.com/RathoreAbhiii/Folina-Vulnerability-Exploitation-Detection-and-Mitigation)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)