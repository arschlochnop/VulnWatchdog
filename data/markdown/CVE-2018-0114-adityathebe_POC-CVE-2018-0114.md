## CVE-2018-0114-Node-jose-JWT密钥混淆

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT密钥混淆

**影响应用:** Node-jose Library

**危害等级:** 高危，允许未授权的远程攻击者重新签名令牌，可能导致身份伪造和权限提升。

**影响版本:** < 0.11.0

**利用条件:** 目标系统使用存在漏洞的Node-jose库来验证JWT。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞源于node-jose库遵循JWS标准，允许在JWT头部嵌入JSON Web Key (JWK)。攻击者可以构造包含恶意公钥的JWT，并使用与之对应的私钥签名，从而绕过验证。 

**利用方式：**
1.  攻击者获取或构造一个合法的JWT。
2.  攻击者生成一个新的RSA密钥对（公钥和私钥）。
3.  攻击者修改JWT头部，将`alg`设置为`RS256`，并在头部添加一个`jwk`字段，其中包含攻击者生成的公钥（以JWK格式）。
4.  攻击者计算修改后的JWT头部和负载的SHA256哈希值。
5.  攻击者使用其私钥对哈希值进行RSA签名。
6.  攻击者将修改后的头部、原始负载和新生成的签名组合成一个新的JWT。
7.  当应用程序使用存在漏洞的node-jose库验证该JWT时，它会信任嵌入在头部中的恶意公钥，并使用该公钥验证攻击者提供的签名，从而认为该JWT是有效的。

**有效性：**
根据漏洞描述和提供的POC代码，此漏洞是有效的。POC代码展示了如何生成包含恶意公钥的JWT，并使用相应的私钥进行签名，从而实现令牌的伪造。

**投毒风险：**
分析POC代码，没有发现明显的投毒代码。代码的主要功能是生成RSA密钥对，构造包含公钥的JWT头部，并使用私钥对JWT进行签名。代码逻辑清晰，没有执行恶意操作或下载恶意资源的迹象。因此，投毒风险较低。

**项目地址:** [adityathebe/POC-CVE-2018-0114](https://github.com/adityathebe/POC-CVE-2018-0114)

**漏洞详情:** [CVE-2018-0114](https://nvd.nist.gov/vuln/detail/CVE-2018-0114)