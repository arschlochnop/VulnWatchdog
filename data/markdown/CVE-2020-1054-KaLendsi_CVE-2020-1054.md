## CVE-2020-1054

**漏洞编号:** CVE-2020-1054

**漏洞类型:** 权限提升

**影响应用:** Windows

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本包括Windows 7 SP1, Windows 8.1, Windows 10 (多个版本), Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows Server 2016, Windows Server 2019 以及相应的Server Core安装。

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1054 存在于 Windows 内核模式驱动程序中，当驱动程序未能正确处理内存中的对象时，会导致权限提升。根据搜索结果和漏洞利用代码，该漏洞利用了 Win32k 组件中的 `DrawIconEx` 函数的越界写入漏洞。

**有效性：**

提供的 PoC 代码（Visual Studio solution）表明该漏洞的利用是可行的。搜索结果中提到了公开可用的exp，且提供了exp的github链接。

**投毒风险：**

提供的代码片段看起来是合法的漏洞利用程序框架，包含 Visual Studio 工程文件和一些源代码。虽然无法完全排除投毒风险，但目前没有明显的证据表明存在恶意代码。风险较低，约10%。主要考虑到以下几点：

*   PoC 只是一个框架，需要编译才能使用，编译过程中可能引入恶意代码。
*   漏洞利用代码本身就具有破坏性，可能被滥用。

**利用方式：**

该漏洞的利用方式通常涉及以下步骤：

1.  利用 `DrawIconEx` 函数或其他相关函数触发 Win32k 组件中的越界写入漏洞。
2.  通过精心构造的内存布局，覆盖关键的内核数据结构。
3.  劫持程序执行流程，执行攻击者控制的代码。
4.  提升当前进程的权限，从而获得系统管理员权限。

**项目地址:** [KaLendsi/CVE-2020-1054](https://github.com/KaLendsi/CVE-2020-1054)

**漏洞详情:** [CVE-2020-1054](https://nvd.nist.gov/vuln/detail/CVE-2020-1054)