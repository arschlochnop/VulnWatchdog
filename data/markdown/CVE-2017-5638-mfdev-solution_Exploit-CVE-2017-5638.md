## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)