## CVE-2024-27956-WordPress Automatic Plugin-SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，未经身份验证的攻击者可以执行任意SQL命令，可能导致数据泄露、数据篡改甚至服务器控制。

**影响版本:** <= 3.92.0

**利用条件:** 需要目标安装了受影响版本的 WordPress Automatic Plugin，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 WordPress Automatic Plugin 的 csv.php 文件中。攻击者可以通过构造恶意的SQL语句，并将其作为 q 参数的值传递给 csv.php 文件，从而执行任意SQL命令。auth 参数似乎被绕过，integ 参数的目的是用于验证查询，但存在缺陷可以绕过。

**有效性：**
提供的POC代码看起来是有效的。它演示了如何使用 `q` 参数注入 SQL 代码，通过 `sleep(5)` 函数来验证SQL注入是否成功。 通过修改 `IF` 条件，可以确认延时执行，从而验证SQL注入的存在。

**投毒风险：**
虽然提供的 `stack.yml` 文件用于快速搭建 WordPress 环境进行测试，本身不包含恶意代码。`README.md` 文件展示了如何安装和利用漏洞，但没发现隐藏的后门或恶意代码。但是github账户可能存在投毒风险，考虑到攻击者可能会修改POC，比如添加反弹shell等恶意操作，因此存在一定的风险，给予10%的投毒风险概率。

**利用方式：**
1.  **确定目标：**  找到安装了 WordPress Automatic Plugin 且版本低于或等于 3.92.0 的 WordPress 站点。
2.  **构造恶意 SQL 注入 payload：** 利用 csv.php 文件的 SQL 注入漏洞，构造恶意的 SQL 查询语句。 例如，可以使用 `SELECT IF(1=1,sleep(5),sleep(0))` 来测试是否存在 SQL 注入，或者使用 `UNION SELECT` 语句来获取数据库中的敏感信息。
3.  **发送 HTTP 请求：**  将构造的 SQL 注入 payload 作为 q 参数的值，通过 GET 或 POST 请求发送到 `/wp-content/plugins/wp-automatic/inc/csv.php` 路径。
4.  **验证攻击结果：**  观察服务器的响应，如果成功执行了 SQL 注入，可能会看到延时、错误信息或数据库中的数据。
5.  **进一步利用：**  如果 SQL 注入成功，可以尝试执行更复杂的 SQL 查询，例如获取用户密码哈希、创建新的管理员用户等。

**项目地址:** [truonghuuphuc/CVE-2024-27956](https://github.com/truonghuuphuc/CVE-2024-27956)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)