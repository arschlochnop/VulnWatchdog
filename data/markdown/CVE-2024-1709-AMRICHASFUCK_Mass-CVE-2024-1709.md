## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 23.9.7

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709是ConnectWise ScreenConnect 23.9.7及更早版本中的一个身份验证绕过漏洞。攻击者可以通过构造特殊的URL绕过身份验证，直接访问敏感信息或关键系统。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞的PoC代码是有效的。 多个来源（如Huntress的博客、Palo Alto Networks的Unit 42报告）表明该漏洞容易被利用，并且已经存在公开可用的PoC。

**投毒风险：**
PoC代码本身的功能是利用身份验证绕过漏洞，上传一个恶意的扩展，该扩展包含一个Web shell。这个Web shell允许攻击者通过`cmd`参数执行任意命令。尽管PoC的目的是为了利用漏洞，但其中的恶意扩展的创建和上传过程本身具有潜在的风险，如果被恶意修改，可以被用于传播恶意软件或执行其他未授权操作。风险评估为10%。

**利用方式：**
1.  **身份验证绕过：** 攻击者利用漏洞绕过ScreenConnect的身份验证机制。
2.  **上传恶意扩展：** 绕过身份验证后，攻击者上传一个包含恶意Web shell的扩展。
3.  **远程代码执行：** 攻击者通过访问上传的Web shell，并利用`cmd`参数执行任意命令。

PoC代码中，首先生成一个随机的插件GUID、payload文件名以及handler class名称。然后，它创建了一个包含恶意代码的`.ashx`文件（payload_data），该文件包含一个Web shell，允许执行任意命令。同时，创建了一个manifest文件（manifest_data）来描述该插件。这些文件被打包成一个zip文件（resources.zip）。接下来，代码从目标ScreenConnect服务器获取反伪造令牌（anti_forgery_token）。最后，利用反伪造令牌将包含恶意Web shell的zip文件上传到ScreenConnect服务器。攻击者可以通过访问上传的Web shell，传递`cmd`参数来执行任意命令。

综上所述，CVE-2024-1709是一个严重的安全漏洞，攻击者可以利用该漏洞完全控制受影响的ScreenConnect服务器。强烈建议ScreenConnect管理员尽快升级到23.9.8或更高版本以修复该漏洞。

**项目地址:** [AMRICHASFUCK/Mass-CVE-2024-1709](https://github.com/AMRICHASFUCK/Mass-CVE-2024-1709)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)