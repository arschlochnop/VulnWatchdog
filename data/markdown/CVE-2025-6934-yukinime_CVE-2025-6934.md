## CVE-2025-6934-Opal Estate Pro-权限提升

**漏洞编号:** CVE-2025-6934

**漏洞类型:** 权限提升

**影响应用:** Opal Estate Pro

**危害等级:** 高危，允许未经验证的攻击者创建管理员账户。

**影响版本:** <= 1.7.5

**利用条件:** 目标WordPress站点安装了受影响的Opal Estate Pro插件，且版本低于或等于1.7.5。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6934是一个存在于Opal Estate Pro WordPress插件中的权限提升漏洞。该漏洞允许未经身份验证的攻击者通过在用户注册期间利用'on_regiser_user'函数中角色限制的缺失，来创建具有管理员权限的帐户。具体来说，攻击者可以向`/wp-admin/admin-ajax.php`端点发送包含所需用户名、电子邮件、密码和角色（设置为“administrator”）的恶意注册请求。PoC代码通过以下步骤利用此漏洞：

1.  **版本检查:** 检查目标站点上安装的Opal Estate Pro插件的版本，如果版本易受攻击，则继续。
2.  **获取Nonce:** 从注册表单中提取一次性使用的`opalestate-register-nonce`值，以绕过某些安全检查。
3.  **发送恶意请求:** 构造一个POST请求，该请求发送到`/wp-admin/admin-ajax.php`端点，并将`action`参数设置为`opalestate_register_form`。此请求还包括注册所需的用户名、电子邮件和密码，最重要的是，将`role`参数设置为`administrator`。
4.  **验证结果:** 检查服务器响应，如果注册成功，则会显示新创建的管理员帐户的详细信息。否则，将显示错误消息。

**有效性分析：**
该POC代码基于漏洞描述，可以自动化利用该漏洞。由于该漏洞源于注册过程中角色验证的缺失，因此提供的PoC代码通过模拟用户注册过程并指定管理员角色来成功地提升权限。

**投毒风险分析：**
该PoC代码中未发现任何明显的投毒行为。该脚本的主要目的是利用权限提升漏洞，而没有其他恶意操作。虽然PoC本身的目的是恶意利用，但它本身不包含任何隐藏的后门或有害功能。风险系数为0%。

**利用方式总结：**
利用方式是向 WordPress 站点的 `/wp-admin/admin-ajax.php` 发送精心构造的 POST 请求，模拟用户注册，并将角色设置为 administrator。在注册过程中，由于插件未能正确验证用户角色，导致攻击者可以成功创建一个具有管理员权限的账户，从而完全控制受影响的 WordPress 站点。

**项目地址:** [yukinime/CVE-2025-6934](https://github.com/yukinime/CVE-2025-6934)

**漏洞详情:** [CVE-2025-6934](https://nvd.nist.gov/vuln/detail/CVE-2025-6934)