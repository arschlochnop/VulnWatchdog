## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 极高危，可能导致未授权访问、信息泄露和完全系统控制

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行ConnectWise ScreenConnect <= 23.9.7，且攻击者可以网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 中的一个身份验证绕过漏洞。该漏洞源于程序对 URL 路径的不正确处理，允许未经身份验证的攻击者通过操纵 URL 路径来绕过身份验证。POC代码通过探测`/SetupWizard.aspx`路径是否存在绕过，如果存在则认为存在漏洞。利用方式主要通过访问`SetupWizard.aspx`来判断目标是否存在漏洞。如果返回302状态码，进一步访问`SetupWizard.aspx/`，如果返回200状态码，则认为存在漏洞，并写入vulnerable_hosts.txt文件。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，可以判断POC代码是有效的，且多个来源表明该漏洞易于利用并已存在公开的PoC。

**投毒风险：** 代码本身的功能是扫描存在CVE-2024-1709漏洞的ScreenConnect实例，并无恶意行为。但是，`requests.packages.urllib3.disable_warnings(InsecureRequestWarning)` 禁用了SSL证书验证警告，可能允许中间人攻击，虽然这本身不是投毒，但降低了安全性。同时output_file_path定义成相对路径，在不熟悉脚本的情况下执行，可能会在不期望的位置生成文件。hosts.txt如果被替换，可能会对不期望的目标进行扫描。综合判断投毒风险为10%。

**利用方式：** 攻击者可以利用此漏洞绕过身份验证，直接访问ConnectWise ScreenConnect服务器，从而可能获得对敏感信息或关键系统的未授权访问，甚至完全控制。

**项目地址:** [HussainFathy/CVE-2024-1709](https://github.com/HussainFathy/CVE-2024-1709)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)