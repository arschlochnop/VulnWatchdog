## CVE-2024-53677-Apache Struts 文件上传路径穿越RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 使用了基于 FileuploadInterceptor 的旧文件上传逻辑

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts中的一个文件上传漏洞，存在于2.0.0到6.4.0之前的版本中。攻击者可以通过操纵文件上传参数，实现路径穿越，将恶意文件上传到受限制的目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的POC是有效的，并且存在多个公开的利用方法。提供的POC代码尝试通过修改`uploadFileName`参数来将JSP webshell上传到webapps/ROOT/目录下，从而实现远程代码执行。

**投毒风险：**
检查提供的POC代码，没有发现明显的投毒行为。该脚本只是一个简单的webshell上传工具，没有执行任何恶意操作，例如安装后门、窃取信息等。因此，投毒风险评估为0%。

**利用方式：**
1.  **路径穿越:** 攻击者利用Struts框架在处理文件上传时的缺陷，通过修改上传文件的文件名参数（`uploadFileName`），构造包含路径穿越字符（如`../`）的文件名。
2.  **上传恶意文件:** 通过路径穿越，攻击者可以将恶意文件（如JSP webshell）上传到Web服务器的任意目录下，突破Web服务器的访问限制。
3.  **远程代码执行:** 上传的恶意文件被Web服务器执行，攻击者可以通过访问该文件来执行任意系统命令，从而完全控制服务器。

**项目地址:** [WhoisBulud/CVE-2024-53677](https://github.com/WhoisBulud/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)