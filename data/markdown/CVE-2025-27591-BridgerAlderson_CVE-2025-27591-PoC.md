## CVE-2025-27591-below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** below

**危害等级:** 高危，可能导致本地用户提升为root权限

**影响版本:** < 0.9.0

**利用条件:** 需要本地访问，且below服务创建了world-writable的/var/log/below目录

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-27591是一个存在于below服务0.9.0版本之前的权限提升漏洞。该漏洞源于below服务创建了世界可写的目录/var/log/below。攻击者可以利用符号链接攻击，将/var/log/below目录下的文件链接到敏感文件（如/etc/passwd），然后通过其他操作（如below服务自身的日志写入）修改这些敏感文件，从而获得root权限。

**有效性分析:**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。PoC代码中，`exploit.py`脚本首先检查`/var/log/below`目录是否存在且是否为世界可写。如果满足条件，则尝试创建指向`/etc/passwd`的符号链接`TARGET_LOG`。然后，脚本运行`below record`命令，触发日志写入，并通过复制恶意内容到`/etc/passwd`，实现权限提升。

**投毒风险分析:**
该PoC存在一定的投毒风险。虽然PoC的主要目的是演示漏洞利用，但以下因素可能存在风险：
1. **依赖于sudo:** PoC的`exploit.py`脚本中，`subprocess.run(["sudo", BINARY, "record"], timeout=30)`这行代码依赖于`sudo`命令来执行`below record`。如果目标系统上的`sudo`配置不当，或者用户执行PoC时没有sudo权限，可能会导致PoC无法正常工作，或者执行其他意外的操作。虽然看起来是利用，但是如果`sudo`配置不对，会导致执行环境和预期不一致。
2. **恶意passwd行:** PoC中向`/etc/passwd`添加用户的操作，虽然是利用的一部分，但如果用户盲目执行，可能会在系统中留下一个实际存在的、拥有特权的恶意账户。攻击者后续可以通过这个账户登录系统。
3. **未清理痕迹:** 在利用完成后，PoC没有彻底清理`/etc/passwd`中的恶意条目。这可能会导致系统管理员在不知情的情况下，让系统长期处于风险之中。
4. **潜在的其他利用方式:** 虽然PoC主要针对`/etc/passwd`进行攻击，但实际上，攻击者可以利用世界可写目录和符号链接攻击，修改其他敏感文件，造成更大的危害。PoC只演示了一种利用方式，可能会让用户低估漏洞的风险。

综合以上因素，将投毒风险评估为10%。主要是因为脚本直接修改了系统文件，如果没有完全了解脚本，使用者可能会误操作。

**利用方式:**
该漏洞的利用方式是：
1.  检查目标系统是否存在`/var/log/below`目录，并且该目录是否为世界可写。
2.  创建`/var/log/below/error_root.log`符号链接，指向`/etc/passwd`。
3.  运行`below record`命令，触发日志写入。
4.  将包含恶意用户信息的文本文件复制到`/var/log/below/error_root.log`，从而修改`/etc/passwd`文件。
5.  使用新添加的恶意用户登录系统，获得root权限。

**项目地址:** [BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)