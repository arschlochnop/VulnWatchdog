## CVE-2025-24813-Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. 可能需要应用程序使用Tomcat基于文件的会话持久化，且使用默认存储位置
4. 可能需要应用程序包含一个可以被反序列化攻击利用的库。
5. 对于信息泄露，目标URL要是公共上传URL的子目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，源于对包含内部点（例如 file.Name）的文件路径处理不当。如果满足特定条件，攻击者可能利用此漏洞执行远程代码或泄露敏感信息。

**有效性：**
根据漏洞描述和搜索结果，此漏洞的利用需要满足多个前提条件，包括启用默认servlet的写入功能，支持部分PUT请求，以及应用程序特定的配置或依赖。提供的POC代码是一个目录扫描器，用于查找可使用PUT方法写入的目录，是漏洞利用的前期步骤，本身并不能直接触发RCE或者信息泄露，需要进一步利用PUT上传恶意文件覆盖session或者其他敏感文件才能达到目的。综合搜索结果，此漏洞确实存在利用实例。

**投毒风险：**
查看代码，该POC主要用于扫描目标服务器上的可写目录，并不会主动上传后门代码。投毒风险主要来自于使用者在找到可写目录后，自行构造恶意payload上传，并非POC本身包含恶意代码。 `PutScanner` 仓库中的投毒风险较低，主要风险在于使用者利用该工具扫描后进行恶意操作，因此我估计的投毒风险为5%。

**利用方式：**
1.  **扫描可写目录：** 使用`putscanner.py`扫描目标Tomcat服务器，寻找可以使用HTTP PUT方法写入的目录。
2.  **信息泄露：** 如果启用了默认Servlet的写入功能，支持部分PUT请求，且攻击者已知安全敏感文件的名称并能通过部分PUT上传，则可能读取或修改这些文件。
3.  **远程代码执行 (RCE):**  如果启用了默认Servlet的写入功能，支持部分PUT请求，应用使用了Tomcat的文件会话持久化机制，且应用包含可被反序列化攻击的库，攻击者可以通过上传包含恶意序列化对象的会话文件来执行任意代码。
   *   攻击者首先需要找到Tomcat用于存储Session的文件目录 (默认在`$CATALINA_BASE/work/Catalina/localhost/[appname]/SESSIONS.ser`)。
   *   然后，攻击者可以通过PUT请求上传恶意的Session文件覆盖原有的Session文件。
   *   当Tomcat反序列化恶意Session文件时，即可触发RCE。

总结：利用此漏洞的关键在于找到可写目录，并根据应用环境选择合适的payload（例如恶意的session对象）进行上传。

**项目地址:** [x00byte/PutScanner](https://github.com/x00byte/PutScanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)