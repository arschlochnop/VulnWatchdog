## CVE-2009-2265 - FCKeditor 目录遍历漏洞

**漏洞编号:** CVE-2009-2265

**漏洞类型:** 目录遍历

**影响应用:** FCKeditor

**危害等级:** 高危，可能导致任意文件创建和远程代码执行

**影响版本:** < 2.6.4.1

**利用条件:** FCKeditor 2.6.4.1之前的版本，且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2009-2265 存在于FCKeditor 2.6.4.1之前的版本中。攻击者可以利用目录遍历漏洞，通过构造包含目录遍历序列（如`../`）的输入，在服务器上创建任意文件，包括可执行文件。漏洞出现在编辑器/filemanager/connectors/目录的相关模块中。从搜索引擎结果和漏洞库信息来看，此漏洞在2009年被广泛利用。

**有效性：** 提供的漏洞利用代码`Cargo.lock`并非漏洞利用的直接PoC，而是一个Rust项目的依赖锁定文件。但是，搜索引擎结果表明存在可利用此漏洞进行远程代码执行的PoC。

**投毒风险：** 提供的 `Cargo.lock` 文件本身是用于锁定Rust项目依赖项版本的，其中包含项目所依赖的各个库的名称、版本、来源和校验和。 投毒风险较低，原因在于：

1.  `Cargo.lock` 文件本身不包含可执行代码，主要作用是确保项目构建的可重复性。
2.  其中列出的依赖项都是流行的Rust库，如`reqwest`、`tokio`、`clap`等，如果这些库本身被投毒，影响会非常广泛，不太可能只针对这个特定的漏洞利用项目。
3.  依赖版本和校验和都有记录，恶意篡改较为困难。

但理论上，如果开发者使用的构建环境中存在恶意软件，可能会在构建过程中替换掉一些依赖项，从而引入恶意代码。 风险评估为2%.

**利用方式：**

1.  攻击者首先需要找到一个使用了存在漏洞的FCKeditor版本的网站。
2.  攻击者构造恶意的文件上传请求，请求中包含包含目录遍历序列的文件名或者文件路径。
3.  FCKeditor的connector模块未对输入进行充分的验证，导致目录遍历成功。
4.  攻击者将恶意代码（如webshell）上传到服务器的任意目录。
5.  攻击者通过访问上传的恶意代码，执行任意命令。

**项目地址:** [nika0x38/CVE-2009-2265](https://github.com/nika0x38/CVE-2009-2265)

**漏洞详情:** [CVE-2009-2265](https://nvd.nist.gov/vuln/detail/CVE-2009-2265)