## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用了受污染的XZ Utils 5.6.0或5.6.1版本，并且OpenSSH链接了liblzma库。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于XZ Utils (版本 5.6.0 和 5.6.1) 中的供应链后门漏洞。攻击者通过一系列复杂的混淆手段，在liblzma的构建过程中，从伪装的测试文件中提取预构建的目标文件，并将其用于修改liblzma代码中的特定函数。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞影响 XZ Utils 的 5.6.0 和 5.6.1 版本。POC 已经在实际环境中得到验证，允许攻击者绕过 SSH 身份验证并执行任意代码。 因此，该漏洞的POC是有效的

**投毒风险分析：** 提供的代码片段主要是关于该漏洞的文档和资源链接，而非实际的漏洞利用代码。 其中包含大量外部链接，指向漏洞分析、受影响的发行版以及相关讨论。因此存在作者隐藏其他攻击载荷的可能性，因为利用此漏洞需要非常复杂和隐蔽的后门注入技术，但文档本身不包含恶意代码。该仓库本身存在风险的可能性较低。 由于只是信息汇总和链接集合，实际投毒风险较低，约为5%。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的恶意代码，修改了 XZ Utils 的构建过程。
2.  **liblzma 篡改：** 在构建过程中，恶意代码会将预先构建好的目标文件注入到 liblzma 库中，修改其功能。
3.  **SSH 拦截：** 受感染的 liblzma 库会拦截 SSH 连接，并在身份验证过程中允许攻击者绕过身份验证。
4.  **远程代码执行：** 攻击者利用绕过身份验证的 SSH 连接，可以在目标系统上执行任意代码。

**总结：** 该漏洞是一个供应链攻击的典型案例，攻击者通过在广泛使用的开源库中植入后门，实现了对大量系统的潜在控制。该漏洞利用方式复杂，隐蔽性强，影响范围广，危害程度极高。

**项目地址:** [reuteras/CVE-2024-3094](https://github.com/reuteras/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)