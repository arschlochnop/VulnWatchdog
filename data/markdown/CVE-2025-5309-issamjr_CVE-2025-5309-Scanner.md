## CVE-2025-5309-BeyondTrust-SSTI

**漏洞编号:** CVE-2025-5309

**漏洞类型:** 服务器端模板注入 (SSTI)

**影响应用:** BeyondTrust Remote Support (RS) & Privileged Remote Access (PRA)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 24.2.4, <= 24.3.4, 25.1.1

**利用条件:** 需要能够通过聊天功能发送消息

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5309 是 BeyondTrust Remote Support 和 Privileged Remote Access 的聊天功能中存在的服务器端模板注入漏洞。攻击者可以通过在聊天消息中插入恶意模板代码来利用此漏洞，导致服务器执行任意代码。根据漏洞描述，未经授权的攻击者可以利用此漏洞进行远程代码执行。

**有效性分析：**
提供的漏洞利用代码 (scanner.py) 是一个 Python 脚本，旨在扫描目标 URL 是否存在 CVE-2025-5309 漏洞。它通过向目标 URL 发送包含不同 SSTI payload 的 POST 请求来测试漏洞。如果服务器返回包含计算结果的响应，则脚本会报告目标易受攻击。该POC利用了常见的SSTI Payload，例如`{{7*7}}`，`${7*7}`，`<%= 7*7 %>`等，通过 `requests.post` 发送到目标服务器，然后判断返回结果中是否包含计算后的结果，来确定是否存在SSTI漏洞. 该POC的有效性取决于目标系统使用的模板引擎和漏洞利用的准确性。

**投毒风险分析：**
该仓库中的投毒风险较低。主要的风险点在于 `scanner.py` 中的 `eval` 函数的使用。 虽然 `eval` 用于评估 payload 的结果，但它也可能被滥用来执行恶意代码。 然而，`eval` 的使用仅限于评估预定义的 payload 的结果，并非直接执行用户输入。 代码的目的是为了验证SSTI的存在，所以要计算payload的结果，需要使用eval函数，所以这个不是投毒代码。如果攻击者可以控制payload的内容，就存在投毒风险。但就目前提供的代码来看，只是预定义了payload， 风险较小。 该脚本依赖 `requests` 和 `colorama` 库，理论上存在依赖投毒的风险，但可能性较低。考虑到这是一个扫描器，作者明确说明用于安全研究，投毒可能性进一步降低。
综合评估，投毒风险约为 5%。

**利用方式：**
1.  攻击者通过 BeyondTrust Remote Support 或 Privileged Remote Access 的聊天功能发送包含恶意 SSTI payload 的消息。
2.  目标系统（服务器）未正确转义或过滤用户输入，导致模板引擎执行恶意 payload。
3.  恶意 payload 在服务器上执行任意代码，从而允许攻击者控制系统。

根据搜索结果，多家安全厂商和漏洞库都确认了 CVE-2025-5309 漏洞的存在及其高危风险。BeyondTrust 官方也发布了安全公告，建议用户升级到最新版本以修复此漏洞。

**项目地址:** [issamjr/CVE-2025-5309-Scanner](https://github.com/issamjr/CVE-2025-5309-Scanner)

**漏洞详情:** [CVE-2025-5309](https://nvd.nist.gov/vuln/detail/CVE-2025-5309)