## CVE-2021-42013 - Apache HTTP Server Path Traversal 和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在可利用的Alias配置或CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞，是CVE-2021-41773的不完整修复。攻击者可以利用该漏洞通过构造包含`..`的URL来访问服务器上受限目录之外的文件。如果服务器配置允许CGI脚本在这些别名路径上执行，则可能导致远程代码执行。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的POC代码描述，该漏洞是真实且有效的。多个来源都证实了该漏洞的存在，以及利用路径遍历实现远程代码执行的可能性。Packetstorm Security 提供了相关的利用代码示例，表明已经存在公开可用的利用方式。

**投毒风险：** 提供的POC代码只是一个README.md文件，描述了一个漏洞扫描、利用和远程交互工具。由于只提供了README.md文件，缺少实际的脚本代码，因此很难准确评估是否存在投毒风险。如果完整的利用代码中包含恶意功能，例如反向shell、持久化后门等，则存在投毒风险。考虑到该漏洞影响较大，且存在公开的利用方式，不排除有人会将恶意代码混入利用工具中进行传播，因此判定存在10%的投毒风险。

**利用方式：** 攻击者通过构造包含`..`序列的恶意URL，绕过Apache HTTP Server的访问限制，读取或执行服务器上任意文件。具体的利用步骤如下：

1.  **路径遍历：** 构造包含多个`../`的URL，尝试访问目标目录之外的文件。例如，`http://target/icons/.%2e/%2e/%2e/%2e/%2e/%2e/%2e/etc/passwd`。
2.  **CGI利用（如果启用）：** 如果目标服务器允许CGI脚本在受影响的Alias路径上执行，攻击者可以利用路径遍历上传一个恶意的CGI脚本，并通过访问该脚本来执行任意命令。
3.  **信息泄露/RCE：** 成功利用漏洞后，攻击者可以读取服务器上的敏感文件（例如/etc/passwd），或者执行任意命令，从而完全控制服务器。

**项目地址:** [Makavellik/POC-CVE-2021-42013-EXPLOIT](https://github.com/Makavellik/POC-CVE-2021-42013-EXPLOIT)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)