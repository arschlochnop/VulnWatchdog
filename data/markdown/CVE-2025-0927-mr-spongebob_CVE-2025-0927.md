## CVE-2025-0927-Linux Kernel HFS+ heap overflow

**漏洞编号:** CVE-2025-0927

**漏洞类型:** 堆溢出

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和任意代码执行

**影响版本:** <= 6.5 (推测，漏洞利用代码针对该版本)

**利用条件:** 需要能够挂载HFS+文件系统，以及一定的用户权限（可能需要CAP_SYS_ADMIN)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0927 是一个Linux内核HFS+文件系统实现中的堆溢出漏洞。根据搜索引擎结果，该漏洞由Attila Szász发现。漏洞利用代码（exploit.c）针对Linux kernel 6.5，利用HFS+文件系统中的漏洞进行slab out of bounds write。该exploit首先尝试恢复KASLR地址，然后利用keyring和tty_struct等内核对象进行堆喷，以便在堆上布置精心构造的数据，最终触发堆溢出，实现任意代码执行或权限提升。漏洞库信息显示该CVE被标记为 REJECTED，因为文件系统bug由于损坏的镜像不被认为是CVE，对于任何只能由初始用户命名空间中的CAP_SYS_ADMIN挂载的文件系统，包括委托挂载。这和搜索引擎结果矛盾。漏洞利用代码首先尝试恢复KASLR base， 然后使用 `add_key` 以及 `spray_tty_struct` 函数进行堆喷, 大量分配 `key` 对象以及 `tty_struct` 对象。 最终利用HFS+的特定结构进行溢出，达到修改内核对象的目的。 漏洞利用代码分析显示存在一定的投毒风险，因为攻击者可能在堆喷过程中布置恶意代码，例如修改内核函数指针，从而实现持久化的后门。虽然代码本身主要展示了漏洞利用的流程，但修改内核关键数据结构的可能性，也为潜在的投毒攻击提供了机会。风险预估为10%，因为未发现明显的恶意代码植入行为，风险主要来源于对内核内存的修改，为后续利用留下了空间。

**项目地址:** [mr-spongebob/CVE-2025-0927](https://github.com/mr-spongebob/CVE-2025-0927)

**漏洞详情:** [CVE-2025-0927](https://nvd.nist.gov/vuln/detail/CVE-2025-0927)