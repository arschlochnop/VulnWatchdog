## CVE-2025-5777 NetScaler ADC/Gateway 内存越界读取

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存越界读取

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** ADC 14.1 < 43.56, ADC 13.1 < 58.32, Gateway 14.1 < 43.56, Gateway 13.1 < 58.32

**利用条件:** 目标NetScaler配置为Gateway（VPN虚拟服务器、ICA代理、CVPN、RDP代理）或AAA虚拟服务器，且可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5777是一个NetScaler ADC和Gateway中的内存越界读取漏洞。由于输入验证不足，当NetScaler配置为Gateway或AAA虚拟服务器时，可能导致内存越界读取，从而泄露敏感信息。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码分析，该漏洞利用的有效性较高。搜索引擎结果表明该漏洞已经被野外利用，且存在“Citrix Bleed 2”的说法，暗示其危害程度和之前的Citrix Bleed漏洞类似。PoC代码 `checker.py` 通过发送特制的HTTP请求到 `/p/u/doAuthentication.do` 路径，利用输入验证不足的缺陷触发内存越界读取。PoC验证通过检查响应内容中是否存在特定的标签（`<InitialValue>`)以及标签内容是否为空来判断是否存在漏洞。

**投毒风险分析：**

PoC代码 `checker.py` 的主要功能是检测目标是否存在 CVE-2025-5777 漏洞，而非进行攻击利用。代码逻辑较为简单，主要功能是发送HTTP POST请求并检查响应内容。`openssl.cnf` 配置文件通过设置 `UnsafeLegacyRenegotiation` 允许不安全的SSL/TLS协商。虽然存在一定的风险，但主要目的是为了兼容老旧的NetScaler设备，并非明显的投毒行为。

综合分析，投毒风险较低，估计在10%左右。主要风险点在于 `openssl.cnf` 配置文件可能存在的潜在风险，以及代码中未知的隐藏行为。 但是大概率是为了兼容性。

**利用方式：**

1.  **确定目标：** 找到配置为Gateway或AAA虚拟服务器的NetScaler ADC/Gateway实例。
2.  **发送恶意请求：** 使用PoC代码 `checker.py` 发送特制的HTTP POST请求到 `/p/u/doAuthentication.do` 路径。
3.  **验证漏洞：** 检查响应内容，如果`<InitialValue>`标签存在且内容为空，则表明存在漏洞。
4.  **信息泄露：** 成功利用该漏洞可能导致内存信息泄露，攻击者可能从中提取敏感信息，如会话令牌、密码等。

**项目地址:** [orange0Mint/CitrixBleed-2-CVE-2025-5777](https://github.com/orange0Mint/CitrixBleed-2-CVE-2025-5777)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)