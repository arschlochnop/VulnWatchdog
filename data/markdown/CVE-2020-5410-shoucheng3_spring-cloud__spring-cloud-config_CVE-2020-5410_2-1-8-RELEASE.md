## CVE-2020-5410 Spring Cloud Config 目录遍历

**漏洞编号:** CVE-2020-5410

**漏洞类型:** 目录遍历

**影响应用:** Spring Cloud Config

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.1.9 (2.1.x) 和 < 2.2.3 (2.2.x)

**利用条件:** 需要目标系统运行受影响版本的Spring Cloud Config Server，并允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5410 是 Spring Cloud Config Server 中的一个目录遍历漏洞。攻击者可以利用构造的恶意 URL 请求，绕过安全检查，读取服务器上的任意配置文件，进而获取敏感信息，如数据库凭据、API 密钥等。

**有效性评估：**
根据漏洞描述和搜索结果（特别是github上的POC链接），该漏洞利用是有效的。

**投毒风险评估：**
提供的代码片段主要是`Guardfile`和`LICENSE.txt`。`Guardfile` 定义了文件监控和自动执行任务的规则，其中使用了 `Asciidoctor` 来处理 `adoc` 文件。虽然直接提供的代码看起来没有明显的恶意行为，但`asciidoctor`配置中的`allow-uri-read` 属性可能允许从远程 URI 读取文件，如果 `adoc` 文件包含恶意链接或内容，则可能导致间接的风险。因此，存在一定的投毒风险，主要体现在利用`asciidoctor`的远程文件读取功能上。LICENSE文件没有风险。

**利用方式：**
利用方式是通过构造包含目录遍历payload的URL来访问Spring Cloud Config Server，例如：

```
GET /foo/default/master/..%2F..%2F..%2Fetc/passwd HTTP/1.1
```

攻击者将替换`foo`，`default`和`master`为有效的`application`，`profile`和`label`值。然后通过`..%2F`来遍历到`/etc/passwd`文件

总而言之，虽然给出的代码片段本身不直接构成漏洞利用，但是asciidoctor配置存在潜在风险。目录遍历漏洞本身的危害在于未经授权的访问和敏感信息的泄露。

**项目地址:** [shoucheng3/spring-cloud__spring-cloud-config_CVE-2020-5410_2-1-8-RELEASE](https://github.com/shoucheng3/spring-cloud__spring-cloud-config_CVE-2020-5410_2-1-8-RELEASE)

**漏洞详情:** [CVE-2020-5410](https://nvd.nist.gov/vuln/detail/CVE-2020-5410)