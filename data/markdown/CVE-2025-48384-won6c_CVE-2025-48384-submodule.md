## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互（克隆恶意仓库）和存在易受攻击的 Git 版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 存在于 Git 中，源于其对配置中回车符处理不当。攻击者可以通过在 submodule 路径中注入回车符，导致 submodule 被检出到错误的位置。如果存在一个符号链接将该错误路径指向 submodule 钩子目录，且 submodule 包含可执行的 post-checkout 钩子，则在检出后可能会意外执行该脚本，造成任意代码执行。

**有效性：**
根据 arcticwolf.com 的搜索结果表明，此漏洞存在可用的 PoC。 提供的 PoC 代码 `/tmp/b95b758d8faf22baf81ee61a8796e533/README.md` 只是一个 dummy submodule 的 README 文件，本身不具备利用漏洞的能力。 完整的 PoC 应当包含恶意的 submodule 配置和 hook 文件。

**投毒风险：**
提供的 PoC 代码不包含任何恶意代码，因此投毒风险为 0%。 但是，实际利用中，攻击者会构建包含恶意 hook 脚本的 submodule，从而在用户克隆并初始化 submodule 时执行恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意 submodule 的 Git 仓库。
2.  在 submodule 的路径中注入回车符。
3.  创建一个符号链接，将包含回车符的错误路径指向 submodule 的钩子目录 (.git/hooks)。
4.  在 submodule 中添加一个恶意的 post-checkout 钩子脚本。
5.  诱导用户克隆该仓库并初始化 submodule (git submodule update --init --recursive)。
6.  当用户检出 submodule 时，由于路径包含回车符，submodule 会被检出到错误的位置，触发符号链接，执行钩子目录下的恶意脚本，从而实现任意代码执行。

**项目地址:** [won6c/CVE-2025-48384-submodule](https://github.com/won6c/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)