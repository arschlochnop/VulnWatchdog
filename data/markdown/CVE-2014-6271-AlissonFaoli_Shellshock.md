## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。

**影响版本:** GNU Bash 1.14 至 4.3

**利用条件:** 目标系统需要运行存在漏洞的Bash版本，并且通过CGI脚本、OpenSSH ForceCommand或其他方式暴露了环境变量注入点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，又名Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，在Bash执行时注入并执行任意命令。利用方式通常涉及以下步骤：

1.  **确定攻击目标：** 寻找使用Bash处理请求的应用程序或服务，例如CGI脚本、OpenSSH服务器（使用ForceCommand）或DHCP客户端。
2.  **构造恶意环境变量：** 创建一个包含函数定义和恶意命令的环境变量。例如：`() { :; }; echo vulnerable`
3.  **发送包含恶意环境变量的请求：** 将构造的环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
4.  **触发漏洞执行：** 当目标系统执行Bash并处理包含恶意环境变量的请求时，漏洞将被触发，导致恶意命令执行。

提供的Python POC脚本 `shellshock.py` 旨在利用此漏洞。该脚本接受目标URL、攻击者IP地址（LHOST）和端口（LPORT）作为参数。它通过构造包含反向shell命令的User-Agent头，向目标URL发送HTTP GET请求。如果目标系统存在漏洞，它将执行反向shell命令，允许攻击者连接到目标系统并执行任意命令。

**关于投毒风险的分析：**

代码中主要功能是利用Shellshock漏洞，建立反向连接。审查代码，发现可能存在轻微投毒风险的地方在于，攻击者可以修改payload，执行任意命令。但是，由于脚本本身就是为了利用漏洞而设计的，因此，这不算是作者有意植入的后门，而是漏洞利用本身的性质决定的。

  * LICENSE和README.md文件相对标准，没有发现恶意代码。
  * `shellshock.py`脚本，虽然主要功能是漏洞利用，但如果被不道德的人使用，仍然会产生危害。

综合评估，该仓库的投毒风险较低，大约在5%左右。主要风险在于脚本被恶意使用，而非代码本身包含隐藏的恶意功能。

**项目地址:** [AlissonFaoli/Shellshock](https://github.com/AlissonFaoli/Shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)