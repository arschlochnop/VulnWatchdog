## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)