## CVE-2025-48384-Git允许通过损坏的配置引用执行任意代码

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户克隆包含恶意配置的 Git 仓库，并递归初始化子模块。用户需要具有一定的权限，并且需要用户交互。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 漏洞源于 Git 在处理包含回车符（CR）的配置值时存在不一致性。当读取配置值时，Git 会删除尾部的 CRLF。但是，当写入配置条目时，如果值包含尾部的 CR，则不会被正确引用，导致在后续读取配置时丢失 CR。当初始化子模块时，如果子模块的路径包含尾部的 CR，则修改后的路径将被读取，导致子模块被检出到错误的位置。如果存在一个符号链接，将修改后的路径指向子模块的 hooks 目录，并且子模块包含一个可执行的 post-checkout hook，则在检出后可能会意外执行该脚本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞允许攻击者通过构造恶意 Git 仓库，在用户克隆仓库并初始化子模块时执行任意代码。提供的 POC 代码 `README.md` 仅包含基本的 Markdown 内容，本身不包含任何恶意代码或利用逻辑。但是，此`README.md`可能是一个更大 PoC 的一部分，用于展示漏洞仓库的结构。实际的利用需要构造包含带有恶意配置和 hook 的恶意仓库。

**投毒风险：**
提供的 POC 代码 `README.md` 文件本身没有投毒风险，但攻击者可能在其他文件中隐藏恶意代码，例如在 `.gitmodules` 文件或 submodule 的 post-checkout hook 中。如果攻击者修改了子模块的 hook 文件，并在其中添加了恶意代码，那么当用户克隆包含此子模块的仓库时，hook 脚本可能会被执行，从而导致任意代码执行。考虑到仅仅是一个`README.md`文件，其他的文件是否包含恶意代码，不得而知，无法完全排除风险。 投毒风险评估为10%。

**利用方式：**
1.  **创建恶意 Git 仓库：** 攻击者创建一个包含子模块的 Git 仓库。
2.  **修改 .gitmodules 文件：** 在 `.gitmodules` 文件中，将子模块的路径设置为包含尾部 CR 的路径。
3.  **创建符号链接：** 创建一个符号链接，将修改后的路径指向子模块的 `.git/hooks` 目录。
4.  **添加恶意 hook：** 在子模块的 `post-checkout` hook 中添加恶意代码。
5.  **诱导用户克隆仓库：** 诱导用户克隆恶意 Git 仓库并使用 `--recursive` 参数初始化子模块。
6.  **执行任意代码：** 当用户初始化子模块时，由于配置解析错误和符号链接的存在，恶意的 `post-checkout` hook 将被执行，从而导致任意代码执行。


**项目地址:** [s41r4j/CVE-2025-48384-submodule](https://github.com/s41r4j/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)