## CVE-2021-3456 - Foreman smart_proxy_salt 权限绕过

**漏洞编号:** CVE-2021-3456

**漏洞类型:** 权限绕过/不当授权

**影响应用:** smart_proxy_salt (Foreman Plugin)

**危害等级:** 高危，可能导致资源删除和拒绝服务

**影响版本:** <= 2.1.5

**利用条件:** 需要本地攻击者通过认证访问smart_proxy_salt

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3456 描述了 Foreman 中 smart_proxy_salt 插件的一个不当授权处理漏洞。攻击者可以通过认证绕过权限检查，执行本应仅由 Foreman 服务器执行的操作。这可能导致攻击者删除有限的资源，并对 Foreman 服务器造成拒绝服务攻击。

**有效性:** 根据漏洞描述，利用的前提是攻击者已通过身份验证，然后利用插件本身的授权缺陷来提升权限。搜索引擎的结果也印证了这一点。

**投毒风险:** 提供的PoC代码包括一个MIT许可证、一个README.md。README.md中提到，漏洞利用链是从一个PDF文件开始，最终在AWS EC2实例上获得反向shell。仅仅基于这些信息，无法准确判断是否存在投毒代码。license和readme文件相对安全，没有直接执行的代码，但考虑到描述的攻击链较为复杂，可能存在隐藏的恶意脚本或者后门在其他地方，例如PDF文件本身。因此，存在一定的投毒风险，但概率较低。估算投毒风险为10%。

**利用方式:**
1.  攻击者首先需要通过某种方式获得对 `smart_proxy_salt` 服务的身份验证。
2.  利用 `smart_proxy_salt` 插件的授权漏洞，绕过正常的权限检查机制。
3.  执行未经授权的操作，例如删除资源或导致拒绝服务。 根据README中描述，可能涉及PDF文件，说明攻击方式可能更复杂，需要进一步分析实际的攻击代码才能确定具体利用方法。

**项目地址:** [mrk336/CVE-2021-3456](https://github.com/mrk336/CVE-2021-3456)

**漏洞详情:** [CVE-2021-3456](https://nvd.nist.gov/vuln/detail/CVE-2021-3456)