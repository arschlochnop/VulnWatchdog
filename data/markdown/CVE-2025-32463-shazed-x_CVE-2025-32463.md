## CVE-2025-32463 Sudo 本地提权漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获得root权限

**影响版本:** 1.9.14 <= 版本 < 1.9.17p1

**利用条件:** 本地用户访问权限，sudo版本符合漏洞版本范围

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Sudo的chroot功能中。攻击者可以利用--chroot选项指定一个用户可控的目录，然后Sudo会从该目录加载/etc/nsswitch.conf文件。通过构造恶意的nsswitch.conf文件，攻击者可以控制sudo加载的动态链接库，从而执行任意代码，最终获取root权限。

**有效性评估：**
提供的POC代码利用了CVE-2025-32463漏洞。POC代码首先检测目标系统的架构，然后选择相应的预编译的payload（动态链接库）。它会创建一个临时目录，并在该目录下创建`king/etc/nsswitch.conf`文件，内容指向一个恶意的动态链接库。最后，它使用`sudo -R king king`命令来触发漏洞，从而执行payload中的恶意代码，实现提权。

**投毒风险评估：**
仔细检查了提供的POC代码，没有发现明显的投毒代码。代码的主要功能是根据目标架构选择合适的payload，并将payload写入临时目录，然后利用sudo的chroot功能执行恶意代码。虽然恶意代码本身可能存在后门或者其他风险，但这些风险并非由作者特意植入的，而是漏洞利用本身固有的风险。`LICENSE` 文件声明作者拥有版权，并以 MIT 许可共享此代码。 `README.md` 解释了漏洞原理和如何使用，没有发现任何恶意诱导或隐藏行为。

**利用方式：**
1.  **漏洞触发：** 通过`sudo -R king king` 命令以及精心构造的`nsswitch.conf`文件来触发漏洞，该文件指定了一个恶意动态链接库。Sudo在chroot环境下会加载这个恶意的动态链接库。
2.  **代码执行：** 恶意动态链接库被加载后，其中的恶意代码会被执行，从而达到提权的目的。
3.  **权限提升：** 恶意代码一般会执行一些提权操作，例如创建root shell，或者修改系统文件等，最终获取root权限。

**项目地址:** [shazed-x/CVE-2025-32463](https://github.com/shazed-x/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)