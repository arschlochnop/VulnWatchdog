## CVE-2023-20198-Cisco IOS XE Software Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响系统

**影响版本:** 见受影响版本列表

**利用条件:** Web UI 功能已启用,网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。攻击者可以利用此漏洞绕过身份验证，创建一个具有 15 级权限的本地用户，从而完全控制受影响的系统。该漏洞结合 CVE-2023-20273 使用，CVE-2023-20198 用于初始访问，CVE-2023-20273 用于提权至 root 并写入植入程序到文件系统。

**利用方式：**

1.  未经身份验证的攻击者发送特制的HTTP请求到启用了Web UI的Cisco IOS XE设备。
2.  利用CVE-2023-20198漏洞，创建一个具有特权级别15的本地用户。
3.  使用新创建的本地用户利用CVE-2023-20273漏洞，将权限提升到root。
4.  将植入程序写入文件系统，从而完全控制设备。

**POC代码分析：**

提供的Python脚本 (`CVE_2023_20198_detector.py`) 主要用于检测设备是否存在漏洞，而不是利用该漏洞。它通过SSH连接到设备，并运行一些命令来检查Web UI是否启用，并尝试检测是否存在攻击迹象，例如存在`ip http server`, `ip http secure-server`,  `ip http active`配置。脚本通过`netmiko`库实现SSH连接和命令执行。该脚本没有直接创建特权用户的恶意代码，只是用于检测是否存在漏洞。该脚本会生成一个csv文件`Results_CVE_2023_20198_{current_timestamp}.csv` 用于记录检测结果。

**有效性：**

根据搜索引擎结果，存在公开的POC代码，可以创建特权用户。`CVE_2023_20198_detector.py`脚本本身并不能直接利用漏洞，它只能用来检测目标是否存在漏洞。

**投毒风险：**

该脚本的投毒风险极低 (0%)。虽然用户需要输入用户名和密码，但是该脚本只是用来检测是否存在漏洞，没有发现任何可疑的代码或后门，也没有修改系统配置的任何行为。LICENSE文件为标准的MIT License。

**项目地址:** [alekos3/CVE_2023_20198_Detector](https://github.com/alekos3/CVE_2023_20198_Detector)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)