## CVE-2019-16278 - Nostromo nhttpd Directory Traversal RCE

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，可远程执行任意代码

**影响版本:** <= 1.9.6

**利用条件:** 目标主机运行存在漏洞的Nostromo nhttpd服务，攻击者能够访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-16278 存在于 Nostromo nhttpd 1.9.6 及更早版本中。`http_verify` 函数存在目录遍历漏洞，攻击者可以通过构造包含目录遍历字符的 HTTP 请求，绕过权限验证，最终执行任意命令。

**有效性：**
提供的 POC 代码 `CVE-2019-16278.py` 看起来是有效的。它通过构造特定的 URL 和 POST 数据包，利用目录遍历漏洞，执行指定的命令。提供的 `README.md` 文件也包含了使用该 POC 成功执行命令的示例，验证了 POC 的有效性。

**投毒风险：**
分析`CVE-2019-16278.py`，代码逻辑相对简单，主要是构造payload并发送，没有发现明显的恶意代码或者后门，风险较低。
*   代码只包含发送恶意请求的功能，并未发现任何尝试在目标机器上安装后门、上传恶意文件或执行其他恶意操作的代码。
*   代码中使用的 `Building_payload` 函数构造 payload 的方式是标准的目录遍历加命令注入，符合漏洞利用的预期行为。
*   依赖项 `optparse`、`socket`、`sys` 都是标准库，不会引入额外的安全风险。

但是，以下几点值得注意：
1.  **供应链投毒风险：** 代码是从外部下载的，可能存在供应链风险。虽然代码本身目前看起来没有问题，但无法保证将来是否会被恶意修改。
2.  **使用风险：** 任何漏洞利用代码都应该在授权的环境中使用，否则可能构成非法入侵。

因此，综合考虑，投毒风险较低，约为5%。

**利用方式：**
1.  攻击者使用 POC 脚本 `CVE-2019-16278.py`，指定目标 IP 地址、端口和要执行的命令。
2.  脚本构建一个包含目录遍历序列的 HTTP POST 请求，该请求的目标 URL 包含 `/.%0d./` 序列，用于绕过 `http_verify` 函数的验证。
3.  请求的内容部分包含要执行的命令，使用 `echo` 命令进行包装，并使用 `2>&1` 将标准错误重定向到标准输出。
4.  脚本通过 socket 连接到目标主机，发送构造的 HTTP 请求。
5.  目标主机上的 Nostromo nhttpd 服务处理该请求，由于目录遍历漏洞，成功执行攻击者指定的命令。
6.  脚本接收并打印执行结果。

**项目地址:** [FredBrave/CVE-2019-16278-Nostromo-1.9.6-RCE](https://github.com/FredBrave/CVE-2019-16278-Nostromo-1.9.6-RCE)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)