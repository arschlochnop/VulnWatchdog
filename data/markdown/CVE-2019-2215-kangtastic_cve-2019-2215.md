## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)