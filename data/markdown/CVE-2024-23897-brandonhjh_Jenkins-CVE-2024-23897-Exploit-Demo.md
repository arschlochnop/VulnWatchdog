## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（RCE）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，无需认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。由于Jenkins CLI命令解析器在使用args4j库时，没有禁用将'@'字符后跟文件路径替换为文件内容的功能，未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 根据漏洞信息和搜索结果，该漏洞利用是有效的。多个来源表明，攻击者可以利用此漏洞读取任意文件。

**投毒风险：** 提供的POC代码（README.md文件）本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果攻击者使用此文件作为更复杂的攻击的一部分，例如，诱使用户下载包含恶意payload的文件，则可能存在间接的投毒风险。 此README文件本身并没有问题，但是利用这个漏洞需要通过CLI接口发送特定payload，如果有人提供了包含后门的payload，则存在投毒风险。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者需要能够访问Jenkins CLI接口（可以通过HTTP、WebSocket或SSH）。
2.  攻击者构造包含`@`字符后跟目标文件路径的CLI命令参数。
3.  Jenkins CLI解析器会将`@`字符和文件路径替换为目标文件的内容。
4.  攻击者可以从Jenkins控制器的响应中读取文件内容。

例如，可以使用以下命令读取`/etc/passwd`文件：
```
java -jar jenkins-cli.jar -s http://your-jenkins-server:8080/ command @/etc/passwd
```

利用此漏洞，攻击者可以读取Jenkins配置文件、凭据文件等敏感信息，从而可能进一步进行RCE攻击。

**项目地址:** [brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo](https://github.com/brandonhjh/Jenkins-CVE-2024-23897-Exploit-Demo)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)