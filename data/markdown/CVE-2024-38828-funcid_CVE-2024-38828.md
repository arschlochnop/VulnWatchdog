## CVE-2024-38828 - Spring MVC DoS

**漏洞编号:** CVE-2024-38828

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Spring Framework

**危害等级:** 中危，可能导致服务中断

**影响版本:** < 5.3.42

**利用条件:** 需要网络访问Spring MVC控制器，该控制器使用 @RequestBody byte[] 作为方法参数。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38828 是 Spring Framework 中的一个拒绝服务漏洞。当 Spring MVC 控制器方法使用 `@RequestBody byte[]` 参数时，攻击者可以通过发送带有巨大 `Content-Length` 头部但实际 payload 很小的 HTTP POST 请求来触发内存耗尽。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中的 `load_test.py` 脚本模拟了攻击，通过发送带有大的 `Content-Length` （2^31 - 1） 头部，但 payload 仅为 1 字节的 POST 请求，来消耗服务器的内存资源。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，约为 5%。理由如下：

*   **主要功能明确：** 该仓库的主要目的是演示 CVE-2024-38828 漏洞，并提供修复方案。
*   **包含修复方案：** 仓库包含 `SafeByteArrayHttpMessageConverter.java` ，表明作者提供了缓解该 DoS 漏洞的措施，这降低了作者恶意投毒的可能性。
*   **测试代码清晰：** `load_test.py` 脚本的目的是触发 DoS，代码本身相对简单直接，没有发现隐藏的恶意代码。但始终需要进行人工审查，来消除潜在的风险。
*   **细微风险：**build.gradle.kts中指定了spring-web的版本为5.3.39，虽然低于5.3.42，符合漏洞版本范围，但是依赖了spring-boot-starter-web 2.7.18，其中可能包含其他的依赖和配置，存在一定的被利用风险，但整体风险可控。

**利用方式：**

1.  **目标：** 存在漏洞的 Spring MVC 应用，其中包含使用 `@RequestBody byte[]` 作为参数的控制器方法。
2.  **攻击：** 攻击者构造恶意的 HTTP POST 请求。
3.  **请求头部：** 设置 `Content-Length` 头部为一个非常大的值（例如 2^31 - 1）。
4.  **请求体：** 发送一个很小的请求体（例如 1 字节）。
5.  **结果：** Spring Framework 会根据 `Content-Length` 的值分配大量的内存，但实际的数据量很小。如果攻击者发送大量这样的请求，服务器的内存将被耗尽，导致拒绝服务。

**项目地址:** [funcid/CVE-2024-38828](https://github.com/funcid/CVE-2024-38828)

**漏洞详情:** [CVE-2024-38828](https://nvd.nist.gov/vuln/detail/CVE-2024-38828)