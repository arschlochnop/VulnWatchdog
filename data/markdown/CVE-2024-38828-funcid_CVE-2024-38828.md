## CVE-2024-38828: Spring Framework DoS Vulnerability

**漏洞编号:** CVE-2024-38828

**漏洞类型:** DoS (Denial of Service)

**影响应用:** Spring Framework

**危害等级:** 中危，可能导致服务中断

**影响版本:** 5.3.x (小于 5.3.42)

**利用条件:** 需要目标应用存在使用 @RequestBody byte[] 的Spring MVC controller 方法，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38828 漏洞存在于 Spring Framework 中，当 Spring MVC 控制器方法使用 `@RequestBody byte[]` 参数时，攻击者可以通过发送具有大的 `Content-Length` 头部但内容为空的 HTTP 请求，触发 `ByteArrayHttpMessageConverter` 不合理的内存分配。这可能导致服务器内存耗尽，最终引发拒绝服务（DoS）。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中包含的测试用例 `testVulnerability()` 模拟了攻击场景，通过发送大量具有大 `Content-Length` 的空请求来验证漏洞。

**投毒风险：**
查看提供的文件列表：
1.  `README.md`: 漏洞描述，利用方法，修复建议，链接。
2.  `CVE-2024-38828/build.gradle.kts`: gradle构建文件，定义了项目依赖和构建配置。只包含了 spring-boot-starter-web, spring-boot-starter-actuator, junit 和 mockito 等常用依赖，没有发现可疑的仓库或依赖。
3.  `CVE-2024-38828/gradlew`: Gradle wrapper脚本，用于在没有预安装 Gradle 的情况下构建项目。

分析代码，没有发现明显的投毒代码。但是，由于 Gradle 构建的灵活性，仍存在一定的潜在风险：

*   **依赖混淆：** 攻击者可能尝试通过修改 `build.gradle.kts` 文件，引入恶意依赖项。但是，提供的 `build.gradle.kts` 文件内容比较简单，没有发现可疑的依赖项。
*   **构建脚本注入：** 攻击者可能尝试通过某种方式修改 `gradlew` 脚本，在构建过程中执行恶意代码。`gradlew` 脚本本身相对安全，风险较低。

综合来看，该仓库中存在恶意投毒代码的风险较低，但不能完全排除。

**利用方式：**
1.  **确定目标：** 找到使用受影响版本的 Spring Framework 的应用程序。
2.  **识别端点：** 寻找接受 `@RequestBody byte[]` 参数的 Spring MVC 控制器方法。
3.  **发送攻击：** 构造具有大的 `Content-Length` 头部但内容为空的 HTTP 请求，发送到目标端点。
4.  **重复攻击：** 重复发送大量这样的请求，直到服务器内存耗尽并崩溃。


**项目地址:** [funcid/CVE-2024-38828](https://github.com/funcid/CVE-2024-38828)

**漏洞详情:** [CVE-2024-38828](https://nvd.nist.gov/vuln/detail/CVE-2024-38828)