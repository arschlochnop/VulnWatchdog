## CVE-2017-0143 - Windows SMB 远程代码执行漏洞（EternalBlue）

**漏洞编号:** CVE-2017-0143

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用SMBv1协议，且未安装MS17-010补丁，攻击者需要网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0143 (EternalBlue) 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及使用 Metasploit Framework，如提供的 POC 代码所示。该漏洞利用的有效性高，因为有多个公开可用的漏洞利用代码和 Metasploit 模块。投毒风险较低 (10%)，主要基于以下考虑：

*   **POC 代码验证：** 提供的 POC 代码主要描述了如何使用 Metasploit 利用 EternalBlue 漏洞，步骤清晰且目标明确，即复现漏洞。
*   **代码文件分析：** 分析了提供的 README.md 和 Steps.md 文件，主要用于指导用户如何搭建环境、配置参数和运行漏洞利用，未发现任何可疑或恶意的代码片段。因此，判断该仓库存在作者隐藏的投毒代码的可能性较低。
*   **风险提示：** POC 代码中包含明确的法律免责声明，提示用户只能在获得授权的系统上进行测试，避免非法使用。这在一定程度上降低了被恶意使用的风险。

**漏洞利用方式：**

1.  **环境准备：** 搭建包含易受攻击的 Windows 系统的实验环境（例如，Windows 7 虚拟机），确保已启用 SMBv1 且未安装 MS17-010 补丁。
2.  **IP 地址获取：** 在攻击者机器（例如，Kali Linux）上确定攻击者和目标系统的 IP 地址。
3.  **漏洞扫描：** 使用 Nmap 等工具扫描目标系统，确认漏洞是否存在。
4.  **Metasploit 利用：** 启动 Metasploit Framework，搜索并选择 EternalBlue 漏洞利用模块（`exploit/windows/smb/ms17_010_eternalblue`）。
5.  **参数配置：** 设置必要的参数，包括目标 IP 地址（RHOST）和攻击者 IP 地址（LHOST）。
6.  **漏洞利用执行：** 运行漏洞利用程序。如果成功，攻击者将获得目标系统的 Meterpreter shell。
7.  **后渗透测试：** 使用 Meterpreter shell 执行各种后渗透测试任务，例如收集系统信息、提升权限、访问文件等。

**总而言之，该漏洞利用有效性高，但请务必在授权环境下使用。**

**项目地址:** [benguelmas/cve-2017-0143](https://github.com/benguelmas/cve-2017-0143)

**漏洞详情:** [CVE-2017-0143](https://nvd.nist.gov/vuln/detail/CVE-2017-0143)