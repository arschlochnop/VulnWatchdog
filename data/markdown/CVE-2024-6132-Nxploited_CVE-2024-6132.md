## CVE-2024-6132-Pexels Free Stock Photos-任意文件上传

**漏洞编号:** CVE-2024-6132

**漏洞类型:** 任意文件上传

**影响应用:** Pexels: Free Stock Photos WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.2.2

**利用条件:** 需要WordPress Contributor及以上权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6132 漏洞存在于 Pexels: Free Stock Photos WordPress 插件 1.2.2 及更早版本中。由于插件缺少文件类型验证，具有 Contributor 或更高级别权限的已认证攻击者可以上传任意文件，包括恶意 PHP 脚本，从而可能导致远程代码执行。

**有效性：**

提供的 POC 代码利用了此漏洞。它首先尝试使用提供的用户名和密码登录到 WordPress 站点。成功登录后，它会提取一个 wpnonce 值，该值用于绕过 CSRF 保护。然后，它构造一个包含指向恶意 PHP 文件 URL 的 image_url 的 POST 请求，并将其发送到 admin-ajax.php 端点。如果上传成功，脚本会尝试提取上传的 shell 文件的路径，并输出 shell 的完整URL。

**投毒风险：**

查看提供的python脚本`CVE-2024-6132.py`，未发现明显的恶意代码。脚本功能正常，执行指定操作。其风险主要来自使用者，如果上传恶意shell，会导致远程代码执行。`LICENSE`声明版权所有者为2025年的Nxploited，这可能是一个笔误，因为漏洞是2024年发现的，但这也引起了一定的怀疑。综合来看，存在一定投毒风险，但概率较低。

**利用方式：**

1.  攻击者需要拥有 WordPress 站点的 Contributor 或更高级别的用户权限。
2.  攻击者准备一个包含恶意 PHP 代码的 shell 文件，并将其托管在可公开访问的 URL 上。
3.  攻击者使用提供的 POC 代码，指定 WordPress 站点 URL、用户名、密码和 shell 文件的 URL。
4.  POC 代码登录到 WordPress 站点，提取 wpnonce 值，并将包含 shell 文件 URL 的 POST 请求发送到 admin-ajax.php 端点。
5.  如果上传成功，攻击者可以通过访问上传的 shell 文件来执行任意代码。

**项目地址:** [Nxploited/CVE-2024-6132](https://github.com/Nxploited/CVE-2024-6132)

**漏洞详情:** [CVE-2024-6132](https://nvd.nist.gov/vuln/detail/CVE-2024-6132)