## CVE-2011-0762-vsftpd-DoS

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致CPU资源耗尽和进程槽耗尽

**影响版本:** < 2.3.3

**利用条件:** 需要FTP服务开启，且攻击者需要通过FTP认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2011-0762 漏洞存在于 vsftpd 2.3.3 之前的版本中，`vsf_filename_passes_filter` 函数在 `ls.c` 文件中存在缺陷。远程已认证的用户可以通过在多个 FTP 会话中使用精心构造的 glob 表达式发送 STAT 命令，导致拒绝服务攻击，具体表现为 CPU 资源耗尽和进程槽耗尽。漏洞利用代码 `cve-2011-0762.c` 实现了通过 FTP 协议连接到目标服务器，使用提供的用户名和密码（或默认的匿名凭据）进行身份验证，然后发送包含大量嵌套花括号的 STAT 命令。这种嵌套结构会触发 `vsf_filename_passes_filter` 函数中的缺陷，导致服务器消耗大量资源并最终崩溃。

**有效性分析：**
根据漏洞描述和搜索结果，此漏洞是真实存在的，并且存在公开的PoC代码。多个安全公告和漏洞数据库条目证实了其有效性。

**投毒风险分析：**
通过分析提供的 `cve-2011-0762.c` 代码，没有发现任何明显的恶意代码或后门。该代码的功能主要是建立 FTP 连接，进行身份验证，并发送特定的 STAT 命令。代码结构清晰，逻辑简单，未发现隐藏的、非预期的行为。因此，判断投毒风险为0%。

**利用方式：**
1.  编译 `cve-2011-0762.c` 漏洞利用代码。
2.  运行编译后的可执行文件，并提供目标 FTP 服务器的主机名、端口、用户名和密码（如果需要身份验证）。
3.  PoC会自动连接到FTP服务器，进行身份验证，并发送恶意的STAT命令。
4.  如果目标服务器运行的是受影响的 vsftpd 版本，且未进行缓解措施，则服务器将开始消耗大量资源，最终可能导致拒绝服务。

**项目地址:** [s3mPr1linux/CVE-2011-0762](https://github.com/s3mPr1linux/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)