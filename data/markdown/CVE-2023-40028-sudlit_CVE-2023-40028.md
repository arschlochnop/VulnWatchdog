## CVE-2023-40028-Ghost-任意文件读取

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost

**危害等级:** 中危，可读取服务器敏感文件

**影响版本:** < 5.59.1

**利用条件:** 需要高权限用户认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40028是Ghost CMS中的一个任意文件读取漏洞。攻击者需要具备Ghost CMS的高权限用户身份（例如管理员）。

**漏洞利用方式：**

1.  **登录验证：** PoC脚本首先使用提供的用户名和密码尝试登录Ghost CMS后台，获取有效的cookie。
2.  **创建Payload：**脚本接收用户输入的文件路径，用于读取服务器上的任意文件。它会创建一个符号链接，将目标文件链接到Ghost CMS的`content/images/2024/`目录下，并将其打包成zip文件（`exploit.zip`）。
3.  **上传ZIP：**脚本模拟文件上传，将包含符号链接的`exploit.zip`文件上传到Ghost CMS。
4.  **触发读取：**上传后，通过访问`GHOST_URL/content/images/2024/{image_name}.png`，触发Ghost CMS读取符号链接指向的文件。
5.  **文件读取：**服务器返回目标文件的内容。
6.  **清理：**移除payload文件。

**有效性：**
根据漏洞信息和PoC代码，此PoC代码在满足版本和权限要求的情况下，是有效的。

**投毒风险：**
该PoC代码主要功能是利用漏洞进行文件读取，在PoC验证后门代码方面没有发现明显的恶意行为。但是脚本中使用了`os.system`和`os.popen`函数执行系统命令，存在潜在的风险。如果用户输入的文件路径包含恶意命令，可能会被执行。此外，脚本中创建和上传zip文件的过程也可能被利用于恶意目的。

总体来说，该PoC代码的投毒风险较低，可能存在的风险主要在于用户输入控制不当和系统命令执行。

**风险评估：**
虽然没有明显的投毒代码，但考虑到`os.system`和`os.popen`的使用，存在一定风险，因此投毒风险评估为10%。

**项目地址:** [sudlit/CVE-2023-40028](https://github.com/sudlit/CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)