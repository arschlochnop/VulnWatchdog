## CVE-2018-1273-Spring Data Commons RCE

**漏洞编号:** CVE-2018-1273

**漏洞类型:** 远程代码执行

**影响应用:** Spring Data Commons

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5, and older unsupported versions

**利用条件:** 需要Spring Data REST支持的HTTP资源或Spring Data的基于投影的请求有效负载绑定

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-1273是Spring Data Commons中的一个属性绑定漏洞，由于对特殊元素的不当处理而导致。未经身份验证的远程恶意用户（或攻击者）可以针对Spring Data REST支持的HTTP资源或使用Spring Data的基于投影的请求有效负载绑定提供特制请求参数，从而导致远程代码执行攻击。

**有效性：**
根据漏洞库信息、搜索结果（如`wearearima/poc-cve-2018-1273`）以及漏洞描述，该漏洞存在已知的PoC利用代码，因此可以判断该漏洞是有效的。

**投毒风险：**
提供的“漏洞利用代码”仅包含Apache License 2.0的许可协议文本，本身不包含任何可执行代码或配置信息，因此直接从中发现投毒代码的可能性极低。但是，如果将许可协议放在漏洞利用项目的根目录下，可能是一种混淆手段，实际的利用代码可能存在恶意行为。因此，投毒风险较低，大概在5%左右。

**利用方式：**
攻击者可以通过以下方式利用此漏洞：
1.  **构造恶意请求参数：** 攻击者构造包含SpEL表达式的恶意请求参数，这些参数将被Spring Data Commons的属性绑定机制处理。
2.  **发送请求到目标端点：** 攻击者将构造的恶意请求发送到Spring Data REST支持的HTTP资源或使用Spring Data的基于投影的请求有效负载绑定的端点。
3.  **SpEL表达式注入和RCE：** Spring Data Commons会解析SpEL表达式，从而允许攻击者执行任意代码。通过SpEL表达式，攻击者可以调用系统命令，读取敏感信息或执行其他恶意操作。

**项目地址:** [webr0ck/poc-cve-2018-1273](https://github.com/webr0ck/poc-cve-2018-1273)

**漏洞详情:** [CVE-2018-1273](https://nvd.nist.gov/vuln/detail/CVE-2018-1273)