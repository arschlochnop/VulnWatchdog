## CVE-2014-6287 - Rejetto HTTP File Server Remote Command Execution

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的HFS版本，并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Rejetto HTTP File Server (HFS) 2.3x版本，具体是parserLib.pas文件中的findMacroMarker函数。攻击者可以通过在搜索操作中利用%00序列来执行任意程序。利用方式如下：

1.  **漏洞触发：** 攻击者构造包含恶意代码的URL，其中利用了HFS的搜索功能以及`%00`截断绕过。
2.  **代码执行：** HFS的`findMacroMarker`函数未能正确处理`%00`，导致后续代码将恶意代码作为宏执行。
3.  **利用步骤（基于提供的POC）：**
    *   **下载Netcat：**  POC首先尝试从攻击者控制的服务器下载`nc.exe`（Netcat）到目标机器的`C:\Users\Public\`目录下。这通过创建并执行一个VBScript脚本来实现。这个VBScript脚本的作用类似于wget，负责从指定的URL下载文件并保存到本地。
    *   **执行Netcat：** 下载完成后，POC尝试执行Netcat，并将其配置为反向shell，连接到攻击者的IP地址和端口。这意味着攻击者可以在目标机器上获得一个命令行界面。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明此漏洞是真实存在的，并且有可利用的POC。
*   提供的Python脚本利用了该漏洞的原理，构造特定的HTTP请求来触发漏洞，并最终执行任意命令。
*   该POC代码依赖于目标机器为Windows环境，并且需要攻击者事先准备好一个可以访问的HTTP服务器，用于托管`nc.exe`。

**投毒风险分析：**

*   查看了提供的POC代码，没有发现明显的投毒行为。POC代码的功能主要是利用漏洞在目标系统上执行命令，并没有在攻击者系统上执行任何操作，或者传播恶意代码。
*   代码的主要目的是下载并执行 Netcat，创建一个反向 Shell。 这里的风险在于，如果攻击者控制的 HTTP 服务器被篡改，提供了一个恶意版本的 `nc.exe`，那么目标系统将会受到恶意软件感染。
*   因此，该漏洞利用本身并不存在直接的投毒风险，但使用未经验证的 `nc.exe` 可能会引入风险。

**总结：**

该漏洞是一个高危漏洞，允许未经身份验证的远程攻击者在目标服务器上执行任意代码。利用方式相对简单，但需要一些前期准备工作，如准备Netcat和搭建HTTP服务器。提供的POC代码有效，但需要确保使用的Netcat是安全可靠的。代码本身没有明显的投毒风险，风险主要在于使用的第三方工具（如 Netcat）的来源。

**项目地址:** [roughiz/cve-2014-6287.py](https://github.com/roughiz/cve-2014-6287.py)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)