## CVE-2025-31161 - CrushFTP Authentication Bypass and User Creation Exploit

**漏洞编号:** CVE-2025-31161

**漏洞类型:** Authentication Bypass

**影响应用:** CrushFTP

**危害等级:** 高危，可导致完全服务器控制

**影响版本:** 10 before 10.8.4, 11 before 11.3.1

**利用条件:** 目标 CrushFTP 实例必须未应用补丁且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞，允许未经身份验证的攻击者创建新的管理用户并完全控制服务器。根据漏洞库信息和搜索结果，该漏洞已被积极利用。漏洞利用代码 `README.md` 描述了一个 Python 脚本，该脚本通过发送特制的 XML payload 到 WebInterface 来创建一个新的管理员用户。该脚本需要 `requests` 和 `colorama` 库。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是 Huntress 的博客）以及漏洞利用代码中的描述，可以确认该漏洞是有效的，并且已经被在野利用。该漏洞利用代码似乎实现了利用漏洞创建用户的过程。

**投毒风险:**

分析提供的代码，该漏洞利用代码主要由一个 `README.md` 文件组成，其中描述了如何使用一个名为 `CVE-2025-31161.py` 的Python脚本来利用该漏洞。目前只提供了 `README.md` 文件的内容,无法确定脚本本身是否携带恶意代码。根据作者声明此工具仅用于授权安全测试目的。投毒风险评估为 10%，因为在缺少实际可执行的 Python 脚本情况下, 仅能推测存在隐藏恶意行为的可能性。如果Python脚本内容包含远程下载恶意 payload 或者执行其他恶意操作的代码，那么投毒的风险会更高，但根据现有的信息，只能初步评估为较低的风险。

**利用方式:**

利用方式是向 CrushFTP WebInterface 发送特制的 XML payload 来创建一个新的用户账户（通常是管理员权限）。成功创建账户后，攻击者就可以使用新账户登录并完全控制服务器。具体步骤如下：

1.  **准备:** 安装Python环境和所需的依赖库 (`requests`, `colorama`)。
2.  **配置:** 根据目标 CrushFTP 实例的 IP 地址、端口和想要创建的用户名、密码等信息配置漏洞利用脚本。
3.  **执行:** 运行漏洞利用脚本，脚本会发送特制的 HTTP 请求到目标服务器。
4.  **控制:** 如果漏洞利用成功，使用新创建的用户凭据登录 CrushFTP 管理界面，并获取对服务器的完全控制权。

根据 Censys 的数据，存在大量暴露在外的 CrushFTP 实例，其中一部分存在该漏洞，使得该漏洞具有较高的潜在影响。

**项目地址:** [0xgh057r3c0n/CVE-2025-31161](https://github.com/0xgh057r3c0n/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)