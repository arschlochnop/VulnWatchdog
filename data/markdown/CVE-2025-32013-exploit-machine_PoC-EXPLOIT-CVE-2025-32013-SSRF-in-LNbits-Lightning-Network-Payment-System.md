## CVE-2025-32013-LNbits-SSRF

**漏洞编号:** CVE-2025-32013

**漏洞类型:** SSRF

**影响应用:** LNbits

**危害等级:** 高危，可能导致内部资源泄露和权限提升

**影响版本:** <= 0.12.12

**利用条件:** 需要LNbits服务运行，且LNURL authentication功能开启。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-32013是LNbits的LNURL认证处理功能中的一个服务器端请求伪造（SSRF）漏洞。由于应用程序在处理LNURL认证请求时，没有充分验证回调URL，攻击者可以指定内部网络地址，迫使服务器向内部资源发起请求。 

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。漏洞库信息表明该漏洞已被公开披露，且存在受影响的版本。搜索引擎结果也印证了这一点，提供了多个关于该漏洞的描述和分析链接。

POC代码提供了一个利用该漏洞的步骤，通过修改LNURL callback请求，将目标主机替换为内部IP地址或域名，从而验证服务器是否会向该地址发起请求。提供的步骤较为详细，包括验证LNbits版本、创建钱包、使用lightninglogin.live、抓包并修改请求等。这些步骤能够帮助攻击者快速理解和复现该漏洞。

**投毒风险：**

POC代码本身看起来并不包含明显的投毒代码。它主要描述了如何利用该SSRF漏洞。但是，Telegram频道链接的存在引入了一定的风险。虽然POC本身没有恶意代码，但通过引导用户访问外部链接（Telegram频道），存在潜在的投毒风险。攻击者可能在Telegram频道中分享包含恶意软件或其他攻击payload的内容，从而进一步危害用户的系统安全。基于此，投毒风险评估为20%。

**利用方式：**

1.  **目标确认:** 确认目标LNbits服务启用了LNURL认证功能，并且版本小于等于0.12.12。
2.  **构造恶意LNURL:**  攻击者构造一个恶意的LNURL，其中包含一个指向内部网络地址的回调URL。例如，`http://127.0.0.1`或者内部服务的域名。
3.  **发起认证请求:**  用户（或攻击者控制的用户）使用LNURL认证流程，当LNbits服务器处理该LNURL时，会向攻击者指定的回调URL发起HTTP请求。
4.  **获取内部资源:**  如果服务器成功连接到内部资源，攻击者可以获得该资源的响应内容，例如服务器配置信息、内部服务状态等。
5.  **进一步利用:** 攻击者可以根据获取的内部资源信息，进一步利用其他漏洞，例如进行权限提升、远程代码执行等。

总的来说，该漏洞利用方式相对简单，但危害性较高，可能导致敏感信息泄露和内部网络暴露。

**项目地址:** [exploit-machine/PoC-EXPLOIT-CVE-2025-32013-SSRF-in-LNbits-Lightning-Network-Payment-System](https://github.com/exploit-machine/PoC-EXPLOIT-CVE-2025-32013-SSRF-in-LNbits-Lightning-Network-Payment-System)

**漏洞详情:** [CVE-2025-32013](https://nvd.nist.gov/vuln/detail/CVE-2025-32013)