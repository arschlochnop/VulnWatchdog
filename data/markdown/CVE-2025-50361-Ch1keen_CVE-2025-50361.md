## CVE-2025-NA-SmallBASIC全局缓冲区溢出

**漏洞编号:** CVE-2025-50361

**漏洞类型:** 全局缓冲区溢出

**影响应用:** SmallBASIC

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** commit 02364eff880ba62afac67bcceebafade2b40d21f 之前的版本

**利用条件:** 需要执行SmallBASIC程序，且可以控制命令行参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于SmallBASIC的`src/platform/sdl/main.cpp`的`main`函数中。当程序解析命令行参数时，使用`strcpy`函数将参数复制到全局变量`opt_command`中，而`strcpy`不会进行边界检查。如果命令行参数的长度超过`OPT_CMD_CZ`（1024字节），则会发生全局缓冲区溢出，覆盖相邻内存区域。攻击者可以通过构造特制的命令行参数来覆盖内存，从而控制程序流程，甚至执行任意代码。

**有效性：** 提供的POC代码是有效的。POC展示了如何通过提供一个长度超过1024字节的字符串作为命令行参数来触发缓冲区溢出，并提供了Address Sanitizer的输出作为验证。

**投毒风险：** POC代码本身是无害的，仅用于演示漏洞。但是，考虑到该漏洞可能允许任意代码执行，如果开发者下载了包含恶意构建版本的SmallBASIC，并受到攻击者的诱导，执行特制的利用代码，那么整个SmallBASIC项目就有可能被投毒。POC的目的是触发缓冲区溢出，但并未展示具体的恶意代码注入。因此，投毒风险极低，评定为1%。

**利用方式：**
1.  构建存在漏洞的SmallBASIC版本。
2.  使用构造的命令行参数（长度超过1024字节的字符串）运行`sbasicg`程序。
3.  程序执行`strcpy`时，会将超长字符串复制到`opt_command`，导致缓冲区溢出。
4.  攻击者可以通过精心构造超长字符串的内容，覆盖相邻内存区域，从而控制程序流程，最终实现任意代码执行。例如，攻击者可以覆盖函数指针，将其指向恶意代码的地址。

由于NVD的网页提供了2025年的CVE信息，考虑到年份的时间顺序，故将搜索结果优先级提到最高。


**项目地址:** [Ch1keen/CVE-2025-50361](https://github.com/Ch1keen/CVE-2025-50361)

**漏洞详情:** [CVE-2025-50361](https://nvd.nist.gov/vuln/detail/CVE-2025-50361)