## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要Exchange Control Panel (ECP)可访问，且攻击者需要具有低权限的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞，该漏洞源于Exchange Control Panel (ECP)未能正确处理内存中的对象。成功利用此漏洞的攻击者可以在运行Exchange的服务器上以SYSTEM权限执行任意代码。利用方式通常涉及以下步骤：

1.  **获取有效凭据：** 攻击者首先需要获取一个有效的Exchange用户帐户的凭据，可以通过暴力破解、钓鱼或其他方式。
2.  **构造恶意请求：** 攻击者构造一个包含恶意序列化对象的特制HTTP请求，发送到Exchange服务器的ECP接口。这个请求通常利用了.NET ViewState的反序列化漏洞。
3.  **利用静态密钥：** 该漏洞的关键在于Exchange使用的静态密钥。攻击者利用此密钥来加密和签名ViewState数据，使其能够被服务器接受。
4.  **远程代码执行：** 当Exchange服务器处理恶意请求时，它会反序列化其中的对象，从而导致执行攻击者注入的任意代码，通常以SYSTEM权限运行。

根据提供的POC代码，该代码尝试通过`socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_RAW)`创建一个原始套接字来建立反向Bind Shell, 如果连接超时，将打印错误信息。同时还尝试从目标机器上通过GET方法获取IP，用户名等信息。这可能存在一定的投毒风险，作者可能将一些恶意代码隐藏在这些函数里，例如,收集用户信息的代码。考虑到风险，投毒风险评估为10%。

搜索引擎结果确认了该漏洞的存在和严重性，并指出有在野利用的案例。Rapid7的博客文章强调了攻击者如何利用此漏洞将任何被盗的Exchange用户帐户转变为完整的系统入侵。

总而言之，该漏洞利用的有效性较高，因为存在公开可用的POC代码和在野利用的报告。虽然POC本身可能没有明显的恶意投毒代码，但使用任何第三方提供的漏洞利用代码都应谨慎，因为其中可能包含未公开的恶意功能。

**项目地址:** [ktpdpro/CVE-2020-0688](https://github.com/ktpdpro/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)