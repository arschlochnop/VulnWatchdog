## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，存在漏洞版本的Sudo

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2025-32463是Sudo的一个本地权限提升漏洞，存在于1.9.14到1.9.17p1之前的版本。该漏洞允许本地用户通过 `--chroot` 选项和精心构造的 `/etc/nsswitch.conf` 文件获得root权限。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是一个已经确认的，并且存在利用方法的本地权限提升漏洞。利用代码片段中，开发者执行exploit，从而导致提权成功。

**投毒风险分析：**

漏洞利用代码本身不包含明显的恶意代码。但代码中通过pip安装了外部的package，攻击者可能会通过发布恶意的package，控制受害者的shell,之后通过下载和运行rootkit，从而植入内核模块，并配置udev规则，计划重新启动,可能会造成系统持久化感染。因此存在较高的投毒风险。具体如下：

1.  **供应链投毒：**
    *   攻击者首先通过PyPI投毒，上传一个高版本（v1.0.1）的恶意包，诱导开发者安装。
    *   开发者在内部环境中使用`pip install --extra-index-url internal package==x.y.z` 命令，优先从内部依赖服务器(IntDep)拉取，如果内部版本过低（v0.0.1），则会fallback到PyPI拉取被投毒的v1.0.1版本。
    *   被投毒的包包含一个stager (package_evil)，在安装时会被执行，反弹shell到攻击者的C2服务器。

2.  **提权后的Rootkit植入：**
    *   攻击者利用CVE-2025-32463漏洞提权到root权限后，会下载并执行一个rootkit loader，该loader会安装内核模块并配置udev规则，并计划重启。
    *   重启后，udev会加载恶意的内核模块，该模块会再次连接C2服务器，实现持久化控制。

**漏洞利用方式：**

1.  **前提条件：** 目标系统需要存在漏洞版本的Sudo（1.9.14 <= version < 1.9.17p1），并且攻击者需要具备本地用户权限。
2.  **漏洞触发：** 攻击者创建一个恶意的 `/etc/nsswitch.conf` 文件。
3.  **权限提升：** 攻击者使用 `sudo --chroot /path/to/evil/root /bin/sh` 命令，其中 `/path/to/evil/root` 是包含恶意 `nsswitch.conf` 文件的目录。由于Sudo在完全解析 sudoers 文件之前就改变了根目录，因此会加载攻击者控制的 `nsswitch.conf`，从而导致权限提升。

**风险评估总结：**

虽然CVE-2025-32463漏洞本身是利用Sudo的 `--chroot` 选项和对 `nsswitch.conf` 文件处理不当导致的权限提升，但结合漏洞利用代码中包含的外部依赖包安装和rootkit loader下载执行，存在较高的供应链投毒和内核级后门植入风险。代码中有license文件为GPLv3. 

投毒代码可能存在于通过PyPI拉取的package，以及rootkit loader binary之中，因此有一定比例的投毒风险。

**项目地址:** [IC3-512/linux-root-kit](https://github.com/IC3-512/linux-root-kit)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)