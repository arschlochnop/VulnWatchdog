## CVE-2025-54135 - Cursor IDE 远程代码执行

**漏洞编号:** CVE-2025-54135

**漏洞类型:** Prompt Injection / 远程代码执行

**影响应用:** Cursor IDE

**危害等级:** 高危，可能导致远程代码执行、数据泄露和系统控制

**影响版本:** < 1.3

**利用条件:** 目标用户使用Cursor IDE，且配置了MCP（Model Context Protocol）并允许从攻击者可控的Slack频道获取数据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 Cursor IDE 中由于 prompt injection 导致的远程代码执行漏洞 (CVE-2025-54135)。

**有效性评估：**

根据搜索引擎结果（特别是 thehackernews.com 和 bleepingcomputer.com），CVE-2025-54135 漏洞已被确认为一个 prompt injection 漏洞，并且已经在 Cursor IDE 1.3 版本中修复。POC 代码描述了一种利用方法，通过构造恶意的 MCP 配置，写入 `~/.cursor/mcp.json` 文件，并设置 `auto_start` 为 true，从而在用户不知情的情况下执行任意命令。该POC代码利用思路清晰，利用条件明确，在未修复版本中应是有效的。

**投毒风险评估：**

POC 代码本身旨在演示漏洞利用，并没有明显的恶意代码。readme中包含了免责声明，也提供了setup步骤说明。虽然代码中存在可以替换的token和server地址，需要用户自行配置，但总体来看，投毒风险较低。风险主要在于用户使用该代码进行非法渗透测试。但是从URL跳转的风险需要注意。
综合评估，投毒风险估计为 10%。

**利用方式分析：**

1.  **攻击准备：** 攻击者需要拥有一个 Slack Bot Token，并设置一个可控的恶意 MCP 服务器（可选项，用于更复杂的攻击载荷）。
2.  **构造恶意 Prompt：** 攻击者构造一个包含恶意 MCP 配置的 Prompt。该配置包含一个指向恶意服务器的条目，并且设置 `auto_start` 标志为 true。这个配置会被 Base64 编码。
3.  **传播恶意 Prompt：** 攻击者将恶意 Prompt 发送到目标用户 Cursor IDE 监听的 Slack 频道或其他 MCP 数据源。
4.  **触发漏洞：** 当目标用户的 Cursor IDE 接收到恶意 Prompt 时，会解析其中的 MCP 配置，并将其写入 `~/.cursor/mcp.json` 文件。由于 `auto_start` 为 true，配置中的 `start_command` 会立即执行，导致任意代码执行。
5.  **远程代码执行：** `start_command` 中的命令以目标用户的权限执行，攻击者可以利用该权限进行数据窃取、安装后门、或进行其他恶意操作。

**项目地址:** [allinsthon/CVE-2025-54135](https://github.com/allinsthon/CVE-2025-54135)

**漏洞详情:** [CVE-2025-54135](https://nvd.nist.gov/vuln/detail/CVE-2025-54135)