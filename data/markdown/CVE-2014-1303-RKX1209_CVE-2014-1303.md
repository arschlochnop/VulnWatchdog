## CVE-2014-1303-Apple Safari 7.0.2-堆缓冲区溢出

**漏洞编号:** CVE-2014-1303

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Apple Safari

**危害等级:** 高危，允许远程攻击者执行任意代码并绕过沙箱保护机制

**影响版本:** 7.0.2

**利用条件:** 需要用户使用Safari 7.0.2 访问包含恶意代码的网页

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-1303 是 Apple Safari 7.0.2 中的一个堆缓冲区溢出漏洞。该漏洞允许远程攻击者通过未指定的向量执行任意代码并绕过沙箱保护机制。该漏洞在 CanSecWest 2014 的 Pwn2Own 比赛中由 Liang Chen 演示。

**有效性:**
根据漏洞库信息和搜索结果，该漏洞存在于 Safari 7.0.2 中，且已被成功利用。提供的PoC代码在Linux环境的WebKitGTK 2.1.2上进行了移植和测试，表明该漏洞具有一定的可利用性。

**投毒风险:**
PoC代码本身的目的在于验证漏洞的存在和利用方法，主要包含以下几个部分：
*   `exploit.html`: 触发漏洞并跳转到ROP链。
*   `scripts/roputil.js`: ROP构建的实用程序。
*   `scripts/syscall.js`: 系统调用ROP链。
*   `scripts/code.js`: 硬编码的远程加载器。
*   `loader/`: 简单的远程加载器（用C编写）。
*   `loader/bin2js`: 将二进制文件转换为js变量（用于加载器）。

分析PoC代码，发现其功能主要是为了演示漏洞利用，例如崩溃、获取PID、代码执行和文件系统转储。 其中`scripts/code.js`和 `loader/`目录下的代码存在潜在的风险，可能会被修改成恶意代码。
作者可能存在的投毒行为，例如：
*   **修改远程加载器:**  `loader/`目录下的C代码或者`scripts/code.js`加载的payload，可能被替换成具有恶意功能的代码，例如植入后门、窃取信息等。
*   **ROP链的篡改:**  ROP链可能会被修改，从而执行恶意操作。

综合考虑，虽然PoC代码的主要目的是演示漏洞，但远程加载器和ROP链存在被篡改的风险，从而实现投毒，但考虑到其目的是用于教育目的，投毒概率较低，估算投毒风险为 10%。

**利用方式:**
1.  攻击者创建一个包含恶意 JavaScript 代码的网页（`exploit.html`）。
2.  用户使用 Safari 7.0.2 访问该网页。
3.  `exploit.html` 中的 JavaScript 代码利用堆缓冲区溢出漏洞，覆盖内存。
4.  攻击者利用 ROP 链（由 `scripts/roputil.js` 和 `scripts/syscall.js` 构建）绕过沙箱保护机制。
5.  攻击者通过远程加载器（`scripts/code.js` 和 `loader/`）从外部网络加载并执行恶意代码。
6.  恶意代码在受害者的计算机上执行，实现远程代码执行。

该漏洞利用过程需要用户交互（访问恶意网页），且依赖于特定的 Safari 版本。攻击者需要精心构造 JavaScript 代码和 ROP 链，才能成功利用该漏洞。

**项目地址:** [RKX1209/CVE-2014-1303](https://github.com/RKX1209/CVE-2014-1303)

**漏洞详情:** [CVE-2014-1303](https://nvd.nist.gov/vuln/detail/CVE-2014-1303)