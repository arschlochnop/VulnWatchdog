## CVE-2025-27410-PwnDoc-RCE

**漏洞编号:** CVE-2025-27410

**漏洞类型:** 路径遍历导致任意文件写入 -> RCE

**影响应用:** PwnDoc

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.2.0

**利用条件:** 需要具备`backups:create` 和 `backups:update`权限（默认仅管理员拥有）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-27410 存在于 PwnDoc 1.2.0 之前的版本中。漏洞是由于备份恢复功能在处理 TAR 文件条目名称时存在路径遍历漏洞。攻击者可以利用此漏洞，通过上传包含恶意构造的 TAR 文件，覆盖系统中的任意文件。提供的POC代码通过覆盖`/app/src/lib/passwordpolicy.js`文件，在其中植入恶意代码，实现远程代码执行。具体利用方式如下：

1.  **身份验证:** 使用管理员账户（USERNAME, PASSWORD）登录 PwnDoc。
2.  **创建恶意TAR文件:** `create_tarslip`函数创建一个包含恶意文件的TAR文件。该函数利用路径遍历漏洞，将恶意代码写入到指定的文件路径，通过构造`../`绕过路径限制。
3.  **上传恶意TAR文件:** `upload_backup`函数将创建的TAR文件作为备份上传到PwnDoc服务器。
4.  **恢复备份:** `restore_backup`函数触发备份恢复过程，将TAR文件中的内容写入到文件系统中。由于路径遍历漏洞，恶意代码被写入到`/app/src/lib/passwordpolicy.js`文件中。
5.  **触发RCE:**  覆盖`/app/src/lib/passwordpolicy.js`后，会执行`require('child_process').execSync('id > /tmp/pwned')`命令，将`id`命令的输出写入`/tmp/pwned`文件中，实现远程代码执行。最后，通过`create_crash`函数创建并上传一个crash的tar包，restore后导致服务重启，使得被篡改的js文件生效。

**关于投毒风险：**

经过分析，提供的POC代码主要目的是验证漏洞的存在和利用方式，没有发现任何明显的投毒行为。其中`/tmp/pwned` 是验证漏洞的后门，用于验证代码执行，不属于投毒。`create_crash` 函数创建的 crash tar 包用于触发服务重启，从而使被篡改的 js 文件生效，不是投毒行为。作者意图明确，是为了方便漏洞验证。

因此，此仓库中隐藏投毒代码的风险较低，评估为0%。

**项目地址:** [shreyas-malhotra/CVE-2025-27410](https://github.com/shreyas-malhotra/CVE-2025-27410)

**漏洞详情:** [CVE-2025-27410](https://nvd.nist.gov/vuln/detail/CVE-2025-27410)