## CVE-2024-24919-Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，允许未经身份验证的远程攻击者读取Check Point Security Gateway上的任意文件

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 目标Check Point Security Gateway需启用远程接入VPN或移动接入软件 Blades，且可从互联网访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中存在的一个高危信息泄露漏洞。攻击者可以利用该漏洞，通过发送特制的HTTP POST请求到 `/clients/MyCRL` 端点，读取目标系统上的任意文件。攻击利用了路径遍历漏洞，通过在请求体中包含 `aCSHELL/` 前缀和包含目录遍历字符的路径，即可绕过权限验证，读取文件内容，例如 `/etc/shadow`。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞利用的有效性较高。CISA已将此漏洞添加到已知被利用的漏洞目录(KEV)中，表明该漏洞正在被积极利用。

**投毒风险:**
提供的POC代码主要功能是利用漏洞读取文件内容，本身没有发现明显的恶意代码（如反弹shell、植入后门等）。但是，需要注意以下几点：

1.  **依赖风险:**  该POC依赖 `requests` 和 `colorama` 等第三方库。如果这些库被恶意篡改，可能会引入安全风险。
2.  **免责声明:**  虽然POC代码包含免责声明，但使用不当可能导致非法入侵行为。攻击者可能会利用该POC进行恶意攻击，因此存在被滥用的风险。
3.  **代码简洁性:** POC代码非常简洁，功能单一，主要就是构造请求和读取返回信息，恶意代码隐藏的可能性较低。`exploit.py`脚本本身逻辑简单，仅包含发送请求和打印结果，但不能排除未来版本被添加恶意功能。

综合评估，认为该仓库存在作者隐藏的投毒代码的风险较低，约为10%。这个评估基于代码的简单性，以及大部分代码是为验证漏洞的存在，而不是持久化或进行恶意行为。

**利用方式:**

1.  **确定目标:** 确定存在漏洞的Check Point Security Gateway，并确保已启用远程接入VPN或移动接入软件。
2.  **发送恶意请求:**  使用POC脚本，指定目标URL和要读取的文件路径。脚本会构造一个包含路径遍历的POST请求，发送到 `/clients/MyCRL` 端点。
3.  **读取文件:**  如果目标存在漏洞，服务器会返回请求的文件内容，攻击者即可获取敏感信息。

例如，可以使用以下命令读取 `/etc/shadow` 文件：

```
python3 exploit.py
```

然后，根据提示输入目标URL和 `/etc/shadow` 路径。


**项目地址:** [Rug4lo/CVE-2024-24919-Exploit](https://github.com/Rug4lo/CVE-2024-24919-Exploit)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)