## CVE-2025-54424-1Panel-RCE

**漏洞编号:** CVE-2025-54424

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** 1Panel

**危害等级:** 高危，未经授权的访问可能导致完全的系统控制。

**影响版本:** < 2.0.6

**利用条件:** 目标系统运行着存在漏洞的1Panel版本，攻击者可以访问目标系统的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54424 存在于 1Panel 的 2.0.6 之前版本。该漏洞是由于 Core 和 Agent 端点之间的 HTTPS 通信在证书验证期间存在缺陷，允许未经授权的接口访问。由于 1Panel 中存在大量的命令执行或高权限接口，这导致了远程代码执行 (RCE)。

**有效性：**

POC代码看起来是有效的。它模拟了客户端，生成自签名证书，尝试通过 HTTPS 访问 API 接口，并尝试建立 WebSocket 连接，利用了服务器端不充分的证书验证。

**利用方式：**

1.  生成伪造的客户端证书，CN为`panel_client`。
2.  使用伪造的证书与目标1Panel服务器建立HTTPS连接，绕过证书验证。
3.  通过HTTPS预检,访问`/api/v2/dashboard/base/os`，验证漏洞是否存在。
4.  如果预检成功，尝试使用伪造的证书建立WebSocket连接到`/api/v2/hosts/terminal`，获取交互式shell。
5.  建立WebSocket连接后，可以发送命令到服务器执行，实现远程代码执行。

**投毒风险：**

代码中存在一定的投毒风险，可能性评估为10%。风险点在于:

*   **依赖第三方库：** 代码依赖 `requests`、`websocket-client` 和 `cryptography` 等第三方库，虽然这些库本身很常用，但如果这些库被恶意篡改，可能会引入安全问题。
*   **证书生成逻辑：**  虽然代码动态生成自签名证书，但在实际环境中，攻击者可能会使用预先生成的恶意证书，而这些证书可能包含其他恶意代码。
*   **交互式shell中的植入:** 代码中交互式shell功能存在被植入恶意代码的可能，例如记录用户输入、上传敏感信息等。由于代码中对输入和输出的检查较少，存在一定风险。
*   **代理设置的风险：** 代码支持通过代理进行连接，如果攻击者使用恶意的代理服务器，可能会导致中间人攻击或其他安全问题。

**总结：**

该漏洞是一个严重的安全问题，利用难度相对较高(需要生成证书和绕过验证)，但一旦成功利用，可以完全控制受影响的服务器。POC代码较为完整，能够有效验证和利用该漏洞。需要关注POC中可能存在的投毒风险。

**项目地址:** [bejbitoilet5125521/CVE-2025-54424](https://github.com/bejbitoilet5125521/CVE-2025-54424)

**漏洞详情:** [CVE-2025-54424](https://nvd.nist.gov/vuln/detail/CVE-2025-54424)