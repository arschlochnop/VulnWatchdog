## CVE-2023-0461 Linux Kernel Use-After-Free

**漏洞编号:** CVE-2023-0461

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel < 2c02d41d71f90a5168391b6a5f2954112ba2307c

**利用条件:** 需要启用 CONFIG_TLS 或 CONFIG_XFRM_ESPINTCP 配置项

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-0461 是 Linux Kernel 中的一个 use-after-free 漏洞，允许本地用户提升权限。根据漏洞库信息，该漏洞存在于`struct inet_connection_sock` 的 `icsk_ulp_data` 字段中。当启用了 `CONFIG_TLS` 或 `CONFIG_XFRM_ESPINTCP` 内核配置时，攻击者可以在已连接的 TCP socket 上安装 TLS 上下文（`struct tls_context`）。如果该 socket 断开连接并被重用为监听器，则该上下文不会被清除。如果从该监听器创建新的 socket，则上下文会被继承，从而导致 use-after-free。`setsockopt TCP_ULP` 操作不需要任何权限。

利用方式：

1.  创建一个 TCP socket 并连接到某个地址。
2.  在该 socket 上安装 TLS 上下文。
3.  断开该 socket 的连接，并将其重新用作监听器。
4.  从该监听器创建一个新的 socket。
5.  触发 `icsk_ulp_data` 的 use-after-free，从而实现权限提升。

根据提供的漏洞利用代码，该代码仅包含MIT许可协议，没有发现任何投毒代码，因此投毒风险为0%。

搜索引擎结果表明，该漏洞已被广泛报道，并且存在公开的 PoC。


**项目地址:** [b1nhack/CVE-2023-0461](https://github.com/b1nhack/CVE-2023-0461)

**漏洞详情:** [CVE-2023-0461](https://nvd.nist.gov/vuln/detail/CVE-2023-0461)