## CVE-2023-23752 - Joomla! Improper Access Control

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 权限绕过/信息泄露

**影响应用:** Joomla! CMS

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 4.0.0-4.2.7

**利用条件:** 目标Joomla!站点启用了webservice endpoints，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23752 是一个 Joomla! CMS 4.0.0 到 4.2.7 版本中的权限绕过漏洞。由于不正确的访问控制，未经授权的攻击者可以访问webservice endpoints，从而可能获取敏感信息。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，且已经被公开披露和利用。提供的PoC代码（`run.py`）尝试通过构造特定的URL（`api/index.php/v1/config/application?public=true`）来访问webservice endpoints，并提取数据库配置信息。如果`validate(response.text)` 返回True，则表示漏洞存在，并将结果写入文件。

**投毒风险分析：**

分析提供的PoC代码，发现潜在的投毒风险较低，但不能完全排除：

*   `run.py`:  该脚本的主要功能是扫描目标URL列表，并尝试利用漏洞获取数据库配置。脚本本身没有明显的恶意代码，例如执行系统命令或上传恶意文件。
*   `requirements.txt`: 列出了一些常用的Python库，如`requests`，`certifi`等。这些库本身没有问题，但如果安装过程中使用了恶意的PyPI镜像源，则可能存在被替换为恶意包的风险。不过，这并非PoC代码本身的问题。
*   虽然脚本没有直接的恶意行为，但其目的是利用漏洞获取敏感信息。如果被恶意使用者利用，可能会对目标系统造成损害。
*   `extra/parser.py`和`extra/requester.py`代码未提供，无法评估是否包含恶意代码。

总体来说，该PoC代码的投毒风险较低，但是需要注意运行环境的安全性，并从官方PyPI源安装依赖库。

**利用方式：**

1.  安装所需的Python库：`pip3 install -r requirements.txt`
2.  准备目标URL列表，每行一个URL，保存为`web_list`文件中。
3.  运行`run.py`脚本，输入目标URL列表文件路径和线程数。
4.  脚本将尝试利用漏洞，如果成功，会将结果保存到`data/result/{日期}.txt`文件中。

该漏洞的利用方式相对简单，只需要提供目标URL列表即可。攻击者可以利用该漏洞批量扫描目标，获取敏感信息。

**项目地址:** [MrP4nda1337/CVE-2023-23752](https://github.com/MrP4nda1337/CVE-2023-23752)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)