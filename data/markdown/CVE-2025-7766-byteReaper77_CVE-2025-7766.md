## CVE-2025-7766-Lantronix Provisioning Manager-XXE

**漏洞编号:** CVE-2025-7766

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Lantronix Provisioning Manager

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 7.10.2

**利用条件:** 需要相邻网络访问，用户交互（被动）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Lantronix Provisioning Manager 中，由于其在处理网络设备提供的配置文件时存在 XML 外部实体注入漏洞。攻击者可以通过构造恶意的 XML 配置文件，利用 XXE 漏洞读取服务器上的敏感文件（如/etc/passwd），或者发起出站 HTTP 请求。

**有效性评估：**

*   根据漏洞库信息和搜索引擎结果，该漏洞已被公开披露，并且分配了 CVE 编号 CVE-2025-7766。
*   提供的 POC 代码（exploit.c）演示了如何利用该漏洞读取文件和发起出站 HTTP 请求，证明了漏洞的可利用性。
*   POC代码的README.md文件提供了编译和使用的详细信息，包括各种payload的用法。

**投毒风险评估：**

*   代码结构清晰，主要功能集中在构造和发送恶意 XML payload，以及处理 HTTP 响应。
*   `exitSyscall()` 函数直接使用汇编代码调用 exit 系统调用，虽然不常见，但符合快速退出的逻辑，并不能直接判定为恶意代码。
*   整个代码中发现的唯一潜在风险是依赖外部服务器来托管或捕获 XXE 请求的数据，这可能导致依赖问题或潜在的中间人攻击，但是这不属于投毒。
*   代码中存在请求标志，可能需要请求外部资源，存在风险。
*   投毒风险评估：极低，约为 5%，因为代码主要功能是利用 XXE 漏洞，没有发现明显的恶意逻辑。

**漏洞利用方式：**

1.  **目标确认:** 确定目标系统上安装了存在漏洞的 Lantronix Provisioning Manager 版本 (<= 7.10.2)。
2.  **Payload 选择:** 根据攻击目标选择合适的 XXE Payload。
    *   **文件读取:** 构造包含 `file:///etc/passwd` 的 XML Payload 读取目标系统上的 `/etc/passwd` 文件。
    *   **出站 HTTP 请求:** 构造包含外部 HTTP 实体的 XML Payload，使目标系统发起对攻击者控制的服务器的 HTTP 请求，从而实现信息泄露。
3.  **发送 Payload:** 将构造的恶意 XML Payload 作为配置文件发送给 Lantronix Provisioning Manager 处理。
4.  **漏洞触发:** 当 Lantronix Provisioning Manager 解析包含恶意 XML Payload 的配置文件时，XXE 漏洞被触发。
5.  **结果获取:**
    *   **文件读取:** 从 Lantronix Provisioning Manager 的响应中获取 `/etc/passwd` 文件的内容。
    *   **出站 HTTP 请求:** 在攻击者控制的服务器上捕获目标系统发起的 HTTP 请求，获取泄露的信息。

**项目地址:** [byteReaper77/CVE-2025-7766](https://github.com/byteReaper77/CVE-2025-7766)

**漏洞详情:** [CVE-2025-7766](https://nvd.nist.gov/vuln/detail/CVE-2025-7766)