## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)