## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许攻击者在目标机器上执行任意代码

**影响版本:** 2.12.0

**利用条件:** 需要目标机器安装了受影响版本的Git LFS，并且用户克隆了包含恶意LFS对象的仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 中的一个远程代码执行 (RCE) 漏洞。该漏洞的利用方式是，攻击者可以创建一个包含恶意 LFS 对象的 Git 仓库。当受害者克隆该仓库时，Git LFS 会尝试下载这些恶意对象，从而导致在受害者机器上执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它包含以下组件：
    * `README.md`: 描述了漏洞和利用方法，并列出了受影响的应用程序。
    * `big-bug-lfs-file.dat`:  一个 LFS 对象示例，用于触发漏洞。
    * `git.bat`: 一个批处理脚本，用于演示如何利用该漏洞。该脚本会创建一个文件`GITHACKED`，并且尝试执行 PowerShell 脚本以建立反向 shell。其中反向shell的目标ip和端口为 deelmind.lab 和 1337
    * `revsh_powersh.ps1`:  一个 PowerShell 脚本，用于建立反向 shell。

**投毒风险：**
投毒风险评估为 10%。 虽然 `revsh_powersh.ps1` 脚本包含硬编码的 IP 地址和端口，但这是反向 shell 的必要组成部分，因此本身不构成投毒行为。  更高级的投毒可能会尝试使用更隐蔽的技术，例如在 LFS 对象中嵌入恶意代码，或者修改现有的脚本以执行其他恶意操作。 但是从提供的POC文件来看,并没有明显的投毒行为。硬编码的反向shell地址和端口相对明显，更容易被发现。

**利用方式：**
利用该漏洞的步骤如下：

1.  攻击者创建一个包含恶意 LFS 对象的 Git 仓库。
2.  攻击者将该仓库上传到公共或私有 Git 仓库托管服务。
3.  受害者克隆该仓库。
4.  当 Git LFS 尝试下载恶意对象时，会执行攻击者预先设定的代码。

在该POC中,攻击者会创建一个名为 `GITHACKED`的文件并在受害者机器上执行 PowerShell 脚本 `revsh_powersh.ps1`，该脚本会尝试连接到攻击者指定的 IP 地址和端口以建立反向 shell。 这使攻击者能够远程控制受害者的机器。

**项目地址:** [DeeLMind/CVE-2020-27955-LFS](https://github.com/DeeLMind/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)