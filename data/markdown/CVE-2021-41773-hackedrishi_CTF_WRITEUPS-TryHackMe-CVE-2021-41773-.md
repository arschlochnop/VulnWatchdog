## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当或CGI脚本启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径穿越漏洞。攻击者可以通过构造包含`..`的恶意URL，绕过Alias-like指令配置的目录限制，访问服务器上的任意文件。如果目标服务器启用了CGI脚本，攻击者可能进一步利用该漏洞执行远程代码。根据漏洞描述，需要特定的配置错误，例如，文件没有被"require all denied"保护。从提供的漏洞利用代码看， 该代码本身是一个 CTF 的 Writeup， 解释了漏洞原理和利用方式，本身不包含恶意代码，但可能存在作者隐藏的后门代码的风险，但是可能性极低。

**有效性：**
该漏洞利用代码(CTF Writeup) 本身不直接用于漏洞利用，而是用于解释该漏洞，根据搜索引擎结果，该漏洞真实存在且被广泛利用。

**投毒风险：**
提供的漏洞利用代码是一个CTF Writeup，主要用于讲解漏洞原理，本身不太可能包含恶意投毒代码， 但为了安全起见， 风险评估为5%。

**利用方式：**
1.  **路径穿越：** 构造包含`..`的URL，例如`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试访问服务器上的敏感文件，如`/etc/passwd`。
2.  **RCE（如果CGI启用）：**如果服务器配置允许执行CGI脚本，攻击者可以通过上传恶意CGI脚本并执行它，来实现远程代码执行。 需要注意的是，通常需要结合Alias指令的配置不当才能实现。

**利用前提：**
*   Apache HTTP Server版本为2.4.49。
*   目标文件所在目录没有被`require all denied`限制。
*   （可选）服务器启用了CGI脚本，并且Alias指令配置不当。

**项目地址:** [hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-](https://github.com/hackedrishi/CTF_WRITEUPS-TryHackMe-CVE-2021-41773-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)