## CVE-Poppler-pdfseparate-拒绝服务漏洞

**漏洞编号:** CVE-2025-50420

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Poppler pdfseparate

**危害等级:** 高危，可能导致应用程序崩溃或挂起

**影响版本:** < 25.07.0

**利用条件:** 只需处理恶意构造的PDF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Poppler的pdfseparate工具中，由于其PDF文档处理逻辑存在缺陷，当解析包含自引用或相互引用的'/Annots'字典时，会导致'PDFDoc::markAnnotations -> PDFDoc::markPageObjects -> PDFDoc::markObject -> PDFDoc::markDictionary' 函数调用链中的无限递归，循环检测机制由于每次获取字典指针的地址都不同而无法检测到循环，最终耗尽调用栈，造成拒绝服务攻击（应用程序挂起或崩溃）。

**有效性分析：**
根据提供的POC代码和readme.md文件，该POC代码有效。readme.md中给出了漏洞的详细描述，包括漏洞原理、受影响版本和复现步骤。复现步骤显示，使用提供的恶意PDF文件，通过pdfseparate工具处理，会导致Segmentation fault（段错误），验证了漏洞的存在。

**投毒风险分析：**
POC 代码本身看起来是一个简单的 PDF 文件，其中包含用于触发无限递归的恶意 '/Annots' 字典结构。没有发现明显的恶意代码或后门。但是，仍有少量风险。
*   readme.md文件可以被修改为包含误导信息或恶意指令，引导用户执行潜在的危险操作。这种风险相对较低，约为10%，因为核心的漏洞利用在于POC文件本身。

**利用方式：**
攻击者可以通过以下步骤利用该漏洞：
1.  构造一个包含自引用或相互引用的'/Annots'字典的恶意PDF文件。
2.  诱导用户使用受影响版本的pdfseparate工具处理该恶意PDF文件（例如，通过电子邮件、网站上传等方式）。
3.  当pdfseparate尝试解析恶意PDF文件时，会触发无限递归，最终导致应用程序崩溃或挂起，造成拒绝服务攻击。

**优先级排序解释：**
*   虽然提供了漏洞库信息，但是由于内容为空，无法提供有效信息，故优先级最低。
*   漏洞利用代码（POC代码和readme.md）提供了漏洞的直接证明和利用方法，所以优先级较高。
*   搜索引擎结果提供了关于漏洞的上下文信息，例如受影响的软件、修复建议等，有助于理解漏洞的整体情况，但不如直接的POC代码重要，因此优先级次之。

**项目地址:** [Landw-hub/CVE-2025-50420](https://github.com/Landw-hub/CVE-2025-50420)

**漏洞详情:** [CVE-2025-50420](https://nvd.nist.gov/vuln/detail/CVE-2025-50420)