## CVE-2022-0847-Dirty Pipe-本地提权

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致非特权用户获得root权限

**影响版本:** 5.8+

**利用条件:** 本地用户访问受影响的系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847（Dirty Pipe）是一个Linux内核中的本地提权漏洞。漏洞原因是由于在`copy_page_to_iter_pipe`和`push_pipe`函数中，新的管道缓冲区结构的`flags`成员缺少适当的初始化，因此可能包含过时的值。攻击者可以利用此漏洞覆盖只读文件，从而提升权限。

**有效性：**
根据搜索结果，CVE-2022-0847已经被广泛研究，并且存在多个可用的PoC。提供的代码是一个`Cargo.lock`文件，它定义了一个Rust项目的依赖关系。虽然没有直接的漏洞利用代码，但它列出了`dirtypipe_exploit`作为依赖项，这表明该项目旨在利用Dirty Pipe漏洞，所以可以推断该仓库存在可利用代码。

**投毒风险：**
`Cargo.lock`文件本身不包含可执行代码，因此直接投毒的可能性较低。但是，依赖项中可能存在恶意代码。因为此仓库不是官方仓库，存在一定的投毒风险,根据代码推断，投毒风险约为10%。主要风险点：
*   **依赖项污染：** 恶意作者可能通过控制依赖项（例如上传同名恶意crate到非官方源）来引入恶意代码。通过查看依赖包可以有效避免。

**利用方式：**
1.  **漏洞触发：** 利用未初始化的`flags`变量。
2.  **文件覆盖：** 通过管道机制，将恶意数据写入原本只读的文件，例如覆盖SUID程序。
3.  **权限提升：** 执行被篡改的SUID程序，从而获得root权限。

**优先级：**
根据你提供的优先级顺序（搜索引擎结果 > 漏洞利用代码 > 漏洞库信息），我首先参考了搜索引擎结果。这些结果证实了该漏洞的存在、影响和利用方式。其次，查看了漏洞利用代码，从中发现了利用该漏洞的迹象。最后，参考漏洞库信息，获取了关于漏洞的官方描述。

**项目地址:** [morgenm/dirtypipe](https://github.com/morgenm/dirtypipe)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)