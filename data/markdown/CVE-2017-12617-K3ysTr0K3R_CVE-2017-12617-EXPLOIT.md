## CVE-2017-12617-Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要Tomcat开启HTTP PUT方法（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12617 漏洞存在于 Apache Tomcat 的特定版本中，当 HTTP PUT 方法被启用时，攻击者可以上传包含恶意代码的 JSP 文件到服务器，并通过访问该 JSP 文件来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码（Exploit-DB:42966, 43008）。提供的 POC 代码 `CVE-2017-12617.py` 尝试利用 PUT 请求上传 JSP 文件，如果目标服务器满足漏洞条件（PUT 方法启用，readonly 设置为 false），则该 POC 代码有效。

**投毒风险：**
查看 `CVE-2017-12617.py` 代码，代码功能较为简单，上传一个jsp类型的文件,并执行,未发现任何明显的恶意代码或后门。`README.md` 文件只是简单的漏洞介绍，没有任何可疑内容。
因此，该仓库中存在作者隐藏的投毒代码的风险很低，判定为0%。

**利用方式：**
1.  **条件判断：**  需要目标 Tomcat 服务器运行在受影响的版本，并且 `readonly` 初始化参数设置为 `false`，允许 HTTP PUT 请求。
2.  **上传恶意 JSP 文件：**  使用 PUT 请求上传包含恶意代码的 JSP 文件。`CVE-2017-12617.py` 脚本中定义了`payload_file`指定上传的文件名,可以修改此变量设置文件名.
3.  **执行恶意代码：**  通过构造 URL 访问上传的 JSP 文件，触发服务器执行其中的恶意代码，从而实现远程代码执行。脚本中包含了反弹shell的代码,通过设置`lhost`和`lport`可以获取目标机器的shell.

**总结：**
该漏洞利用的关键在于利用 Tomcat 对 PUT 请求处理不当，允许未经授权的文件上传，从而为恶意代码执行打开了缺口。

**项目地址:** [K3ysTr0K3R/CVE-2017-12617-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-12617-EXPLOIT)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)