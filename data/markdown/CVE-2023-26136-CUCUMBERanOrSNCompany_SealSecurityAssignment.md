## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致数据泄露

**影响版本:** < 4.1.3

**利用条件:** 需要使用 CookieJar 且 rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136 是 tough-cookie 包在 4.1.3 之前版本中的原型污染漏洞。由于在使用 `CookieJar` 时对 Cookie 的不当处理（特别是在 `rejectPublicSuffixes=false` 模式下），攻击者可以通过修改对象的 `__proto__` 属性，向 JavaScript 对象的原型链中注入恶意属性，从而影响所有继承该原型的对象。这可能导致未经授权的数据访问，甚至远程代码执行。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，且已确认可以通过原型污染修改对象属性。提供的漏洞利用代码仓库中，`index.js` 包含了一个基于 Snyk PoC 的测试用例，该 PoC 旨在验证漏洞是否可以被成功利用。说明 POC 代码有效，可以通过原型链污染的方式来利用此漏洞。

**投毒风险：**
查看了仓库中的文件列表，主要是描述和测试用例，没有发现明显的恶意代码或后门。漏洞利用代码本身是为了验证漏洞的存在，并非恶意软件。评估投毒风险较低，约5%。 风险主要在于，如果下载者不小心执行了仓库中的测试代码，可能会在本地环境中造成原型污染。

**利用方式：**
1.  攻击者需要找到使用存在漏洞的 `tough-cookie` 库，并且 `CookieJar` 配置为 `rejectPublicSuffixes=false` 的应用程序。
2.  通过构造恶意的 Cookie 数据，利用 `CookieJar` 处理 Cookie 的方式，向 JavaScript 对象的原型链注入属性（例如，设置 `__proto__.isAdmin = true`）。
3.  应用程序在后续处理对象时，会受到原型污染的影响，导致出现非预期的行为，例如权限提升或信息泄露。
4.  该漏洞的利用需要攻击者能够控制 Cookie 的内容，或者能够通过其他方式影响 `CookieJar` 的行为。

**项目地址:** [CUCUMBERanOrSNCompany/SealSecurityAssignment](https://github.com/CUCUMBERanOrSNCompany/SealSecurityAssignment)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)