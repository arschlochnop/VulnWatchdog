## CVE-2021-42013: Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行Apache HTTP Server 2.4.49或2.4.50，并且存在Alias-like指令配置，同时CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 Apache HTTP Server 2.4.49 和 2.4.50 版本中存在的路径遍历漏洞，是 CVE-2021-41773 的不完整修复。

**有效性：**

提供的POC代码有效。它展示了利用路径遍历漏洞读取 `/etc/passwd` 文件的几种方式。通过URL编码 `.` (点) 字符（例如：`%2e`, `%32%65`），攻击者可以绕过服务器的安全检查，访问受限目录之外的文件。

**投毒风险：**

该仓库主要包含漏洞利用相关的文档和PoC，直接嵌入恶意代码的可能性较低。但仍不能完全排除投毒风险，因为攻击者可能会修改 README.md 等文件诱导用户执行恶意操作，例如下载恶意软件，占比约为5%。

**利用方式：**

1.  **路径遍历：** 攻击者利用URL中的编码过的路径遍历字符（如 `.%%32e/.%%32e/.%%32e/.%%32e` ）尝试访问位于Alias-like指令配置目录之外的文件。
2.  **信息泄露：** 如果成功绕过限制，攻击者可以读取服务器上的敏感文件，如 `/etc/passwd`，从而获取系统用户信息。
3.  **远程代码执行：** 如果CGI脚本被启用，攻击者可能上传包含恶意代码的CGI脚本并执行，从而实现远程代码执行。

**总结：**

此漏洞利用的关键在于利用路径遍历绕过Alias-like指令的限制，从而访问和执行服务器上的文件。如果服务器配置不当（例如，CGI脚本启用，且未对Alias-like指令配置目录外的文件设置`require all denied`），则可能导致严重的后果，包括敏感信息泄露和远程代码执行。

**项目地址:** [mightysai1997/cve-2021-42013L](https://github.com/mightysai1997/cve-2021-42013L)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)