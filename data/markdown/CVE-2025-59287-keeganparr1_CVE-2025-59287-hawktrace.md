## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，远程代码执行

**影响版本:** Windows Server 2019: 10.0.17763.0 < version < 10.0.17763.7919, Windows Server 2022: 10.0.20348.0 < version < 10.0.20348.4294, Windows Server 2025: 10.0.26100.0 < version < 10.0.26100.6899, Windows Server 23H2: 10.0.25398.0 < version < 10.0.25398.1913, Windows Server 2016: 10.0.14393.0 < version < 10.0.14393.8519, Windows Server 2012: 6.2.9200.0 < version < 6.2.9200.25722, Windows Server 2012 R2: 6.3.9600.0 < version < 6.3.9600.22824

**利用条件:** 需要网络访问WSUS服务，并且能够发送恶意构造的序列化数据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是Windows Server Update Service (WSUS)中的一个远程代码执行漏洞，源于对不可信数据的反序列化。未经授权的攻击者可以通过网络利用此漏洞执行任意代码。提供的PoC代码包含一个C#程序，该程序使用`ysoserial.net`生成的payload，并对其进行加密。具体来说，它使用一个硬编码的AES密钥对序列化的payload进行加密，然后将其转换为Base64字符串。攻击者需要将生成的Base64编码的payload发送到存在漏洞的WSUS服务器。漏洞利用涉及以下步骤：

1.  **漏洞分析：** 漏洞库信息表明，由于反序列化不可信数据，WSUS存在远程代码执行漏洞。
2.  **PoC代码分析：** PoC代码使用`ysoserial.net`生成一个执行`cmd /c calc`的payload（从base64解码后可以看到）。然后，该payload使用硬编码的AES密钥进行加密。
3.  **漏洞利用方式：** 攻击者需要将PoC生成的加密的Base64字符串发送到易受攻击的WSUS服务器。服务器反序列化该数据，导致执行恶意代码。
4.  **有效性评估：** PoC代码有效，因为它生成了可以触发漏洞的payload。漏洞库信息和PoC代码都支持远程代码执行的说法。
5. **投毒风险评估:** 虽然PoC本身旨在展示漏洞利用，但代码中存在硬编码的密钥。该密钥的使用在真实攻击中可能会被利用，但在此上下文中，更像是一个简化PoC的方式。 此外，PoC利用了`ysoserial.net`，如果`ysoserial.net`被投毒，则利用该PoC生成的Payload也可能被投毒。由于PoC需要硬编码密钥，以及依赖外部工具生成Payload, 因此存在较低的投毒风险.

**项目地址:** [keeganparr1/CVE-2025-59287-hawktrace](https://github.com/keeganparr1/CVE-2025-59287-hawktrace)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)