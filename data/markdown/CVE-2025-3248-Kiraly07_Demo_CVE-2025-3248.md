## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.3.0

**利用条件:** 目标Langflow实例版本低于1.3.0且/api/v1/validate/code端点可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-3248是Langflow中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于`/api/v1/validate/code`端点，攻击者可以通过发送特制的HTTP请求，将恶意代码注入到`code`参数中，利用Python的`exec`函数执行任意代码。提供的POC代码有效，它通过构造包含恶意代码的JSON payload，并将其POST到目标端点来触发漏洞。漏洞利用过程不需要任何身份验证。根据搜索引擎结果，此漏洞已被积极利用，并且可能被用于部署恶意软件如Flodrix僵尸网络。docker-compose.yml文件用于快速搭建存在漏洞的Langflow环境进行复现，requirements.txt 列出了所需依赖项。Payload利用了`subprocess.check_output`执行命令并将结果返回。

**漏洞利用方式：**

1.  **环境搭建：** 使用`docker-compose.yml` 快速搭建漏洞环境,运行Langflow 1.2.0版本。
2.  **漏洞触发：** 向 `/api/v1/validate/code` 端点发送包含恶意代码的POST请求。
3.  **代码执行：** Langflow 使用 `exec` 函数执行恶意代码，从而导致远程代码执行。
4.  **结果获取：** 利用代码中的异常处理捕获`subprocess.check_output`的结果并返回，作为命令执行的回显。

**投毒风险分析：**
代码逻辑相对简单，主要功能是发送包含恶意代码的 HTTP POST 请求，并解析命令执行的结果。Payload本身旨在利用目标系统的漏洞，但仓库中的代码本身没有明显的恶意功能或者后门，只是一个漏洞利用工具。考虑到作者GitHub的用户名与代码中信息匹配，风险极低, 判定投毒风险为1%。

**项目地址:** [Kiraly07/Demo_CVE-2025-3248](https://github.com/Kiraly07/Demo_CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)