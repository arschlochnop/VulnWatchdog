## CVE-2025-3248 - Langflow RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Langflow

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.3.0

**利用条件:** 需要网络访问Langflow实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-3248是Langflow中存在的一个远程代码执行漏洞，影响版本低于1.3.0。漏洞位于/api/v1/validate/code端点，攻击者可以发送特制的HTTP请求来执行任意代码，无需身份验证。

**有效性分析：**

漏洞库信息和搜索引擎结果都确认了该漏洞的存在和严重性。POC代码提供了一个可利用的exp,通过发送包含恶意python代码的POST请求到/api/v1/validate/code端点，触发`exec`函数执行恶意代码，从而实现RCE。

**投毒风险分析：**

通过分析POC代码，没有发现任何明显的投毒行为。代码逻辑清晰，主要功能是构造Payload发送到漏洞端点，并解析响应。虽然执行了任意代码，但这是漏洞利用本身的特性，不是指作者在代码中植入后门。

具体分析：

*   `docker-compose.yml`: 用于快速启动包含漏洞的Langflow 1.2.0版本，方便漏洞复现和测试。
*   `exploit.py`: 漏洞利用脚本，主要包含以下步骤：
    *   构造包含恶意代码的JSON payload。
    *   发送POST请求到`/api/v1/validate/code`端点。
    *   解析响应，提取命令执行结果。
    *   代码没有执行除漏洞利用之外的恶意操作,所以判断投毒风险为0%。

**利用方式：**

1.  攻击者需要一个运行着Langflow 1.3.0之前版本的实例。
2.  攻击者构造一个包含恶意Python代码的JSON payload。
3.  攻击者发送POST请求到/api/v1/validate/code端点，将payload作为请求体发送。
4.  Langflow服务端接收到请求后，未对payload中的代码进行充分验证，直接使用`exec`函数执行该代码。
5.  攻击者通过解析响应，获取命令执行结果。

**项目地址:** [Kiraly07/Demo_CVE-2025-3248](https://github.com/Kiraly07/Demo_CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)