## CVE-2025-48384-Git配置注入导致任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/符号链接攻击

**影响应用:** Git

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库并递归初始化子模块，并需要用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384是Git中的一个漏洞，由于Git在处理配置文件时，会删除尾部的CRLF字符，导致如果子模块路径中包含尾部CR字符，则修改后的路径会被读取，导致子模块被检出到错误的位置。如果存在一个符号链接将更改后的路径指向子模块的hooks目录，并且子模块包含一个可执行的post-checkout hook，则在检出后可能会意外执行该脚本，从而导致任意代码执行。 

**有效性：**

根据提供的漏洞库信息和搜索引擎结果，以及POC代码，可以判断此POC有效。POC Dockerfile使用`apk`安装了受影响的Git版本（2.40.4），然后克隆了两个包含利用代码的Git仓库。Dockerfile中的CMD指令执行了`git clone --recurse-submodules`命令，这会触发漏洞利用。搜索引擎结果中也提到了此漏洞存在POC，并提供了利用示例，表明此漏洞可以被复现。

**投毒风险：**

分析Dockerfile的内容，主要的风险点集中在克隆的两个Git仓库：`https://github.com/vinieger/CVE-2025-48384.git`和`https://github.com/liamg/CVE-2025-48384-submodule.git`。

*   检查`vinieger/CVE-2025-48384`仓库，该仓库主要用于提供触发漏洞的配置，风险较低，因为目标是演示漏洞本身。
*   `liamg/CVE-2025-48384-submodule` 仓库，它用于提供恶意的子模块。恶意代码最可能存在于子模块的hooks目录中，尤其是post-checkout hook。该仓库需要仔细审查。考虑到其目的是为了利用漏洞，因此其存在恶意代码的可能性较高，但主要用于演示漏洞利用而非进行大规模攻击。因此，投毒风险相对较低，估计在10%左右，主要源于该仓库可能隐藏一些超出漏洞演示范围的恶意行为（例如，收集用户信息或尝试横向渗透）。

**利用方式：**

1.  攻击者创建一个包含恶意配置的Git仓库，该配置包括带有尾部CR字符的子模块路径。
2.  攻击者创建一个包含恶意post-checkout hook的子模块，并将该子模块托管在另一个Git仓库。
3.  攻击者创建一个符号链接，将带有尾部CR字符的子模块路径指向子模块的hooks目录。
4.  受害者克隆包含恶意配置的Git仓库，并使用`git clone --recurse-submodules`命令初始化子模块。
5.  Git在处理子模块路径时，会错误地将子模块检出到符号链接指向的目录，从而执行恶意post-checkout hook，导致任意代码执行。

**项目地址:** [vinieger/vinieger-CVE-2025-48384-Dockerfile](https://github.com/vinieger/vinieger-CVE-2025-48384-Dockerfile)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)