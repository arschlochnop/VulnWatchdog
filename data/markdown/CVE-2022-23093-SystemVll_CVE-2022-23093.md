## CVE-2022-23093-FreeBSD-ping-Stack Overflow

**漏洞编号:** CVE-2022-23093

**漏洞类型:** Stack Overflow

**影响应用:** FreeBSD ping

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** FreeBSD 13.1-RELEASE (小于 p5), 12.4-RC2 (小于 p2), 12.3-RELEASE (小于 p10)

**利用条件:** 需要能够向目标主机发送特制的ICMP包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-23093是FreeBSD ping程序中的一个栈溢出漏洞。该漏洞存在于`pr_pack()`函数中，该函数在处理ICMP响应时，未能正确处理IP选项头。当响应或引用的包中存在IP选项头时，`pr_pack()`函数会将接收到的IP和ICMP头复制到栈缓冲区进行处理，导致最多40字节的缓冲区溢出，

**有效性：**
根据漏洞信息和搜索引擎结果，此漏洞的PoC应该是有效的，因为多个来源都确认了漏洞的存在，并且提供了分析和利用的信息。

**投毒风险：**
提供的漏洞利用代码是一个Apache License的文本文件，本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
攻击者可以通过发送特制的ICMP Echo Request包触发此漏洞，该请求包包含带有特制的IP选项的回复包。目标主机上的ping程序在处理响应时，`pr_pack()`函数会将IP和ICMP头复制到栈缓冲区，因为IP选项的存在，会发生缓冲区溢出，从而导致ping程序崩溃。由于ping程序运行在capability模式沙箱中，因此利用受到限制，可能无法实现任意代码执行，但会导致拒绝服务。

**项目地址:** [SystemVll/CVE-2022-23093](https://github.com/SystemVll/CVE-2022-23093)

**漏洞详情:** [CVE-2022-23093](https://nvd.nist.gov/vuln/detail/CVE-2022-23093)