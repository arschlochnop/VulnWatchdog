## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Fusion Builder WordPress插件 (Avada主题)

**危害等级:** 高危，可能导致敏感信息泄露、内网扫描、绕过防火墙访问内部服务。

**影响版本:** < 3.6.2

**利用条件:** 目标网站安装了存在漏洞的Fusion Builder插件，且未做SSRF相关防御。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-1386 是一个存在于 Fusion Builder WordPress 插件 3.6.2 之前版本的未授权 SSRF 漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTTP 请求，使服务器代表攻击者访问内部或外部网络资源。

**有效性：**

根据漏洞库信息、搜索结果和提供的POC代码，该POC代码应该是有效的。漏洞库信息明确指出该漏洞存在于 Fusion Builder 3.6.2 之前的版本，并且无需身份验证。搜索结果中也提到了利用该漏洞扫描内网，绕过防火墙的可能性。提供的 bash 脚本 `fubucker.sh` 使用 curl 命令，通过向 `/wp-admin/admin-ajax.php` 发送 POST 请求，触发 SSRF 漏洞。脚本首先获取 `fusion-form-nonce` 值，然后构造包含恶意 `fusionAction` 的请求，`fusionAction` 指向一个外部URL，如 `https://pastebin.com/raw/VaxXtjGV`。服务器会尝试请求此URL，并将结果返回，攻击者便可利用这一点进行SSRF。

**投毒风险：**

虽然主要的利用逻辑是 SSRF，但脚本中存在潜在的投毒风险。以下分析:
* 首先脚本创建 `vuln.txt` 和 `notvuln.txt` 文件，用于记录存在漏洞和不存在漏洞的 URL。这是一个正常操作，用于扫描结果的统计和整理。
* 脚本通过 `--insecure` 参数禁用 SSL 证书验证，增加了中间人攻击的风险，如果脚本执行者不注意，可能在不安全的网络环境中执行，导致敏感信息泄露。
* 最主要的潜在风险在于 `fusionAction=https://pastebin.com/raw/VaxXtjGV`。脚本直接从 pastebin 下载 payload。如果 pastebin 上的内容被恶意修改，攻击者可以在 pastebin 上的payload中包含任意恶意代码（如反弹shell等）。虽然当前 pastebin 的内容可能无害，但未来存在被篡改的风险。此外，利用bash脚本批量执行站点攻击，容易造成大量站点访问，属于非授权行为。

综合以上因素，虽然主要功能是SSRF检测，但来自外部 pastebin 的 payload 引入了不确定性，因此存在投毒风险，大约为 20%。大部分代码逻辑正常，风险主要集中在外部资源的依赖上。

**利用方式：**

1.  **确定目标 WordPress 网站使用了存在漏洞的 Fusion Builder 插件 (版本 < 3.6.2)。**
2.  **运行提供的 `fubucker.sh` 脚本，指定包含目标 URL 列表的文件和线程数。**
3.  **脚本会自动发送包含恶意 `fusionAction` 参数的 POST 请求到 `/wp-admin/admin-ajax.php`。**
4.  **如果目标网站存在漏洞，服务器会尝试请求 `fusionAction` 指定的 URL，并将结果返回。**
5.  **攻击者可以通过分析返回的结果，判断漏洞是否存在，并利用 SSRF 漏洞进行进一步的攻击，如内网端口扫描、读取内网服务等。**


**项目地址:** [zycoder0day/CVE-2022-1386-Mass_Vulnerability](https://github.com/zycoder0day/CVE-2022-1386-Mass_Vulnerability)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)