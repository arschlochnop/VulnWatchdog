## CVE-2017-7269-IIS6-缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行的是存在漏洞的IIS 6.0版本，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0中的缓冲区溢出漏洞。该漏洞位于WebDAV服务的`ScStoragePathFromUrl`函数中。远程攻击者可以通过发送包含一个长`If: <http://`起始的头的`PROPFIND`请求，利用此漏洞执行任意代码。

**有效性：**
提供的漏洞利用代码(`ii6_reverse_shell.py`)尝试利用CVE-2017-7269漏洞在易受攻击的IIS 6.0服务器上执行反向shell。漏洞库信息和搜索结果表明该漏洞真实存在且已被广泛利用。

**投毒风险：**
分析提供的`ii6_reverse_shell.py`代码，该脚本的主要目的是创建一个反向shell。虽然反向shell本身可以用于恶意目的，但代码中没有明显的迹象表明作者有意添加了任何额外的投毒代码。代码的核心功能是利用缓冲区溢出漏洞，在目标系统上执行预定义的shellcode，该shellcode尝试连接到攻击者指定的IP地址和端口。没有发现尝试进行额外恶意活动的迹象,例如上传信息，安装恶意程序等。

**利用方式：**
1.  攻击者构造一个恶意的`PROPFIND`请求，其中`If:`头包含一个超长的URL字符串。
2.  当IIS 6.0处理此请求时，`ScStoragePathFromUrl`函数内的缓冲区溢出漏洞会被触发。
3.  通过控制溢出，攻击者可以将恶意shellcode注入到进程的内存中，并劫持程序的执行流程。
4.  提供的漏洞利用代码中的shellcode会尝试建立一个反向shell连接到攻击者指定的IP地址和端口，从而允许攻击者远程控制受感染的服务器。

**项目地址:** [h3x0v3rl0rd/CVE-2017-7269](https://github.com/h3x0v3rl0rd/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)