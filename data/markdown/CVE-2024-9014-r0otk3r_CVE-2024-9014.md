## CVE-2024-9014 - pgAdmin 4 OAuth2 认证绕过

**漏洞编号:** CVE-2024-9014

**漏洞类型:** 认证绕过

**影响应用:** pgAdmin 4

**危害等级:** 高危，可能导致未授权访问用户数据

**影响版本:** <= 8.11

**利用条件:** 需要网络访问pgAdmin 4的登录页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9014 存在于 pgAdmin 4 的 OAuth2 认证实现中，允许攻击者通过访问登录页面获取 OAuth2 客户端 ID 和密钥，从而绕过认证并访问敏感的用户数据。根据提供的漏洞库信息和搜索引擎结果，此漏洞的 CVSS 评分为 9.9，属于严重级别。漏洞利用代码包含两个 Python 脚本：`cve_2024_9014_check.py` 用于检查目标系统是否存在漏洞，通过请求登录页面并检查 HTML 源代码中是否存在暴露的 OAuth2 客户端密钥来判断；`extract_oauth2_config.py` 脚本用于提取 OAuth2 配置。利用方式包括：1. 使用 `cve_2024_9014_check.py` 检查目标 pgAdmin 4 实例是否存在漏洞。2. 如果存在漏洞，使用 `extract_oauth2_config.py` 提取 OAuth2 客户端 ID 和密钥。3. 使用提取的客户端 ID 和密钥绕过 OAuth2 认证，并访问受保护的资源。

**关于投毒风险：**

该POC代码主要是检测和提取OAuth2配置，本身不包含恶意代码。但是，代码中存在以下潜在的投毒风险：

1.  **中间人攻击：** 通过 `--proxy` 参数指定代理服务器，可能存在恶意代理截获和篡改请求的风险，但这个风险并非脚本本身引入，而是使用代理服务器时固有的风险。
2.  **输出文件：** 脚本将检测结果和提取的 OAuth2 配置写入文件，如果输出文件被恶意替换，可能导致信息泄露或被用于后续攻击。
3.  **依赖风险：** 该脚本依赖 `requests` 库，如果 `requests` 库被恶意篡改，可能会影响脚本的安全性。

基于以上分析，认为此仓库存在较低的投毒风险 (10%)，主要集中在使用代理和处理输出文件方面。需要用户在使用时保持警惕，确保网络环境安全，并对输出文件进行妥善管理。

**项目地址:** [r0otk3r/CVE-2024-9014](https://github.com/r0otk3r/CVE-2024-9014)

**漏洞详情:** [CVE-2024-9014](https://nvd.nist.gov/vuln/detail/CVE-2024-9014)