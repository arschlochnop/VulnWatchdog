## CVE-2025-48148-StoreKeeper for WooCommerce-任意文件上传

**漏洞编号:** CVE-2025-48148

**漏洞类型:** 任意文件上传

**影响应用:** StoreKeeper for WooCommerce

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 14.4.4

**利用条件:** 目标WordPress站点安装并启用了StoreKeeper for WooCommerce插件，且版本小于等于14.4.4。攻击者需要能够访问WordPress站点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2025-48148 存在于 StoreKeeper for WooCommerce 插件中，允许未经授权的攻击者上传任意文件，包括可执行的PHP文件。该漏洞的利用方式如下：

1.  **获取 Nonce:**  利用代码首先尝试从目标WordPress站点的首页获取一个用于身份验证的 Nonce 值。这个 Nonce 值通常用于防止跨站请求伪造 (CSRF) 攻击。
2.  **构造恶意文件:**  利用代码会创建一个包含PHP后门的恶意文件 shell.php。这个文件包含一段简单的代码 `<?php system($_GET['cmd']); ?>`，允许攻击者通过GET请求执行任意系统命令。
3.  **上传恶意文件:**  利用代码使用获取到的 Nonce 值，将恶意文件 shell.php 上传到 WordPress 站点。上传的目标端点是 `wp-admin/admin-ajax.php`，并伪装成上传产品图片。
4.  **远程代码执行:**  成功上传后，攻击者可以通过访问上传的文件，并附带 cmd 参数来执行任意系统命令。例如，`http://site.com/wp-content/uploads/shell.php?cmd=whoami`。

**有效性分析:**
根据漏洞描述和提供的POC代码，该POC代码是有效的。它利用了插件中存在的任意文件上传漏洞，允许攻击者上传恶意文件并执行任意代码。

**投毒风险分析:**
该POC代码本身**没有明显的投毒代码**。主要操作是获取nonce、创建包含后门的shell.php文件、上传文件。所有的代码逻辑都清晰可见，没有发现隐藏的恶意功能。

**利用方式总结:**
该漏洞的利用方式是未经授权的攻击者通过上传恶意PHP文件到目标服务器，并利用该文件执行任意系统命令。由于未对上传文件类型进行严格的校验，攻击者可以将恶意PHP文件伪装成图片文件或其他类型的文件进行上传。

**项目地址:** [Nxploited/CVE-2025-48148](https://github.com/Nxploited/CVE-2025-48148)

**漏洞详情:** [CVE-2025-48148](https://nvd.nist.gov/vuln/detail/CVE-2025-48148)