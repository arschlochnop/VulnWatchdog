## CVE-2024-7593 - Ivanti vTM Authentication Bypass

**漏洞编号:** CVE-2024-7593

**漏洞类型:** 身份验证绕过

**影响应用:** Ivanti Virtual Traffic Manager (vTM)

**危害等级:** 严重，可能导致完全控制受影响的服务器

**影响版本:** 除22.2R1和22.7R2以外的所有版本

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7593 是 Ivanti vTM 中的一个身份验证绕过漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者绕过管理面板的身份验证。CVSS评分为9.8，属于严重漏洞。

**利用方式：**
利用代码显示，该漏洞通过以下步骤利用：
1.  首先,通过POST请求向`/apps/zxtm/wizard.fcgi` 创建一个管理员用户。利用了`Access+Management%3ALocalUsers`模块的创建用户功能。
2.  然后,通过POST请求向`/apps/zxtm/login.cgi`使用刚刚创建的用户名和密码进行登录。
3.  如果登录成功，服务器将返回一个包含`Location: /apps/zxtm/` 以及 `Set-Cookie: ZeusTMZAUTH=` 和 `Set-Cookie: ZeusTMZAUTHTIME=` 的响应头，以及302状态码，这意味着攻击者已成功绕过身份验证并获得管理员权限。

**有效性：**
POC代码看起来有效，因为它尝试创建一个新用户并使用该用户登录，这符合身份验证绕过的描述。

**投毒风险：**
分析POC代码, 存在一定的投毒风险。风险点在于攻击者可以修改`username`和`password`变量的值。虽然这些值由`rand_base(6)`和`rand_base(8)`生成，具有一定的随机性，但是在批量攻击的情况下，也可能被投毒者植入一些特殊的值，或者植入恶意Payload。 同时yaml文件中集成了nuclei扫描框架，该框架本身具有一定的恶意代码植入的风险。因此，总体投毒风险评估为10%。

**总结：**
该漏洞是一个严重的安全问题，利用简单，威胁很高。建议受影响的用户尽快升级到安全版本。

**项目地址:** [0xlf/CVE-2024-7593](https://github.com/0xlf/CVE-2024-7593)

**漏洞详情:** [CVE-2024-7593](https://nvd.nist.gov/vuln/detail/CVE-2024-7593)