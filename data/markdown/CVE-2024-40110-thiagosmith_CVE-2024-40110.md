## CVE-2024-40110 - Poultry Farm Management System v1.0 - 远程代码执行

**漏洞编号:** CVE-2024-40110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Poultry Farm Management System

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.0

**利用条件:** 需要目标系统运行受影响的 Poultry Farm Management System v1.0，并且可以从攻击者控制的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-40110 存在于 Sourcecodester Poultry Farm Management System v1.0 中。 这是一个未经身份验证的远程代码执行 (RCE) 漏洞，位于 /farm/product.php 的 productimage 参数中。

**有效性：**
提供的PoC代码（exploit.py）通过上传一个webshell来实现远程代码执行。该脚本首先定义了目标URL和webshell的URL，然后构造一个包含webshell内容的POST请求，将其发送到/farm/product.php端点。如果上传成功，脚本将提供一个交互式shell，允许攻击者执行任意命令。
根据github上的描述和提供的代码，漏洞利用有效。

**投毒风险：**
代码中包含`web-backdoor.php`的webshell payload, 但这是漏洞利用本身的一部分，不能算作投毒。代码中存在恶意行为的可能性较低, 但考虑到代码仓库中可能存在其他未审计的文件或未来的修改, 因此存在很小的投毒风险。 风险评估: 5% 是基于对当前提供的 `exploit.py` 文件和 `README.md` 文件的评估。`README.md` 提到了免责声明，这表明作者可能知道潜在的滥用风险，但并不一定意味着存在故意的投毒行为。`exploit.py` 上传的 webshell 本身是一种后门，但它是为了验证漏洞的存在而存在的。 存在的 `teste` 文件则无法判断.

**利用方式：**
1.  攻击者无需身份验证。
2.  攻击者构造一个包含恶意PHP代码（webshell）的文件。
3.  攻击者将此文件作为`productimage`参数的值，通过POST请求发送到`/farm/product.php`。
4.  服务器未正确验证上传的文件，允许上传包含恶意代码的PHP文件。
5.  攻击者可以通过访问上传的webshell文件来执行任意命令。
6.  PoC代码提供了一个交互式shell，允许攻击者执行任意命令，从而完全控制受影响的系统。

**项目地址:** [thiagosmith/CVE-2024-40110](https://github.com/thiagosmith/CVE-2024-40110)

**漏洞详情:** [CVE-2024-40110](https://nvd.nist.gov/vuln/detail/CVE-2024-40110)