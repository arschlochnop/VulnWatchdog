## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要网络访问，GeoServer服务开启，目标存在漏洞版本的GeoServer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞，存在于OGC Filter表达式语言和OGC Common Query Language (CQL)的支持中。攻击者可以通过WFS和WMS协议，或者WCS协议（针对ImageMosaic覆盖），注入恶意的SQL代码。PoC代码通过构造包含恶意SQL语句的CQL_FILTER参数，发送到存在漏洞的GeoServer实例，利用`strStartsWith`等函数进行SQL注入。虽然代码整体上是用于验证漏洞的，但存在潜在投毒风险，例如，攻击者可能会修改PoC，使其包含更具破坏性的SQL payload，或者在大型环境中分发这些修改后的PoC，达到攻击的目的。代码本身的危害较小，但被恶意修改后风险增大。

**项目地址:** [win3zz/CVE-2023-25157](https://github.com/win3zz/CVE-2023-25157)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)