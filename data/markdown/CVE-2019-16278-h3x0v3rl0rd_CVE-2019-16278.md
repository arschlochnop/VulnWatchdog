## CVE-2019-16278 - Nostromo nhttpd Directory Traversal Remote Code Execution

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致的远程代码执行

**影响应用:** nostromo nhttpd

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 1.9.6

**利用条件:** 目标服务器运行存在漏洞的nostromo nhttpd版本，且攻击者能够通过网络访问目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-16278 是一个存在于 Nostromo nhttpd 1.9.6 及更早版本中的目录遍历漏洞。该漏洞位于 `http_verify` 函数中，攻击者可以通过构造特殊的 HTTP 请求，利用目录遍历漏洞执行任意代码。从提供的漏洞利用代码 `cve2019_16278.py` 来看，它通过发送一个包含目录遍历序列（`/.%0d./`）的POST请求到目标服务器的 `/bin/sh` 路径，从而执行命令。`%0d` 是回车符的URL编码，用于绕过某些检查。该利用脚本首先连接到目标服务器的指定端口，然后发送构造好的包含恶意payload的HTTP POST请求。Payload包含要执行的命令，并通过 `2>&1` 将标准错误重定向到标准输出，以便在响应中获取执行结果。分析该POC代码，没有发现明显的投毒行为。代码逻辑简单直接，主要功能是发送恶意HTTP请求并打印服务器响应。从搜索引擎结果来看，多个安全厂商和漏洞库都确认了该漏洞的存在，并提供了相应的分析和利用方法。 exploit-db上也有相应的exploit (https://www.exploit-db.com/exploits/47837)。综合来看，该POC代码的有效性较高，并且没有明显的投毒风险。漏洞利用方式：攻击者通过发送特制的HTTP POST请求，利用目录遍历漏洞在目标服务器上执行任意命令。该请求的目标URL包含目录遍历序列，指向 `/bin/sh` 解释器。请求体中包含要执行的命令。由于`http_verify` 函数没有正确地验证请求路径，攻击者可以绕过访问控制，执行系统命令。

**项目地址:** [h3x0v3rl0rd/CVE-2019-16278](https://github.com/h3x0v3rl0rd/CVE-2019-16278)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)