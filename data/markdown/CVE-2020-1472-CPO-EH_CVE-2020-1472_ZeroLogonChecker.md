## CVE-2020-1472 (Zerologon) 漏洞检测

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，具体请参考漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个Windows Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过MS-NRPC协议连接到域控制器，重置域控制器的机器帐户密码为空，从而获取域管理员权限。提供的漏洞利用代码是一个C#程序，用于**检测**目标域控制器是否存在此漏洞，**并非真正的漏洞利用代码**。该代码通过尝试与目标域控制器建立Netlogon安全通道并执行身份验证来检测漏洞。由于代码本身是漏洞**检测**工具，并非直接进行提权，因此**投毒风险较低**，主要体现在可能被修改为发送大量探测流量进行拒绝服务攻击，或者收集目标服务器信息的可能。代码片段不完整，只能推断出实现逻辑，但未看到恶意代码，初步认为投毒风险概率为10%。

**利用方式：**

1.  攻击者利用MS-NRPC协议的加密缺陷，向域控制器发送一系列特制的Netlogon请求。
2.  这些请求将导致域控制器的机器帐户密码被重置为空字符串。
3.  攻击者随后可以使用空密码来冒充域控制器，并执行各种恶意操作，例如添加新的域管理员帐户或修改现有帐户的权限。

**有效性：**

由于提供的代码是漏洞检测工具，并非漏洞利用工具，所以**有效性体现在能否准确检测出目标是否存在漏洞**。根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，攻击影响极大。

**参考链接：**
*   https://www.crowdstrike.com/en-us/blog/cve-2020-1472-zerologon-security-advisory/
*   https://msrc.microsoft.com/blog/2020/10/attacks-exploiting-netlogon-vulnerability-cve-2020-1472/
*   https://nvd.nist.gov/vuln/detail/cve-2020-1472

**项目地址:** [CPO-EH/CVE-2020-1472_ZeroLogonChecker](https://github.com/CPO-EH/CVE-2020-1472_ZeroLogonChecker)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)