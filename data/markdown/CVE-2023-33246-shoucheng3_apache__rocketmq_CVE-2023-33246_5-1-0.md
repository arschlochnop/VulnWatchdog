## CVE-2023-33246 Apache RocketMQ 远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache RocketMQ

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ 组件（NameServer, Broker, Controller）暴露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33246 允许攻击者通过利用 RocketMQ 的更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，以运行 RocketMQ 的系统用户身份。漏洞存在于 RocketMQ 5.1.0 及以下版本。

**漏洞利用方式：**

1.  **利用更新配置功能：** 攻击者可以发送恶意请求，修改 RocketMQ 的配置，从而执行任意系统命令。
2.  **伪造 RocketMQ 协议内容：**  攻击者可以构造恶意的 RocketMQ 协议数据包，诱导 RocketMQ 服务端执行恶意代码。

**POC有效性评估：**

根据漏洞描述、搜索结果（特别是GitHub链接）和CISA KEV目录信息，可以确定存在可用的POC，并且该漏洞已经被积极利用。

**投毒风险评估：**

提供的代码片段看起来是构建文件（BUILD.bazel）、构建说明(BUILDING)和贡献指南(CONTRIBUTING.md)，这些文件本身不太可能包含恶意代码。但是，漏洞的利用可能涉及修改配置文件或发送特定格式的数据包，这些恶意配置或数据包可能包含投毒代码。因此，仓库中存在作者隐藏的投毒代码的风险较低，大约为10%。 主要风险在于后续利用过程中引入恶意配置或载荷的可能性。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-33246_5-1-0)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)