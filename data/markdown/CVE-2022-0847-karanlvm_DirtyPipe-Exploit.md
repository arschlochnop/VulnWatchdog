## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致root权限获取

**影响版本:** Linux Kernel 5.8 以上至 5.17 rc6

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中对pipe buffer结构体中的`flags`成员未进行适当初始化，导致其可能包含陈旧的值。

**有效性：**
根据漏洞信息和搜索结果，以及漏洞利用代码的描述，此漏洞的PoC代码是有效的。 多个来源证实了该漏洞的可利用性和可靠性，并且已经存在公开可用的利用代码。

**投毒风险：**
提供的漏洞利用代码本身只是一个README文件，解释了漏洞原理。没有直接的可执行代码或脚本。因此投毒风险较低，大约5%。尽管如此，用户在使用任何来自不可信来源的漏洞利用代码时，应始终保持警惕，仔细审查代码，以确保没有隐藏的恶意行为。

**利用方式：**
1.  利用该漏洞，攻击者可以覆盖只读文件支持的页面缓存中的页面。
2.  攻击者首先需要找到一个目标文件，这个文件会被映射到内存中（例如，通过`mmap`系统调用）。
3.  攻击者创建管道，并利用未初始化的标志来注入恶意数据到管道的缓冲区。
4.  利用该管道将精心构造的数据“喷射”到目标文件在内存中的映射区域，从而修改文件内容。
5.  由于修改的是内存中的映射，这种修改会反映到磁盘上（最终）。
6.  通过覆盖具有SUID权限的可执行文件，攻击者可以提升权限。

**项目地址:** [karanlvm/DirtyPipe-Exploit](https://github.com/karanlvm/DirtyPipe-Exploit)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)