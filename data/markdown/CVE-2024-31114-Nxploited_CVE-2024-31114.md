## CVE-2024-31114 - WordPress Shortcode Addons 任意文件上传

**漏洞编号:** CVE-2024-31114

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Shortcode Addons

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.5

**利用条件:** 需要具备管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31114 存在于 WordPress Shortcode Addons 插件中，允许经过身份验证的（管理员或更高级别）用户上传任意文件。由于缺少文件类型验证，攻击者可以上传包含恶意PHP代码的zip文件，并在服务器上执行任意命令。利用方式如下：

1.  **身份验证：** 首先，攻击者需要具有 WordPress 站点的管理员或更高级别的权限。
2.  **生成Payload：**  攻击者使用给定的POC代码生成一个包含恶意PHP代码的zip文件，PHP代码中包含可以执行系统命令的后门。
3.  **上传Payload：** 攻击者访问Shortcode Addons的导入功能，上传包含恶意PHP代码的zip文件。
4.  **触发Payload：** 成功上传后，恶意文件会被解压到服务器的`wp-content/uploads/shortcode-addons/`目录下。然后，攻击者通过访问该PHP文件，并使用GET参数 `cmd` 执行任意系统命令。

**关于投毒风险：**

尽管POC代码看起来比较直接，但仍然存在一些细微的投毒风险：

*   **Payload内容：** 后门`<?php if(isset($_GET["cmd"])){ system($_GET["cmd"]); } ?>` 本身非常简单，但如果攻击者修改这个payload，例如添加下载额外恶意文件的功能，那么其他使用者在不知情的情况下可能会受到影响。
*   **依赖风险：** 该脚本依赖于 `requests` 和 `beautifulsoup4` 库。虽然这两个库本身很常用，但如果恶意作者修改脚本，添加从不可信源安装依赖的代码，则可能引入恶意库。
*   **时间延迟:** 代码中存在`time.sleep(3)`，该函数可能会被恶意利用。

总的来说，该POC代码的投毒风险较低，但是仍然需要注意潜在的风险。

**搜索引擎结果分析：**

搜索引擎结果确认了该漏洞的存在，并且都指向了该漏洞是由于上传了具有危险类型的文件所导致。


**项目地址:** [Nxploited/CVE-2024-31114](https://github.com/Nxploited/CVE-2024-31114)

**漏洞详情:** [CVE-2024-31114](https://nvd.nist.gov/vuln/detail/CVE-2024-31114)