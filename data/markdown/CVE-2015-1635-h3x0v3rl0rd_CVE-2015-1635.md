## CVE-2015-1635-HTTP.sys远程代码执行漏洞

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows HTTP.sys

**危害等级:** 高危，可能导致远程代码执行和系统崩溃

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2

**利用条件:** 目标系统运行存在漏洞的HTTP.sys服务，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Microsoft Windows的HTTP.sys组件中，攻击者可以通过发送特制的HTTP请求，利用Range头部的整数溢出漏洞，导致蓝屏崩溃（DoS）或远程代码执行（RCE）。提供的POC代码 `MS15-034.py` 包含漏洞检测和DoS攻击功能。检测功能通过发送包含特制Range头的HTTP请求，检查服务器返回的HTTP状态码是否为416（Requested Range Not Satisfiable）或响应体中是否包含"Requested Range Not Satisfiable"字符串，以此判断目标是否存在漏洞。DoS攻击功能则通过发送大量包含特制Range头的HTTP请求，消耗服务器资源，导致拒绝服务。由于PoC代码中存在 user_agent 伪造功能，具备初步的隐藏真实客户端信息能力,但代码逻辑本身较为简单,并且使用了常用的库(如 `aiohttp`,`user_agent`等)，没有发现明显的恶意行为或后门代码。但依然需要注意,由于存在网络请求,存在服务器端记录客户端IP地址的风险,故判断存在一定程度的投毒风险。

**漏洞利用方式：**

1.  **漏洞检测：** 使用POC脚本提供的检测功能，向目标服务器发送包含特制Range头的HTTP请求。
2.  **漏洞验证：** 如果服务器返回HTTP 416错误或响应体包含特定字符串，则表明目标服务器存在漏洞。
3.  **拒绝服务攻击（DoS）：** 使用POC脚本提供的DoS攻击功能，向目标服务器发送大量包含特制Range头的HTTP请求，造成服务器资源耗尽，拒绝服务。
4.  **远程代码执行（RCE）：** 虽然POC代码主要演示了DoS攻击，但理论上该漏洞也可能被用于执行任意代码。更复杂的利用方式需要进一步研究和开发，不在当前分析范围。

**项目地址:** [h3x0v3rl0rd/CVE-2015-1635](https://github.com/h3x0v3rl0rd/CVE-2015-1635)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)