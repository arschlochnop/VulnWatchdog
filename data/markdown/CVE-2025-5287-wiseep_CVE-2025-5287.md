## CVE-2025-5287-Likes and Dislikes Plugin-SQL注入

**漏洞编号:** CVE-2025-5287

**漏洞类型:** SQL注入

**影响应用:** Likes and Dislikes Plugin

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 1.0.0

**利用条件:** 目标WordPress站点安装了受影响版本的Likes and Dislikes插件，且无需认证即可访问wp-admin/admin-ajax.php。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于 WordPress 的 Likes and Dislikes Plugin 插件中，版本小于等于 1.0.0。攻击者可以利用 'post' 参数进行 SQL 注入。由于对用户提供的参数未进行充分的转义，以及对现有的 SQL 查询未进行充分的准备，未经身份验证的攻击者可以将额外的 SQL 查询附加到现有查询中，从而提取数据库中的敏感信息。

**有效性：**

提供的 Python 脚本 `CVE-2025-5287.py` 使用时间延迟方法检测 SQL 注入漏洞。它通过向 `wp-admin/admin-ajax.php` 发送包含 `SLEEP()` 函数的特制 payload，并监控服务器响应时间来判断是否存在 SQL 注入。如果服务器响应时间符合预期延迟，则认为目标存在漏洞。从代码逻辑来看，该 PoC 有效。

**投毒风险：**

检查 `CVE-2025-5287.py` 脚本和 `README.md` 文件后，没有发现明显的恶意代码。脚本主要功能是发送包含 SQL 注入 payload 的 HTTP 请求，并根据响应时间判断漏洞是否存在。`README.md` 文件仅包含脚本的描述和使用方法。 潜在的投毒风险较低。需要注意的是，使用任何第三方提供的漏洞利用代码都存在一定风险，建议在使用前进行代码审计。如果作者想投毒，可能会通过代理服务器将所有请求记录下来或者通过其他的手段进行攻击。

**利用方式：**

1.  **漏洞位置：** `wp-admin/admin-ajax.php` 的 'post' 参数。
2.  **攻击方式：** 未经身份验证的攻击者可以构造包含恶意 SQL 代码的 'post' 参数，发送到目标 WordPress 站点的 `wp-admin/admin-ajax.php`。由于插件未对该参数进行充分的过滤和转义，恶意 SQL 代码会被直接拼接到数据库查询语句中执行。
3.  **影响：** 攻击者可以利用该漏洞执行任意 SQL 查询，从而读取、修改或删除数据库中的数据。例如，可以提取管理员账户的用户名和密码，或直接在数据库中插入恶意代码，进一步控制服务器。
4. **利用步骤：**
    *   确定目标 WordPress 站点安装了受影响版本的 Likes and Dislikes 插件。
    *   使用提供的 Python 脚本或手动构造 HTTP 请求，向 `wp-admin/admin-ajax.php` 发送包含 SQL 注入 payload 的请求。
    *   根据服务器响应判断漏洞是否存在。
    *   如果漏洞存在，可以进一步利用 SQL 注入漏洞执行任意 SQL 查询。

**搜索引擎结果优先级：**

搜索引擎结果提供了关于 CVE-2025-5287 漏洞的基本信息，包括漏洞描述、影响版本和修复建议。其中，GitHub 链接指向了漏洞利用代码的存储库，表明该漏洞已经被公开披露和利用。

**漏洞利用代码优先级：**

漏洞利用代码提供了实际可用于检测和利用漏洞的 PoC 脚本。通过分析代码，可以深入了解漏洞的利用方式和影响。

**漏洞库信息优先级：**

漏洞库信息提供了关于漏洞的官方描述、CVSS 评分和修复建议等信息。可以作为评估漏洞风险和制定修复策略的参考。

**项目地址:** [wiseep/CVE-2025-5287](https://github.com/wiseep/CVE-2025-5287)

**漏洞详情:** [CVE-2025-5287](https://nvd.nist.gov/vuln/detail/CVE-2025-5287)