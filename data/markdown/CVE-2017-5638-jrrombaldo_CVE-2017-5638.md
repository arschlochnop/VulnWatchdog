## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)