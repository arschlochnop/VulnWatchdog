## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未授权攻击者可利用该漏洞以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需配置 GlobalProtect gateway 或 portal，无需开启设备遥测

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS GlobalProtect 功能中的一个命令注入漏洞。攻击者可以通过构造恶意请求，利用任意文件创建漏洞实现命令注入，最终在防火墙上以 root 权限执行任意代码。

**有效性评估：**

根据漏洞描述和搜索结果，CVE-2024-3400 漏洞是一个严重的安全问题，存在公开可用的 PoC，且已被实际利用。因此，提供的 PoC 代码很可能有效。

**投毒风险评估：**

提供的漏洞利用代码仅包含README.md文件，该文件主要描述了安全分析人员如何检测和响应此漏洞，没有发现任何可以执行的代码。
因此，可以判定该仓库存在作者隐藏的投毒代码的可能性较低，大约为10%， 主要考虑有以下几点原因：
*   **README.md文件：** 该文件详细描述了漏洞的分析、检测和修复过程，更像是一个安全分析报告。
*   **引用外部PoC：** 该文件引用了 GitHub 上另一个 PoC 仓库（`https://github.com/seed1337/CVE-2024-24919-POC/blob/main/exploit.py`），表明作者可能并未自行编写漏洞利用代码，而是使用了公开资源。
*   **缺乏可执行代码：** 提供的文件中没有任何可执行的代码，因此无法直接进行恶意操作。

**利用方式分析：**

1.  **漏洞成因：** 由于GlobalProtect 功能中存在任意文件创建漏洞，导致可以执行系统命令。
2.  **攻击方式：** 攻击者构造特定的 HTTP 请求，该请求包含恶意的 payload， 尝试读取敏感文件（例如 `/etc/shadow`）。
3.  **利用结果：** 成功利用该漏洞可使攻击者在目标系统上以 root 权限执行任意命令。
4.  **修复方案：** 升级到 PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3 及以上版本。

**项目地址:** [CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-](https://github.com/CyberBibs/SOC274---Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400-)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)