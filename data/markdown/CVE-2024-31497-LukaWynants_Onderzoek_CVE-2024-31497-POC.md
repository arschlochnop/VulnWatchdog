## CVE-2024-31497-PuTTY-ECDSA密钥恢复

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA密钥恢复

**影响应用:** PuTTY

**危害等级:** 高危，可能导致密钥泄露和供应链攻击

**影响版本:** 0.68 到 0.80 (不含 0.81)

**利用条件:** 需要大约60个使用NIST P-521密钥通过有漏洞的PuTTY版本签名的消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 是 PuTTY 0.68 到 0.80 版本中存在的一个漏洞，该漏洞源于有偏差的 ECDSA nonce 生成。攻击者可以通过收集大约 60 个使用 NIST P-521 密钥通过有漏洞的 PuTTY 版本签名的消息，利用 LLL（Lenstra–Lenstra–Lovász）算法恢复用户的私钥。

**有效性：**
根据漏洞描述和参考链接，该漏洞是真实存在的，并且已经有公开的 PoC 利用代码（github.com/daedalus/BreakingECDSAwithLLL）。 提供的文件 `/tmp/ce70fe6db3fc1fe6875bdb2d2a00751f/README.md` 仅仅是一个 README 文件，看起来像是某个 PoC 研究项目的说明，本身不包含可执行代码，验证需要结合`github.com/daedalus/BreakingECDSAwithLLL`仓库中的代码进行。

**投毒风险：**
提供的漏洞利用代码 `/tmp/ce70fe6db3fc1fe6db3fc1fe6875bdb2d2a00751f/README.md` 只是一个README文件，主要提供关于漏洞研究的说明。虽然该文件本身不包含恶意代码，但是完整的PoC可能存在被投毒的风险，例如修改利用脚本，在密钥恢复后植入后门或者进行其他恶意操作。由于目前只提供了README文件，无法确定是否存在后门代码，推测投毒风险为 10%。

**利用方式：**
1.  **收集签名：** 攻击者需要收集受害者使用有漏洞的 PuTTY 版本（0.68 到 0.80）通过 NIST P-521 密钥签名的消息。这些消息可能来自公开的 Git 仓库（如果使用了 SSH 签名）或者被攻陷的 SSH 服务器。
2.  **密钥恢复：** 收集到足够的签名（大约 60 个）后，攻击者可以使用 PoC 代码（例如 `github.com/daedalus/BreakingECDSAwithLLL`）和 LLL 算法恢复用户的私钥。
3.  **恶意利用：** 恢复私钥后，攻击者可以使用该密钥冒充受害者，进行各种恶意活动，例如：
    *   **供应链攻击：** 如果受害者使用该密钥对 Git 仓库进行签名，攻击者可以冒充受害者提交恶意代码。
    *   **未授权访问：** 攻击者可以使用该密钥访问受害者可以访问的任何 SSH 服务。

**项目地址:** [LukaWynants/Onderzoek_CVE-2024-31497-POC](https://github.com/LukaWynants/Onderzoek_CVE-2024-31497-POC)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)