## CVE-2023-3460-Ultimate Member-权限提升

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member WordPress plugin

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制网站

**影响版本:** < 2.6.7

**利用条件:** Ultimate Member插件版本低于2.6.7，目标WordPress站点存在注册页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-3460 漏洞存在于 Ultimate Member WordPress 插件的注册模块。未授权的攻击者可以通过构造恶意的注册请求，将新注册的用户提升为管理员权限，从而完全控制网站。

**漏洞利用方式：**

1.  **版本检测：** POC首先尝试从`/wp-content/plugins/ultimate-member/readme.txt`获取插件版本，判断目标是否在受影响范围内。
2.  **获取Nonce：**  POC访问注册页面（`/index.php/register/`），提取用于防止跨站请求伪造（CSRF）的nonce值（`_wpnonce`）。
3.  **创建管理员账户：** POC构造一个包含管理员权限（`wp_càpabilities[administrator]`: 1）的注册请求，并将用户名、密码、邮箱等信息通过POST请求发送到注册页面。`form_id`硬编码为6，可能需要根据实际情况修改。
4.  **验证：** 检查返回的状态码，如果重定向到302，则表示管理员账户创建成功。

**有效性：**

从提供的漏洞库信息和搜索引擎结果来看，此漏洞已在野外被积极利用。POC代码也提供了一个相对简单的利用方式，通过构造注册请求可以直接添加管理员用户。因此，提供的POC代码是有效的。

**投毒风险：**

代码本身的功能是利用漏洞创建管理员帐户。代码存在投毒的风险较低，但仍需注意以下几点：

*   **硬编码的`form_id`：** `form_id` 被硬编码为6。如果目标网站的注册表单ID不是6，则此POC无法正常工作，可能需要根据目标站点的实际情况手动更改。这可以被视为一种轻微的“陷阱”，但更可能是为了简化POC的实现。
*   **潜在后门：** 仔细审查代码，确认是否存在在创建管理员账户之外，还添加了其他后门或者恶意行为。当前的代码没有发现此类行为。
*   **依赖外部库：** 代码依赖 `requests` 和 `colorama` 库。 虽然这些库本身很常用，但从不可信的来源安装它们存在风险。

总体而言，代码中存在明显投毒的可能性较低，估计在5%左右。主要风险在于不熟悉代码的用户直接使用，可能因为参数不匹配而导致利用失败，或者因为依赖的第三方库而被引入其他安全问题。但从代码本身来看，主要功能集中在实现漏洞利用上，没有发现额外恶意行为。

**项目地址:** [gbrsh/CVE-2023-3460](https://github.com/gbrsh/CVE-2023-3460)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)