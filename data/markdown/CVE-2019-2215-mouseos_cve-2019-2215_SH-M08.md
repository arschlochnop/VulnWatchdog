## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)