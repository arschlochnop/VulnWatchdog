## CVE-2024-32002 Git Submodule RCE

**漏洞编号:** CVE-2024-32002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git

**危害等级:** 高危，允许攻击者在受害者机器上执行任意代码

**影响版本:** 受影响版本包括 2.45.0, 2.44.0, >= 2.43.0 且 < 2.43.4, >= 2.42.0 且 < 2.42.2, 2.41.0, >= 2.40.0 且 < 2.40.2, 以及 < 2.39.4

**利用条件:** 目标系统需要使用受影响的Git版本，并且文件系统区分大小写，支持符号链接，用户需要克隆恶意仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32002 漏洞存在于 Git 的子模块处理中。攻击者可以创建一个恶意仓库，其中包含特殊的子模块配置，使得在克隆仓库时，Git 将文件写入 `.git/` 目录而非子模块的工作目录。这允许攻击者放置一个恶意 hook 脚本到 `.git/hooks` 目录，该脚本会在克隆过程执行时被触发，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意子模块配置的Git仓库。
2.  该恶意配置指向一个包含 hook 脚本的子模块。
3.  受害者使用 `git clone --recursive` 命令克隆该仓库。
4.  Git 在处理子模块时，会将恶意 hook 脚本写入 `.git/hooks` 目录。
5.  克隆过程执行到一定阶段时，恶意 hook 脚本被触发，执行攻击者指定的任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞真实存在，并且有公开的PoC（例如vsociety提供的PoC）。提供的PoC代码`git clone --recursive "git@github.com:masamuneee/CVE-2024-32002-POC.git"` 可以触发漏洞。

**投毒风险：**

提供的 PoC 代码仅仅是一个 README 文件，用于演示漏洞利用的克隆命令。但是， `masamuneee/CVE-2024-32002-POC.git` 仓库本身可能包含恶意 payload（例如 hook 脚本）。虽然目前的PoC只是一个说明文件，不构成直接威胁，但是如果用户真的去克隆`git@github.com:masamuneee/CVE-2024-32002-POC.git`这个仓库,存在被投毒的风险。即使作者本意是提供PoC，也可能被其他人修改后上传带有恶意代码的版本。 因此，投毒风险评估为10%，主要源于克隆远程仓库的潜在风险，以及对作者上传的poc完整性的怀疑，毕竟用户克隆的是远程仓库，本地进行验证。

**参考链接：**

*   [https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv](https://github.com/git/git/security/advisories/GHSA-8h77-4q3w-gfgv)
*   [https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002](https://www.vicarius.io/vsociety/posts/exploiting-git-rce-cve-2024-32002)
*   [https://www.wiz.io/vulnerability-database/cve/cve-2024-32002](https://www.wiz.io/vulnerability-database/cve/cve-2024-32002)

**项目地址:** [Masamuneee/CVE-2024-32002-POC](https://github.com/Masamuneee/CVE-2024-32002-POC)

**漏洞详情:** [CVE-2024-32002](https://nvd.nist.gov/vuln/detail/CVE-2024-32002)