## CVE-2018-19664 - libjpeg-turbo 堆缓冲区过度读取

**漏洞编号:** CVE-2018-19664

**漏洞类型:** 堆缓冲区过度读取

**影响应用:** libjpeg-turbo

**危害等级:** 中危，可能导致信息泄露

**影响版本:** 2.0.1

**利用条件:** 需要处理特制的 BMP 图像

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-19664 存在于 libjpeg-turbo 2.0.1 版本的 `wrbmp.c` 文件中的 `put_pixel_rows` 函数中。这是一个堆缓冲区过度读取漏洞，当使用 `djpeg` 处理某些 BMP 图像时会触发。漏洞的根本原因是程序在处理 BMP 图像的像素行时，读取了超出分配的堆缓冲区范围的数据，可能泄露敏感信息。

**有效性评估：**
漏洞库信息和搜索结果都表明该漏洞是一个真实的堆缓冲区过度读取漏洞，并且存在可复现的PoC，可以通过特制的BMP图像触发。

**投毒风险分析：**
提供的漏洞利用代码(`BUILDING.md`) 只是 libjpeg-turbo 的构建说明文档，不包含任何可执行代码或脚本。因此，不存在通过该文件进行投毒的风险。

**利用方式：**
1.  **准备特制的 BMP 图像：**  构造一个 BMP 图像，使其在 `put_pixel_rows` 函数中触发缓冲区过度读取。需要精心设计图像的尺寸、颜色深度等参数，使得读取操作超出分配的堆缓冲区边界。
2.  **使用 djpeg 处理图像：**  使用 `djpeg` 命令行工具（libjpeg-turbo 自带）处理构造的 BMP 图像。`djpeg` 在处理图像时会调用 `put_pixel_rows` 函数。
3.  **触发漏洞：**  当 `djpeg` 处理特制的 BMP 图像时，`put_pixel_rows` 函数会尝试读取超出堆缓冲区范围的数据，从而触发漏洞。这可能导致程序崩溃或泄露堆内存中的敏感信息。

**总结：**
该漏洞利用依赖于提供特制的BMP图像，并通过`djpeg`工具触发。虽然该漏洞可能不会直接导致远程代码执行，但信息泄露的风险仍然存在，因此需要及时更新 libjpeg-turbo 版本以修复此漏洞。

**项目地址:** [h31md4llr/libjpeg_cve-2018-19664](https://github.com/h31md4llr/libjpeg_cve-2018-19664)

**漏洞详情:** [CVE-2018-19664](https://nvd.nist.gov/vuln/detail/CVE-2018-19664)