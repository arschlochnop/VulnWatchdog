## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)