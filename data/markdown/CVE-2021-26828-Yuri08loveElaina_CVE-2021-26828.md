## CVE-2021-26828 - ScadaBR Authenticated RCE

**漏洞编号:** CVE-2021-26828

**漏洞类型:** 远程代码执行

**影响应用:** ScadaBR

**危害等级:** 高危，允许远程认证用户上传和执行任意JSP文件，可能导致完全系统控制

**影响版本:** Linux: <= 0.9.1, Windows: <= 1.12.4

**利用条件:** 需要有效的ScadaBR用户认证凭据和网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26828漏洞存在于OpenPLC ScadaBR软件中，允许远程认证用户通过`view_edit.shtm`页面上传并执行任意JSP文件。提供的PoC代码（`scadaflare.py`）是一个Python脚本，旨在利用此漏洞。该脚本包含Linux和Windows两种payload，Linux payload使用反向shell，Windows payload使用命令执行。脚本功能包括kill switch、环境信息泄漏、反向shell和自清理机制。搜索结果表明该漏洞已被公开披露，并且存在公开可用的PoC代码。

**有效性：**根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该漏洞是有效的，并且存在可利用的PoC。

**投毒风险：**PoC代码中存在一定的投毒风险。虽然核心功能是实现远程代码执行，但是作者有可能在logging模块中加入恶意代码，记录受害者信息或进行其他未授权操作。风险评估为10%。

**利用方式：**
1.  攻击者需要拥有一个有效的ScadaBR用户账户。
2.  使用PoC脚本（`scadaflare.py`）或者手动构造请求，上传包含恶意代码的JSP文件到服务器。
3.  通过访问上传的JSP文件，触发恶意代码执行。
4.  根据选择的payload，可以获得反向shell或者执行任意命令。

总而言之，这是一个高危漏洞，利用简单，影响广泛，需要及时修复。

**项目地址:** [Yuri08loveElaina/CVE-2021-26828](https://github.com/Yuri08loveElaina/CVE-2021-26828)

**漏洞详情:** [CVE-2021-26828](https://nvd.nist.gov/vuln/detail/CVE-2021-26828)