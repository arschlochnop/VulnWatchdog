## CVE-2024-45436-Ollama-路径遍历

**漏洞编号:** CVE-2024-45436

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** < 0.1.47

**利用条件:** 需要能够上传或提供恶意的ZIP文件给Ollama处理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45436 是 Ollama 软件在 0.1.47 版本之前的路径遍历漏洞，存在于 `extractFromZipFile` 函数中。攻击者可以构造一个恶意的 ZIP 文件，该文件包含指向父目录的路径（例如 `../`），从而将 ZIP 文件中的内容解压到文件系统的任意位置，进而覆盖或访问敏感文件。根据搜索结果，存在公开的POC代码。提供的代码段是Apache License 2.0的文本，不是漏洞利用代码，无法直接评估其有效性。 但根据搜索结果中的github链接，POC是存在的，所以有效性较高。由于提供的文件是Apache License 2.0协议文本，不包含任何可执行代码，因此投毒风险为0%。利用方式是：攻击者创建一个包含恶意路径的ZIP文件，当Ollama服务器处理这个ZIP文件时，由于没有正确校验解压路径，会将文件解压到恶意路径，导致任意文件写入。

**项目地址:** [XiaomingX/cve-2024-45436-exp](https://github.com/XiaomingX/cve-2024-45436-exp)

**漏洞详情:** [CVE-2024-45436](https://nvd.nist.gov/vuln/detail/CVE-2024-45436)