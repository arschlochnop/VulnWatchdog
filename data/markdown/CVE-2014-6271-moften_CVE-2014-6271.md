## CVE-2014-6271 Shellshock漏洞扫描器

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许攻击者执行任意命令

**影响版本:** <= 4.3

**利用条件:** 目标系统运行存在漏洞的Bash版本，并且存在CGI脚本或其他方式通过环境变量调用Bash。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271 (Shellshock) 漏洞允许攻击者通过特制的 Bash 环境变量执行任意命令。漏洞存在于 Bash 处理函数定义后尾随字符串的方式中。 

**有效性：**
提供的PoC代码是一个Python脚本，用于扫描目标URL是否存在Shellshock漏洞。它通过发送包含恶意payload的User-Agent头部的HTTP请求到常见的CGI脚本路径，然后检查响应中是否包含特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断目标是否易受攻击。根据漏洞库信息和搜索结果，该漏洞利用方式是有效的。

**投毒风险：**
该仓库包含一个Python脚本和一个README.md文件。Python脚本的功能是发送包含特定payload的HTTP请求并检查响应。README.md文件仅包含项目名称和描述。
 *  投毒代码分析: 该python脚本主要功能是发送特定Header的请求到服务器端CGI脚本,存在以下潜在的投毒风险：
    *  **CGI脚本路径猜测：**脚本中包含一个常见的CGI脚本路径列表。如果攻击者控制了该列表，可以通过添加恶意CGI路径来欺骗扫描者，引导他们攻击不存在的或伪造的服务。
    *  **Payload修改：**虽然当前的payload是良性的，用于检测漏洞，但攻击者可能修改payload以执行恶意操作，例如上传后门或执行拒绝服务攻击。
    *  **扫描行为：** 扫描行为本身可能被目标系统检测为恶意活动，从而触发防御机制或记录扫描者的IP地址。
    *  **误报风险：**脚本依赖于特定的字符串（'VULNERABLE-SHELLSHOCK'）来判断漏洞是否存在。如果目标服务器返回包含该字符串的响应，即使实际不存在漏洞，脚本也会报告为易受攻击。修改这个字串可以导致信息泄露或者权限提升,因此可能存在一定风险。

**利用方式：**
1.  **环境变量注入：** 攻击者构造一个包含恶意代码的 Bash 函数定义的环境变量。例如：`(){ :;}; /usr/bin/id`。
2.  **触发 Bash 执行：** 通过 CGI 脚本、OpenSSH 的 ForceCommand 功能、DHCP 客户端脚本等方式，将构造的包含恶意代码的环境变量传递给 Bash。
3.  **代码执行：** 当 Bash 执行上述环境变量时，由于漏洞，尾随在函数定义后的命令会被执行，从而实现远程代码执行。

**总结：**
该PoC代码利用了Shellshock漏洞，通过环境变量注入执行任意命令。漏洞影响范围广泛，修复难度较大，危害程度高。


**项目地址:** [moften/CVE-2014-6271](https://github.com/moften/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)