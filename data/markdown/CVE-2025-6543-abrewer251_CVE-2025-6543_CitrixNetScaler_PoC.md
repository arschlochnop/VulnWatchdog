## CVE-2025-6543 NetScaler ADC/Gateway 内存溢出

**漏洞编号:** CVE-2025-6543

**漏洞类型:** 内存溢出

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可能导致拒绝服务和控制流劫持

**影响版本:** NetScaler ADC 14.1 < 47.46, 13.1 < 59.19, 13.1 FIPS and NDcPP < 37.236; NetScaler Gateway 14.1 < 47.46, 13.1 < 59.19, 13.1 FIPS and NDcPP < 37.236

**利用条件:** 需要目标设备配置为 Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) 或者 AAA virtual server，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6543 是一个 NetScaler ADC 和 NetScaler Gateway 中的内存溢出漏洞。当设备配置为 Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) 或 AAA virtual server 时，此漏洞可能导致拒绝服务（DoS）或未预期的控制流劫持。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已经被积极利用。提供的 PoC 代码是一个增强的漏洞检查器，可以扫描多个主机和端口，通过 SNMP 和 SSH 获取版本信息，并与已知的补丁版本进行比较来判断设备是否容易受到攻击。PoC 中包含一个“exploit probe”存根，表明该漏洞是可以被利用的，尽管提供的代码中没有实际的漏洞利用逻辑。综合判断 PoC 代码有效，可以检测目标是否存在漏洞。

**投毒风险：**

PoC 代码的主要功能是扫描和版本检测，没有发现明显的恶意代码。但是，`cve_2025_6543_checker.py`脚本利用`subprocess`模块调用外部程序（`snmpget`和`sshpass`）来进行SNMP和SSH的扫描，如果攻击者能够控制目标系统的环境变量或者篡改这些外部程序的路径，则可能实现远程代码执行，存在一定的安全风险。

仓库中包含 `LICENSE` 和 `README.md` 文件，说明作者有意公开此工具，降低了恶意投毒的可能性。`README.md` 文档中包含免责声明，表明该工具仅用于授权的安全测试。

综合以上分析，投毒风险较低，估计为 10%。风险主要来自于对外部命令的调用，而非代码本身包含恶意逻辑。

**利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 NetScaler ADC 或 Gateway，且配置为 Gateway 或 AAA virtual server。
2.  **版本检测：** 使用 PoC 脚本扫描目标，通过 SNMP 或 SSH 获取设备的版本信息。
3.  **漏洞确认：** 将获取的版本信息与已知的受影响版本进行比较，确认目标是否存在漏洞。
4.  **漏洞利用：** 由于提供的 PoC 只是一个检查器，要实现真正的漏洞利用，需要开发者在“exploit probe”存根中添加漏洞利用代码，例如，构造特定的恶意请求，触发内存溢出，从而实现 DoS 或控制流劫持。根据搜索结果，可能存在未经验证的远程代码执行（RCE）的可能性，但需要进一步的研究和利用。
5.  **缓解措施：** 尽快升级到 NetScaler ADC 和 NetScaler Gateway 的安全版本 (>= 14.1-47.46, >= 13.1-59.19, >= 13.1 FIPS and NDcPP-37.236)。

**项目地址:** [abrewer251/CVE-2025-6543_CitrixNetScaler_PoC](https://github.com/abrewer251/CVE-2025-6543_CitrixNetScaler_PoC)

**漏洞详情:** [CVE-2025-6543](https://nvd.nist.gov/vuln/detail/CVE-2025-6543)