## CVE-2017-8481 Windows Kernel Information Disclosure Vulnerability

**漏洞编号:** CVE-2017-8481

**漏洞类型:** 信息泄露

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能泄露敏感内核信息

**影响版本:** Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, 1703, and Windows Server 2016.

**利用条件:** 需要经过身份验证的本地访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-8481 是一个 Windows 内核信息泄露漏洞。经验证有效的POC代码通过`NtQueryInformationResourceManager`函数，配合内核栈喷射，尝试读取内核内存。该POC代码首先动态加载 `ntdll.dll` 并获取 `NtQueryInformationResourceManager` 函数的地址。然后，它创建一个易失性事务管理器和资源管理器。接下来，通过 `NtMapUserPhysicalPages` 函数进行内核栈喷射，将内核栈填充为特定值。最后，POC尝试使用不同大小的缓冲区调用 `NtQueryInformationResourceManager` 函数，并检查返回状态，打印输出和返回长度。根据代码注释，此POC在较新的Windows版本（例如 Windows 11 24h2）上可能已无法复现该漏洞，说明已经被修复。没有发现明显的投毒代码，作者更倾向于说明此代码为了未来研究。通过控制缓冲区大小，尝试读取内核信息，若成功则可能导致敏感信息泄露。

**项目地址:** [TamatahYT/CVE-2017-8481](https://github.com/TamatahYT/CVE-2017-8481)

**漏洞详情:** [CVE-2017-8481](https://nvd.nist.gov/vuln/detail/CVE-2017-8481)