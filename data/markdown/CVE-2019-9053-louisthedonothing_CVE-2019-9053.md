## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露、未授权访问和远程代码执行

**影响版本:** <= 2.2.9

**利用条件:** 需要目标CMS Made Simple站点存在 News 模块且能够通过URL访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053 是 CMS Made Simple 2.2.9 及更早版本中 News 模块存在的一个未经身份验证的盲注时间型 SQL 注入漏洞。攻击者可以通过构造特制的 URL，利用 `m1_idlist` 参数执行恶意的 SQL 查询，从而提取数据库中的敏感信息。漏洞利用方式如下：

1.  **漏洞点：** `/moduleinterface.php`，`m1_idlist` 参数。
2.  **注入类型：** 盲注时间型 SQL 注入。攻击者无法直接看到 SQL 查询的结果，而是通过观察服务器响应的时间来推断查询结果。
3.  **利用方式：** 攻击者构造包含 `sleep()` 函数的 SQL 查询语句，如果查询条件为真，服务器会休眠指定的时间，攻击者通过判断响应时间来确定条件是否成立。

POC 代码 `46635.py` 实现了自动化利用该漏洞。它首先尝试获取 salt 值，然后获取管理员密码的哈希值，最后可以选择使用字典破解密码。 代码通过二分法逐个字符地猜测密码或 salt。 存在投毒风险的可能性较低，但是仍需进行代码审计以确定是否存在作者隐藏的恶意代码（例如，向远程服务器发送数据）。由于代码使用了requests库，存在发起外部连接的可能，从而可以隐蔽发送数据或者进行其他恶意行为. 投毒风险主要来自于篡改时间延迟的参数或者在获取到信息后，暗中发送到恶意地址。

**项目地址:** [louisthedonothing/CVE-2019-9053](https://github.com/louisthedonothing/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)