## CVE-2025-5394 - Alone WordPress Theme 任意文件上传导致远程代码执行

**漏洞编号:** CVE-2025-5394

**漏洞类型:** 任意文件上传

**影响应用:** Alone WordPress Theme

**危害等级:** 高危，允许未授权用户上传恶意文件并执行任意代码

**影响版本:** <= 7.8.3

**利用条件:** 目标WordPress站点使用Alone主题，且版本小于等于7.8.3，可网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5394是Alone WordPress Theme主题中一个严重的任意文件上传漏洞。该漏洞源于`alone_import_pack_install_plugin()`函数缺少权限检查，允许未经身份验证的攻击者上传恶意ZIP文件，其中包含伪装成插件的webshell，从而实现远程代码执行。

**漏洞利用方式：**
1.  攻击者构造包含webshell的ZIP文件，并将其托管在可公开访问的URL上。
2.  攻击者向目标WordPress站点的`wp-admin/admin-ajax.php`发送POST请求，指定`action`为`beplus_import_pack_install_plugin`，并包含`data[plugin_slug]`（webshell的文件名，不含.zip后缀）和`data[plugin_source]`（webshell的URL）参数。
3.  由于缺少权限验证，目标站点会将ZIP文件解压到`wp-content/plugins/`目录下，并执行其中的PHP代码，从而导致远程代码执行。

**有效性：**
提供的POC代码可以有效利用该漏洞。POC脚本会自动构建payload，发送请求，并尝试上传和激活包含webshell的插件。如果成功，它会输出webshell的URL。

**投毒风险：**
存在较低的投毒风险（5%）。

*   **POC代码审查：**
    *   POC代码逻辑相对简单，主要功能是构建payload并发送请求，上传指定URL的ZIP文件。
    *   代码中存在一个LICENSE文件，声明了使用限制，但未发现任何隐藏的恶意代码。
    *   脚本使用`urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)`禁用了SSL证书验证，虽然这在渗透测试中很常见，但如果攻击者在中间人攻击中使用该脚本，可能会导致安全风险。
    *  作者Khaled Alenazi (Nxploited) 在github上面有一定知名度,但是不排除投毒可能.

*   **潜在风险：**
    *   虽然POC代码本身未发现明显的投毒代码，但攻击者可能会修改POC，使其上传包含恶意后门的ZIP文件，从而感染目标站点。
    *   此外，如果攻击者控制了托管ZIP文件的服务器，他们可以随时更改ZIP文件的内容，使其包含恶意代码。

**总结：**
该漏洞利用简单，风险极高。管理员应立即升级Alone主题到最新版本，或者禁用该主题。 同时，注意保护好自己的webshell 服务器避免被入侵，被用于传播恶意payload。 提供的POC代码有效，但使用时需要注意潜在的投毒风险。

**项目地址:** [Nxploited/CVE-2025-5394](https://github.com/Nxploited/CVE-2025-5394)

**漏洞详情:** [CVE-2025-5394](https://nvd.nist.gov/vuln/detail/CVE-2025-5394)