## CVE-2025-48799 - Windows Update Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-48799

**漏洞类型:** 特权提升

**影响应用:** Windows Update Service (wuauserv)

**危害等级:** 高危，攻击者可以利用此漏洞提升权限到SYSTEM

**影响版本:** 受影响的Windows 10, Windows 11和Windows Server 2025版本（见漏洞库信息）

**利用条件:** 需要至少拥有一个低权限账户和至少两个硬盘驱动器。需要能够修改Storage Sense的存储位置设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48799 是一个 Windows Update Service 的权限提升漏洞，利用了不正确的符号链接处理。攻击者通过以下步骤利用此漏洞：

1.  **设置存储位置：** 攻击者利用 Storage Sense 功能将新内容的存储位置更改为辅助驱动器。
2.  **创建符号链接：** 攻击者创建一个指向敏感系统目录（例如 `C:\Windows\System32`）的符号链接。
3.  **触发更新：** 当 Windows Update Service 安装新应用程序或更新时，由于符号链接的存在，服务可能会错误地删除目标目录中的文件，从而允许攻击者替换系统文件或执行任意代码。

**漏洞利用有效性分析：**

根据漏洞库信息，搜索引擎结果和提供的PoC代码，可以判断此漏洞利用的有效性较高。存在公开的PoC代码，并且多个安全厂商已经对此漏洞进行了分析和报告。PoC代码描述了如何通过操纵符号链接和 Windows Update Service 的行为来提升权限。

**投毒风险分析：**

提供的PoC代码文件列表包括一个README.md和一个FileOplock.cpp文件。 README.md文件主要提供漏洞的描述，下载链接，使用说明和免责声明等信息。FileOplock.cpp 文件实现了与文件操作锁相关的逻辑，根据代码内容，其主要目的是请求和管理文件操作锁，以模拟或控制文件操作的时序。虽然看似无害，但潜在的投毒风险在于：

*   **依赖项和构建过程：** README.md 中提供的下载链接指向一个 GitHub 仓库，该仓库可能包含恶意代码。此外，构建 PoC 可能需要额外的依赖项，这些依赖项也可能被篡改。
*   **文件操作锁的滥用：** FileOplock.cpp 中对文件操作锁的控制，如果被恶意修改，可能导致拒绝服务或数据损坏。
*   **Payload 的隐藏：** 恶意代码可能隐藏在其他资源文件、配置文件或脚本中，在编译或运行时执行恶意操作。

综合来看，虽然提供的代码片段本身没有明显的恶意行为，但整个 PoC 的下载、构建和运行过程存在一定的投毒风险。因此，保守估计投毒风险为 10%。需要对完整的 PoC 代码进行更深入的分析才能准确评估。


**项目地址:** [ukisshinaah/CVE-2025-48799](https://github.com/ukisshinaah/CVE-2025-48799)

**漏洞详情:** [CVE-2025-48799](https://nvd.nist.gov/vuln/detail/CVE-2025-48799)