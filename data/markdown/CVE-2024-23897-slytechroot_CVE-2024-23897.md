## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE（通过读取密钥等）

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 目标Jenkins实例需要启用CLI接口并且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞，利用了args4j库的参数解析功能。Jenkins CLI允许用户通过命令行与Jenkins交互。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的后接文件路径的内容替换为文件内容。未经身份验证的攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：** 提供的POC代码有效。它通过构造特定的HTTP请求，利用Jenkins CLI的'@file'参数扩展功能来读取指定文件。POC代码中使用了两个线程，一个用于发送带有Session ID的下载请求，另一个用于发送带有Session ID和文件内容的上传请求。这种方式是利用了Jenkins CLI处理会话的方式。

**投毒风险：** 该仓库中没有发现明显的投毒代码。POC代码的功能明确，仅用于读取文件。README文件也只是提供了漏洞描述、利用方式和修复建议。因此，投毒风险为0%。

**利用方式：**
1.  确定目标Jenkins实例的URL。
2.  使用POC代码，指定目标URL和要读取的文件路径作为参数（例如，`python poc.py http://127.0.0.1:8888/ /etc/passwd`）。
3.  POC代码会发送两个HTTP POST请求到`/cli?remoting=false`端点，其中一个请求包含`@file`参数，指向要读取的文件。
4.  Jenkins服务器会解析该请求，并将指定文件的内容返回到响应中。
5.  攻击者可以从响应中获取文件内容。

**项目地址:** [slytechroot/CVE-2024-23897](https://github.com/slytechroot/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)