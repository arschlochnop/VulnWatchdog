## CVE-2025-55752-Apache Tomcat 路径遍历

**漏洞编号:** CVE-2025-55752

**漏洞类型:** 路径遍历

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致信息泄露甚至远程代码执行（若PUT方法启用）

**影响版本:** Apache Tomcat 11.0.0-M1 至 11.0.10, 10.1.0-M1 至 10.1.44, 9.0.0.M11 至 9.0.108, 8.5.6 至 8.5.100

**利用条件:** 需要RewriteValve启用，且存在将查询参数重写到URL的规则。开启PUT方法可以上传恶意文件，但较为少见。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-55752 是 Apache Tomcat 中 RewriteValve 的一个路径遍历漏洞，由于 URL 规范化在 URL 解码之前发生，导致攻击者可以通过操纵请求 URI 绕过安全约束，访问受保护的目录，如 /WEB-INF/ 和 /META-INF/。如果启用了 PUT 请求，则可能导致远程代码执行。 

**有效性：**提供的POC代码是有效的。它提供了一个基于 Docker 的环境来重现该漏洞。通过利用URL编码的路径遍历序列（`..%2f`），可以绕过对`/WEB-INF/`等目录的保护，读取受保护的文件，例如`web.xml`。

**投毒风险：**该漏洞利用代码仓库主要包含Dockerfile、docker-compose.yml、以及一个python的POC文件。整体结构清晰，目的是为了复现该漏洞。虽然理论上任何代码都存在投毒风险，但该仓库代码简单直接，恶意代码的生存空间较小。Dockerfile 定义了Tomcat版本(10.1.44)和配置，没有可疑的命令。docker-compose.yml 定义了服务编排，也没有发现恶意配置。而python POC 脚本主要用于验证漏洞。综上所述，该仓库存在投毒的概率较低，初步估计为5%。

**利用方式：**

1.  攻击者构造包含URL编码的路径遍历序列的请求，例如`/download?path=..%2fWEB-INF%2fweb.xml`。
2.  RewriteValve 将请求重写为 `/files/..%2fWEB-INF%2fweb.xml`。
3.  Tomcat 先对 URL 进行规范化，但此时 `%2f` 未被识别为 `/`，`..`得以保留。
4.  然后 Tomcat 对 URL 进行解码，将 `%2f` 转换为 `/`，得到 `/files/../WEB-INF/web.xml`。
5.  最后，Tomcat 进行路径解析，将 `/files/../WEB-INF/web.xml` 解析为 `/WEB-INF/web.xml`，从而允许攻击者访问受保护的文件。
6.  如果 PUT 请求被启用，攻击者可能上传恶意的 web shell，最终导致远程代码执行。

**项目地址:** [masahiro331/CVE-2025-55752](https://github.com/masahiro331/CVE-2025-55752)

**漏洞详情:** [CVE-2025-55752](https://nvd.nist.gov/vuln/detail/CVE-2025-55752)