## CVE-2025-2776-SysAid On-Prem-XXE

**漏洞编号:** CVE-2025-2776

**漏洞类型:** XML 外部实体 (XXE) 注入

**影响应用:** SysAid On-Prem

**危害等级:** 高危，可能导致管理员账户接管和文件读取

**影响版本:** <= 23.3.40

**利用条件:** 目标系统运行 SysAid On-Prem 且受害者可访问目标服务器

**POC 可用性:** 是，但提供的代码并非直接的 XXE Payload

**投毒风险:** 30%

## 详情

CVE-2025-2776 是 SysAid On-Prem <= 23.3.40 版本中存在的一个未授权的 XXE 漏洞，位于 Server URL 处理功能中。攻击者可以利用此漏洞读取服务器上的任意文件，甚至接管管理员帐户。

**有效性分析：**

提供的“漏洞利用代码”实际上是一个更广泛的攻击链示例，它源自 EternalBlue 并且已经被修改成如今的 CVE-2025-2776，而不是直接的 XXE Payload。它描述了一个通过 SMB 协议利用 PowerShell 下载和执行恶意脚本的场景，攻击者首先通过某个方法（例如，钓鱼邮件中的 PDF 附件）在目标系统上执行 JavaScript 代码，该代码会创建一个 PowerShell 脚本 (script.ps1)。这个 PowerShell 脚本随后会从远程服务器下载并执行 shell.exe，或者尝试通过 TCP 连接 (445 端口) 向 10.0.1.5 发送 script.ps1 的内容，建立反向 shell 连接。虽然与直接的 XXE Payload 无关，但它展示了漏洞利用中常用的攻击手法。

根据漏洞库信息和搜索结果，CVE-2025-2776 本身是一个 XXE 漏洞，而提供的代码更侧重于后渗透阶段，利用 PowerShell 进行反向 shell 连接。因此，提供的代码本身 *不是* 直接的 XXE Payload，但它揭示了攻击者可能如何进一步利用 XXE 漏洞获取的信息。

**投毒风险分析：**

该存储库似乎更多是一个概念验证 (POC) 和检测方案，而不是一个可以直接使用的漏洞利用程序。但是，其中存在一定风险。

*   **脚本的潜在恶意性：** PowerShell 脚本会从 `https://attack.com/shell.exe` 下载内容并执行，这是一个明显的风险点。攻击者可以控制 `attack.com` 上的内容，从而执行任意代码。由于 `shell.exe` 的实际内容未知，无法判断具体的恶意行为。如果攻击者控制 `attack.com`，则可以在 `shell.exe` 中植入恶意代码，从而感染受害者系统。风险度较高。
*   **IP地址和域名的潜在恶意性：** 脚本中硬编码的 IP 地址 `10.0.1.5` 和域名 `attack.com` 可能是恶意基础设施的一部分，用于接收反向 shell 连接或传播恶意软件。即使当前这些地址和域名是无害的，攻击者也可以随时更改它们，使其指向恶意服务器。风险度中等。
*   **KQL 检测规则的潜在误导性：** 虽然提供的 KQL 检测规则旨在帮助安全分析师检测利用此漏洞的攻击，但如果这些规则编写不当或不完整，可能会导致漏报或误报，从而降低安全防御的有效性。风险度较低。

总体而言，该存储库存在一定的投毒风险，主要集中在脚本下载和执行的恶意代码方面。虽然存储库的作者可能没有恶意意图，但攻击者可以利用该存储库提供的代码来构建和传播恶意软件。因此，在使用该存储库中的代码时，务必谨慎，并进行充分的安全审查。

投毒风险百分比预估：30%。

**利用方式：**

1.  **XXE 漏洞利用：** 攻击者利用 SysAid On-Prem 的 Server URL 处理功能中的 XXE 漏洞，构造恶意的 XML 数据，其中包含外部实体引用。
2.  **文件读取或管理员账户接管：** 通过 XXE 漏洞，攻击者可以读取服务器上的敏感文件，例如配置文件、密码文件等。如果攻击者能够读取包含管理员账户信息的文件，就可以接管管理员账户。
3.  **反向 Shell（利用提供的代码场景）：** 在接管管理员账户后，攻击者可以利用 PowerShell 脚本下载并执行恶意程序，例如反向 shell，从而远程控制受害者系统。

总之，利用方式首先是通过未授权的XXE读取文件或者管理员账号，然后进一步通过获取的权限，利用PoC中相似的脚本下载远程代码执行更深层次的利用。

**项目地址:** [mrk336/From-EternalBlue-to-CVE-2025-2776-The-Evolution-of-an-SMB-Attack](https://github.com/mrk336/From-EternalBlue-to-CVE-2025-2776-The-Evolution-of-an-SMB-Attack)

**漏洞详情:** [CVE-2025-2776](https://nvd.nist.gov/vuln/detail/CVE-2025-2776)