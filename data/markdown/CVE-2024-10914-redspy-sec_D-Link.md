## CVE-2024-10914 - D-Link NAS 设备远程命令执行

**漏洞编号:** CVE-2024-10914

**漏洞类型:** 操作系统命令注入

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可导致远程代码执行，完全控制受影响设备

**影响版本:** 所有版本至 20241028

**利用条件:** 目标设备需要开启web管理界面，攻击者需要能够访问该管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10914 存在于 D-Link NAS 设备的 `account_mgr.cgi` 文件的 `cgi_user_add` 函数中。攻击者通过在 `name` 参数中注入恶意操作系统命令，即可实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源表明存在公开可用的Exploit，且提供的Python脚本就是一个可用的PoC。

**投毒风险：**
提供的Python脚本主要功能是发送HTTP请求到目标设备，利用命令注入漏洞执行payload，并且具备启动交互式shell的功能。代码中存在以下潜在的投毒风险：

1.  **Payload执行：**  脚本允许用户自定义payload，如果用户设置的payload是恶意代码，则会导致被攻击的设备受到恶意攻击。
2.  **交互式Shell：** 脚本启动的交互式shell，虽然方便了攻击者进行渗透测试，但也可能被用于执行恶意操作。
3.  **线程数：** 扫描文件的时候，脚本使用了线程池，如果目标文件包含大量目标，并且线程数设置过高，可能对攻击者的主机造成资源压力，导致拒绝服务。
4.  **请求异常捕获：** 脚本包含了请求异常处理，能处理网络请求中的一些问题，但不能保证完全避免因payload造成的其他异常。

综合来看，此仓库中的投毒风险较低（约10%），主要风险来自于使用者恶意利用该脚本执行非法操作，脚本本身没有发现明显的回连或者破坏行为，当然不排除作者在逻辑不清晰的地方加入恶意代码。

**利用方式：**
1.  攻击者构造包含恶意命令的HTTP GET请求，发送到目标设备的 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=[恶意命令]`
2.  目标设备解析该请求，并将 `name` 参数中的恶意命令注入到操作系统中执行。
3.  攻击者通过分析响应数据，判断命令是否执行成功。
4.  （可选）攻击者可以使用脚本提供的交互式shell，进一步控制目标设备。

**项目地址:** [redspy-sec/D-Link](https://github.com/redspy-sec/D-Link)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)