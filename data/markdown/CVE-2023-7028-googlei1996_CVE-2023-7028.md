## CVE-2023-7028-GitLab账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱口令恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可能导致账户接管

**影响版本:** 16.1之前到16.1.6，16.2之前到16.2.9，16.3之前到16.3.7，16.4之前到16.4.5，16.5之前到16.5.6，16.6之前到16.6.4，以及16.7之前到16.7.2

**利用条件:** 需要目标GitLab实例存在漏洞版本且用户拥有未验证的邮箱地址

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028是一个GitLab的账户接管漏洞，源于其密码重置流程中的缺陷。攻击者可以在密码重置请求中提供两个邮箱地址，一个合法的已验证邮箱地址和一个攻击者控制的邮箱地址。由于漏洞，密码重置邮件可能会发送到攻击者控制的邮箱，从而允许攻击者重置目标用户的密码并接管其账户。

**有效性：**
提供的POC代码 `user[email][]=valid@email.com&user[email][]=attacker@email.com` 表明了利用该漏洞的方式，即在密码重置请求中通过 `user[email][]` 参数传递多个邮箱地址。根据漏洞信息和搜索结果，该POC是有效的。

**投毒风险：**
分析提供的漏洞利用代码文件：

*   `/tmp/39bff639f2358389df0f687fbe2dcf48/README.md` 中只包含POC代码和招聘信息。
*   `exp.png` 文件内容未知，无法分析，理论上存在一定的风险，考虑到文件类型为图片，故风险较低。

综合评估，仓库中存在作者隐藏投毒代码的风险较低，约为10%。 主要集中在`exp.png`中，但是由于图片文件类型，所以风险相对较低，且此仓库的主要信息为POC，诱导下载其他恶意代码概率较低

**利用方式：**

1.  **目标确认：** 确定目标GitLab实例的版本是否在受影响的范围内。
2.  **发起密码重置请求：** 针对目标用户的账户，发起密码重置请求。
3.  **构造恶意请求：** 在密码重置请求中，通过修改请求参数，添加两个 `user[email][]` 参数，一个参数为目标用户的已验证邮箱地址，另一个参数为攻击者控制的邮箱地址。
4.  **接收重置链接：** 如果漏洞存在，密码重置链接将会发送到攻击者控制的邮箱地址。
5.  **重置密码：** 使用攻击者邮箱收到的重置链接，重置目标用户的密码。
6.  **账户接管：** 使用新密码登录目标用户的账户，实现账户接管。

**项目地址:** [googlei1996/CVE-2023-7028](https://github.com/googlei1996/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)