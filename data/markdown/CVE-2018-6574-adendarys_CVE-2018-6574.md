## CVE-2018-6574-Go-get远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 需要目标系统使用受影响的Go版本，并执行 `go get` 命令获取包含恶意代码的包。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 `go get` 命令中，由于未正确过滤 gcc/clang 的 `-fplugin` 和 `-plugin` 参数，攻击者可以通过构造恶意的 Go 包，在构建过程中执行任意命令。提供的POC代码包含一个 C 文件 (`attack.c`)，该文件编译后生成一个动态链接库 (`attack.so`)，其中包含一个 `malicious()` 函数，该函数在动态链接库加载时自动执行，从而执行系统命令 `/usr/local/bin/score 504b8416-d89e-4980-80ff-7cd7d4605752`。Go 代码 (`main.go`) 使用 `#cgo CFLAGS: -fplugin=./attack.so` 指令在编译时加载该动态链接库，从而触发恶意代码的执行。此POC有效，不存在明显的投毒代码，只是利用该漏洞执行预期的恶意行为。

**利用方式：**

1.  攻击者创建一个包含恶意 C 代码（如 `attack.c`）和 Go 代码（如 `main.go`）的 Go 包。
2.  `attack.c` 编译生成一个包含恶意指令的动态库。恶意指令可以是任意系统命令。
3.  Go 代码使用 `#cgo CFLAGS: -fplugin=./attack.so` 引入包含恶意指令的动态库。
4.  攻击者将该 Go 包发布到公共或私有仓库。
5.  受害者使用 `go get` 命令获取该 Go 包。
6.  在构建过程中，Go 编译器会执行 C 编译指令，加载恶意动态链接库，从而执行攻击者预设的恶意命令，导致远程命令执行。

**项目地址:** [adendarys/CVE-2018-6574](https://github.com/adendarys/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)