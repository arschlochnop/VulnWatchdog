## CVE-2025-48384-Git配置注入导致RCE

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/RCE

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要clone包含恶意配置的git仓库（特别是包含submodule的仓库），并递归更新submodule。需要用户交互。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 漏洞是由于 Git 在处理包含回车符（CR）的配置值时存在不一致的行为导致的。具体来说，Git在读取配置值时会移除尾部的CRLF，但在写入配置时，如果值以CR结尾，则不会进行引号包裹，这会导致在后续读取时CR被截断。利用此漏洞，攻击者可以通过构造包含恶意配置的 `.gitmodules` 文件，当用户递归克隆包含 submodule 的仓库时，submodule会被检出到错误的位置。如果错误的位置存在一个指向 submodule 钩子目录的符号链接，并且 submodule 中包含一个可执行的 post-checkout 钩子，那么该钩子脚本可能在检出后被意外执行，从而导致远程代码执行 (RCE)。

**有效性：** 提供的 POC 代码 `/tmp/81eebc7f5ed9915ea7ef755075778acd/README.md` 看起来只是一个 README 文件，用于描述该漏洞。单凭这个文件本身无法直接触发漏洞，但可以作为漏洞利用的一部分，例如提供一个包含恶意`.gitmodules`文件的仓库。因此，提供的 PoC 代码本身无效，需要配合其他恶意文件才能完成漏洞利用。

**投毒风险：** 虽然提供的 PoC 仅仅是一个 README 文件，没有任何可疑代码。但是考虑到攻击者可能会在整个恶意Git仓库的其他位置，比如 `.gitmodules` 文件，或者 submodule 的 post-checkout 钩子中隐藏恶意代码。 考虑到这个漏洞需要恶意git仓库才能触发，因此存在一定的投毒风险，风险占比10%。

**利用方式：**

1.  **创建恶意 Git 仓库：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。
2.  **注入恶意配置：** 在 `.gitmodules` 文件中，攻击者设置 submodule 的路径，并在路径末尾包含一个回车符（CR）。此路径会被 Git 处理错误，导致 submodule 被检出到非预期的位置。
3.  **创建符号链接：** 攻击者在仓库中创建一个符号链接，将错误的 submodule 路径指向 `.git/modules/<submodule>/hooks` 目录。
4.  **添加恶意钩子：** 攻击者在 submodule 中添加一个 post-checkout 钩子脚本，该脚本包含恶意代码。
5.  **诱骗用户克隆：** 攻击者诱骗用户递归克隆（`git clone --recursive`）恶意仓库。
6.  **触发 RCE：** 当用户执行 `git submodule update --init --recursive` 命令或类似的命令初始化 submodule 时，由于配置处理错误和符号链接的存在，恶意 post-checkout 钩子脚本会被执行，从而导致 RCE。

**项目地址:** [butyraldehyde/CVE-2025-48384-PoC](https://github.com/butyraldehyde/CVE-2025-48384-PoC)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)