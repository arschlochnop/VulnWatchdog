## CVE-2025-5777-NetScaler ADC/Gateway-内存信息泄露

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存信息泄露/Out-of-bounds Read

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可能导致会话劫持、身份验证绕过以及敏感信息泄露

**影响版本:** NetScaler ADC/Gateway 13.1 < 58.32, 14.1 < 43.56

**利用条件:** NetScaler配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) 或 AAA virtual server

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5777 漏洞是由于 NetScaler ADC 和 Gateway 设备中输入验证不足导致的内存越界读取漏洞（CitrixBleed 2）。

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且已经存在公开的利用方法（CitrixBleed 2）。提供的 PoC 代码是一个简单的 shell 脚本，它使用 `curl` 命令向目标 NetScaler 实例发送一个精心构造的 HTTP POST 请求 `/p/u/doAuthentication.do`。 该请求包含特定的 HTTP 头部（Content-Length, Connection, Content-Type, Host）和数据（login），用于触发内存越界读取漏洞。脚本中`curl`的参数`-k`表明忽略证书验证，`-A`指定User-Agent，`-L` 自动跟踪重定向，`-i` 显示响应头。 脚本会将 curl 命令的输出通过管道传递给 `sh` 命令执行，这意味着如果服务器响应中包含可执行的 shell 代码，它将会被执行，存在一定的风险。

**投毒风险分析：**
PoC 代码的主要功能是发送特定的 HTTP 请求。管道到sh操作存在一定风险，如果服务器返回恶意代码会被执行，因此存在极低的投毒风险，可能性估计为5%。LICENSE和README文件主要是法律声明和简要描述，不包含恶意代码。

**利用方式分析：**
1.  **目标配置：** 漏洞利用需要目标 NetScaler 实例配置为 Gateway（VPN virtual server、ICA Proxy、CVPN、RDP Proxy）或 AAA virtual server。
2.  **构造恶意请求：** 攻击者发送特制的 HTTP 请求到 `/p/u/doAuthentication.do` 路径，该请求旨在触发输入验证不足，导致内存越界读取。
3.  **信息泄露：** 成功利用漏洞会导致服务器内存中的敏感信息泄露。这些信息可能包括会话令牌、用户名、密码、其他用户的会话信息，以及其他敏感数据。
4.  **会话劫持/身份验证绕过：** 通过泄露的会话信息，攻击者可以劫持现有用户会话或绕过身份验证，从而获得对受保护资源的未授权访问。

**项目地址:** [ndr-repo/CVE-2025-5777](https://github.com/ndr-repo/CVE-2025-5777)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)