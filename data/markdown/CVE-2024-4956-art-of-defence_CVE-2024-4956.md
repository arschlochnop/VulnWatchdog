## CVE-2024-4956-Nexus Repository Manager 3-路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Nexus Repository Manager 3

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问目标Nexus Repository Manager实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4956 存在于 Sonatype Nexus Repository Manager 3 中，是一个未经验证的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 URL 访问服务器上的任意文件。根据搜索引擎结果，该漏洞允许攻击者下载敏感的系统文件、应用程序源代码和配置信息。漏洞利用代码 `CVE-2024-4956_detect.py` 通过发送包含路径遍历payload的HTTP GET请求来验证目标是否易受攻击。该脚本检查响应中是否包含 'root' 字符串，以此判断是否成功读取了 `/etc/passwd` 文件。 

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，且影响范围广泛。提供的 POC 代码可以直接验证该漏洞的存在性，因此有效性较高。

**投毒风险：**

查看提供的 POC 代码 `CVE-2024-4956_detect.py` 和 `README.md`。该脚本仅用于检测漏洞是否存在，没有发现任何恶意代码或后门。`README.md` 只是对脚本的简单描述。因此，该仓库中存在投毒代码的可能性为 0%。

**利用方式：**

1.  攻击者构造包含路径遍历的 URL，例如：`http://<目标IP>:<端口>/%2F%2F%2F%2E%2E%2F%2F%2E%2F%2F%2E%2E%2F%2F%2F%2E%2E%2F%2F%2E%2E%2F%2E%2F%65%74%63%2F%70%61%73%73%77%64`。
2.  Nexus Repository Manager 3 处理请求时，由于未正确验证路径，导致可以访问目标文件系统上的任意文件。
3.  攻击者可以通过修改 URL 中的路径，读取其他敏感文件，例如配置文件、数据库连接信息等。

**项目地址:** [art-of-defence/CVE-2024-4956](https://github.com/art-of-defence/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)