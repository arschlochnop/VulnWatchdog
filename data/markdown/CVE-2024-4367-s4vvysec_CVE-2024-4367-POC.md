## CVE-2024-4367 PDF.js 任意JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** 任意JavaScript执行

**影响应用:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**危害等级:** 高危，可能导致信息泄露，跨站脚本攻击 (XSS)，或在用户上下文中执行恶意代码

**影响版本:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 用户需要打开恶意的PDF文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4367 漏洞存在于 PDF.js 中，由于在处理字体时缺少类型检查，攻击者可以通过构造恶意的 PDF 文件，在 PDF.js 的上下文中执行任意 JavaScript 代码。 

**利用方式：**

1.  攻击者创建一个恶意的 PDF 文件。该 PDF 文件利用了字体处理中缺失的类型检查漏洞，在 FontMatrix 中插入恶意 JavaScript 代码。
2.  当受害者使用受影响的 Firefox, Firefox ESR, 或 Thunderbird 版本打开该 PDF 文件时，嵌入的 JavaScript 代码将在 PDF.js 的上下文中执行。
3.  利用代码 `poc.py` 可以自动化生成包含恶意 JavaScript 代码的 PDF 文件。

**有效性：**

根据漏洞描述和POC代码，此漏洞利用是有效的。POC代码直接生成包含嵌入的 JavaScript 代码的 PDF，并利用漏洞执行。

**投毒风险：**

分析提供的 `poc.py` 和 `malicious.pdf` 文件，没有发现任何明显的投毒代码。`poc.py` 的作用是生成包含指定 JavaScript payload 的 PDF 文件，而 `malicious.pdf` 是一个已经生成好的示例 PDF。 仓库的README.md也描述了如果使用python脚本生成PDF。因此，投毒风险评估为 0%。

**项目地址:** [s4vvysec/CVE-2024-4367-POC](https://github.com/s4vvysec/CVE-2024-4367-POC)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)