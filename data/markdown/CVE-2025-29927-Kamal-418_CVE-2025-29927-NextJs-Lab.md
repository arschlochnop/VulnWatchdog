## CVE-2025-29927-next.js-权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了Next.js中间件进行权限验证，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据CVE-2025-29927漏洞信息和搜索结果，该漏洞是Next.js中间件中存在的权限绕过漏洞。攻击者可以通过特定的请求头（`x-middleware-subrequest`）绕过中间件的身份验证检查，从而访问受保护的资源。

**有效性：**
提供的代码展示了一个使用Next.js中间件进行身份验证的简单示例。`middleware.ts` 文件中的中间件会检查是否存在 `auth_token` cookie。如果访问 `/admin` 路径，且不存在该 cookie，则会被重定向到 `/login`。利用该漏洞可以通过构造包含`x-middleware-subrequest`header的请求来绕过中间件验证，直接访问`/admin`页面,从而成功利用该漏洞。该POC能够复现该漏洞，因此POC有效。

**投毒风险：**
分析提供的代码，并未发现明显的恶意代码或后门。所有文件都与Next.js应用程序的正常结构和功能相符。`Dockerfile` 用于构建 Docker 镜像，`README.md` 提供构建和运行应用程序的说明， `middleware.ts` 包含中间件逻辑，`package.json` 列出项目依赖项， `tsconfig.json` 配置 TypeScript 编译器，`pages/admin.tsx` 是一个简单的管理页面，展示了登出功能。

**利用方式：**
1.  目标应用需要使用 Next.js 中间件进行身份验证，并存在漏洞。
2.  攻击者构造一个包含 `x-middleware-subrequest` 请求头的 HTTP 请求。
3.  将请求发送到目标应用受保护的资源（例如 `/admin` 页面）。
4.  由于中间件验证绕过，攻击者无需身份验证即可访问受保护的资源。

**项目地址:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)