## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未授权的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行 Rejetto HFS 2.3m 且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而在受影响的系统上执行任意命令。根据提供的漏洞利用代码，攻击者通过构造特定的 URL，在URL中嵌入恶意命令，由于程序没有充分过滤模板注入，导致命令在服务器端执行。 

**有效性：**
提供的 POC 代码看起来是有效的。它构造了一个包含恶意命令的 HTTP GET 请求，并使用 `http.client` 库发送请求。代码还包含对响应进行 gzip 解压缩以及检测字符编码的功能，提高了在不同环境下的适应性。代码还实现了重试机制以应对间歇性连接问题。

**投毒风险：**
该漏洞利用代码的投毒风险较低。`LICENSE` 文件表明代码遵循 MIT 许可协议，允许自由使用和修改。`exploit.py` 脚本的主要功能是利用漏洞，没有发现明显的恶意代码。尽管如此，始终建议审查任何第三方代码以确保安全。

**利用方式：**
1.  **漏洞定位：**  该漏洞存在于 Rejetto HTTP File Server 的模板处理功能中。
2.  **攻击向量：**  攻击者通过构造包含恶意代码的 HTTP 请求，特别是 URL 中的参数，来触发模板注入。
3.  **命令执行：**  恶意代码被服务器解析并执行，导致远程命令执行。
4.  **响应处理：**  攻击者通过检查服务器的响应来判断漏洞是否利用成功，并获取命令执行的结果。

**项目地址:** [vanboomqi/CVE-2024-23692](https://github.com/vanboomqi/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)