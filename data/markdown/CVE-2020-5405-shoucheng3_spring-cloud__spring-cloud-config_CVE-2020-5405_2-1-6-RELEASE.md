## CVE-2020-5405-Spring Cloud Config-目录遍历

**漏洞编号:** CVE-2020-5405

**漏洞类型:** 目录遍历

**影响应用:** Spring Cloud Config

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 2.2.2 (2.2.x), < 2.1.7 (2.1.x)

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-5405是一个Spring Cloud Config服务器的目录遍历漏洞。攻击者可以构造包含目录遍历字符的恶意URL来访问服务器上的任意文件。根据漏洞库信息，该漏洞影响2.2.x版本低于2.2.2和2.1.x版本低于2.1.7的Spring Cloud Config。搜索引擎结果显示该漏洞允许攻击者通过特制的URL发起目录遍历攻击。提供的漏洞利用代码主要包含一个Guardfile和一个LICENSE.txt文件。Guardfile 使用 asciidoctor 读取文档，可能存在外部资源读取,该行为具备一定的风险,存在小概率恶意代码注入的可能性,因此评定投毒风险为10%。LICENSE.txt 文件是 Apache 2.0 许可协议，不包含恶意代码。 利用方式是构造包含 '..' 的URL访问受限文件。

**利用方式：**

1.  **构造恶意URL:** 攻击者构造包含诸如 `../../../../etc/passwd` 的URL，发送到存在漏洞的Spring Cloud Config服务器。
2.  **目录遍历:**  服务器在处理这个URL时，由于没有充分的输入验证，允许目录遍历发生。
3.  **文件访问:** 攻击者能够读取服务器上的任意文件，例如配置文件、密钥等，从而获取敏感信息。

**项目地址:** [shoucheng3/spring-cloud__spring-cloud-config_CVE-2020-5405_2-1-6-RELEASE](https://github.com/shoucheng3/spring-cloud__spring-cloud-config_CVE-2020-5405_2-1-6-RELEASE)

**漏洞详情:** [CVE-2020-5405](https://nvd.nist.gov/vuln/detail/CVE-2020-5405)