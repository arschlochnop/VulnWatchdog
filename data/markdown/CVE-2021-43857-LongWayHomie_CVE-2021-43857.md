## CVE-2021-43857-Gerapy-远程代码执行

**漏洞编号:** CVE-2021-43857

**漏洞类型:** 远程代码执行

**影响应用:** Gerapy

**危害等级:** 严重，未经授权的攻击者可以执行任意系统命令。

**影响版本:** < 0.9.8

**利用条件:** 需要目标Gerapy实例版本低于0.9.8，并且攻击者需要知道或能够猜解默认的用户名和密码（admin/admin）。如果修改过默认密码，则需要知道修改后的密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43857 是 Gerapy 0.9.8 之前版本中的一个远程代码执行漏洞。根据漏洞描述，攻击者可以通过构造特定的请求，利用项目设置中的 spider 机制来执行任意系统命令。提供的 POC 代码首先尝试使用默认凭据（admin/admin）登录到 Gerapy 应用程序。登录成功后，它会获取项目列表，然后利用找到的第一个项目的 ID 来构造一个 URL，向该 URL 发送包含反向 shell payload 的恶意 spider 定义，从而实现远程代码执行。由于该POC代码目的是利用漏洞验证,并且没有发现恶意篡改行为,因此投毒风险为0。

**利用方式：**
1.  使用默认或已知的用户名和密码登录 Gerapy。
2.  获取现有项目的列表。
3.  获取项目中 spider 构建的 ID。
4.  构造包含反向 shell 命令的 payload。
5.  发送包含 payload 的请求，触发远程代码执行。

从搜索结果来看，该漏洞被广泛报道，并且存在公开可用的 Exploit-DB 漏洞利用代码。这进一步证实了该漏洞的有效性。

**项目地址:** [LongWayHomie/CVE-2021-43857](https://github.com/LongWayHomie/CVE-2021-43857)

**漏洞详情:** [CVE-2021-43857](https://nvd.nist.gov/vuln/detail/CVE-2021-43857)