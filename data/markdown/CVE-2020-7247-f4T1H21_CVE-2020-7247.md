## CVE-2020-7247 OpenSMTPD 远程命令执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程命令执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标服务器运行受影响版本的OpenSMTPD，并且使用默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 `smtp_session.c` 文件中的 `smtp_mailaddr` 函数中。由于对输入验证的错误处理，远程攻击者可以通过构造包含 shell 元字符的 `MAIL FROM` 字段的 SMTP 会话来执行任意命令。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。 因此,提供的漏洞利用代码有效。

**投毒风险：** 提供的漏洞利用代码只包含 GNU GPL v3 许可协议的内容，没有发现恶意代码或后门，因此可以判断不存在投毒风险。投毒风险为0%。

**利用方式：**

1.  攻击者与目标 OpenSMTPD 服务器建立 SMTP 连接。
2.  攻击者在 `MAIL FROM` 命令中插入包含 shell 元字符的恶意命令。例如：`MAIL FROM:<;touch /tmp/vuln;>`。
3.  OpenSMTPD 在处理 `MAIL FROM` 地址时，由于输入验证不当，会将恶意命令传递给 shell 执行，从而导致远程命令执行。
4. 攻击者可以利用此漏洞以 root 权限在目标服务器上执行任意命令。

**项目地址:** [f4T1H21/CVE-2020-7247](https://github.com/f4T1H21/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)