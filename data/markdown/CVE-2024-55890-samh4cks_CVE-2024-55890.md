## CVE-2024-55890-D-Tale-远程代码执行

**漏洞编号:** CVE-2024-55890

**漏洞类型:** 远程代码执行

**影响应用:** D-Tale

**危害等级:** 高危，允许攻击者在服务器上执行任意代码

**影响版本:** < 3.16.1

**利用条件:** D-Tale实例需要公开暴露，且未进行授权限制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-55890是D-Tale（一个用于pandas数据结构的visualizer）中存在的一个远程代码执行漏洞。漏洞存在于3.16.1之前的版本。通过构造恶意的custom filter input，攻击者可以在服务器上执行任意代码。

**利用方式：**

1.  **上传CSV文件：** 首先，攻击者上传一个CSV文件到D-Tale服务器，这会生成一个data_id。
2.  **更新设置：** 接着，攻击者通过`/dtale/update-settings/{data_id}`接口将`enable_custom_filters`设置为true。在修复的版本中，这个操作应该被阻止。
3.  **构造Payload：** 然后，攻击者构造一个包含恶意代码的payload。POC中使用`@pd.core.frame.com.builtins.__import__('os').system('{cmd}')` 的形式，允许执行任意命令。`cmd`变量在POC中被设置为反弹shell。
4.  **触发漏洞：** 最后，攻击者通过访问`/dtale/test-filter/{data_id}?query={encoded_payload}&save=true`接口触发漏洞。D-Tale会执行payload中包含的恶意代码。

**有效性：**
根据漏洞信息和POC代码，该漏洞利用方法应该是有效的。POC代码已经实现了漏洞的利用过程，如果D-Tale版本低于3.16.1且`enable_custom_filters`未被禁用，则可以成功执行任意代码。

**投毒风险：**
查看提供的POC代码，未发现作者隐藏的投毒代码。该代码的目的是利用漏洞执行指定的命令，例如反弹shell。代码逻辑较为清晰，没有发现任何试图破坏系统或植入恶意软件的迹象。
可以明确的说，POC的作者目的不在于投毒，而是展示漏洞的利用方式, 因此可以认为投毒风险为0%。

**项目地址:** [samh4cks/CVE-2024-55890](https://github.com/samh4cks/CVE-2024-55890)

**漏洞详情:** [CVE-2024-55890](https://nvd.nist.gov/vuln/detail/CVE-2024-55890)