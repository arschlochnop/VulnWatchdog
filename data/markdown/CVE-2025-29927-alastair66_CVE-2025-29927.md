## CVE-2025-29927-Next.js中间件认证绕过漏洞

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用了 Next.js 中间件进行认证，且未对 `x-middleware-subrequest` 请求头进行正确校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 框架中间件中存在的一个认证绕过漏洞。攻击者可以通过操纵 `x-middleware-subrequest` 请求头来绕过中间件的认证检查，从而访问受保护的资源。该漏洞影响 Next.js 的多个版本，包括 11.1.4 到 13.5.6，14.0.0 到 14.2.25，以及 15.0.0 到 15.2.3。根据搜索结果，漏洞源于 Next.js 处理 `x-middleware-subrequest` 请求头的方式存在缺陷。该头部原本用于防止无限重定向，但可以被滥用以绕过认证。 

**有效性：**
POC代码的有效性需要进一步验证。提供的代码只是一个包含漏洞ID和描述信息的 `README.md` 文件，并没有包含任何实际的攻击代码。 但是根据搜索结果，此漏洞是可利用的。

**投毒风险：**
`README.md` 文件本身不包含任何可执行代码，因此直接投毒的风险较低，评估投毒风险为10%。但是，如果攻击者篡改了包含 `README.md` 文件的整个项目仓库，并在其中添加恶意代码，则存在投毒的可能。因此，使用该仓库需要谨慎。

**利用方式：**
根据漏洞信息和搜索结果，利用方式如下：
1.  攻击者构造包含 `x-middleware-subrequest` 请求头的 HTTP 请求。
2.  由于 Next.js 中间件对该请求头的处理存在缺陷，导致认证检查被绕过。
3.  攻击者成功访问受保护的资源，执行未授权操作。

**缓解措施：**
1.  升级 Next.js 到安全版本 (>= 14.2.25 或 >= 15.2.3)。
2.  如果无法升级，则需要对所有包含 `x-middleware-subrequest` 请求头的外部用户请求进行过滤，确保其无法到达 Next.js 应用。

**项目地址:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)