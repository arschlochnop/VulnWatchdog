## CVE-2024-45519-Zimbra-远程命令执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程命令执行

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标Zimbra服务器的25端口开放且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519是一个存在于Zimbra Collaboration Suite (ZCS) postjournal服务中的远程命令执行漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的Zimbra服务器上执行任意系统命令。

**有效性分析：**

根据提供的漏洞信息和搜索引擎结果，此漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。POC代码尝试利用SMTP协议的RCPT TO字段中的命令注入漏洞来执行任意命令。POC首先检查目标端口是否开放，然后使用OAST（带外应用安全测试）服务验证漏洞是否存在，最后尝试利用反向shell有效负载进行漏洞利用。

**投毒风险分析：**

审查提供的Python脚本，没有发现明显的投毒代码。该脚本的主要目的是验证和利用CVE-2024-45519漏洞。所有操作都与描述的漏洞利用过程一致，如端口检查、SMTP命令发送、payload注入和reverse shell连接等。脚本没有包含任何隐藏的、非预期的恶意行为，比如数据窃取、恶意文件上传或未经授权的系统修改。脚本依赖用户提供的OAST和reverse shell地址，如果这些地址被恶意控制，可能导致用户受到攻击，但这不属于脚本本身的投毒。

**利用方式：**

1.  **端口扫描：** 使用`is_port_open`函数检查目标Zimbra服务器的25端口（SMTP）是否开放。
2.  **漏洞验证：** 使用`smtp_payload_check_vulnerability`函数，通过构造包含`curl`命令的RCPT TO字段，向目标服务器发送SMTP命令。`curl`命令会尝试访问用户指定的OAST URL，如果OAST服务器收到请求，则表明存在命令注入漏洞。
3.  **漏洞利用：** 使用`smtp_payload_exploit_reverse_shell`函数，构造包含反向shell命令的RCPT TO字段，向目标服务器发送SMTP命令。反向shell命令会在目标服务器上执行，并尝试连接到攻击者指定的IP地址和端口，从而建立一个反向shell连接。
4.  **命令执行：** 成功建立反向shell连接后，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [XiaomingX/cve-2024-45519-poc](https://github.com/XiaomingX/cve-2024-45519-poc)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)