## CVE-2017-11317-Telerik UI for ASP.NET AJAX-任意文件上传/远程代码执行

**漏洞编号:** CVE-2017-11317

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** R1 2017 之前版本，R2 2017 SP2 之前 R2 版本

**利用条件:** 需要能够访问存在漏洞的ASP.NET应用，并且该应用使用了存在漏洞版本的Telerik UI控件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11317漏洞存在于Progress Telerik UI for ASP.NET AJAX中，由于RadAsyncUpload控件使用了弱加密算法，导致攻击者可以构造恶意请求绕过上传限制，上传任意文件。结合不安全的反序列化漏洞，攻击者可以进一步执行任意代码。漏洞利用方式如下：

1.  **漏洞描述：** Telerik.Web.UI 组件使用弱加密密钥对 RadAsyncUpload 使用的数据进行加密。
2.  **攻击过程：**
    *   攻击者首先需要找到使用了存在漏洞版本的Telerik UI控件的ASP.NET应用。
    *   然后，攻击者利用已知的弱加密算法，构造包含恶意代码的上传文件，并对其进行加密。
    *   最后，攻击者将加密后的数据通过 RadAsyncUpload 控件上传到服务器。
    *   服务器端接收到上传的文件后，使用相同的弱加密算法进行解密，并将恶意代码写入到服务器。

3.  **投毒风险评估：**  提供的POC代码主要功能是密钥爆破，用于解密RadAsyncUpload上传的文件。该代码本身旨在利用漏洞，但如果攻击者篡改代码，例如在成功上传后门文件后自动执行某些恶意操作，则存在一定的投毒风险。该代码的mass.py 只是一个key的爆破脚本,并未发现存在恶意代码. 但是上传payload的操作依赖于其他的脚本或者手动操作, 这里存在风险.因此投毒风险评定为10%。

4.  **参考信息：** 漏洞信息源于NVD、CISA等权威机构，并有公开的漏洞利用代码可供参考，证明该漏洞的有效性。

**总结：** 该漏洞是一个高危漏洞，利用简单，影响广泛。建议受影响的用户尽快升级Telerik UI控件到最新版本。

**项目地址:** [0xr2r/CVE-2017-11317-auto-exploit-](https://github.com/0xr2r/CVE-2017-11317-auto-exploit-)

**漏洞详情:** [CVE-2017-11317](https://nvd.nist.gov/vuln/detail/CVE-2017-11317)