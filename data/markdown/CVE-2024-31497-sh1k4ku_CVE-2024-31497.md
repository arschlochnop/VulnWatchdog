## CVE-2024-31497-PuTTY-ECDSA私钥泄露

**漏洞编号:** CVE-2024-31497

**漏洞类型:** ECDSA私钥泄露

**影响应用:** PuTTY

**危害等级:** 高危，可能导致身份伪造和供应链攻击

**影响版本:** 0.68 <= version < 0.81

**利用条件:** 需要获取受影响 PuTTY 版本生成的至少 60 个 NIST P-521 ECDSA 签名。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31497 漏洞存在于 PuTTY 0.68 到 0.80 版本，以及其他相关软件（FileZilla, WinSCP, TortoiseGit, TortoiseSVN）。 该漏洞是由于有偏的 ECDSA nonce 生成导致，攻击者可以通过大约 60 个签名恢复用户的 NIST P-521 私钥。  

**漏洞利用方式:**

1.  **收集签名:** 攻击者需要收集受影响的 PuTTY 版本生成的 ECDSA 签名。这些签名可能从公开的 Git 仓库（如果使用 SSH 进行提交签名）或恶意 SSH 服务器获取。
2.  **私钥恢复:** 使用收集到的签名，攻击者可以利用数学方法（例如，格基规约算法）恢复用户的私钥。  已知的POC代码（如github.com/daedalus/BreakingECDSAwithLLL） 可以用于利用此漏洞。  
3.  **利用私钥:** 恢复私钥后，攻击者可以进行身份伪造，访问受害者账户，甚至发起供应链攻击（如果受害者使用该密钥进行代码签名）。

**POC有效性:**

提供的 POC 代码 `/tmp/a0edd92b931da468750e54b908748263/README.md` 只是一个描述文件，本身不包含任何可执行的漏洞利用代码。 因此，提供的 POC 代码本身无效。 但是，CVE 信息中提到了 github.com/daedalus/BreakingECDSAwithLLL，这提供了一个可行的漏洞利用途径。

**投毒风险:**

鉴于提供的POC只是一个描述文件，且仓库名称和描述暗示其目的是展示漏洞利用，投毒风险较低。 然而，任何从网络上下载的代码都存在潜在风险，因此，使用任何漏洞利用代码之前都应该进行仔细审查。 考虑到 README 文件是描述文件，其中包含恶意代码的可能性较低，因此判断投毒风险为 10%。 此百分比是基于假设，如果包含其他的文件则投毒风险会增加。

**缓解措施:**

*   升级到 PuTTY 0.81 或更高版本。
*   对于其他受影响的软件，升级到相应的修复版本（例如，FileZilla 3.67.0，WinSCP 6.3.3，TortoiseGit 2.15.0.1）。
*   重新生成新的 SSH 密钥对。
*   避免在不受信任的 SSH 服务器上使用 SSH agent forwarding。

**项目地址:** [sh1k4ku/CVE-2024-31497](https://github.com/sh1k4ku/CVE-2024-31497)

**漏洞详情:** [CVE-2024-31497](https://nvd.nist.gov/vuln/detail/CVE-2024-31497)