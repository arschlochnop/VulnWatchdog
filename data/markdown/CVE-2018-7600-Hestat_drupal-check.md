## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)