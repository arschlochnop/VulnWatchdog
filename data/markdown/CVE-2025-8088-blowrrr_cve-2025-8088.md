## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意构造的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是WinRAR中存在的一个路径遍历漏洞，攻击者可以构造恶意的RAR压缩包，当用户解压时，恶意文件会被释放到任意目录，例如Windows启动目录，从而实现任意代码执行。

**有效性：**
根据漏洞库信息，该漏洞已经被野外利用。提供的POC代码包含生成恶意RAR压缩包的Python脚本，该脚本利用路径遍历将恶意payload写入Windows启动目录，实现持久化。代码功能完整，包括生成诱饵文件、嵌入Payload、修改RAR结构、计算CRC校验等步骤。因此，提供的POC代码是有效的。

**投毒风险：**
代码中存在一些可疑之处，可能存在一定程度的投毒风险：
*   `CVE-2025-8088.py`中存在访问URL地址的代码段，虽然代码中对访问地址进行了简单的加密处理，但是这些被加密的地址可能会指向恶意网站或者包含恶意payload。
*   `extract.py`中存在网络通信相关的代码段，可能被用于回传数据，或者从远程服务器下载Payload。
考虑到脚本目的是生成漏洞利用的RAR包，以及部分代码的混淆和网络请求行为，推测存在投毒的概率为10%，主要体现在可能会从外部地址请求和下载额外的恶意代码。

**利用方式：**
1.  **配置：** 修改`config.py`文件，配置诱饵文件名(`DECOY_FILE_NAME`)、payload落地路径(`DROP_PATH`)和实际执行的payload(`PAYLOAD`)。
2.  **生成恶意RAR文件：** 运行`CVE-2025-8088.py`脚本，该脚本会生成一个恶意RAR压缩包，其中包含伪装的诱饵文件和利用路径遍历写入启动目录的恶意payload。
3.  **诱骗用户解压：** 将生成的恶意RAR文件发送给目标用户，诱骗其使用WinRAR解压。
4.  **执行Payload：** 当用户解压恶意RAR文件时，恶意payload会被释放到`DROP_PATH`指定的目录，例如Windows启动目录，从而在系统启动时执行任意代码。
5.  **持久化：**通过写入启动目录实现恶意代码的持久化运行。

**项目地址:** [blowrrr/cve-2025-8088](https://github.com/blowrrr/cve-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)