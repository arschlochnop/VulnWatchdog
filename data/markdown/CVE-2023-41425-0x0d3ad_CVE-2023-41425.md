## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击 (XSS) 导致远程代码执行 (RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可导致任意代码执行和服务器控制

**影响版本:** 3.2.0 <= version <= 3.4.2

**利用条件:** 目标WonderCMS存在漏洞版本，攻击者可访问目标URL，且目标服务器可访问攻击者控制的HTTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WonderCMS的installModule组件中。攻击者可以通过上传包含恶意JavaScript代码的zip文件（模块）到服务器，利用XSS漏洞执行任意代码。具体利用方式如下：

1.  **漏洞原理：** WonderCMS允许通过`installModule`参数安装主题或者模块。该过程存在XSS漏洞，攻击者可以构造恶意的URL，通过管理员访问，从而触发XSS。
2.  **利用步骤：**
    *   攻击者首先运行`exploit.py`脚本，该脚本会启动一个简单的HTTP服务器，并生成必要的payload。
    *   脚本会生成一个包含PHP后门的`cuk.php`文件，并将其压缩为`cuk.zip`。
    *   脚本还会生成一个`xss.js`文件，其中包含XSS payload，用于下载并安装`cuk.zip`模块。
    *   脚本生成一个包含XSS Payload的URL。
    *   攻击者诱导管理员访问该URL，管理员访问后，XSS Payload会被执行，从而下载并安装`cuk.zip`。
    *   `cuk.zip`被解压到`themes/cuk/cuk.php`，攻击者可以通过访问`http://{RHOST.split('/')[2]}/themes/cuk/cuk.php?0=id`执行任意命令。
3.  **有效性：** 根据提供的POC代码和漏洞描述，此漏洞利用方式有效。POC代码中包含了完整的利用流程，可以成功实现XSS到RCE的攻击。
4.  **投毒风险：** 经分析，提供的POC代码本身不包含任何隐藏的恶意代码或后门。脚本的功能完全是为了利用该XSS漏洞并执行命令。因此，投毒风险较低。
5.  **利用方式总结：** 攻击者利用WonderCMS的`installModule`参数中的XSS漏洞，上传包含恶意PHP代码的模块，从而在目标服务器上执行任意代码，实现远程代码执行。

**项目地址:** [0x0d3ad/CVE-2023-41425](https://github.com/0x0d3ad/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)