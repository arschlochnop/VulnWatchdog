## CVE-2023-27350-PaperCut NG/MF-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极高，可能导致完全系统控制

**影响版本:** 22.0.5 (Build 63914)

**利用条件:** 目标系统安装了PaperCut NG/MF 22.0.5 (Build 63914)，攻击者需要能够通过网络访问PaperCut服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 存在于 PaperCut NG/MF 软件中，允许未经身份验证的远程攻击者绕过身份验证并执行任意代码。漏洞位于 SetupCompleted 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，该漏洞的POC是可用的，并且已经被积极利用。
提供的Python脚本看起来像是利用了该漏洞，通过访问`/app?service=page/SetupCompleted`路径来绕过身份验证。

**投毒风险：**
查看提供的python代码，代码较为简单，主要用于验证漏洞的存在。代码中引入了requests和BeautifulSoup4库用于发送HTTP请求和解析HTML。该脚本的功能是发送GET请求到目标PaperCut服务器的特定URL，并检查返回的HTML内容是否包含特定的标记，以确定漏洞是否存在。未发现明显的恶意代码。因此，该仓库中存在投毒代码的风险较低，估计在5%左右，主要是考虑到代码可能存在隐藏的缺陷或者依赖项被篡改的风险，但总体上代码逻辑较为清晰。

**利用方式：**
1.  攻击者首先发送特制的HTTP GET请求到目标PaperCut服务器的`/app?service=page/SetupCompleted`端点。
2.  服务器未正确验证身份，允许未经身份验证的访问。
3.  攻击者检查响应的内容以确认漏洞利用是否成功（通过解析HTML查找特定的产品信息）。
4.  成功绕过身份验证后，攻击者可能会利用PaperCut内置的脚本功能来执行任意代码，从而完全控制系统。
5.  参考搜索结果，攻击者可能利用此漏洞安装勒索软件。

**项目地址:** [ThatNotEasy/CVE-2023-27350](https://github.com/ThatNotEasy/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)