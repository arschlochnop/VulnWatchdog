## CVE-2015-1635-HTTP.sys远程代码执行漏洞

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows HTTP.sys

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2

**利用条件:** 目标系统运行受影响版本的Windows，并且HTTP.sys服务对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Microsoft Windows的HTTP.sys驱动中，攻击者可以通过构造特殊的HTTP请求中的Range头，触发整数溢出漏洞，导致拒绝服务或远程代码执行。

**有效性：**
提供的POC代码是一个漏洞检测脚本，通过发送包含恶意Range头的HTTP请求来判断目标服务器是否存在漏洞。如果服务器返回“Requested Range Not Satisfiable”错误，则可能存在漏洞。如果返回“The request has an invalid header name”，则表明已修补。此脚本的有效性在于能够初步判断目标是否受到影响，但并不能直接利用漏洞执行任意代码。

**投毒风险：**
提供的代码仓库主要包含一个漏洞检测脚本（index.php）以及相关的许可证和README文件。该脚本的功能是检测目标服务器是否存在MS15-034漏洞，而非执行恶意操作。没有发现任何作者故意植入的后门或恶意代码，因此投毒风险较低。虽然代码质量可能不高（注释中有提及），但功能明确，仅用于漏洞检测。

**利用方式：**
1.  攻击者构造包含畸形Range头的HTTP请求。畸形的Range头会导致HTTP.sys驱动程序在处理请求时发生整数溢出，进而可能造成拒绝服务（DoS）或远程代码执行（RCE）。
2.  服务器接收到恶意请求后，HTTP.sys处理Range头时触发漏洞。
3.  如果漏洞成功利用，攻击者可以在目标系统上执行任意代码（RCE）。该漏洞的利用方式通常依赖于具体的系统环境和攻击向量，但核心在于构造能够触发整数溢出的畸形Range头。

该检测脚本的主要作用是验证目标系统是否存在漏洞，为后续的攻击利用提供依据。真正的利用需要结合其他技术，例如shellcode注入等。

**项目地址:** [xPaw/HTTPsys](https://github.com/xPaw/HTTPsys)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)