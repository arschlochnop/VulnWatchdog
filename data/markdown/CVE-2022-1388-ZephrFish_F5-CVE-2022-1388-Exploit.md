## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括16.1.x（低于16.1.2.2），15.1.x（低于15.1.5.1），14.1.x（低于14.1.4.6），13.1.x（低于13.1.5），以及所有12.1.x和11.6.x版本。

**利用条件:** 需要网络访问BIG-IP的管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，从而可以执行任意命令。POC代码通过构造特殊的HTTP请求，设置特定的Header (Host: 127.0.0.1, X-F5-Auth-Token: a, Authorization: Basic YWRtaW46)来绕过身份验证，然后通过/mgmt/tm/util/bash接口执行命令。该漏洞的利用方式是向目标URL发送包含待执行命令的POST请求。

根据分析提供的代码，该脚本主要功能是验证漏洞是否存在，并允许执行任意命令。未发现作者隐藏的恶意代码或者后门。 因此投毒风险评估为0%。

利用方式总结：
1.  发送精心构造的HTTP POST请求到/mgmt/tm/util/bash端点。
2.  在HTTP头部中包含绕过身份验证所需的特定header。
3.  在POST请求的body中，使用JSON格式指定要执行的命令。
4.  服务器执行命令并将结果返回。

**项目地址:** [ZephrFish/F5-CVE-2022-1388-Exploit](https://github.com/ZephrFish/F5-CVE-2022-1388-Exploit)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)