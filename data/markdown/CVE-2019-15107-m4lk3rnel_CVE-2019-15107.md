## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要网络访问 Webmin 服务，并且Webmin版本小于等于1.920

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107 是 Webmin 1.920 及更早版本中的一个命令注入漏洞。漏洞存在于 `password_change.cgi` 脚本中，`old` 参数存在命令注入。

**有效性：**

根据漏洞库信息、搜索结果以及提供的 POC 代码，可以判断该漏洞是有效的。漏洞库信息明确指出 `password_change.cgi` 中的 `old` 参数存在命令注入。搜索结果中多个链接指向该漏洞的详细信息和利用方式，甚至有 Metasploit 模块可利用。提供的 POC 代码通过向 `password_change.cgi` 发送包含恶意命令的请求来利用该漏洞。脚本能够成功发送包含命令的 POST 请求并执行，验证了漏洞的存在。

**投毒风险：**

分析提供的 POC 代码，未发现明显的投毒代码。代码的功能是发送带有命令的 POST 请求，并解析返回结果。虽然存在绕过 SSL 证书验证的部分 (`verify=False`)，这在实际利用中很常见，但并非投毒行为。代码本身并不包含任何恶意逻辑，比如安装后门、上传恶意文件等。因此投毒风险评估为0%。

**利用方式：**

1.  **目标确认：** 确认目标 Webmin 版本小于等于 1.920。
2.  **漏洞触发：**
    *   发送包含恶意命令的 POST 请求到 `/password_change.cgi` 页面。
    *   通过 `expired` 参数传递要执行的命令。例如 `expired=;id;`
    *   设置 Cookie: `redirect=1; testing=1; sid=x; sessiontest=1`
    *   设置 Referer: Webmin的URL + `/session_login.cgi`
    *   Content-Type: `application/x-www-form-urlencoded`
3.  **命令执行：** Webmin 服务器执行该命令，并将结果返回。
4.  **结果提取：** 从响应中提取命令执行的结果。POC脚本中，解析响应并输出结果。

**总结：**

此漏洞允许未经身份验证的攻击者在 Webmin 服务器上执行任意命令，风险极高。由于存在公开的 POC 代码和 Metasploit 模块，该漏洞易于被利用。建议受影响的用户尽快升级到安全版本。

**项目地址:** [m4lk3rnel/CVE-2019-15107](https://github.com/m4lk3rnel/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)