## CVE-2023-36802 Microsoft Streaming Service Proxy Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-36802

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service Proxy (MSKSSRV.SYS)

**危害等级:** 高危，本地特权提升

**影响版本:** 受影响的Windows 10, Windows Server, Windows 11版本（详见CVE信息）

**利用条件:** 本地访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36802是Microsoft Streaming Service Proxy的特权提升漏洞。该漏洞位于MSKSSRV.SYS驱动中，允许本地攻击者提升权限。\n\n**有效性：**
提供的POC代码包含Visual Studio解决方案文件和相关的源文件结构，表明它是一个可以编译和运行的POC。参考搜索结果，该漏洞已经被公开披露，并且存在可利用的exp，POC代码大概率有效。\n\n**投毒风险：**
虽然代码仓库主要包含用于重现漏洞利用的必要组件（如Visual Studio解决方案文件），但依旧存在一定的投毒风险。具体分析如下：
*   **LICENSE和README.md：**标准的文件，没有发现可疑内容。
*   **CVE-2023-36802_Win10-11.sln：**Visual Studio解决方案文件，用于组织项目文件。检查其中的项目依赖和构建配置，寻找潜在的恶意链接或指令。
*   **CVE-2023-36802_Win10-11.filters：**Visual Studio过滤器文件，用于组织源文件。检查其中的文件引用，确保没有包含未知的或可疑的文件。
*   **CVE-2023-36802_Win10-11/CVE-2023-36802_Win10-11.vcxproj** 如果存在vcxproj文件和代码文件(这里只展示了部分内容,应该存在缺失)，需要分析代码逻辑，寻找可能被插入的恶意代码，例如：
    *   **后门代码：** 检查是否存在在提权后执行恶意操作的代码，如创建隐藏用户、修改系统文件等。
    *   **远程连接：** 检查是否存在尝试建立网络连接的代码，这可能用于将控制权交给远程攻击者。
    *   **资源消耗：** 检查是否存在过度消耗系统资源的代码，如无限循环、大量内存分配等，可能导致拒绝服务攻击。
    *   **对特定版本的依赖或修改，** 可能导致在其他系统上崩溃或者行为异常。
\n鉴于没有完整的代码文件,目前只能根据现有信息进行静态分析，无法确定是否存在恶意代码，综合判断投毒风险为10%。\n\n**利用方式：**
1.  攻击者需要在目标系统上拥有本地访问权限。
2.  攻击者需要利用该POC编译得到可执行文件。
3.  运行编译后的可执行文件，触发漏洞，提升权限。\n根据搜索结果和漏洞描述，利用方式涉及特定的API调用和内存操作，最终导致特权提升。

**项目地址:** [ISH2YU/CVE-2023-36802](https://github.com/ISH2YU/CVE-2023-36802)

**漏洞详情:** [CVE-2023-36802](https://nvd.nist.gov/vuln/detail/CVE-2023-36802)