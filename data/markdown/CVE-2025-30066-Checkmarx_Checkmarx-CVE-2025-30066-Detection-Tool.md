## CVE-2025-30066-tj-actions/changed-files-敏感信息泄露

**漏洞编号:** CVE-2025-30066

**漏洞类型:** 供应链攻击/敏感信息泄露

**影响应用:** tj-actions/changed-files

**危害等级:** 高危，可能导致凭据泄露，供应链投毒

**影响版本:** < 46

**利用条件:** 需要目标项目使用了受影响版本的tj-actions/changed-files

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-30066 是一个供应链攻击漏洞，存在于 tj-actions/changed-files action 的早期版本（<46）。攻击者通过篡改 action 的 tag，使其指向包含恶意代码的 commit，实现了对使用该 action 的项目的投毒。漏洞利用方式是，恶意代码会将 Github Actions 运行日志中的敏感信息泄露给攻击者。提供的POC代码 `CxGithubActionsScan.py` 并非直接利用 CVE-2025-30066，而是用于扫描 Github 仓库，查找是否使用了包含恶意代码的 `tj-actions/changed-files` action，以及在 workflow 文件中查找可能暴露敏感信息的关键词。POC代码主要通过 Github API 获取仓库内容，然后进行静态分析，判断是否存在风险。搜索结果和漏洞库信息确认了该漏洞的存在以及其危害，多个链接指向了该漏洞的分析和缓解措施。

**有效性：**虽然提供的脚本不能直接利用漏洞，但是该脚本可以通过扫描工作流文件，检查是否使用了受污染的tj-actions/changed-files版本，以及查找敏感信息，从而帮助用户发现和修复受影响的项目。因此，可以认为该POC代码在漏洞发现和风险评估方面是有效的。

**投毒风险：**此处的“投毒”是指攻击者修改了tj-actions/changed-files action，使其包含恶意代码。脚本本身的目的不是投毒，而是检测是否已被投毒。但是，如果攻击者能够控制运行此脚本的环境，他们可能会修改此脚本以包含恶意代码，从而实现进一步的攻击。因此，该脚本本身存在一定的投毒风险，但主要风险来自已经存在的供应链投毒事件。默认search里存在可疑的base64字符串，需要人工review才能确定风险。

**利用方式：**
1.  攻击者篡改 tj-actions/changed-files action 的 tag，使其指向包含恶意代码的 commit。
2.  受害者项目使用被篡改的 action 版本。
3.  恶意代码在 Github Actions 运行过程中执行，例如窃取环境变量、API 密钥等敏感信息，并将信息泄露给攻击者。
4.  （或者，恶意代码可以修改项目代码，提交恶意PR等等，进行更进一步的攻击）

该漏洞的修复方法是升级 tj-actions/changed-files action 到安全版本（>=46），并检查 Github Actions 运行日志，确认没有敏感信息泄露。

**项目地址:** [Checkmarx/Checkmarx-CVE-2025-30066-Detection-Tool](https://github.com/Checkmarx/Checkmarx-CVE-2025-30066-Detection-Tool)

**漏洞详情:** [CVE-2025-30066](https://nvd.nist.gov/vuln/detail/CVE-2025-30066)