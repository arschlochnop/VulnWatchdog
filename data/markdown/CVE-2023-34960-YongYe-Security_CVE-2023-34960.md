## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要网络访问，目标系统运行着存在漏洞的Chamilo版本，并且可以访问到/main/webservices/additional_webservices.php SOAP接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Chamilo的wsConvertPpt组件中。攻击者可以通过构造恶意的SOAP请求，在PPT文件名中注入命令，从而执行任意代码。 

**有效性分析：**
提供的POC代码`CVE-2023-34960.py`看起来有效。它构造了一个带有恶意`file_name`的SOAP请求，发送到`/main/webservices/additional_webservices.php`。代码会打印执行结果，并将存在漏洞的URL保存到`Kill_ALL.txt`。

**投毒风险分析：**
查看了提供的`CVE-2023-34960.py`和`README.md`的内容，没有发现任何明显的投毒代码。EXP的代码逻辑是，发送SOAP请求，获取并打印返回结果，没有发现恶意行为。`README.md`文件主要是使用说明，没有发现可疑代码。

**利用方式：**
1.  **确定目标：** 确定要攻击的Chamilo实例的URL。
2.  **构造SOAP请求：** 使用POC脚本，构造一个SOAP请求，其中`file_name`包含要执行的命令。命令注入发生在PPT文件名，payload的格式为``{{}}`.pptx'|" |{command}||a #`，其中`{command}`是要执行的命令。
3.  **发送请求：** 将SOAP请求发送到`/main/webservices/additional_webservices.php`。
4.  **执行命令：** 服务器执行注入的命令。
5.  **获取结果：**  从SOAP响应中提取命令执行结果。

**总结：**
该漏洞利用过程相对简单，利用POC发送构造好的SOAP数据包即可完成利用。

**项目地址:** [YongYe-Security/CVE-2023-34960](https://github.com/YongYe-Security/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)