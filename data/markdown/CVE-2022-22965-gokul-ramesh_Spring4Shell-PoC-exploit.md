## CVE-2022-22965 Spring4Shell 远程代码执行漏洞

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Spring Framework versions 5.3.0 to 5.3.17, 5.2.0 to 5.2.19 and older versions

**利用条件:** 需要运行在JDK 9+，并且部署为WAR包在Tomcat上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22965（Spring4Shell）是一个Spring Framework的远程代码执行漏洞。攻击者可以通过精心构造的请求，利用数据绑定功能操纵ClassLoader，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。漏洞已被公开利用，并有可用的POC。

**投毒风险：**
查看提供的exploit.py代码，代码结构非常简单，主要是一个命令行参数解析器，但run和check函数均未实现，是未完成的POC。直接分析没有发现明显的投毒行为，但是由于代码不完整，未来存在被修改并添加恶意代码的可能性。考虑到仓库本身是PoC性质，以及代码的未完成状态，投毒风险评估为10%。该仓库还引用了其他仓库，需要注意。

**利用方式：**
1.  **目标环境：** 应用程序必须运行在JDK 9+上，并且部署为传统的WAR包在Tomcat服务器中。
2.  **漏洞原理：** 该漏洞源于Spring Framework的数据绑定功能。当使用`RequestMapping`注解和POJO参数时，攻击者可以通过修改`class.module.classLoader`等属性，进而控制Tomcat的日志目录，写入webshell或其他恶意代码。
3.  **攻击步骤（基于已知利用方式）：**
    *   发送包含恶意参数的HTTP请求，例如，修改`class.module.classLoader.resources.context.parent.pipeline.first.pattern`属性，将Tomcat的access log配置为webshell。
    *   访问webshell，执行任意代码。

**项目地址:** [gokul-ramesh/Spring4Shell-PoC-exploit](https://github.com/gokul-ramesh/Spring4Shell-PoC-exploit)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)