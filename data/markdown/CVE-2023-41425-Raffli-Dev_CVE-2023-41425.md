## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** XSS to RCE

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.0 <= 3.4.2

**利用条件:** 需要管理员用户点击恶意链接，以及攻击者可以访问目标 CMS 的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425是WonderCMS 3.2.0到3.4.2版本中的一个跨站脚本攻击（XSS）漏洞，该漏洞允许远程攻击者通过上传精心设计的脚本来执行任意代码。利用方式如下：

1.  **XSS注入：**攻击者构造一个包含恶意JavaScript代码的URL。根据提供的利用代码，恶意JavaScript的目的是安装一个新的主题。
2.  **诱骗管理员点击：** 攻击者诱骗WonderCMS的管理员用户访问此恶意URL。这通常通过社会工程学或其他攻击手段实现。
3.  **安装恶意主题：** 恶意JavaScript代码利用WonderCMS的模块安装功能，从攻击者控制的服务器下载并安装一个恶意主题。利用代码中提供了两种方式，一种是直接执行代码，另一种是修改cookie。
4.  **远程代码执行（RCE）：** 恶意主题包含一个PHP文件（例如`evil.php`或`rev.php`），该文件允许攻击者执行任意PHP代码。攻击者可以通过访问该PHP文件并传递参数来执行系统命令。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此漏洞利用方法是有效的。多个来源确认了该漏洞的存在，并且提供了可行的POC代码。POC利用了管理员身份安装主题的功能，并注入恶意代码。

**投毒风险：**
根据提供的漏洞利用代码，存在一定的投毒风险，但概率较低。`exploit.py`脚本本身比较简单，主要是生成payload和启动http server，并没有明显的恶意代码。但是，从github下载压缩包存在风险，`revshell`压缩包也可能存在隐藏的webshell，所以`revshell`代码本身可能存在其他投毒代码，需要人工review代码进行分析。

**漏洞利用方式：**

1.  攻击者准备一个包含恶意PHP代码的zip文件（evil.zip 或 github压缩包）。
2.  攻击者启动一个HTTP服务器来托管该zip文件和xss.js文件，以及可选的 revshell 代码。
3.  攻击者构造一个包含XSS payload的URL，该payload指向攻击者托管的xss.js文件。该文件利用`installModule`参数安装恶意主题，从而写入webshell。
4.  攻击者诱骗管理员访问构造的恶意URL。
5.  管理员访问该URL后，恶意JavaScript代码被执行，WonderCMS从攻击者的服务器下载并安装恶意主题。
6.  攻击者通过访问恶意主题中的PHP文件来执行任意代码或窃取 Cookies。

**项目地址:** [Raffli-Dev/CVE-2023-41425](https://github.com/Raffli-Dev/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)