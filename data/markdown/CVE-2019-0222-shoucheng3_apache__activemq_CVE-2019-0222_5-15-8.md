## CVE-2019-0222-Apache ActiveMQ-MQTT OOM DoS

**漏洞编号:** CVE-2019-0222

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致ActiveMQ Broker服务不可用

**影响版本:** 5.0.0 - 5.15.8

**利用条件:** 需要能够向ActiveMQ Broker发送MQTT消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0222 漏洞存在于 Apache ActiveMQ 5.0.0 到 5.15.8 版本中。该漏洞是由于 ActiveMQ 在反序列化 MQTT 帧时，未正确处理畸形的 MQTT 帧，导致 Broker 发生 OutOfMemoryException，进而导致服务不可用，形成拒绝服务攻击。 

**有效性评估：**

根据漏洞描述和搜索结果，利用畸形的MQTT帧导致OOM，从而使服务不可用，利用思路简单明确，因此漏洞的有效性较高。

**投毒风险评估：**

提供的“漏洞利用代码” 实际上是 PGP 公钥块，用于验证 ActiveMQ 组件的签名，并非直接利用漏洞的 Payload。因此，直接的投毒风险较低。但其中可能存在细微的风险，例如，如果攻击者能够控制这些公钥的来源，并替换成恶意公钥，那么可能会导致用户信任被篡改过的恶意组件。因此投毒风险评估为10%。

**利用方式：**

1.  **攻击者构造畸形的 MQTT 帧。** 帧的结构或者某些字段的值会触发 ActiveMQ Broker 在反序列化过程中出现 OOM。
2.  **攻击者将构造的 MQTT 帧发送到 ActiveMQ Broker。**
3.  **ActiveMQ Broker 尝试反序列化该帧，由于帧的畸形结构，导致 OOM 异常。
4.  **ActiveMQ Broker 由于 OOM 异常而变得无响应，导致拒绝服务。**

总而言之，攻击的本质在于发送恶意构造的MQTT包，导致ActiveMQ服务崩溃。


**项目地址:** [shoucheng3/apache__activemq_CVE-2019-0222_5-15-8](https://github.com/shoucheng3/apache__activemq_CVE-2019-0222_5-15-8)

**漏洞详情:** [CVE-2019-0222](https://nvd.nist.gov/vuln/detail/CVE-2019-0222)