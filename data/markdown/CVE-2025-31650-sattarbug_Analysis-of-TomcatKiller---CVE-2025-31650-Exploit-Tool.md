## CVE-2025-31650-ApacheTomcat-DoS

**漏洞编号:** CVE-2025-31650

**漏洞类型:** DoS

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务拒绝

**影响版本:** 9.0.76 <= version <= 9.0.102, 10.1.10 <= version <= 10.1.39, 11.0.0-M2 <= version <= 11.0.5

**利用条件:** 需要目标服务器开启HTTP/2协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31650是Apache Tomcat中的一个不当输入验证漏洞。由于对某些无效的HTTP优先级标头处理不当，导致未能完全清理失败的请求，从而造成内存泄漏。大量此类请求可能会触发OutOfMemoryException，从而导致拒绝服务(DoS)。

**有效性：**
POC代码通过发送包含无效HTTP/2优先级标头的请求来测试目标服务器是否存在漏洞。代码会检查服务器是否支持HTTP/2，如果支持，则发送特制的恶意请求。如果服务器在处理这些请求时出现问题，则可能受到攻击。

**投毒风险：**
该POC代码主要功能是检测漏洞，但也存在一定的风险：
*   **依赖安装风险：**  脚本会自动安装`httpx[http2]`，如果安装源被篡改，可能引入恶意依赖，存在一定的投毒风险。
*   **资源消耗：** 该脚本通过高并发发包进行验证，可能存在被滥用进行DDOS的风险。
综合评估，投毒风险较低，但存在上述隐患，因此评估投毒风险为10%。

**利用方式：**
1.  **目标发现：** 使用Shodan API搜索暴露在外的Apache Tomcat服务器。
2.  **HTTP/2支持检测：**  检查目标服务器是否启用了HTTP/2协议。
3.  **漏洞触发：**  如果目标支持HTTP/2，则发送一系列包含无效HTTP优先级标头的HTTP/2请求。恶意请求利用`invalid_priorities`中定义的错误header。
4.  **拒绝服务：**  由于Tomcat服务器无法正确处理这些无效标头，导致内存泄漏，最终耗尽服务器资源，造成拒绝服务。

**项目地址:** [sattarbug/Analysis-of-TomcatKiller---CVE-2025-31650-Exploit-Tool](https://github.com/sattarbug/Analysis-of-TomcatKiller---CVE-2025-31650-Exploit-Tool)

**漏洞详情:** [CVE-2025-31650](https://nvd.nist.gov/vuln/detail/CVE-2025-31650)