## CVE-2025-48385-Git bundle-uri 参数注入导致任意文件写入

**漏洞编号:** CVE-2025-48385

**漏洞类型:** 参数注入/任意文件写入

**影响应用:** Git

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互（用户执行克隆操作），且bundle.heuristic配置允许使用bundle URIs。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48385 漏洞允许攻击者通过 `bundle-uri` 参数注入，导致 Git 客户端写入恶意 bundle 文件到攻击者控制的路径。 

**有效性:**

根据漏洞描述和提供的 PoC 代码，该漏洞利用方式是有效的。PoC 通过构造一个包含恶意 `bundle-uri` 的 `bundle.list` 文件，诱导 Git 客户端从攻击者指定的 URL 下载恶意 bundle 文件，从而实现任意文件写入。

**投毒风险:**

PoC代码本身 `bundle.list` 文件只是指定了一个 bundle 文件的下载地址，并没有包含任何可执行代码或恶意脚本。它依赖于下载的 bundle 文件来执行攻击。 如果下载的 bundle 文件被篡改，则可能存在潜在的投毒风险。但是根据提供的代码片段，`bundle.list` 的 `uri` 指向的是 Github 的 `raw.githubusercontent.com`，这个地址可以被验证为真实的仓库文件地址，增加了一些可信度，但是仍然不能完全排除被劫持和替换的风险。因此，本仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式:**

1.  攻击者创建一个包含恶意 `bundle-uri` 的 `bundle.list` 文件。这个文件会被放在一个攻击者可控的 web 服务器上。
2.  攻击者诱导受害者执行 `git clone --bundle <url_to_bundle_list> <target_directory>` 命令，其中 `<url_to_bundle_list>` 指向攻击者服务器上的 `bundle.list` 文件， `<target_directory>` 是受害者本地的目录。
3.  Git 客户端解析 `bundle.list` 文件，并从 `bundle-uri` 指定的 URL 下载恶意 bundle 文件。
4.  由于缺乏足够的验证，Git 客户端将恶意 bundle 文件写入到攻击者指定的位置，从而实现任意文件写入，最终可能导致任意代码执行。

该漏洞需要用户交互（执行克隆命令），并且 bundle URIs 功能需要被启用（`bundle.heuristic` 配置）。

**项目地址:** [Mitchellzhou1/CVE-2025-48385-PoC](https://github.com/Mitchellzhou1/CVE-2025-48385-PoC)

**漏洞详情:** [CVE-2025-48385](https://nvd.nist.gov/vuln/detail/CVE-2025-48385)