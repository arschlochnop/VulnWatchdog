## CVE-2024-12084-Rsync-堆缓冲区溢出

**漏洞编号:** CVE-2024-12084

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Rsync

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 3.2.7, 3.3.0

**利用条件:** 需要网络访问Rsync服务，匿名读取权限或已知用户名密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-12084是Rsync守护进程中的一个基于堆的缓冲区溢出漏洞。由于不正确处理攻击者可控的校验和长度 (s2length)，当 MAX_DIGEST_LEN 超过固定的 SUM_LENGTH (16 字节) 时，攻击者可以在 sum2 缓冲区中进行越界写入。

**有效性：**
根据漏洞库信息和GitHub漏洞库信息,可知此漏洞POC可用。提供的Python脚本并没有直接利用堆缓冲区溢出漏洞，而是尝试利用rsync的配置错误（如匿名访问）进行文件上传，如果目标rsync服务器配置不当存在可以上传文件的模块，脚本能够上传文件。

**投毒风险：**
该脚本的主要功能是枚举rsync模块并测试写入权限。脚本没有明显的恶意代码，例如反向shell、downloader等。风险较低，但仍存在潜在风险，脚本可能被修改后用于恶意目的，例如上传包含恶意代码的文件，考虑到作者未经验证，因此投毒风险概率评估为 1%。

**利用方式：**
1.  **扫描目标：** 使用提供的脚本扫描指定IP列表中的Rsync服务(端口873)。
2.  **枚举模块：**  尝试列出Rsync服务器上可用的模块。
3.  **权限测试：**  针对每个模块，尝试写入文件，以确定是否具有写入权限。如果成功写入，则表明目标存在配置错误，可能允许恶意文件上传，存在进一步利用的可能，但是上传本身并没有直接利用 CVE-2024-12084。

**结论：**
虽然提供的脚本本身并没有直接利用 CVE-2024-12084 漏洞进行堆缓冲区溢出攻击，但是如果结合其他exp，可能会成功利用该漏洞进行RCE。

**项目地址:** [themirze/cve-2024-12084](https://github.com/themirze/cve-2024-12084)

**漏洞详情:** [CVE-2024-12084](https://nvd.nist.gov/vuln/detail/CVE-2024-12084)