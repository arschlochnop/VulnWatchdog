## CVE-2021-41773/CVE-2021-42013 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，存在Alias-like指令配置，且相关目录没有“require all denied”保护。CGI脚本需要启用以进行RCE。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Apache HTTP Server 2.4.49/2.4.50中路径规范化处理的缺陷。攻击者可以利用路径遍历漏洞读取服务器上的任意文件。如果服务器同时启用了CGI脚本，则可能导致远程代码执行。

**有效性分析：**

根据漏洞信息和搜索结果，该漏洞在野外被积极利用，具有较高的有效性。POC代码针对Apache 2.4.50版本，尝试利用路径遍历漏洞，首先检测CGI是否禁用，如果禁用则尝试读取/etc/passwd，如果CGI开启，则尝试执行反向shell。根据代码逻辑，该POC有一定的有效性，能检测和利用漏洞。

**投毒风险分析：**

代码中存在轻微的投毒风险。作者可能在LICENSE文件中隐藏了恶意代码，虽然该可能性较低，但是需要考虑到,或者在代码中存在一些对普通用户不友好的代码。 代码整体较为直接，没有明显的恶意行为，但仍需谨慎评估。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`.%%32%65`）的URL，绕过路径规范化检查，从而访问Alias-like指令配置以外的文件。例如，`/.%%32%65/.%%32%65/.%%32%65/etc/passwd`可以尝试读取`/etc/passwd`文件。
2.  **远程代码执行（RCE）：** 如果目标服务器启用了CGI，攻击者可以通过POST请求发送恶意代码，该代码将在服务器上执行。POC代码尝试注入一个反向shell，连接到攻击者指定的IP地址和端口。利用前提是服务器允许执行CGI脚本，并且没有对CGI脚本的执行进行严格的限制。

**项目地址:** [Zyx2440/Apache-HTTP-Server-2.4.50-RCE](https://github.com/Zyx2440/Apache-HTTP-Server-2.4.50-RCE)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)