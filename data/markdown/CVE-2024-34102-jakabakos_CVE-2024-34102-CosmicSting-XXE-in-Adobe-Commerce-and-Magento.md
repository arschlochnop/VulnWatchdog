## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 无需用户交互，网络可达即可

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102是Adobe Commerce和Magento中的一个严重的XXE漏洞。攻击者可以通过发送特制的XML文档，其中包含对外部实体的引用来利用此漏洞。成功利用此漏洞可能导致敏感信息泄露，例如app/etc/env.php中的加密密钥，或执行任意代码。根据漏洞信息，此漏洞无需身份验证或用户交互，攻击者只需发送特制的请求即可。提供的POC代码`exploit.py`允许攻击者读取远程服务器上的任意文件。它还支持使用OOB（带外）服务器来接收数据，这意味着即使目标服务器无法直接将数据发送回攻击者，攻击者仍然可以通过OOB服务器获取数据。`detect.py`脚本用于检测目标服务器是否存在漏洞。由于代码中使用 `urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)` 和 `warnings.filterwarnings("ignore")`，导致潜在的漏洞细节被忽略，存在一定的投毒风险。此外，依赖外部服务器（--oob-server，--host-server）来进行攻击，可能存在被中间人攻击或数据泄露的风险，作者可以轻易获取用户的使用记录。总体来说，代码存在小概率的投毒风险，主要体现在其隐藏攻击行为的可能性上。

**项目地址:** [jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento](https://github.com/jakabakos/CVE-2024-34102-CosmicSting-XXE-in-Adobe-Commerce-and-Magento)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)