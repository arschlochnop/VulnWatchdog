## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)