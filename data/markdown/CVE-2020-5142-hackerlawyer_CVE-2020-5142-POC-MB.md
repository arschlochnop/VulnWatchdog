## CVE-2020-5142-SonicWall-SSLVPN-Stored-XSS

**漏洞编号:** CVE-2020-5142

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** SonicWall SSLVPN

**危害等级:** 中危，可能导致敏感信息泄露，会话劫持，或页面恶意跳转

**影响版本:** SonicOS 6.5.4.7-79n 及更早版本, SonicOS 5.9.1.7-2n 及更早版本, SonicOS 5.9.1.13-5n 及更早版本, SonicOS 6.5.1.11-4n 及更早版本, SonicOS 6.0.5.3-93o 及更早版本, SonicOSv 6.5.4.4-44v-21-794 及更早版本, SonicOS 7.0.0.0-1

**利用条件:** 需要能够访问 SonicOS SSLVPN Web 界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-5142 是 SonicWall SSLVPN Web 界面中的一个存储型跨站脚本 (XSS) 漏洞。未经身份验证的远程攻击者能够在防火墙 SSLVPN 门户中存储并可能执行任意 JavaScript 代码。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于多个 SonicOS 版本中。提供的 POC 代码 `/tmp/d71c2039f9022b74d059b8186cccd8bb/CVE20205142MB.txt`  中描述了利用方式，提到通过转义字符绕过过滤，从而执行任意 JavaScript。POC 看起来是有效的，虽然描述说是 Reflected XSS，但CVE描述是Stored XSS， 需要进一步验证是哪种。

**投毒风险：** POC 代码本身看起来较为简单，主要是利用 Burp Suite 进行主动扫描，并尝试通过特定 URL 和转义字符来注入恶意 JavaScript。`/tmp/d71c2039f9022b74d059b8186cccd8bb/README.md` 文件只是一些简单的说明文档。代码本身没有明显的恶意操作或者后门，但作者有可能在其他地方隐藏恶意代码。由于是XSS漏洞，更多需要关注恶意脚本执行后的行为，例如，将用户的cookie发送到恶意服务器等。因此，认为存在较低的投毒风险，约 5%。

**利用方式：** 攻击者可以通过在 SonicOS SSLVPN Web 界面的某些输入点（例如 URL 参数）注入恶意 JavaScript 代码。由于是存储型 XSS，恶意代码会被存储在服务器端，当其他用户访问包含恶意代码的页面时，恶意 JavaScript 代码会在用户的浏览器中执行。利用方式可以是通过`- or "> or ';` 等闭合方式绕过SonicWall的过滤规则。


**项目地址:** [hackerlawyer/CVE-2020-5142-POC-MB](https://github.com/hackerlawyer/CVE-2020-5142-POC-MB)

**漏洞详情:** [CVE-2020-5142](https://nvd.nist.gov/vuln/detail/CVE-2020-5142)