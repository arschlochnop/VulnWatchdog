## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 5.1.0

**利用条件:** 需要RocketMQ NameServer, Broker, 或 Controller组件暴露在公网且无权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-33246是Apache RocketMQ 5.1.0及以下版本中存在的远程代码执行漏洞。根据漏洞描述，当RocketMQ的NameServer、Broker或Controller组件暴露在公网且缺乏权限验证时，攻击者可以通过更新配置功能或者伪造RocketMQ协议内容来执行任意命令，从而完全控制服务器。

**有效性：**
根据CISA KEV目录、NVD、Arctic Wolf等多个信息源，此漏洞已被积极利用，并存在公开可用的PoC代码，因此判断该漏洞的PoC代码有效。

**投毒风险：**
提供的PoC代码（从README.md文件来看）是一个Java程序，通过命令行参数指定目标IP地址和要执行的命令。 风险较低，因为如果存在后门,一般在jar包里面,而不是README.md说明文件里，用户可以使用反编译工具分析jar包。

**利用方式：**
利用方式主要有两种：

1.  **更新配置功能：** 攻击者利用RocketMQ的配置更新接口，注入恶意命令到配置项中，导致服务器执行任意命令。
2.  **伪造RocketMQ协议内容：** 攻击者构造包含恶意命令的RocketMQ协议数据包，发送到目标服务器，触发远程代码执行。

总而言之，利用此漏洞需要目标服务器存在可被攻击的RocketMQ组件且未进行严格的权限控制。 搜索引擎结果显示该漏洞已被DreamBus僵尸网络利用，说明该漏洞具有较高的威胁性。

**项目地址:** [SuperZero/CVE-2023-33246](https://github.com/SuperZero/CVE-2023-33246)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)