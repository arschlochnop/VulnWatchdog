## CVE-2025-3248 - Langflow Unauth RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** Langflow

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.2.0

**利用条件:** 需要网络访问 vulnerable 的 Langflow 实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248 是 Langflow 中一个未经身份验证的远程代码执行漏洞，影响版本小于等于 1.2.0。该漏洞位于 `/api/v1/validate/code` 端点，允许远程攻击者通过发送特制的 HTTP 请求执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，漏洞利用代码很可能有效。多个来源 (NVD, Zscaler, Horizon3.ai 等) 都确认了该漏洞的存在和严重性，并且 Horizon3.ai 提供了关于如何利用 `exec` 函数实现 RCE 的细节。GitHub 上存在公开可用的 POC 代码 (verylazytech/CVE-2025-3248, xuemian168/CVE-2025-3248)，进一步表明了其有效性。

**投毒风险：**
提供的漏洞利用代码仅包含一个 README.md 文件，该文件描述了漏洞扫描器和利用程序。因此，直接从该文件判断是否存在投毒代码的可能性较低，但无法完全排除。漏洞利用代码本身没有提供直接的后门代码。xuemian168的仓库宣称可以执行系统命令，如果该项目存在恶意代码，则存在投毒风险。这里给出一个10%的投毒风险概率，主要考虑到实际使用中，用户可能会下载其他仓库的POC，这些POC可能包含恶意代码。

**利用方式：**
利用方式为：

1.  **确定目标 Langflow 实例版本低于 1.3.0。**
2.  **向 `/api/v1/validate/code` 端点发送包含恶意 Python 代码的 HTTP 请求。** 由于缺少身份验证，攻击者可以未经授权发送此请求。
3.  **恶意 Python 代码将被执行，从而允许攻击者在目标服务器上执行任意命令。**

该漏洞利用的核心在于 Langflow 使用 `exec` 函数执行用户提供的代码，而没有进行适当的身份验证和沙箱处理。攻击者可以利用这一点注入恶意代码并获得远程代码执行权限。

**项目地址:** [Praison001/CVE-2025-3248](https://github.com/Praison001/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)