## CVE-2018-1002204 adm-zip 目录遍历漏洞

**漏洞编号:** CVE-2018-10022

**漏洞类型:** 目录遍历

**影响应用:** adm-zip npm library

**危害等级:** 高危，允许攻击者写入任意文件

**影响版本:** < 0.4.9

**利用条件:** 需要能够上传或控制包含恶意路径的ZIP文件

**POC 可用性:** 待验证

**投毒风险:** 5%

## 详情

根据搜索结果，CVE-2018-1002204 描述了 adm-zip npm 库 0.4.9 之前的版本存在目录遍历漏洞。攻击者可以构造包含恶意路径（如 `../../../../path/to/file`）的 ZIP 文件，解压时将文件写入任意位置，从而覆盖敏感文件或执行恶意代码。

提供的“漏洞利用代码”实际上是 ZT Zip 库的 Changelog 和 License 文件，并非直接的漏洞利用代码。但是，结合 CVE 信息，可以推断利用方式：构造一个包含恶意文件名的 ZIP 文件，该文件名包含目录遍历的 payload，当使用存在漏洞的 adm-zip 版本解压此 ZIP 文件时，恶意文件会被写入到文件系统的任意位置。

**有效性：**
需要验证，提供的代码不是直接的PoC，需要根据漏洞描述构造恶意 ZIP 文件才能验证。

**投毒风险：**
提供的代码片段主要是 Changelog 和 License 文件，本身不太可能包含恶意代码。但是存在极小的风险（大约 5%），攻击者可能在合法的代码中隐藏一些难以察觉的恶意代码，但这种情况的可能性较低，因为这些文件主要是文本文件，执行的可能性很低。

**利用方式：**
1.  确定目标系统使用的 adm-zip 版本低于 0.4.9。
2.  构造一个包含恶意文件名的 ZIP 文件，例如 `evil.zip`，其中包含一个文件 `../../../../tmp/evil.txt`。
3.  如果目标系统使用有漏洞的 adm-zip 解压 `evil.zip`，则 `evil.txt` 会被写入到 `/tmp/evil.txt`，攻击者可以覆盖目标文件。

**排序优先级:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**漏洞详情:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)