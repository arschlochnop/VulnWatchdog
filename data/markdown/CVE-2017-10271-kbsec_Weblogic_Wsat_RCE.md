## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)