## CVE-2023-23752 - Joomla! 未授权信息泄露

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 未授权信息泄露

**影响应用:** Joomla! CMS

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 4.0.0 - 4.2.7

**利用条件:** 需要网络可达，目标Joomla站点开启了webservice endpoint并且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23752 是 Joomla! 4.0.0 到 4.2.7 版本中的一个缺陷，允许未经身份验证的用户访问 webservice endpoints，从而泄露敏感信息。根据漏洞利用代码，攻击者可以通过构造特定的 URL（例如 `/api/index.php/v1/config/application?public=true`）来获取数据库配置信息，包括数据库类型、主机、用户名、密码和表前缀。该漏洞利用代码使用 Go 语言编写，通过发送 HTTP GET 请求到目标 URL，然后解析返回的 JSON 数据，提取数据库配置信息并输出。代码中使用了 `resty` 库发送 HTTP 请求，并忽略了 TLS 证书验证。`urls.txt` 文件包含了需要测试的目标 URL 列表。代码中包含从`urls.txt`读取url进行批量测试功能。此外，还添加了代理设置功能。投毒风险分析：此POC主要功能是利用漏洞读取数据库配置信息，没有发现直接的后门代码。存在一定投毒风险的可能性是，代码中忽略了TLS证书验证，可能被中间人攻击。此外，代理设置如果使用恶意代理，存在泄露扫描目标url的风险。代码作者在注释中声明代码仅供学习使用，请勿用于其他用途。综合考量，投毒风险较低，估计为10%。漏洞利用方式总结：
1.  攻击者准备包含目标Joomla站点URL的`urls.txt`文件。
2.  运行POC代码，POC代码会循环读取`urls.txt`中的URL，并发送构造好的HTTP GET请求到`/api/index.php/v1/config/application?public=true`，尝试未授权访问 webservice endpoints。
3.  如果目标站点存在漏洞，webservice endpoint会返回包含数据库配置信息的JSON数据。
4.  POC代码解析JSON数据，提取数据库配置信息并输出。

**项目地址:** [C1ph3rX13/CVE-2023-23752](https://github.com/C1ph3rX13/CVE-2023-23752)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)