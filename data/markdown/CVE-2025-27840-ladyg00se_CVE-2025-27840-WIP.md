## CVE-2025-27840-Espressif ESP32 芯片隐藏HCI命令

**漏洞编号:** CVE-2025-27840

**漏洞类型:** 权限提升/内存写入

**影响应用:** Espressif ESP32

**危害等级:** 中危，尽管CVSS评分为6.8，但需要物理访问或高权限。

**影响版本:** 2025-03-06

**利用条件:** 需要物理访问或蓝牙配对权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-27840 漏洞存在于 Espressif ESP32 芯片中，允许通过 29 个隐藏的 HCI 命令执行未授权操作，特别是 `0xFC02` 命令允许直接写入内存。 根据漏洞信息、搜索结果和提供的漏洞利用代码，分析如下：

**1. 有效性：**

*   漏洞库信息和搜索引擎结果均证实了该漏洞的存在，描述一致，表明该漏洞是有效的。
*   POC代码的存在表明该漏洞可以被利用，尽管需要一定的条件。

**2. 投毒风险：**

*   提供的POC代码仅包含一个许可证文件和一个README.md文件，用于描述漏洞信息，漏洞利用方式和免责声明。没有发现直接的恶意代码或后门代码。但是，考虑到实际漏洞利用可能涉及到复杂的蓝牙通信过程和内存操作，如果利用代码来源于不可信的第三方，存在投毒的可能。
*   **投毒风险评估: 10%**。这个风险评估是因为目前提供的代码只是漏洞信息的描述，并未包含实际的攻击代码。如果实际的攻击代码中存在恶意行为，风险会大大增加。

**3. 利用方式：**

*   攻击者需要通过蓝牙连接到目标ESP32设备，或者拥有物理访问权限。
*   利用隐藏的HCI命令（特别是`0xFC02`），向设备的内存中写入恶意代码。
*   写入的恶意代码可以用于修改设备的行为，例如：
    *   伪造MAC地址
    *   获取未授权的数据访问权限
    *   在网络中进行横向渗透
    *   控制连接到ESP32的设备

**4. 防御措施:**
*   Espressif 计划在未来的更新中移除这些未公开的命令
*   限制对设备的物理访问
*   及时监控漏洞补丁发布情况并及时更新

**项目地址:** [ladyg00se/CVE-2025-27840-WIP](https://github.com/ladyg00se/CVE-2025-27840-WIP)

**漏洞详情:** [CVE-2025-27840](https://nvd.nist.gov/vuln/detail/CVE-2025-27840)