## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)