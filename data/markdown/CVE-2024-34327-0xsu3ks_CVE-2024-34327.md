## CVE-2024-34327 SQL注入漏洞

**漏洞编号:** CVE-2024-34327

**漏洞类型:** 时间盲注SQL注入

**影响应用:** 未知 (根据PoC，影响`/auth/password-reset-token.php`端点)

**危害等级:** 高危，可能导致数据泄露，账户接管

**影响版本:** 未知，PoC针对 `/auth/password-reset-token.php`

**利用条件:** 目标服务器的`/auth/password-reset-token.php`端点可访问，且存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-34327是一个时间盲注SQL注入漏洞，存在于`/auth/password-reset-token.php`端点，通过`email`参数进行注入。PoC通过构造包含`SLEEP(10)`函数的SQL语句，判断服务器响应时间是否超过9秒来验证漏洞是否存在。如果响应时间超过9秒，则判断为存在漏洞。

**有效性：**
根据提供的PoC代码，该漏洞利用的有效性取决于目标系统是否存在该SQL注入漏洞。该PoC通过时间延迟来判断是否存在漏洞，是一种常见的盲注检测方法。

**投毒风险：**
经过对PoC代码的分析，未发现明显的恶意代码或后门。代码逻辑相对简单，主要功能是发送包含SQL注入payload的HTTP POST请求，并根据响应时间判断是否存在漏洞。`urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)`虽然关闭了TLS警告，但这是为了方便测试，并非恶意行为。随机生成`PHPSESSID`也增加了请求的真实性，同样不是恶意行为。代码逻辑的主要风险点在于可能被用于未经授权的漏洞扫描和利用，但从代码本身来看，投毒风险较低，估计在5%左右。需要说明的是，任何安全工具都可能被滥用，关键在于使用者的行为。

**利用方式：**
1.  使用PoC脚本（`V-24-02-001_SQLi_Check.py`或`cve-2024-34327.py`）。
2.  通过命令行参数指定目标URL（例如：`python3 V-24-02-001_SQLi_Check.py --url https://vulnerable-site.com`）。
3.  脚本会发送包含恶意SQL payload的POST请求到`/auth/password-reset-token.php`端点。
4.  如果服务器响应时间超过9秒，脚本会输出`[+] VULNERABLE`，否则输出`[-] NOT VULNERABLE`。

总的来说，该PoC的利用方式是标准的时间盲注SQL注入检测，代码本身投毒风险较低，但使用时务必获得授权。

**项目地址:** [0xsu3ks/CVE-2024-34327](https://github.com/0xsu3ks/CVE-2024-34327)

**漏洞详情:** [CVE-2024-34327](https://nvd.nist.gov/vuln/detail/CVE-2024-34327)