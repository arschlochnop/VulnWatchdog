## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致Net-NTLM hash泄露，进而进行身份冒充和横向移动

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, Outlook 2016, Outlook 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise。详见漏洞库信息中的cpeApplicability。

**利用条件:** 攻击者需要能够发送邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者通过构造包含指向恶意 SMB 服务器 UNC 路径的特殊邮件（例如，利用 `reminder_sound_file` 字段），当 Outlook 客户端处理该邮件时，会自动尝试通过 SMB 协议连接到攻击者的服务器，从而泄露受害者的 Net-NTLM hash。由于 Outlook 客户端会自动处理邮件，因此该漏洞是零点击漏洞。

**漏洞利用方式：**
1.  攻击者构造一个恶意的 `.msg` 文件，其中包含指向攻击者控制的 SMB 服务器的 UNC 路径，该路径位于 `reminder_sound_file` 字段中。
2.  攻击者通过邮件将此恶意 `.msg` 文件发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理此邮件时，会自动尝试连接到攻击者的 SMB 服务器。
4.  攻击者的 SMB 服务器捕获受害者的 Net-NTLM hash。
5.  攻击者可以使用此 hash 进行身份冒充或尝试破解密码。

**有效性：**
提供的 POC 代码 `CVE-2023-23397.py` 有效。它利用 `independentsoft.msg` 库创建恶意 `.msg` 文件，并使用 `smtplib` 库将其作为附件发送给受害者。

**投毒风险：**
该仓库中的 POC 代码没有发现明显的投毒代码。代码的主要功能是生成恶意的 Outlook 邮件并发送，以触发漏洞。所有操作都与其描述相符，没有隐藏的恶意行为。

**项目地址:** [Trackflaw/CVE-2023-23397](https://github.com/Trackflaw/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)