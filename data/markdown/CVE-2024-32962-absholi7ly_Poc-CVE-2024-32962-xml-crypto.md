## CVE-2024-32962-xml-crypto-签名伪造

**漏洞编号:** CVE-2024-32962

**漏洞类型:** XML签名验证绕过

**影响应用:** xml-crypto

**危害等级:** 高危，可能导致身份伪造和权限提升

**影响版本:** >= 4.0.0, < 6.0.0

**利用条件:** 需要能够篡改或控制被签名的XML文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-32962 存在于 xml-crypto 库中，允许攻击者通过构造恶意的 XML 文档，绕过签名验证。漏洞原因为库在默认配置下，仅验证签名的有效性，而未对签名者的身份进行授权检查。攻击者可以替换 XML 文档中的原始签名，使用攻击者自己的私钥进行签名，并将对应的公钥证书插入到 `<KeyInfo />` 元素中。由于库默认信任 `<KeyInfo />` 中提供的证书，因此可以成功绕过签名验证。

**有效性：** 根据漏洞库信息和搜索引擎结果，此漏洞已经确认存在，并且有可利用的POC代码。

**投毒风险：** 提供的POC代码仓库包含一个`README.md`文件，声明很快提供漏洞利用代码，并链接到一个视频文件（`poc.mp4`）。当前无法直接分析视频文件的内容，因此投毒风险较低。但依然存在一定风险，例如，作者可能后续上传包含恶意代码的POC或视频文件包含误导性信息，误导使用者执行恶意操作。综合来看，投毒风险评估为10%。

**利用方式：**

1.  攻击者拦截或获取待签名的XML文档。
2.  攻击者生成自己的密钥对。
3.  攻击者使用自己的私钥对篡改后的XML文档进行签名。
4.  攻击者将自己的公钥证书添加到 XML 文档的 `<KeyInfo />` 元素中。
5.  攻击者将篡改后的XML文档发送给依赖 xml-crypto 库进行签名验证的目标系统。
6.  目标系统使用 xml-crypto 库进行签名验证时，会信任 `<KeyInfo />` 中提供的攻击者证书，从而绕过签名验证。

此漏洞可被用于伪造身份，例如在SAML身份验证中，攻击者可以伪造SAML断言，从而获得未经授权的访问权限。

**项目地址:** [absholi7ly/Poc-CVE-2024-32962-xml-crypto](https://github.com/absholi7ly/Poc-CVE-2024-32962-xml-crypto)

**漏洞详情:** [CVE-2024-32962](https://nvd.nist.gov/vuln/detail/CVE-2024-32962)