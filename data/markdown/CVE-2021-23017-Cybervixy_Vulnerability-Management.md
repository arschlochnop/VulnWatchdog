## CVE-2021-23017-Nginx Resolver 内存覆盖

**漏洞编号:** CVE-2021-23017

**漏洞类型:** 内存覆盖

**影响应用:** Nginx

**危害等级:** 高危，可能导致worker进程崩溃或潜在的其他影响，如DoS

**影响版本:** Nginx Web Server versions 0.6.18 thru 1.20.0 before 1.20.1, Nginx plus versions R13 thru R23 before R23 P1. Nginx plus version R24 before R24 P1

**利用条件:** 需要能够伪造来自DNS服务器的UDP数据包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-23017是Nginx resolver中的一个安全问题，允许攻击者通过伪造来自DNS服务器的UDP数据包来导致1字节的内存覆盖。从提供的漏洞利用代码来看，它展示了一个利用Nginx漏洞的例子，但并未直接包含利用CVE-2021-23017的明确exp代码，所以有效性需要根据实际的利用代码判断。提供的漏洞利用代码主要描述了使用Nessus进行漏洞扫描和使用Ansible进行补丁管理的流程，以及扫描结果中发现的CVE-2021-23017漏洞。利用方式是通过发送特制的UDP数据包，触发Nginx resolver的内存覆盖漏洞，进而导致worker进程崩溃或执行恶意代码。

**有效性评估：**  根据搜索结果和漏洞库信息，可以确认该漏洞存在且影响特定版本的Nginx。但是，提供的漏洞利用代码并没有直接展示exp的编写，需要进一步验证。

**投毒风险评估：**  虽然此仓库展示了通过nessus进行漏洞扫描，但依然存在一定的投毒风险。此报告目的是记录漏洞管理，但是不排除作者隐藏其他恶意代码的可能，因此存在**10%**的投毒风险。主要关注点是：

1.  **自动化脚本：** 查看Ansible脚本等自动化配置管理脚本，确认其内容是否符合预期，是否存在未知的操作。
2.  **第三方依赖：**  检查是否存在不必要的第三方依赖，以及这些依赖的来源是否可信。
3. **后门验证代码:** 务必不要把POC验证的后门代码判定为投毒代码。

**利用方式：**

1.  **伪造DNS响应：** 攻击者需要能够拦截或伪造DNS服务器的响应数据包。
2.  **构造恶意数据包：** 构造包含恶意负载的UDP数据包，该负载能够触发Nginx resolver中的内存覆盖漏洞。
3.  **发送数据包：**  将伪造的DNS响应数据包发送给Nginx服务器，触发漏洞。
4.  **结果：** 成功利用后，可能导致Nginx worker进程崩溃，从而造成拒绝服务攻击。如果能精确控制覆盖的内存区域，则可能实现远程代码执行。

**项目地址:** [Cybervixy/Vulnerability-Management](https://github.com/Cybervixy/Vulnerability-Management)

**漏洞详情:** [CVE-2021-23017](https://nvd.nist.gov/vuln/detail/CVE-2021-23017)