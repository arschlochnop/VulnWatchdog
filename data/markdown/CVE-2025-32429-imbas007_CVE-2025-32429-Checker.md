## CVE-2025-32429-XWiki-SQL注入

**漏洞编号:** CVE-2025-32429

**漏洞类型:** SQL注入

**影响应用:** XWiki Platform

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 9.4-rc-1 <= version < 16.10.6, 17.0.0-rc-1 <= version < 17.3.0-rc-1

**利用条件:** 需要网络访问，且目标XWiki实例存在getdeleteddocuments.vm模板并允许未授权访问该模板。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32429是XWiki Platform中的一个SQL注入漏洞，位于`getdeleteddocuments.vm`模板的`sort`参数中。攻击者可以通过构造恶意的SQL语句，利用该漏洞执行任意SQL查询，从而获取敏感信息，甚至可能执行任意代码。根据漏洞描述，该漏洞无需认证即可利用，CVSS评分为9.3，属于严重级别漏洞。

**有效性:**
根据提供的漏洞利用代码，该POC脚本通过发送特制的HTTP请求到`/xwiki/rest/liveData/sources/liveTable/entries`接口，并操控`sourceParams.template`和`sort`参数来触发漏洞。POC代码实现了WAF检测、基于时间的盲注和基于错误的SQL注入检测，表明该POC在一定程度上是有效的。

**投毒风险:**
分析POC代码，发现代码主要功能是检测漏洞，虽然存在多线程功能，但主要目的是为了提高扫描效率。代码中没有发现明显的恶意行为，比如反弹shell、上传文件等。但是，攻击者可以基于此POC进行修改，加入恶意代码进行传播，因此存在一定的投毒风险，评估为10%， 主要基于以下原因:
1.  **依赖第三方库：** POC 使用了`requests` 和 `urllib3`库，虽然这些库本身是常用的，但是如果攻击者修改POC，使其依赖于包含恶意代码的第三方库，则可能引入风险。
2.  **代码可修改性：**  POC 代码是开源的，攻击者可以很容易地修改该代码，添加恶意功能。
3.  **执行系统命令风险：**  虽然当前POC没有直接执行系统命令，但攻击者可以通过SQL注入执行数据库命令，进而可能导致间接的系统命令执行。

**利用方式:**
1.  **确定目标XWiki版本：** 确认目标XWiki Platform的版本是否在受影响范围内（9.4-rc-1 <= version < 16.10.6, 17.0.0-rc-1 <= version < 17.3.0-rc-1）。
2.  **发送恶意请求：** 构造包含恶意SQL代码的HTTP请求，通过修改`sort`参数的值，注入到SQL查询语句中。
    例如：`https://target/xwiki/rest/liveData/sources/liveTable/entries?sourceParams.template=getdeleteddocuments.vm&sort=恶意SQL代码`
3.  **获取敏感信息或执行任意代码：** 利用注入的SQL代码，读取数据库中的敏感信息，例如用户名、密码等。如果数据库权限配置不当，甚至可以执行任意代码。

**项目地址:** [imbas007/CVE-2025-32429-Checker](https://github.com/imbas007/CVE-2025-32429-Checker)

**漏洞详情:** [CVE-2025-32429](https://nvd.nist.gov/vuln/detail/CVE-2025-32429)