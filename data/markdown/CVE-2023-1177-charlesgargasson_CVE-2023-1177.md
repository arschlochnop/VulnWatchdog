## CVE-2023-1177-mlflow-路径遍历

**漏洞编号:** CVE-2023-1177

**漏洞类型:** 路径遍历

**影响应用:** mlflow

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** < 2.2.1

**利用条件:** 需要能够发送POST请求到mlflow服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-1177是mlflow版本低于2.2.1时存在的路径遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。

**有效性评估：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了`file://`协议和路径遍历，结合空字节注入来绕过路径检查，读取目标文件。

**投毒风险评估：**
查看提供的漏洞利用代码，该代码主要包含一个bash脚本，用于创建注册模型，创建模型版本，并使用`curl`命令读取指定文件。脚本中没有发现任何后门或者恶意代码，该仓库的LICENSE文件也是常规的MIT开源协议。
因此，此仓库中作者隐藏投毒代码的风险很低，评估为**0%**。

**利用方式分析：**
1.  **创建注册模型：** 使用`curl`向`/ajax-api/2.0/mlflow/registered-models/create`接口发送POST请求，创建一个名为`$RAND`的注册模型。
2.  **创建模型版本：** 使用`curl`向`/ajax-api/2.0/mlflow/model-versions/create`接口发送POST请求，创建一个模型版本。关键在于`source`参数，该参数使用`file://`协议指定文件路径，并通过 `%00` 引入空字节来截断路径，尝试绕过mlflow的路径检查。${FILE%/*} 获取文件所在目录。
3.  **读取目标文件：** 使用`curl`向`/model-versions/get-artifact`接口发送GET请求，指定要读取的文件路径（`path`参数），模型名称（`name`参数）和版本（`version`参数）。${FILE##*/} 用于获取文件名。

总的来说，该漏洞利用方式通过MLflow的API接口，结合`file://`协议和路径遍历技术读取服务器上的敏感文件。

**项目地址:** [charlesgargasson/CVE-2023-1177](https://github.com/charlesgargasson/CVE-2023-1177)

**漏洞详情:** [CVE-2023-1177](https://nvd.nist.gov/vuln/detail/CVE-2023-1177)