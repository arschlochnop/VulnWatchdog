## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，攻击者可利用该漏洞在目标系统上执行任意代码

**影响版本:** 受影响的版本包括Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022等，具体版本范围见漏洞库信息。

**利用条件:** 需要用户打开包含恶意链接或文件的文档，例如Word文档。 或者通过其他调用程序触发MSDT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT)中的远程代码执行漏洞。攻击者可以通过诱使用户打开特制的文档(例如Word文档)来触发该漏洞。该文档利用Word的远程模板功能从远程服务器检索HTML文件，其中包含恶意代码。当MSDT被调用并使用URL协议时，就会触发此漏洞，允许攻击者以调用应用程序的权限执行任意代码。这可能导致安装程序、查看/更改/删除数据或创建新帐户。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意代码的Word文档或其他支持远程模板的文档。
2.  该文档包含一个指向攻击者控制的远程服务器的链接，该服务器托管一个包含恶意HTML代码的文件。
3.  当用户打开该文档时，Word会从远程服务器下载HTML文件。
4.  HTML文件中的恶意代码使用`ms-msdt:`协议调用MSDT，并传递恶意参数。
5.  MSDT解析恶意参数并执行攻击者指定的代码。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被积极利用，并且存在公开的POC代码。
提供的Cargo.lock文件只是Rust项目的依赖锁文件，本身不包含漏洞利用代码，不能直接验证漏洞是否有效。但该文件表明该项目可能与该漏洞的利用有关，需要进一步分析项目源代码才能确定。

**投毒风险：**
Cargo.lock文件本身不包含可执行代码，因此直接通过该文件进行投毒的可能性较低。但是，如果该项目包含恶意构建脚本或者依赖了被投毒的第三方库，则可能存在投毒风险。初步判断该仓库存在一定比例的投毒风险，约10%，需要进一步分析项目源代码，检查是否存在以下情况：
*   构建脚本中是否包含恶意代码。
*   依赖项中是否存在已知被投毒的库。
*   是否存在其他可疑的文件或代码。

需要强调的是，在未对整个代码库进行彻底审查的情况下，无法完全排除投毒风险。

**项目地址:** [skitkat/CVE-2022-30190-POC](https://github.com/skitkat/CVE-2022-30190-POC)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)