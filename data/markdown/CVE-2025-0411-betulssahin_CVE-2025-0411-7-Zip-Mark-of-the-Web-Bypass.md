## CVE-2025-0411-7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web Bypass

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 需要用户交互，打开恶意网页或文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 是一个 7-Zip 的 Mark-of-the-Web (MotW) 绕过漏洞。该漏洞存在于处理存档文件时，7-Zip 未能将 MotW 标记传播到提取的文件。攻击者可以利用此漏洞在当前用户的上下文中执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个带有 MotW 标记的恶意双层压缩包 (例如，out.7z)。
2.  第一层压缩包(out.7z)包含第二层压缩包(in.doс)，in.doс伪装成doc文档, 实际上是一个压缩文件。
3.  第二层压缩包(in.doс) 包含可执行文件(例如，shell.exe)，或者指向包含恶意程序的URL文件。
4.  用户下载并使用 7-Zip 解压该压缩包。
5.  由于 7-Zip 未能将 MotW 标记传播到第二层压缩包内的文件，导致文件没有MotW标记。
6.  用户运行解压出的可执行文件，从而执行恶意代码。

**有效性评估：**

提供的 POC 代码展示了如何创建双层压缩包，并验证了 MotW 标记未被正确传递到内部文件。POC 描述了如何使用同形字攻击来伪装内部的压缩包文件，增加欺骗性。根据漏洞库信息和搜索结果，此漏洞已被积极利用。

**投毒风险评估：**

代码仓库中存在投毒代码的风险较低。POC 代码的主要目的是演示漏洞利用，并没有发现明显的恶意代码。但是需要注意的是, 攻击者可能会在构造恶意压缩包的时候, 在第二层压缩包中放置恶意程序, 这也算是利用此漏洞进行攻击的一部分.  因此, 评估投毒风险为 10%, 主要来自于攻击者最终构造的恶意payload。

**项目地址:** [betulssahin/CVE-2025-0411-7-Zip-Mark-of-the-Web-Bypass](https://github.com/betulssahin/CVE-2025-0411-7-Zip-Mark-of-the-Web-Bypass)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)