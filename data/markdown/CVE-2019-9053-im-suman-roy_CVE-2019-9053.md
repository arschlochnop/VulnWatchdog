## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和未授权访问

**影响版本:** <= 2.2.9

**利用条件:** 需要网络访问CMS Made Simple实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中存在的一个未经身份验证的基于时间的盲SQL注入漏洞，位于News模块。攻击者可以通过构造恶意的URL，修改`m1_idlist`参数，利用`sleep()`函数来判断SQL注入是否成功，从而提取数据库信息。 

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码是有效的。搜索结果中存在多个关于该漏洞的报告和利用代码的链接，表明该漏洞是真实存在的，并且已经有可用的利用代码。

**投毒风险：**

分析提供的POC代码，可以发现代码主要功能是利用时间盲注漏洞提取数据库信息，包括salt和密码哈希。代码中包含一个`crack_password`函数，尝试使用提供的字典破解密码。虽然代码尝试破解密码，但这不属于投毒行为。代码中没有发现明显的恶意代码，比如反弹shell、上传恶意文件等，风险点在于如果攻击者修改了脚本，例如修改了sleep的时间，或者加入反弹shell等操作，将会造成更大的危害。综合评估，投毒风险为10%。该风险主要来自使用者对下载的脚本缺乏安全审核，直接执行导致潜在的危害。

**利用方式：**

1.  攻击者构造包含恶意SQL语句的URL，主要利用`m1_idlist`参数。
2.  通过`sleep()`函数引入时间延迟，根据响应时间判断SQL注入是否成功。
3.  利用盲注技术，逐步提取数据库中的敏感信息，例如salt和管理员密码的哈希值。
4.  使用字典攻击或其他破解方法，尝试破解管理员密码。
5.  成功破解密码后，攻击者可以登录CMS后台，进行进一步的攻击，例如上传恶意插件、修改网站内容等。

**项目地址:** [im-suman-roy/CVE-2019-9053](https://github.com/im-suman-roy/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)