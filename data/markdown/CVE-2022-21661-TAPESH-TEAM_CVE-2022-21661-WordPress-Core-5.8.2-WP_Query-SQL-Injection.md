## CVE-2022-21661-WordPress-WP_Query-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改、甚至服务器控制

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点使用受影响的版本，并允许未授权用户访问admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类由于不正确的输入验证导致的SQL注入漏洞。攻击者可以通过向wp-admin/admin-ajax.php发送包含恶意SQL语句的POST请求，利用`tax_query`参数中的`term_taxonomy_id`字段进行注入。PoC代码显示了构造恶意请求的payload，攻击者可以将SQL注入语句放在`<inject>`的位置。搜索引擎结果中的链接表明该漏洞可以被利用来执行任意SQL查询，从而泄露数据库信息。尽管PoC相对简单，但仍然存在一定程度的投毒风险，因为攻击者可能在利用过程中引入额外的恶意代码或模块，例如用于持久化控制、隐藏攻击行为等。PoC中使用的参数是标准WordPress功能的一部分，但恶意构造的`query_vars`参数导致了SQL注入。PoC的有效性较高，因为多个来源都确认了该漏洞的存在，并提供了利用示例。

关于投毒风险的评估：PoC代码本身看起来比较直接，主要是演示如何构造恶意请求。但是，在实际利用过程中，攻击者可能会修改PoC代码，例如添加收集目标系统信息的代码、尝试执行其他恶意操作的代码、或者使用更隐蔽的注入方式。因此，不能完全排除投毒风险。这里给出10%的投毒风险是考虑了实际攻击场景中可能存在的变数。

**项目地址:** [TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection](https://github.com/TAPESH-TEAM/CVE-2022-21661-WordPress-Core-5.8.2-WP_Query-SQL-Injection)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)