## CVE-2025-31324 - SAP NetWeaver Visual Composer Metadata Uploader 未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer development server

**危害等级:** 严重，可能导致远程代码执行，系统完全控制

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 需要网络访问，目标系统运行受影响版本的 SAP NetWeaver Visual Composer。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31324 漏洞存在于 SAP NetWeaver Visual Composer 的 Metadata Uploader 组件中。由于缺乏适当的授权检查，未经身份验证的攻击者可以上传任意文件，包括恶意的可执行二进制文件，到服务器上。这些文件随后可能被执行，导致远程代码执行，进而完全控制受影响的系统。从提供的搜索结果来看，该漏洞已被积极利用。提供的POC代码是一个Python脚本，它通过构造包含恶意内容的zip文件，并将其发送到`/developmentserver/metadatauploader`端点来利用此漏洞。zip文件包含`.properties`文件，其中包含精心构造的Java反序列化payload，可以执行任意命令。代码中包含了硬编码的base64编码的java序列化数据和版本判断与修改。虽然该POC代码有效，但作者在代码的开头和中间部分都添加了大量文本和链接，这些内容看起来与漏洞本身无关，存在一定的误导性，属于一种信息噪声，增加了分析和使用的难度，所以有5%的投毒风险。实际的利用 payload 位于 base64 编码的字符串中，该字符串在上传后会被反序列化，从而导致命令执行。

**利用方式：**

1.  攻击者构造一个包含恶意Java序列化对象的`.properties`文件。
2.  将该`.properties`文件压缩成ZIP格式。
3.  将ZIP文件作为`application/octet-stream`发送到目标SAP NetWeaver服务器的`/developmentserver/metadatauploader`端点。
4.  服务器在处理上传的文件时，会反序列化ZIP文件中的Java对象，从而执行攻击者预设的恶意代码。

**项目地址:** [antichainalysis/sap-netweaver-0day-CVE-2025-31324](https://github.com/antichainalysis/sap-netweaver-0day-CVE-2025-31324)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)