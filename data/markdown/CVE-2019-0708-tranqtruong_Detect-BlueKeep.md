## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)