## CVE-2024-3400 - Palo Alto Networks PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (<10.2.9-h1), 11.0 (<11.0.4-h1), 11.1 (<11.1.2-h3)，并配置了GlobalProtect网关或门户

**利用条件:** 需要目标系统运行受影响的PAN-OS版本，并启用了GlobalProtect网关或门户功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。由于任意文件创建漏洞导致，未经身份验证的远程攻击者可以通过在受影响的设备上创建恶意文件，执行任意代码，从而获得root权限。漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据提供的漏洞利用代码, 可以看到一个SOC分析师利用自动化工具对告警进行分析, 通过分析攻击流量, 恶意IP以及最终日志响应码来判断漏洞是否被利用. 漏洞利用代码分析主要是记录SOC分析过程, 本身没有提供exp代码。投毒风险分析：漏洞利用代码本身是SOC分析过程记录，而非漏洞利用的EXP，本身不具备漏洞利用能力。其中的图片引用可能存在钓鱼风险，例如替换为恶意链接等， 风险较低，因此投毒风险评定为10%。漏洞利用方式：攻击者发送特制的HTTP请求到GlobalProtect的登录页面`/global-protect/login.esp`，利用任意文件创建漏洞，写入包含恶意命令的文件。由于命令注入漏洞的存在，写入的文件中的命令将以root权限执行。根据搜索结果, 此漏洞已经被大规模利用, 并且已经有公开的POC.

**项目地址:** [hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400](https://github.com/hashdr1ft/SOC274-Palo-Alto-Networks-PAN-OS-Command-Injection-Vulnerability-Exploitation-CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)