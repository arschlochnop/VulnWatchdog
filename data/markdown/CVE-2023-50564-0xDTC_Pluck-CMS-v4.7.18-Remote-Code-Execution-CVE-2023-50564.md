## CVE-2023-50564 Pluck-CMS v4.7.18 任意文件上传导致RCE

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck-CMS

**危害等级:** 高危，允许未经授权的攻击者执行任意代码

**影响版本:** 4.7.18

**利用条件:** 需要能访问Pluck-CMS的安装页面，且具有低权限用户权限（可以登录后台）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Pluck CMS 4.7.18版本的`/inc/modules_install.php`组件中，允许攻击者通过上传特制的ZIP文件来执行任意代码。 

**利用方式：**

1.  **身份验证：** 攻击者首先需要使用有效的密码登录到Pluck CMS的后台管理界面。
2.  **准备Payload：** 攻击者创建一个包含恶意PHP代码（例如，反向Shell）的ZIP文件。在这个POC中，脚本会自动从revshells.com下载一个反向shell，然后打包成zip文件。
3.  **上传ZIP文件：** 攻击者使用构造好的包含恶意PHP文件的zip文件，上传到`/admin.php?action=installmodule`，利用存在漏洞的模块安装功能。
4.  **远程代码执行：** 成功上传并解压ZIP文件后，攻击者可以通过访问上传的PHP文件来触发远程代码执行。  POC中访问的URL为`http://$host/data/modules/loverce/love.php`，触发反向shell。

**有效性评估：**

根据漏洞信息和利用代码，此POC是有效的。它利用了Pluck CMS后台模块安装功能中存在的任意文件上传漏洞，通过上传包含恶意代码的ZIP文件来实现远程代码执行。

**投毒风险评估：**

该脚本存在一定的投毒风险，主要体现在以下几个方面：
1. **外部依赖**: 该脚本依赖于 `revshells.com` 下载反向shell代码。虽然 `revshells.com` 本身是一个信誉良好的在线反向shell生成器，但依赖于外部资源总是存在一定的风险。`revshells.com` 可能被篡改，导致下载的shell包含恶意代码。
2. **潜在的恶意代码注入**: 攻击者可能修改此脚本，在生成的ZIP文件中添加额外的恶意PHP文件，或者修改反向shell的配置，使其连接到攻击者控制的服务器。
3. **信息收集**: 脚本收集目标系统的IP地址和端口信息，这些信息可能被滥用。

总的来说，投毒风险较低，大约为10%。

**缓解措施：**

1.  及时将Pluck CMS升级到最新版本或应用官方提供的补丁。
2.  限制后台管理界面的访问权限，只允许受信任的用户访问。
3.  对上传的文件进行严格的检查和验证，防止恶意代码的上传和执行。
4.  监控系统日志，及时发现和处理异常行为。

**项目地址:** [0xDTC/Pluck-CMS-v4.7.18-Remote-Code-Execution-CVE-2023-50564](https://github.com/0xDTC/Pluck-CMS-v4.7.18-Remote-Code-Execution-CVE-2023-50564)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)