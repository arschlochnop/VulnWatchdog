## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆恶意git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 允许攻击者通过构造恶意的 Git LFS 对象，当受害者克隆包含这些恶意对象的仓库时，执行任意代码。漏洞存在于 Git LFS 处理特定文件的方式中，攻击者可以通过 `git.bat` 文件进行攻击，该文件可以创建测试文件，或者通过 powershell 脚本`revsh_powersh.ps1`反弹shell。

**有效性：**

提供的PoC代码看起来是有效的，它包含了一个 `git.bat` 文件，该文件在被克隆的机器上执行，并尝试通过 PowerShell 反弹 shell 到攻击者控制的服务器上。PoC 还包含一个 `revsh_powersh.ps1` 文件，用于执行反向 shell。

**投毒风险：**

投毒风险评估为10%。虽然核心的利用代码看起来直接实现了 RCE，但是 `git.bat` 文件中执行 PowerShell 脚本存在一定的风险。攻击者可能会在 `revsh_powersh.ps1` 脚本中添加额外的恶意代码，例如安装后门，窃取凭据等。如果用户不检查 `revsh_powersh.ps1` 脚本的内容直接执行,则可能存在风险。虽然这种风险较低，但不能完全排除。

**利用方式：**

1.  攻击者创建一个包含恶意 Git LFS 对象的 Git 仓库。
2.  恶意对象包含指向 `git.bat` 文件的链接，该文件包含 PowerShell 脚本。
3.  受害者克隆该恶意仓库。
4.  当 Git LFS 尝试处理恶意对象时，会自动执行 `git.bat` 文件。
5.  `git.bat` 文件创建测试文件,并执行 PowerShell 脚本 `revsh_powersh.ps1`，从而反弹 shell 到攻击者控制的服务器上。
6.  攻击者获得受害者机器的远程访问权限。

**项目地址:** [HK69s/CVE-2020-27955](https://github.com/HK69s/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)