## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限和受影响的Sudo版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是一个存在于 Sudo 1.9.14 到 1.9.17p1 版本的本地提权漏洞。该漏洞允许本地用户通过 `--chroot` 选项和一个用户控制的 `/etc/nsswitch.conf` 文件来获取 root 权限。利用方式如下：

1.  **漏洞原理：** Sudo 在使用 `--chroot` 选项时，如果处理不当，会允许用户指定一个用户可控的目录作为新的根目录。如果用户能够控制 chroot 环境中的 `/etc/nsswitch.conf` 文件，就可以影响 Sudo 的名称服务解析行为。
2.  **利用步骤：**
    *   创建一个包含恶意配置的 `/etc/nsswitch.conf` 文件，例如，劫持 `passwd` 数据库的查找过程，指向攻击者控制的共享库。
    *   使用 `sudo --chroot` 命令，将根目录切换到攻击者创建的目录。
    *   当 Sudo 尝试解析用户名或组名时，会加载攻击者提供的恶意共享库，从而执行任意代码，提升到 root 权限。

提供的 POC 代码是一个 GitHub 仓库，其中包含利用此漏洞的说明和文件。根据 `README.md` 的描述，利用过程涉及下载和运行特定的脚本。

**有效性：** 根据漏洞描述和搜索引擎结果，该漏洞是一个已知的且具有实际影响的本地提权漏洞，存在有效的利用方法。提供的 POC 代码很可能可以成功利用该漏洞，因为仓库中包含利用说明和文件，并且有人已经发布了相应的利用代码。

**投毒风险：** 评估 POC 代码的投毒风险为 10%。这个评估基于以下考虑：
* 提供的代码库仅包含 `LICENSE` 和 `README.md` 文件，未包含可执行脚本文件。`README.md` 推荐用户从release地址下载可执行文件。
* 由于缺乏可执行文件，无法直接分析其行为。
*  但是考虑到攻击者可能会在构建或者运行 POC 时引入恶意代码，所以存在一定的投毒风险。为了降低风险，建议用户在受控环境中测试 POC 代码，并仔细审查下载的可执行文件。

**总结：** CVE-2025-32463 是一个严重的安全漏洞，允许本地用户获取 root 权限。利用方式涉及通过 `--chroot` 选项劫持名称服务解析。提供的 POC 代码可能有效，但存在轻微的投毒风险，建议谨慎使用。

**项目地址:** [92gmuz/CVE-2025-32463](https://github.com/92gmuz/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)