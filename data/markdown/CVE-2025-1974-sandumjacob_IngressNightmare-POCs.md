## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)