## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)