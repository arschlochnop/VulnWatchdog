## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要网络访问Webmin服务，默认端口10000

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107是一个存在于Webmin <= 1.920中的命令注入漏洞。该漏洞位于`password_change.cgi`文件的`old`参数中。 

**有效性：**
提供的PoC代码尝试利用该漏洞。它构造恶意的POST请求到`password_change.cgi`，并在`old`参数中插入命令。PoC代码尝试通过`echo`命令来验证漏洞的存在。

**投毒风险：**
该PoC代码的仓库中未发现明显的投毒代码。PoC代码本身旨在验证漏洞的存在，而不是植入后门或执行恶意操作。PoC中的两个curl 命令分别对应CVE-2019-15107和CVE-2019-15231两个漏洞的验证，没有发现恶意逻辑。

**利用方式：**
1.  攻击者构造一个POST请求，目标是Webmin服务器上的`password_change.cgi`脚本。
2.  在POST请求的`old`参数中，攻击者注入恶意命令。由于`old`参数未进行充分的过滤或转义，Webmin会将注入的命令作为操作系统命令执行。
3.  利用代码首先尝试利用CVE-2019-15107，然后尝试CVE-2019-15231，通过`grep`命令检查命令执行结果来判断漏洞是否存在。

综上所述，该漏洞利用代码是有效的，没有发现投毒风险，利用方式是构造恶意的HTTP请求，在`old`参数中执行系统命令。

**项目地址:** [hannob/webminex](https://github.com/hannob/webminex)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)