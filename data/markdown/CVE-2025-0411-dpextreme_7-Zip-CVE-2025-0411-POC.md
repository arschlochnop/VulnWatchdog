## CVE-2025-0411 - 7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) 绕过

**影响应用:** 7-Zip

**危害等级:** 高危，允许攻击者在用户上下文中执行任意代码

**影响版本:** 24.08 (x64)

**利用条件:** 用户必须访问恶意页面或打开恶意文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 允许远程攻击者绕过 7-Zip 中 Mark-of-the-Web (MotW) 保护机制。当从带有 MotW 的恶意压缩文件中提取文件时，7-Zip 不会将 MotW 传播到提取的文件。这允许攻击者执行任意代码，因为提取的文件不会被标记为来自不受信任的来源。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已经被积极利用。提供的 POC 代码展示了如何加载 shellcode，虽然 shellcode 部分是空的占位符，但是整个项目表明了如何通过 7-Zip 绕过 MotW 并执行代码。如果`p[]`中填充恶意代码（例如计算器或其他恶意payload），则该POC有效。

**投毒风险：**
代码本身包含一个`loader.cpp`，它负责加载和执行shellcode，shellcode 的具体内容留空，由攻击者填充。从代码结构来看，并没有明显的恶意行为（例如反调试，信息搜集等），但是因为shellcode内容留空，存在被植入恶意shellcode的潜在风险。此外，`README.md` 提供了一个下载链接，如果链接指向恶意文件，也存在投毒的风险。考虑到 shellcode 留空，以及下载链接可能被替换，所以判断存在较低的投毒风险。

**利用方式：**
1.  攻击者创建一个带有 MotW 的恶意压缩文件（例如，通过网络下载）。
2.  该压缩文件包含另一个压缩文件或可执行文件。
3.  用户使用 7-Zip 提取恶意压缩文件。
4.  7-Zip 未能将 MotW 传递给提取的文件。
5.  用户执行提取的文件（可执行文件或者二次解压），由于缺少 MotW 标记，系统不会发出警告，攻击者就可以在用户上下文中执行任意代码。
6.  利用案例中提到了双重压缩，是为了绕过某些安全工具的检测。
7.  攻击者可能使用社会工程学技术，例如伪装成正常文档，诱使用户打开该文件。
8.  攻击者可能通过鱼叉式网络钓鱼活动传播恶意文件，冒充合法来源（例如，使用同形字攻击）。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)