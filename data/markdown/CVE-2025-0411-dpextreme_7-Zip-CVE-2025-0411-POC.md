## CVE-2025-0411-7-Zip-MotW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) 绕过

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致恶意软件执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要下载并使用7-Zip打开恶意的压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 是 7-Zip 中的一个 MotW 绕过漏洞。当用户从网络下载带有 MotW 标记的恶意压缩包，并使用存在漏洞的 7-Zip 版本解压时，解压后的文件不会继承 MotW 标记。这可能导致用户在不知情的情况下执行恶意程序。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2025-0411 已经被积极利用。提供的 POC 代码仓库包含 `README.md` 和 `loader.cpp`。`README.md` 文件描述了漏洞和 POC 的基本信息，并提供了下载 POC 的链接（指向 GitHub Releases）。`loader.cpp` 文件是一个简单的 Windows 程序，用于执行 shellcode。该shellcode被注释为`//calc.exe shellcode`但是shellcode的具体内容是缺失的，这表明该POC需要用户自行填充shellcode。

**投毒风险分析：**

`README.md` 文件主要提供信息和使用说明，风险较低。`loader.cpp` 文件本身是一个简单的shellcode加载器，如果用户替换为恶意shellcode，则可能造成危害。因此，存在一定的投毒风险，但是代码本身不构成直接投毒，因为缺少 shellcode，需要用户自行插入。可以考虑有10%的投毒风险。

**利用方式：**

1.  攻击者创建一个恶意的压缩包，其中包含可执行文件（例如 `loader.exe`）和其他恶意文件。
2.  攻击者将此压缩包放置在网络共享或通过钓鱼邮件发送给目标用户。
3.  用户下载该压缩包，并且7-Zip打开。由于 CVE-2025-0411 漏洞，解压后的文件不会带有 MotW 标记。
4.  用户执行解压后的 `loader.exe` 文件，该程序加载并执行攻击者预先设置好的 shellcode，从而实现任意代码执行。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)