## CVE-2025-0411-7-Zip Mark-of-the-Web Bypass Vulnerability

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) Bypass

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户必须访问恶意网页或打开恶意文件，且目标系统安装了受影响版本的7-Zip。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411是7-Zip中的一个Mark-of-the-Web（MotW）绕过漏洞。当用户从网络下载带有MotW标记的压缩文件并使用7-Zip解压时，解压后的文件不会继承MotW标记。这使得恶意文件可以绕过Windows的安全机制，例如安全警告，从而允许攻击者在用户不知情的情况下执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的PoC代码（loader.cpp）展示了如何执行Shellcode。虽然提供的代码片段只包含一个占位符注释 "//calc.exe shellcode"，但它表明了漏洞利用的基本思路：利用7-Zip解压时MotW标记缺失的特性，将恶意代码伪装成普通文件，诱导用户执行。

**投毒风险：**

PoC代码本身`loader.cpp` 存在一定的投毒风险，因为`unsigned char p[] = {//calc.exe shellcode};` 中 `//calc.exe shellcode` 是一个注释的提示，如果攻击者将shellcode替换成其他恶意载荷,再进行传播,那么可能存在更高的安全风险。该`README.md`引导用户下载压缩包，而压缩包内是否包含其他恶意脚本需要进一步分析。

风险评估：考虑到PoC可能被用于部署恶意载荷，因此推断存在10%的投毒风险。

**利用方式：**

1.  攻击者创建一个包含恶意可执行文件或脚本的压缩文件。
2.  攻击者将此压缩文件托管在恶意网站或通过钓鱼邮件发送给目标用户。
3.  此压缩文件带有Mark-of-the-Web (MotW) 标记。
4.  用户使用受影响的7-Zip版本打开压缩文件。
5.  7-Zip解压缩文件，但没有将MotW标记传递给解压后的文件。
6.  用户运行解压后的恶意文件，从而导致任意代码执行。
7.  根据搜索结果，攻击者可能使用双重压缩和同形字攻击等技术来增加攻击的成功率。


**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)