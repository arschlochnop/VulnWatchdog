## CVE-2025-0411 7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web Bypass

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要打开恶意的压缩文件，并使用存在漏洞的7-Zip版本进行解压

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 是一个 7-Zip 的 Mark-of-the-Web (MotW) 绕过漏洞。攻击者可以创建一个包含恶意文件的压缩包，当用户下载并使用存在漏洞的 7-Zip 版本（例如 24.08 x64）解压该压缩包时，MotW 标记不会被正确传递到解压后的文件。这使得恶意文件在没有安全警告的情况下执行，从而允许攻击者执行任意代码。根据搜索结果，该漏洞已被积极利用，并被俄罗斯网络犯罪团伙用于针对乌克兰组织的鱼叉式网络钓鱼活动。PoC 代码 loader.cpp 包含 shellcode，表明该 PoC 旨在演示代码执行的可能性。投毒风险较低，因为核心漏洞在于 7-Zip 本身，PoC 提供的 shellcode 仅仅是攻击载荷。但存在将后门程序添加至shellcode的可能性。

**利用方式：**

1.  **创建恶意压缩包：** 攻击者创建一个包含恶意文件的压缩包，该压缩包会被标记为来自互联网（设置了 MotW）。
2.  **诱骗用户下载：** 攻击者通过网络钓鱼或其他手段，诱骗用户下载该压缩包。
3.  **解压压缩包：** 用户使用存在漏洞的 7-Zip 版本解压压缩包。
4.  **绕过 MotW：** 由于漏洞存在，解压后的文件不会被标记为来自互联网，因此 MotW 保护失效。
5.  **执行恶意代码：** 用户执行解压后的恶意文件，导致恶意代码在用户系统上执行。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)