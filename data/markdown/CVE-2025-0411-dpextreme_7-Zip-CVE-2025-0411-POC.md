## CVE-2025-0411 - 7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) Bypass

**影响应用:** 7-Zip

**危害等级:** 中危，用户交互后可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户必须打开恶意文件或访问恶意网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 允许攻击者绕过 7-Zip 的 Mark-of-the-Web (MotW) 保护机制。漏洞存在于 7-Zip 处理归档文件的方式中。当从带有 MotW 标记的恶意归档文件中提取文件时，7-Zip 不会将 MotW 标记传播到提取的文件。攻击者可以利用此漏洞在当前用户的上下文中执行任意代码。

根据搜索结果，该漏洞已被俄罗斯网络犯罪团伙积极利用，通过鱼叉式网络钓鱼活动针对乌克兰组织，使用同形字攻击来欺骗用户。漏洞利用涉及双重归档文件以绕过 MotW 安全机制。

POC 代码包含一个 `README.md` 文件，描述了漏洞和如何获取POC，以及 `loader.cpp`，该文件包含将 shellcode 加载到内存并执行的代码。`loader.cpp` 中 `unsigned char p[]` 数组是存放payload的地址，但是内容为空。这表明该POC需要攻击者自行添加shellcode. 考虑到提供的代码片段只是骨架，缺乏实际payload，因此投毒风险较低，但存在攻击者利用该框架植入恶意代码的可能性。

**利用方式：**

1.  **攻击者创建一个带有恶意 payload (例如，shellcode) 的归档文件。** 这个 payload 通常放在loader.cpp编译出的loader.exe文件中，然后对loader.exe进行压缩。 2.  **攻击者将此归档文件（例如，ZIP）上传到互联网上，或者通过鱼叉式网络钓鱼电子邮件发送给目标用户。该文件包含Mark of The Web (MotW)。** 3.  **用户下载并使用 7-Zip 解压此归档文件。** 4.  **7-Zip 在提取文件时未能正确传播 MotW 标记。** 5.  **解压后的文件（例如，一个包含恶意脚本或可执行文件的文件夹）在没有 MotW 保护的情况下执行，从而绕过安全机制。**由于loader.cpp编译生成的文件(loader.exe)被解压出来没有motw标记，用户双击执行，将执行其中包含的shellcode。 6.  **攻击者可以在目标系统上执行任意代码。**

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)