## CVE-2025-0411 - 7-Zip MotW Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) Bypass

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要打开恶意网页或文件，并使用受影响的7-Zip版本提取恶意制作的压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 允许攻击者绕过 7-Zip 的 MotW 保护机制。当用户从网络下载带有 MotW 标记的压缩文件后，通常 Windows 会对解压后的文件施加安全限制，防止恶意代码执行。此漏洞允许攻击者通过精心构造的压缩文件，在解压时避免 MotW 标记传播到解压后的文件，从而绕过安全限制，最终导致任意代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已在野外被利用，并且CISA KEV中包含此漏洞，说明 PoC 代码具有实际有效性。

**投毒风险：**
分析提供的PoC代码，主要包含一个`README.md`文件和一个`loader.cpp`文件。
*   `README.md`文件主要描述了漏洞和PoC的使用方法，没有发现可疑代码。
*   `loader.cpp`文件包含一段shellcode，并在运行时将其加载到内存中执行。这段shellcode 的具体内容缺失，`//calc.exe shellcode`注释表明它原本应该执行计算器程序。虽然默认情况下是无害的，但是可以被替换成任意恶意代码。

考虑到 `loader.cpp` 中 shellcode 的可替换性，存在一定的投毒风险。攻击者可以将这段 shellcode 替换为恶意代码，例如下载器或后门，从而感染用户的计算机。但是本代码中只是一个默认的计算器程序，所以投毒风险较低。

**利用方式：**
1.  攻击者创建一个包含恶意负载（例如，可执行文件）的压缩包，并使用特定的双重压缩或其它方式绕过MotW。
2.  攻击者通过钓鱼邮件、恶意网站等方式诱骗用户下载该压缩包。
3.  用户使用受影响的7-Zip版本解压该压缩包。
4.  由于漏洞的存在，解压后的恶意负载没有继承MotW标记，因此可以绕过Windows的安全保护机制。
5.  用户运行解压后的恶意负载，导致任意代码执行。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)