## CVE-2025-0411-7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web Bypass

**影响应用:** 7-Zip

**危害等级:** 中危，取决于用户操作，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要访问恶意网页或打开恶意文件，并使用7-Zip解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411 允许攻击者绕过 7-Zip 的 Mark-of-the-Web (MotW) 保护机制。该漏洞存在于 7-Zip 处理归档文件时，当从带有 MotW 标记的恶意归档文件中提取文件时，7-Zip 不会将 MotW 传播到提取的文件，从而允许恶意文件在没有安全警告的情况下执行。

**有效性：**
根据漏洞库信息、搜索结果（特别是提到 double archiving）和提供的 POC 代码，可以判断该漏洞利用的有效性较高。POC 代码仓库中包含了一个简单的 `loader.cpp` 文件，该文件编译后可执行 shellcode。结合漏洞描述，攻击者可以构造一个恶意压缩包，其中包含该 `loader.exe` （或其他恶意程序）。当用户下载并解压该压缩包时，由于 MotW 保护被绕过，`loader.exe` 会直接执行，从而执行任意代码（本例中是计算器）。

**投毒风险：**
`loader.cpp` 文件本身只是一个 shellcode 加载器，其中 shellcode 部分被故意留空。因此，不能简单地将 shellcode 加载器本身视为投毒代码。但是，如果攻击者将恶意的 shellcode 放入 `p[]` 中并提供给受害者，这会被当成一次完整的漏洞攻击，而不是投毒。该项目本身意在展示漏洞，而非直接提供恶意载荷。
仓库说明提到 “POC scenarios included in this repository are designed for educational and informational purposes only. It is important to handle these scenarios with caution and avoid using them for malicious intent.” 风险在于其他人基于此代码库创建包含恶意载荷的压缩包进行传播，但该代码仓库本身并不能直接定性为投毒。
综合考量后，认为存在一定的投毒风险，例如，该仓库可能会被恶意修改后再次发布。因此给出10%的投毒风险评估。

**利用方式：**
1.  攻击者创建一个恶意的压缩文件，例如双重压缩文件，其中包含可执行文件（如 `loader.exe` 或其他恶意程序）。
2.  攻击者通过社工手段（如鱼叉式网络钓鱼）诱骗用户下载并解压该恶意压缩文件。
3.  由于 CVE-2025-0411 漏洞，7-Zip 在解压时不会将 MotW 标记传播到提取的文件。
4.  用户执行提取的可执行文件，从而执行攻击者植入的恶意代码，例如运行 shellcode，从而实现远程代码执行。
5.  搜索引擎结果显示，该漏洞已被俄罗斯网络犯罪组织利用，通过鱼叉式网络钓鱼攻击乌克兰组织。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)