## CVE-2025-0411 7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web Bypass

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要打开恶意页面或恶意文件，并使用受影响的7-Zip版本提取文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411是7-Zip中的一个Mark-of-the-Web (MotW)绕过漏洞。当7-Zip从带有MotW的恶意压缩文件中提取文件时，不会将MotW传播到提取的文件，允许攻击者绕过安全机制执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，此漏洞已被积极利用。提供的POC代码（loader.cpp）是一个简单的shellcode加载器。它分配可执行内存，将shellcode复制到该内存中，然后执行它。`//calc.exe shellcode` 注释表明此处应放置恶意shellcode，例如用于启动计算器或其他恶意行为的shellcode. 配合精心构造的压缩包即可完成漏洞利用。

**投毒风险分析：**
POC代码本身是一个简单的加载器，是否具有投毒风险取决于`unsigned char p[]` 中填充的 shellcode。默认情况下，此处应填充calc.exe的 shellcode，以作为POC验证。如果发布者在此处填充了其他恶意代码，则具有一定的投毒风险。但由于POC通常需要使用者自行填充恶意代码，因此投毒风险较低，估计为10%。此数值代表对恶意shellcode的猜测。

**利用方式：**
1.  攻击者创建一个包含恶意可执行文件的压缩包，该压缩包被设计为利用此漏洞。
2.  攻击者将该压缩包上传到网站或通过钓鱼邮件发送给目标用户。
3.  目标用户下载压缩包并使用受影响的7-Zip版本打开它。由于漏洞的存在，提取的文件不会被标记为来自不受信任的来源（没有MotW）。
4.  用户运行提取的恶意可执行文件，从而执行攻击者的任意代码。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)