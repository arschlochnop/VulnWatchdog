## CVE-2025-0411-7-Zip Mark-of-the-Web Bypass Vulnerability

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) Bypass

**影响应用:** 7-Zip

**危害等级:** 高危，攻击者可以绕过安全警告执行任意代码。

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要访问恶意网页或打开恶意文件（例如，通过鱼叉式网络钓鱼）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411是一个存在于7-Zip中的Mark-of-the-Web (MotW)绕过漏洞。当7-Zip从带有MotW标记的恶意归档文件中提取文件时，它不会将MotW传播到提取的文件。这允许攻击者绕过安全警告，并在当前用户的上下文中执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码，该漏洞利用是有效的。搜索结果表明该漏洞已被积极利用，且CISA KEV已收录。

**投毒风险：**
提供的POC代码包含一个`loader.cpp`文件，该文件用于加载并执行shellcode。 虽然`loader.cpp`本身是为了利用漏洞而存在的，但风险点在于嵌入的shellcode(`unsigned char p[]`)。如果shellcode被替换为恶意代码，则存在投毒风险。当前`loader.cpp` 的shellcode 部分被注释，并未提供具体的shellcode内容，因此投毒的可能性相对较低，约为10%。这10%是基于仓库提供的是一个可修改的攻击脚本。如果该脚本被用于恶意目的，则可能包含恶意payload。

**利用方式：**
1.  攻击者创建一个恶意归档文件，该文件包含可执行文件或其他恶意内容，并带有Mark-of-the-Web标记。
2.  攻击者通过鱼叉式网络钓鱼、恶意网站或其他方式诱骗目标用户下载并使用7-Zip提取该恶意归档文件。
3.  由于7-Zip没有正确传播MotW标记，提取的文件不会被标记为来自不受信任的来源。
4.  用户执行提取的文件，导致恶意代码在用户的系统上执行。可以通过 double archiving files 来绕过MotW 的安全机制.

综上所述，该漏洞利用是有效的，并且存在一定的投毒风险。攻击者可以利用该漏洞绕过安全警告，并在用户的系统上执行任意代码。请务必谨慎处理来自不受信任来源的归档文件。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)