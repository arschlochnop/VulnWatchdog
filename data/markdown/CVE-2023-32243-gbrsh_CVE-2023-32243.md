## CVE-2023-32243-Essential Addons for Elementor-Privilege Escalation

**漏洞编号:** CVE-2023-32243

**漏洞类型:** 权限提升

**影响应用:** Essential Addons for Elementor

**危害等级:** 高危，可能导致账户接管

**影响版本:** 5.4.0 - 5.7.1

**利用条件:** 目标WordPress站点安装了受影响版本的Essential Addons for Elementor插件，且允许未授权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Essential Addons for Elementor插件中，允许未经身份验证的攻击者通过重置密码的方式接管用户帐户。攻击者首先通过发送POST请求到`wp-admin/admin-ajax.php`获取nonce值。然后，构造包含目标用户名、新密码以及nonce值的POST请求发送到`wp-admin/admin-ajax.php`，成功重置目标用户的密码。利用代码中的投毒风险较低，主要体现在作者可能在代码中添加了一些不必要或者混淆阅读的代码(如enumerate_users 函数)，使其运行效率降低或隐藏了一些不易察觉的后门逻辑。但总体来看,PoC是为了验证漏洞本身。

**利用方式：**

1.  **版本检测：** 检查目标网站上安装的Essential Addons for Elementor插件的版本是否在受影响的范围内（5.4.0 - 5.7.1）。
2.  **获取Nonce：** 发送一个包含`action=eael_get_token`的POST请求到`/wp-admin/admin-ajax.php`，获取用于密码重置的nonce值。
3.  **密码重置：** 构造一个包含`eael-resetpassword-submit`、`widget_id`、`page_id`、`eael-resetpassword-nonce`、`eael-pass1`、`eael-pass2`和`rp_login`参数的POST请求发送到`/wp-admin/admin-ajax.php`。其中，`rp_login`为目标用户名，`eael-pass1`和`eael-pass2`为新密码，`eael-resetpassword-nonce`为之前获取的nonce值。
4.  **登录：** 使用新密码登录目标用户的帐户。

**项目地址:** [gbrsh/CVE-2023-32243](https://github.com/gbrsh/CVE-2023-32243)

**漏洞详情:** [CVE-2023-32243](https://nvd.nist.gov/vuln/detail/CVE-2023-32243)