## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的系统

**影响版本:** 16.1.1 至 17.12.3 以及其他版本

**利用条件:** 目标系统启用了Web UI功能，且位于网络可达范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。该漏洞允许未经身份验证的攻击者通过不正确的路径验证绕过 Nginx 过滤，访问 `webui_wsma_http` Web 端点，从而可以执行任意 Cisco IOS 命令或进行配置更改，获得 Privilege 15 权限。该漏洞利用涉及两个 XML SOAP 端点：`cisco:wsma-exec` 和 `cisco:wsma-config`。攻击者可以使用 `cisco:wsma-exec` 端点将命令插入到 `execCLI` 元素标记中，例如获取运行配置或执行任意命令。攻击者还可以使用 `cisco:wsma-config` 端点添加具有 Privilege 15 的新用户。随附的 PoC 脚本提供检查漏洞、获取配置、执行命令以及添加/删除用户的功能。PoC 代码的投毒风险较低 (10%)，主要风险在于不熟悉该漏洞的人员可能意外地在生产环境中执行恶意命令，或在测试时使用了存在后门的IOS版本。脚本本身旨在利用漏洞，并且不包含任何明显的恶意或隐藏功能，仓库的README.md声明了此POC的利用方式,降低了隐藏的恶意代码的风险。

**漏洞利用方式：**

1.  **利用 CVE-2023-20198 绕过身份验证：** 攻击者构造特制的 URL 访问易受攻击的 Web UI 端点。
2.  **提升权限：** 成功绕过身份验证后，攻击者可以利用 `cisco:wsma-exec` 或 `cisco:wsma-config` SOAP接口下发命令。
3.  **创建特权用户：** 攻击者创建一个具有 Privilege 15 权限的新用户，从而获得对系统的完全控制。
4.  **执行任意命令：** 攻击者可以使用提权的会话执行任意 Cisco IOS 命令，包括安装后门、修改配置或窃取敏感信息。

**项目地址:** [sanan2004/CVE-2023-20198](https://github.com/sanan2004/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)