## CVE-2025-55188-7-Zip符号链接处理不当漏洞

**漏洞编号:** CVE-2025-55188

**漏洞类型:** 符号链接处理不当

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致任意文件写入

**影响版本:** < 25.01

**利用条件:** 需要用户解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-55188 是 7-Zip 在 25.01 之前版本中存在的一个漏洞，由于程序在提取压缩文件时对符号链接的处理不当，可能导致攻击者利用特制的压缩包，将文件写入到用户指定的任意位置。根据漏洞库信息，该漏洞的 CVSS 3.1 评分为 3.6，属于低危漏洞，但实际上，结合搜索引擎结果中的信息（如 oss-security 邮件列表），攻击者可以通过利用此漏洞进行任意文件写入，进而可能导致代码执行。

**有效性：**

根据提供的漏洞利用代码 `exploit.sh`，其原理是创建一个包含符号链接的压缩包。该脚本接受三个参数：`payload_file`（要写入的文件），`target_symlink_path`（目标路径，符号链接指向的位置），和 `output_archive`（生成的恶意压缩包）。脚本首先创建一个临时目录，并在其中创建指向 `target_symlink_path` 的符号链接。然后，将 `payload_file` 复制到符号链接指向的位置（实际上是 `target_symlink_path`）。最后，将包含符号链接的临时目录打包成 tar 文件，再使用 7-Zip 将 tar 文件压缩成最终的 `output_archive`。 当用户使用存在漏洞的 7-Zip 版本解压此压缩包时，符号链接会被错误地解析，导致 `payload_file` 的内容被写入到 `target_symlink_path` 指定的位置。 因此，提供的 POC 代码是有效的。

**投毒风险：**

分析仓库中的代码，`README.md` 文件仅包含关于如何下载和使用该工具的说明，并没有发现任何恶意代码。`exploit.sh` 脚本的功能是生成包含符号链接的压缩包，本身并不包含任何后门或者恶意行为。 但是，由于该工具可以被用于进行恶意文件写入，存在被滥用的可能。用户在使用此工具时，需要确保在受控环境下进行，且仅用于安全测试目的。 `exploit.sh` 脚本本身需要用户提供payload,可以理解为投毒的可能性很低。

**利用方式：**

1.  攻击者创建一个恶意的压缩包，其中包含指向目标位置的符号链接。
2.  攻击者诱使用户使用存在漏洞的 7-Zip 版本解压该压缩包。
3.  7-Zip 在提取压缩文件时，由于对符号链接处理不当，会将压缩包中的文件写入到符号链接指向的任意位置。
4.  攻击者可以利用此漏洞覆盖关键系统文件，或将恶意代码写入到启动目录，从而实现远程代码执行。

**项目地址:** [rhllsingh/CVE-2025-55188-7z-exploit](https://github.com/rhllsingh/CVE-2025-55188-7z-exploit)

**漏洞详情:** [CVE-2025-55188](https://nvd.nist.gov/vuln/detail/CVE-2025-55188)