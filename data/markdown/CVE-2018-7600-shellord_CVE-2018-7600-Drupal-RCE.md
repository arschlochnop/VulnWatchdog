## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)