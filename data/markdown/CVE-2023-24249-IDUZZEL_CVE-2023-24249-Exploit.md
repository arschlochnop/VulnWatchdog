## CVE-2023-24249-laravel-admin-任意文件上传

**漏洞编号:** CVE-2023-24249

**漏洞类型:** 任意文件上传

**影响应用:** laravel-admin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.8.19

**利用条件:** 需要目标系统运行laravel-admin 1.8.19，并具有可登录的管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-24249是laravel-admin v1.8.19版本中存在的一个任意文件上传漏洞。攻击者可以利用此漏洞上传恶意的PHP文件并在服务器上执行，从而实现远程代码执行。从搜索引擎的结果来看，多个来源证实了此漏洞的存在，并且漏洞细节已经被公开。

**有效性：**

提供的POC代码包含一个Python脚本，该脚本自动化了利用CVE-2023-24249的过程，包括身份验证、上传包含反向shell的PHP文件，以及执行该文件。该脚本需要`requests`和`beautifulsoup4`库，并且需要用户提供目标URL、用户名、密码、攻击者的IP地址和端口。从代码逻辑和README说明来看，该POC代码是有效的，如果目标系统存在此漏洞且配置正确，则可以成功利用。

**投毒风险：**

检查提供的`exploit.py`脚本，未发现明显的恶意代码，例如删除文件、篡改数据、植入持久性后门等。但是，由于该脚本会上传和执行PHP代码，因此存在一定的投毒风险。例如，攻击者可能修改脚本，使其上传的PHP文件不仅包含反向shell，还包含其他恶意功能，例如扫描内网、窃取数据库凭据等。尽管如此，脚本本身看起来没有被投毒，风险在于利用方式可能被滥用。

**具体分析：**

*   **许可证：** 采用MIT许可证，比较宽松，允许修改和分发。
*   **README.md：** 描述了漏洞、利用方法、所需条件和免责声明。看起来比较规范。
*   **exploit.py：**
    *   使用`requests`库发送HTTP请求，与目标系统进行交互。
    *   使用`BeautifulSoup`库解析HTML响应，提取CSRF token等信息。
    *   包含一个`BANNER`变量，用于在脚本运行时显示一个ASCII艺术标题。这部分代码本身没有危害。
    *   定义了一个`get_tokens`函数，用于从登录页面获取CSRF token。
    *   定义了一个`upload_file`函数，用于上传包含反向shell的PHP文件。
    *   定义了一个`trigger_shell`函数，用于通过GET请求触发上传的PHP文件。
    *   使用`argparse`模块解析命令行参数，包括目标URL、用户名、密码、攻击者IP和端口。
    *   脚本会先登录到目标系统，然后上传包含反向shell的PHP文件，最后通过GET请求触发该文件。整个流程较为清晰。

**投毒风险评估：** 10% ， 风险在于如果下载源被篡改，可能导致下载到投毒的EXP。

**利用方式：**

1.  **身份验证：** 利用提供的用户名和密码登录到laravel-admin后台管理界面。
2.  **上传恶意文件：** 通过文件上传功能，上传一个包含反向shell的PHP文件。
3.  **执行恶意文件：** 通过构造特定的URL，触发上传的PHP文件，执行其中的恶意代码，从而建立反向shell连接。
4.  **远程控制：** 攻击者可以通过反向shell连接控制目标服务器。

**项目地址:** [IDUZZEL/CVE-2023-24249-Exploit](https://github.com/IDUZZEL/CVE-2023-24249-Exploit)

**漏洞详情:** [CVE-2023-24249](https://nvd.nist.gov/vuln/detail/CVE-2023-24249)