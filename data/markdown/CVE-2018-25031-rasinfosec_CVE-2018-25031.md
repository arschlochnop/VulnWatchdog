## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)