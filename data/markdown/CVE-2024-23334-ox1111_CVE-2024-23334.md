## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`选项的静态文件服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为web服务器并配置静态路由时，如果设置`follow_symlinks=True`，则可能允许攻击者访问静态文件目录之外的文件。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件。

**有效性：**

根据漏洞信息和提供的POC代码，该漏洞是有效的。POC代码提供了一个简单的受害者应用程序，该应用程序使用`aiohttp.web.static`提供静态文件服务，并且设置了`follow_symlinks=True`。攻击者可以通过构造包含`../`的URL来访问服务器上的任意文件，例如访问`/static/../../../../etc/passwd`。

**投毒风险：**

提供的代码仓库包含三个文件：`README.md`、`requirements.txt`和`victim.py`。`requirements.txt`指定了`aiohttp==3.9.1`，这是一个受影响的版本。`victim.py`是漏洞利用的示例，没有包含任何恶意代码。`README.md`文件仅包含漏洞的描述、安装说明和视频链接。因此，该仓库中**没有发现任何投毒代码**，投毒风险为0%。

**利用方式：**

1.  配置aiohttp web服务器，并使用`web.static`提供静态文件服务，务必设置`follow_symlinks=True`。
2.  构造包含`../`的URL，例如`/static/../../../../etc/passwd`，其中`/static/`是静态文件路由的前缀。
3.  发送构造的URL到web服务器。
4.  如果服务器存在漏洞，则会返回`/etc/passwd`文件的内容。

**搜索引擎结果补充：**

搜索引擎结果表明，CVE-2024-23334是一个公开的漏洞，并且已经被广泛讨论。多个网站都提供了关于此漏洞的详细信息，包括漏洞描述、影响和修复方案。

**项目地址:** [ox1111/CVE-2024-23334](https://github.com/ox1111/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)