## CVE-2024-7954-SPIP Porte Plume Plugin-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码

**影响版本:** 4.3.0-alpha < 4.3.0-alpha2, 4.2.0 < 4.2.13, 4.1.0 < 4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且已安装并启用 porte_plume 插件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954 存在于 SPIP 的 porte_plume 插件中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过向 `/index.php?action=porte_plume_previsu` 发送精心构造的 HTTP POST 请求，在目标服务器上执行任意 PHP 代码。

**有效性：**
提供的 Nuclei 模板 `CVE-2024-7954.yml` 看起来有效。它发送一个包含 PHP 代码的 POST 请求到 `/index.php?action=porte_plume_previsu`，并检查响应中是否包含 `/etc/passwd` 文件的内容，以及是否包含 `Composed-By: SPIP` 头，以及状态码是否为 200。这些检查可以确认漏洞是否成功利用。

**投毒风险：**
该POC代码主要用于验证漏洞是否存在，payload 使用 `system('cat /etc/passwd')` 读取敏感文件。评估投毒风险时，需要考虑仓库作者是否在其他地方隐藏了恶意代码。根据目前的信息，主要的风险在于使用者可能会直接在生产环境中使用此POC，从而暴露敏感信息或导致其他安全问题。直接投毒风险较低，初步估计为10%。

**利用方式：**
1.  确定目标系统正在运行受影响的 SPIP 版本，并且安装并启用了 porte_plume 插件。
2.  使用提供的 Nuclei 模板或手动构造 HTTP POST 请求，将恶意 PHP 代码注入到 `data` 参数中。示例请求如下：

```
POST /index.php?action=porte_plume_previsu HTTP/1.1
Host: {{Hostname}}
Content-Type: application/x-www-form-urlencoded

data=AA_[<img111111>->URL`<?php system('cat /etc/passwd'); ?>`]_BB
```

3.  发送请求到目标服务器。
4.  如果漏洞利用成功，服务器将执行恶意 PHP 代码，并将结果返回到响应中。例如，使用 `system('cat /etc/passwd')`，攻击者将在响应中看到 `/etc/passwd` 文件的内容。

**项目地址:** [0dayan0n/RCE_CVE-2024-7954-](https://github.com/0dayan0n/RCE_CVE-2024-7954-)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)