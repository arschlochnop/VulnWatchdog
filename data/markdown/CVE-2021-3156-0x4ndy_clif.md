## CVE-2021-3156-Sudo-Heap-Based Buffer Overflow

**漏洞编号:** CVE-2021-3156

**漏洞类型:** Heap-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.9.5p2

**利用条件:** 本地用户可执行sudo命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3156，又名Baron Samedit，是一个存在于Sudo 1.9.5p2之前版本中的堆缓冲区溢出漏洞。该漏洞允许本地用户通过利用`sudoedit -s`命令以及一个以单反斜杠字符结尾的命令行参数，将权限提升到root。

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞是有效的。搜索结果中的多个网页都提到了该漏洞，并确认它允许权限提升到root。漏洞库信息中也明确指出了该漏洞是一个堆缓冲区溢出，可以通过特定的方式触发。

**投毒风险：** 提供的漏洞利用代码看起来像是一个 `Cargo.lock` 文件，这个文件是 Rust 项目依赖管理的一部分。它本身不包含任何可执行代码，只是记录了项目依赖项的版本信息和校验和。因此，此仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：** 该漏洞的利用方式涉及到向`sudoedit -s`命令传递一个以单反斜杠结尾的精心构造的命令行参数。这个参数会导致Sudo在处理命令行参数时出现一个off-by-one错误，从而导致堆缓冲区溢出。通过控制溢出的内容，攻击者可以覆盖堆上的数据结构，最终实现权限提升。

根据搜索结果，利用该漏洞通常不需要任何特殊的配置或权限，只需要一个可以执行sudo的本地用户即可。这使得该漏洞非常容易被利用。

**项目地址:** [0x4ndy/clif](https://github.com/0x4ndy/clif)

**漏洞详情:** [CVE-2021-3156](https://nvd.nist.gov/vuln/detail/CVE-2021-3156)