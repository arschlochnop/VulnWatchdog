## CVE-2022-3782-Keycloak-路径遍历

**漏洞编号:** CVE-2022-3782

**漏洞类型:** 路径遍历

**影响应用:** Keycloak

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 20.0.2

**利用条件:** 客户端使用带有通配符的Valid Redirect URIs字段

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2022-3782 是 Keycloak 中的一个路径遍历漏洞。由于 Keycloak 没有正确验证重定向 URL 中的 URL，攻击者可以构造一个恶意请求来绕过验证，访问其他 URL，并可能访问域内的敏感信息。此漏洞影响所有在 Valid Redirect URIs 字段中使用通配符的客户端。

**有效性：**
从提供的漏洞信息和搜索结果来看，该漏洞确实存在于 Keycloak <= 20.0.2 版本中。 但是，提供的“漏洞利用代码”实际上是 Keycloak 项目的 ADOPTERS.md 和 CONTRIBUTING.md 文件内容，并非真正的漏洞利用代码，因此无法直接验证其有效性。需要根据漏洞原理构造特定的恶意请求。

**投毒风险：**
提供的代码只是项目文档，不存在投毒风险。

**利用方式：**
攻击者利用此漏洞，通常需要以下步骤：
1.  找到一个 Keycloak 实例，该实例启用了在 `Valid Redirect URIs` 字段中使用通配符的客户端。
2.  构造一个包含双重 URL 编码的恶意重定向 URL。例如，`https://example.com/%%2e%%2e/%%2e%%2e/sensitive-file`。
3.  将构造的恶意 URL 作为 `redirect_uri` 参数发送到 Keycloak 的授权端点。
4.  如果 Keycloak 没有正确解码和验证 URL，则会将用户重定向到攻击者指定的恶意 URL，从而可能允许攻击者访问服务器上的敏感文件。

**项目地址:** [shoucheng3/keycloak__keycloak_CVE-2022-3782_20-0-1](https://github.com/shoucheng3/keycloak__keycloak_CVE-2022-3782_20-0-1)

**漏洞详情:** [CVE-2022-3782](https://nvd.nist.gov/vuln/detail/CVE-2022-3782)