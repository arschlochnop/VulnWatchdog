## CVE-2022-3782-Keycloak-路径遍历

**漏洞编号:** CVE-2022-3782

**漏洞类型:** 路径遍历

**影响应用:** Keycloak

**危害等级:** 高危，可能导致敏感信息泄露和进一步攻击

**影响版本:** < 20.0.2

**利用条件:** 客户端配置了使用通配符的Valid Redirect URIs

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2022-3782是Keycloak中的一个路径遍历漏洞，源于Keycloak没有正确验证重定向URL中包含的URL。攻击者可以构造恶意请求绕过验证，访问其他URL，并可能访问域内的敏感信息或进行进一步攻击。该漏洞影响任何在Valid Redirect URIs字段中使用通配符的客户端。根据漏洞信息和搜索结果，该漏洞是由于Keycloak在处理重定向URI时未进行充分的URL解码，特别是双URL编码。攻击者可以利用这一点，通过在重定向URI中插入包含路径遍历序列（如`..`）的编码URL，绕过验证并访问受限资源。提供的漏洞利用代码并非直接的PoC，而是Keycloak项目的ADOPTERS.md和CONTRIBUTING.md文件，无法直接用于验证漏洞。因此，需要构造特定的恶意请求进行测试。

**利用方式：**

1.  **利用条件：** 客户端必须配置了使用通配符的`Valid Redirect URIs`。
2.  **攻击步骤：** 攻击者构造包含双URL编码路径遍历序列的恶意重定向URI。
3.  **服务器行为：** Keycloak服务器尝试重定向到攻击者构造的URI，但由于未正确处理双URL编码，路径遍历序列生效。
4.  **攻击结果：** 攻击者可能能够访问服务器上的敏感文件或执行其他未经授权的操作。

**关于投毒风险：**

提供的代码片段（ADOPTERS.md和CONTRIBUTING.md）是Keycloak项目的文档文件，不包含可执行代码，因此不存在投毒风险。因此投毒风险为0%。

**项目地址:** [shoucheng3/keycloak__keycloak_CVE-2022-3782_20-0-1](https://github.com/shoucheng3/keycloak__keycloak_CVE-2022-3782_20-0-1)

**漏洞详情:** [CVE-2022-3782](https://nvd.nist.gov/vuln/detail/CVE-2022-3782)