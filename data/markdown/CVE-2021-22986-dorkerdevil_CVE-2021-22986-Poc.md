## CVE-2021-22986-F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3；BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP/BIG-IQ版本，且允许通过网络访问iControl REST接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22986 漏洞存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中。攻击者可以利用此漏洞在未经身份验证的情况下远程执行命令。根据漏洞库信息，受影响的版本包括 BIG-IP 的 16.0.x 之前版本 16.0.1.1，15.1.x 之前版本 15.1.2.1，14.1.x 之前版本 14.1.4，13.1.x 之前版本 13.1.3.6，以及 12.1.x 之前版本 12.1.5.3，以及 BIG-IQ 的 7.1.0.x 之前版本 7.1.0.3 和 7.0.0.x 之前版本 7.0.0.2。搜索引擎结果表明该漏洞已被积极利用。提供的 POC 代码包含多个 curl 命令，用于利用该漏洞。其中一种利用方式是利用`filePath`参数执行命令，另一种是利用`/mgmt/tm/util/bash` 接口。目前没有明显的投毒代码的迹象，该仓库中的代码主要为了验证漏洞的存在。

**利用方式分析:**

1.  **利用filePath参数:**
    *   攻击者发送包含恶意 `filePath` 参数的请求到 `/mgmt/tm/access/bundle-install-tasks` 接口。
    *   由于未授权的访问控制缺陷，系统将执行 `filePath` 参数中包含的命令。
    *   `id` 命令被用作示例，但攻击者可以执行任何其他命令。

2.  **利用 /mgmt/tm/util/bash 接口:**
    *   攻击者发送包含 `command` 和 `utilCmdArgs` 参数的 JSON 数据到 `/mgmt/tm/util/bash` 接口。
    *   `command` 设置为 "run"，`utilCmdArgs` 包含要执行的命令（例如，`-c id`）。
    *   系统执行 `utilCmdArgs` 中指定的命令。

**有效性:**
根据漏洞信息、搜索结果以及 POC 代码，该漏洞的利用是有效的。搜索结果也表明此漏洞在野外已被积极利用。


**项目地址:** [dorkerdevil/CVE-2021-22986-Poc](https://github.com/dorkerdevil/CVE-2021-22986-Poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)