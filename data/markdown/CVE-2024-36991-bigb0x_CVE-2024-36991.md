## CVE-2024-36991-Splunk Enterprise on Windows-路径遍历

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise on Windows

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**利用条件:** 需要网络访问 Splunk Enterprise 的/modules/messaging/ 端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36991是Splunk Enterprise on Windows版本中的一个路径遍历漏洞。攻击者可以利用`/modules/messaging/`端点，通过构造包含`../`的恶意路径，读取服务器上的任意文件。根据漏洞信息和搜索结果，该漏洞影响9.2.2之前的所有9.2.x版本，9.1.5之前的所有9.1.x版本，以及9.0.10之前的所有9.0.x版本。

**利用方式：**

1.  攻击者发送包含恶意路径的HTTP GET请求到`/modules/messaging/`端点。
2.  恶意路径利用`../`序列尝试跳出预期的目录。
3.  如果路径遍历成功，服务器将返回指定文件的内容。

例如，POC代码中使用的payload是`/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`，该payload尝试读取Windows系统的`/etc/passwd`文件。

**有效性：**

提供的POC代码是有效的，因为它利用了路径遍历漏洞读取`/etc/passwd`文件，如果能成功读取，则表明目标存在漏洞。

**投毒风险：**

POC代码本身主要执行漏洞验证和利用，读取/etc/passwd文件。 代码中存在日志记录功能，可能会泄露扫描目标。理论上，作者可以在代码中插入恶意代码，例如：

*   **数据回传：**  将扫描结果（包括存在漏洞的主机列表和读取的文件内容）发送到攻击者的服务器。
*   **反弹shell：**  尝试在目标主机上执行恶意命令，例如反弹shell。
*   **植入后门：**  修改目标主机上的配置文件或安装恶意软件，以便长期控制目标主机。
虽然没有直接证据表明存在投毒代码，但以下因素增加了投毒的可能性：代码来自个人开发者，且未经过严格的安全审计。代码使用了`requests`库，存在潜在的安全风险。因此，存在投毒的可能, 但概率较低， 估计在10%左右。 为了降低风险，建议在使用POC代码之前，进行代码审计，确保代码的安全性。

**项目地址:** [bigb0x/CVE-2024-36991](https://github.com/bigb0x/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)