## CVE-2024-54761-BigAnt Office Messenger-SQL注入

**漏洞编号:** CVE-2024-54761

**漏洞类型:** SQL注入

**影响应用:** BigAnt Office Messenger

**危害等级:** 高危，可远程代码执行

**影响版本:** 5.6.06

**利用条件:** 需要目标服务器开放Web服务，且存在漏洞的dev_code参数可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-54761是BigAnt Office Messenger 5.6.06版本中存在的一个SQL注入漏洞，该漏洞位于`dev_code`参数中。根据提供的漏洞利用代码，攻击者可以利用该漏洞读取数据库版本信息，并进一步通过SQL语句将PHP Webshell写入服务器的Web目录下，最终实现远程代码执行。

**有效性：**
根据漏洞利用代码，提供的POC代码是有效的。它展示了如何利用SQL注入读取数据库版本，以及如何写入Webshell并执行命令。提供的图片也佐证了其有效性。

**投毒风险：**
虽然POC本身是为了演示漏洞，但仍然存在一定的投毒风险。因为webshell上传之后权限属于目标服务器权限,如果目标服务器权限过大，可能导致服务器被完全控制，风险较高。此风险无法通过静态分析完全确认，需要动态调试来分析具体影响。初步估计投毒风险在10%左右。

**利用方式：**
1.  **信息收集：** 利用SQL注入获取数据库版本等信息，为后续利用做准备。
2.  **写入Webshell：** 通过SQL的`INTO OUTFILE`语句，将包含恶意PHP代码的Webshell写入到目标服务器的Web目录下。此步骤需要数据库用户具有文件写入权限。
3.  **远程代码执行：** 访问上传的Webshell，通过GET请求传递命令参数，执行任意系统命令。

**项目地址:** [nscan9/CVE-2024-54761](https://github.com/nscan9/CVE-2024-54761)

**漏洞详情:** [CVE-2024-54761](https://nvd.nist.gov/vuln/detail/CVE-2024-54761)