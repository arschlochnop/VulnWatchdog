## CVE-2020-13777-GnuTLS会话票证漏洞

**漏洞编号:** CVE-2020-13777

**漏洞类型:** 身份验证绕过/信息泄露

**影响应用:** GnuTLS

**危害等级:** 高危，可能导致TLS 1.2中机密性丧失以及TLS 1.3中身份验证绕过

**影响版本:** 3.6.x (3.6.4 - 3.6.13)

**利用条件:** 服务器使用受影响的GnuTLS版本，并且使用了会话票证功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-13777是GnuTLS 3.6.4到3.6.13版本中的一个漏洞，该漏洞影响了会话票证的加密方式。在密钥轮换之前，服务器会使用错误的数据（全零密钥）来加密会话票证，导致TLS 1.2中的机密性丧失，攻击者可以解密票证，以及TLS 1.3中的身份验证绕过，攻击者可以重用票证。利用方式如下：

1.  **捕获会话票证：** 攻击者首先需要捕获服务器颁发的存在漏洞的会话票证，这可以通过中间人攻击或者监听网络流量实现。
2.  **解密会话票证 (TLS 1.2)：** 由于加密密钥是已知的（全零），攻击者可以解密票证内容。
3.  **重用会话票证 (TLS 1.3)：** 攻击者可以使用捕获的会话票证，在未经授权的情况下恢复TLS会话，从而绕过身份验证。

提供的漏洞利用代码是Zeek脚本，用于检测网络流量中是否存在利用此漏洞的服务器。脚本通过检查会话票证的前16个字节是否为零来判断服务器是否可能存在漏洞。该脚本的有效性取决于其检测能力，即能否准确识别使用存在漏洞的GnuTLS版本的服务器。由于该脚本只是用于检测，所以不存在直接的利用代码。该Zeek脚本主要用于判断服务器是否存在漏洞，辅助进行漏洞验证。

**投毒风险分析：**

该Zeek脚本的投毒风险较低，主要原因是：

*   **脚本功能单一：** 脚本的主要功能是检测CVE-2020-13777漏洞，没有执行恶意操作的代码。
*   **代码可读性高：** Zeek脚本的代码相对简单易懂，易于审查，因此隐藏恶意代码的难度较高。
*   **NOTICE事件：** 脚本通过生成`NOTICE`事件来报告潜在的漏洞，`NOTICE`事件通常会被记录在日志中，方便管理员进行审计。

尽管如此，仍然存在一定的投毒风险。例如，攻击者可以修改脚本，使其在特定条件下误报，或者添加额外的逻辑来记录用户的网络流量。因此，在使用该脚本时，建议进行代码审查，并确保从可信的来源获取。

综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，估计为5%。

**项目地址:** [0xxon/cve-2020-13777](https://github.com/0xxon/cve-2020-13777)

**漏洞详情:** [CVE-2020-13777](https://nvd.nist.gov/vuln/detail/CVE-2020-13777)