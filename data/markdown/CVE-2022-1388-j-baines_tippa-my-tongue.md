## CVE-2022-1388 & CVE-2022-41800 F5 BIG-IP RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions

**利用条件:** 目标系统运行在受影响的 F5 BIG-IP 版本上，并且可以网络访问 iControl REST API。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 存在的一个身份验证绕过漏洞。攻击者可以发送特制的请求绕过身份验证，从而执行未经授权的操作。该漏洞允许未经身份验证的攻击者通过 iControl REST 接口执行任意代码，从而完全控制受影响的系统。提供的POC利用了 CVE-2022-1388 绕过身份验证，并结合 CVE-2022-41800 (可能指的是利用 rpm-spec-creator 和 build-package 方式进行命令注入)来在目标系统上建立 root 权限的 reverse shell。  利用过程包含向 `/mgmt/shared/iapp/rpm-spec-creator` 发送初始请求，然后向 `/mgmt/shared/iapp/build-package` 发送 exploit 请求以执行命令。虽然代码本身看起来合法，但依然存在极小的投毒风险（5%），因为攻击者可能通过修改 reverse shell 连接的目标地址来达到攻击其他系统的目的，或者在rpm构建过程中执行一些不期望的代码。然而，该POC主要关注于利用漏洞本身，而不是植入恶意代码或后门。

利用方式：
1.  利用 CVE-2022-1388 绕过 iControl REST API 的身份验证。
2.  使用 `/mgmt/shared/iapp/rpm-spec-creator` 创建一个 RPM 规范文件。
3.  使用 `/mgmt/shared/iapp/build-package` 构建 RPM 包，并在构建过程中执行任意命令，从而建立反向 shell。

搜索引擎结果显示该漏洞已被广泛利用，CISA也发布了相关安全公告，建议立即修复。

**项目地址:** [j-baines/tippa-my-tongue](https://github.com/j-baines/tippa-my-tongue)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)