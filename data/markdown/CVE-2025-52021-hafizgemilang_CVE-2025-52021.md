## CVE-2025-52021 - Online Shopping System Advanced - Time-Based Blind SQL Injection

**漏洞编号:** CVE-2025-52021

**漏洞类型:** Time-Based Blind SQL Injection

**影响应用:** Online Shopping System Advanced

**危害等级:** 高危，可能导致数据泄露

**影响版本:** 1.0

**利用条件:** admin/admin/edit_product.php 页面可访问，且 product_id 参数未进行充分的验证和参数化。

**POC 可用性:** 是 (但完整PoC未公开，仅提供高层次描述和sqlmap命令)

**投毒风险:** 10%

## 详情

该漏洞存在于Online Shopping System Advanced v1.0 的 admin/admin/edit_product.php 页面。通过 GET 参数 product_id 注入恶意的 SQL 代码，利用 time-based blind SQL injection 的方式，攻击者可以根据服务器响应时间来判断注入的 SQL 语句是否执行成功。由于完整 PoC 被作者有意省略，只提供了一个 sqlmap 命令， 仓库本身只是一个漏洞报告， 因此直接投毒的可能性较低。 但不排除作者可能在其他提交或相关文件中植入恶意代码的可能性， 但就当前提供的README.md文件来说，投毒风险较低。

**利用方式：**

1.  攻击者构造包含 `SLEEP()` 函数或其他时间延迟函数的恶意 `product_id` 参数。
2.  将构造的 URL 发送到易受攻击的 `edit_product.php` 页面。
3.  根据服务器响应时间，判断 SQL 注入是否成功。
4.  使用 sqlmap 等工具自动化提取数据。

**示例利用URL：**

`http://<host>/online-shopping-system-advanced-master/admin/admin/edit_product.php?product_id=0 AND SLEEP(5)`  (其中`<host>`需要替换成实际的服务器地址)

**缓解措施：**

*   使用参数化查询或预处理语句。
*   对用户输入进行验证和过滤。
*   最小权限原则。
*   避免泄露数据库错误信息。
*   使用 WAF 和速率限制进行缓解。
*   审计其他相关接口。

**项目地址:** [hafizgemilang/CVE-2025-52021](https://github.com/hafizgemilang/CVE-2025-52021)

**漏洞详情:** [CVE-2025-52021](https://nvd.nist.gov/vuln/detail/CVE-2025-52021)