## CVE-2023-35078 - Ivanti EPMM 身份验证绕过

**漏洞编号:** CVE-2023-35078

**漏洞类型:** 身份验证绕过

**影响应用:** Ivanti Endpoint Manager Mobile (EPMM)

**危害等级:** 高危，未经授权访问受限功能或资源，可能导致数据泄露和远程代码执行

**影响版本:** <= 11.10.0.1, 11.9.1.0, 11.8.1.0 (受影响版本小于 11.10.0.2, 11.9.1.1, 11.8.1.1)

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-35078 是 Ivanti Endpoint Manager Mobile (EPMM) 中的一个身份验证绕过漏洞。攻击者可以通过未经身份验证的 API 访问来利用此漏洞，从而访问受限功能或资源。漏洞利用代码 (CVE-2023-35078.sh) 提供了一种检测目标是否易受攻击的方法，它通过检查特定的 API 路径和版本信息来判断。该脚本首先尝试从 `/mifs/c/windows/api/v2/device/registration` 获取确切的版本信息，如果失败，则检查网页标题中的版权年份。基于版本或版权年份来判断目标是否容易受到攻击。虽然该脚本本身主要用于检测漏洞，但可以修改为利用该漏洞，例如，通过向 `/mifs/aad/...` 路径发送恶意请求来访问受限 API。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被积极利用。提供的 POC 代码用于检测漏洞是否存在，可以确定目标系统是否运行着存在漏洞的 Ivanti EPMM 版本。因此，POC 代码具有一定的有效性。

**投毒风险：** 分析了提供的 shell 脚本和 LICENSE 文件。没有发现明显的恶意代码或者后门。脚本的功能是检测目标系统版本，并根据版本号判断是否存在漏洞。LICENSE 文件是 GNU GPL v3，是常见的开源许可证。因此，投毒风险较低，但不能完全排除，因为即使在检查版本更新过程中，服务器返回恶意版本信息也可被利用。 脚本中 `curl` 命令可能存在潜在的风险，如果攻击者可以控制 DNS 解析或中间人攻击，则可能将流量重定向到恶意服务器。因此，综合来看，投毒风险约为 10%。

**利用方式：** 漏洞的利用方式是未经身份验证访问受保护的 API 端点。攻击者可以使用特制的 HTTP 请求绕过身份验证机制，然后执行未经授权的操作。 具体利用方式通常涉及构造特定的 URL 和请求参数，以访问诸如 `/mifs/aad/api/v2/admins/users` 之类的受保护的API路径。成功利用此漏洞可能允许攻击者获取敏感信息、修改系统配置或执行其他恶意操作。

**项目地址:** [lager1/CVE-2023-35078](https://github.com/lager1/CVE-2023-35078)

**漏洞详情:** [CVE-2023-35078](https://nvd.nist.gov/vuln/detail/CVE-2023-35078)