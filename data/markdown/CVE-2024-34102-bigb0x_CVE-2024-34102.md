## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Adobe Commerce/Magento

**危害等级:** 高危，可能导致任意代码执行、敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，无需用户交互，未授权即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce/Magento 中的一个严重的 XML 外部实体注入 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，引用外部实体来利用此漏洞，从而可能导致任意代码执行和敏感信息泄露。

**有效性：**
提供的POC代码尝试读取目标主机上的文件（默认为 /etc/passwd）。它通过创建一个包含 XXE 载荷的 poc.xml 文件，然后通过 POST 请求将其发送到目标。POC 还在攻击者机器上设置一个监听器，以接收来自目标机器的 GET 请求，从而读取文件内容。

**投毒风险：**
该POC代码的主要功能是利用XXE漏洞读取文件，没有明显的恶意代码。但是，由于POC需要攻击者指定IP地址和端口，并在目标机器上执行请求，**存在潜在的风险**：
1.  **依赖外部资源:** 如果攻击者指定的IP地址上的服务被篡改或关闭，POC可能无法正常工作，或者可能被重定向到恶意站点。
2.  **日志记录:** 虽然 POC 本身似乎没有恶意代码，但是部署恶意修改过的版本相对简单，例如添加额外的请求或记录用户输入。
3.  **HTTP服务风险:** 临时开启的HTTP服务可能存在安全隐患，虽然代码相对简单，但也可能被滥用。

由于以上潜在风险,因此判断存在10%的投毒风险, 即使POC的主要功能是演示漏洞，也无法保证在实际使用中不会被恶意利用。

**利用方式：**
1.  攻击者构造包含恶意外部实体引用的 XML 文档。
2.  攻击者将构造的 XML 文档作为 POST 请求发送到易受攻击的 Adobe Commerce/Magento 实例。
3.  目标服务器解析 XML 文档时，会尝试解析外部实体。
4.  利用 XXE，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**排序优先级结果依据:**
1. **搜索引擎结果:** 多个搜索结果确认了该漏洞的存在，并提供了漏洞的详细信息和利用方式。
2. **漏洞利用代码:** 提供的POC代码演示了如何利用该漏洞读取文件。
3. **漏洞库信息:** 漏洞库信息确认了该漏洞的影响范围和严重程度。

**项目地址:** [bigb0x/CVE-2024-34102](https://github.com/bigb0x/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)