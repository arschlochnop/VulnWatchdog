## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致系统崩溃或远程代码执行

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11和Windows Server 2008到2022的特定版本。

**利用条件:** 需要目标系统启用IPv6。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38063是一个Windows TCP/IP远程代码执行漏洞。攻击者可以通过发送特制的IPv6数据包触发此漏洞，从而在目标系统上执行任意代码或造成拒绝服务。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是真实存在的，且具有较高的严重性(CVSS评分9.8)。搜索结果中多个来源（例如Picus Security, Strobes, SonicWall, MalwareTech, Orca Security）确认了该漏洞的存在，并描述了其影响和利用方式。漏洞利用代码包含用于检查目标系统是否易受攻击的脚本 (checker.bat, exploit.ps1) 和用于实际利用漏洞的Python脚本 (exploit.py)。因此，可以判断提供的POC代码具有一定的有效性。

**投毒风险分析：**
提供的代码中存在潜在的投毒风险，虽然主体代码似乎是用于验证和利用CVE-2024-38063漏洞，但在`exploit.ps1`和`exploit.py`脚本中，目标IP地址(`sDstIP`, `$dstIP`)和MAC地址(`sDstMAC`, `$dstMAC`)均为硬编码。如果用户不小心直接运行这些脚本，可能会导致对非预期目标进行攻击。此外，`exploit.ps1`脚本中使用了`nping`工具，如果用户没有安装该工具，脚本会报错，这可能会给一些缺乏经验的用户造成困扰。`exploit.py`脚本使用了scapy库，该库功能强大，但如果使用不当，也可能导致意外的系统行为。

**利用方式分析：**
1.  **检查漏洞：** 使用checker.bat或exploit.ps1检查目标系统是否受CVE-2024-38063影响。
2.  **获取目标信息：** 获取目标系统的IPv6地址和MAC地址（如果需要）。
3.  **发送恶意数据包：** 使用exploit.py或exploit.ps1中调用的nping工具发送特制的IPv6数据包到目标系统。这些数据包旨在触发TCP/IP协议栈中的整数下溢漏洞（CWE-191）。
4.  **执行代码或造成DoS：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码或导致系统崩溃(DoS)。

综上所述，尽管提供的POC代码可以用于验证和利用CVE-2024-38063，但用户需要谨慎操作，避免攻击非预期目标或执行恶意代码。因此，我判断投毒风险为10%，主要是由于硬编码的目标地址和潜在的误用风险。

**项目地址:** [idkwastaken/CVE-2024-38063](https://github.com/idkwastaken/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)