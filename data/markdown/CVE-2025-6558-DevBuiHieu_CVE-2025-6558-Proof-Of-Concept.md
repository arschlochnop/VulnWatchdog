## CVE-2025-6558 - Google Chrome ANGLE and GPU Improper Input Validation Vulnerability

**漏洞编号:** CVE-2025-6558

**漏洞类型:** 沙箱逃逸

**影响应用:** Google Chrome

**危害等级:** 高危，可能导致沙箱逃逸和远程代码执行

**影响版本:** < 138.0.7204.157

**利用条件:** 用户需要访问包含恶意JavaScript代码的HTML页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6558是Google Chrome浏览器中ANGLE和GPU组件中由于未充分验证不可信输入而导致的漏洞。攻击者可以通过构造恶意的HTML页面，利用WebGL API，并结合顶点着色器和片元着色器，通过transform feedback操作，注入一个伪造的浮点数指针，并进行内存泄漏尝试，最终实现沙箱逃逸。这个漏洞的PoC代码通过创建一个canvas元素，获取WebGL2上下文，编译并链接顶点着色器和片元着色器，创建一个顶点缓冲区并绑定伪造的浮点数数据。随后，代码创建一个transform feedback缓冲区，并启用RASTERIZER_DISCARD来阻止像素输出，然后使用drawArrays触发transform feedback操作，利用漏洞进行内存泄漏。最后，读取transform feedback缓冲区的内容并将其解释为地址，从而实现信息泄露。由于该PoC直接展示了漏洞触发过程和内存泄漏，没有发现任何额外的、非必要的功能或代码，因此可以判断投毒风险较低。PoC通过检查gl.getError()返回值判断漏洞是否已被修复。

**漏洞利用方式：**

1.  **攻击者构造恶意的HTML页面：** 该页面包含利用WebGL的JavaScript代码。
2.  **用户访问恶意页面：** 用户使用存在漏洞的Chrome版本访问该页面。
3.  **WebGL上下文初始化：**  PoC初始化WebGL2上下文。
4.  **Shader编译和链接：** PoC编译顶点和片元着色器，创建一个程序并链接它们。
5.  **顶点数据注入：** PoC创建一个包含伪造浮点数指针的顶点缓冲区。
6.  **Transform Feedback利用：** PoC利用transform feedback特性，在缓冲区之间拷贝数据，尝试泄漏内存地址。
7.  **数据读取和解析：** PoC读取transform feedback缓冲区的内容，并将其解析为内存地址。
8.  **沙箱逃逸：** 通过泄漏的内存地址，攻击者可以进一步进行沙箱逃逸攻击。

**项目地址:** [DevBuiHieu/CVE-2025-6558-Proof-Of-Concept](https://github.com/DevBuiHieu/CVE-2025-6558-Proof-Of-Concept)

**漏洞详情:** [CVE-2025-6558](https://nvd.nist.gov/vuln/detail/CVE-2025-6558)