## CVE-2025-22963-Teedy-CSRF账户接管

**漏洞编号:** CVE-2025-22963

**漏洞类型:** 跨站请求伪造 (CSRF)

**影响应用:** Teedy

**危害等级:** 高危，可导致账户接管

**影响版本:** <= 1.11

**利用条件:** 用户已登录Teedy，攻击者诱导用户访问恶意网站

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22963存在于Teedy 1.11及更早版本中，是一个跨站请求伪造（CSRF）漏洞。该漏洞允许攻击者通过诱骗已认证用户访问恶意网站，从而代表用户执行未授权的操作，例如更改账户信息（包括密码），最终导致账户接管。

**有效性：**

提供的PoC代码有效。它展示了一个针对`/api/user/admin`端点的POST请求，该请求缺少CSRF令牌验证。攻击者可以构造包含恶意负载的HTML页面，当受害者在登录Teedy的情况下访问此页面时，浏览器会自动发送带有受害者cookie的POST请求到Teedy服务器，从而修改受害者的帐户。

**投毒风险：**

PoC代码仓库的投毒风险较低，约为5%。主要风险在于提供的修复方案代码片段可能存在隐藏的漏洞或后门，但评估下来，可能性较低。

**利用方式：**

1.  攻击者构造一个包含恶意POST请求的HTML页面。此POST请求的目标是Teedy服务器的`/api/user/admin`端点，并包含攻击者想要设置的账户信息（例如新的密码）。
2.  攻击者诱骗已登录Teedy的受害者访问此恶意HTML页面。
3.  当受害者访问该页面时，浏览器会自动发送带有受害者cookie的POST请求到Teedy服务器。
4.  由于Teedy服务器缺乏有效的CSRF保护，它会接受此请求并更改受害者的帐户信息。
5.  攻击者可以使用新设置的密码登录受害者的帐户。

**总结：**

CVE-2025-22963是一个严重的安全漏洞，可能导致Teedy用户的账户被接管。Teedy应该尽快发布补丁，以修复此漏洞。用户应该避免访问来自未知来源的链接，并且及时更新Teedy版本。

**项目地址:** [gmh5225/CVE-2025-22963](https://github.com/gmh5225/CVE-2025-22963)

**漏洞详情:** [CVE-2025-22963](https://nvd.nist.gov/vuln/detail/CVE-2025-22963)