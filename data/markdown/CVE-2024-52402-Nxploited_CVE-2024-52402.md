## CVE-2024-52402-Exclusive Content Password Protect-CSRF to Arbitrary File Upload

**漏洞编号:** CVE-2024-52402

**漏洞类型:** CSRF to Arbitrary File Upload

**影响应用:** Exclusive Content Password Protect

**危害等级:** 高危，允许攻击者上传webshell到服务器，可能导致远程代码执行

**影响版本:** <= 1.1.0

**利用条件:** 需要目标WordPress站点安装存在漏洞的插件，并需要诱骗已登录的管理员点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-52402是WordPress Exclusive Content Password Protect插件1.1.0及更早版本中的一个跨站请求伪造（CSRF）漏洞。攻击者可以利用此漏洞诱骗已登录的管理员执行恶意操作，例如上传webshell。根据提供的漏洞利用代码，攻击者需要提供目标WordPress站点的URL，有效的WordPress用户名和密码。脚本首先尝试登录到WordPress站点，然后尝试上传一个名为`nxploit.php`的webshell到`/wp-content/uploads/`目录。该webshell包含简单的代码执行功能，允许通过`cmd`参数执行任意命令。尽管该POC的主要功能是利用CSRF漏洞上传webshell，但其登录过程使用了明文密码，存在一定风险。此外，代码中硬编码了webshell文件名`nxploit.php`和webshell代码，这在一定程度上降低了其隐蔽性，可以作为潜在的投毒风险指标，但不构成直接的恶意投毒行为，因此判断投毒风险为10%。利用方式总结：1. 攻击者构造一个包含恶意请求的HTML页面。2. 诱骗已登录的WordPress管理员访问该页面。3. 管理员的浏览器在未经授权的情况下向WordPress站点发送请求，上传webshell。4. 攻击者通过webshell执行任意命令。

**项目地址:** [Nxploited/CVE-2024-52402](https://github.com/Nxploited/CVE-2024-52402)

**漏洞详情:** [CVE-2024-52402](https://nvd.nist.gov/vuln/detail/CVE-2024-52402)