## CVE-2024-4956-Sonatype Nexus Repository 3-路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository 3

**危害等级:** 高危，可读取系统文件

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository 3 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造包含路径遍历序列的 URL 来读取服务器上的任意文件。漏洞存在于所有 3.x 版本直到 3.68.0（包含 3.68.0）。

**有效性：**

提供的 POC 代码利用了该漏洞。它通过构造一个包含多个 `..` 序列的 URL，尝试访问文件系统上的任意文件。如果服务器存在漏洞，则会返回文件的内容。

**投毒风险：**

分析了提供的 Python 脚本（CVE-2024-4956.py）和 README.md 文件。

*   **CVE-2024-4956.py:** 该脚本的主要功能是发送 HTTP GET 请求到目标 Nexus Repository 服务器，请求中包含经过编码的路径遍历 payload。脚本包含基本的错误处理，并在响应中检查 "Not Found" 字符串以确定文件是否存在。没有发现任何明显的恶意代码或后门。脚本的功能与其描述的功能一致，即利用 CVE-2024-4956 进行本地文件包含（LFI）。
*   **README.md:** 该文件提供了有关如何使用该脚本的基本信息。没有发现任何可疑内容。

尽管没有明显的投毒迹象，但任何从不受信任的来源获取的代码都存在一定的风险。此脚本的投毒风险评估为 5%，主要考虑到以下几点：
    *   **依赖关系风险：** 脚本使用 `requests` 库。虽然 `requests` 是一个常用的库，但攻击者可能会尝试通过恶意版本的 `requests` 或 `requests` 的依赖项进行投毒，尽管这种情况不太可能。
    *   **开发者疏忽：** 开发者可能会在无意中引入漏洞或错误，攻击者可以利用这些漏洞或错误。
    *   **元数据欺骗：** 攻击者可以修改脚本的元数据，例如作者信息或描述，以使其看起来更可信。
    *   **有限的审查：** 由于没有对该脚本进行广泛的审查，因此无法完全排除投毒的可能性。

建议在使用前审查该代码，并在隔离环境中测试。

**利用方式：**

1.  攻击者构造包含路径遍历序列的 URL，例如 `http://<nexus_ip>:<nexus_port>/%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc/passwd`。
2.  Nexus Repository 服务器未正确验证 URL 中的路径，从而允许攻击者访问 `/etc/passwd` 文件。
3.  服务器将 `/etc/passwd` 文件的内容返回给攻击者，导致敏感信息泄露。

**项目地址:** [Buff3st-0v3rfl0w/CVE-2024-4956](https://github.com/Buff3st-0v3rfl0w/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)