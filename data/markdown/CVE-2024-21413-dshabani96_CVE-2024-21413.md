## CVE-2024-21413 - Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统权限获取

**影响版本:** 受影响版本包括 Microsoft Office 2016 (版本低于 16.0.5435.1001), Microsoft Office 2019, Microsoft 365 Apps for Enterprise, Microsoft Office LTSC 2021等。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或文件的电子邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为“MonikerLink”漏洞。攻击者可以利用此漏洞在受害者的计算机上执行任意代码，无需用户交互。

**有效性：**根据漏洞信息和搜索结果，此漏洞是一个零日漏洞，已被积极利用。POC 代码旨在利用此漏洞。但是,提供的POC 代码只是发送电子邮件的框架，需要配置 SMTP 服务器，用户名密码等信息，并且需要 SMB 服务器来捕获 NTLM hash，成功利用的可能性取决于环境配置和目标用户行为。

**投毒风险：** 代码主要功能是发送包含恶意链接的电子邮件，并启动 SMB 服务器捕获 NTLM hash。虽然代码包含发送邮件和捕获 NTLM hash的功能，但潜在的风险包括：
1.  **恶意HTML模板：** HTML模板可能包含恶意脚本，例如 JavaScript，如果用户打开邮件并允许执行脚本，可能导致客户端漏洞或信息泄露。
2.  **SMB服务器钓鱼：** 启动的 SMB 服务器可能被用于钓鱼，例如，捕获用户的 NTLM 哈希后尝试破解，或者利用捕获的凭据访问其他服务。
3. **依赖外部服务:** 依赖 SMTP 服务和 SMB 服务, 这些服务本身可能存在安全隐患.
整体投毒风险较低，约为10%，主要集中在HTML模板和配置是否含有恶意代码。

**利用方式：**
1.  攻击者构造包含恶意链接的电子邮件。
2.  受害者打开电子邮件并点击恶意链接。
3.  恶意链接利用 Outlook 的 MonikerLink 漏洞，在受害者计算机上执行任意代码，或者泄露NTLM Hash。
4. 攻击者启动 SMB 服务器，诱导 Outlook 客户端连接，捕获受害者的 NTLM 哈希。
5. 攻击者可以使用捕获的 NTLM 哈希进行进一步攻击，例如传递哈希攻击。

**项目地址:** [dshabani96/CVE-2024-21413](https://github.com/dshabani96/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)