## CVE-2025-49144-Notepad++-权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，可导致SYSTEM权限获取

**影响版本:** < 8.8.2

**利用条件:** 需要用户运行恶意的Notepad++安装程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49144 是 Notepad++ v8.8.1 及其之前版本中存在的一个权限提升漏洞。该漏洞源于 Notepad++ 安装程序不安全的可执行文件搜索路径。攻击者可以通过社会工程学诱使用户下载合法的安装程序和一个恶意的 regsvr32.exe 文件到同一目录（通常是下载目录）。当用户运行安装程序时，由于安装程序首先在其工作目录中搜索 regsvr32.exe，因此会执行恶意的 regsvr32.exe 文件，从而以 SYSTEM 权限执行任意代码。

**有效性：**
提供的 PoC 代码描述了一种利用此漏洞的方法，即将编译好的恶意 `regsvr32.exe` 文件与 Notepad++ 安装程序放在同一目录中。该 `regsvr32.exe` 文件包含 shellcode，该 shellcode 会在 `C:\Windows\Temp\NOTEPAD_VULNERABIL.txt` 创建一个文件，以证明代码以 SYSTEM 权限执行。根据漏洞信息和 PoC 描述，该 PoC 有效。

**投毒风险：**
代码仓库存在一定投毒的风险，大约为10%。这种风险主要来自于以下几个方面：

*   **二进制文件风险：** PoC 描述中提及需要编译 C 代码生成 `regsvr32.exe`，这部分未提供预编译的二进制文件，需要使用者自行编译。如果提供预编译的二进制文件，则可能存在被植入恶意代码的风险。提供的C源代码相对简单，但仍需仔细审计。
*   **代码混淆或隐藏：** PoC 描述中使用了 `donut` 工具将 C# 代码转换为 shellcode。虽然 `donut` 本身是一个合法的 shellcode 生成工具，但通过 shellcode 可以隐藏更复杂的恶意行为。C源代码部分比较简单，没有明显问题，但shellcode本身有一定的隐藏性。
*   **依赖风险：** 构建PoC 需要额外的工具，这些工具链可能存在被篡改的风险。

虽然存在以上风险，但考虑到 PoC 的主要目的是演示漏洞利用，且提供的 C 代码较为简单，可读性较强，因此总体投毒风险较低。

**利用方式：**
1.  攻击者准备合法的 Notepad++ 安装程序（v8.8.1 或更早版本）。
2.  攻击者编写一个恶意的 `regsvr32.exe` 文件，该文件可以执行任意代码。
3.  攻击者通过社会工程学等手段，诱使用户下载 Notepad++ 安装程序和恶意的 `regsvr32.exe` 文件到同一目录（例如，用户的“下载”文件夹）。
4.  用户运行 Notepad++ 安装程序。
5.  由于安装程序首先在其工作目录中查找 `regsvr32.exe`，因此会执行攻击者放置的恶意 `regsvr32.exe` 文件。
6.  恶意 `regsvr32.exe` 文件以 SYSTEM 权限执行，攻击者从而获得 SYSTEM 权限。

**项目地址:** [0xCZR1/cve-2025-49144](https://github.com/0xCZR1/cve-2025-49144)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)