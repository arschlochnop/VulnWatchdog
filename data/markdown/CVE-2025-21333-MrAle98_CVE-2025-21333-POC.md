## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致系统权限提升

**影响版本:** Windows 10 21H2 (<= 10.0.19044.5371), Windows 11 22H2 (<= 10.0.22621.4751), Windows 10 22H2 (<= 10.0.19045.5371), Windows Server 2025 (<= 10.0.26100.2894), Windows 11 23H2 (<= 10.0.22631.4751), Windows 11 24H2 (<= 10.0.26100.2894), Windows Server 23H2 (<= 10.0.25398.1369)

**利用条件:** 需要Guest OS环境, 并需要利用I/O Ring机制进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的特权提升漏洞。该漏洞是由于内核驱动`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。 

**漏洞利用方式：**

1.  **I/O Ring机制：** PoC利用了Windows I/O Ring机制，通过伪造IOP_MC_BUFFER_ENTRY结构体，从而实现内核任意地址读写。
2.  **堆溢出：** 通过在分页池中分配大量内存，然后触发堆溢出，覆盖IOP_MC_BUFFER_ENTRY结构体指针。
3.  **任意读写：** 覆盖后的`Address`可以指向任意内核地址，从而实现任意地址读写。
4. **提权：** 通过任意读写能力，可以修改当前进程的Token，从而提升权限。

**有效性：**

根据提供的PoC代码和搜索结果，该漏洞PoC的存在，并且已经被CISA列入已知被利用漏洞目录。PoC代码的README描述了如何在Windows 11 23h2上利用此漏洞进行提权，同时也说明了该PoC的可靠性可能不高。

**投毒风险：**

PoC代码本身是一个Visual Studio解决方案，包含C++源代码。 代码主要功能是利用堆溢出和I/O Ring机制实现内核任意地址读写，从而提升权限。审查代码后，发现潜在的投毒风险较低，例如：

*   **复杂性：** 代码相对复杂，阅读和理解需要一定的内核安全知识，增加了隐藏恶意代码的难度。
*   **公开性：** PoC本身是为了演示漏洞利用，作者倾向于公开透明，减少隐藏恶意代码的动机。
    但是，仍然存在一些微小的风险：
*   **细微修改：** 攻击者可能会在PoC代码中添加一些细微的修改，例如修改内存地址或增加延时，从而绕过安全检测。
*   **依赖项：** PoC可能依赖一些外部库或驱动，这些依赖项可能存在安全风险。

综上所述，该PoC代码存在10%的投毒风险，主要是考虑到细微修改和依赖项的潜在风险。


**项目地址:** [MrAle98/CVE-2025-21333-POC](https://github.com/MrAle98/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)