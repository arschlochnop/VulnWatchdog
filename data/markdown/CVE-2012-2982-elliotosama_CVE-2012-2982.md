## CVE-2012-2982-Webmin-命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.590

**利用条件:** 需要Webmin用户认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Webmin 1.590及更早版本的`/file/show.cgi`文件中。远程认证用户可以通过在路径名中使用无效字符（例如 `|` 管道符）来执行任意命令。利用方式是，攻击者首先需要通过`session_login.cgi`进行身份验证，成功后获取`sid` cookie。然后，攻击者构造包含恶意命令的URL，其中的payload部分包含反弹shell的指令，利用管道符将payload注入到`/file/show.cgi`的参数中。`rand()` 函数用于生成随机字符串，以绕过某些过滤或检测机制。由于Webmin版本较老，且`/file/show.cgi`未对输入进行充分的过滤，导致命令注入。POC代码中没有发现明显的投毒代码。

**项目地址:** [elliotosama/CVE-2012-2982](https://github.com/elliotosama/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)