## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (except for patched versions: 8.0.7, 8.1.8, 8.2.7, 8.3.1)

**利用条件:** 需要Grafana实例运行在受影响版本，并且可以通过网络访问/public/plugins//路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件处理逻辑中，允许未经身份验证的攻击者利用目录遍历漏洞读取服务器上的任意文件。攻击者可以通过构造包含../的恶意URL，绕过文件访问限制，读取敏感文件，例如SSH私钥、配置文件等。

**漏洞利用方式：**

1.  确定目标Grafana实例的版本是否在受影响范围内（8.0.0-beta1 to 8.3.0，不包括已修复版本）。
2.  构造包含目录遍历payload的URL，例如：`/<grafana_host_url>/public/plugins/<plugin_id>/../../../../../../../../etc/passwd`。 其中`<plugin_id>`为任意已安装插件的ID，`../../../../../../../../etc/passwd`为尝试读取的文件路径。
3.  发送HTTP GET请求到构造的URL。
4.  如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

根据漏洞库信息和搜索结果，此漏洞利用的有效性很高，因为存在公开的PoC代码和利用案例。

**投毒风险分析：**
查看提供的漏洞利用代码`grafxploit.py`，此代码主要功能为扫描Grafana实例是否存在漏洞，并提取敏感信息，包括SSH密钥等。
代码本身没有发现明显的恶意行为，例如反弹shell、植入后门等。 代码还包含`LICENSE`和`README.md`文件，为MIT开源协议和说明文档，降低了投毒的可能性。
虽然代码中可能存在未知的bug或安全隐患，但从整体来看，**未发现明显的投毒迹象**，因此投毒风险较低，评估为0%。

**项目地址:** [wezoomagency/GrafXploit](https://github.com/wezoomagency/GrafXploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)