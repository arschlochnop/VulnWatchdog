## CVE-2020-21365-wkhtmltopdf-目录遍历

**漏洞编号:** CVE-2020-21365

**漏洞类型:** 目录遍历

**影响应用:** wkhtmltopdf

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 0.12.5

**利用条件:** 需要wkhtmltopdf服务运行，且允许加载远程或本地HTML文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，wkhtmltopdf 0.12.5及之前版本存在目录遍历漏洞，允许攻击者读取本地文件。POC代码 `index.html` 使用 JavaScript 的 `XMLHttpRequest` 对象发起 `file:///etc/passwd` 请求，尝试读取 `/etc/passwd` 文件内容，并在页面上显示。POC代码 `index.php` 尝试使用PHP的header函数重定向到`file:///etc//passwd`。由于是目录遍历漏洞，需要目标服务器允许wkhtmltopdf加载恶意构造的HTML文件。由于POC代码的功能明确，且没有发现任何隐藏的、非预期的行为，因此认为不存在投毒风险。

**项目地址:** [andrei2308/CVE-2020-21365](https://github.com/andrei2308/CVE-2020-21365)

**漏洞详情:** [CVE-2020-21365](https://nvd.nist.gov/vuln/detail/CVE-2020-21365)