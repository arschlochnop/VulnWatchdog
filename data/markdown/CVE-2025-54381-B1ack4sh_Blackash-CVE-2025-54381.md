## CVE-2025-54381-BentoML-SSRF

**漏洞编号:** CVE-2025-54381

**漏洞类型:** SSRF

**影响应用:** BentoML

**危害等级:** 高危，可能导致内部信息泄露，访问受限资源

**影响版本:** >= 1.4.0, <= 1.4.19

**利用条件:** 需要目标BentoML服务开启文件上传功能，且未进行URL验证和访问控制

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-54381是BentoML框架中存在的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于文件上传处理功能中，攻击者可以通过构造恶意的URL，诱使BentoML服务器向任意地址发起请求。漏洞利用方式主要通过 multipart form data 或 JSON 请求，在请求中包含恶意的URL。由于BentoML未对用户提供的URL进行充分的校验，导致服务器会尝试下载该URL指向的文件，从而可能访问内部服务、云元数据或其他受限资源，导致敏感信息泄露。提供的PoC代码包含两种方式：一种是基本的curl命令，另一种是Python脚本，均通过POST请求发送包含恶意URL的JSON数据。curl命令直接构造HTTP请求，Python脚本使用requests库发送请求，二者均可用于验证漏洞的存在。

**有效性：** 根据漏洞描述和PoC代码，漏洞利用应该有效。PoC代码展示了如何利用URL-based file upload功能，通过提供指向内部或云元数据地址的URL，来触发SSRF漏洞。

**投毒风险：**
虽然该仓库的主要目的是提供漏洞信息和PoC，但仍然存在一定的投毒风险。PoC本身利用了BentoML的已知漏洞，目的是演示漏洞利用，并非恶意代码。但是，在漏洞利用代码中，如果作者有意添加额外的恶意行为（例如，在发起SSRF请求的同时，执行其他系统命令或上传恶意文件），则可能存在投毒行为。考虑到PoC代码相对简单，且主要目的是读取数据，因此投毒风险较低，估计在5%左右。更复杂的投毒可能涉及在利用SSRF漏洞访问内部服务时，尝试执行RCE (Remote Code Execution)或者其他提权操作。但当前提供的PoC来看，只涉及到信息读取。

**利用方式：**
1.  **构造恶意URL：** 攻击者需要构造一个指向内部服务、云元数据或其他受限资源的URL。
2.  **发送恶意请求：** 攻击者通过multipart form data或JSON POST请求，将包含恶意URL的文件上传请求发送到BentoML服务器。
3.  **触发SSRF：** BentoML服务器接收到请求后，会尝试下载URL指向的文件，从而触发SSRF漏洞。
4.  **获取敏感信息：** 如果SSRF成功，攻击者可以获取内部服务的信息、云元数据或其他受限资源的内容。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-54381](https://github.com/B1ack4sh/Blackash-CVE-2025-54381)

**漏洞详情:** [CVE-2025-54381](https://nvd.nist.gov/vuln/detail/CVE-2025-54381)