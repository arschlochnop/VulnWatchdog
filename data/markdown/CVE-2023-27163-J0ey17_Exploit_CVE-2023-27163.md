## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞位于`/api/baskets/{name}`组件中，允许攻击者通过构造恶意的API请求来访问网络资源和敏感信息。

**有效性评估：**

提供的PoC代码通过以下步骤利用该漏洞：

1.  **创建Basket：** PoC脚本首先创建一个具有随机名称的basket。
2.  **获取API Token：** 然后获取与该basket关联的API token，用于后续的身份验证。
3.  **配置Basket转发URL：**  使用PUT请求，将`forward_url`设置为`http://127.0.0.1:{port}/`，其中`{port}`是一个端口范围（75-81）。这会将发送到basket的所有请求转发到目标服务器（即运行Request-Baskets的服务器）上的指定端口。
4.  **发起请求：** 使用GET请求访问basket的URL，从而触发服务器端请求伪造。  如果目标端口上有服务运行，则PoC会打印该服务的响应。

此方法允许攻击者扫描目标服务器上的内部端口，并获取在这些端口上运行的服务的响应。根据漏洞描述和搜索结果中的信息，该PoC代码被认为是有效的。

**投毒风险评估：**

PoC代码本身相对简单，主要功能是利用SSRF漏洞扫描本地端口。以下几点需要注意：

*   **依赖关系：** 该脚本只依赖于requests库，这是一个常用的Python库，本身不太可能包含恶意代码。
*   **代码逻辑：** PoC的主要逻辑是发送HTTP请求，没有发现可疑的系统调用或文件操作。
*   **潜在风险：** 攻击者可能会修改`forward_url`以访问其他内部服务或执行更严重的操作，但这属于漏洞利用的范畴，而不是代码投毒。

根据对代码的分析，投毒风险较低，估计为5%。 主要风险来自于使用者如果未充分理解代码，直接运行或者修改`forward_url`参数，可能造成的非预期后果。

**利用方式：**

1.  **攻击者首先需要访问存在漏洞的Request-Baskets服务。**
2.  **攻击者构造一个包含目标内部地址（例如`127.0.0.1`或内部网络地址）的`forward_url`的PUT请求，以配置一个basket。** 这实质上是将Request-Baskets服务器配置为代理攻击者的请求。
3.  **攻击者发送一个GET请求到配置的basket URL。** Request-Baskets服务器将根据配置将此请求转发到内部地址。
4.  **如果内部地址存在服务，Request-Baskets服务器将返回该服务的响应给攻击者，从而泄露内部信息。**

通过这种方式，攻击者可以绕过防火墙和其他安全措施，访问通常无法从外部访问的内部服务，从而进行端口扫描、服务发现或获取敏感数据。

**项目地址:** [J0ey17/Exploit_CVE-2023-27163](https://github.com/J0ey17/Exploit_CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)