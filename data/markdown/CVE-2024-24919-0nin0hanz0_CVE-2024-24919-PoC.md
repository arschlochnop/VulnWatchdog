## CVE-2024-24919-Check Point Security Gateway信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露，进而横向渗透

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 目标设备连接互联网，并且启用了远程访问VPN或移动接入软件 blades

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919是一个Check Point Security Gateway的信息泄露漏洞，允许未经身份验证的远程攻击者读取设备上的任意文件。利用方式是通过构造包含路径遍历的恶意请求，访问`/clients/MyCRL` 接口，payload为`aCSHELL/../../../../../../../etc/shadow`。PoC代码通过发送精心构造的POST请求到目标URL，尝试读取`/etc/shadow`文件，从而验证漏洞的存在。

**有效性评估：**
根据漏洞描述和搜索引擎结果，该漏洞是一个高危漏洞，并且存在可用的PoC，可以读取任意文件，因此提供的POC代码有效。

**投毒风险评估：**
PoC代码主要功能是发送一个包含特定payload的HTTP POST请求，用于利用路径遍历漏洞读取文件内容。代码中存在以下潜在的风险点，需要仔细评估：
*   **依赖安装:** PoC代码要求安装 `requests` 和 `urllib3`库,如果依赖库被篡改,会导致投毒. *   **请求构造:**  检查请求的headers和payload是否符合漏洞利用的预期，是否存在被修改的可能。 *   **目标IP的验证:**  PoC没有对--target 或者 --file 文件中的内容做严格的校验,存在被恶意诱导扫描非授权IP的风险。 *   **结果处理:**  PoC代码没有给出如何处理读取到的文件,如果文件内容被上传到作者服务器,则存在投毒风险。
综合考虑，该PoC的投毒风险较低，主要风险在于依赖库被篡改、目标IP被恶意诱导，以及读取到的文件内容被泄露。因此，投毒风险评估为10%。


**项目地址:** [0nin0hanz0/CVE-2024-24919-PoC](https://github.com/0nin0hanz0/CVE-2024-24919-PoC)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)