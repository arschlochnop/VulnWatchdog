## CVE-2025-25257-FortiWeb-SQL注入到RCE

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 7.0.10 / 7.2.10 / 7.4.7 / 7.6.3

**利用条件:** 需要网络访问目标FortiWeb设备，并且设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-25257是Fortinet FortiWeb中的一个SQL注入漏洞，攻击者可以通过构造恶意的HTTP或HTTPS请求，利用该漏洞执行未经授权的SQL代码或命令，最终实现远程代码执行。漏洞存在于GUI界面，由于对SQL命令中使用的特殊元素未进行适当的中和。 

**利用方式：**

1.  **SQL注入：** 攻击者通过在`Authorization`头部注入恶意的SQL代码，例如`Bearer ';{injection}`。具体注入点位于`/api/fabric/device/status`接口。
2.  **创建webshell：** POC代码首先创建并写入一个webshell到`/migadmin/cgi-bin/x.cgi`。webshell的功能是执行通过`User-Agent`头传递的命令。
3.  **权限提升：** 为了确保webshell可执行，POC会尝试通过`/cgi-bin/ml-draw.py`触发一个chmod命令，该命令会给webshell赋予执行权限。该python hook会执行`/var/log/lib/python3.10/pylab.py`脚本，poc通过sql注入写入chmod提权指令到该文件。
4.  **远程命令执行：** 攻击者随后可以通过访问webshell并设置`User-Agent`头来执行任意命令。

**有效性：**

根据漏洞信息和利用代码，该POC代码是有效的，因为它利用了一个未经身份验证的SQL注入漏洞来实现远程代码执行。

**投毒风险：**

该POC代码的主要功能是利用SQL注入漏洞实现RCE。经过对代码的分析，检测到存在微小的投毒风险，可能性为5%。主要考虑到以下几点：

*   该脚本依赖于特定的文件路径（例如`_pyhook_path`,`_webshell_path`, `_pth_path`）。如果这些路径在目标系统上不存在或不可写，那么攻击将会失败，可能导致拒绝服务或者留下恶意文件。
*   `_chmod_script` 中使用了 `os.system`，如果目标系统上禁用了相关函数，可能造成脚本执行失败
*   SQL注入本身具有一定的风险，错误的注入可能导致数据库损坏。

总体来说，代码功能明确，主要用于漏洞验证和利用，但仍然存在一些细微的潜在风险。

**项目地址:** [mrmtwoj/CVE-2025-25257](https://github.com/mrmtwoj/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)