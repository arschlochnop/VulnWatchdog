## CVE-2024-45436-Ollama-路径遍历

**漏洞编号:** CVE-2024-45436

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 0.1.47

**利用条件:** 需要网络访问Ollama服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45436是Ollama版本0.1.47之前存在的一个路径遍历漏洞（也称为“Zip Slip”）。该漏洞允许攻击者通过构造恶意的ZIP文件，将文件解压到文件系统的任意位置。 

**漏洞利用方式：**

1.  **创建恶意共享对象文件 (hook.so):** 包含任意命令执行代码。
2.  **创建包含路径遍历的恶意ZIP文件:** 将`hook.so`打包到包含路径遍历的ZIP文件中，例如`../../../../../../../../../../etc/ld.so.preload`和`../../../../../../../../../../tmp/hook.so`。
3.  **上传ZIP文件:** 通过Ollama的blob API上传恶意ZIP文件。
4.  **创建模型:** 创建一个引用上传的blob的模型。
5.  **触发执行:** 请求Ollama生成embeddings。

成功执行后，payload将以Ollama服务相同的权限运行，可能导致远程代码执行。

**有效性:**

根据漏洞信息、搜索结果以及漏洞利用代码，该漏洞利用的有效性高。POC代码已经存在，并且描述了详细的利用步骤。漏洞库信息也确认了该漏洞的存在以及影响的版本。

**投毒风险:**

提供的POC代码主要用于演示和验证漏洞。代码本身虽然没有明显的投毒代码，但仍然存在一定的风险：

*   **恶意命令：**`exp.py`脚本允许攻击者指定要执行的命令。如果攻击者使用恶意命令，可能会对目标系统造成损害。
*   **`hook.so` 内容：** 攻击者可以控制`hook.so`的内容，这意味着可以执行任意代码。虽然提供的`README.md` 和 `README_CN.md` 只提到执行命令，但实际上可以做更多的事情。
*   **依赖：** 脚本依赖于`requests`、`argparse` 以及 GCC。虽然都是比较常见的依赖，但是如果这些依赖本身被篡改，也可能引入安全风险。

考虑到这些因素，这里把投毒风险设定为10%，因为主要是用户可以控制`command` 和 `hook.so`的内容，该仓库只是提供exp框架

**项目地址:** [srcx404/CVE-2024-45436](https://github.com/srcx404/CVE-2024-45436)

**漏洞详情:** [CVE-2024-45436](https://nvd.nist.gov/vuln/detail/CVE-2024-45436)