## CVE-2025-4524 - Madara-core WordPress theme 未授权本地文件包含 (LFI)

**漏洞编号:** CVE-2025-4524

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Madara WordPress theme

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于服务器配置）

**影响版本:** <= 2.2.2 (根据Wordfence链接)

**利用条件:** 需要安装存在漏洞的Madara WordPress主题

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于`madara`主题的`madara_load_more`动作中。`template`参数接受用户提供的任意数据，并传递给PHP的`include`函数。如果`template`参数中包含字符串`plugins`，则会直接执行`include($template)`，否则会调用`get_template_part($template, get_post_format())`。这使得攻击者可以通过构造包含`plugins`和路径遍历的`template`参数来读取服务器上的任意文件，例如`plugins/../../../../../../../etc/passwd`。 如果服务器开启了`allow_url_include`，则可以通过包含远程文件来执行任意代码。即使`allow_url_include`未开启，攻击者也可以先上传包含PHP代码的文件（例如伪装成图片），然后通过LFI来执行上传的恶意代码，从而实现远程代码执行。提供的POC代码包含用于触发漏洞的HTTP请求示例和一个Python脚本，虽然脚本不完整，但描述了利用过程，没有发现明显的投毒代码。此漏洞利用的核心思路是利用`include`函数的特性，结合路径遍历或远程文件包含来读取或执行恶意代码。

**项目地址:** [ptrstr/CVE-2025-4524](https://github.com/ptrstr/CVE-2025-4524)

**漏洞详情:** [CVE-2025-4524](https://nvd.nist.gov/vuln/detail/CVE-2025-4524)