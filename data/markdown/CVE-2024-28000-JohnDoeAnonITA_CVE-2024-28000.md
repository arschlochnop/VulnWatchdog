## CVE-2024-28000 - LiteSpeed Cache 未授权提权

**漏洞编号:** CVE-2024-28000

**漏洞类型:** 权限提升

**影响应用:** LiteSpeed Cache

**危害等级:** 高危，可能导致管理员权限被盗取

**影响版本:** <= 6.3.0.1

**利用条件:** 目标网站安装了受影响版本的LiteSpeed Cache插件, 并且开启了LiteSpeed Cache 的相关功能，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28000是LiteSpeed Cache插件中的一个未授权权限提升漏洞。攻击者可以利用此漏洞在未经身份验证的情况下创建一个新的管理员帐户，从而完全控制受影响的WordPress网站。

**有效性分析:**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。多个来源(包括Patchstack、NVD、安全博客和GitHub存储库)确认了该漏洞的存在，并提供了利用它的方法。

**投毒风险分析:**

PoC代码本身实现的是创建管理员用户的功能，从代码来看，没有明显的恶意代码植入用于进行破坏或信息收集。

但是，依旧存在一定的投毒风险。攻击者可能会：

*   **篡改用户枚举部分:** 攻击者可能修改userenum函数，使其返回包含恶意用户的信息，从而误导使用者。
*   **修改创建管理员用户部分:** 攻击者可能在testcradmin函数中添加额外的代码，例如，创建一个隐藏的后门帐户，或者在创建管理员帐户的同时执行其他恶意操作。
*    **依赖包风险:**  此PoC依赖`github.com/carlmjohnson/requests`、`github.com/schollz/progressbar/v3`等第三方依赖包， 攻击者可能通过替换或者篡改这些依赖包的方式植入恶意代码。

综上，该PoC代码存在一定的投毒风险，大约为10%。建议在使用前仔细审查代码，并从可信的来源获取PoC。

**利用方式分析:**

1.  **检查目标:** 首先，脚本通过检查目标网站是否存在LiteSpeed Cache插件，并确认其版本是否在受影响范围内（<= 6.3.0.1）。
2.  **检查Tag:**  检查是否存在x-litespeed-tag。
3.  **生成Hash:** 利用`async_litespeed` action 触发hash生成。
4.  **用户枚举:**  利用 WordPress REST API (`/wp-json/wp/v2/users`) 枚举现有用户。
5.  **创建管理员账户:**  通过构造包含新管理员用户名、密码和电子邮件的JSON数据，并使用生成的`litespeed_hash` Cookie，向`/wp-json/wp/v2/users`端点发送POST请求，从而创建一个新的管理员帐户。

**项目地址:** [JohnDoeAnonITA/CVE-2024-28000](https://github.com/JohnDoeAnonITA/CVE-2024-28000)

**漏洞详情:** [CVE-2024-28000](https://nvd.nist.gov/vuln/detail/CVE-2024-28000)