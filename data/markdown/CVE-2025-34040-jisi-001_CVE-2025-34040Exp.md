## CVE-2025-34040-Zhiyuan OA-任意文件上传

**漏洞编号:** CVE-2025-34040

**漏洞类型:** 任意文件上传

**影响应用:** Zhiyuan OA

**危害等级:** 高危，可远程代码执行

**影响版本:** 5.0, 5.1 - 5.6sp1, 6.0 - 6.1sp2, 7.0, 7.0sp1 - 7.1, 7.1sp1, 8.0 - 8.0sp2

**利用条件:** 目标存在未授权访问的wpsAssistServlet接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-34040是致远OA平台中存在的一个任意文件上传漏洞。攻击者可以通过`wpsAssistServlet`接口，利用`realFileType`和`fileId`参数中的路径遍历漏洞，上传恶意JSP文件到Web服务器可访问的目录，从而实现远程代码执行。

**有效性分析：**

根据漏洞信息和POC代码，该漏洞利用方式是有效的。POC代码通过构造包含恶意JSP代码的multipart/form-data请求，并将其发送到目标OA系统的`wpsAssistServlet`接口，其中`realFileType`参数被用于构造路径穿越，从而将文件上传到指定目录。

**投毒风险分析：**

查看提供的EXP的python代码，该代码主要功能是发送精心构造的HTTP请求，利用漏洞上传JSP文件。EXP中的内容基本符合漏洞描述，没有发现明显的恶意代码或后门。EXP允许用户指定上传的文件名和文件内容，增加了利用的灵活性。 因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为100%。

**利用方式总结：**

1.  **确定目标：** 找到运行存在漏洞版本致远OA的服务器。
2.  **构造请求：** 构造一个multipart/form-data的POST请求，包含一个名为`upload`的文件字段，其内容为恶意的JSP代码。
3.  **利用路径穿越：** 在请求的URL中，使用`wpsAssistServlet?flag=save&realFileType=../../../../ApacheJetspeed/webapps/ROOT/{filename}&fileId=2`， 其中`realFileType`参数的值包含路径穿越字符，用于将文件上传到Web服务器的根目录（或其他可访问目录）。`{filename}`替换为想要上传的文件名，例如`shell.jsp`。
4.  **发送请求：** 将构造好的请求发送到目标服务器。
5.  **验证：** 尝试访问上传的文件，例如`http://目标IP/shell.jsp`，如果能够成功执行JSP代码，则漏洞利用成功。

**项目地址:** [jisi-001/CVE-2025-34040Exp](https://github.com/jisi-001/CVE-2025-34040Exp)

**漏洞详情:** [CVE-2025-34040](https://nvd.nist.gov/vuln/detail/CVE-2025-34040)