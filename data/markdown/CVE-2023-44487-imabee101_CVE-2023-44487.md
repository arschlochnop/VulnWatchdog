## CVE-2023-44487 HTTP/2 Rapid Reset 拒绝服务漏洞

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2 协议

**危害等级:** 高危，可能导致服务器资源耗尽，服务不可用

**影响版本:** 所有实现 HTTP/2 协议且未进行缓解措施的服务器

**利用条件:** 需要目标服务器支持 HTTP/2 协议，且攻击者能够建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-44487 是 HTTP/2 协议中的一个拒绝服务漏洞，被称为 Rapid Reset 攻击。攻击者通过快速建立和重置大量的 HTTP/2 流，消耗服务器资源，导致服务器无法正常处理合法请求，从而造成拒绝服务。\n\n**有效性：**\n根据漏洞信息、搜索结果以及提供的 PoC 代码，可以判定该 PoC 代码有效。漏洞库信息和搜索结果都表明该漏洞在野外被利用，且有公开的 PoC 代码。PoC 代码通过创建大量线程，每个线程都建立一个 HTTP/2 连接，并快速发送和重置流，从而达到拒绝服务的目的。\n\n**投毒风险：**\nPoC 代码本身的功能是实现漏洞利用，风险较低。代码主要实现了以下流程:\n1. 循环创建socket连接,设置tls和alpn协议为h2.\n2. 初始化h2连接，并发送连接初始化数据。\n3. 创建新的stream，并发送headers。\n4. 循环读取数据，如果接收到RequestReceived事件，则reset stream。\n5. 使用大量线程并发执行上述过程，达到拒绝服务效果。\n\n虽然PoC的主要目的是展示漏洞，但潜在的投毒风险在于：\n*   **资源消耗：** 大量线程可能会消耗攻击者自身的资源，影响攻击效果或暴露攻击者身份。\n*   **不稳定性：** 循环中的异常处理可能不够健壮，导致程序崩溃。\n\n根据代码分析和漏洞本身的特性，投毒风险评估为 10%。\n\n**利用方式：**\n1.  攻击者首先与目标服务器建立 HTTP/2 连接。\n2.  攻击者创建大量的 HTTP/2 流（streams）。\n3.  攻击者在每个流上发送一个请求，然后立即重置（reset）该流。这个过程快速重复进行。\n4.  服务器需要为每个新建的流分配资源，即使流很快就被重置。由于攻击者快速创建和重置流，服务器资源会被迅速耗尽，从而导致拒绝服务。

**项目地址:** [imabee101/CVE-2023-44487](https://github.com/imabee101/CVE-2023-44487)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)