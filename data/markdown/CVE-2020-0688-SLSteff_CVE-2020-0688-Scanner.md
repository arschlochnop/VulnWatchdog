## CVE-2020-0688-Microsoft Exchange-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange

**危害等级:** 高危，可能导致完全系统入侵

**影响版本:** 受影响版本包括但不限于Exchange Server 2010 SP3 UR30, Exchange Server 2013 CU23, Exchange Server 2016 CU14/15, Exchange Server 2019 CU3/4

**利用条件:** 需要OWA（Outlook Web Access）的访问权限以及有效的Exchange用户凭据或服务器的静态密钥（ValidationKey, DecryptionKey），如果服务器使用了默认密钥，则不需要用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange 中存在的一个远程代码执行漏洞，源于 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用此漏洞，通过构造恶意的请求，利用ViewState反序列化在服务器上执行任意代码。\n\n**漏洞利用方式：**\n1.  **获取密钥：** 攻击者需要首先获得目标 Exchange 服务器的 ValidationKey 和 DecryptionKey。这些密钥通常可以在 web.config 文件中找到。如果目标使用了默认密钥，利用则变得更加简单。\n2.  **构造恶意 ViewState：** 利用获得的密钥，攻击者可以构造一个包含恶意代码的 ViewState 对象。这个 ViewState 对象会被序列化并编码。\n3.  **发送恶意请求：** 攻击者将构造好的恶意 ViewState 对象作为请求参数发送到 Exchange 服务器的 OWA 接口 (例如`/ecp/default.aspx`)。\n4.  **执行代码：** Exchange 服务器在处理该请求时，会反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。\n\n**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。多个来源表明该漏洞已在野外被利用，且存在公开的 PoC 代码。

**投毒风险：**
提供的shell脚本主要用于扫描指定IP范围内的Exchange服务器，并识别可能存在CVE-2020-0688漏洞的版本。脚本的功能在于版本探测，而非直接的漏洞利用。尽管如此，仍然存在一定的投毒风险（大约10%），虽然扫描器本身没有明显的恶意代码，但存在以下可能性：\n*   **依赖项风险：** 脚本可能依赖于其他外部脚本或工具，这些依赖项可能包含恶意代码。\n*   **命令注入风险：** 尽管脚本本身没有明显的命令注入漏洞，但如果用户在使用脚本时没有正确处理输入，可能会引入命令注入漏洞。
*   **信息收集风险：** 扫描器会收集目标 Exchange 服务器的版本信息，这些信息可能被攻击者用于后续的攻击。
*   **伪装与欺骗：** 攻击者可能修改脚本，使其在扫描过程中执行恶意操作，例如植入后门或窃取凭据。由于此脚本会尝试与目标服务器进行交互，增加了被恶意利用的可能性。
*   **域名欺骗:** 此脚本中没有发现域名欺骗或IP地址欺骗的恶意行为。\n\n由于存在上述潜在风险，使用此脚本时务必谨慎，并确保从可信的来源获取。


**项目地址:** [SLSteff/CVE-2020-0688-Scanner](https://github.com/SLSteff/CVE-2020-0688-Scanner)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)