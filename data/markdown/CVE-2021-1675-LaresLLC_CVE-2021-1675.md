## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，可能导致系统完全控制

**影响版本:** 受影响的Windows版本，具体参见漏洞库信息

**利用条件:** 目标系统开启Print Spooler服务且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务中的远程代码执行漏洞。

**有效性：**
根据NVD和Rapid7的信息，此漏洞的PoC已经公开，并且在野外被利用。提供的文件包含一个 Sysmon 配置文件，用于检测利用此漏洞的可疑活动。搜索结果表明，即使安装了最初的补丁，某些系统仍然容易受到攻击，这表明漏洞利用仍然有效，直到完全缓解措施到位。

**投毒风险：**
提供的代码主要是一个Sysmon配置文件，用于检测PrintNightmare漏洞的利用。它定义了一系列规则，用于监视与`spoolsv.exe`进程相关的可疑行为，例如加载驱动程序、创建文件、访问注册表等。由于Sysmon配置文件本身不包含任何可执行代码，因此直接的投毒风险较低。然而，仍然存在一些间接风险，比如：
*   **误报/漏报：** 配置不当或过于宽松的规则可能导致大量的误报，从而淹没安全分析师，并可能错过真正的攻击。过于严格的规则可能会导致漏报，使攻击者能够绕过检测。
*   **依赖外部组件：** 该配置依赖于Sysmon的存在和正确配置。如果攻击者能够禁用或篡改Sysmon，就可以绕过这些检测规则。
*   **社会工程：** 攻击者可能伪装成安全研究人员，分享修改后的、包含恶意规则的Sysmon配置文件。这些恶意规则可能旨在隐藏攻击活动或禁用其他安全措施。
*   **后门代码验证:** 搜索结果提示漏洞可以针对Active Directory域控制器。 漏洞利用代码中针对 spoolsv.exe 进程进行监控，并添加创建远程线程, 镜像加载等高危操作的日志监控。务必不要把POC验证的后门代码判定为投毒代码。
因此，综合评估，投毒风险约为10%。

**利用方式：**
1.  **远程代码执行：** 攻击者通过Print Spooler服务远程在目标系统上执行代码。
2.  **DLL注入：** 攻击者上传恶意的DLL文件到目标系统，并诱使Print Spooler服务加载它。
3.  **权限提升：** 通过利用该漏洞，攻击者可以将权限从普通用户提升到SYSTEM级别。

**总结：**
该漏洞影响广泛，利用难度较低，危害性高。需要及时安装补丁，并采取其他缓解措施，如禁用Print Spooler服务或限制对打印服务器的访问。
提供的Sysmon配置文件可以帮助检测该漏洞的利用，但不能完全阻止攻击。需要结合其他安全措施，如入侵检测系统（IDS）和终端检测与响应（EDR）解决方案，才能更有效地防御该漏洞。

**项目地址:** [LaresLLC/CVE-2021-1675](https://github.com/LaresLLC/CVE-2021-1675)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)