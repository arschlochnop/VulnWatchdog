## CVE-2025-4476-Libsoup-空指针解引用

**漏洞编号:** CVE-2025-4476

**漏洞类型:** 空指针解引用

**影响应用:** Libsoup

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 3.6.6

**利用条件:** 用户客户端应用连接到恶意HTTP服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4476 是 Libsoup 库中的一个空指针解引用漏洞。当 Libsoup 客户端接收到包含精心构造的 domain 参数的 401 (Unauthorized) HTTP 响应的 WWW-Authenticate 头部时，会触发此漏洞。处理此格式错误的头部可能导致使用 Libsoup 的客户端应用程序崩溃，造成拒绝服务。

**利用方式：**

1.  攻击者搭建一个恶意 HTTP 服务器。
2.  诱使用户的客户端应用程序连接到该恶意服务器。
3.  恶意服务器发送包含恶意构造的 WWW-Authenticate 头部的 401 响应。
4.  Libsoup 处理该头部时，发生空指针解引用，导致客户端应用程序崩溃。

**POC 有效性：**

提供的 Python POC 代码 (`send_auth_request.py`) 通过发送带有超大 `Authorization: Basic` 头部的 HTTP GET 请求来测试目标服务器。虽然它本身不是一个直接的 CVE-2025-4476 漏洞利用，但它旨在用于测试头部解析问题，可以作为触发相关漏洞（例如空指针解引用）的工具。通过调整 `payload_len` 参数，可以测试 Libsoup 对超长头部的处理，验证目标是否容易受到因头部解析不当而引起的拒绝服务攻击。但是该poc没有直接的利用401认证回复来触发漏洞，有效性需要验证。漏洞库信息中指明了漏洞触发需要发送包含 specifically crafted domain parameter within the WWW-Authenticate header的401认证回复

**投毒风险：**

提供的代码片段看起来相对简单，主要功能是构建和发送 HTTP 请求。然而，仍然存在很小的投毒风险，例如：

*   **微妙的参数修改：** 代码中的参数（例如 `payload_len`, `host`, `port`, `path`）可能被修改以执行非预期操作，但考虑到该POC的目的是为了进行测试，这种风险较低。
*   **依赖项风险：** 虽然提供的代码片段没有明确的外部依赖，但如果完整的仓库包含 `requirements.txt` 或其他依赖声明，则可能存在供应链攻击的风险。
*   **不安全的 TLS 配置：** 代码中包含 `--insecure-tls` 选项，允许禁用 TLS 证书验证。虽然这在测试环境中很有用，但在生产环境中可能导致中间人攻击。
*   **日志记录和数据泄露：** 攻击者可能会修改代码以记录请求和响应数据，从而窃取敏感信息，但这种可能性较小，因为代码主要用于测试和研究。

总体来说，**投毒风险约为10%**。虽然代码看起来比较直接，但仍然需要仔细审查整个仓库，特别是任何依赖项和配置文件，以确保不存在恶意代码。


**项目地址:** [soltanali0/CVE-2025-4476-Exploit](https://github.com/soltanali0/CVE-2025-4476-Exploit)

**漏洞详情:** [CVE-2025-4476](https://nvd.nist.gov/vuln/detail/CVE-2025-4476)