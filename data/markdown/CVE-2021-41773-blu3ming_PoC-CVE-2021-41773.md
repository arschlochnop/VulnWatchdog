## CVE-2021-41773 Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的Alias-like指令配置允许访问受限目录外的文件，同时CGI脚本未被禁用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。该漏洞源于Apache HTTP Server对路径规范化处理的缺陷。攻击者可以通过构造包含URL编码的路径遍历序列的恶意HTTP请求，绕过服务器的安全检查，读取服务器上任意文件，甚至可能执行任意代码。

**有效性分析：**

提供的PoC代码通过构造包含`/.%2e/%2e%2e/%2e%2e/%2e%2e/`的URL，利用Apache HTTP Server 2.4.49的路径遍历漏洞读取指定文件。PoC代码使用`urllib3`库发送HTTP请求，避免了`requests`库自动URL规范化导致的利用失败。
根据漏洞库信息、搜索引擎结果和PoC代码，可以判断该PoC代码有效。

**投毒风险分析：**

对提供的PoC代码进行分析，主要包括以下几个文件：

*   `README.md`: 描述了漏洞的详细信息、利用方法和示例。没有发现恶意代码。
*   `cve-2021-41773.py`: 漏洞利用脚本。该脚本的功能是发送包含恶意路径的HTTP请求，读取指定文件。没有发现明显的恶意代码，但存在潜在风险，即攻击者可能利用该脚本读取服务器上的敏感信息，并进行进一步的攻击。不过从代码本身来看，功能单一，不包含任何额外的后门或者恶意功能。
*   `requirements.txt`: 声明了所需的Python依赖库，包括`requests`和`urllib3`。这两个库都是常用的Python库，没有发现恶意库。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除攻击者利用该脚本进行恶意活动的风险。

**利用方式：**

1.  **确定目标服务器：** 确定运行Apache HTTP Server 2.4.49的目标服务器。
2.  **检查配置：** 检查目标服务器的`Alias-like`指令配置，确认是否存在允许访问受限目录外的文件的配置。
3.  **构造恶意URL：** 构造包含URL编码的路径遍历序列的恶意URL，例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e//etc/passwd`。
4.  **发送HTTP请求：** 使用PoC脚本或其他工具发送包含恶意URL的HTTP请求。
5.  **读取文件：** 如果漏洞利用成功，服务器将返回指定文件的内容。
6. **远程代码执行：** 如果CGI脚本被允许执行，攻击者可以上传一个恶意的CGI脚本并执行，从而实现远程代码执行。

**项目地址:** [blu3ming/PoC-CVE-2021-41773](https://github.com/blu3ming/PoC-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)