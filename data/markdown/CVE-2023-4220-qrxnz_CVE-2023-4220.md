## CVE-2023-4220-Chamilo LMS-未授权文件上传导致RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS，且版本小于等于1.11.24，需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220是Chamilo LMS 1.11.24及更早版本中存在的一个高危漏洞。该漏洞位于`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件中，允许未经身份验证的攻击者通过`big file upload`功能上传任意文件。由于未对上传的文件类型进行充分验证，攻击者可以上传包含恶意代码的Web Shell，从而执行存储型跨站脚本攻击(XSS)或实现远程代码执行(RCE)。

**有效性：** 根据搜索结果和漏洞描述，该漏洞的PoC是存在的，并且可以实现RCE。根据搜索结果，GitHub上已经有公开的PoC代码（https://github.com/VanishedPeople/CVE-2023-4220），证明漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码`/tmp/10c4d756f57f88eae973d9e10fafe40c/README.md` 非常简单，只是一个包含CVE编号的说明文件，恶意代码不太可能存在于此文件本身。 但是，由于该漏洞是关于文件上传，而提供的代码只是一个README文件，需要进一步查找其他文件，才能确定投毒风险。结合搜索结果中提供的POC链接，假设该PoC仓库包含其他文件，例如用于上传的脚本或webshell，则在这些脚本中可能存在作者隐藏的恶意代码，例如反向shell、信息收集或其他恶意功能。因此，存在一定投毒的风险，估计为10%，主要是考虑到需要进一步分析完整的POC代码才能做出准确判断，目前只看到了README文件。

**利用方式：**
1.  攻击者无需身份验证，可以直接访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
2.  利用`big file upload`功能上传恶意文件，例如包含PHP代码的Web Shell。
3.  由于未充分验证文件类型，恶意文件会被服务器接受并存储。
4.  攻击者可以通过访问上传的Web Shell来执行任意PHP代码，从而控制服务器。
5.  攻击者还可以利用上传的Web Shell执行存储型XSS攻击，影响其他用户。


**项目地址:** [qrxnz/CVE-2023-4220](https://github.com/qrxnz/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)