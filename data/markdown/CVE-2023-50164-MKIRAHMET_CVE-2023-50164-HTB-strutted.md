## CVE-2023-50164: Apache Struts 文件上传路径遍历导致远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，允许攻击者上传恶意文件并执行任意代码

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要应用存在文件上传功能，且未对上传路径进行严格校验

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 存在于 Apache Struts 的文件上传组件中。攻击者可以通过操纵文件上传参数，实现路径遍历，进而上传恶意文件。根据POC，该漏洞的利用方式是上传一个 WAR webshell 到 Tomcat 服务器。

**有效性：**
根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
POC 代码包含一个 `Vagrantfile`，用于创建一个虚拟机环境来复现漏洞。 exploit.py 脚本用于上传webshell。 检查了 exploit.py（未提供，因此只能根据README推断），Vagrantfile 和 README.md 没有发现明显的恶意代码。投毒风险较低，但仍需谨慎，因为攻击者可能通过其他方式（例如修改依赖）引入恶意代码。

**利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求。
2.  Struts 应用未能正确验证上传路径，允许攻击者将文件上传到任意位置。
3.  攻击者上传包含恶意代码的 WAR 文件 (webshell) 到 Tomcat 的 webapps 目录。
4.  Tomcat 部署该 WAR 文件，攻击者可以通过访问 webshell 执行任意代码。

**搜索引擎结果说明:** 众多安全厂商博客和漏洞库记录显示该漏洞存在且利用方法已经公开。

**项目地址:** [MKIRAHMET/CVE-2023-50164-HTB-strutted](https://github.com/MKIRAHMET/CVE-2023-50164-HTB-strutted)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)