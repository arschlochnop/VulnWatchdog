## CVE-2025-31650-Apache Tomcat-DoS

**漏洞编号:** CVE-2025-31650

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务不可用

**影响版本:** 9.0.76 <= version <= 9.0.102, 10.1.10 <= version <= 10.1.39, 11.0.0-M2 <= version <= 11.0.5

**利用条件:** 需要目标服务器启用HTTP/2，且存在于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31650 是 Apache Tomcat 中的一个不当输入验证漏洞。通过发送带有无效 HTTP 优先级标头的特制 HTTP/2 请求，攻击者可以触发内存泄漏，从而导致 OutOfMemoryError 最终造成拒绝服务。 

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该POC代码利用了对 HTTP/2 优先级标头验证不当的缺陷。通过发送大量包含恶意优先级标头的请求，服务器会耗尽内存最终导致崩溃。

**投毒风险：**

代码总体结构较为简单，主要功能是发送恶意请求。检查发现潜在的投毒风险较低，主要考虑以下几点：
* `httpx.AsyncClient(http2=True, verify=False, timeout=0.3, limits=httpx.Limits(max_connections=1000))`中`verify=False`会导致不验证SSL证书, 可能存在中间人攻击.
* `user-agent`可以伪造, 可能存在追踪溯源问题

**利用方式：**

1.  **检查目标：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本，且启用了 HTTP/2 协议。
2.  **发送请求：** 运行 TomcatKiller.py 脚本，指定目标服务器的 URL。脚本会发送大量包含随机选择的无效优先级标头的 HTTP/2 请求。
3.  **触发 DoS：** 大量的恶意请求会逐渐消耗服务器的内存，最终导致 OutOfMemoryError 和拒绝服务。

**结论：**
该漏洞利用代码的有效性较高。通过发送大量构造的恶意请求，可以有效地触发 Tomcat 服务器的内存泄漏，实现拒绝服务攻击。 投毒风险较低，但存在不验证SSL证书, `user-agent`可以伪造的潜在风险。

**项目地址:** [absholi7ly/TomcatKiller-CVE-2025-31650](https://github.com/absholi7ly/TomcatKiller-CVE-2025-31650)

**漏洞详情:** [CVE-2025-31650](https://nvd.nist.gov/vuln/detail/CVE-2025-31650)