## CVE-2022-0824-Webmin-远程代码执行

**漏洞编号:** CVE-2022-0824

**漏洞类型:** 远程代码执行

**影响应用:** Webmin

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 1.990

**利用条件:** 需要Webmin管理账号密码

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0824是Webmin中的一个不当访问控制漏洞，允许具有低权限的认证用户（即使没有文件管理器模块的访问权限）通过文件管理器上传恶意文件并执行，从而实现远程代码执行。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要有效的Webmin用户名和密码。
2.  **上传恶意文件：**  使用已知的会话ID（sid）和文件管理器模块中的漏洞，攻击者可以上传一个包含恶意代码的CGI脚本（commands.cgi）到Webmin服务器的指定目录（/usr/share/webmin）。
3.  **修改权限：**  上传后，攻击者需要修改该CGI脚本的权限，使其可执行（chmod 0755）。
4.  **执行代码：**  最后，攻击者通过访问该CGI脚本的URL来触发恶意代码的执行，从而获取服务器的控制权。

**POC有效性：**

提供的POC代码（cve-2022-0824.go）是一个Go程序，它自动化了上述利用过程。它首先使用提供的凭据登录到Webmin服务器，获取会话ID（sid），然后上传、修改权限并执行包含反向shell代码的CGI脚本。

从代码的功能逻辑和提供的描述来看，该POC代码应该是有效的，可以直接利用漏洞。

**投毒风险：**

尽管POC代码本身旨在利用漏洞，但仍需要评估是否存在恶意代码或后门。仔细检查代码，特别是以下部分：

*   `makePayload` 函数：此函数生成反向shell有效负载。重点检查此函数是否包含任何额外的恶意命令或后门。
*   HTTP请求部分：检查代码中是否有任何额外的HTTP请求发送到未知的服务器，这可能是收集信息或安装后门的迹象。

基于对提供的POC代码的分析，投毒的风险较低，但不能完全排除。可能存在的风险是作者可能在反向shell中加入一些不易察觉的命令，用来收集信息或进行其他恶意活动。考虑到安全风险，投毒的可能性估计为5%。

**项目地址:** [pizza-power/golang-webmin-CVE-2022-0824-revshell](https://github.com/pizza-power/golang-webmin-CVE-2022-0824-revshell)

**漏洞详情:** [CVE-2022-0824](https://nvd.nist.gov/vuln/detail/CVE-2022-0824)