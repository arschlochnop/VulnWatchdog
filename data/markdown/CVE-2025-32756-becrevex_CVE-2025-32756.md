## CVE-2025-32756 - Fortinet 多产品栈溢出

**漏洞编号:** CVE-2025-32756

**漏洞类型:** 栈溢出

**影响应用:** FortiVoice, FortiRecorder, FortiMail, FortiNDR, FortiCamera

**危害等级:** 高危，远程未授权代码执行

**影响版本:** FortiVoice (7.2.0, 7.0.0-7.0.6, 6.4.0-6.4.10), FortiRecorder (7.2.0-7.2.3, 7.0.0-7.0.5, 6.4.0-6.4.5), FortiMail (7.6.0-7.6.2, 7.4.0-7.4.4, 7.2.0-7.2.7, 7.0.0-7.0.8), FortiNDR (7.6.0, 7.4.0-7.4.7, 7.2.0-7.2.4, 7.0.0-7.0.6, 1.5.0-1.5.3, 1.4.0, 1.3.0-1.3.1, 1.2.0, 1.1.0), FortiCamera (2.1.0-2.1.3, 2.0, 1.1.0-1.1.5)

**利用条件:** 目标系统运行受影响的Fortinet产品，且可通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32756 是一个影响多个 Fortinet 产品的栈溢出漏洞。攻击者可以通过发送特制的 HTTP 请求中的 hash cookie，利用该漏洞在目标系统上执行任意代码。根据NVD以及多方安全机构的描述和分析，该漏洞无需身份验证即可触发，且已被野外利用。 

提供的Nmap脚本 (fortinet_cve_2025_32756.nse) 本身是一个检测脚本，而非漏洞利用脚本。它通过检查 `/remote/info` 和 `/remote/hostcheck_validate` 路径是否存在来判断目标系统是否可能存在漏洞。脚本首先尝试获取 `/remote/info` 的内容，如果成功，则解析 JSON 数据，提取版本和构建信息。然后，它尝试向 `/remote/hostcheck_validate` 发送 POST 请求。如果两个路径都存在，脚本会报告目标系统可能存在漏洞。

**有效性评估:**
Nmap脚本本身不具备漏洞利用能力，只是用于检测漏洞是否存在。根据搜索结果，存在其他利用方式，例如通过精心构造的HTTP请求触发栈溢出以达到远程代码执行的目的。

**投毒风险评估:**
提供的Nmap脚本主要功能是探测，没有发现明显的恶意行为或者后门代码，投毒风险较低，这里评估为5%。

**利用方式总结:**
1.  攻击者发送包含恶意构造的hash cookie的HTTP请求到存在漏洞的Fortinet设备。
2.  设备解析HTTP请求，由于hash cookie的恶意构造，触发栈溢出。
3.  攻击者通过栈溢出，执行预先设定的恶意代码，实现远程代码执行，从而控制设备。

**项目地址:** [becrevex/CVE-2025-32756](https://github.com/becrevex/CVE-2025-32756)

**漏洞详情:** [CVE-2025-32756](https://nvd.nist.gov/vuln/detail/CVE-2025-32756)