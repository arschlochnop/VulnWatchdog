## CVE-2023-1545-Teampass-SQL注入

**漏洞编号:** CVE-2023-1545

**漏洞类型:** SQL注入

**影响应用:** Teampass

**危害等级:** 高危，可能导致敏感数据泄露，例如用户名和密码。

**影响版本:** < 3.0.0.23

**利用条件:** 需要能够访问Teampass的Web服务器，并且目标Teampass实例的版本低于3.0.0.23。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-1545是Teampass版本3.0.0.23之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为7.5，属于高危漏洞。

**有效性：**
提供的Python POC代码通过构造恶意的SQL语句，利用Teampass的身份验证接口中的SQL注入漏洞，绕过身份验证并提取数据库中的用户信息。POC代码首先检查目标URL是否可访问，然后尝试使用SQL注入枚举用户，并提取用户名和密码哈希值。根据代码逻辑和漏洞描述，该POC代码应该是有效的。

**投毒风险：**
仔细检查了提供的POC代码，未发现任何明显的投毒代码。该脚本的功能明确且集中于利用SQL注入漏洞，没有发现任何尝试进行未经授权的文件访问、系统命令执行或其他恶意活动的代码。因此，投毒风险较低，可以认为风险为0%。

**利用方式：**
1.  攻击者首先需要确定目标Teampass实例的版本是否低于3.0.0.23。
2.  攻击者使用POC代码，向Teampass的/api/index.php/authorize接口发送包含恶意SQL注入的POST请求。
3.  恶意SQL注入语句被插入到login字段中，绕过身份验证，并从teampass_users表中提取用户名和密码哈希值。
4.  攻击者可以利用提取到的密码哈希值，通过密码破解等手段获取用户密码，从而获得对Teampass系统的访问权限。

**项目地址:** [gunzf0x/CVE-2023-1545](https://github.com/gunzf0x/CVE-2023-1545)

**漏洞详情:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)