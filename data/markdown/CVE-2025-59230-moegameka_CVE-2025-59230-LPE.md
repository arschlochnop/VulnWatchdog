## CVE-2025-59230 - Windows Remote Access Connection Manager LPE

**漏洞编号:** CVE-2025-59230

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Windows Remote Access Connection Manager (RASMAN)

**危害等级:** 高危，攻击者可从低权限用户提升至SYSTEM权限

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围参见漏洞库信息

**利用条件:** 本地访问权限（标准用户即可）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-59230是一个Windows Remote Access Connection Manager服务中的本地权限提升漏洞。根据漏洞描述和提供的POC代码，该漏洞源于RASMAN服务在处理IPC消息时存在不正确的访问控制。攻击者可以利用此漏洞，通过向服务发送特制消息，触发竞态条件，从而覆盖关键注册表键或服务句柄的访问控制列表（ACL），最终提升至SYSTEM权限。

**有效性评估：**
根据README.md文件描述，该POC代码旨在绕过DEP和ASLR等缓解措施，并已在截至2025年10月15日的完全修补的系统上进行过测试。这表明该POC代码具有一定的有效性。

**投毒风险分析：**
尽管POC代码看起来是为了演示漏洞利用而编写的，但仍然存在一定的投毒风险。以下因素需要考虑：

1.  **代码审查难度：** 复杂的漏洞利用代码可能隐藏恶意逻辑。
2.  **外部链接：** README.md文件包含了[href](https://tinyurl.com/5heszhnb)短链接，必须解开链接进行进一步确认。
3.  **编译过程：** 使用msbuild编译，如果`exploit.sln`或相关项目文件被篡改，可能在编译过程中引入恶意代码。
4.  **开发者信息：** 开发者邮箱moegameka@onet.pl存在匿名性，无法完全信任。

综合以上因素，考虑到POC代码可能包含隐藏的恶意行为（例如，安装后门、窃取凭据等），因此评估投毒风险为20%。在实际使用前，必须对POC代码进行彻底的安全审计，并避免在生产环境中使用未经验证的代码。

**利用方式：**
1.  **编译：** 使用Visual Studio (MSVC 2022+)编译`exploit.sln`项目。
2.  **执行：** 在受影响的Windows系统上，以低权限用户身份运行编译后的`exploit.exe`。
3.  **提权：** 使用`--elevate`参数指定要以SYSTEM权限运行的命令（例如`cmd.exe`或`powershell.exe`）。
4.  **调试：** 可以使用`--debug`参数启用详细日志，以便进行故障排除。

总体来说，利用方式相对简单，但需要仔细审查和验证代码，以避免潜在的投毒风险。

**项目地址:** [moegameka/CVE-2025-59230-LPE](https://github.com/moegameka/CVE-2025-59230-LPE)

**漏洞详情:** [CVE-2025-59230](https://nvd.nist.gov/vuln/detail/CVE-2025-59230)