## CVE-2010-1240 Adobe Reader PDF 嵌入式可执行文件执行漏洞

**漏洞编号:** CVE-2010-1240

**漏洞类型:** 文件格式漏洞

**影响应用:** Adobe Reader

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.3.2 (9.x), <= 8.2.2 (8.x)

**利用条件:** 用户需要打开恶意PDF文件，并且在安全提示框中允许执行嵌入的文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2010-1240 漏洞存在于 Adobe Reader 和 Acrobat 9.x (<=9.3.2) 以及 8.x (<=8.2.2) 版本中。攻击者可以通过构造包含嵌入式可执行文件的恶意 PDF 文件，诱骗用户打开。当用户打开该 PDF 文件时，Adobe Reader 会显示一个安全警告对话框。如果用户忽略风险并允许执行嵌入的文件，攻击者就可以在用户系统上执行任意代码。

**有效性评估：**
根据漏洞信息和提供的利用代码，此漏洞利用方式是有效的。利用代码描述了如何使用 Metasploit 框架生成包含嵌入式可执行文件的恶意 PDF 文件，并通过反向 TCP 连接获取 Meterpreter 会话。

**投毒风险分析：**
虽然提供的 `README.md` 文件描述了漏洞利用过程，但仍存在一定的投毒风险。主要风险点在于：

*   攻击者可能在 PDF 文件中嵌入恶意后门程序，而不仅是 Meterpreter payload。虽然示例代码使用 Metasploit 生成 payload，但攻击者完全可以替换成其他恶意代码。
*   `README.md` 虽然提供了完整的步骤，但是攻击者可能会更改某些参数(例如 LHOST,LPORT,Payload)将受害者IP放入病毒中。使得该exp在传播后,其他人使用会反过来攻击使用者。

综合考虑，该漏洞利用代码的投毒风险大约为 10%。因为核心步骤依赖 Metasploit 框架，而 Metasploit 本身是安全工具。

**利用方式：**

1.  **准备攻击环境：** 安装 Kali Linux 和 Metasploit 框架。
2.  **生成恶意 PDF 文件：** 使用 Metasploit 的 `adobe_pdf_embedded_exe` 模块，设置 Payload 为 `windows/meterpreter/reverse_tcp`，并设置 LHOST 和 LPORT 为攻击者的 IP 地址和端口。
3.  **诱骗用户打开 PDF 文件：** 将生成的恶意 PDF 文件通过社交工程等方式发送给目标用户。
4.  **建立 Meterpreter 会话：** 当目标用户打开 PDF 文件并允许执行嵌入的文件后，攻击者就可以在 Kali Linux 上建立 Meterpreter 会话，从而控制目标系统。

**项目地址:** [omarothmann/Embedded-Backdoor-Connection](https://github.com/omarothmann/Embedded-Backdoor-Connection)

**漏洞详情:** [CVE-2010-1240](https://nvd.nist.gov/vuln/detail/CVE-2010-1240)