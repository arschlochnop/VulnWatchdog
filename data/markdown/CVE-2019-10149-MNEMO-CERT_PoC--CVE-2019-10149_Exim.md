## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)