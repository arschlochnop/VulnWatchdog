## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX 反序列化 RCE

**漏洞编号:** CVE-2019-18935

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Progress Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** <= 2019.3.1023

**利用条件:** 需要目标系统存在漏洞版本，攻击者能够访问Telerik UI的RadAsyncUpload功能，且已知或能够破解加密密钥 (或者配置为不使用加密)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18935 是一个存在于 Progress Telerik UI for ASP.NET AJAX 中的反序列化漏洞。由于 RadAsyncUpload 功能存在 .NET 反序列化漏洞，攻击者可以利用该漏洞在服务器上执行任意代码。漏洞利用的关键在于已知或能够破解加密密钥，这通常依赖于 CVE-2017-11317 或 CVE-2017-11357 的存在，或者目标系统使用了弱密钥或根本没有启用加密。 

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。 搜索结果表明，CVE-2019-18935 已被广泛利用，并且有公开可用的 PoC 代码。漏洞库信息也确认了漏洞的存在和严重性。

**投毒风险评估：**

该仓库的投毒风险较低，约 10%。风险主要来源于以下几点：
1.  该仓库提供的扫描器，理论上不具备直接投毒的能力。
2.  该仓库代码主要功能是扫描目标是否存在该漏洞，并非直接的利用代码，降低了投毒的可能性。
3.  `http-telerik-vuln.nse` 脚本只是一个 nmap 脚本，用于检测漏洞是否存在，本身不执行恶意操作。

**利用方式：**

1.  **漏洞发现：** 使用提供的 Python 扫描器或 Nmap 脚本（`http-telerik-vuln.nse`）来识别存在漏洞的 Telerik UI for ASP.NET AJAX 实例。
2.  **密钥获取/绕过：** 尝试利用 CVE-2017-11317 或 CVE-2017-11357 获取加密密钥，或者如果配置允许，直接绕过加密。
3.  **Payload 构造：** 使用已知密钥或不使用密钥（如果可能）构造恶意的 .NET 反序列化 payload。 这个payload包含了攻击者想要执行的任意代码。
4.  **漏洞触发：** 将构造的 payload 发送到 RadAsyncUpload 功能的端点，通常是通过修改 rauPostData 参数。这会导致服务器反序列化恶意数据，从而执行攻击者的代码。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以在服务器上执行任意代码，例如安装后门、窃取数据或控制整个系统。

简而言之，攻击者需要首先找到目标系统上的 Telerik UI，然后确定加密密钥。之后，攻击者会构建一个恶意的序列化对象，该对象会在服务器上执行任意代码。最后，攻击者会将这个对象发送到 RadAsyncUpload 端点，从而在服务器上执行代码。

**项目地址:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)