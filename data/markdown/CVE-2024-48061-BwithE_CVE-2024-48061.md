## CVE-2024-48061-langflow-远程代码执行

**漏洞编号:** CVE-2024-48061

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** langflow

**危害等级:** 高危，可导致完全系统控制

**影响版本:** <= 1.0.18

**利用条件:** 目标系统运行langflow <= 1.0.18，攻击者能够通过网络访问langflow服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-48061是langflow 1.0.18及更早版本中的一个远程代码执行(RCE)漏洞。漏洞原因是langflow中的组件没有在沙箱环境中运行，攻击者可以利用`/api/v1/validate/code` API端点，通过构造包含恶意代码的payload，在目标系统上执行任意代码。提供的POC代码通过发送包含反向shell命令的payload到目标API端点，从而建立与攻击者控制的监听器的连接，实现远程代码执行。

**漏洞利用方式：**

1.  **验证漏洞存在：** 使用POC脚本验证目标是否存在`/api/v1/validate/code`端点。
2.  **启动监听器：** 在攻击者机器上启动一个TCP监听器，等待目标机器的反向连接。
3.  **发送Payload：** 构造包含反向shell命令的JSON payload，并将其发送到目标的`/api/v1/validate/code`端点。
4.  **建立连接：** 目标机器执行payload中的代码，反向连接到攻击者的监听器。
5.  **远程控制：** 攻击者在监听器上获得一个shell，可以执行任意命令。

**投毒风险分析：**
该POC代码主要功能是利用漏洞，未发现明显的恶意行为或者隐藏的后门代码。代码的功能集中在启动监听器、发送payload和处理交互式shell，没有发现其他可疑操作。但是，用户仍然需要小心，从不可信的来源下载的代码都有潜在的风险。因此，投毒风险较低，约为1%。

**项目地址:** [BwithE/CVE-2024-48061](https://github.com/BwithE/CVE-2024-48061)

**漏洞详情:** [CVE-2024-48061](https://nvd.nist.gov/vuln/detail/CVE-2024-48061)