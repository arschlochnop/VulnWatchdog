## CVE-2025-30065-Apache Parquet-RCE/SSRF

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行(RCE)或服务器端请求伪造(SSRF)

**影响版本:** <= 1.15.0

**利用条件:** 需要受影响的系统处理恶意的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065存在于Apache Parquet的parquet-avro模块中，由于不安全的反序列化导致RCE或SSRF。攻击者可以构造恶意的Parquet文件，其中包含恶意的Avro schema，当受害者使用存在漏洞的版本解析该文件时，会导致代码执行或SSRF。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被评为高危，并且已经存在公开的POC代码。POC代码中提供了两种利用方式：
1.  利用RCEPayload.java (需要RCEPayload.java存在于classpath中)
2.  利用MaliciousSSRF.java (可触发SSRF, 风险更高)

综合来看，POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险：**
查看提供的POC代码，主要功能是生成包含恶意Avro schema的Parquet文件，利用`java-class`属性指定反序列化的类。仔细分析代码，并未发现明显的后门或恶意代码。`DISCLAIMER.md`也声明了该代码仅用于教育和安全研究目的。但是，考虑到安全风险，仍然存在一定的投毒风险，比如作者可能使用了混淆技术隐藏了恶意代码，或者依赖了其他不安全的第三方库。 总体投毒风险较低，估计为10%。

**利用方式：**
1.  攻击者构造恶意的Parquet文件，其中包含恶意的Avro schema。Schema中的字段类型利用`java-class`属性指定为恶意类。
2.  受害者使用存在漏洞的Apache Parquet版本读取该Parquet文件。
3.  parquet-avro模块在解析Avro schema时，会尝试反序列化恶意类，从而导致RCE或SSRF。如果classpath中存在利用链，则可以导致RCE。否则，可以使用SSRF payload，发起网络请求。

从提供的`README.md` 可以看到，需要读者理解漏洞原理才能复现成功，所以降低了直接利用的风险。


**项目地址:** [mouadk/parquet-rce-poc-CVE-2025-30065](https://github.com/mouadk/parquet-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)