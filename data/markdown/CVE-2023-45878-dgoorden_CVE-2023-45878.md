## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要目标系统部署了存在漏洞的GibbonEdu应用，并可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-45878 存在于 GibbonEdu 25.0.1 及更早版本中。由于 `rubrics_visualise_saveAjax.phps` 文件未进行身份验证，攻击者可以通过构造包含恶意 PHP 代码的 base64 编码图像，并指定目标路径，将恶意代码写入到服务器的任意位置。利用方式如下：

1.  **漏洞点：**`rubrics_visualise_saveAjax.php` 文件未授权访问，允许上传 base64 编码的数据并写入文件。
2.  **利用过程：**
    *   攻击者构造包含 PHP 代码的 base64 编码的图像数据（`img` 参数）。
    *   攻击者指定文件写入的路径（`path` 参数），由于路径拼接存在漏洞，攻击者可以控制写入文件的绝对路径。
    *   攻击者通过 POST 请求将 `img`、`path` 和 `gibbonPersonID` 参数发送到 `rubrics_visualise_saveAjax.php`。
3.  **影响：** 成功利用此漏洞后，攻击者可以在服务器上写入任意 PHP 文件，从而执行任意代码，控制服务器。

**有效性评估：**

提供的PoC代码利用了该漏洞，通过上传包含恶意PHP代码的图片，并在服务器上写入PHP webshell，进一步通过webshell执行命令，实现远程代码执行，因此POC是有效的。

**投毒风险评估：**

PoC代码的主要功能是利用漏洞实现远程代码执行，其中包含了生成和上传webshell的代码，并利用`system()`函数执行系统命令。代码中使用了从revshells.com获取的PowerShell反弹shell，并进行URL编码。总体来看，该代码的主要意图是漏洞利用，但是存在以下风险点：

*   **依赖外部资源：**PoC代码依赖`revshells.com`生成PowerShell反弹shell，如果该网站被恶意篡改，可能导致生成的payload包含恶意代码。
*   **自定义程度低：**该PoC直接使用了固定的PowerShell反弹shell，攻击者可能需要修改代码才能适应不同的环境。但是代码的结构使得修改的难度不高。
*   **Webshell本身：**上传的Webshell本身就是一个风险，攻击者可以利用它进行进一步的恶意操作。

尽管存在以上风险点，但这些风险更多是由于漏洞利用本身的性质所致，而非作者有意植入的恶意代码。因此，可以认为投毒的可能性较低，约为5%。这里的5%指的是PoC作者通过修改PowerShell payload 或者webshell代码加入恶意代码的可能性。

**搜索引擎结果优先级：**

搜索引擎结果确认了漏洞的存在，并提供了一些缓解建议。漏洞利用代码提供了具体的利用方式。

**项目地址:** [dgoorden/CVE-2023-45878](https://github.com/dgoorden/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)