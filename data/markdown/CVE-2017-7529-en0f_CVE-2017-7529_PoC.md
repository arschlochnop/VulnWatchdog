## CVE-2017-7529 - Nginx Range Filter Integer Overflow

**漏洞编号:** CVE-2017-7529

**漏洞类型:** Integer Overflow

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2

**利用条件:** 需要目标服务器开启range filter模块且存在可访问的文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7529是Nginx range filter模块中的一个整数溢出漏洞。通过构造特殊的HTTP Range请求头，可以触发整数溢出，导致Nginx返回超出文件范围的数据，从而泄露服务器内存中的敏感信息。从漏洞库信息和搜索结果来看，该漏洞影响Nginx 0.5.6到1.13.2版本。

**有效性：**

提供的PoC代码 `CVE-2017-7529_PoC.py` 看起来是有效的。它构造了恶意 Range 请求头，尝试触发整数溢出。该代码会发送带有特制Range头的HTTP请求，如果服务器存在漏洞，则会返回206状态码，并且响应中包含Content-Range头，PoC 会进行数据提取并 hexdump 输出泄漏的数据。该PoC通过检查HTTP状态码和响应头来验证漏洞是否存在。Content-Length被用来构造恶意Range请求。

**投毒风险：**

分析提供的Python脚本和README文件，未发现明显的恶意代码。脚本的主要功能是发送特制的HTTP请求并解析响应，以验证目标是否存在CVE-2017-7529漏洞。脚本逻辑清晰，没有执行系统命令或上传文件的操作。因此，投毒风险较低。 概率评估为0%。

**利用方式：**

1.  **确定目标Nginx版本：** 确认目标服务器运行的Nginx版本在受影响的范围内 (0.5.6 - 1.13.2)。
2.  **发送恶意 Range 请求：** 使用PoC脚本或手动构造包含特制Range头的HTTP请求。Range头中包含精心计算的起始和结束位置，以触发整数溢出。
3.  **分析响应：** 如果服务器存在漏洞，则会返回206 Partial Content响应，并且响应体中可能包含服务器内存中的敏感信息。分析响应体，提取泄露的数据。

总而言之，该漏洞的利用方式是通过发送特制的 Range 请求头，触发 Nginx 范围过滤器模块中的整数溢出漏洞，从而导致敏感信息泄漏。

**项目地址:** [en0f/CVE-2017-7529_PoC](https://github.com/en0f/CVE-2017-7529_PoC)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)