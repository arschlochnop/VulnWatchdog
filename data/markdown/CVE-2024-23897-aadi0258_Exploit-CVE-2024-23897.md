## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于读取的文件内容）

**影响版本:** Jenkins 2.441 及更早版本, LTS 2.426.2 及更早版本

**利用条件:** 目标Jenkins实例存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 的任意文件读取漏洞。由于 Jenkins CLI 命令解析器的一个特性，会将参数中以'@'字符开头的路径替换为文件内容，未授权的攻击者可以通过构造包含恶意文件路径的命令，读取 Jenkins 控制器文件系统上的任意文件。

**利用方式：**

1.  **漏洞原理：** Jenkins CLI 命令解析器存在缺陷，允许将以'@'字符开头的参数视为文件路径，并读取其内容。
2.  **攻击步骤：** 攻击者构造一个包含'@'字符和目标文件路径的恶意命令，通过 Jenkins CLI 发送给目标 Jenkins 实例。
3.  **利用代码分析：**
    *   `build_payload(file_path)` 函数构造恶意 payload，其中包含以`@`开头的文件路径。
    *   `perform_exploit_attempt(target_url, file_path, request_timeout)` 函数通过两个线程并发地向 Jenkins 实例发送 POST 请求，分别模拟 `download` 和 `upload` 操作。这种并发操作是利用此漏洞的关键。
    *   上传线程将构造的 payload 作为 `application/octet-stream` 的内容上传。下载线程则用于触发漏洞，读取文件内容。
    *   该 POC 尝试读取指定文件，并将读取到的内容返回。
4.  **有效性：** 根据漏洞库信息和提供的漏洞利用代码，此漏洞的POC是有效的。该漏洞已被CISA添加到已知被利用的漏洞列表中。

**投毒风险评估：**

*   分析提供的`exploit.py`文件，代码逻辑清晰，主要是构造payload并发送HTTP请求，不存在明显的恶意代码或后门。没有发现尝试修改系统文件、执行恶意命令或泄露用户信息的行为。因此，投毒风险较低，评估为 0%。

**缓解措施：**

*   升级 Jenkins 到不受影响的版本（>= 2.442, >= 2.426.3）。
*   禁用 Jenkins CLI，如果不需要。


**项目地址:** [aadi0258/Exploit-CVE-2024-23897](https://github.com/aadi0258/Exploit-CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)