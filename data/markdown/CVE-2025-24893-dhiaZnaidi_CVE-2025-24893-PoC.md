## CVE-2025-24893-XWiki-远程代码执行

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** < 15.10.11, < 16.4.1, 16.5.0RC1之前版本

**利用条件:** 需要网络访问XWiki实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24893是XWiki平台中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过向`SolrSearch`发送特制的请求来执行任意Groovy代码。该漏洞源于对`SolrSearch`宏中的输入验证不足。利用方式是构造包含恶意Groovy代码的URL，然后发送到目标XWiki服务器。服务器解析该URL时，将执行嵌入的Groovy代码，从而允许攻击者在服务器上执行任意命令。提供的POC代码通过向`/bin/get/Main/SolrSearch`路径发送带有`media=rss`参数和包含恶意Groovy代码的`text`参数的GET请求来利用此漏洞。由于是未经身份验证的远程代码执行，因此风险极高。投毒风险评估为5%，主要考虑是POC代码相对简单，没有明显恶意代码，但依旧存在一些潜在风险，例如下载README.md文件过程中，有可能会包含一些恶意代码，或者引用的URL被篡改。从搜索引擎结果来看，多个安全机构都证实了此漏洞的存在，并且有可用的POC代码。因此，此POC代码具有较高的有效性。

**利用方式总结:**

1.  **漏洞定位:**  `CVE-2025-24893` 位于XWiki平台中，存在于 `SolrSearch` 宏中，由于输入验证不足导致远程代码执行。
2.  **攻击入口:**  攻击者通过构造恶意的URL，该URL包含 `media=rss` 参数和包含恶意 Groovy 代码的 `text` 参数。
3.  **请求发送:**  构造好的URL通过GET请求发送到目标XWiki服务器的 `/bin/get/Main/SolrSearch` 路径。
4.  **代码执行:**  XWiki服务器解析请求，由于漏洞存在，嵌入在URL中的Groovy代码被执行，从而实现远程代码执行。
5.  **Payload:** Payload 经过了url编码，通过 `quote` 函数。
6.  **结果获取:**  POC代码尝试从响应的XML文本中提取命令执行的输出结果，并打印到控制台。

**项目地址:** [dhiaZnaidi/CVE-2025-24893-PoC](https://github.com/dhiaZnaidi/CVE-2025-24893-PoC)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)