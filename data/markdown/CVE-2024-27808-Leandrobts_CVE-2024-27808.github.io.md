## CVE-2024-27808

**漏洞编号:** CVE-2024-27808

**漏洞类型:** 类型混淆/内存处理错误导致任意代码执行

**影响应用:** WebKit/Safari/iOS/iPadOS/macOS/visionOS/watchOS/tvOS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.5 (iOS/iPadOS/tvOS), < 14.5 (macOS), < 1.2 (visionOS), < 10.5 (watchOS), < 17.5 (Safari)

**利用条件:** 用户需要使用存在漏洞的浏览器或应用访问恶意网页内容。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27808 是一个 WebKit 中的漏洞，处理恶意 web 内容可能导致任意代码执行。该漏洞通过改进内存处理得到修复。提供的POC代码模拟了一种TypedArray相关的攻击，通过创建一个巨大的Proxy对象来试图造成内存溢出或破坏。具体利用方式是首先通过大量的array进行内存spray，随后创建一个handler用于劫持数组的length属性，构造一个超大length的Proxy对象，然后将这个Proxy对象通过concat方法进行合并，concat操作预期触发漏洞，如果Proxy对象的length属性被成功利用，可能导致内存越界读取或写入，最终实现任意代码执行。

**有效性：** 从代码逻辑和漏洞描述来看，提供的PoC代码试图触发内存处理错误，具有一定的有效性，但成功利用取决于目标系统的具体内存布局和缓解措施。

**投毒风险：** 代码本身功能是触发漏洞，没有发现明显的恶意行为或者后门代码，如上传信息、修改系统配置等。但不能完全排除开发者可能在其他部分添加恶意代码的可能性。此处判定投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的网页。
2.  受害者使用存在漏洞的 Safari 或其他 WebKit 内核的浏览器访问该网页。
3.  恶意 JavaScript 代码利用 TypedArray 的Buffer Underflow漏洞，可能通过Proxy对象结合concat操作，造成内存越界读取或者写入，从而执行任意代码。
4.  攻击者可以利用执行的代码来控制受害者的设备。

**项目地址:** [Leandrobts/CVE-2024-27808.github.io](https://github.com/Leandrobts/CVE-2024-27808.github.io)

**漏洞详情:** [CVE-2024-27808](https://nvd.nist.gov/vuln/detail/CVE-2024-27808)