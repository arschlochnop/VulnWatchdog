## CVE-2020-17530-Apache Struts2-OGNL表达式注入

**漏洞编号:** CVE-2020-17530

**漏洞类型:** OGNL表达式注入

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 需要应用程序使用Struts2，且存在未经过滤的用户输入在tag属性中

**POC 可用性:** 是，但提供的POC无效

**投毒风险:** 100%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的OGNL表达式注入漏洞。当Struts2框架在tag属性中对未经验证的用户输入进行双重OGNL表达式计算时，可能导致远程代码执行。根据漏洞库信息和搜索引擎结果，该漏洞影响Struts 2.0.0到Struts 2.5.25版本。

**有效性：**

提供的`POC.py`文件内容是`print("哈哈哈，想屁吃呢???")`，显然这是一个无效的POC，并不能利用该漏洞。

**投毒风险：**

`POC.py`文件本身只是打印一句话，并不包含任何利用漏洞的代码。`README.md`文件只是漏洞的简单描述。 因此，该仓库的投毒风险非常高。作者上传无效POC可能存在欺骗行为。

**利用方式：**

该漏洞的利用方式是构造恶意的OGNL表达式，并将其注入到Struts2 tag的属性中。当Struts2解析该tag时，会执行恶意OGNL表达式，从而导致远程代码执行。

例如，可以利用`%{}`或者`#{}`包裹的OGNL表达式进行注入。具体的利用方式会根据不同的tag和属性有所不同，但基本原理都是利用Struts2的OGNL表达式解析功能来执行任意代码。

根据搜索结果，该漏洞已经在野外被利用。

**项目地址:** [secpool2000/CVE-2020-17530](https://github.com/secpool2000/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)