## CVE-2024-23692 - Rejetto HTTP File Server 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行受影响版本的 Rejetto HFS，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。攻击者可以通过构造特定的 HTTP 请求，在服务器上执行任意命令。\n\n**有效性：**\n提供的 PoC 代码 `CVE-2024-23692.sh` 似乎有效。它构造一个包含恶意模板注入的 HTTP GET 请求，利用 `nc` (netcat) 发送到目标服务器，然后显示响应。脚本接受目标 IP 地址、端口和要执行的命令作为参数。 README.md 文件也提供了使用示例，表明可以执行系统命令或部署反向 shell。\n\n**投毒风险：**\n评估投毒风险时，需要考虑以下几点：\n1.  **代码来源：** 代码来自非官方渠道（GitHub 上的个人仓库）。虽然该漏洞本身是真实存在的，但脚本可能包含恶意代码。\n2.  **脚本功能：** 脚本使用 `nc` 工具发送构造的 HTTP 请求。恶意代码可能被隐藏在构造的请求本身（例如，试图下载和执行其他恶意程序），或者在利用成功后执行其他操作。\n3.  **代码审查：** 快速审查脚本发现其核心功能是利用漏洞。投毒代码可能存在于不明显之处，例如对命令执行结果的篡改或者植入后门。\n4.  **网络行为：** 脚本中使用了`nc`，正常使用是发送恶意请求，如果存在其他网络连接行为，需要特别关注\n\n基于上述分析，认为存在10%的投毒风险。风险主要来自于脚本可能尝试利用漏洞植入后门或者执行其他恶意活动。\n\n**利用方式：**\n1.  **构造恶意 HTTP 请求：** PoC 脚本构造一个带有精心设计的查询字符串的 HTTP GET 请求。该查询字符串包含一个模板注入，允许执行服务器端代码。关键参数是 `cmd`，它包含要执行的命令。\n2.  **发送请求：** 脚本使用 `nc` 工具将构造的 HTTP 请求发送到目标服务器。\n3.  **执行命令：** 如果服务器存在漏洞，它将解析并执行注入的模板，从而执行 `cmd` 参数中指定的命令。\n4.  **获取结果：** 服务器的响应包含命令执行的结果。PoC 脚本捕获并显示此响应。

**项目地址:** [Mr-r00t11/CVE-2024-23692](https://github.com/Mr-r00t11/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)