## CVE-2020-14882/CVE-2020-14883 WebLogic 未授权远程代码执行

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 目标服务器开启WebLogic服务，且存在未授权访问漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-14882 允许未经身份验证的攻击者通过 HTTP 访问 WebLogic Server Console。CVE-2020-14883 允许攻击者利用未经授权的访问权限在 Console 中执行任意代码，从而实现远程代码执行。根据漏洞库信息和搜索引擎结果，此漏洞的CVSS 3.1评分为9.8，属于严重级别，表明其易于利用，影响巨大。

**利用方式：**

1.  **CVE-2020-14882 (未授权访问):** 攻击者通过构造特定的URL，例如`/console/css/%25%32%65%25%32%65%25%32%66consolejndi.portal`，绕过身份验证，访问WebLogic控制台。
2.  **CVE-2020-14883 (远程代码执行):** 在成功绕过身份验证后，攻击者可以构造包含恶意 MVEL 表达式的 URL，例如 `/console/css/%25%32%65%25%32%65%25%32%66consolejndi.portal?test_handle=com.tangosol.coherence.mvel2.sh.ShellSession(...)`，并在HTTP头部 `cmd` 中指定要执行的系统命令。WebLogic服务器将执行此命令，并将结果返回给攻击者。

**POC有效性：**
提供的 Python 脚本 `CVE-2020-14882&14883.py` 实现了上述利用方式。首先，它检测 CVE-2020-14882 是否存在，然后利用 CVE-2020-14883 执行命令。

**投毒风险：**
通过分析提供的POC代码，没有发现任何明显的投毒代码。脚本的功能是利用漏洞进行命令执行，没有添加任何恶意代码来破坏系统或传播恶意软件。虽然脚本本身可以被恶意使用，但这不属于投毒范畴。作者有可能会留下后门，通过命令执行的方式进行控制，但是当前没有办法确定是否存在后门，但可以确定的是，该代码不属于投毒代码，因此投毒风险为0%。

**缓解措施：**
*   及时安装 Oracle 官方提供的补丁。
*   限制对 WebLogic Console 的网络访问，仅允许授权用户访问。
*   配置 Web 应用防火墙 (WAF) 以检测和阻止恶意的 HTTP 请求。

**项目地址:** [N0Coriander/CVE-2020-14882-14883](https://github.com/N0Coriander/CVE-2020-14882-14883)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)