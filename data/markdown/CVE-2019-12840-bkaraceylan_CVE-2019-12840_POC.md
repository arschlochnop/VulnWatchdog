## CVE-2019-12840-Webmin-远程命令执行

**漏洞编号:** CVE-2019-12840

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可以完全控制服务器

**影响版本:** <= 1.910

**利用条件:** 需要Webmin用户具有Package Updates模块的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-12840 是一个存在于 Webmin 1.910 及更早版本中的远程命令执行漏洞。任何有权访问 "Package Updates" 模块的用户都可以利用此漏洞通过 update.cgi 的 data 参数执行任意命令，获得 root 权限。

**有效性：**

提供的 exploit.py 代码有效。根据代码和漏洞信息，利用方式如下：

1.  **登录 Webmin:**  利用提供的用户名和密码登录 Webmin。
2.  **绕过一些检测:** 访问/proc/index_tree.cgi，设置必要的Cookie。
3.  **命令注入：** 通过 "Package Updates" 模块的 update.cgi 页面，利用 data 参数注入命令。攻击者将命令进行 Base64 编码，然后将其插入到 "u" 参数中，最终通过 bash 解码执行。具体注入点位于 `data=f"u=acl%2Fapt&u=%20%7C%20{cmd}&ok_top=Update+Selected+Packages"`。通过管道符 `|` 将命令注入到 apt 的某个操作中，从而执行任意命令。

**投毒风险：**

该POC代码本身没有明显的投毒迹象。代码逻辑清晰，主要包含登录、请求特定页面绕过限制以及通过 "Package Updates" 模块执行命令的功能。所有操作都与漏洞描述相符，没有发现尝试安装后门、上传恶意文件或执行其他未经授权操作的代码。因此，投毒风险评估为 0%。

**利用方式：**

1.  **目标确认:**  确定目标 Webmin 服务器的版本是否在 1.910 或更早版本。
2.  **权限获取:**  获取一个具有 "Package Updates" 模块访问权限的 Webmin 用户名和密码。
3.  **利用：**  运行 exploit.py，提供目标 URL、端口、用户名、密码以及要执行的命令。
4.  **执行结果:**  命令将在目标服务器上以 root 权限执行。

**搜索引擎结果：**

搜索结果确认了漏洞的存在，描述和严重性等级与漏洞库信息和 POC 代码一致。同时，也提供了其他关于该漏洞的参考链接，例如 NVD 详细信息和 Broadcom 安全中心的攻击签名。

**项目地址:** [bkaraceylan/CVE-2019-12840_POC](https://github.com/bkaraceylan/CVE-2019-12840_POC)

**漏洞详情:** [CVE-2019-12840](https://nvd.nist.gov/vuln/detail/CVE-2019-12840)