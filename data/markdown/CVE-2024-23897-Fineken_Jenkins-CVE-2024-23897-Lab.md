## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，甚至RCE

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP/WebSocket/SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，利用 Jenkins CLI 中的参数解析功能缺陷，攻击者可以通过 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。漏洞存在于 Jenkins 2.441 及更早版本，以及 LTS 2.426.2 及更早版本中。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认该漏洞是有效的。漏洞利用代码中提供了两种利用方法：
1.  **help 命令：** 利用 `help` 命令读取文件的前几行。
2.  **connect-node 命令：** 利用 `connect-node` 命令读取文件的完整内容。
这些方法都通过 `-s` 参数指定 Jenkins 的 URL，并通过 `-http` 参数使用 HTTP 协议与 Jenkins CLI 进行交互。`@/etc/passwd` 等参数指定了要读取的文件路径。

**投毒风险分析：**
在提供的漏洞利用代码中，没有发现明显的投毒代码。所有的脚本和配置文件都指向利用 CVE-2024-23897 漏洞读取文件。`auto-exploit.sh` 脚本只是自动化了利用过程，没有包含任何恶意行为。

**利用方式分析：**
1.  攻击者需要首先获取 `jenkins-cli.jar` 文件，可以通过访问 `http://vulnerable-jenkins:8080/jnlpJars/jenkins-cli.jar` 下载。
2.  然后，攻击者可以使用 `java -jar jenkins-cli.jar` 命令，结合 `help` 或 `connect-node` 命令，以及 `@` 符号和文件路径，读取目标文件。
3.  攻击者可以使用不同的文件路径，如 `/etc/passwd`、`/opt/test-files/secret.txt`、`/var/jenkins_home/config.xml` 等，读取系统中的敏感信息。

**搜索引擎信息补充：**
搜索结果表明，该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。该漏洞可能对 CI/CD 管道构成风险，并可能导致 RCE（远程代码执行），但直接的利用方式是任意文件读取。

**项目地址:** [Fineken/Jenkins-CVE-2024-23897-Lab](https://github.com/Fineken/Jenkins-CVE-2024-23897-Lab)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)