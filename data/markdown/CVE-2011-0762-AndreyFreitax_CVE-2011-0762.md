## CVE-2011-0762 - vsftpd STAT 命令拒绝服务

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致CPU资源耗尽和进程槽耗尽

**影响版本:** 2.3.3之前

**利用条件:** 需要FTP服务开启，且攻击者需要通过身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2011-0762 漏洞存在于 vsftpd 2.3.3 之前的版本中，位于 ls.c 文件中的 `vsf_filename_passes_filter` 函数。该漏洞允许经过身份验证的远程用户通过在多个 FTP 会话中的 STAT 命令中构造恶意的 glob 表达式，导致拒绝服务（CPU 消耗和进程槽耗尽）。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出该漏洞会导致拒绝服务，而搜索结果中也包含相关的利用程序和漏洞细节。

**投毒风险：**

提供的 C 语言 exploit 代码分析显示，它只是连接到 FTP 服务器，使用提供的用户名和密码（或默认的匿名凭据）进行身份验证，然后发送一个包含大量嵌套花括号的 `STAT` 命令。这种嵌套结构会导致 `vsf_filename_passes_filter` 函数进行过多的计算，从而导致拒绝服务。代码本身不包含任何恶意代码，例如写入任意文件、执行系统命令等。因此，投毒风险评估为0%。

**利用方式：**

1.  **连接到 FTP 服务器：** 使用给定的主机和端口建立到目标 vsftpd 服务器的连接。
2.  **身份验证：** 使用提供的用户名和密码（或默认的 anonymous/cxib.net@127.0.0.1）登录 FTP 服务器。
3.  **发送 STAT 命令：** 发送精心构造的 `STAT` 命令，其中包含大量嵌套的花括号，例如：`STAT {{*},{{*},...}}`。这个命令会触发 `vsf_filename_passes_filter` 函数中的漏洞。
4.  **拒绝服务：** 由于 `vsf_filename_passes_filter` 函数尝试匹配嵌套的 glob 表达式，服务器会消耗大量的 CPU 资源，最终导致拒绝服务。攻击者可以通过建立多个 FTP 会话并发送类似的 `STAT` 命令来加剧 DoS 攻击。

综上所述，该漏洞利用方式简单，利用代码清晰，主要通过发送畸形的STAT 命令耗尽服务器资源达成拒绝服务攻击。


**项目地址:** [AndreyFreitax/CVE-2011-0762](https://github.com/AndreyFreitax/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)