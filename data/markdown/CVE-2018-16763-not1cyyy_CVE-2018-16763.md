## CVE-2018-16763-FuelCMS-远程代码执行

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行

**影响应用:** Fuel CMS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 1.4.1

**利用条件:** 需要目标服务器运行Fuel CMS 1.4.1版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-16763是Fuel CMS 1.4.1版本中存在的一个远程代码执行漏洞。根据漏洞信息和搜索结果，攻击者可以通过 `pages/select/` 的 `filter` 参数或者 `preview/` 的 `data` 参数，进行PHP代码注入，从而执行任意代码。

**有效性：**
提供的POC代码 `FuelCMS.py` 利用了 `pages/select/?filter=` 参数进行攻击。代码通过构造包含PHP代码的URL，发送GET请求到目标服务器，然后解析服务器返回的结果，提取执行命令的结果。POC代码结构清晰，实现了发送恶意请求和解析结果的功能，因此判断POC代码是有效的。

**投毒风险：**
对POC代码的分析发现，其主要功能是利用漏洞执行命令和建立反向shell。虽然代码包含从命令行获取IP地址和端口的功能，这可能被误用，但核心功能仍然是漏洞利用。LICENSE文件为GPL v3，可以用于商业。

*   **可疑点：** 代码中包含 `shell_me` 功能，该功能会尝试建立反向shell。虽然这是漏洞利用的常见手段，但如果攻击者修改此部分代码，可能会植入恶意后门。

*   **分析结果：** 综合考虑，该仓库存在投毒代码的可能性较低，但不能完全排除，可能性评估为10%。

**利用方式：**
1.  **确定目标：**  确认目标服务器正在运行Fuel CMS 1.4.1版本。
2.  **执行命令：** 使用POC脚本，通过指定目标IP地址，利用`pages/select/?filter=` 参数注入PHP代码，执行任意系统命令。 例如： `python3 FuelCMS.py <target_ip>`，然后在交互式界面中输入要执行的命令。
3.  **反向Shell：**  使用 `shell_me` 命令，指定攻击机的IP地址和端口，在目标服务器上执行反向shell命令，从而获得对目标服务器的控制权。

该漏洞利用的关键在于构造恶意的URL，将PHP代码注入到服务器中。由于该漏洞无需身份验证，因此攻击者可以直接发送恶意请求利用此漏洞。

**项目地址:** [not1cyyy/CVE-2018-16763](https://github.com/not1cyyy/CVE-2018-16763)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)