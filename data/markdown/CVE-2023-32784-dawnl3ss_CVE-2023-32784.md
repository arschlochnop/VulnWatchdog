## CVE-2023-32784-KeePass-主密码明文泄露

**漏洞编号:** CVE-2023-32784

**漏洞类型:** 信息泄露

**影响应用:** KeePass

**危害等级:** 高危，可能导致数据库泄露

**影响版本:** < 2.54

**利用条件:** 需要能够访问目标系统的内存dump文件（如KeePass进程dump、swap file、hibernation file、RAM dump）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32784允许攻击者通过分析KeePass 2.x（2.54之前版本）的内存dump来恢复明文主密码。该POC利用脚本 `poc.py` 实现了从内存dump中提取可能的密码字符的功能。虽然脚本注释中提到第一个字符无法直接恢复，但仍可以通过爆破方式尝试。利用过程主要分为以下几步：

1.  **获取内存Dump：** 攻击者首先需要获取KeePass进程的内存dump，可能通过dump KeePass进程、读取交换文件（swap file）、休眠文件（hiberfil.sys）或者整个系统的RAM dump来实现。
2.  **运行POC脚本：** 攻击者使用 `python3 poc.py <PathToDmp>` 命令运行提供的POC脚本，指定内存dump文件的路径。
3.  **提取候选字符：**  脚本会扫描内存dump，查找符合特定模式 (`0xCF 0x25`) 的字符串片段，这些片段很可能是主密码的组成部分。
4.  **生成可能的密码组合：**  脚本根据提取出的候选字符，生成所有可能的密码组合。
5.  **爆破第一个字符（可选）：**由于脚本无法直接恢复第一个字符，攻击者可以使用`keepass-pwn.sh` 脚本，通过字典爆破的方式尝试不同的第一个字符，进而打开KeePass数据库。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞POC的有效性较高。多个来源都证实了可以通过内存dump恢复KeePass主密码。提供的POC脚本也实现了从内存dump中提取候选密码字符的功能。

**投毒风险评估：**

代码量较少，且逻辑相对简单，重点关注 `poc.py` 和 `keepass-pwn.sh` 两个脚本。`poc.py`脚本的功能是解析内存dump文件，提取可能的密码字符，然后进行排列组合，没有发现恶意代码。`keepass-pwn.sh`是一个爆破脚本，调用了`kpcli`，也没有发现明显恶意代码。`README.md`只是使用说明，也没有投毒代码。但是，由于该代码逻辑依赖特定的内存结构，如果目标系统或KeePass版本与代码的预期不符，可能导致提取的密码不正确。此外，攻击者可能修改脚本，增加恶意功能，因此存在一定的投毒风险。整体投毒风险估计为10%。

**利用方式总结：**

攻击者首先需要获取目标系统的内存dump，然后使用提供的POC脚本提取可能的密码字符。最后，结合字典爆破的方式（针对第一个字符）来破解KeePass数据库。


**项目地址:** [dawnl3ss/CVE-2023-32784](https://github.com/dawnl3ss/CVE-2023-32784)

**漏洞详情:** [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-32784)