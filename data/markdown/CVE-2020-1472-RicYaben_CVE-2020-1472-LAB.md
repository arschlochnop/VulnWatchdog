## CVE-2020-1472 Zerologon Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被接管

**影响版本:** 受影响的Windows Server版本，具体见漏洞库信息

**利用条件:** 需要位于目标网络的内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经验证的攻击者可以通过MS-NRPC连接到域控制器，并使用一组全零的加密密钥来执行身份验证，从而完全控制域。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响多个版本的Windows Server，并且存在公开可用的POC。POC代码（zerologon_tester.py）旨在测试目标域控制器是否存在漏洞，通过尝试Netlogon身份验证绕过进行检测。如果成功绕过，脚本将立即终止。因此，提供的POC代码是有效的漏洞验证工具。

**投毒风险：**
分析Dockerfile、LICENSE、README.md以及zerologon_tester.py的内容，没有发现明显的恶意代码或后门。Dockerfile用于构建包含POC脚本的Docker镜像，LICENSE是MIT许可，允许自由使用和修改，README.md提供使用说明。zerologon_tester.py脚本主要用于验证漏洞存在，不执行任何提权或持久化的操作。但是，任何代码都存在被篡改的可能。因此，认为存在1%的潜在投毒风险，主要来自于以下可能：

1.  **依赖项投毒：** requirements.txt文件中指定的依赖库（特别是impacket）可能被替换为恶意版本。
2.  **构建过程投毒：** Dockerfile构建过程中，可能存在恶意指令篡改。

**利用方式：**
1.  **环境准备：** 需要一台能够访问目标域控制器的机器，并安装Python环境和相关依赖库（impacket, cryptography）。
2.  **漏洞验证：** 运行zerologon_tester.py脚本，指定目标域的NetBIOS名称和IP地址。脚本会尝试使用全零密钥进行Netlogon身份验证绕过。
3.  **攻击：** 如果漏洞验证成功，则目标域控制器存在Zerologon漏洞。攻击者可以使用更复杂的利用代码来重置域控制器的计算机密码，从而获得域管理员权限。

搜索结果中包含了大量的漏洞分析文章和缓解措施，表明该漏洞已经被广泛研究和利用。Microsoft已经发布了补丁程序来修复此漏洞，因此确保域控制器已安装最新的安全更新至关重要。

**项目地址:** [RicYaben/CVE-2020-1472-LAB](https://github.com/RicYaben/CVE-2020-1472-LAB)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)