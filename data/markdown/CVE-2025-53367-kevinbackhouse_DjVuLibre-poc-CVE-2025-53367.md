## CVE-2025-53367-DjVuLibre-OOB-Write

**漏洞编号:** CVE-2025-53367

**漏洞类型:** OOB-Write（越界写）

**影响应用:** DjVuLibre

**危害等级:** 高危，可能导致堆损坏，代码执行

**影响版本:** < 3.5.29

**利用条件:** 需要用户打开恶意构造的DjVu文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53367 是 DjVuLibre 中 MMRDecoder::scanruns 方法中的一个越界写入漏洞。由于该方法没有检查 xr 指针是否在已分配缓冲区范围内，导致可以写入到已分配的内存之外，从而造成堆损坏。攻击者可以创建一个特制的 DjVu 文件，当用户尝试打开此文件时，触发该漏洞，可能导致代码执行。

**有效性：**
根据漏洞描述和搜索结果，该漏洞是可利用的。Github 安全博客也提到了这一点，并提供了相关分析。NVD、RedHat、Tenable 的 CVE 页面也确认了该漏洞的存在。

**投毒风险：**
提供的漏洞利用代码看起来像是 DjVuLibre 的许可证文件，没有发现明显的恶意代码。但是，在实际利用中，攻击者可能会在特制的 DjVu 文件中嵌入恶意代码，从而实现远程代码执行。这里主要指篡改DjVu文件本身，而不是License。

**利用方式：**
1.  攻击者创建一个恶意构造的 DjVu 文件，其中包含精心设计的数据，以便在 MMRDecoder::scanruns 方法中触发越界写入。
2.  攻击者诱使用户打开此 DjVu 文件。这可以通过电子邮件、恶意网站或其他方式完成。
3.  当 DjVuLibre 处理该恶意文件时，MMRDecoder::scanruns 方法中的越界写入漏洞会被触发，导致堆损坏。
4.  攻击者可以利用堆损坏来执行任意代码。这通常需要精心的堆喷射和其他利用技术。


**项目地址:** [kevinbackhouse/DjVuLibre-poc-CVE-2025-53367](https://github.com/kevinbackhouse/DjVuLibre-poc-CVE-2025-53367)

**漏洞详情:** [CVE-2025-53367](https://nvd.nist.gov/vuln/detail/CVE-2025-53367)