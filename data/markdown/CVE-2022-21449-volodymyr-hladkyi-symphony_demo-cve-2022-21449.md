## CVE-2022-21449 - Java ECDSA 签名绕过

**漏洞编号:** CVE-2022-21449

**漏洞类型:** 签名绕过

**影响应用:** Java SE JDK and JRE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，可能导致未授权访问和数据篡改

**影响版本:** Oracle Java SE: 17.0.2, 18; Oracle GraalVM Enterprise Edition: 21.3.1, 22.0.0.2

**利用条件:** 需要目标系统运行受影响的 Java 版本，且依赖 ECDSA 签名进行身份验证或授权。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21449 'Psychic Signatures' 漏洞存在于 Java 的 ECDSA 签名验证实现中。攻击者可以通过提供 r=0 和 s=0 的伪造签名，绕过签名验证。 

**有效性：**
提供的 PoC 代码有效。它演示了如何生成一个包含零签名 (r=0, s=0) 的伪造 JWT token，并且在未修复漏洞的 Java 17 版本上，该 token 可以通过验证，从而绕过身份验证。

**投毒风险：**
PoC 代码主要用于演示漏洞，其目的明确，用于展示如何利用零签名绕过 ECDSA 验证。该仓库中的`ec_private_key.pem`和`ec_public_key.pem`用于生成和验证JWT，如果用户直接使用了这些密钥，会造成安全问题，但不属于投毒范畴。由于是演示PoC，所以主要关注点在于攻击原理的呈现，代码本身实现比较直接，因此判断代码存在投毒的可能性较低，大约为1%。

**利用方式：**
1.  攻击者构造一个 JWT，其中包含所需的 payload（例如，提升的权限）。
2.  攻击者将 JWT 的签名部分设置为零值（r=0, s=0）。
3.  当应用程序使用存在漏洞的 Java 版本验证 JWT 时，由于 ECDSA 签名验证的缺陷，零签名会被错误地接受为有效签名。
4.  攻击者从而获得未授权的访问权限。

**项目地址:** [volodymyr-hladkyi-symphony/demo-cve-2022-21449](https://github.com/volodymyr-hladkyi-symphony/demo-cve-2022-21449)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)