## CVE-2020-24913-QCubed-SQL注入

**漏洞编号:** CVE-2020-24913

**漏洞类型:** SQL注入

**影响应用:** QCubed

**危害等级:** 高危，可能导致数据库信息泄露

**影响版本:** <= 3.1.1 (所有版本)

**利用条件:** 目标系统运行QCubed框架，且profile.php文件可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2020-24913是QCubed框架profile.php文件中strQuery参数存在的SQL注入漏洞。该漏洞允许未经身份验证的攻击者通过构造恶意SQL语句来访问数据库。

**有效性：**
提供的PoC代码看起来有效，因为它提供了测试漏洞是否存在、创建会话、暴力破解表名和列名、以及提取数据的工具。PoC代码中的不同模式针对SQL注入漏洞利用的不同阶段。

**投毒风险：**
PoC代码的投毒风险较低，大约为10%。虽然代码本身看起来是为漏洞利用而设计的，但仍存在潜在的风险：
*   `args.ts`文件中的参数解析部分存在一定的风险。如果目标URL或其他参数被恶意构造，可能会导致意外行为。例如，虽然目前没有直接的`eval`或`exec`函数，但代码如果被修改，攻击者可能会引入恶意代码。
*   依赖管理：该PoC使用`bun install`安装依赖。依赖项本身可能包含恶意代码。
*   文件名/目录名：虽然不太可能，但目录名`/tmp/57a29f3a9a33fab6ea96bbdef1d41a85/`本身很奇怪。这可能是为了隐藏恶意活动，或者只是自动生成的名字。

**利用方式：**
漏洞利用方式如下：
1.  **漏洞检测：** 使用`bun run exploit vulnerable -u <target_url>`检测目标系统是否存在漏洞。
2.  **创建会话：** 使用`bun run exploit create -n <session_name> -u <target_url>`创建一个新的会话，用于存储目标信息。
3.  **表名暴力破解：** 使用`bun run exploit brute-table -n <session_name> -w <wordlist_path>`暴力破解数据库表名。需要提供一个包含常见表名的字典文件。
4.  **列名暴力破解：** 使用`bun run exploit brute-column -n <session_name> -t <table_name> -c <column_name> -i 1`暴力破解指定表的列名。 
5.  **数据提取：** 使用`bun run exploit show-rows -n <session_name> -t <table_name>`提取指定表的数据。

通过上述步骤，攻击者可以逐步获取数据库中的敏感信息。

**项目地址:** [shpaw415/CVE-2020-24913-exploit](https://github.com/shpaw415/CVE-2020-24913-exploit)

**漏洞详情:** [CVE-2020-24913](https://nvd.nist.gov/vuln/detail/CVE-2020-24913)