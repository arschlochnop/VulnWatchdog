## CVE-2020-1472 Zerologon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 需要位于目标域控制器的网络中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-1472（Zerologon）是一个存在于Windows Server Netlogon Remote Protocol (MS-NRPC) 中的特权提升漏洞。攻击者通过与域控制器建立脆弱的Netlogon安全通道连接，可以运行特制的应用程序并获取域管理员权限。

**有效性分析：**

提供的POC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在Zerologon漏洞。该脚本通过尝试使用全零的challenge和credential来进行Netlogon身份验证绕过。如果域控制器存在漏洞，则身份验证将成功，脚本会立即终止。如果域控制器已打补丁，脚本会在多次尝试后放弃并认为目标不存在漏洞（存在极低的假阴性概率）。根据搜索引擎结果，该漏洞利用代码的思路和方法与公开的漏洞利用方式一致，因此判断提供的POC代码是有效的。

**投毒风险分析：**

通过对Dockerfile，requirements.txt和zerologon_tester.py的代码分析，该仓库主要包含漏洞利用的测试代码和依赖项，未发现明显的恶意代码或后门，代码的功能主要是实现对Zerologon漏洞的检测,因此投毒风险较低。

**利用方式：**

1.  **漏洞利用阶段：** 攻击者首先需要与目标域控制器建立网络连接。然后，攻击者运行Zerologon漏洞利用脚本（例如提供的`zerologon_tester.py`的修改版本），该脚本通过MS-NRPC协议发送特制的身份验证请求，利用加密算法中的漏洞将域控制器的机器帐户密码置零。
2.  **权限提升阶段：** 成功将域控制器的机器帐户密码置零后，攻击者可以使用该零密码来获得域控制器的身份验证，从而完全控制域。
3.  **持久化和横向移动（可选）：** 攻击者获得域管理员权限后，可以进行持久化操作（例如创建新的管理员帐户）并在域内进行横向移动，以控制更多系统和数据。

**项目地址:** [Anonymous-Family/CVE-2020-1472](https://github.com/Anonymous-Family/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)