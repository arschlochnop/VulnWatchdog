## CVE-2025-24813 - Apache Tomcat 路径等价/路径遍历漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 文件内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露、恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 安全敏感上传URL是公共上传URL的子目录，攻击者需要知道安全敏感文件的名称, 并且安全敏感文件通过部分PUT上传。 或者 默认Servlet启用写入 (默认禁用), 支持部分PUT (默认启用), 应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以利用此漏洞绕过访问控制，上传恶意文件，甚至执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用**有效**。搜索引擎结果显示该漏洞已被公开披露，并且存在活跃利用。PoC代码提供了一种利用方式，即通过PUT请求上传JSP webshell，如果成功，攻击者可以通过访问上传的JSP文件来执行任意命令。

**投毒风险：**
提供的PoC代码比较简单，主要功能是上传一个JSP webshell。经过分析，没有发现作者有意隐藏的投毒代码。JSP webshell 本身存在风险，但这是漏洞利用本身固有的风险，而不是作者额外添加的恶意代码。因此，该仓库的投毒风险评估为**0%**。

**利用方式：**
1.  **先决条件：** 目标Tomcat服务器需要满足以下条件：
    *   `writes`参数在Tomcat的DefaultServlet中启用 (默认禁用)
    *   启用`支持partial PUT` (默认启用)
    *   目标上传路径为可写。
    *   对于RCE，需要应用使用Tomcat基于文件的session持久化，默认存储位置，应用程序包含一个可以在反序列化攻击中被利用的库。
2.  **上传JSP Webshell：** 使用PoC脚本，通过构造包含路径遍历的PUT请求，将JSP webshell上传到服务器的webapp目录中。请求类似如下：
    ```
    PUT /uploads/../webapps/ROOT/updates.jsp HTTP/1.1
    Content-Type: application/x-jsp
    ```
    其中`updates.jsp`为webshell的文件名。
3.  **执行命令：** 成功上传后，攻击者可以通过访问上传的JSP webshell，在服务器上执行任意命令。例如，如果上传的路径是`/updates.jsp`，则访问`http://<target>/updates.jsp?cmd=<command>`即可执行命令。

**总结：**
CVE-2025-24813是一个高危漏洞，利用条件相对苛刻, 如果目标Tomcat服务器配置不当，攻击者可以利用该漏洞进行RCE或信息泄露，务必及时升级到安全版本。

**项目地址:** [La3B0z/CVE-2025-24813-POC](https://github.com/La3B0z/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)