## CVE-2021-34527 PrintNightmare Windows Print Spooler Remote Code Execution Vulnerability

**漏洞编号:** CVE-2021-34527

**漏洞类型:** 远程代码执行 (RCE) / 本地权限提升 (LPE)

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致远程代码执行，系统完全控制

**影响版本:** 受影响的Windows版本众多，具体请参考漏洞库信息。

**利用条件:** 需要目标系统开启Print Spooler服务，在某些利用场景下，可能需要经过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-34527，又名PrintNightmare，是一个Windows Print Spooler服务中的严重漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码，获得SYSTEM权限。搜索引擎结果显示，此漏洞影响广泛，并且存在公开的PoC。提供的漏洞利用代码是一个PowerShell脚本，它通过利用Print Spooler服务的漏洞来实现本地权限提升。该脚本通过嵌入Base64编码的GZIP压缩DLL payload，并根据用户提供的参数进行修改，然后将其加载到Print Spooler服务中。该DLL payload的默认行为是向本地管理员组添加新用户。利用方式主要有两种：一种是远程代码执行，需要网络访问；另一种是本地权限提升，攻击者需要在目标系统上已经具有一定的权限。分析PoC代码，发现其主要功能是权限提升，并没有明显的恶意代码。但是，用户在使用自定义DLL payload时，存在被投毒的风险。因此，虽然PoC本身看起来没有明显的投毒行为，但用户需要谨慎使用自定义DLL，避免加载恶意代码。

**项目地址:** [AUSK1LL9/CVE-2021-34527](https://github.com/AUSK1LL9/CVE-2021-34527)

**漏洞详情:** [CVE-2021-34527](https://nvd.nist.gov/vuln/detail/CVE-2021-34527)