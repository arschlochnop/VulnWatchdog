## CVE-2025-1661-HUSKY WooCommerce插件-本地文件包含

**漏洞编号:** CVE-2025-1661

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** HUSKY – Products Filter Professional for WooCommerce

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 1.3.6.5

**利用条件:** 需要目标WordPress站点安装并启用存在漏洞的HUSKY插件

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2025-1661漏洞存在于HUSKY – Products Filter Professional for WooCommerce插件中，是一个未经身份验证的本地文件包含漏洞。攻击者可以利用`woof_text_search` AJAX action的`template`参数，包含并执行服务器上的任意文件。 

**利用方式：**

1.  **版本检测:** 脚本首先尝试读取 `readme.txt` 文件确定插件版本，并判断版本是否小于 1.3.6.6，确认是否存在漏洞。
2.  **查找Nonce:** 通过访问站点首页或其子页面，解析HTML源码，查找名为 `woof_text_search_nonce` 的input标签，提取其 `value` 属性值，该值用于绕过插件的CSRF保护。
3.  **日志投毒 (RCE):** 通过向Apache的access.log文件写入包含PHP代码的User-Agent，实现日志投毒。然后通过LFI漏洞包含该日志文件，并执行其中的PHP代码，实现远程代码执行。脚本构造包含 `<?php system($_GET['cmd']); ?>` 的User-Agent，通过LFI读取日志文件，并通过GET参数`cmd`传递要执行的命令。
4.  **本地文件包含 (LFI):**  直接利用 LFI 读取目标服务器上的文件，通过构造 `template` 参数的值，指向目标文件路径。脚本将目标文件路径拼接到 `../../../../../../../../../../../..` 这样的字符串后面，实现目录穿越。

**有效性：** 根据漏洞描述和PoC代码，此漏洞利用非常有效，因为它可以未经身份验证地读取服务器上的任何文件或执行命令。

**投毒风险：** 此PoC代码存在极高的投毒风险。 它将User-Agent设置为包含PHP代码，这意味着如果其他用户或服务使用此脚本访问目标服务器，它们也可能意外地将恶意代码注入到Web服务器的日志文件中，或者在测试过程中被滥用。


**项目地址:** [gbrsh/CVE-2025-1661](https://github.com/gbrsh/CVE-2025-1661)

**漏洞详情:** [CVE-2025-1661](https://nvd.nist.gov/vuln/detail/CVE-2025-1661)