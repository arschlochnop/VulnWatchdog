## CVE-2025-24893 - XWiki RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 15.10.11, < 16.4.1 (受影响版本范围)

**利用条件:** 需要目标XWiki实例可以通过网络访问，并且攻击者可以控制一个HTTP/HTTPS服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893 是一个 XWiki 平台中的远程代码执行漏洞，允许未经身份验证的攻击者通过构造恶意的 SolrSearch 请求来执行任意 Groovy 代码。 

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞利用的有效性很高。漏洞库信息明确指出这是一个未经身份验证的远程代码执行漏洞， CVSS 评分为 9.8，属于严重级别。搜索引擎结果中也包含多个安全厂商的分析和警告，以及CISA的公告，表明该漏洞已得到广泛关注和验证。PoC代码提供了一个完整的利用脚本，可以执行任意命令。

**投毒风险分析：**

PoC代码的主要功能是从攻击者控制的服务器上下载并执行恶意文件。潜在的投毒风险可能存在于以下几个方面：

1.  **恶意文件内容：** 攻击者可以轻易地在 `--file` 参数指定的文件中插入恶意代码。 PoC本身的功能就是下载并执行该文件，因此存在极高的自定义恶意行为可能性。 此处PoC代码本身没有展现出任何额外的后门或者恶意行为, 但用户在使用该PoC时，必须仔细检查从攻击者服务器下载的文件的内容。
2.  **依赖项投毒：** PoC脚本依赖于 `requests` 等 Python 库。如果这些依赖项被恶意篡改（例如通过PyPI投毒），可能会导致额外的安全风险。建议使用安全的包管理工具，例如 `pipenv` 或 `poetry` ，并验证依赖项的完整性。
3. **Github账号风险:** 虽然该作者已经贡献了POC,但Github账号仍然存在被盗用的风险。仓库本身被植入恶意代码的概率较低,除非该账户被黑客攻破。

综合评估，虽然PoC本身没有明显的恶意代码，但用户必须高度警惕从攻击者服务器下载的文件的内容，以及PoC代码依赖项的安全性。因此，投毒风险评估为10%。

**漏洞利用方式：**

1.  **确定目标 XWiki 实例：** 找到存在漏洞的 XWiki 实例，版本低于 15.10.11 或低于 16.4.1。
2.  **准备攻击者服务器：** 搭建一个可以通过 HTTP/HTTPS 访问的服务器，并将要执行的恶意脚本（例如 `exploit.sh`）放置在该服务器上。
3.  **执行 PoC 脚本：** 使用提供的 `exploit.py` 脚本，指定目标 XWiki 实例的 URL、攻击者服务器的地址和恶意脚本的文件名。
4.  **利用成功：** PoC 脚本会构造恶意的 SolrSearch 请求，将恶意脚本下载到目标系统并执行。攻击者可以在目标系统上执行任意命令。

**项目地址:** [570RMBR3AK3R/xwiki-cve-2025-24893-poc](https://github.com/570RMBR3AK3R/xwiki-cve-2025-24893-poc)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)