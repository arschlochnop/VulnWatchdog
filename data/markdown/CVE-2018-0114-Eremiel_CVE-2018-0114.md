## CVE-2018-0114-Node-jose-JWT 签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT 签名伪造

**影响应用:** Node-jose Library

**危害等级:** 高危，可能导致权限提升和身份伪造

**影响版本:** < 0.11.0

**利用条件:** 需要目标系统使用存在漏洞的 Node-jose 库来验证 JWT。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-0114 漏洞存在于 Cisco node-jose 开源库 0.11.0 之前的版本中。该漏洞允许未经身份验证的远程攻击者使用嵌入在令牌中的密钥重新签名令牌。该漏洞是由于 node-jose 遵循 JSON Web Signature (JWS) 标准 for JSON Web Tokens (JWTs) 造成的。该标准规定，表示公钥的 JSON Web Key (JWK) 可以嵌入到 JWS 的标头中。然后信任此公钥进行验证。攻击者可以通过删除原始签名，将新的公钥添加到标头，然后使用与嵌入在该 JWS 标头中的公钥关联的（攻击者拥有的）私钥对对象进行签名来利用此漏洞。

**有效性分析：**

根据漏洞描述和搜索结果，该漏洞允许攻击者通过在 JWT 头部嵌入攻击者控制的公钥，并使用对应的私钥重新签名 JWT，从而绕过 JWT 签名验证。提供的 POC 代码 `cve-2018-0114.py` 实现了这一攻击过程，可以生成伪造的 JWT 令牌。因此，提供的 POC 代码有效。

**投毒风险分析：**

查看 `cve-2018-0114.py` 脚本，该脚本的主要功能是生成 RSA 密钥对，构造包含公钥的 JWT 头部，然后使用私钥对 JWT 进行签名。脚本的逻辑相对简单，没有发现任何可疑的代码，例如反弹 shell、恶意文件写入或网络请求等。虽然脚本使用了 `base64`、`urllib` 和 `rsa` 等库，但这些库的使用方式都是常规的，没有发现任何利用漏洞的迹象。
因此，可以认为此仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式总结：**

1.  攻击者构造一个包含恶意 payload 的 JWT 结构。
2.  攻击者生成一对 RSA 密钥，并将公钥嵌入到 JWT 头部的 `jwk` 字段中。
3.  攻击者使用私钥对 JWT 进行签名，生成伪造的 JWT 令牌。
4.  攻击者将伪造的 JWT 令牌发送给目标系统。
5.  目标系统使用 `node-jose` 库验证 JWT 令牌时，会信任 JWT 头部中的公钥，并使用该公钥验证签名。由于签名是用攻击者控制的私钥生成的，因此验证会成功，从而使攻击者能够绕过身份验证或权限控制。

**项目地址:** [Eremiel/CVE-2018-0114](https://github.com/Eremiel/CVE-2018-0114)

**漏洞详情:** [CVE-2018-0114](https://nvd.nist.gov/vuln/detail/CVE-2018-0114)