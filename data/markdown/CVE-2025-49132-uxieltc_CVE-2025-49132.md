## CVE-2025-49132-Pterodactyl Panel-远程代码执行

**漏洞编号:** CVE-2025-49132

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Pterodactyl Panel

**危害等级:** 极高危，未经身份验证的远程代码执行，可能导致完全控制服务器

**影响版本:** < 1.11.11

**利用条件:** 需要目标Pterodactyl Panel实例可网络访问，且版本低于1.11.11

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49132 是 Pterodactyl Panel 中一个未经身份验证的远程代码执行漏洞。攻击者可以通过构造恶意的请求到 `/locales/locale.json` 路径，利用 `locale` 和 `namespace` 查询参数执行任意代码。搜索引擎结果和漏洞库信息均表明该漏洞危害巨大，无需任何身份验证即可完全控制面板服务器。提供的漏洞利用代码自动化了利用过程，包括检测目标是否受到 Cloudflare 保护，提取数据库凭据，以及创建一个新的管理员用户。虽然代码主要功能是漏洞利用，但存在少量潜在的投毒风险，例如利用高权限修改其他用户数据、植入webshell等。创建管理员用户的功能本身也可以被视为一种后门，但此处不视为投毒代码。通过分析代码中对数据库的操作，以及可能引入恶意代码的地方，投毒风险估计为10%。漏洞利用方式：

1.  **确定目标：** 找到运行 Pterodactyl Panel 且版本低于 1.11.11 的实例。
2.  **绕过Cloudflare（如果存在）：** 脚本会检测 Cloudflare，如果存在，可能需要采取其他绕过方法，例如使用其他源IP地址。
3.  **提取数据库凭据：** 利用漏洞读取 `locale.json` 文件，从中获取数据库配置信息。
4.  **连接数据库：** 使用提取的凭据连接到 Pterodactyl Panel 的数据库。
5.  **创建管理员用户：** 在数据库中插入一个新的管理员用户，利用bcrypt加密。
6.  **登录：** 使用新创建的管理员用户登录到 Pterodactyl Panel。

漏洞利用的有效性很高，因为该漏洞允许未经身份验证的远程代码执行。投毒风险较低，但仍需注意代码的来源和潜在的恶意修改。


**项目地址:** [uxieltc/CVE-2025-49132](https://github.com/uxieltc/CVE-2025-49132)

**漏洞详情:** [CVE-2025-49132](https://nvd.nist.gov/vuln/detail/CVE-2025-49132)