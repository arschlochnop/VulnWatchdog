## CVE-2021-26855 - Microsoft Exchange Server SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要能够访问Exchange Server的端口，通常是443端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。攻击者可以利用此漏洞发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证，从而绕过身份验证。

**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码判断，该漏洞利用代码的有效性较高。大量的信息表明这是一个已知的、被广泛利用的漏洞，并且CISA已知可利用漏洞目录中包含了此漏洞。

**投毒风险：**
检视提供的代码，主要包含以下几个部分：
1.  `README.md`: 包含漏洞描述和图片。
2.  `build.xml`: Ant构建脚本，用于编译Java项目。
3.  `ipVuln.txt`: 空文件，可能用于存储易受攻击的IP地址列表。
4.  `list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描。
5.  `manifest.mf`: JAR文件的清单文件。
6.  `Tool-Build/Run.bat`: 用于运行编译后的JAR文件的批处理脚本。
7.  `Tool-Build/ipVuln.txt`: 空文件，与上面的`ipVuln.txt`相同。
8.  `Tool-Build/list-ip.txt`: 包含一个IP地址（`192.168.1.0`），可能用于扫描，与上面的`list-ip.txt`相同。
9.  `Tool-Build/Nmap/scripts/http-vuln-cve2021-26855.nse`: Nmap脚本，用于检测目标是否受CVE-2021-26855漏洞影响。这个脚本是漏洞检测的核心。

主要风险点在于`build.xml`构建脚本和`http-vuln-cve2021-26855.nse`这个Nmap脚本。构建脚本可能被修改以包含恶意代码，虽然在这个例子中看起来比较简单，但无法完全排除隐蔽的后门代码存在的可能性。Nmap脚本本身看起来是合法的漏洞检测脚本，但理论上，如果脚本被篡改，可能存在投毒风险。例如，在检测到漏洞时，植入后门或执行恶意操作。
总体评估，投毒风险较低，约为10%，因为主要的代码功能是漏洞扫描，而不是漏洞利用，且代码量不大，容易审计。

**利用方式：**
利用方式通常涉及以下步骤：
1.  **SSRF:** 攻击者利用SSRF漏洞向Exchange服务器发送精心构造的HTTP请求。
2.  **身份验证绕过：** 通过SSRF漏洞，攻击者可以绕过身份验证，模拟Exchange服务器上的其他用户。
3.  **远程代码执行：** 在成功绕过身份验证后，攻击者可以进一步利用其他漏洞（如不安全的deserialization）来执行任意代码。根据搜索引擎结果，CVE-2021-26855是ProxyLogon攻击链的初始漏洞。

综上所述，此漏洞的有效性高，利用方式较为明确，但提供的代码主要用于扫描而非直接利用，因此投毒风险较低。攻击者可以通过SSRF漏洞绕过身份验证，然后利用其他漏洞实现远程代码执行。

**项目地址:** [shacojx/Scan-Vuln-CVE-2021-26855](https://github.com/shacojx/Scan-Vuln-CVE-2021-26855)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)