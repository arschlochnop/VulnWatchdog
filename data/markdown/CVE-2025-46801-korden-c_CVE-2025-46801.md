## CVE-2025-46801 - Pgpool-II 认证绕过

**漏洞编号:** CVE-2025-46801

**漏洞类型:** 认证绕过

**影响应用:** Pgpool-II

**危害等级:** 高危，可能导致数据泄露、数据篡改和拒绝服务

**影响版本:** 4.6.0, 4.5.0 to 4.5.6, 4.4.0 to 4.4.11, 4.3.0 to 4.3.14, 4.2.0 to 4.2.21, 所有4.1和4.0系列版本

**利用条件:** 需要网络可达目标Pgpool-II实例

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-46801是Pgpool-II中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证，并以任意用户身份访问PostgreSQL数据库。 该漏洞源于Pgpool-II对身份验证配置处理不当。在某些错误配置下，例如pool_hba.conf和pg_hba.conf中的特定设置，攻击者可以绕过身份验证机制。利用方式是通过利用不正确的配置，攻击者无需有效凭据即可访问数据库，从而执行未经授权的操作。POC利用步骤：
1. 安装依赖：`pip install -r requirements.txt`
2. 运行exploit：`python3 exploit.py --host <目标主机>`

关于投毒风险：

*   README中提供了一个`tinyurl`链接，指向exploit的下载。虽然说明是教育目的，但仍然存在链接指向恶意软件的风险。链接缩短服务常常被用来隐藏真实URL，因此存在一定的风险。
*   POC中未提供直接可用的exp脚本,增加使用者自行分析和二次开发的步骤，增加投毒难度。
*   假设下载的脚本是无害的，但用户在实际使用的时候，可能需要修改代码来适应不同的环境，这存在引入恶意代码的风险。

综合评估，考虑到以上风险，POC代码本身直接包含后门的概率较低，但考虑到tinyurl链接可能存在风险，以及用户自行修改代码可能引入恶意代码，因此认为存在**20%**的投毒风险。

**项目地址:** [korden-c/CVE-2025-46801](https://github.com/korden-c/CVE-2025-46801)

**漏洞详情:** [CVE-2025-46801](https://nvd.nist.gov/vuln/detail/CVE-2025-46801)