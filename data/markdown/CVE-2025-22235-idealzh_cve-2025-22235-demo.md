## CVE-2025-22235 Spring Boot EndpointRequest.to() 认证绕过

**漏洞编号:** CVE-2025-22235

**漏洞类型:** 认证绕过

**影响应用:** Spring Boot

**危害等级:** 中危，可能导致未授权访问敏感信息

**影响版本:** Spring Boot 2.7.x (< 2.7.25), 3.1.x (< 3.1.16), 3.2.x (< 3.2.14), 3.3.x (< 3.3.11), 3.4.x (< 3.4.5)

**利用条件:** 使用Spring Security，EndpointRequest.to()用于未暴露的actuator端点，应用处理/null路径且需要保护

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-22235 漏洞出现在 Spring Boot 的 `EndpointRequest.to()` 方法中。当使用 `EndpointRequest.to()` 配置安全规则，并且该方法引用的 actuator 端点未被启用（未在 `management.endpoints.web.exposure.include` 中配置）或者未暴露时，会导致Spring Security 生成错误的路径匹配器 `/null/**`。这会使得原本应该受到保护的 `/null/**` 路径下的请求绕过认证，从而导致未授权访问。

**有效性:**

提供的 POC 代码有效。该代码提供了一个可运行的 Spring Boot 应用，演示了当 health 端点未暴露，且安全配置中使用 `EndpointRequest.to("health")` 时，访问 `/null` 路径可以绕过认证。

**投毒风险:**

从提供的代码片段来看，该漏洞利用代码主要由一个 README.md 文件、mvnw 脚本以及其他 Maven 相关文件组成。README.md 提供了漏洞描述、影响版本、环境搭建、复现步骤、修复方案以及代码分析等信息。mvnw 脚本是 Maven Wrapper，用于简化 Maven 项目的构建和运行。并没有发现可疑的恶意代码或后门，因此投毒风险较低。可以认为投毒风险为 0%。

**利用方式:**

1.  **配置:** 确保应用程序满足以下条件：
    *   使用 Spring Security。
    *   使用 `EndpointRequest.to()` 配置安全规则。
    *   `EndpointRequest.to()` 引用的 actuator 端点未被启用或未暴露。
    *   应用程序处理 `/null` 路径的请求，并且该路径需要受到保护。
2.  **触发:** 访问 `/null` 路径，绕过认证，即可访问原本应受保护的资源。

**项目地址:** [idealzh/cve-2025-22235-demo](https://github.com/idealzh/cve-2025-22235-demo)

**漏洞详情:** [CVE-2025-22235](https://nvd.nist.gov/vuln/detail/CVE-2025-22235)