## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感信息。

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Next.js中间件中，由于对`x-middleware-subrequest`请求头处理不当，导致可以绕过中间件的权限验证。攻击者可以通过发送带有特定`x-middleware-subrequest`请求头的请求，直接访问受保护的路由。

**有效性：**

提供的PoC代码是有效的。根据漏洞描述和利用代码，攻击者可以通过设置`x-middleware-subrequest`请求头来绕过中间件的身份验证。

**投毒风险：**

经过分析，此仓库存在一定投毒风险。虽然核心的漏洞利用代码相对简单直接，但Dockerfile指定了 node:14-alpine，可能存在一些历史漏洞。

  *   `exploit.py`：该脚本功能明确，目的是通过发送特定HTTP请求来利用漏洞。没有发现任何可疑的恶意代码。代码逻辑简单清晰，主要是构造带有特定header的请求。但存在被其他恶意程序篡改的可能
  *   `Dockerfile`：Dockerfile指定了node:14-alpine作为基础镜像，可能存在一些历史安全漏洞,需要对docker内容做进一步的检查。
  *   `middleware.js`：该文件包含存在漏洞的中间件验证逻辑，不存在恶意代码。

因此，综合判断，该仓库存在**10%**的投毒风险。

**利用方式：**

1.  目标应用使用Next.js，且版本在受影响范围内（>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3）。
2.  目标应用使用Next.js中间件进行权限验证。
3.  攻击者发送带有`x-middleware-subrequest: middleware`请求头的HTTP请求，访问受保护的路由。
4.  中间件验证逻辑失效，攻击者成功绕过身份验证，访问受保护的资源。

**搜索引擎结果佐证：** 搜索结果中的多个链接表明该漏洞确实存在，并且是由于对`x-middleware-subrequest`请求头的处理不当造成的。

**项目地址:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)