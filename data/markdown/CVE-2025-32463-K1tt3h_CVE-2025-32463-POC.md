## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户，受影响的Sudo版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17 版本中。该漏洞允许本地用户通过 `--chroot` (或 `-R`) 选项，利用用户可控目录下的 `/etc/nsswitch.conf` 文件，加载恶意共享对象，从而提升至 root 权限。

**有效性：**
提供的 PoC 代码通过以下步骤利用此漏洞：
1.  创建一个临时目录作为 chroot 环境。
2.  创建一个恶意的 C 代码，该代码在构造函数中设置 uid 和 gid 为 0，然后执行 /bin/bash。
3.  编译该 C 代码为一个共享对象（`libnss_/xd1337.so.2`）。
4.  在 chroot 环境中创建 `etc/nsswitch.conf`，将其配置为使用恶意共享对象进行用户查找。
5.  使用 `sudo -R <chroot_dir> /bin/true` 命令，触发 chroot 并加载恶意的 NSS 模块，从而获取 root shell。

根据漏洞描述和 PoC 代码，可以判断 PoC 代码是有效的。

**投毒风险：**
PoC 代码本身主要用于演示漏洞利用。投毒风险主要在于：
*   **C 代码中可能包含隐藏的恶意行为。** 虽然提供的 C 代码功能较为简单，但攻击者可能在其中添加额外的恶意代码，例如持久化后门或进行其他攻击。
*   **脚本执行过程中可能存在风险。** 在 mktemp 创建临时目录时，如果存在竞争条件，可能导致安全问题。不过这更偏向于安全隐患，而非投毒。
*   **编译参数可能被篡改。** 编译 C 代码时，如果恶意修改了 gcc 的参数，可能会引入意料之外的风险，例如连接其他恶意库文件。
总体来说，该仓库本身作为PoC示例，恶意投毒的可能性比较低，代码和描述还算诚实。风险主要在于使用者对PoC的修改，以及运行环境可能存在的其他安全隐患。这里主观给出投毒风险为 5%。

**利用方式：**
1.  攻击者需要在目标系统上拥有本地用户权限。
2.  攻击者需要能够写入目标系统上的某个目录，并将其作为 chroot 目录使用。
3.  攻击者需要将恶意共享对象和 `nsswitch.conf` 文件放置在 chroot 目录中。
4.  攻击者使用 `sudo -R <chroot_dir> /bin/true` 命令触发漏洞，获取 root 权限。

**项目地址:** [K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)