## CVE-2026-24061 - GNU InetUtils telnetd Argument Injection / 远程身份验证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** Argument Injection / 远程身份验证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 1.9.3 -> 2.7

**利用条件:** 无需认证，远程可利用，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析: 
提供的POC代码cve-2026-24061.py是一个用Python编写的完整且高度可用的漏洞利用脚本。脚本头部包含了详细的ASCII艺术横幅、漏洞描述、受影响产品版本（GNU InetUtils telnetd 1.9.3到2.7）、影响（远程root shell，无需认证）、CVSS评分（9.8 critical）、漏洞向量（USER="-f root" -> /bin/login -f root -> gg）以及漏洞发现时间线。这表明POC作者对漏洞有深入理解，并提供了高质量的文档。代码实现了多种功能，包括交互式root shell、自定义端口、单命令执行、漏洞检查以及详细协议调试模式。脚本内部使用了Python标准库（如socket, struct, sys, select, time, os, argparse）进行网络通信和参数解析，代码结构清晰，易于理解。其对Telnet协议的NEW_ENVIRON协商机制的实现是准确且符合规范的。该POC不仅证明了漏洞的存在，还提供了一个完整的远程利用工具，预期能够在受影响的系统上成功获取root权限。因此，该POC的有效性极高，功能完整，是一个成熟的漏洞利用工具。

利用步骤: 
该漏洞利用的核心机制是“参数注入”。当Telnet服务器（GNU telnetd）接收到客户端的连接时，它会调用本地的/usr/bin/login程序进行身份验证。在处理用户提供的USERNAME时，GNU telnetd会在login命令中插入`%U`占位符。其内部模板为`/bin/login -p -h %h %?u{-f %u}{%U}`。攻击者利用Telnet协议的`NEW_ENVIRON`选项，可以在客户端与服务器协商时，设置`NEW_ENVIRON`变量，特别是`USER`变量。攻击者构造恶意的`USER`变量，例如`USER="-f root"`。当telnetd将这个变量插入到login命令中时，命令变为`/bin/login -f root`。`login`程序通常支持`-f`参数，用于在不进行密码验证的情况下以指定用户身份登录（如果调用者具有足够权限）。由于telnetd在调用`login`时，通常以root权限运行或在特权环境中执行，这使得攻击者可以直接绕过身份验证，获取目标系统上的root shell。POC脚本自动化了这一过程：首先，它与目标Telnet服务器建立TCP连接；接着，它进行Telnet协议协商，包括开启`NEW_ENVIRON`选项；然后，它发送精心构造的`USER="-f root"`变量到服务器；服务器在处理时触发参数注入，执行`login -f root`，从而授予攻击者root权限。随后，POC脚本会启动一个交互式shell，或执行指定的命令。

投毒风险分析: 
对提供的CVE-2026-24061 POC代码进行分析后，评估其投毒风险为低，定为10%。该POC代码cve-2026-24061.py的目的是演示和利用一个特定的安全漏洞，获取远程root shell，其代码行为完全符合这一目的。代码结构清晰，使用了标准的Python库（如socket、argparse等），并且没有包含任何混淆代码。没有发现任何可疑的外部网络请求（除了与目标Telnet服务器的通信）、隐蔽的文件操作、额外的进程启动或未经授权的数据窃取行为。该脚本的核心功能是构建和发送Telnet协议的特定消息以触发漏洞，然后提供一个交互式shell。虽然获取远程shell本身是一个高风险的操作，但这是漏洞利用预期的直接结果，而非POC作者额外注入的恶意负载。如果攻击者使用此POC来攻击系统，那么攻击者将获得系统的控制权，但这不应与POC代码本身包含恶意“投毒”混淆。鉴于代码的透明性和其明确的漏洞利用目的，可以认为该POC代码本身不包含二次投毒机制或后门。

**项目地址:** https://github.com/JayGLXR/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
