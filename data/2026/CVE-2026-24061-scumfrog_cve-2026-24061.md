## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过 (Authentication Bypass / Argument Injection)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过 (Authentication Bypass / Argument Injection)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 to 2.7

**利用条件:** 远程利用，无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061漏洞是GNU InetUtils telnetd服务中一个存在长达11年的远程认证绕过漏洞，其根本原因是telnetd在调用/usr/bin/login进行用户登录时，未对客户端通过NEW_ENVIRON协商机制传入的USER环境变量进行有效过滤和校验。攻击者可以利用这一缺陷，将USER环境变量设置为特殊的字符串，例如"-f root"。由于telnetd内部的登录模板会将USER变量直接插值到/bin/login命令中（例如`/bin/login -p -h %h %?u{-f %u}{%U}`），这会导致最终执行的命令变为`/bin/login -f root`。其中，`/bin/login`程序的`-f`选项允许用户以指定的身份（在此案例中为root）直接登录，而无需提供密码。这使得远程攻击者能够在未进行任何身份验证的情况下，以root权限完全控制受影响的服务器。该漏洞影响范围广泛，涵盖GNU InetUtils 1.9.3至2.7版本，且利用复杂度极低，危害等级被评定为9.8（严重）。

POC有效性分析：所提供的Python POC脚本`cve-2026-24061.py`是一个高度成熟且功能完整的漏洞利用工具。该脚本通过精准模拟telnet协议的NEW_ENVIRON协商过程，向目标telnetd服务发送恶意构造的USER环境变量（设置为"-f root"）。脚本不仅包含了建立与目标服务的socket连接、处理telnet协议协商细节的关键逻辑，还提供了用户友好的接口，支持交互式root shell、执行单条命令、指定自定义端口以及进行漏洞检测等多种操作模式。代码结构清晰，注释详尽，采用标准Python库，无混淆，可读性强。通过对脚本代码的分析，可以确认其完全符合漏洞描述的攻击原理，能够稳定有效地触发认证绕过，并成功获取目标系统的root权限。该POC的实现质量高，稳定性好，是一个可靠的、可用于复现和验证CVE-2026-24061漏洞的完整利用工具。

利用步骤：
1. 攻击者运行提供的POC脚本，指定目标服务器的IP地址（可选端口，默认为23）。
2. POC脚本通过网络连接到目标服务器上监听的telnetd服务。
3. 在telnet协议的初始协商阶段，POC脚本会启动NEW_ENVIRON协商，并向服务器发送一个精心构造的`USER`环境变量，其值为`"-f root" `。
4. 目标服务器上的telnetd服务接收到此环境变量后，在准备调用本地的`/usr/bin/login`程序进行身份验证时，会将`USER`变量值不当拼接进登录命令。
5. 最终，`/bin/login`程序被执行为`/bin/login -f root`。由于`-f`参数的作用，`/bin/login`将直接授予攻击者root权限，无需任何密码验证。
6. POC脚本随后会建立一个持久化的交互式root shell，使攻击者能够完全控制受感染的远程系统，执行任意命令。

投毒风险分析：对POC代码`cve-2026-24061.py`进行全面审查后，评估其投毒风险为极低（10%）。该脚本是一个独立的Python程序，其依赖项仅限于Python标准库（如`socket`, `sys`, `os`, `argparse`等），代码逻辑清晰、注释详尽，不包含任何形式的代码混淆。脚本的核心功能完全围绕CVE-2026-24061漏洞的认证绕过原理展开，旨在实现远程root shell的获取，这与漏洞利用的预期行为完全一致。在代码中未发现任何可疑的外部网络请求（除了与目标Telnet服务通信）、恶意文件写入、本地系统修改（除了其预期提供的shell环境操作）、或者包含后门、挖矿程序、数据窃取模块等与漏洞利用无关的恶意负载。该POC是一个纯粹的漏洞利用工具，其设计和实现均专注于验证并利用特定漏洞。因此，在受控环境中进行防御性安全研究或渗透测试时，使用此POC不会对执行环境造成非预期的恶意损害。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
