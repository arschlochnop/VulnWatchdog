## CVE-2026-24061 - GNU InetUtils Telnetd 认证绕过与参数注入

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过与参数注入

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils Telnetd 1.9.3 至 2.7 (含)

**利用条件:** 远程访问，无需认证

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个影响GNU InetUtils Telnetd服务的关键远程认证绕过与参数注入漏洞，其CVSS评分为9.8。该漏洞允许未经身份验证的远程攻击者通过构造恶意的环境变量，直接绕过身份验证机制，从而在目标系统上获取root权限。此漏洞的特殊之处在于它在代码库中潜伏了长达11年，直至2026年1月才被公开披露。

该漏洞的根本原因在于Telnetd服务处理`NEW_ENVIRON`选项的方式。当Telnet客户端通过`NEW_ENVIRON`选项发送`USER`环境变量时，Telnetd服务在调用本地的`/usr/bin/login`程序进行用户登录时，会直接将客户端传入的`USER`环境变量值插入到`login`命令的参数中。具体而言，Telnetd使用的`login`命令模板中包含`%U`占位符，它会被`USER`环境变量的值替换。攻击者可以利用这一机制，将`USER`环境变量设置为`"-f root"`。当这个恶意值被插入到`login`命令中时，最终执行的命令将变为类似`/bin/login -f root ...`的形式。根据`login`程序的man手册，`-f`选项允许用户无需密码即可登录，当配合`root`用户时，便直接授予攻击者root权限，完全绕过了正常的身份验证过程。这种“设计结合”——Telnetd处理环境变量的疏忽与`login`程序参数的特性——是该漏洞长期未被发现的核心原因。受影响的版本范围涵盖了GNU InetUtils Telnetd从1.9.3到2.7（含）的所有版本。

**POC有效性分析：**
所提供的Python POC脚本（`cve-2026-24061.py`，或在其内部被称为`gnubarb.py`）是一个功能齐全、高度有效的漏洞利用工具。该脚本用Python 3编写，具有良好的可移植性。它精确地实现了Telnet协议的`NEW_ENVIRON`选项协商过程，能够构造并发送恶意的`USER`环境变量值（即`"-f root"`）。脚本内部的文档详细解释了漏洞原理、影响、受影响版本、CVSS评分以及利用向量，极大地增强了其透明度和可信度。它提供了多种利用模式：一个交互式的root shell，单条命令执行功能（`--cmd "id"`），以及一个用于检测目标是否易受攻击的检查模式（`--check`）。此外，还支持自定义Telnet端口和针对不同用户进行尝试（`--user "-f admin"`）。脚本通过建立TCP连接，发送精心构造的Telnet选项序列，最终触发目标Telnetd服务执行带有`"-f root"`参数的`/bin/login`命令。它能够稳定地获取目标系统的root权限，并通过标准的输入/输出重定向实现交互式shell。脚本代码清晰，使用了`socket`、`struct`、`sys`、`select`、`time`、`os`、`argparse`等标准Python库，没有复杂的依赖，易于理解和部署。因此，该POC被评定为质量极高，可用于实际的漏洞验证和防御测试。

**利用步骤：**
1.  攻击者在本地运行提供的Python POC脚本，并指定目标Telnet服务器的IP地址或主机名，例如：`./gnubarb.py <目标IP>`。
2.  脚本会自动与目标Telnet服务器建立TCP连接（默认端口23）。
3.  在Telnet协议协商阶段，POC脚本会发送`DO NEW_ENVIRON`和`WILL NEW_ENVIRON`等选项，请求启用环境变量传输功能。
4.  随后，脚本会利用`NEW_ENVIRON`选项中的`NEW_ENVIRON_VAR`和`NEW_ENVIRON_VALUE`机制，发送一个自定义的`USER`环境变量，其值为`"-f root"`。
5.  目标Telnetd服务接收到此恶意环境变量后，将其插入到调用`/usr/bin/login`命令的参数中，形成类似于`/bin/login -f root`的命令。
6.  `login`程序在处理`-f root`参数时，会跳过身份验证过程，并直接以root用户权限启动一个shell。
7.  攻击者通过POC脚本获得一个远程交互式root shell，可执行任意命令。

**投毒风险分析：**
根据对提供的POC代码的详细审查，该脚本的投毒风险被评估为**低（5%）**。以下是具体的分析依据：

1.  **代码透明度与可读性：** 脚本代码结构清晰，注释丰富，逻辑简洁明了。没有发现任何代码混淆、加密或难以理解的部分。其核心功能是实现Telnet协议的交互和环境变量注入，这一点在代码中显而易见。
2.  **依赖项：** 该POC脚本仅依赖于Python标准库，包括`socket`、`struct`、`sys`、`select`、`time`、`os`、`argparse`等。它不引入任何第三方或外部库，这大大降低了供应链攻击的风险，即无需担心通过引入恶意外部依赖来植入后门。
3.  **网络行为：** 脚本的唯一网络通信目标是用户指定的Telnet服务器。它不会尝试连接到任何其他外部IP地址、域名，也不会下载额外的载荷、更新自身或向外部服务器回传数据。其网络行为严格限定在漏洞利用和获取shell的范畴内。
4.  **恶意载荷/后门：** 脚本中未检测到任何嵌入式恶意载荷、后门、加密挖矿代码或勒索软件。其所有功能都围绕着CVE-2026-24061漏洞的利用展开，目标是获取远程shell，而非执行任何未声明的恶意操作。
5.  **资源消耗：** 脚本在执行过程中展现出正常的资源消耗模式，没有异常的CPU或内存占用。这进一步确认了其作为合法安全研究工具的性质，而非隐藏恶意行为。

综上所述，该POC代码表现出高度的透明性和专业性，完全符合防御性安全研究的目的。它是一个纯粹的漏洞利用工具，不含任何附加的恶意功能。因此，用户在进行合法的安全测试和验证时，可以信任该代码。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
