## CVE-2026-24061 - GNU InetUtils telnetd 身份认证绕过, 参数注入

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 身份认证绕过, 参数注入

**影响应用:** GNU InetUtils telnetd

**危害等级:** 关键级

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils telnetd versions 1.9.3 through 2.7

**利用条件:** 远程、无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2026-24061是GNU InetUtils telnetd服务中一个潜伏长达11年的远程认证绕过漏洞，CVSS评分高达9.8（关键级）。该漏洞影响GNU InetUtils telnetd的1.9.3到2.7版本。它源于telnetd在处理客户端通过Telnet协议的NEW_ENVIRON协商机制传入的`USER`环境变量时，未进行充分的校验和过滤。当telnetd服务内部调用`/usr/bin/login`程序进行用户认证时，恶意构造的`USER`变量（例如`USER="-f root"`）会被直接作为命令行参数传递给`/usr/bin/login`。`/bin/login`程序的`-f`参数允许跳过常规的身份验证过程，直接以指定用户（此处为root）登录，从而使攻击者能够在无需提供任何凭据的情况下，远程获取目标系统的root权限。此漏洞的利用条件极为宽松，仅需目标系统开放telnetd服务并处于受影响版本范围即可。

POC有效性分析: 所提供的Python POC脚本`cve-2026-24061.py`是一个高度有效且功能完整的利用工具。脚本清晰地展示了如何通过Telnet NEW_ENVIRON协商机制注入`USER="-f root"`环境变量。其内部逻辑精确模拟了Telnet协议的交互过程，并成功利用了`telnetd`将非过滤的`USER`变量传递给`/bin/login`的弱点。该脚本提供了多种操作模式，包括获取交互式`root` shell、执行单个命令（如`--cmd "id"`）、进行漏洞检查（`--check`），以及自定义目标用户（`--user "-f admin"`）和端口（`-p 2323`）。这些功能覆盖了从漏洞发现到完全利用的各个阶段，极大地简化了攻击过程。脚本的注释详细解释了攻击原理和历史背景，并明确指出其为远程root权限获取工具。搜索结果中“微步情报局已成功复现”的报告，进一步验证了该POC的实际可用性和漏洞的严重性。代码结构清晰，主要依赖Python标准库，确保了其稳定性和易用性。

利用步骤: 攻击者首先需要确保目标系统正在运行受影响版本的GNU InetUtils telnetd服务，通常监听TCP 23端口。然后，攻击者可以利用提供的Python POC脚本执行攻击。最简单的利用方式是运行`./gnubarb.py <target_ip>`，脚本将自动协商Telnet协议，注入恶意`USER`环境变量，并在成功利用后提供一个交互式的`root` shell。攻击者也可以使用`./gnubarb.py <target_ip> --cmd "whoami"`来执行单个命令并获取其输出，或使用`./gnubarb.py <target_ip> --check`来安全地检测目标是否易受攻击。整个过程自动化程度高，攻击者无需深入了解Telnet协议细节，只需简单的命令行操作即可实现远程root权限的获取。这种利用方式对攻击者的技术门槛要求极低，使得漏洞更易于被广泛利用。

投毒风险分析: 对所提供的Python POC代码`cve-2026-24061.py`进行分析后，评估其投毒风险为低，具体风险百分比为10%。该POC代码结构透明，逻辑清晰，旨在合法地演示和利用CVE-2026-24061漏洞。脚本中使用的所有模块均为Python标准库，未发现混淆、加密代码、动态加载外部恶意脚本或尝试与非标准/恶意外部服务器通信的行为。代码中不包含任何试图在运行POC的本地机器上安装后门、窃取用户数据或其他超出漏洞利用范围的恶意操作。因此，从代码层面上看，该POC本身不含恶意载荷，并非“被投毒”的POC。尽管如此，任何从互联网下载并执行的第三方代码都存在固有风险，即使代码看似无害，也可能存在未被发现的漏洞或隐藏的恶意功能，因此建议始终在隔离的、受控的沙箱环境中运行此类工具，并进行必要的静态和动态分析以确保安全。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
