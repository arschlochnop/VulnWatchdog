## CVE-2026-20841 - Microsoft Windows 记事本 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-20841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows 记事本

**危害等级:** 高危

**CVSS评分:** 8.8

**影响版本:** 通过Microsoft Store分发的新版Windows记事本应用，特别是包含2025年5月新增的Markdown渲染及可点击链接功能的版本

**利用条件:** 需要用户交互（诱导用户打开恶意Markdown文件并Ctrl+点击链接），需要受害者系统安装受影响版本的记事本应用

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

### POC有效性分析
本研究中提供的POC是一个`README.md`文件，旨在演示CVE-2026-20841，即Windows记事本中存在的远程代码执行（RCE）漏洞。该漏洞的核心在于记事本的Markdown渲染器未能正确限制URL协议。当处理Markdown格式的可点击链接时，攻击者可以构造恶意协议链接（如`file://`），诱导用户点击后触发本地程序执行。POC通过一个简洁的示例 `[click](file://C:/windows/system32/cmd.exe)` 清晰地展示了这种利用方式。当受影响的记事本应用打开包含此链接的Markdown文件，并且用户执行“Ctrl+点击”操作时，系统将尝试执行 `C:\windows\system32\cmd.exe`，从而实现任意命令执行。

该POC的有效性在于它直接演示了漏洞机制，并且提供了可立即测试的载荷。它明确指出漏洞影响的是通过Microsoft Store分发的、包含Markdown渲染功能的新版记事本。虽然POC指出“Requires more than one click in most cases”（在大多数情况下需要多次点击，即“Ctrl+点击”），这表明它并非无交互式漏洞，但一旦用户被诱导完成操作，其后果便是完全的远程代码执行。POC的结构清晰，没有模糊或复杂的依赖，使其成为一个优秀的、用于理解和重现漏洞的概念验证工具。其警告“Test only in a VM.”也体现了负责任的安全研究态度。

### 利用步骤
1.  **构造恶意文件**：攻击者首先创建一个恶意的Markdown文件（例如，`exploit.md`），其中包含一个特制的链接，利用 `file://` 协议指向一个本地可执行文件，如 `[Click Me!](file://C:/windows/system32/cmd.exe)`。攻击者可以替换 `cmd.exe` 为 `powershell.exe`、`mshta.exe` 或任何其他预期的本地程序。
2.  **诱导受害者**：攻击者通过电子邮件、即时通讯工具或其他社交工程手段，诱导受害者下载并使用存在漏洞的Microsoft Store版本Windows记事本应用打开此恶意Markdown文件。
3.  **用户交互**：当受害者在记事本中打开 `exploit.md` 文件时，会看到一个渲染后的可点击链接。为了触发漏洞，受害者需要按下 `Ctrl` 键并同时点击该恶意链接。
4.  **远程代码执行**：一旦链接被 `Ctrl+点击`，记事本将尝试解析并执行 `file://` 协议指定的本地程序。在上述示例中，这将启动 `C:\windows\system32\cmd.exe`，从而在受害者系统上实现攻击者预期的远程代码执行效果。

### 投毒风险分析
本研究中提供的POC是一个纯文本的 `README.md` 文件。它清晰地展示了CVE-2026-20841漏洞的原理和利用方式，通过一个简单的Markdown链接示例来触发 `file://` 协议进行本地代码执行。

从投毒风险的角度来看，这个POC的风险级别被评估为**0% (极低)**。其主要原因如下：

1.  **纯文本格式**：POC本身是Markdown格式的说明文档，不包含任何可执行代码、脚本或二进制文件。这意味着它不具备自主执行恶意行为的能力。
2.  **内容透明**：文件的内容完全可见且易于理解。恶意链接的构造方式一目了然，没有使用任何代码混淆、加密或隐藏技术。
3.  **无外部依赖**：POC不引入任何外部脚本、库或组件。所有信息都内联于 `README.md` 文件中。
4.  **无恶意行为**：除了演示漏洞利用的原理外，POC本身不包含任何收集用户数据、建立后门、进行网络通信或对系统进行未经授权修改的代码。它只是一个教学性质的漏洞概念验证。
5.  **明确的免责声明和安全建议**：POC中明确指出“Not my discovery.”（非作者发现）、“Test only in a VM.”（仅在虚拟机中测试）等内容，表明其设计初衷是用于研究和防御性测试，而非恶意攻击。

因此，下载、查看或分析此 `README.md` 文件本身并不会对研究人员的系统造成任何威胁。潜在的风险仅在于研究人员如果**主动且故意地**将POC中提供的恶意链接构造方式，应用于一个真正存在漏洞的Windows记事本实例中，并执行了“Ctrl+点击”操作，才可能触发漏洞。但这种操作是可控且有意的，不属于“投毒”范畴。对于合法的防御性安全研究而言，这是一个安全且具有教育意义的POC。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-20841
