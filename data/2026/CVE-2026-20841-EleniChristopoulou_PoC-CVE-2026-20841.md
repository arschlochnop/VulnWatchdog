## CVE-2026-20841 - Windows 记事本 (Notepad) 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-20841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows 记事本 (Notepad)

**危害等级:** 高危

**CVSS评分:** 8.8

**影响版本:** Windows Notepad < 11.2510

**利用条件:** 需要用户交互 (点击恶意链接), 需要社会工程学诱导

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10

## 详情

CVE-2026-20841是一个影响Microsoft Store分发的新版Windows记事本应用的高危远程代码执行（RCE）漏洞，CVSS评分高达8.8分。该漏洞于2026年2月的“补丁星期二”期间被微软修复。漏洞的根本原因在于记事本在2025年5月新增的Markdown渲染及可点击链接功能中，对链接解析和校验不足。攻击者可以构造恶意的协议链接，并将其嵌入到`.md`文件中。当用户被社会工程学诱导打开此恶意文件，并通过Ctrl+点击操作触发这些恶意链接时，即可导致远程代码执行。这打破了“基础应用无风险”的认知，表明任何处理外部输入的组件都可能成为攻击面。

**POC有效性分析**
提供的PoC包含`README.md`和`poc.md`两个文件。`README.md`清晰地描述了PoC的目的，即演示Windows记事本的远程代码执行漏洞。它指出了漏洞利用的两个关键要求：记事本版本低于11.2510，以及用户通过社会工程学下载并打开`poc.md`文件。`poc.md`文件是PoC的核心，它包含两个Markdown格式的链接。第一个链接`[poc](https://github.com/EleniChristopoulou/just_an_exe/raw/refs/heads/main/poc.exe)`旨在从GitHub下载一个名为`poc.exe`的可执行文件。第二个链接`[poc](C:\Users\user\Downloads\poc.exe)`则尝试执行已下载到用户`Downloads`目录下的`poc.exe`文件。这个PoC的结构非常直接且具有高度的有效性，它完整地模拟了从下载恶意载荷到执行恶意载荷的攻击链条。通过用户简单的Ctrl+点击操作，即可触发漏洞，实现任意代码执行。因此，该PoC是一个功能完整且文档清晰的利用示例，具有很高的复现成功率。

**利用步骤**
1. 攻击者首先准备一个恶意载荷（例如一个简单的`poc.exe`），并将其托管在一个可公开访问的服务器或代码仓库（如GitHub）上。
2. 攻击者精心构造一个`.md`文件，如`poc.md`，其中包含两个关键的Markdown链接：第一个链接指向恶意载荷的下载地址，第二个链接指向载荷下载后的本地执行路径（例如`C:\Users\user\Downloads\poc.exe`）。
3. 攻击者通过社会工程学手段，诱骗目标用户下载并使用受影响版本的Windows记事本（版本低于11.2510）打开这个恶意的`.md`文件。
4. 当用户在记事本中看到这些恶意链接时，攻击者进一步诱导用户（例如通过文本说明）Ctrl+点击第一个链接。此时，`poc.exe`文件将被下载到用户的`Downloads`目录。
5. 用户随后被诱导Ctrl+点击第二个链接。记事本将尝试执行本地的`poc.exe`文件，从而在受害者的系统上实现远程代码执行，攻击者得以执行任意指令。

**投毒风险分析**
对当前提供的PoC代码（`README.md`和`poc.md`）进行分析，其投毒风险评估为低（10%）。`poc.md`文件内容简洁明了，仅包含两个Markdown格式的超链接，一个用于从公开的GitHub仓库下载`poc.exe`，另一个用于在本地执行该文件。代码中没有发现混淆技术、恶意脚本、可疑的外部请求或非标准库调用。它的行为完全符合PoC的目的，即清晰地演示漏洞的利用流程。`README.md`也明确指出`poc.exe`是一个“简单的Proof of Concept”，其目标是作为PoC的执行载荷，而非隐藏恶意功能。

根据提供的评分标准，PoC的投毒风险主要评估PoC代码本身是否被恶意篡改、是否包含隐藏的恶意功能、或者是否采用混淆技术以掩盖其真实意图。在此PoC中，`poc.md`的内容是完全透明且极易审查的，不包含任何复杂的脚本逻辑或隐藏的结构。它仅依赖Markdown的链接解析功能，指向一个外部可执行文件。这意味着PoC的代码意图是公开的，任何安全分析人员都可以通过快速浏览`poc.md`的内容来理解其功能，从而有效地进行审计。代码中不存在常见的混淆手法，例如使用`base64`编码、位移操作、加密字符串、动态加载模块或采用`eval()`等高风险函数来掩盖恶意代码。其唯一的外部依赖是`just_an_exe` GitHub仓库中的`poc.exe`，这个依赖是明确声明并直接嵌入在Markdown链接中的，完全透明。

因此，从PoC代码的结构和透明度来看，其被“投毒”的风险极低。任何试图在`poc.md`中注入额外恶意代码的行为都会立刻显现，因为Markdown的语法限制了复杂代码的嵌入，且记事本的渲染行为相对直观。然而，这并不意味着使用该PoC是完全没有风险的。尽管PoC代码本身是干净的，但其核心功能是下载并执行一个外部提供的`poc.exe`文件。在实际测试环境中，用户必须自行确保所下载的`poc.exe`（如果不是由测试人员自行编译的已知安全程序）是安全无害的，因为它代表了在真实攻击场景中可能被攻击者恶意利用的载荷。例如，如果`https://github.com/EleniChristopoulou/just_an_exe`仓库在未来被劫持或`poc.exe`被替换为真正的恶意软件，那么即使PoC代码本身未被篡改，执行此PoC仍将带来严重风险。因此，我们始终建议在隔离环境中测试，并对所有外部下载的文件进行严格的安全审查。我们的评估专注于PoC代码本身的诚信度，而非其所演示的漏洞利用结果或载荷本身。由于代码清晰、标准库使用（Markdown链接解析），且无可疑行为，故判断投毒风险为低。

**项目地址:** https://github.com/EleniChristopoulou/just_an_exe

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-20841
