## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过、特权升级、任意代码执行

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过、特权升级、任意代码执行

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危。攻击者可远程绕过认证，直接获取目标系统root权限，导致任意代码执行，影响范围广。

**CVSS评分:** 9.8

**影响版本:** GNU Inetutils telnetd 1.9.3 到 2.7 版本

**利用条件:** 远程可利用，无需任何认证，仅需网络访问目标Telnet服务（默认TCP 23端口）。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2026-24061是一个影响GNU InetUtils telnetd服务的远程认证绕过漏洞，该漏洞被发现已潜伏长达11年。其核心在于telnetd服务对Telnet协议的NEW_ENVIRON选项处理不当，特别是当客户端发送包含特定构造的USER环境变量时。利用此漏洞，未经授权的远程攻击者能够绕过系统认证机制，直接以root权限登录目标系统，从而实现任意代码执行。

**POC有效性分析：**
提供的Proof-of-Concept (PoC) 脚本 `cve-2026-24061-poc.py` 精确地利用了这一漏洞。该脚本首先通过标准Telnet协议协商功能与目标telnetd服务建立连接。随后，其关键部分在于`exploit_payload`函数，该函数构造并发送了恶意Telnet选项序列。具体来说，脚本首先发送`IAC WILL NEW_ENVIRON`（指示客户端愿意发送环境变量），接着通过子协商命令`IAC SB NEW_ENVIRON ... IAC SE`，注入了一个特殊的`USER`环境变量，其值为`"-f root"`。

在受影响的GNU InetUtils telnetd版本中，当接收到此恶意构造的`USER`环境变量时，telnetd未能正确地进行输入验证和清理，而是将其值直接拼接到了 `/usr/bin/login` 程序的命令行参数中。这导致 `/usr/bin/login` 被以 `login -f root` 的形式执行。在某些Linux系统或特定配置下，`-f`（force）选项可以被滥用，允许在未进行密码验证的情况下以指定用户（在此例中为`root`）身份登录。因此，这种参数注入导致了认证绕过，并直接获得了目标系统的root权限。

PoC脚本的实现非常直观：它明确地发送了`IAC WILL 39`（对应NEW_ENVIRON），然后通过字节数组构造了`IAC SB 39 ENVIRON VAR 'U' 'S' 'E' 'R' VALUE '-','f',' ','r','o','o','t' IAC SE`的payload。脚本在发送payload后，会尝试读取Telnet会话的输出，如果检测到root shell的提示符（如`#`或`root@`），则表明漏洞利用成功，并会将用户放入一个交互式shell中，从而验证了远程认证绕过和root权限获取的能力。该脚本结构清晰，逻辑严谨，是一个功能完整且可靠的漏洞验证工具。

**利用步骤：**
1. 确保目标系统运行受影响版本的`GNU InetUtils telnetd`服务（版本范围为1.9.3到2.7），并且Telnet服务在默认端口23上可访问。
2. 从GitHub仓库克隆PoC代码：`git clone https://github.com/cyberpoul/CVE-2026-24061-POC`。
3. 进入PoC目录：`cd CVE-2026-24061-POC`。
4. 运行Python脚本，并提供目标系统的IP地址和Telnet端口：`python cve-2026-24061-poc.py <target_ip> <target_port>`。
5. 如果漏洞利用成功，脚本将显示一个交互式shell提示符，表明已成功获取目标系统的`root`权限。攻击者即可在此root shell中执行任意系统命令。

**投毒风险分析：**
对提供的`cve-2026-24061-poc.py`脚本进行详尽的安全审查后，可以确认其投毒风险为极低的0%。该结论基于以下几点：

首先，该脚本的代码结构清晰、透明，完全由Python标准库（如`socket`、`sys`、`threading`、`argparse`、`os`）构成，未导入任何非标准或可疑的第三方库。这种依赖的纯粹性显著降低了引入恶意代码或供应链攻击的风险。

其次，脚本的核心逻辑严格遵循CVE-2026-24061的漏洞描述，旨在通过Telnet协议的`NEW_ENVIRON`选项注入特定环境变量，实现认证绕过。脚本的所有网络通信操作都明确指向命令行参数中指定的目标IP和端口，没有发现任何连接外部未知服务器、下载额外组件、或向非预期目标发送数据的行为。脚本的行为与一个纯粹的漏洞验证工具完全一致。

再者，脚本代码中不存在任何形式的代码混淆或加密技术。所有函数、变量和逻辑流程都清晰可读，使得安全研究人员能够逐行审查代码，从而轻松识别任何潜在的恶意活动。代码的透明度是判断PoC可靠性和安全性的关键指标。

此外，该脚本的主要功能是建立一个Telnet连接，发送特定payload，并在成功后提供一个交互式shell。它不涉及任何文件系统读写操作（如创建、修改或删除文件），也不会尝试在执行PoC的本地系统或目标系统上安装后门、持久化机制或进行数据窃取。这种有限的行为范围进一步证实了其仅作为概念验证的性质。

最后，脚本使用了Python内置的`argparse`模块来安全地处理命令行参数，有效防止了参数解析过程中可能引入的自身注入漏洞。因此，该`cve-2026-24061-poc.py`脚本被认定为安全、无害的漏洞验证工具，不构成任何形式的投毒威胁，可在受控环境中放心使用。

**项目地址:** https://github.com/cyberpoul/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
