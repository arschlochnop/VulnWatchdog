## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过 (参数注入)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过 (参数注入)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 从 1.9.3 到 2.7

**利用条件:** 远程利用，无需认证，需要网络访问目标Telnet服务（默认端口23）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是一个存在于GNU InetUtils telnetd守护程序中的严重认证绕过漏洞。该漏洞已存在长达11年之久，自2015年引入以来一直未被发现，直到最近才被披露。漏洞的核心源于telnetd在Telnet协商过程中对客户端传递的USER环境变量处理和验证不当。具体来说，当客户端连接并使用Telnet环境选项（RFC 1572）发送USER="-f root"字符串时，易受攻击的telnetd服务器会未经适当的清理或认证检查，直接将此“-f root”参数传递给底层的login程序。login程序在接收到“-f”标志后跟着“root”时，会将其解释为无需密码或任何其他认证凭据即可登录指定用户（此处为root）的指令。这实质上允许未经认证的远程攻击者立即获得对易受攻击系统的root权限访问。其影响极其严重，可导致系统的机密性、完整性和可用性（CIA三要素）完全被破坏。攻击者可以执行任意命令、安装恶意软件、窃取敏感数据或完全中断系统运行。受影响的telnetd版本范围从1.9.3到2.7，这意味着广泛的旧版类Unix系统如果仍在运行telnetd，都可能受到影响。鉴于利用的简易性以及直接获得root权限的途径，该漏洞对尚未禁用或修补Telnet服务的组织构成极高的风险。

**POC有效性分析与利用步骤**
所提供的概念验证（PoC）代码`cve-2026-24061-poc.py`是一个用Python编写的完全功能性漏洞利用工具。它旨在演示并主动利用CVE-2026-24061认证绕过漏洞以获取root权限。PoC通过建立与目标主机和端口（通常是23）的标准Telnet连接来工作。在初始的Telnet选项协商阶段，脚本会正确处理标准的IAC（Interpret As Command）序列，根据需要确认或拒绝选项。关键在于，它随后利用Telnet环境选项（RFC 1572）发送一个精心构造的`USER`环境变量，具体为`USER="-f root"`。目标机器上易受攻击的`telnetd`守护程序会以有缺陷的方式处理此环境变量，将`-f root`直接传递给`login`工具。`login`工具反过来会将`-f`标志解释为绕过`root`用户的密码认证的指令，从而立即授予攻击者一个root权限的shell。
该PoC脚本结构健壮，包含终端类型（`TERM`）和窗口大小（`NAWS`）协商等功能，以在漏洞利用后提供更稳定和交互式的shell体验。成功绕过认证后，脚本会进入一个交互式循环，允许攻击者输入命令，这些命令随后发送到受感染的系统，并且系统输出会返回给攻击者。这证实了该PoC不仅仅是概念上的演示，而是一个用于获取作为root用户的远程代码执行（RCE）的实用工具。PoC的`README.md`中包含的屏幕截图`poc.png`也直观地证实了成功获得root权限。
要使用此PoC利用此漏洞，攻击者需要执行以下步骤：
1. 确保目标系统运行的是受影响的`telnetd`版本（从1.9.3到2.7）。
2. 验证目标上的Telnet服务（默认端口23）可从网络访问。
3. 从GitHub克隆PoC仓库：`git clone https://github.com/cyberpoul/CVE-2026-24061-POC`。
4. 进入新创建的目录：`cd CVE-2026-24061-POC`。
5. 执行Python脚本，提供目标的IP地址和Telnet端口：`python cve-2026-24061-poc.py <target_ip> <target_port>`。
6. 如果目标易受攻击，将出现一个交互式shell，确认远程系统上的root权限已获得，允许攻击者执行任意命令。

**投毒风险分析**
对所提供的PoC代码`cve-2026-24061-poc.py`进行了彻底分析，以评估潜在的投毒风险。该脚本用Python编写，主要依赖于标准库模块，包括`socket`用于网络通信，`sys`用于系统交互，`threading`用于并发执行（管理输入/输出流），`argparse`用于命令行参数解析，以及`os`用于基本的操作系统功能。这些都是Python生态系统中常用且受信任的模块。
审查源代码后，未发现任何恶意混淆、加密字符串或可疑的外部资源请求。脚本没有尝试从远程服务器下载或执行额外的代码。没有发现使用`eval()`或`exec()`等动态代码执行函数处理不受信任的输入的情况，也没有发现任何偏离Telnet客户端和漏洞利用预期目的的可疑系统命令调用。脚本的文件系统交互极少，似乎仅限于Python脚本的标准操作，没有明显的尝试创建持久性后门、修改系统文件或从执行PoC的系统中窃取敏感信息。
PoC的核心逻辑完全专注于实现CVE-2026-24061漏洞利用，通过构造和发送特定的Telnet协议序列（包括关键的`USER="-f root"`环境变量）来在*目标*系统上获取未经认证的root shell。此行为与PoC的声明目的完全一致，即演示和利用telnetd认证绕过漏洞。代码中或相关上下文（CVE信息、搜索结果）中没有证据表明作者（`@opscur` / `cyberpoul`）嵌入了任何针对*攻击者*机器或其他非目标系统的恶意载荷。
基于这项全面审查，与此特定PoC代码相关的投毒风险被评估为低，约为10%。此评级表明代码看起来是干净的，并且在没有隐藏恶意功能的情况下实现了其声明的目的。然而，作为一项通用的安全最佳实践，始终建议用户在执行来自公共来源的任何漏洞利用代码之前进行审查，最好在隔离和受控的环境中执行，以减轻任何不可预见的风险。

**项目地址:** https://github.com/cyberpoul/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
