## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过 (Remote Authentication Bypass)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过 (Remote Authentication Bypass)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重高危

**CVSS评分:** 9.8

**影响版本:** GNU Inetutils 1.9.3 至 2.7 (自2015年起受影响)

**利用条件:** 远程可利用，无需认证，需要网络访问目标Telnet服务（通常为23端口），攻击者无需特殊权限。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是一个存在于GNU InetUtils telnetd服务中的严重远程认证绕过漏洞。该漏洞因其长达11年的潜伏期（自2015年引入相关代码）和广泛的影响范围（据估计超千万设备）而备受关注。其本质是一个典型的“低水平代码安全疏漏与遗留协议惯性使用”相结合的案例。漏洞的根本原因在于telnetd在调用`/usr/bin/login`进行用户登录时，未能对客户端传入的`USER`环境变量进行充分有效的清理和验证。攻击者可以通过在Telnet协议协商过程中，发送包含恶意值（例如`"-f root"`）的自定义`USER`环境变量，从而绕过正常的身份验证机制，以`root`权限登录到目标系统。POC作者甚至指出，此漏洞最终可能导致作为root用户的远程代码执行（RCE），进一步提升了其危害等级。

所提供的POC代码`cve-2026-24061-poc.py`是一个用Python编写的脚本，旨在演示CVE-2026-24061漏洞的有效性。该POC通过模拟Telnet客户端与目标Telnet服务器进行交互，并在Telnet协议协商阶段巧妙地注入一个恶意的`USER`环境变量。具体来说，它会发送一个包含`USER="-f root"`值的`NEW_ENVIRON`选项。当不安全的telnetd服务接收到此特殊构造的环境变量时，在调用`/usr/bin/login`时会被误解析为合法的登录参数，从而允许攻击者在没有提供正确密码的情况下，直接以`root`用户的身份成功认证。POC代码结构清晰，使用了标准的`socket`、`sys`、`threading`、`argparse`和`os`库，未发现任何复杂的依赖或异常行为。`README.md`文件提供了详尽的使用说明、受影响版本信息和缓解措施，并附带了利用成功的截图，证明了其高度的可用性和有效性。POC声称可以导致RCE作为root，这进一步证实了其作为完整利用工具的潜力。

**利用步骤：**
1. 攻击者首先通过`git clone https://github.com/cyberpoul/CVE-2026-24061-POC`获取POC代码库。
2. 进入克隆的目录：`cd CVE-2026-24061-POC`。
3. 运行Python脚本，指定目标IP地址和Telnet服务端口（默认23）：`python cve-2026-24061-poc.py <target_ip> <target_port>`。
4. 脚本会发起与目标Telnet服务器的连接，并执行Telnet协议协商。
5. 在协商过程中，POC会发送一个特殊的`DO`命令，请求启用`NEW_ENVIRON`选项（选项代码为39）。
6. 一旦服务器响应`WILL NEW_ENVIRON`，POC便会构造一个`SB`（子协议）命令，其中包含`VAR USER VAL -f root`的数据。
7. 服务器在处理此`USER="-f root"`环境变量时，由于其未对输入进行充分清理，会将`-f root`作为参数传递给`/usr/bin/login`命令，导致认证绕过。
8. 成功利用后，攻击者将获得目标系统的`root`权限会话。

**投毒风险分析：**
对`cve-2026-24061-poc.py`代码及其相关文档的深入分析表明，该POC的投毒风险极低，评估为10%。这一判断基于以下几个关键考量。首先，从代码本身来看，该Python脚本结构清晰，注释合理，逻辑流易于追踪。它完全由Python语言编写，没有发现任何可疑的二进制文件、加密或混淆代码块，这使得安全研究人员可以轻松地对其进行静态和动态分析，以确认其行为与预期功能的一致性。这种透明性是评估软件安全性的基石。
其次，代码所使用的库均为Python标准库（`socket`, `sys`, `threading`, `argparse`, `os`），这些库是Python生态系统中广泛使用且经过严格审查的组件，本身不带有已知恶意功能。POC未检测到对外部不可信资源（如未知URL、第三方不安全的API）的请求或依赖，排除了通过加载外部恶意内容进行投毒的可能性。恶意POC常常会试图下载额外的载荷，或者与外部C2服务器进行隐秘通信，但在此POC中均未发现此类行为。
此外，该POC的行为模式完全符合其“概念验证”或“完整利用”的描述：它专注于模拟Telnet协议通信，并通过特定的Telnet选项协商过程注入环境变量，以触发目标Telnetd服务的认证绕过漏洞。代码中没有发现任何与漏洞利用无关的额外功能，例如：在目标系统上创建后门账户、部署持久化机制、执行加密货币挖矿操作、收集敏感数据并回传、或者向攻击者控制的服务器发送任何形式的遥测数据。其唯一的输出是展示认证是否成功，并可能在成功后提供一个交互式的shell，这与验证漏洞的目标一致。
更重要的是，该POC中没有发现任何尝试检测分析环境、虚拟机或沙箱的技术，也没有任何反调试或反逆向工程的措施。恶意软件通常会包含这些机制以逃避检测和分析。该POC的缺乏这些复杂功能，进一步证明了其非恶意性质和作为安全研究工具的纯粹性。其设计目的纯粹是为了验证和演示CVE-2026-24061的存在和可利用性，为组织提供一个安全评估工具，帮助企业识别并修复其网络中存在的脆弱Telnetd服务。因此，综合来看，该POC代码表现出高度的透明度和可信赖性，其作为投毒载体的风险微乎其微。部署或执行此POC以进行内部安全测试的风险可以忽略不计，前提是应在受控环境中进行，并充分理解其对目标系统的潜在影响（即root权限获取）。

**项目地址:** https://github.com/cyberpoul/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
