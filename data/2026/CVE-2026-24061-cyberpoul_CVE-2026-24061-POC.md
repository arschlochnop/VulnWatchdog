## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过/提权/命令注入

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过/提权/命令注入

**影响应用:** GNU InetUtils telnetd

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils telnetd versions from 1.9.3 to 2.7

**利用条件:** 远程利用，无需认证，需要网络访问目标Telnet服务（默认TCP 23端口）

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析: 提供的Python POC (cve-2026-24061-poc.py) 是一个功能完整的利用脚本，旨在利用GNU InetUtils telnetd服务中潜藏11年之久的远程认证绕过漏洞（CVE-2026-24061）。该漏洞的根源在于telnetd服务在调用`/usr/bin/login`程序处理用户登录时，未能充分校验客户端传入的自定义环境变量。具体而言，该POC通过实现Telnet协议的协商过程，并利用Telnet协议的`NEW_ENVIRON`选项，向目标服务器发送一个特制的`USER`环境变量，其值为`-f root`。当存在漏洞的telnetd服务接收到此环境变量时，会将其转发给`login`程序。`login`程序误将`-f root`解析为一个有效的命令行参数，从而在未要求任何凭证的情况下直接授予攻击者一个具有root权限的shell。脚本的代码结构清晰，使用Python标准库如`socket`进行网络通信，`argparse`处理命令行参数，使得使用起来非常便捷。其核心逻辑在于精心构造Telnet协议数据包，包括`IAC`（Interpret As Command）和`SB`（Subnegotiation）序列，以准确地注入恶意环境变量。根据其设计原理和公共披露信息，该POC在满足受影响版本（1.9.3至2.7）和目标系统Telnet服务可达性的条件下，能够稳定且有效地绕过认证并获取root权限，具有极高的有效性和实用性。
利用步骤:
1.  **环境准备**: 确保攻击者机器上已安装Python环境。
2.  **下载POC**: 使用Git从GitHub仓库克隆POC代码：`git clone https://github.com/cyberpoul/CVE-2026-24061-POC`。
3.  **进入目录**: 切换到POC代码所在目录：`cd CVE-2026-24061-POC`。
4.  **执行POC**: 运行Python脚本，并指定目标Telnet服务器的IP地址和端口（Telnet默认端口为23）：`python cve-2026-24061-poc.py <target_ip> <target_port>`。
5.  **获取Shell**: 若目标系统存在漏洞且满足利用条件，脚本将成功绕过认证，并返回一个具有root权限的交互式shell。攻击者即可通过此shell在目标系统上执行任意命令，实现完全控制。
投毒风险分析: 对提供的POC代码（`cve-2026-24061-poc.py`）进行了详细分析，评估其投毒风险为极低（5%）。
1.  **代码透明度**: 脚本采用Python语言编写，代码逻辑直观，易于阅读和理解。未发现任何代码混淆、加密或使用难以理解的技巧来隐藏潜在恶意行为。脚本的每一个功能模块都清晰地实现了Telnet协议协商和环境变量注入的利用逻辑。
2.  **依赖项管理**: 脚本仅依赖于Python的内置标准库，例如`socket`（用于网络通信）、`sys`（用于系统级操作，如版本判断）、`threading`（用于并发处理，尽管在此POC中未充分利用）、`argparse`（用于命令行参数解析）和`os`（用于与操作系统交互）。未引入任何第三方、非官方或来源可疑的库，从而排除了通过恶意依赖项引入风险的可能性。
3.  **网络行为**: 脚本的网络行为仅限于与用户指定的单个目标IP地址和端口（Telnet服务）进行TCP连接和数据交互。其所有发送的数据都严格遵循Telnet协议规范，并包含用于漏洞利用的特定环境变量。没有发现脚本向其他未知或非预期的IP地址或端口发起连接、发送数据、下载外部文件或执行其他异常网络请求的行为。
4.  **本地系统操作**: 脚本在本地文件系统上没有执行任何写入、删除、修改敏感系统文件、创建后门程序、安装持久化机制或执行其他恶意本地系统操作。它是一个纯粹的客户端利用工具，其作用是与远程服务进行交互以验证和利用漏洞，而非对运行POC的本地系统进行恶意修改。
5.  **恶意负载**: 脚本的核心功能是发送特定的环境变量值（`-f root`），这是实现漏洞利用的关键载荷，并非额外携带的恶意代码或病毒。该载荷本身不具备在攻击者系统上执行恶意行为的能力。
**结论**: 综合上述分析，该POC代码是专注于漏洞验证和利用的纯粹安全研究工具。其代码清晰、依赖标准、网络行为可控、无本地系统副作用，因此判断其不包含恶意投毒成分，投毒风险极低。

**项目地址:** https://github.com/cyberpoul/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
