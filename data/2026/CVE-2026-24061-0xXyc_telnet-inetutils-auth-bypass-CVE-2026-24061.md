## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过 (参数注入)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过 (参数注入)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 到 2.7 (含)

**利用条件:** 远程访问，无需认证

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个影响GNU InetUtils telnetd服务（版本1.9.3到2.7，含）的严重远程认证绕过漏洞，CVSS评分为9.8。该漏洞源于telnetd在调用`/usr/bin/login`程序进行用户登录时，未能正确净化客户端传入的`USER`环境变量。攻击者可以构造恶意的`USER`环境变量值，例如`'-f root'`，将其作为参数注入到`/usr/bin/login`程序中。`/usr/bin/login`程序的一个合法功能是支持`-f`参数，该参数用于跳过认证，通常用于预认证会话。然而，由于telnetd未对`USER`变量进行严格的输入校验和清理，导致远程未授权攻击者可以利用此参数注入缺陷，欺骗`/usr/bin/login`程序跳过认证过程，并直接以`root`用户身份获取目标系统的shell访问权限，无需提供任何密码。此漏洞的利用复杂度极低，攻击者只需通过网络即可发起攻击，且据报道已在野外被利用，对暴露Telnet服务的系统构成严重威胁。

**POC有效性分析**
提供的POC代码是一个基于Docker的实验环境，旨在清晰地演示CVE-2026-24061的利用过程。`Dockerfile`首先构建了一个Debian 11 slim镜像，并精确安装了已知受影响的`inetutils-telnetd=2:2.0-1+deb11u2`版本，确保了环境的漏洞复现性。`docker-entrypoint.sh`脚本负责启动`inetd`服务，确保telnetd监听在标准端口，并创建了一个普通用户`user1`作为初始登录环境，这符合实际场景。`README.md`文件提供了详尽的背景信息、漏洞描述、受影响版本、CVSS评分以及关键的利用步骤。利用过程极其简单，只需一条命令`USER='-f root' telnet -a localhost`即可在容器内获取root shell。经过分析，该POC代码逻辑清晰，目标明确，完整复现了漏洞，且具备高度的可用性和稳定性。它不仅提供了一个可操作的攻击示例，还通过Docker这种现代化的方式，极大地降低了研究人员和安全团队复现并理解漏洞的门槛。POC的文档也充分解释了漏洞原理和缓解措施，对防御者而言具有极高的参考价值。

**利用步骤**
1.  **环境准备**: 使用`Dockerfile`构建一个包含易受攻击`inetutils-telnetd`版本的Docker镜像。在POC目录中执行`docker build -t telnetd-exploit .`。
2.  **启动容器**: 运行构建好的镜像，启动一个易受攻击的telnetd服务。执行`docker run --rm -it telnetd-exploit`。此时会进入容器内的`user1`用户shell。
3.  **执行攻击**: 在宿主机或其他网络可达的客户端上，使用特定的`USER`环境变量发起telnet连接。执行`USER='-f root' telnet -a localhost`。
4.  **验证**: 攻击成功后，用户将直接获得目标系统的root shell。可以通过运行`whoami`命令来验证当前用户是否为`root`。

**投毒风险分析**
该POC代码由安全研究人员提供，旨在演示CVE-2026-24061漏洞的利用。对`Dockerfile`、`docker-entrypoint.sh`和`README.md`进行了全面审查，未发现任何恶意代码、代码混淆、外部恶意链接、可疑的第三方依赖或非预期行为。`Dockerfile`仅安装了标准的Debian软件包和配置，没有添加任何未经授权的软件源或可疑的安装后脚本。`docker-entrypoint.sh`的内容也仅限于启动`inetd`服务和创建用户，这些都是为了搭建合法脆弱环境所必需的步骤。`README.md`清晰地说明了漏洞原理、利用方法和防御建议，符合专业安全研究报告的规范。因此，该POC代码被判定为**低投毒风险**（5%）。它是一个合法且专业的安全研究工具，其目的是帮助用户理解和防御漏洞，而非传播恶意软件。组织可以安全地使用此POC进行漏洞复现、威胁模拟和防御措施验证。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
