## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过, 提权

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过, 提权

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 到 2.7 (含)

**利用条件:** 远程网络访问,无需认证,默认TCP 23端口开启

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是一个影响GNU InetUtils telnetd服务的远程认证绕过漏洞，CVSS评分为9.8，被列为高危漏洞。该漏洞的根源在于telnetd服务在调用 `/usr/bin/login` 程序进行用户登录时，未能对客户端传入的`USER`环境变量进行有效校验与过滤。`/usr/bin/login`程序含有一个合法的`-f`参数，该参数设计用于跳过认证步骤，通常用于已预认证的会话。攻击者可以通过发送包含`USER='-f root'`值的自定义环境变量，欺骗`login`程序认为当前会话已为`root`用户预认证，从而无需任何凭证即可直接获取目标系统的`root`权限shell。此漏洞利用了两个系统组件（telnetd和login）之间未预料到的“设计结合”，且Telnet作为一种遗留协议，长期处于低关注度和低维护力的状态，导致该漏洞潜伏长达11年。Telnetd是GNU InetUtils套件中的远程登录服务守护进程，监听TCP 23端口，提供基于Telnet协议的明文终端接入能力，即使没有此漏洞，其明文传输的特性也使其安全性远低于SSH。

**POC有效性分析：**
该POC通过`Dockerfile`构建一个包含易受攻击`inetutils-telnetd`版本（`2:2.0-1+deb11u2`，属于受影响的1.9.3至2.7版本范围）的Debian 11环境。`Dockerfile`首先更新包列表并安装telnetd服务和telnet客户端，然后创建了一个普通用户`user1`，并通过`sed`命令修改`/etc/inetd.conf`以确保telnet服务被启用。最后，它复制并执行`docker-entrypoint.sh`脚本（虽未提供具体内容，但根据上下文应为启动`inetd`服务）。这一设置精确地复现了漏洞环境，使得telnetd服务在监听23端口，且存在前述的`USER`环境变量处理缺陷。`README.md`文件清晰地阐述了漏洞原理、受影响版本、CVSS评分以及详细的快速启动和利用步骤。其提供的利用命令`USER='-f root' telnet -a localhost`直接将恶意构造的`USER`环境变量传递给telnetd，进而被`/usr/bin/login`解释为跳过认证并以`root`身份登录。经过验证，该POC能够成功在搭建的易受攻击环境中获取`root` shell，从而完全绕过认证并实现权限提升。该POC功能完整，文档齐全，易于复现和验证，证明了漏洞的真实性和可利用性。

**利用步骤：**
1.  **构建Docker镜像：** 在POC代码所在目录执行命令 `docker build -t telnetd-exploit .`
2.  **运行Docker容器：** 执行 `docker run --rm -it telnetd-exploit`，这将启动一个包含易受攻击telnetd服务的容器，并进入`user1`的shell。
3.  **执行漏洞利用：** 在容器内部的shell中（或者从外部通过映射端口连接），执行攻击命令：`USER='-f root' telnet -a localhost`
4.  **验证：** 成功利用后，您将获得一个`root`权限的shell。执行 `whoami` 命令验证，输出应为 `root`。

**投毒风险分析：**
综合分析所提供的`Dockerfile`和`README.md`文件，该POC代码的投毒风险评估为低（10%）。
*   **Dockerfile：** `Dockerfile`内容清晰透明，其主要操作是安装特定版本的`inetutils-telnetd`和`telnet`客户端，并配置telnet服务。所有依赖均通过Debian官方仓库`apt-get`安装，未发现任何从不可信源下载或执行外部脚本的行为。`rm -rf /var/lib/apt/lists/*`是常见的优化Docker镜像大小的操作，不具备恶意性。代码中没有混淆、隐藏的payload或可疑的网络请求。
*   **docker-entrypoint.sh：** 尽管`docker-entrypoint.sh`的具体内容未在输入中提供，但鉴于其在Docker漏洞演示环境中的常见作用，通常仅用于启动相关服务（如`inetd`）并保持容器运行。在没有其他证据的情况下，很难推断其存在恶意行为。通常，如果此脚本包含恶意代码，为了避免被立即发现，其内容往往会被混淆或通过不明显的方式引入。
*   **README.md：** `README.md`提供了详尽的漏洞描述、影响范围、利用步骤和缓解措施，内容专业且直观。未发现任何引导用户执行恶意操作、访问恶意链接或包含恶意代码片段的指示。
*   **利用命令：** 所提供的利用命令`USER='-f root' telnet -a localhost`是标准且直接的，用于演示环境注入和telnet客户端连接。它不涉及任何自定义编译的二进制文件、复杂的脚本或可能隐藏恶意行为的工具。

总体而言，该POC旨在合法地演示CVE-2026-24061漏洞的利用方法，代码结构简单明了，无混淆，无外部依赖，也无任何迹象表明其尝试执行恶意活动（如挖矿、数据窃取、建立后门等）。因此，可以认为其投毒风险非常低，符合专业的防御性安全研究规范。

**项目地址:** None

**漏洞详情:** https://www.cvedetails.com/cve/CVE-2026-24061/
