## CVE-2026-24061 - GNU InetUtils Telnetd 远程认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU inetutils 1.9.3 至 2.7

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析:
该POC（概念验证）是一个高度有效且结构完整的Docker实验室环境，旨在演示CVE-2026-24061漏洞。此漏洞是GNU inetutils telnetd中的一个关键身份认证绕过漏洞，其特点是易于利用且影响广泛。POC的有效性体现在其精确的复现能力和用户友好的操作流程上。Dockerfile精心构建了一个Debian 11操作系统环境，并明确安装了已知的、存在漏洞的inetutils-telnetd版本（具体为2:2.0-1+deb11u2），同时安装了telnet客户端。这种精确的版本锁定确保了漏洞环境的完美复现。通过修改`/etc/inetd.conf`文件，Telnet服务被正确启用，使其能够被远程访问和攻击。

README.md文件作为POC的详细说明文档，清晰地阐述了漏洞的根本原因：telnetd服务在调用`/usr/bin/login`程序进行用户登录时，未能对客户端传入的`USER`环境变量进行充分的清理和验证。而`/usr/bin/login`程序本身包含一个`-f`参数，用于在用户已预先认证的情况下跳过密码验证。攻击者正是利用这一机制，通过将`USER`环境变量设置为`'-f root'`，欺骗`/usr/bin/login`直接授予root权限，从而绕过任何身份验证步骤。

POC提供的利用命令`USER='-f root' telnet -a localhost`简单直接，能够立即演示身份认证绕过并获得root权限的shell。用户只需按照README中的指示，构建Docker镜像，运行容器，然后在宿主机上执行此命令，即可迅速获得目标容器内的root shell。POC还包含了`whoami`命令作为验证步骤，以确认攻击成功并获取了root权限。

总而言之，该POC是安全研究人员、渗透测试人员和系统管理员理解、验证和复现此漏洞的绝佳工具。其清晰的结构、精确的版本控制和详细的指导使其成为一个高质量的漏洞验证实例，尤其强调了该漏洞长达11年未被修补的严重性和潜在影响。

利用步骤:
1.  **环境搭建**: 确保本地系统已安装Docker环境。
2.  **构建镜像**: 在包含`Dockerfile`和`README.md`的POC文件目录下，打开终端执行命令`docker build -t telnetd-exploit .` 以构建易受攻击的Telnet服务镜像。
3.  **运行容器**: 构建成功后，执行命令`docker run --rm -it telnetd-exploit`启动一个包含漏洞Telnet服务的容器。容器启动后，用户将进入一个非特权用户（user1）的shell。
4.  **发起攻击**: 在宿主机或其他可网络访问到容器Telnet端口的终端中，执行攻击命令：`USER='-f root' telnet -a localhost` (如果攻击目标是远程主机，将`localhost`替换为目标IP地址)。
5.  **验证攻击**: 如果攻击成功，当前终端会直接进入目标容器的root shell。此时，可以执行`whoami`命令来验证当前用户是否为`root`，确认已成功获取root权限。

投毒风险分析:
对该POC代码进行分析后，评估其投毒风险极低。
1.  **代码透明度与可读性**: `Dockerfile`内容清晰明了，主要指令是更新apt源、安装特定版本的`inetutils-telnetd`和`telnet`包，以及配置telnet服务启用。`README.md`详细解释了漏洞原理、利用方式和缓解措施。代码中没有发现任何混淆、加密或难以理解的恶意逻辑。
2.  **依赖项的安全性**: POC主要依赖于Debian基础镜像以及通过apt包管理器安装的官方inetutils软件包和telnet客户端。这些都是标准且经过广泛审查的系统组件，不涉及任何可疑的第三方库或非官方源。
3.  **无外部通信**: POC代码（包括`Dockerfile`和`README.md`描述的运行流程）本身不包含任何主动向外部服务器发送请求、下载额外文件、执行远程脚本或进行隐秘数据传输的指令。它的操作完全局限在本地Docker环境中，旨在纯粹地演示漏洞的存在。
4.  **无恶意载荷**: 此次POC的目的在于验证CVE-2026-24061漏洞，即远程认证绕过并获取root权限。获取root权限是漏洞的预期结果，并非POC额外植入的后门或恶意功能。POC中不包含任何额外的恶意载荷，例如加密货币挖矿程序、僵尸网络客户端、数据窃取模块或其他形式的恶意软件。
5.  **总结**: 综合上述分析，该POC是一个完全为了防御性安全研究和漏洞验证而设计的工具。其代码清晰、依赖项可靠、无外部通信且不包含任何额外的恶意载荷。因此，将其投毒风险评估为5%，属于低风险范畴。用户可以放心地在受控环境中进行测试和研究。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
