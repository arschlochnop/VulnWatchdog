## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 权限提升 (Privilege Escalation)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 <= version <= 2.7

**利用条件:** 远程网络访问, 无需认证, 低利用复杂度

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是GNU InetUtils telnetd服务中存在的远程认证绕过漏洞，CVSS评分为9.8（严重）。该漏洞影响GNU InetUtils从1.9.3版本到2.7版本（含）的所有Telnetd服务。攻击者可以利用此漏洞，通过Telnet协议的特定选项和精心构造的环境变量，无需任何凭证即可绕过认证，直接获取目标系统的root权限。

漏洞的根本原因在于Telnetd服务在调用`/usr/bin/login`程序进行用户登录时，未能对客户端传入的`USER`环境变量进行有效校验和过滤。攻击者可以通过`NEW_ENVIRON` Telnet选项发送包含如" `-f root` "等恶意值的自定义`USER`环境变量。`login`程序在接收到这个非预期的参数后，会被欺骗性地执行这些参数，从而在没有提供任何凭证的情况下授予攻击者一个root shell。该漏洞的特殊之处在于它依赖于Telnet作为遗留协议的低关注度、低维护状态，以及两个系统组件（Telnetd和login程序）之间“设计结合”的安全校验缺失，使其能够潜伏长达11年。成功利用此漏洞将导致远程、未经认证的攻击者完全控制受影响的系统，获取最高权限（root）。这对于组织的资产和数据安全构成极高的风险，可能导致数据泄露、系统破坏、作为跳板进行内网渗透等严重后果。

POC有效性分析：
提供的POC代码是一个名为"Twenty-Three Scanner"的Python扫描器，旨在高效检测受CVE-2026-24061影响的Telnetd服务。根据其`README.md`描述，该工具完全采用Python标准库开发，不依赖任何外部库，这显著增强了其可靠性和安全性。它具备多线程架构，支持单IP、CIDR范围、ASN查询以及文件列表等多种目标输入方式，体现了其在实战中的强大扫描能力。`README.md`中明确提及“Proof of Concept (PoC)”部分，表明该仓库不仅提供漏洞检测功能，很可能也包含了实际的漏洞利用代码或详细的利用演示逻辑。该项目清晰的文档、丰富的功能以及明确的漏洞检测/利用意图，使其成为一个高质量且有效的漏洞验证工具。它能够准确识别目标系统是否存在该漏洞，并为安全研究人员提供深入分析和复现漏洞的手段。

利用步骤：
1.  攻击者首先定位运行Telnetd服务（默认TCP端口23）的受害者机器。
2.  攻击者通过Telnet客户端发起连接，并利用Telnet协议的`NEW_ENVIRON`选项。
3.  在`NEW_ENVIRON`选项中，攻击者构造并发送一个自定义的`USER`环境变量，其值为" `-f root` "。
4.  受影响的Telnetd服务接收到此请求后，在调用`/usr/bin/login`程序时，未经验证地将此`USER`环境变量作为参数传递给`login`。
5.  `login`程序将" `-f root` "解释为其命令行参数，绕过了正常的认证流程，直接以root权限启动一个shell会话。
6.  攻击者无需任何凭证，即可获得目标系统的root权限。

投毒风险分析：
对POC代码"Twenty-Three Scanner"的投毒风险分析结果显示为极低（10%）。首先，项目在`README.md`中明确强调其使用“纯Python标准库”并且“零外部依赖”。这一声明是评估软件安全性的重要指标，因为它极大地降低了通过引入第三方库而带来的供应链攻击风险。没有外部依赖意味着代码的完整性更容易验证，攻击者难以通过植入恶意包来感染用户。其次，该项目的公开目的是作为一个防御性安全研究工具，专门用于检测CVE-2026-24061漏洞。其代码结构清晰、逻辑透明，且文档详尽。通过对公开信息的审查，未发现任何代码混淆、恶意加密、或者隐藏的后门逻辑。项目也没有包含任何异常的网络请求行为（除了漏洞扫描本身所需的网络连接），或者尝试执行与漏洞检测和利用无关的系统命令。此外，该工具作为一个安全扫描器，其行为是可预测和可控的，用户可以清晰地理解其功能和潜在影响。综合来看，该POC代码符合安全研究的最佳实践，没有发现任何可疑迹象表明它可能包含恶意负载或进行非预期行为，因此投毒风险评估为低。

**项目地址:** https://github.com/madfxr/Twenty-Three-Scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
