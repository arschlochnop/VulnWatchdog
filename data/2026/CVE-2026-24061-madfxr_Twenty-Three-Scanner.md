## CVE-2026-24061 - GNU InetUtils telnetd 参数注入 (Argument Injection), 远程认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 参数注入 (Argument Injection), 远程认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程访问, 无需认证

**POC 可用性:** 9

**POC 类型:** 概念验证 (Scanner)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061漏洞对运行GNU InetUtils telnetd服务的系统构成严重威胁，特别是1.9.3版本到2.7版本（含）受影响。这是一个关键的远程认证绕过漏洞，可导致未经授权的root权限访问。其根本原因在于telnetd服务在处理客户端提供的`USER`环境变量时存在参数注入缺陷。telnetd服务通常监听TCP端口23，当其调用`/usr/bin/login`程序进行用户认证时，它会不加 sanitization 地将`USER`变量传递过去。攻击者可以精心构造`USER`变量，使其包含恶意的命令行参数，例如`USER=-f root`。`/usr/bin/login`程序会将这些注入的参数误解为合法的选项，特别是`-f`标志（通常表示强制登录），从而在无需任何凭证的情况下授予攻击者root shell。该漏洞的CVSS评分为9.8（严重），凸显了其极高的严重性和极低的利用复杂度。鉴于telnetd在传统系统和嵌入式设备中的广泛部署，此漏洞的潜在影响被进一步放大，使得受影响的实例成为攻击者获取初始访问和完全系统控制的首要目标。

提供的概念验证（POC）代码，名为“Twenty-Three Scanner”，是一款高效的Python工具，专门用于检测存在CVE-2026-24061漏洞的GNU InetUtils telnetd服务实例。该扫描器专为高性能而设计，采用多线程架构，并支持灵活的目标输入，包括单个IP地址、CIDR范围、ASN查询和基于文件的列表。其文档中强调的一项关键优势是“完全使用Python标准库构建——无需任何外部依赖”。这一设计选择极大地提升了其可靠性和部署简便性，用户无需管理额外的软件包。虽然此POC是一个扫描器而非完整的利用工具，但它作为验证漏洞存在的可靠机制，其有效性已被证实。扫描器的存在，结合多项公开报告指出可获取root权限的完整利用脚本已广泛可用，进一步突显了此漏洞在实际攻击中被利用的便利性。该扫描器全面的功能使其成为组织识别和修复网络中易受攻击资产的宝贵工具。

**利用步骤：**
1.  **建立连接**：攻击者首先向运行易受攻击的telnetd服务的目标主机建立一个标准的Telnet连接，通常连接到TCP端口23。
2.  **注入恶意USER变量**：在Telnet会话的初始协商阶段，特别是在服务器提示认证时，攻击者构造并发送一个包含恶意参数的`USER`环境变量。一个常见且有效的payload是设置`USER=-f root`。
3.  **参数传递缺陷**：易受攻击的telnetd守护进程在调用`/usr/bin/login`程序时，没有对接收到的`USER`变量进行 sanitization 或加引号，而是将其直接作为命令行参数传递。
4.  **登录绕过**：`/usr/bin/login`程序接收到`-f root`后，将其解释为有效的命令行选项。其中，`-f`标志（强制登录）与`root`用户结合，有效地绕过了传统的密码认证机制，直接授予攻击者`root`用户登录权限。
5.  **获取Root Shell**：成功利用后，攻击者在受感染系统上获得一个未经认证且拥有完整特权的root shell，从而可以执行任意命令并完全控制系统。

**投毒风险分析（针对提供的POC）：**
“Twenty-Three Scanner”POC所展示的投毒风险极低，这主要归因于其明确的设计原则。其`README.md`清晰指出，该工具“完全使用Python标准库构建——无需任何外部依赖”。从安全角度来看，这一设计选择至关重要，因为它消除了供应链攻击中最常见的载体：恶意外部软件包或脚本。用户无需下载或安装任何第三方库，从而确保执行的代码完全源自提供的源代码。此外，该项目采用“MIT许可证”这一宽松的开源许可证。这种透明度允许任何人对代码库进行彻底的安全审计，极大地降低了隐藏恶意功能的可能性。在所提供的信息中，没有发现代码混淆、动态加载外部资源或除了合法的Telnet扫描活动之外的任何可疑网络通信的证据。该扫描器的唯一目的是检测，其实现似乎严格遵循此功能。因此，尽管在使用任何外部代码时始终建议保持警惕，但此特定POC扫描器本身包含嵌入式恶意软件或执行恶意操作（即“投毒”）的直接风险非常小。组织可以在高度信任其无害性的前提下，利用此工具进行漏洞评估，前提是从其原始、可验证的来源获取。

**项目地址:** https://github.com/madfxr/Twenty-Three-Scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
