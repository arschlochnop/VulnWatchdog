## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程利用，无需认证

**POC 可用性:** 8/10

**POC 类型:** 概念验证环境

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个存在于GNU InetUtils telnetd服务中的严重远程认证绕过漏洞，影响从1.9.3版本到2.7版本（含）的所有GNU InetUtils版本。该漏洞的CVSS评分高达9.8，被评为高危漏洞。它允许远程未经认证的攻击者直接获取目标系统的root权限。该漏洞利用了Telnetd服务在调用系统`login`程序进行用户认证时，对客户端通过`NEW_ENVIRON`选项传入的`USER`环境变量未进行充分校验和过滤的缺陷。攻击者可以通过发送一个特制的`USER`环境变量（例如`-f root`），欺骗`login`程序，使其在没有有效凭证的情况下授予攻击者一个root shell。这一漏洞的隐蔽性在于其依赖于`telnetd`和`login`两个系统组件之间不当的“设计结合”，且Telnet作为遗留协议长期处于较低的关注度和维护力度。

POC有效性分析：
提供的POC代码包含一个`Dockerfile`、`README.md`和一个`telnet.xinetd`配置文件。这个POC的核心价值在于其能够可靠地构建一个完全符合漏洞条件的、运行着易受攻击的`GNU InetUtils telnetd`服务（版本2.7）的测试环境。`Dockerfile`的设计非常严谨，它首先从官方GNU FTP服务器下载`inetutils-2.7.tar.gz`源码包，确保了所构建环境的真实性和版本准确性。随后，它负责编译并安装`telnetd`，并配置`xinetd`服务以监听23端口，并将`/usr/libexec/telnetd`作为`root`用户启动。这种从官方源代码编译安装的策略避免了使用预编译二进制文件可能存在的潜在风险，并保证了环境的高度定制化和准确性。尽管此POC本身不包含客户端侧的漏洞利用代码，但它提供了一个高度有效且易于复现的漏洞靶机环境。对于安全研究人员和防御者而言，这是一个极其宝贵的资源，能够帮助他们深入理解漏洞机制、验证修复措施或测试入侵检测系统。`README.md`中还明确指出了NVD漏洞详情页和外部GitHub上的完整攻击代码仓库（如JayGLXR/CVE-2026-24061 PoC），这进一步提升了此POC作为漏洞研究起点的完整性，因为它为用户指明了获取完整利用链的方向。因此，从建立漏洞复现环境的角度来看，此POC的质量非常高，能有效证明漏洞的存在性。

利用步骤：
1.  **环境准备：** 使用提供的`Dockerfile`构建并运行Docker容器。例如，通过`docker build -t cve-2026-24061-vuln .`命令构建镜像，然后使用`docker run -p 23:23 cve-2026-24061-vuln`命令启动容器，使Telnetd服务在本地23端口对外暴露。确保目标服务`telnetd`已成功启动并可远程访问。
2.  **建立连接：** 攻击者从远程机器使用支持`NEW_ENVIRON`选项的Telnet客户端（或自定义脚本）连接到目标服务器的23端口。标准的Telnet客户端可能需要特定参数或修改才能发送环境变量。
3.  **协商选项：** 在建立连接的初始阶段，客户端必须与服务器协商并成功启用`NEW_ENVIRON` Telnet选项，这是传输自定义环境变量的关键前置条件。如果此选项未被服务器接受或客户端无法发送，则利用将失败。
4.  **发送恶意环境变量：** 在Telnet会话的认证阶段，攻击者通过协商好的`NEW_ENVIRON`机制发送一个包含特制值的`USER`环境变量，例如`USER=-f root`。由于`telnetd`服务内部在调用`login`程序时，未能正确过滤或转义此输入，它会将`-f root`字符串作为参数直接传递给`login`程序，使其被误认为是合法的命令行选项。
5.  **获取Root Shell：** `login`程序会将`-f`解释为一个内部标志，指示它无需密码即可直接以root用户身份登录。一旦成功利用，攻击者将无需任何凭证即可获得目标系统的完整root权限，从而能够完全控制受影响的系统。

投毒风险分析：
对本POC代码进行了详细的分析，以评估其潜在的投毒风险。整体评估结果为投毒风险极低，评定为5%。以下是详细分析依据：

*   **代码透明度高与来源可靠：** `Dockerfile`中明确指定了`inetutils-2.7.tar.gz`的下载源为官方GNU FTP服务器（`ftp.gnu.org`）。这确保了核心漏洞组件的来源是可信的，且不易被第三方恶意篡改。代码本身也没有经过混淆或加密，所有操作都清晰可见，易于安全审计人员审查。
*   **依赖项均为标准组件：** 容器构建过程中使用的基础镜像`nlss/xinetd`是一个常用的、社区普遍接受的镜像，其安全性有一定保障。通过`apk`包管理器安装的所有依赖项（如`build-base`、`xz`、`man-db`）都是标准的Linux系统工具和开发库，没有引入任何异常或可疑的第三方二进制文件或脚本。
*   **无恶意行为或隐藏功能：** POC代码的行为逻辑完全符合其宣称的目的——构建一个脆弱的Telnet服务环境。没有发现任何尝试进行网络回连、数据窃取、植入持久性后门（除了漏洞本身导致的root权限）、或者执行其他与漏洞复现无关的恶意操作的迹象。代码的执行流程简单直接，缺乏复杂或隐蔽的逻辑。
*   **“后门”代码的非恶意性：** `Dockerfile`中的`RUN echo "root:root" | chpasswd`命令为`root`用户设置了一个默认密码。这并非为了植入后门，而是为了在测试或调试过程中，如果漏洞利用失败，仍然可以通过常规方式登录系统进行排查。这是一个在安全测试环境中常见的良性实践，不应被误判为恶意行为，其目的是为了方便测试人员进行环境管理和问题诊断。
*   **无外部可疑通信：** 在POC代码的构建和运行过程中，除了明确从GNU官方FTP下载源码外，没有探测到任何尝试连接未知或可疑外部服务器的请求或行为。所有网络活动均可追溯，且符合正常的软件编译和运行模式。

**总结：** 综合以上分析，此POC代码是安全且可信赖的。其设计目标明确，代码逻辑清晰，依赖项来源可靠，且无任何恶意行为的迹象。用户可以放心使用此POC来搭建CVE-2026-24061的测试环境，而无需担心潜在的投毒风险。

**项目地址:** https://github.com/JayGLXR/CVE-2026-24061

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
