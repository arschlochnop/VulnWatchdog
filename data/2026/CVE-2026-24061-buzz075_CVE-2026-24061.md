## CVE-2026-24061 - GNU InetUtils telnetd 参数注入 (Argument Injection) / 认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 参数注入 (Argument Injection) / 认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 through 2.7

**利用条件:** 远程, 无需认证, 网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061漏洞是GNU InetUtils telnetd服务中的一个关键远程认证绕过漏洞，影响版本范围为1.9.3至2.7。此漏洞的本质是一个参数注入（CWE-88）缺陷，允许未经身份验证的远程攻击者直接获取目标系统的root权限。漏洞的根本原因在于telnetd在调用`/usr/bin/login`程序时，对客户端传入的`USER`环境变量未能进行充分的校验和过滤，直接将其作为命令行参数传递。具体来说，在非Solaris系统上，`telnetd/telnetd.c`中的`login_invocation`模板使用了`%?u{-f %u}{%U}`的表达式。当`user_name`（对应`%u`）未设置时，模板会回退使用`%U`，而`%U`则直接扩展为从`getenv("USER")`获取到的、未经任何清理的`USER`环境变量值。攻击者可以利用这一机制，通过Telnet协议的NEW_ENVIRON选项，发送一个特制的`USER`环境变量，例如将其值设置为"-f root"。当telnetd执行`/usr/bin/login`时，其命令会变为类似于`login -p -h <hostname> -f root`。`login`程序会将`-f`识别为一个有效的命令行参数，并根据其功能，在没有凭证的情况下直接为`root`用户授予shell访问权限，从而实现了完全的认证绕过和特权升级。该漏洞已潜伏多年，凸显了遗留协议和多组件交互中安全隐患的发现难度和高危性。

**利用步骤:**
1.  攻击者使用Telnet客户端连接到目标服务器上运行的GNU InetUtils telnetd服务（默认端口TCP 23）。
2.  在Telnet协议协商阶段，攻击者发送一个包含NEW_ENVIRON选项的请求，并将`USER`环境变量的值设置为`"-f root"`。
3.  Telnetd服务接收到此请求后，在准备调用`/usr/bin/login`时，将攻击者提供的`USER`环境变量值直接注入到`login`命令的参数中。
4.  例如，如果原始模板是`PATH_LOGIN " -p -h %h %?u{-f %u}{%U}"`，且`USER`环境变量被设置为`"-f root"`，则最终执行的命令会类似于`login -p -h [远程主机名] -f root`。
5.  `/usr/bin/login`程序根据其设计，识别`-f`参数为“自动登录”标志，并尝试以`root`用户的身份直接授予shell，无需密码验证。
6.  攻击者随即获得目标服务器的root权限shell访问。

**投毒风险分析:**
对所提供的`README.md`文档进行投毒风险评估，结果为低风险（5%）。该文档是一份详细的技术分析报告，而非可执行的POC代码。它通过解释漏洞原理、引用受影响的源码片段（来自`telnetd/telnetd.c`和`telnetd/utility.c`），并分析其如何导致参数注入，来帮助读者理解CVE-2026-24061。文档内容清晰，逻辑严谨，主要集中在漏洞的技术细节和影响上，不包含任何可直接执行的恶意脚本、二进制文件或外部链接。因此，直接从这份`README.md`文档感染恶意软件或触发恶意行为的风险极低。

然而，在广义的威胁情报和安全研究背景下，获取和使用任何公开的POC代码或漏洞分析文档都存在潜在风险，即便其本身是良性的。攻击者可能利用以下方式进行投毒：恶意重打包或修改POC代码，在看似合法的POC中植入后门；通过供应链攻击篡改POC托管平台上的内容；或利用社会工程学诱导用户下载包含恶意内容的“POC”。为了应对这些潜在风险，组织在处理任何公开的POC和漏洞信息时，应采取严格的防御措施，包括：始终从官方或可信渠道获取信息；在独立的沙箱环境中运行和分析所有POC代码；对POC进行彻底的代码审查和静态/动态安全分析；限制POC运行环境的网络访问；并遵循最小权限原则。通过这些措施，可以最大程度地降低因POC获取和使用带来的潜在投毒风险。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
