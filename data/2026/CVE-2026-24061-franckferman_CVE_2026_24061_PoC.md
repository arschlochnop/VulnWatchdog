## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过 / 参数注入

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过 / 参数注入

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程、无需认证、网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是GNU InetUtils套件中telnetd服务的一个严重远程认证绕过漏洞。该漏洞的根源在于telnetd在调用后端`/usr/bin/login`程序进行用户认证时，未能正确处理客户端通过Telnet协议`NEW-ENVIRON`选项传入的`USER`环境变量值。远程未经认证的攻击者可以通过在`USER`环境变量中注入恶意参数，例如`-f root`，欺骗`login`程序以root用户身份完成登录，从而绕过认证机制并获取目标系统的root权限。这本质上是一种参数注入（Argument Injection）缺陷，允许攻击者对`login`程序的行为进行控制。该漏洞影响GNU InetUtils从1.9.3到2.7（含）的所有版本，CVSS评分为9.8，属于高危漏洞。
所提供的POC代码是一个功能强大的Python脚本，名为`cve_2026_24061_poc.py`，并配有详细的`README.md`。它被设计为一个“Telnet Root Exploit & Scanner”，能够利用CVE-2026-24061来获取root shell。该POC完全实现了RFC 1572 `NEW-ENVIRON`协议协商，能够模拟Telnet客户端与服务端进行交互。脚本通过`socket`模块建立连接，精确构造Telnet命令序列，将`USER=-f root`作为环境变量注入。它支持单IP、CIDR范围及文件输入等多目标扫描模式，并能进行多线程处理，效率高。成功利用后，POC能够验证是否获得了root权限。代码结构清晰，易于理解和审计，是高度可用和可靠的漏洞验证及利用工具。
**利用步骤**:
1.  **环境准备**: 安装Python依赖库`colorama`和`netaddr`（通过`pip install -r requirements.txt`）。
2.  **目标识别**: 确定受影响的GNU InetUtils telnetd服务（默认端口TCP 23）的IP地址或IP范围。
3.  **执行利用**: 运行POC脚本，例如`python cve_2026_24061_scanner.py -t <目标IP>`。
4.  **协议交互**: 脚本将与目标建立Telnet连接，协商`NEW-ENVIRON`选项。
5.  **参数注入**: 脚本发送`USER=-f root`环境变量值，利用漏洞。
6.  **权限获取**: 如果目标易受攻击，攻击者将直接获得root权限，POC将对此进行确认。
**投毒风险分析**:
该POC代码的投毒风险被评估为**低**，约为5%。
**代码透明性**: 脚本采用Python编写，代码逻辑清晰，未发现代码混淆或加密，便于安全研究人员审查。它主要依赖于Python标准库和两个知名的开源库：`colorama`（用于控制台颜色输出）和`netaddr`（用于网络地址处理），这些库通常不包含恶意功能。
**行为分析**: 脚本的核心功能是实现Telnet协议通信，并将特定参数注入到目标服务中以验证漏洞。其网络活动局限于对目标Telnet服务（TCP 23端口）进行扫描和利用，没有迹象表明会向未知的第三方服务器发送数据、下载或执行额外负载、或在本地系统上执行非预期的文件操作（除了可选的CSV日志文件）。
**作者声明**: `README.md`明确指出该工具仅用于“授权安全审计和教育目的”，并强调未经授权使用的法律和道德风险。这表明作者的意图是出于合法安全研究，而非恶意传播。
**结论**: 综合来看，该POC是一个专注于漏洞利用的专用工具，其“恶意”行为仅限于针对目标系统进行测试以获取root权限，这与漏洞利用本身的行为特征相符。因此，它不包含常规意义上的恶意代码（如后门、病毒等），对运行POC的用户系统不构成显著的投毒威胁。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
