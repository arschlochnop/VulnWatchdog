## CVE-2026-24061 - GNU InetUtils Telnetd 远程认证绕过，权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过，权限提升

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils Telnetd 1.9.3 <= version <= 2.7

**利用条件:** 远程、无需认证、网络可达、默认安装的Telnetd服务

**POC 可用性:** 9

**POC 类型:** 完整利用 (Exploit)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个影响GNU InetUtils Telnetd服务的严重远程认证绕过漏洞，可导致未经身份验证的攻击者获取目标系统的root权限。该漏洞的核心在于Telnetd服务在处理客户端的“NEW-ENVIRON”选项时，未能对传入的`USER`环境变量进行充分的校验和过滤。当Telnetd调用 `/usr/bin/login` 程序进行用户认证时，它会将客户端提供的`USER`环境变量直接作为参数传递给`login`。攻击者可以利用这一机制，在`USER`环境变量中注入特定的值，例如“-f root”。`login`程序通常支持`-f`参数，用于指定用户登录时不执行某些初始化脚本，但当其与`root`结合时，在缺乏适当安全上下文校验的Telnetd环境中，会被错误地解释为以root用户身份登录的指令，从而绕过正常的密码验证过程。这个漏洞的利用逻辑巧妙地结合了Telnet协议的遗留特性、Telnetd服务对环境变量处理的不当以及`login`程序的参数解析机制，使其得以潜伏多年。由于Telnet协议本身是一个明文传输的遗留协议，长期处于低关注度和低维护力的状态，这也是此类深层设计缺陷能够长期存在的原因。该漏洞的CVSS评分高达9.8，表明其危害性极高，任何运行受影响版本的Telnetd服务的系统都面临被远程完全控制的风险。

所提供的Python脚本`cve_2026_24061_poc.py`是一个功能强大且高度有效的概念验证（PoC）及扫描器，用于检测和利用CVE-2026-24061。该脚本的显著特点是其对RFC 1572中定义的“NEW-ENVIRON”Telnet协议选项进行了原生且完整的实现，这表明了开发者对Telnet协议栈的深入理解。它无需依赖外部Telnet客户端或复杂工具，完全通过Python的`socket`模块构造和解析Telnet会话数据包。脚本支持多线程扫描，显著提升了大规模网络环境下的检测效率。其目标灵活性高，既可以针对单个IP地址进行检测，也能处理CIDR网络范围或从文件读取目标列表，并能选择将结果输出到CSV文件，极大地便利了安全审计工作。在利用机制上，脚本通过精心构造的Telnet选项协商过程，在`NEW-ENVIRON`阶段注入包含“-f root”值的`USER`环境变量。如果目标系统存在漏洞，这一操作将成功欺骗远程的`login`进程授予攻击者一个无需凭证的root shell。该工具集扫描、检测和利用能力于一体，且代码清晰、功能完备，展现了极高的PoC质量和实际可用性，可作为组织评估其Telnet服务安全风险的可靠工具。

利用该PoC进行攻击或安全审计的步骤如下：
1.  **环境准备**：确保本地系统已安装Python 3环境。根据`requirements.txt`文件，安装必要的第三方库：`pip install colorama netaddr`。`colorama`用于命令行输出的颜色高亮，`netaddr`用于IP地址和CIDR范围的处理。
2.  **目标识别**：确定要检测或攻击的目标系统IP地址。确保目标系统运行着可从外部访问的Telnetd服务（默认监听TCP端口23）。
3.  **基本扫描**：执行脚本以检测单个目标。例如，针对IP地址`192.168.1.1`：`python cve_2026_24061_poc.py -t 192.168.1.1`。
4.  **批量扫描**：对于更大范围的网络，可以使用CIDR表示法。例如，扫描`192.168.1.0/24`子网，并使用50个线程加速：`python cve_2026_24061_poc.py -t 192.168.1.0/24 -T 50`。
5.  **文件输入与结果输出**：如果目标列表存储在文件中（每行一个IP或CIDR），可以使用`-f`参数。同时，可以将扫描结果保存到CSV文件以供后续分析：`python cve_2026_24061_poc.py -f targets.txt -o results.csv`。
6.  **结果解析**：脚本执行后，会根据目标的响应判断其是否脆弱，并在控制台输出带有颜色标记的结果。如果系统被标记为“VULNERABLE”，则表明该系统易受攻击，攻击者可直接获得root权限。
7.  **后续操作**：在成功识别并利用脆弱目标后，攻击者通常会获得一个远程shell。此时，即可像在本地系统上一样执行命令，从而完全控制目标服务器。

对提供的`cve_2026_24061_poc.py`脚本的投毒风险评估为低（5%）。这一评估基于对其代码的全面审查，结果显示该脚本具有高度的透明性和良好的编程实践。首先，代码结构清晰，注释合理，逻辑易于理解，没有任何形式的混淆或加密，使得任何潜在的恶意行为都无所遁形。其次，脚本仅使用了Python标准库（如`socket`, `os`, `threading`, `argparse`等）以及两个广受认可且开源的第三方库`colorama`和`netaddr`。这些库的用途明确，`colorama`用于美化命令行输出，`netaddr`用于IP地址管理，均不涉及高风险操作。脚本中没有发现任何试图连接未经授权的外部服务器、下载并执行远程代码、写入可疑文件、修改系统配置或执行其他恶意活动的迹象。所有网络通信均严格围绕Telnet协议的规范，旨在模拟漏洞利用过程。最重要的是，`README.md`文件中包含明确的免责声明，指出该工具仅用于“授权的安全审计和教育目的”，并警告未经授权的使用是非法和不道德的。这种高度的透明度和对伦理使用的强调，进一步降低了将其误判为恶意代码的风险。因此，尽管任何公开的PoC代码都存在被滥用的可能，但就其自身作为攻击性工具的投毒风险而言，该脚本是安全的。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
