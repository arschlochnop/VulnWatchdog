## CVE-2026-24061 - GNU InetUtils Telnetd 远程认证绕过 (参数注入, 提权)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过 (参数注入, 提权)

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 1.9.3 及更高版本，直至修复版本

**利用条件:** 无需认证，通过网络远程访问，Telnet服务需监听TCP23端口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该POC代码提供了一个高度有效且完整的漏洞利用演示。它通过Docker Compose文件（`compose.yaml`）在隔离环境中搭建了攻击者和受害者机器。受害者机器（`node2`）精确地配置了一个易受攻击的GNU InetUtils telnetd服务（版本`inetutils-telnetd_2.6-3_amd64.deb`，被确认为受影响版本），并通过`inetd.conf`配置使其监听TCP 23端口。攻击者机器（`node1`）则包含了核心利用脚本`exploit.py`。该Python脚本能够模拟Telnet客户端，执行必要的Telnet协议协商，并利用`NEW-ENVIRON`选项的关键机制。具体来说，`send_new_environ_user`函数被设计用于注入一个恶意构造的`USER`环境变量，其中包含如`-f root`之类的参数。根据漏洞原理，telnetd服务在将该`USER`变量传递给`/usr/bin/login`程序进行身份验证时，未能对其进行充分的校验和过滤，从而导致参数注入，使`login`程序在处理时被欺骗。最终，攻击者可以在没有提供任何有效凭据的情况下，直接以root权限登录受害系统。整个POC代码结构清晰，逻辑严谨，精确复现了漏洞的触发机制和利用过程，证明了该认证绕过漏洞的真实性和高危性。其环境搭建自动化程度高，利用脚本功能完整，是复现和研究该漏洞的优秀工具。

**利用步骤：**
1.  **环境准备**：使用`docker-compose up --build`命令，依据提供的`compose.yaml`及关联的`Dockerfile.node1`和`Dockerfile.node2`文件，启动包含攻击者(`node1`)和受害者(`node2`)的两个Docker容器。
2.  **受害者服务**：`node2`容器将自动安装并启动`inetutils-telnetd`服务，监听TCP 23端口，并处于易受攻击状态。
3.  **发起攻击**：在`node1`容器内部，执行Python利用脚本，例如`python exploit.py <受害者IP> <恶意用户名>`。恶意用户名应包含漏洞利用所需的参数注入字符串，例如在`exploit.py`中传入`'-f root'`。
4.  **协议协商与注入**：`exploit.py`会连接到`node2`的Telnet服务，并进行Telnet协议协商。在协商过程中，它会利用`NEW-ENVIRON`选项向服务器发送包含恶意参数的`USER`环境变量。
5.  **权限获取**：`telnetd`服务接收到恶意`USER`环境变量后，会将其未经处理地传递给`/usr/bin/login`程序，导致`login`程序被注入参数，最终绕过认证，攻击者直接获得`node2`容器的`root`权限Shell。

**投毒风险分析：**
该CVE-2026-24061的POC代码经过仔细审查，其投毒风险被评估为极低（10%）。首先，代码结构清晰，逻辑透明，没有任何混淆或加密处理。`exploit.py`脚本完全使用Python标准库，核心功能专注于Telnet协议通信和环境变量的构造与注入，未发现任何与漏洞利用无关的文件读写、隐蔽网络回调、恶意系统命令执行或数据窃取等行为。Dockerfiles也清晰地展示了环境的构建过程，包括从Debian官方仓库下载特定版本的telnetd软件包，所有依赖项均来源于官方或可靠的开源渠道。整个POC旨在合法地演示和验证漏洞的存在和可利用性，其行为与所描述的漏洞利用原理完全一致。它不包含任何后门、恶意软件植入或其他非预期功能。因此，该POC可以安全地用于防御性安全研究、漏洞复现和防御措施验证。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
