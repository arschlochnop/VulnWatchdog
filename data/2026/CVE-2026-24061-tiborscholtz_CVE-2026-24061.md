## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过/提权

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过/提权

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 2.6之前

**利用条件:** 远程无认证访问，需要目标系统开启Telnet服务并运行受影响版本

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个影响GNU InetUtils telnetd版本2.6之前的严重远程认证绕过和提权漏洞。这个漏洞据称已潜伏超过十一年，允许未经身份验证的远程攻击者在受影响的系统上获得root权限。漏洞的核心在于telnetd服务在调用`/usr/bin/login`程序进行用户认证时，未能正确处理或验证客户端通过`NEW_ENVIRON`（Telnet选项39）机制发送的环境变量。攻击者通过构造并发送一个包含值`"-f root"`的恶意`USER`环境变量，可以欺骗`login`程序绕过正常的身份验证流程，直接授予一个root权限的shell。这种利用方式将未经验证的网络连接直接转化为完整的root权限系统入侵，因此被赋予了高达9.8的CVSS评分，属于高危漏洞。

**POC有效性分析**
所提供的POC是一个结构完善且功能完整的利用工具，旨在为CVE-2026-24061提供一个可重现的演示环境。它利用Docker Compose来编排两个容器：`node1`作为攻击者，`node2`作为易受攻击的目标。
`Dockerfile.node2`详细设置了受害者环境，它从一个合法的Debian归档中安装了`inetutils-telnetd`的特定版本`2.6-3_amd64.deb`。根据威胁情报，该版本在2.6之前，因此是易受攻击的。Dockerfile随后配置`inetd`来监听TCP 23端口，并在连接建立时启动`telnetd`，这模拟了一个标准的传统Telnet服务配置，确保目标处于易受攻击和可利用的状态。
`Dockerfile.node1`则负责准备攻击者环境，安装`telnet`客户端并复制`exploit.py`脚本。
`exploit.py`脚本是攻击的核心。它是一个基于Python的Telnet客户端，精确实现了必要的协议交互，其关键组件包括：
1.  **Telnet命令处理**：它正确定义了标准Telnet命令（`IAC`, `DO`, `WILL`, `SB`, `SE`）以及`NEW_ENVIRON`选项（39）。
2.  **协商逻辑（`handle_telnet_negotiation`）**：此函数智能地响应服务器发起的Telnet选项协商。至关重要的是，当服务器发送`DO NEW_ENVIRON`（表示支持环境变量协商）时，exploit会响应`WILL NEW_ENVIRON`，同意参与。
3.  **环境变量注入（`send_new_environ_user`）**：在同意`NEW_ENVIRON`后，脚本立即构造并发送恶意载荷。此载荷包含`IAC SB NEW_ENVIRON`序列，接着是`ENV_USERVAR`，字符串“USER”，`ENV_VALUE`，关键值`"-f root"`，最后是`IAC SE`。此序列注入了`USER=-f root`环境变量，而易受攻击的`telnetd`会将其未经校验地传递给`/usr/bin/login`。
4.  **交互式Shell（`interactive_telnet`）**：成功协商并传递载荷后，脚本将进入交互模式，允许攻击者与在受害者`node2`上获得的新root shell直接交互。
Docker Compose的环境设置、对易受攻击服务版本的精确控制以及Telnet协议与特定环境变量注入的准确实现，使这个POC高效且能够可靠地远程获取root访问权限，与威胁情报中的描述完全一致。

**利用步骤**
1.  **环境准备**：确保您的系统已安装Docker和Docker Compose。
2.  **文件放置**：将所有POC文件（`Dockerfile.node1`, `Dockerfile.node2`, `compose.yaml`, `exploit.py`）下载或克隆到一个专用目录中。
3.  **构建并运行**：在您的终端中导航到该目录，然后执行`docker-compose up --build -d`。这将构建攻击者（`node1`）和受害者（`node2`）容器，并在`node2`上启动易受攻击的Telnet服务。
4.  **进入攻击者容器**：通过`docker exec -it node1 bash`命令进入`node1`容器的shell。
5.  **执行漏洞利用**：在`node1`容器内部，运行漏洞利用脚本，目标指向`node2`：`python3 exploit.py node2`。
6.  **获取Root Shell**：如果利用成功，您将在`node2`容器上获得一个交互式的root shell（`#`提示符），从而确认漏洞已被成功利用。

**投毒风险分析**
此POC的投毒风险被评估为低，大约5%。此评估基于对所有提供的代码和配置文件的全面审查。
**代码清晰度和标准库**：`exploit.py`脚本使用清晰、未混淆的Python编写，仅利用了`socket`、`sys`和`select`等标准且广为人知的库。其逻辑透明地专注于Telnet协议协商和特定的漏洞利用机制。
**合法来源**：`Dockerfile.node2`从合法的Debian归档（`ftp.de.debian.org`）拉取`inetutils-telnetd`软件包。没有使用任何可疑或非官方的存储库来获取软件。
**无恶意指示**：未发现任何隐藏功能、对未知外部服务的调用、尝试从不受信任的来源下载或执行任意代码、异常的文件系统修改或超出漏洞利用本身范围的持久化机制。Dockerfile和Python脚本仅用于设置易受攻击的环境和执行所描述的攻击。
**预期目的**：此POC严格遵守其防御性研究目的：演示CVE。它不包含任何旨在建立后门、执行加密货币挖矿或从事通常与“投毒”POC相关的其他恶意活动的代码或载荷。因此，对于进行合法安全研究的组织而言，通过此POC无意中引入恶意软件的风险可以忽略不计。

**项目地址:** N/A

**漏洞详情:** https://www.cnvd.org.cn/flaw/show/CNVD-2026-05940
