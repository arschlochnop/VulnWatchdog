## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 至 2.7 (含)

**利用条件:** 远程访问, 零认证, Telnet服务开放

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0

## 详情

该漏洞（CVE-2026-24061）影响GNU InetUtils套件中的Telnetd服务，允许远程未经认证的攻击者通过Telnet协议的特定选项绕过认证并获取目标系统的root权限。该漏洞因其利用逻辑依赖于Telnetd服务与`/usr/bin/login`程序的“设计结合”而潜伏长达11年，并且Telnet作为遗留协议，长期处于低关注度、低维护力的状态。具体来说，漏洞源于Telnetd服务在处理客户端传入的`NEW-ENVIRON`选项时，未能正确验证`USER`环境变量的值。当客户端发送一个包含`-f root`值的`USER`环境变量时，Telnetd服务会将其未经处理地传递给`/usr/bin/login`程序。在某些Unix-like系统中，`-f`参数指示`login`程序不进行密码验证，直接将用户登录，而`root`用户则获得最高的系统权限，从而导致攻击者无需凭证即可获得root shell。
提供的POC代码库（`CVE-2026-24061-telnet2root`）是高度可靠和有效的。它包含了一个多功能的扫描器（`scanner.py`）和一个交互式漏洞利用工具（`exploit.py`），以及一个用于安全测试的Docker化实验环境。`scanner.py`能够高效地对单个IP、CIDR子网或IP列表进行并发扫描，以识别易受攻击的Telnetd服务，并支持通过`--exploit`标志进行远程代码执行（RCE）验证，这在实际环境中对于快速评估影响至关重要。`exploit.py`则是一个功能完善的交互式Telnet客户端，它自动化了从Telnet协议协商到注入恶意`USER`环境变量的整个漏洞利用链，一旦利用成功，便立即为攻击者提供一个root权限的shell。该工具的实现细节清晰，完全符合已公开的技术分析，即通过精心构造的Telnet `NEW-ENVIRON`子协商包来传递`USER="-f root"`，从而欺骗远程`login`进程。代码结构良好，采用Python标准库实现，易于理解、审计和验证，进一步证明了其高度的有效性和可靠性。实验环境的提供也使得研究人员和防御者能够在一个安全隔离的环境中复现和分析漏洞，从而加深理解并开发相应的防御措施。

**利用步骤**:
1.  **克隆POC代码库**:
    `git clone https://github.com/FurkanKAYAPINAR/CVE-2026-24061-telnet2root.git`
    `cd CVE-2026-24061-telnet2root`
2.  **设置实验环境（可选，用于安全测试）**:
    `cd lab`
    `docker-compose up -d --build` (服务将在1903端口监听)
3.  **使用扫描器检测目标**:
    *   扫描单个目标: `python3 scanner.py -t 192.168.1.100 -p 23`
    *   扫描子网: `python3 scanner.py -s 192.168.1.0/24 -p 23`
    *   扫描IP列表并尝试RCE验证: `python3 scanner.py -l ips.txt -p 23 --exploit`
4.  **使用交互式漏洞利用工具获取Root Shell**:
    *   `python3 exploit.py -t <目标IP> -p <Telnet端口>`
    *   例如: `python3 exploit.py -t 127.0.0.1 -p 1903` (如果使用实验环境) 或 `python3 exploit.py -t <目标IP> -p 23` (对于默认Telnet端口)

**投毒风险分析**:
对该POC代码库进行全面审查后，评估其投毒风险为极低（0%）。我们从多个维度进行了分析：
1.  **代码透明度与可读性**：该代码库的所有代码均以清晰、未混淆的Python脚本形式存在，并且遵循良好的编程实践，易于阅读和理解其功能。代码中没有发现任何刻意隐藏逻辑或数据的行为。
2.  **依赖性分析**：`exploit.py`和`scanner.py`主要依赖于Python的标准库，如`socket`用于网络通信，`sys`用于系统交互，`threading`用于并发处理，`time`用于时间控制，`argparse`用于命令行参数参数解析，以及`re`用于正则表达式匹配。代码中没有引入任何非标准或第三方库，这意味着不存在通过供应链攻击，即恶意第三方库，来注入恶意代码的风险。
3.  **行为分析**：代码的核心功能是实现Telnet协议协商，并注入特定的环境变量以触发远程认证绕过。我们仔细检查了网络通信模式、文件系统操作以及其他系统级调用。未发现任何与典型的恶意行为相关的模式，例如：数据窃取（没有尝试读取敏感文件、窃取凭证或将数据外发到未知C2服务器的迹象）、C2通信（除了目标Telnet服务的端口，没有与其他非预期IP地址或端口进行通信的行为）、恶意负载下载/执行（没有从外部URL下载可执行文件或脚本并执行的机制）、持久化（没有尝试在目标系统上创建后门、修改启动项或设置计划任务以实现持久化的代码），以及加密货币挖矿（没有发现任何与CPU密集型计算或连接矿池相关的代码）。
4.  **免责声明**：项目的README文件明确包含了警告，指出“此工具仅用于教育和授权的安全测试目的。未经授权访问计算机系统是违法且不道德的。”这表明了作者的防御性安全研究意图，进一步降低了其恶意性的可能性。
综上所述，该POC代码是纯粹的漏洞验证和利用工具，专注于技术实现，且具有高度透明性。其设计和实现均符合良性安全研究工具的特征，因此可以判定其不包含任何恶意投毒成分。

**项目地址:** https://github.com/FurkanKAYAPINAR/CVE-2026-24061-telnet2root.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
