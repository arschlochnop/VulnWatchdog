## CVE-2026-24061 - GNU Inetutils telnetd 远程认证绕过, 参数注入, 提权 (Pre-authentication bypass, Argument Injection, Privilege Escalation)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 参数注入, 提权 (Pre-authentication bypass, Argument Injection, Privilege Escalation)

**影响应用:** GNU Inetutils telnetd

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 远程利用, 零认证, 默认开放Telnet服务或自定义端口

**POC 可用性:** 10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低 (Low)

**投毒风险:** 5%

## 详情

该漏洞利用工具（POC）由 `scanner.py` 和 `exploit.py` 组成，旨在全面检测和利用 CVE-2026-24061 漏洞。其有效性极高，能够可靠地识别受影响的 GNU Inetutils telnetd 服务并获取远程 root 权限。`scanner.py` 是一款多线程、高效的扫描器，支持单目标IP、CIDR子网和IP列表作为输入。它甚至包含一个可选的 `--exploit` 标志，可以在扫描过程中主动尝试RCE（远程代码执行）验证，极大地提高了发现和验证漏洞的效率。`exploit.py` 则是一个强大且交互式的Telnet客户端，它自动化了复杂的Telnet协议协商和漏洞利用链，一旦成功，便会直接将用户置于目标系统的root shell中，提供了完整的控制能力。此外，POC项目还提供了一个Docker化的Ubuntu实验环境，运行着易受攻击的 `inetutils-telnetd` 版本，这使得安全研究人员可以在完全隔离和安全的环境中进行测试、复现和分析，极大地降低了误操作的风险。代码结构清晰，易于理解和审计，且依赖于标准Python库，确保了其稳定性和兼容性。总而言之，此POC是针对 CVE-2026-24061 的一个高质量、功能完善且易于使用的利用工具。

**利用步骤**
此漏洞利用过程相对直接，且攻击复杂度较低：
1.  **环境准备**: 确保您的攻击机器上已安装 Python 3.x。通过 Git 命令克隆 POC 代码库到本地：`git clone https://github.com/FurkanKAYAPINAR/CVE-2026-24061-telnet2root.git`，然后进入克隆下来的目录：`cd CVE-2026-24061-telnet2root`。
2.  **目标发现与验证 (可选)**: 如果您不确定目标IP是否存在漏洞，可以使用 `scanner.py` 工具进行探测。例如，扫描单个IP：`python3 scanner.py -t 192.168.1.100 -p 1903`；扫描一个子网：`python3 scanner.py -s 192.168.1.0/24 -p 1903`。如果希望在扫描时立即验证RCE，可以加上 `--exploit` 标志：`python3 scanner.py -l ips.txt -p 1903 --exploit`。
3.  **交互式利用**: 一旦确定目标系统脆弱，使用 `exploit.py` 即可获得一个交互式的 root shell。命令格式为：`python3 exploit.py -t <目标IP地址> -p <目标Telnet服务端口>`。例如：`python3 exploit.py -t 127.0.0.1 -p 1903`。
4.  **漏洞原理简述**: 攻击的核心在于 Telnet 协议的 `NEW-ENVIRON` 选项处理不当。当 Telnet 服务器（`inetutils-telnetd`）在与客户端协商 `NEW-ENVIRON` 选项时，攻击者可以通过发送一个特制的子协商包，其中包含 `IS VAR "USER" VALUE "-f root"` 这样的恶意构造。服务器端的 `telnetd` 进程在接收并处理这个 `USER` 环境变量时，未能对其进行充分的消毒或转义。因此，当 `telnetd` 随后调用 `/usr/bin/login` 程序进行用户认证时，`-f root` 值会被错误地解释为 `login` 命令的一个有效命令行参数，而不是一个普通的用户名字段。这使得 `login` 程序绕过正常的身份验证流程，直接授予攻击者 root 用户的权限，从而实现零认证远程提权。

**投毒风险分析**
对所提供的 CVE-2026-24061 POC 代码库进行详细分析后，可以评估其投毒风险为**极低，定为 5%**。这一评估基于以下几个关键因素：

首先是**代码的透明度和可读性**。整个POC项目由Python编写，核心利用逻辑分布在 `scanner.py` 和 `exploit.py` 两个文件中。这两个文件代码结构清晰，注释合理，变量命名规范，极易于安全研究人员进行审计和理解。没有发现任何形式的代码混淆、动态加载或加密代码段，这使得潜在的恶意行为难以隐藏。任何具有基本Python知识和网络协议背景的人都可以迅速掌握其工作原理。

其次，**依赖性检查**显示该POC仅使用了Python的标准库，包括 `socket` 用于网络通信、`sys` 和 `argparse` 用于命令行参数处理、`threading` 用于多线程扫描、`time` 用于时间控制、`re` 用于正则表达式匹配，以及 `pty`, `os`, `signal` 等用于实现交互式 shell 功能。这些都是Python生态系统中高度信任和广泛使用的内置模块，它们本身不包含已知漏洞或恶意功能。POC没有引入任何第三方外部库或二进制文件，这显著降低了通过供应链攻击引入恶意代码的风险。

再者，**网络行为分析**表明，POC的全部网络活动都严格围绕 Telnet 协议及其漏洞利用展开。`scanner.py` 会向指定目标发送 Telnet 探测请求，并分析服务器响应以判断是否存在漏洞；`exploit.py` 则会建立一个完整的 Telnet 会话，进行协议协商，并注入精心构造的 `NEW-ENVIRON` 选项以触发漏洞，最终尝试建立与目标设备的交互式 shell。在整个过程中，未观察到任何异常的网络连接尝试，例如与未知IP地址的通信、数据外发到第三方服务器、下载额外的恶意负载、或进行DDoS攻击等。其通信模式完全符合预期的 Telnet 利用逻辑。

此外，**文件系统和系统资源操作**也表现出高度的合规性。代码主要在内存中执行其逻辑，除了读取用户提供的IP列表文件（如果使用 `-l` 选项）和处理命令行参数外，没有进行任何意外的文件创建、修改、删除操作。它没有尝试修改系统配置、安装持久化后门、或利用系统资源（如CPU、内存）进行加密货币挖矿等非预期行为。其核心目标是提供一个临时的 root shell 访问，而非长期驻留或对系统造成物理性破坏。

最后，**作者意图和声明**进一步强化了低风险评估。项目的 `README.md` 文件明确声明了该工具的教育和授权安全测试目的，并包含了一个显眼的 `WARNING` 警告框，强调未经授权的访问是违法和不道德的。这种清晰的声明表明了作者致力于合法的安全研究和防御目的。POC提供的 Dockerized 实验环境也体现了作者鼓励安全、负责任地使用工具进行研究的理念。

综上所述，尽管任何来自外部的二进制或脚本都理论上存在风险，但此POC代码的透明度、对标准库的严格依赖、可预测的网络行为、有限的系统资源操作以及明确的防御性研究意图，使其成为一个低投毒风险的工具。建议在将其用于任何实际环境之前，仍然进行独立的沙箱环境测试和代码审查。

**项目地址:** https://github.com/FurkanKAYAPINAR/CVE-2026-24061-telnet2root.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
