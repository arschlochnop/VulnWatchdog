## CVE-2026-21440 - AdonisJS (@adonisjs/bodyparser) 路径穿越 (Path Traversal)

**漏洞编号:** CVE-2026-21440

**漏洞类型:** 路径穿越 (Path Traversal)

**影响应用:** AdonisJS (@adonisjs/bodyparser)

**危害等级:** CRITICAL

**CVSS评分:** 9.2

**影响版本:** @adonisjs/bodyparser <= 10.1.1, 11.x < 11.0.0-next.6

**利用条件:** 远程网络访问，应用程序需使用multipart文件上传功能且未对上传文件名进行手动重命名/过滤。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于AdonisJS的核心组件@adonisjs/bodyparser中。通过分析提供的POC代码和README文档，有效性确认如下：漏洞根源在于multipartfile.move()函数在处理上传文件时，如果开发者没有显式提供第二个参数（sanitizedName），系统会默认回退到客户端提供的原始文件名。由于代码库内部使用了path.join()处理路径，且未对原始文件名中的“../”等遍历序列进行严格校验，攻击者可以构造如“../../etc/cron.d/shell”的文件名。由于options.overwrite默认为true，这允许攻击者覆盖系统关键文件或在Web根目录外写入恶意脚本。提供的Dockerfile构建了一个完整的易受攻击环境，包含了受影响版本的依赖包和基础配置，具备极高的复现成功率。利用步骤：1. 启动Docker环境，使Vulnerable-App在3333端口运行。2. 寻找执行文件上传的接口。3. 构造一个多部分表单（multipart/form-data）请求，上传一个包含恶意Payload的文件。4. 在HTTP请求头或表单字段中，将文件名（filename）字段修改为包含路径穿越序列的字符串，例如“../../tmp/poc.txt”。5. 发送请求后，检查服务器文件系统，确认文件是否已写入预期的敏感路径。投毒风险分析：该POC项目展现出极高的专业性和透明度。分析其Dockerfile内容，其基础镜像使用了标准的node:20-alpine，安装的依赖包均通过官方npm仓库下载，没有发现引用不明来源的二进制文件或外部恶意脚本。README中明确标注了安全研究用途及风险警告，代码逻辑清晰且符合Node.js开发规范。在投毒风险评估中，重点检查了其healthcheck和环境变量配置，均指向本地localhost及模拟环境，未发现敏感数据回传（Exfiltration）或隐藏的反弹shell逻辑。唯一潜在风险在于其Docker镜像为了演示方便，将/app目录权限设置为777，这在受控研究环境外可能导致局部权限提升，但考虑到其目的是漏洞演示，此行为属于合理的非恶意范畴。总体而言，该POC代码清晰透明，未发现明显的后门植入或恶意投毒迹象，属于低风险等级的安全研究资料。

**项目地址:** /tmp/vulnwatchdog_9a4f4be994a7b47d3613b588cd00ca02/

**漏洞详情:** [https://www.tenable.com/cve/CVE-2026-21440](https://www.tenable.com/cve/CVE-2026-21440)
