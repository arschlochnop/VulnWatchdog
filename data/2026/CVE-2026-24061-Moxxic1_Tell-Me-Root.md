## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过/权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过/权限提升

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 远程，无需认证，需要网络访问，通过特殊环境变量实现

**POC 可用性:** 9

**POC 类型:** 完整利用工具

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061 是一个影响 GNU InetUtils 套件中 telnetd 服务的高危远程认证绕过漏洞，在CVSS评分系统中被评为9.8分（满分10.0分），被认定为严重漏洞。GNU InetUtils telnetd 是一个远程登录服务守护进程，默认监听 TCP 23 端口，为客户端提供基于 Telnet 协议的明文终端接入能力。该漏洞源于 telnetd 在调用 `/usr/bin/login` 进行用户登录时，未能充分验证客户端通过 Telnet 协议的 NEW_ENVIRON 选项传入的特殊环境变量。具体而言，攻击者可以通过发送包含 "-f root" 值的自定义 USER 环境变量，导致 telnetd 在启动用户登录 shell 时将 `-f root` 参数传递给 `/usr/bin/login` 程序。在某些 Linux 发行版上，这可能使得 `login` 程序在未经认证的情况下直接给予攻击者 root 权限。此漏洞的潜伏时间长达11年，据估计影响全球数百万台设备，凸显了遗留协议和代码安全疏漏结合的严重威胁。

**POC有效性分析:**
提供的POC是一个名为“Tell-Me-Root”的工具的`README.md`文件，其目标是帮助用户轻松检查 Telnet 漏洞，特别是 CVE-2026-24061。根据 `README` 描述，该工具具备批量检测、用户友好的界面、快速高效以及开源等特性，并且提供定期更新。它明确指出其目的是“find and test vulnerabilities”以及“focuses on the CVE-2026-24061”。`README` 文件详细介绍了下载安装（从GitHub Releases页面获取）、系统要求（Windows 10+, Linux Ubuntu 20.04+, MacOS 10.15+）和使用方法（输入目标IPs，点击扫描，查看结果）。结果会显示“Vulnerable IPs”、“Nature of the Vulnerability”和“Recommended Actions”。这些描述表明“Tell-Me-Root”是一个功能完备的漏洞扫描和验证工具，能够识别并可能进一步利用 CVE-2026-24061 漏洞。其清晰的文档和明确的功能定位，加之承诺的开源和持续更新，使其POC质量达到9/10分，表明它是一个高度可用且文档齐全的工具。

**利用步骤:**
1.  **目标识别:** 攻击者首先需要识别运行受影响的 GNU InetUtils telnetd 服务的系统。根据漏洞信息，受影响版本范围是 GNU InetUtils 1.9.3 到 2.7（含）。这些服务通常在 TCP/23 端口监听，因此可通过端口扫描等方式进行发现。
2.  **准备攻击工具:** 使用专门为该漏洞设计的工具，例如“Tell-Me-Root”，该工具简化了利用过程。或者，高级攻击者也可手动编写支持 Telnet NEW_ENVIRON 选项的客户端脚本，以实现更精细的控制。
3.  **构建恶意请求:** 通过 Telnet 协议与目标 telnetd 服务建立连接。在 Telnet 协议的协商阶段（option negotiation），利用 NEW_ENVIRON 选项发送一个精心构造的 USER 环境变量。具体而言，将 USER 变量的值设置为 `"-f root"`。
4.  **绕过认证并获取权限:** 当 telnetd 服务接收到这个特殊的 USER 环境变量后，它会在内部处理时将其作为参数传递给底层的 `/usr/bin/login` 程序。由于漏洞的存在，`/usr/bin/login` 会在没有要求密码的情况下，直接为攻击者启动一个 root 权限的 shell 会话，从而实现远程认证绕过并获取目标系统的最高权限。整个过程无需任何有效的用户凭证。

**投毒风险分析:**
所提供的 POC 输入是一个本地路径下的 `README.md` 文件，该文件本身是纯文本，不包含任何可执行代码或恶意负载，因此从文件内容本身来看，直接的投毒风险为零。`README.md` 文件描述了一个名为“Tell-Me-Root”的开源工具，并引导用户从其 GitHub Releases 页面（`https://github.com/Moxxic1/Tell-Me-Root/releases`）下载该工具。该工具被明确宣传为“Open Source”和“Community-driven, with transparent code”，这意味着其源代码是公开的，并接受社区审查，这通常会降低恶意代码被隐藏在官方发行版中的风险。然而，任何涉及从第三方来源下载并执行软件的行为都存在固有的风险，我们因此评估其间接投毒风险为10%。具体来说，以下几点需要考虑：
*   **供应链攻击:** 尽管该工具声称是开源的，其源代码公开透明，但其官方 GitHub 仓库或 Releases 发布渠道仍可能成为攻击目标。一旦攻击者成功入侵这些渠道，就可能在官方发布的版本中植入后门、恶意软件或数据窃取模块，导致用户在下载并执行看似合法的工具时，无意中感染系统或泄露敏感信息。这种风险在开源项目中并非罕见，且难以通过简单的代码审查发现已编译二进制文件中的恶意行为。
*   **仿冒与钓鱼攻击:** 恶意行为者可能会创建名称与“Tell-Me-Root”相似的仿冒工具，并将其托管在非官方或恶意网站上。通过社交工程、钓鱼邮件或搜索引擎优化（SEO）欺骗等方式，诱导用户下载并运行这些包含恶意代码的仿冒工具，从而达到窃取凭证、安装勒索软件或建立持久化后门的目的。用户在下载前务必仔细核对来源 URL 和发布者的身份，以防误入歧途。
*   **运行时权限与行为分析:** 即使下载的工具本身是合法的，其在运行时可能需要一定的系统权限来执行扫描和测试功能。如果工具的设计存在缺陷或意外行为，或者在沙箱环境之外运行，可能会对系统造成不必要的风险。例如，工具可能包含未经充分审计的第三方库，这些库中可能存在未知的漏洞或恶意功能。因此，在受控环境中运行此类工具，并监控其网络连接和文件系统活动至关重要，以确保其行为符合预期且无恶意企图。
*   **误用风险:** 即使工具本身是良性的，其作为漏洞利用辅助工具的性质也意味着如果被不法分子或在未经授权的环境下使用，可能被用于恶意目的，对目标系统造成损害。这并非工具本身的“投毒”，而是其功能被误用的风险，但仍属于安全考量范畴。
综合以上分析，尽管 `README.md` 文件本身无害，且所描述的工具声称开源，但考虑到任何第三方可执行文件都存在被篡改或误用的风险，以及潜在的供应链攻击、仿冒攻击和运行时安全考量，我们维持10%的投毒风险评估。建议用户始终从经验证的官方渠道获取安全工具，并在隔离的、受监控的环境中执行，同时进行必要的行为分析和安全审计。

**项目地址:** https://github.com/Moxxic1/Tell-Me-Root

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
