## CVE-2026-24061 - GNU InetUtils Telnetd 远程认证绕过, 权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 权限提升

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 至 2.7 (含)

**利用条件:** 远程、无需认证、网络可达、Telnetd服务运行在受影响版本

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该漏洞编号为CVE-2026-24061，是一个影响GNU InetUtils Telnetd服务的远程认证绕过漏洞。该漏洞的CVSS评分为9.8，被认为是严重级别。攻击者可以利用此漏洞，通过Telnet协议绕过认证直接获取目标系统的root权限。漏洞的根本原因在于Telnetd服务在调用`/usr/bin/login`程序进行用户登录时，未对客户端传入的`USER`环境变量进行有效校验与过滤，直接将其作为参数传递。攻击者可以通过Telnet的`NEW_ENVIRON`选项，发送包含特殊值（例如“-f root”）的自定义`USER`环境变量，从而欺骗`login`进程在没有凭证的情况下授予shell。

**POC有效性分析**：
提供的POC代码是一个用Python编写的批处理扫描和利用工具，专门针对CVE-2026-24061漏洞。根据`README.md`和`exploit.py`的分析，该POC具有高度的有效性和实用性。它支持从文本文件（如`ip_list.txt`）批量导入目标IP地址和端口，提高了效率。在尝试利用之前，工具会进行智能预检查，通过socket连接确认目标的可达性，避免不必要的Telnet客户端启动，从而优化了扫描过程。利用的核心在于自动载荷注入。该工具内置了利用CVE-2026-24061漏洞的载荷，即通过Telnetd服务的`NEW_ENVIRON`选项发送包含“-f root”值的自定义`USER`环境变量。这种方式可以欺骗目标系统的`login`进程，在无需凭证的情况下授予攻击者root权限的shell。一旦利用成功，POC会直接在当前终端中提供一个交互式shell，方便攻击者进一步操作。工具还提供了实时进度条显示，用户可以清晰地了解扫描和利用的进展。健壮的错误处理机制使得当目标超时、拒绝连接或不可达时，脚本能够自动跳过这些目标并继续扫描，保证了批处理操作的流畅性。代码结构清晰，使用了`pexpect`库来处理Telnet的交互式会话，这是自动化此类任务的常见且有效的方式。综合来看，该POC是一个功能完整、易于使用、且高度有效的漏洞利用工具。

**利用步骤**：
1. **环境准备**：确保系统安装了Python 3.8+版本以及`pexpect`库。可以使用`sudo apt install python3-pexpect`和`sudo pip install -r requirements.txt`进行安装。
2. **目标列表配置**：在脚本同目录下创建一个名为`ip_list.txt`的文本文件。文件中每行包含一个目标IP地址，可选地后跟冒号和端口号（例如`192.168.1.1`或`192.168.1.103:8888`）。以`#`开头的行将被视为注释并忽略。
3. **运行脚本**：在命令行中执行`python exploit.py`或`python3 exploit.py`。如果目标列表文件名为自定义，则使用`python exploit.py --file my_targets.txt`。
4. **漏洞利用**：脚本将遍历目标列表，对每个可达的目标，尝试通过Telnet协议发送包含特殊`USER`环境变量（值为“-f root”）的`NEW_ENVIRON`选项。
5. **获取Root Shell**：如果目标系统受影响且利用成功，脚本将自动获取目标机器上的root权限，并在本地终端中提供一个交互式的root shell。用户可以在此shell中执行命令。
6. **退出**：在交互式shell中输入`exit`即可退出。

**投毒风险分析**：
针对提供的POC代码`exploit.py`及其`README.md`文件进行审查，评估其投毒风险。代码是纯Python编写，结构清晰，主要使用了`socket`、`pexpect`、`os`、`sys`、`time`、`argparse`等标准或常用的第三方库。`pexpect`是用于自动化交互式程序（如Telnet客户端）的标准库。`logfy`库虽不常见，但从代码上下文来看，它主要用于日志输出，并未发现有执行外部恶意代码或进行隐蔽网络通信的迹象。代码的核心逻辑在于读取目标列表，尝试连接Telnet服务，并发送特定的环境变量载荷来绕过认证。这是一个典型的漏洞利用流程，旨在获取目标系统的控制权。该工具本身的主要目的是为了演示或执行漏洞利用，而不是作为恶意软件的载体。在代码中未发现明显的混淆、加密或者动态加载外部恶意脚本的行为。没有看到任何与加密货币挖矿、反向shell连接到未知C2服务器（除了目标成功利用后给出的交互式shell）或者持久化机制相关的代码。`README.md`中明确强调了该项目“严格用于安全研究和测试。请勿在未经授权的系统上使用”，表明了其合法的安全研究用途，并警示了滥用可能带来的法律风险。因此，从POC代码本身来看，它专注于CVE-2026-24061的漏洞利用功能，并未发现夹带额外的恶意载荷或行为。其投毒风险评估为低（10%），意味着该工具本身被恶意篡改以进行额外投毒的可能性很小。但是，任何具有利用能力的工具，一旦落入恶意攻击者手中，都可能被用于攻击，这是漏洞利用工具的固有风险，并非POC代码本身的投毒风险。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
