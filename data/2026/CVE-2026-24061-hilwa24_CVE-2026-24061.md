## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过 (Argument Injection)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过 (Argument Injection)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程，无需认证，需要网络访问，低复杂度

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是一个影响GNU InetUtils套件中telnetd服务的远程认证绕过漏洞，被评为严重等级，CVSS评分高达9.8分（满分10.0分）。该漏洞影响GNU InetUtils从1.9.3版本到2.7版本（含）的所有版本。漏洞的核心源于telnetd在调用后端`/usr/bin/login`程序进行用户登录时，未能对客户端传入的`USER`环境变量进行充分的校验和净化。攻击者可以远程通过构造恶意的`USER`环境变量值，例如`-f root`，来欺骗`login`程序。`login`程序会误将`-f root`解析为合法参数，从而绕过认证过程，并直接以`root`权限登录到目标系统。这意味着未经授权的远程攻击者无需任何凭证即可获取目标系统的最高权限。该漏洞的利用复杂度被评估为低，使得其威胁性极高，广泛部署在嵌入式系统、网络设备以及其他可能使用GNU InetUtils telnetd服务的环境中都面临严重风险，亟需引起高度关注并采取防护措施。

提供的POC是一个名为“Tell Me Root”的Python工具，专门用于批量扫描和利用CVE-2026-24061漏洞。该工具功能完整且文档齐全，被评估为高质量的POC（POC质量评分9/10）。它利用`pexpect`库实现了与Telnet服务的自动化交互，能够有效地注入恶意`USER`环境变量。POC具备多项实用功能，包括：1. 批量处理：支持从文本文件（如`ip_list.txt`）导入目标IP列表。2. 智能预检查：在尝试Telnet连接前，会先进行Socket连接性测试，确保目标可达。3. 自动化载荷注入：内置payloads（即`USER=-f root`等）能够自动尝试，并在成功后将Shell控制权交由用户。4. 实时进度显示：提供清晰的进度条，方便用户跟踪扫描状态。5. 错误处理：对于连接超时、拒绝连接或不可达的主机，脚本会自动跳过，确保扫描流程不受中断。综合来看，该POC能够可靠、高效地复现和利用CVE-2026-24061漏洞，获取目标系统的root权限。

利用此POC进行攻击的步骤如下：
1. **准备目标列表**：在与`exploit.py`脚本相同的目录下创建一个名为`ip_list.txt`的文件。文件中每行包含一个目标IP地址，可选择性地在其后添加冒号和端口号（例如`192.168.1.1`或`192.168.1.103:8888`）。以`#`开头的行将被视为注释并忽略。
2. **环境准备**：确保系统安装了Python 3.8或更高版本。同时，需要安装`pexpect` Python包。在基于Debian/Ubuntu的系统上，可以通过`sudo apt update && sudo apt install python3-pexpect`来安装。之后，通过`pip install -r requirements.txt`安装其他依赖（POC代码中提到了`pexpect`，`requirements.txt`可能是更完整的依赖列表）。
3. **运行脚本**：在终端中执行`python3 exploit.py`命令。如果目标列表文件名为自定义，则使用`python3 exploit.py --file my_targets.txt`。
4. **交互式会话**：脚本将开始扫描`ip_list.txt`中列出的目标。对于每个可利用的目标，脚本将自动注入payload，绕过认证并尝试获取一个root shell。一旦成功，脚本会将交互式shell会话传递给当前终端，攻击者可以直接在目标系统上执行命令。攻击者可以通过输入`exit`来退出交互模式。

对提供的POC代码（`exploit.py`）及其配套的`README.md`文件进行了详细分析，以评估其潜在的投毒风险。首先，`README.md`明确声明此项目仅用于安全研究和测试目的，并警告用户不得在未经授权的系统上使用。从代码层面来看，`exploit.py`的结构清晰，可读性强，没有发现明显的混淆或加密代码。它主要使用了Python标准库（如`os`、`sys`、`time`、`socket`、`argparse`）以及`pexpect`库。`pexpect`是一个广泛用于自动化交互式应用程序的合法Python库，在安全工具中很常见。脚本的逻辑是建立Telnet连接，发送特定构造的`USER`环境变量字符串以触发漏洞，然后管理通过`pexpect`获得的交互式会话。整个过程中，代码没有表现出任何下载外部恶意代码、执行`eval()`函数、向未知第三方服务器发送敏感数据、或尝试在本地系统上安装后门等可疑行为。虽然引入了`logfy`模块，但在未提供其代码的情况下，通常假设它是一个简单的本地日志记录工具，不会引入恶意功能。因此，该POC的投毒风险被评估为低（约10%）。建议用户在部署任何安全工具前，始终从官方或可信来源获取依赖，并对代码进行安全审计，以确保其完整性和安全性。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
