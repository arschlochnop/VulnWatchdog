## CVE-2026-24061 - GNU Inetutils telnetd 远程身份验证绕过 (Argument Injection)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程身份验证绕过 (Argument Injection)

**影响应用:** GNU Inetutils telnetd

**危害等级:** Critical (高危)

**CVSS评分:** 9.8

**影响版本:** GNU Inetutils telnetd ≤ 2.7

**利用条件:** 需要网络访问，无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是GNU Inetutils telnetd中的一个高危远程身份验证绕过漏洞，影响版本为2.7及更早版本。该漏洞的CVSS评分为9.8，允许未经身份验证的远程攻击者绕过Telnet服务的认证机制，从而获得未经授权的访问权限，并可能提升至root权限。漏洞的根本原因是一个参数注入（Argument Injection）问题，发生在telnetd服务器在处理用户登录请求时，调用`/usr/bin/login`程序的过程中。攻击者可以通过在Telnet协议协商阶段注入恶意的环境变量，特别是将`USER=-f root`这样的参数注入到环境中。当telnetd将这些带有注入参数的环境变量传递给`/usr/bin/login`时，`login`程序会错误地将其解释为绕过认证的合法参数，从而直接授予攻击者root权限，无需提供任何凭据，导致系统完全受控。

所提供的Python POC脚本`CVE-2026-24061.py`是一个功能完备且设计精良的漏洞利用工具。它利用Python的标准网络编程能力，与目标telnetd服务建立连接。脚本内部的`TelnetNegotiator`类巧妙地处理了Telnet协议的复杂性，包括解释命令（IAC）和管理子协商（SB, SE）。其核心利用逻辑位于`send_env`方法，该方法精心构造Telnet子协商数据包，将恶意载荷`USER=-f root`作为环境变量注入。这一载荷对于触发telnetd服务器中的参数注入漏洞至关重要。成功注入并绕过认证后，POC会提供一个交互式的`Shell`类，使攻击者能够在受感染系统上获得root权限的命令行界面。代码的清晰性、对标准库的依赖以及对报告漏洞的直接利用方式，都充分证实了其高度的有效性。
利用步骤如下：
1. **目标识别**：识别运行GNU Inetutils telnetd 2.7或更早版本、可通过网络访问的目标系统。
2. **执行POC**：在Python 3环境下运行POC脚本：`python3 CVE-2026-24061.py <target_host> <target_port>`。将`<target_host>`替换为目标服务器的IP地址或主机名，`<target_port>`替换为Telnet服务端口（默认为23）。
3. **协商与注入**：脚本会自动初始化Telnet会话，执行必要的协议协商，并通过Telnet子协商命令注入`USER=-f root`参数作为环境变量。
4. **权限获取**：脆弱的telnetd服务处理该环境变量，导致`/usr/bin/login`程序被调用时带有`-f root`参数，从而绕过认证。
5. **交互式Shell**：脚本随后提供一个交互式的root权限Shell，允许攻击者在目标系统上以管理员权限执行任意命令。

对CVE-2026-24061的POC代码`CVE-2026-24061.py`进行了细致的安全审查，以评估其潜在的投毒风险。投毒风险是指公开分发的POC脚本可能包含隐藏的恶意代码，例如后门、加密货币挖矿程序、数据窃取例程或其他不必要的恶意功能，这些功能通常伪装成合法的漏洞利用逻辑。

根据分析，此Python脚本的投毒风险极低，估计为5%。这一低风险评估基于以下几个关键观察点：
首先，脚本只使用了标准的Python库：`socket`、`sys`、`select`和`threading`。这些都是用于网络通信、系统交互和并发的核心模块，其包含完全符合网络型漏洞利用工具的合法功能。脚本中没有导入任何异常或第三方库，这可能秘密引入外部依赖或隐藏功能，从而大大限制了潜在的攻击面。
其次，脚本除了与目标Telnet服务进行通信外，没有尝试进行任何其他外部网络连接。代码中没有发现对`requests`、`urllib`或类似HTTP客户端库的调用，这些库可能被用于命令与控制（C2）通信、数据外泄或下载额外的恶意载荷。`socket`模块仅用于与指定的目标主机和端口进行通信的预期目的。
第三，代码非常清晰，完全没有混淆技术。没有base64编码字符串、复杂的字符串数学运算或动态加载代码段（如`eval()`、`exec()`调用），这些都是恶意行为者常用来隐藏其真实意图的手段。Telnet协议常量和漏洞利用的协商与载荷注入逻辑都直观易懂，便于任何安全分析师进行审计。
第四，区分针对受害系统的漏洞利用载荷与POC本身可能包含的恶意载荷至关重要。脚本中的`user="-f root"`是为**脆弱目标服务**精心制作的参数注入载荷，旨在实现身份验证绕过。这不是一个旨在损害运行POC的用户本身的恶意命令，而是POC注入到目标系统以获取未经授权访问的参数。将漏洞利用载荷（针对受害者）与可能针对运行POC的安全研究人员的恶意载荷混淆是错误的。
最后，脚本的所有功能都完全集中于实现既定目标：身份验证绕过和交互式Shell。代码的每一行都直接有助于Telnet协商、载荷传输以及随后的交互式通信，没有冗余代码暗示存在次要或隐藏目的。
综上所述，基于对标准库的依赖、缺乏可疑的外部通信、代码未混淆以及其载荷与漏洞描述直接对齐，`CVE-2026-24061.py` POC的投毒风险被评估为非常低（约5%）。用户可以高度信任地运行此POC，因为它不会对本地执行环境造成恶意影响。然而，作为通用的安全原则，所有漏洞利用代码，即使被评为低风险，也应在受控和隔离的环境（例如虚拟机）中执行，以规避任何不可预见的风险。

**项目地址:** https://github.com/JayGLXR/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
