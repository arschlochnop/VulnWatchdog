## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 远程、无需认证

**POC 可用性:** 9/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是GNU InetUtils telnetd中的一个高危远程认证绕过漏洞。该漏洞源于telnetd服务在处理客户端通过NEW-ENVIRON telnet选项发送的环境变量时存在安全疏漏。特别是，当telnetd在调用`/usr/bin/login`进行用户登录认证时，未能对传入的`USER`环境变量进行充分的验证和清理。攻击者可以利用此缺陷，通过构造恶意的`USER`环境变量（例如设置为`'-f root'`），绕过正常的身份验证流程，直接以root权限登录目标系统。该漏洞影响广泛，已潜伏多年，被多个安全研究机构证实可导致远程获取root权限，且利用难度极低。

**POC有效性分析**：提供的POC是一个名为`telnetd_CVE-2026-24061_test.py`的Python脚本，旨在检测telnetd服务器是否存在CVE-2026-24061漏洞。根据`README.md`的描述，该脚本是一个功能完善、易于使用的安全测试工具。它利用NEW-ENVIRON telnet选项尝试注入特定的环境变量，以模拟攻击者绕过认证的行为。脚本提供了详细、彩色的输出，包括分步进度、全面的错误处理以及最终的测试结果、风险评估和影响分析总结。脚本声称是独立的，仅使用Python标准库模块，无需额外安装。其设计目标是作为概念验证工具，有效验证目标telnetd服务是否易受此环境变量注入漏洞攻击，进而判断其是否存在认证绕过风险。鉴于其详细的文档和清晰的测试目的，该POC的有效性很高，能够准确识别脆弱系统。

**利用步骤**：攻击者可以执行以下步骤利用此漏洞：
1. 识别运行GNU InetUtils telnetd服务的Linux系统。
2. 使用支持NEW-ENVIRON选项的telnet客户端或专门编写的脚本（如提供的POC脚本），与目标telnetd服务建立连接。
3. 在认证过程中，通过NEW-ENVIRON选项向服务器发送包含恶意值的`USER`环境变量，例如`USER='-f root'`。
4. 如果目标telnetd服务存在漏洞且未对`USER`变量进行适当清理，它会将`'-f root'`传递给底层的`/usr/bin/login`程序，使其误认为用户为`root`且已通过认证，从而允许攻击者无需密码以root权限登录系统。
5. 成功登录后，攻击者即可完全控制受感染的系统。

**投毒风险分析**：根据提供的`README.md`文件对POC脚本的描述，该脚本被设计为一个“安全测试工具”，旨在“检测漏洞”，并声称“仅使用Python标准库模块”，无需额外安装。这意味着该POC的主要目的是进行合法的安全评估和漏洞验证，而非执行恶意操作或传播恶意负载。脚本的文档清晰，说明了其功能、用途和技术细节，未提及任何混淆代码、外部可疑依赖或与恶意服务器通信的行为。因此，基于现有信息，该POC被判定为投毒风险极低（10%）。然而，用户在下载和运行任何POC代码时，仍应保持警惕，务必从可靠来源获取，并在隔离环境中进行初步审查和测试，以防范潜在的、未在文档中披露的恶意行为。本分析仅基于提供的`README.md`内容，若实际脚本代码存在差异，风险评估可能随之改变。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
