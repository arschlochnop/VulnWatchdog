## CVE-2026-24061 - GNU InetUtils telnetd 参数注入 (Argument Injection)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 参数注入 (Argument Injection)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 <= version <= 2.7

**利用条件:** 远程利用，无需认证，网络访问

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是GNU InetUtils telnetd服务中的一个严重远程认证绕过漏洞。该漏洞允许远程未经认证的攻击者通过Telnet协议的NEW-ENVIRON选项，向telnetd服务注入恶意构造的USER环境变量值，例如使用'-f root'。由于telnetd在调用后端的`/usr/bin/login`程序进行用户认证时，未能对这些传入的环境变量进行充分的验证和清理，导致`login`程序误将恶意值解析为合法的命令行参数。最终，这使得攻击者能够欺骗`login`程序，绕过正常的认证流程，并直接获得目标系统的root权限访问。此漏洞的CVSS评分为9.8，危害等级为严重，且攻击复杂度低，极易被利用。

**POC有效性分析:**
提供的POC是一个名为`telnetd_CVE‑2026‑24061_test.py`的Python脚本。该脚本被明确描述为一个“安全测试工具”，其主要目的是“检测”telnetd服务器是否存在通过NEW-ENVIRON Telnet选项进行环境变量注入的漏洞。脚本的设计旨在模拟攻击者构造恶意USER环境变量（如`USER=-f root`）的行为，并观察telnetd服务器的响应，以判断其是否对该漏洞易受攻击。根据POC的README文件，该脚本是独立的，仅使用Python标准库模块，无需安装额外的第三方依赖，这大大简化了其部署和使用过程。脚本提供了详细、彩色编码的输出，包括测试进度、全面的错误处理以及包含测试结果、风险评估和影响分析的最终总结。这些特性表明该POC是一个功能完整的概念验证工具，能够有效且可靠地识别目标系统是否受CVE-2026-24061漏洞影响。它不直接提供完整的攻击利用链来获取root权限，而是验证了漏洞的存在性，为后续的利用提供了基础。因此，该POC对于安全研究人员和系统管理员来说，是验证系统是否存在该严重漏洞的有力工具，具有很高的实用价值和有效性。

**利用步骤:**
1.  **目标识别:** 攻击者首先需要确定目标系统正在运行受影响的GNU InetUtils telnetd服务版本（1.9.3至2.7）。通常，telnetd服务监听在TCP 23端口。
2.  **建立连接:** 攻击者使用支持NEW-ENVIRON Telnet选项的客户端（或编写自定义脚本，例如此处分析的PoC）连接到目标telnetd服务。
3.  **环境变量注入:** 在与telnetd建立会话后，攻击者通过NEW-ENVIRON选项发送一个恶意构造的USER环境变量。最常见的payload是`USER=-f root`。
4.  **后端处理:** 易受攻击的telnetd服务接收到此环境变量后，在将其传递给用于认证的`/usr/bin/login`程序时，不会对其进行充分的过滤或清理。
5.  **参数注入与认证绕过:** `/usr/bin/login`程序会将`USER=-f root`中的`-f root`部分错误地解释为其自身的命令行参数，其中`-f`选项通常用于跳过二次认证（如PAM模块）。通过这种方式，`login`程序在未经验证的情况下将攻击者认证为`root`用户。
6.  **权限获取:** 成功利用后，攻击者将直接获得目标系统的root权限shell访问，从而完全控制受影响的系统。

**投毒风险分析:**
根据提供的POC代码的`README.md`内容，该工具被明确标注为“Telnetd CVE-2026-24061 Test Script”和“security testing tool”，其核心目的是“检测”telnetd服务器是否存在漏洞，而非执行恶意操作或部署后门。`README`文件还特别强调，该脚本是独立的，且“uses only Python standard library modules”，意味着它没有外部依赖，从而避免了因引入第三方库而可能带来的潜在恶意代码风险。在提供的POC代码片段中，没有发现任何代码混淆、对外部可疑资源的请求、利用`eval`等高风险函数、或包含任何已知恶意行为的迹象。文件路径`/tmp/vulnwatchdog_.../README.md`也暗示这可能是一个在受控安全分析环境中运行的合法安全工具的一部分。综合来看，该POC的投毒风险评估为极低（5%）。它似乎完全致力于其声明的安全检测目的，并且在设计和实现上采取了措施来最小化潜在的安全风险。然而，在实际使用任何第三方安全工具之前，始终建议对完整的源代码进行彻底审查，以确保其行为完全符合预期且不包含任何隐藏的恶意功能。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
