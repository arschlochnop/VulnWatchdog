## CVE-2026-21858 - n8n (Workflow Automation Platform) RCE

**漏洞编号:** CVE-2026-21858

**漏洞类型:** RCE

**影响应用:** n8n (Workflow Automation Platform)

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** n8n < 1.121.0 (LFI) / 0.211.0 - 1.120.3 (RCE)

**利用条件:** 无需身份验证，通过网络远程访问目标端口 (默认 5678)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞链结合了两个高危漏洞（CVE-2026-21858和CVE-2025-68613），形成了一个从非授权访问到系统控制的完整闭环。CVE-2026-21858的核心在于Content-Type混淆导致的任意文件读取。在受影响版本中，由于后端未能严格校验Content-Type是否为multipart/form-data，攻击者可通过发送application/json请求，在JSON Body中直接控制filepath参数，绕过文件上传的安全检查。实验证明，该方式可稳定读取/proc/self/environ获取环境变量及HOME路径。利用步骤如下：首先，攻击者利用CVE-2026-21858读取目标系统的环境变量、配置文件（config）和数据库文件（database.sqlite）；随后，从配置文件中提取encryptionKey，并从数据库中获取管理员信息；接着，利用提取的秘钥伪造管理账户的JWT Session Token实现垂直越权。最后，结合CVE-2025-68613漏洞，在拥有管理权限的情况下，通过创建包含表达式注入的Workflow，利用JavaScript沙箱逃逸技术（通过this.process.mainModule.require）执行系统级命令。此POC链条逻辑清晰，利用路径通畅，且已有完整的全自动化脚本发布，对互联网上暴露的10万余台n8n服务器构成了极大威胁。投毒风险分析：经过对提供的POC代码结构及README描述分析，该POC主要由Cyera研究员Dor Attias和社区成员Chocapikk披露，其代码逻辑展示了清晰的漏洞利用链条，未发现明显的恶意混淆或外部可疑连接。POC中使用的Dockerfile和README文档旨在演示安全隐患，符合安全研究规范。然而，在针对此漏洞的投毒风险评估中，需警惕两点：一是脚本化利用工具（如Github项目Chocapikk/CVE-2026-21858）在下载执行时，若攻击者在自动化脚本中植入反弹Shell或窃取本地凭证的代码，普通研究员难以在快速测试中察觉；二是由于该漏洞涉及JWT秘钥派生，任何声称能自动‘生成’或‘爆破’秘钥的二进制预编译工具均存在极高的投毒嫌疑。目前该特定POC文本部分表现为合法的防御性研究，建议在使用此类自动化利用脚本前，严格审查JavaScript payload中execSync执行的指令，防止测试者反被控制。当前代码整体呈现低风险，但由于其CVSS评分高达10.0，黑产团伙极易以此为诱饵发布虚假‘一键利用工具’。因此，组织在复现时应在完全隔离的沙箱镜像环境中运行，并对网络流量进行严格审计。

**项目地址:** [https://github.com/Chocapikk/CVE-2026-21858](https://github.com/Chocapikk/CVE-2026-21858)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2026-21858](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2026-21858)
