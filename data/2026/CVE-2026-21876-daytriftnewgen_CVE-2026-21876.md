## CVE-2026-21876 - OWASP ModSecurity Core Rule Set (CRS) WAF绕过/SSTI

**漏洞编号:** CVE-2026-21876

**漏洞类型:** WAF绕过/SSTI

**影响应用:** OWASP ModSecurity Core Rule Set (CRS)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** CRS < 4.22.0, CRS < 3.3.8

**利用条件:** 目标系统使用受影响版本的OWASP CRS进行防护，且后端应用支持解析带有charset参数的multipart/form-data内容（如Flask、Python内置解析库等）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC展示了一个针对OWASP CRS WAF的高级绕过技术。其核心原理在于利用ModSecurity对multipart/form-data请求中'charset'参数处理的不一致性。攻击者在Content-Disposition或Content-Type头部中注入非标准的编码声明（如UTF-7），而WAF规则集在此时未能对这些经过编码的恶意Payload（如SSTI攻击代码 '+AHs-+AHs-' 对应的 '{{'）进行正确的解码检测，导致Payload直接穿透防护层到达后端。POC包含完整的Docker部署环境，通过Flask应用模拟了一个存在SSTI（模板注入）漏洞的后端，证明了即使在WAF处于最高偏执模式（Paranoia Level 1）下，只要利用字符集编码差异，攻击者就能成功执行恶意代码。该POC逻辑清晰，复现环境完整，具有极高的实战参考价值和防御测试意义。利用步骤：1. 使用docker-compose启动提供的实验环境。2. 构造一个POST请求，将Content-Type设置为multipart/form-data并定义boundary。3. 在表单字段（如username）的Header中指定'charset=utf-7'。4. 将恶意Payload（如SSTI探测语句）进行UTF-7编码后放入该字段。5. 发送请求至部署了ModSecurity的代理端口（8083），观察请求绕过WAF并被后端Flask解析执行。投毒风险分析：该POC项目主要由Docker配置文件（docker-compose.yml, Dockerfile）、Python应用脚本（app.py）和README说明文档组成。经过代码审计，未发现明显的投毒行为。app.py使用的是标准的Flask和Python内置解析库（cgi, email.parser），不包含任何外部混淆指令或恶意的Shell反弹代码。其核心功能是展示漏洞成因，而非在本地执行破坏性操作。引用的Docker镜像源为官方或公认的OWASP/Python镜像，不存在恶意替换的情况。虽然该POC利用了UTF-7编码，但这属于漏洞利用的技术手段，并非针对研究员环境的恶意植入。由于项目代码完全透明且可本地离线运行，投毒风险极低（5%），主要风险仅限于未经授权在生产环境测试可能导致的业务中断。

**项目地址:** [https://github.com/coreruleset/coreruleset/security/advisories/GHSA-36fv-25j3-r2c5](https://github.com/coreruleset/coreruleset/security/advisories/GHSA-36fv-25j3-r2c5)

**漏洞详情:** [https://coreruleset.org/20260106/cve-2026-21876-critical-multipart-charset-bypass-fixed-in-crs-4.22.0-and-3.3.8/](https://coreruleset.org/20260106/cve-2026-21876-critical-multipart-charset-bypass-fixed-in-crs-4.22.0-and-3.3.8/)
