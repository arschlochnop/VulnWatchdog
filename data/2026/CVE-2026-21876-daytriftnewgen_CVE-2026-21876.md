## CVE-2026-21876 - OWASP Core Rule Set (CRS) WAF绕过/跨站脚本(XSS)

**漏洞编号:** CVE-2026-21876

**漏洞类型:** WAF绕过/跨站脚本(XSS)

**影响应用:** OWASP Core Rule Set (CRS)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (预测)

**影响版本:** CRS 4.x < 4.22.0, CRS 3.x < 3.3.8

**利用条件:** 目标系统使用受影响版本的OWASP CRS，且后端解析器支持特定的MIME字符集（如UTF-7）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC展示了一个针对OWASP Core Rule Set (CRS) 的关键绕过漏洞，利用了multipart/form-data请求中Content-Type字段的charset参数。在POC代码中，攻击者构造了一个特殊的POST请求，其payload位于名为'username'的表单字段中。关键点在于该字段声明了'Content-Type: text/plain; charset=utf-7'。由于旧版本的CRS未能对multipart部分中的非标准字符集声明进行有效拦截或重组检查，导致WAF无法识别经过UTF-7编码后的恶意代码（例如+ADw-img+ACA-src+AD0-x+AD4-）。当此请求到达后端服务器（如Flask应用）时，如果后端解析器支持该编码并将其解码回原始HTML标签（<img src=x>），则成功绕过了WAF的XSS防护规则。POC中包含完整的Docker环境配置（docker-compose.yml、Dockerfile、app.py），能够闭环复现从代理拦截到后端解析的全过程。验证步骤如下：1. 使用Docker部署实验环境。2. 发送带有UTF-7编码Payload的multipart请求至8083端口。3. 观察WAF是否拦截。根据POC描述，4.22.0之前的版本无法拦截此类编码混淆，从而证实了漏洞的有效性。该绕过手段属于协议层解析不一致漏洞，极具实战杀伤力。\n\n利用步骤：1. 环境准备：通过docker-compose build和up命令启动包含漏洞版本CRS的Nginx反向代理和后端Flask应用。2. 构造Payload：将攻击载荷（如XSS代码）转换为UTF-7或其他非标准字符集编码。3. 发送请求：使用curl或Burp Suite向目标URL发送multipart/form-data POST请求。4. 配置头部：在表单部分的Content-Type中明确指定charset=utf-7。5. 结果验证：检查后端响应或观察Payload是否在前端执行，若未触发CRS拦截规则（403 Forbidden）且Payload成功执行，则利用成功。\n\n投毒风险分析：该POC来源于合法的安全研究及官方修复通告相关的仓库（引用了Github Security Advisory和coreruleset官方博客），属于高质量的防御性研究资料。代码结构透明，包含标准的Dockerfile和Flask应用程序代码。经过分析，代码库中主要包含环境搭建脚本（yaml/docker）和简单的Python逻辑，未发现任何混淆处理、未授权的外部域名连接、BASE64隐藏命令或系统权限持久化操作。所有的容器配置均指向官方镜像（owasp/modsecurity-crs）或标准Python基础镜像。虽然这是一个针对安全防护系统的绕过PoC，其行为本质上是模拟攻击，但代码本身不具备恶意自我复制或窃取主机敏感信息的能力。风险点仅在于：由于其利用了字符集编码特性，初级分析人员若直接在未授权的生产环境中运行，可能会产生真实的攻击流量。但在研究环境中，其作为威胁情报的参考价值远高于安全风险，投毒风险评级极低。

**项目地址:** [https://github.com/coreruleset/coreruleset](https://github.com/coreruleset/coreruleset)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2026-21876](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2026-21876)
