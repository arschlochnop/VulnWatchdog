## CVE-2026-24061 - GNU InetUtils telnetd 参数注入 (Argument Injection)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 参数注入 (Argument Injection)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 to 2.7 (inclusive)

**利用条件:** 远程攻击，无需认证，通过构造USER环境变量值

**POC 可用性:** 9

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061 是一项针对 GNU InetUtils 套件中 Telnetd 服务的严重远程认证绕过漏洞，CVSS 评分高达 9.8，表明其具有极高的危害性。该漏洞影响 GNU InetUtils 1.9.3 至 2.7（含）版本。Telnetd 是一款监听 TCP 23 端口的远程登录服务守护进程，为客户端提供基于 Telnet 协议的明文终端接入能力。

该漏洞的根本原因在于 Telnetd 在调用底层 /usr/bin/login 程序进行用户认证时，未能充分过滤或验证客户端传入的 USER 环境变量。攻击者可以利用这一参数注入 (Argument Injection) 缺陷，在 USER 环境变量中构造恶意值（例如 '-f root'）。当 Telnetd 将此变量传递给 /usr/bin/login 程序时，login 程序会错误地将 '-f' 解析为自身的一个命令行选项，并将其后的 root 解析为要登录的用户，从而绕过正常的密码验证流程，直接授予攻击者目标系统上的 root 权限。由于 Telnet 协议本身是明文传输，且该漏洞无需任何凭证即可利用，攻击者可以通过网络远程发起攻击，利用复杂度极低。

**POC 有效性分析：**
提供的 POC 代码是一个名为 cve_2026_24061_telnetd.py 的 Python 脚本，其描述明确指出旨在“理解并测试一个关键漏洞”以及“利用 GNU inetutils-telnetd 认证绕过漏洞 (CVE-2026-24061) 来演示无需凭证的远程登录”。脚本的使用说明清晰，包括 Python 版本要求（3.x）、下载安装步骤以及详细的命令行参数。这表明该 POC 是一个功能完整且易于操作的工具，能够有效地模拟攻击者的行为，通过构造恶意的 USER 环境变量来绕过 Telnetd 服务的认证机制，从而在受影响的系统上实现未经授权的远程登录。鉴于漏洞的性质和 POC 的描述，该脚本预期能够成功复现并验证 CVE-2026-24061 漏洞。其清晰的文档和直接的利用方式，使得安全研究人员可以轻松部署和测试其防御措施。

**利用步骤：**
1.  **环境准备**：确保攻击者机器上已安装 Python 3.x 或更高版本。
2.  **获取 POC**：访问 POC 项目的 GitHub 仓库（https://github.com/Good123321-bot/CVE-2026-24061-POC），下载最新的 cve_2026_24061_telnetd.py 脚本文件。通常，可以直接从 Releases 页面下载打包好的版本。
3.  **导航至脚本目录**：打开命令行终端（Windows 用户使用 cmd，Linux/macOS 用户使用 Terminal），使用 cd 命令切换到 cve_2026_24061_telnetd.py 文件所在的目录。
4.  **执行 POC**：在命令行中运行以下命令来执行脚本：
    ```bash
    python cve_2026_24061_telnetd.py <目标IP地址> [端口] [用户名]
    ```
    -   `<目标IP地址>`：必填，指定存在漏洞的 Telnetd 服务的目标服务器 IP 地址。
    -   `[端口]`：可选，Telnetd 服务的监听端口，默认为 23。
    -   `[用户名]`：可选，要尝试登录的用户名，例如 root。
    脚本将尝试与目标 Telnetd 服务建立连接，并在连接过程中注入精心构造的 USER 环境变量（例如 -f root），以欺骗 /usr/bin/login 程序绕过认证。
5.  **验证结果**：如果目标系统存在漏洞，攻击者将直接获得目标系统的 shell 访问权限，通常是 root 权限，无需提供任何密码。

**投毒风险分析：**
对于 CVE-2026-24061 的 POC 代码，投毒风险被评估为低（约 5%）。此评估基于以下几个关键因素：
1.  **代码透明度**：POC 以 Python 脚本形式提供，Python 代码的开放性和可读性使其相对容易进行安全审计和审查。防御性安全研究人员可以逐行检查代码，以识别任何潜在的恶意行为或隐藏功能。
2.  **明确的用途**：POC 的标题和描述都非常清晰地阐明了其作为漏洞演示和测试工具的合法目的，没有模糊或误导性的信息。其核心功能是利用特定的漏洞机制，而非执行其他无关的恶意操作。
3.  **缺乏恶意迹象**：在提供的 POC 信息中，没有发现任何常见的投毒迹象，例如代码混淆、非标准库的异常调用、连接到未知外部服务器、下载额外的二进制文件、或者尝试修改本地系统配置（除了演示漏洞本身）。脚本的核心逻辑预期将围绕 Telnet 协议交互和环境变量注入展开。
4.  **合法安全研究背景**：此 POC 是在 CVE 披露后由安全社区公开，通常这类 POC 是为了帮助企业和研究人员理解漏洞原理、验证漏洞存在并开发补丁或防御措施。在合法防御性安全研究工作中，POC 的主要目标是复现漏洞，而不是成为新的攻击载荷。
5.  **“后门代码”与“投毒代码”的区别**：此 POC 的作用是利用目标系统上 Telnetd 服务中的“后门”（即漏洞本身），从而获得 root 权限。这与 POC 代码自身包含额外恶意功能（如在运行 POC 的机器上安装后门、窃取信息等）的“投毒”行为有着本质区别。本评估仅针对 POC 代码本身是否具备额外的恶意意图。

综上所述，虽然运行任何来自第三方来源的代码都存在一定风险，但此 POC 的透明性、明确的目的以及缺乏可疑特征，使其投毒风险被认为较低。建议在隔离环境中运行任何 POC，并在执行前仔细审查代码。

**项目地址:** https://github.com/Good123321-bot/CVE-2026-24061-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
