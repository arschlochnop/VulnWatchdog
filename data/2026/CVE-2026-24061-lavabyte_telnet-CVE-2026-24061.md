## CVE-2026-24061 - GNU InetUtils Telnetd 认证绕过, 权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过, 权限提升

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 至 2.7 版本（含）

**利用条件:** 无需认证, 远程可访问Telnetd服务 (TCP 23)

**POC 可用性:** 8

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个影响GNU InetUtils Telnetd服务的严重远程认证绕过漏洞，CVSS评分为9.8。该漏洞允许未经认证的远程攻击者直接获取受影响系统的root权限。漏洞的根本原因在于Telnetd服务在调用 `/usr/bin/login` 程序进行用户认证时，未能对客户端通过Telnet协议 `NEW_ENVIRON` 选项传入的 `USER` 环境变量进行充分的校验和过滤。攻击者可以利用这一缺陷，在 `USER` 环境变量中注入特定的参数，例如 "-f root"，以欺骗 `login` 程序，使其在没有用户凭证的情况下授予攻击者一个root shell。

这个漏洞的特殊之处在于其利用逻辑依赖于两个关键系统组件（Telnetd和login）的“设计结合”缺陷，使得该漏洞能够长期潜伏而未被发现。Telnet作为一种遗留协议，在现代系统中通常被SSH等更安全的协议取代，导致其长期处于低关注度、低维护状态，这也是漏洞持续11年未被发现的原因之一。

**POC有效性分析:**
提供的POC代码 `telnet_rce.py` 来自SafeBreach-Labs的GitHub仓库，是一个针对CVE-2026-24061的Python实现。该POC旨在演示和实现远程代码执行，具体而言是获取目标系统的root shell。基于搜索结果中对漏洞原理的详细描述——通过操作Telnet的 `NEW_ENVIRON` 选项来传递恶意 `USER` 环境变量给 `login` 程序——Python作为一种高级脚本语言，完全有能力模拟Telnet协议的客户端行为，包括协商选项和发送自定义环境变量。因此，该POC在技术上是完全可行的，能够复现漏洞并实现认证绕过和权限提升。POC文件命名为 `telnet_rce.py` 进一步表明其目标是实现远程代码执行，与漏洞的严重性相符。虽然README中提到需要“理解代码”以及“构建一个没有 `input()` 的可运行代码”，这意味着原始脚本可能包含交互式输入或需要微调才能在特定自动化环境中无缝运行，但它无疑提供了完整的概念验证和实现漏洞利用的核心逻辑。SafeBreach-Labs作为专业的安全研究机构，其发布的POC通常具备较高的质量和可靠性，能够有效验证漏洞的存在和可利用性。

**利用步骤:**
1.  **确定目标**: 识别运行受影响GNU InetUtils Telnetd服务（通常监听TCP 23端口）的系统。
2.  **建立连接**: 使用定制的Telnet客户端连接到目标服务器的23端口。
3.  **协商选项**: 在Telnet协议的初始协商阶段，客户端需要与服务器协商 `NEW_ENVIRON` 选项。客户端会发送 `DO NEW_ENVIRON` 请求，服务器会回复 `WILL NEW_ENVIRON` 或 `WONT NEW_ENVIRON`。成功协商是利用的前提。
4.  **注入环境变量**: 一旦 `NEW_ENVIRON` 选项协商成功，攻击者通过该选项发送自定义的 `USER` 环境变量。关键在于将 `USER` 的值设置为 `-f root`。例如，可以构造类似 `VAR=USER VAL=-f root` 的数据包。
5.  **Telnetd调用Login**: Telnetd服务在接收到 `USER` 变量后，会在内部调用 `/usr/bin/login` 程序进行认证。由于Telnetd未能正确过滤 `USER` 变量，它会将 `USER=-f root` 作为一个参数传递给 `login`。
6.  **Login程序被欺骗**: `/usr/bin/login` 程序通常接收 `-f user` 参数来强制用户以指定身份登录，并且不进行密码验证（假设已经通过其他方式认证）。当 `login` 收到 `-f root` 时，它会误以为被Telnetd以特权方式调用，直接授予攻击者root用户权限的shell，而无需任何凭证。
7.  **获取Root Shell**: 攻击者成功绕过认证，获得目标系统的root权限shell。

**投毒风险分析:**
该POC代码来源于GitHub上的SafeBreach-Labs，这是一个知名的网络安全研究机构。从来源的可靠性来看，其发布的POC通常用于合法的安全研究、漏洞验证和防御目的，而不是散布恶意软件。因此，该POC代码本身包含恶意“投毒”的可能性极低。项目README中提到的“理解代码”和“构建一个没有 `input()` 的代码”等提示，更多是关于优化和定制化利用脚本的建议，使其更适合自动化或特定环境，而非暗示代码中存在需要清理的恶意逻辑。通常，这类建议旨在提升脚本的健壮性、自动化能力和兼容性，例如避免在自动化环境中进行交互式输入，或者不依赖 `os.system()` 等可能导致跨平台兼容性问题的命令。代码本身是Python脚本，结构清晰，可读性高，易于审计，没有明显的混淆或加密迹象。尽管如此，作为最佳安全实践，任何从第三方获取的代码，包括来自知名安全研究机构的POC，都应在隔离环境中进行审查和测试，尤其是在生产环境中使用之前。检查代码中是否存在可疑的网络请求、系统调用、编码混淆或与已知恶意软件模式相似的行为是必要的安全措施。然而，就CVE-2026-24061的这个特定POC而言，其直接的投毒风险被评估为非常低，约为5%。主要风险来自于使用者可能未经验证地执行任何第三方代码的固有风险，而非POC本身携带恶意载荷的风险。

**项目地址:** https://github.com/SafeBreach-Labs/CVE-2026-24061

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
