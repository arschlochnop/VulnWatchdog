## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 提权

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 提权

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程, 零认证, 需要通过环境变量USER注入特定参数

**POC 可用性:** 6/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 70%

## 详情

CVE-2026-24061是一个影响GNU InetUtils套件中telnetd服务的严重远程认证绕过漏洞，CVSS评分为9.8分。该漏洞能让远程攻击者在无需任何凭证的情况下获取目标系统的root权限。其核心成因在于telnetd服务在调用`/usr/bin/login`程序进行用户登录验证时，未能对客户端传入的`USER`环境变量进行有效校验和过滤。攻击者可以通过在`USER`环境变量中注入特定参数（例如`-f root`），欺骗`login`程序，使其在没有正常认证流程的情况下，直接授予攻击者root权限的shell。这个漏洞的利用逻辑依赖于Telnet协议的遗留特性、`login`程序的参数设计以及开源代码中长期未被发现的安全校验缺失，使其能够潜伏长达11年。该漏洞影响GNU InetUtils从1.9.3版本到2.7版本（含）的所有版本。由于Telnetd是GNU InetUtils套件中的远程登录服务守护进程，通常监听TCP 23端口，因此受影响的范围可能非常广泛。利用此漏洞，攻击者可以完全控制受影响的系统，执行任意命令，安装恶意软件，或进一步渗透内部网络。

**POC有效性分析:**
本POC提供了一个基于Docker的易于部署的漏洞环境(`Dockerfile.vulnerable`)，该Dockerfile详细展示了如何配置一个运行`inetutils-telnetd`的Ubuntu 20.04系统。它通过`xinetd`守护进程启动telnetd服务，并将其配置为以root用户运行，同时添加了必要的`securetty`条目以允许telnetd访问。这为验证漏洞提供了一个真实且可控的测试平台。尽管实际的攻击脚本`cve_2026_24061_telnetd.py`未直接包含在输入数据中，但`README.md`文件提供了清晰的用法说明和攻击示例，如`echo "id; whoami" | python cve_2026_24061_telnetd.py 192.168.1.1`。这个示例表明，利用该漏洞可以直接注入并执行任意系统命令，并获取命令的输出，这与漏洞描述中提及的获取root权限shell的能力完全一致。因此，该POC尽管缺少完整的利用代码，但其提供的环境配置和利用指导，使得该漏洞的验证具有高度的有效性和可操作性。攻击者只需按照说明获取并运行相应的Python脚本，即可成功绕过认证并获取root权限。

**利用步骤:**
1.  **识别目标：** 扫描网络，寻找运行GNU InetUtils telnetd服务（通常在TCP 23端口）且版本处于1.9.3到2.7之间的目标系统。
2.  **获取POC：** 访问`README.md`中提供的GitHub Releases页面（`https://github.com/Good123321-bot/CVE-2026-24061-POC/releases`），下载`cve_2026_24061_telnetd.py`或其他适用于目标操作系统的漏洞利用程序。
3.  **准备环境：** 确保攻击机上安装了Python 3.6或更高版本，并且具备网络连接到目标系统。
4.  **执行攻击：** 使用下载的Python脚本，针对目标IP地址发起攻击。攻击者可以向脚本传递希望执行的命令，例如：`echo "id; whoami; cat /etc/shadow" | python cve_2026_24061_telnetd.py <目标IP地址>`。此命令将通过注入`-f root`等参数到`USER`环境变量，欺骗目标`login`程序，使其在未经验证的情况下执行`id`、`whoami`和`cat /etc/shadow`命令，并将结果返回给攻击者。
5.  **获取Root权限：** 成功执行后，攻击者将获得目标系统的root权限，可以执行任何命令，进一步控制系统。

**投毒风险分析:**
在分析CVE-2026-24061的POC投毒风险时，需要区分已提供的代码（`Dockerfile.vulnerable`和`README.md`）和`README.md`中引用的外部资源。**已提供的`Dockerfile.vulnerable`和`README.md`本身是干净的**，没有检测到代码混淆、恶意行为或直接的外部脚本加载。`Dockerfile`用于构建一个标准且易受攻击的Telnetd环境，而`README.md`则提供了漏洞概览、受影响版本、系统要求、使用说明和测试环境设置，这些内容都是防御性安全研究中常见的、无害的文档信息。

然而，**主要的投毒风险点在于`README.md`中明确指示用户从GitHub Releases页面（`https://github.com/Good123321-bot/CVE-2026-24061-POC/releases`）下载实际的漏洞利用程序（例如`cve_2026_24061_telnetd.py`）。** 这种从第三方GitHub Releases下载可执行文件或脚本的行为，具有显著的潜在风险。GitHub Releases可以被任何人上传任意文件，攻击者可以利用这种机制，在看似合法的POC工具中嵌入恶意代码。这些恶意代码可能包括但不限于：后门程序、勒索软件、加密货币挖矿程序、信息窃取器或系统破坏工具。

用户在下载并执行这些外部来源的文件时，面临以下风险：
1.  **恶意Payload植入：** 下载的利用程序可能被篡改，除了实现漏洞利用功能外，还捆绑了额外的恶意Payload，从而在攻击者的系统或测试环境中执行未经授权的操作。
2.  **供应链攻击：** 即使最初的POC是无害的，项目维护者账户被攻陷后，攻击者也可能上传恶意版本。
3.  **缺乏代码审查：** 对于下载的Python脚本，用户可能无法或不会进行详细的代码审查，从而无法发现隐藏的恶意逻辑。

鉴于`README.md`直接引导用户下载一个外部的、未经审计的可执行/脚本文件，这构成了高风险的投毒行为。虽然POC本身的意图是合法的漏洞测试，但其获取和使用方式为恶意软件分发提供了渠道。因此，**投毒风险评估为70%**。强烈建议用户在获取并执行此类外部脚本时，务必在隔离的虚拟机或沙箱环境中进行，并对下载的文件进行病毒扫描和代码审计，以最大程度地降低潜在风险。

**项目地址:** https://github.com/Good123321-bot/CVE-2026-24061-POC/releases

**漏洞详情:** 
