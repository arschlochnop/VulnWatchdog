## CVE-2026-24061 - GNU Inetutils telnetd 认证绕过, 提权

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过, 提权

**影响应用:** GNU Inetutils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8 (Crítico)

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 远程、无需认证、网络可达

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2026-24061是GNU Inetutils telnetd服务中存在的严重远程认证绕过漏洞，已潜伏超过11年。该漏洞源于telnetd在调用/usr/bin/login进行用户登录时，未能对客户端传入的USER环境变量进行充分过滤和验证。当攻击者通过Telnet协议的NEW_ENVIRON选项发送包含恶意值（如“-f root”）的USER环境变量时，telnetd会将其直接传递给login命令，导致login命令以“-f root”参数执行，从而强制以root用户身份登录而无需密码，最终使得远程攻击者能够无需认证直接获取目标系统的root权限。

本分析中提供的POC是一个功能完备的Python扫描器，旨在高效准确地检测并验证CVE-2026-24061。其有效性体现在以下几点：
1.  **全面性**: 支持多种目标输入格式，包括单个IP、CIDR网络段以及包含目标列表的文本文件，极大地提高了目标覆盖能力。
2.  **动态Payload生成**: 能够生成并尝试多种恶意USER环境变量payload（如“-f root”、“-f admin”以及带有“--”、“-p”等变种），覆盖了潜在的利用方式，增强了检测的鲁棒性。
3.  **真实性验证**: POC不仅尝试绕过认证，还包含通过执行“id”和“whoami”命令来实际验证是否成功获取了root权限的功能，确保了检测结果的准确性。
4.  **高可用性**: 具备并行执行能力（通过“-w”参数调整线程数），有效提升了扫描速度。同时，还处理了Telnet banner的捕获、SSH端口23的冲突检测，并提供彩色输出和JSON格式的结果保存，方便用户使用和分析。
5.  **实时威胁印证**: POC的README明确指出，此漏洞在2026年1月已进入CISA KEV（已知被利用漏洞目录），且GreyNoise持续检测到每日的野外利用尝试。这强烈印证了该POC在实际攻击面中的高度有效性和现实威胁。

综合来看，该POC是一个高质量、功能强大且高度可用的漏洞检测和验证工具，能够精准复现和验证CVE-2026-24061，对于防守方进行资产排查具有重要价值。

此漏洞的利用步骤相对直接，利用复杂度极低，可自动化完成：
1.  **目标识别**: 攻击者首先识别运行GNU Inetutils telnetd服务（版本1.9.3至2.7）的远程主机，通常监听TCP端口23。
2.  **连接建立**: 攻击者使用定制的Telnet客户端连接到目标服务器的Telnet服务。
3.  **环境变量注入**: 在Telnet协议的初始协商阶段，特别是当客户端发出NEW_ENVIRON选项请求时，攻击者会发送一个包含恶意值的USER环境变量，例如“USER=-f root”或“USER=-f admin”。
4.  **后端登录调用**: telnetd服务在接收到此环境变量后，在调用/usr/bin/login程序进行用户认证时，未能正确地对USER环境变量进行安全过滤或沙箱化处理。它将恶意构造的USER值直接作为命令行参数传递给login程序。
5.  **权限绕过**: login程序接收到“-f root”参数后，会将其解释为“强制以root用户身份登录，跳过密码验证”，从而导致攻击者无需提供密码即可成功以root权限登录目标系统。
6.  **获取Root Shell**: 认证成功后，攻击者立即获得目标服务器的root权限shell，从而能够执行任意系统命令，完全控制受影响的系统。
POC工具通过模拟上述Telnet协商和环境变量注入过程，自动化地对指定目标进行扫描和利用尝试，并在成功获取root权限后，通过执行“id”和“whoami”命令来验证利用结果，从而报告目标是否脆弱。

根据提供的POC README.md内容进行评估，此POC本身被判定为具有极低的投毒风险（0%）。分析依据如下：
1.  **明确的声明**: README.md文件在开篇就以醒目的“AVISO LEGAL MUITO IMPORTANTE”（非常重要的法律警告）明确指出，该工具“exclusively for educational purposes, security research, vulnerability analysis and authorized testing”（仅限于教育目的、安全研究、漏洞分析和授权测试）。这表明了作者透明的意图，旨在帮助社区理解和防御漏洞，而非进行恶意活动。
2.  **法律免责**: README.md详细列举了在巴西进行未经授权使用的法律后果（如刑法第154-A条和第14.155/2021号法律），并强调作者不承担任何滥用、损害或非法利用的责任。这种强烈的法律警告进一步证明了其防御性研究的定位。
3.  **功能描述**: POC的功能描述集中于漏洞检测、验证和信息收集（如banner抓取），没有提及任何与后门植入、数据窃取、C2通信或持久化相关的可疑行为。其核心功能是发送特定Telnet选项来触发漏洞并验证root权限。
4.  **透明度与致谢**: README.md明确感谢了“Hakai Security”团队提供的技术分析和概念验证，这种开放和透明的引用来源方式，也增强了工具的公信力。
综上所述，该POC的发布意图明确，即用于合法的防御性安全研究和测试。它没有表现出任何恶意投毒的特征，其本身不包含后门或恶意负载。潜在的风险在于该工具可能被不法分子滥用于攻击，但这属于滥用风险，而非POC本身携带恶意代码的投毒风险。

**项目地址:** Not provided

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
