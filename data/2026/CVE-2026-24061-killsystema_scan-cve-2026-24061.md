## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 关键

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 无需认证, 需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是GNU InetUtils telnetd中一个极为严重的远程认证绕过漏洞，影响1.9.3到2.7版本（含）的所有GNU InetUtils telnetd服务。该漏洞的CVSS评分高达9.8，允许远程未经身份验证的攻击者绕过登录机制，直接获得目标系统的root权限。漏洞的根本原因在于telnetd服务在调用`/usr/bin/login`程序进行用户登录时，未能对客户端通过Telnet `NEW_ENVIRON`选项传入的`USER`环境变量进行充分的校验和过滤。攻击者可以通过发送一个精心构造的`USER`环境变量，例如`USER=-f root`，欺骗`login`程序在无需提供凭据的情况下为攻击者授予root shell。这是因为`login`程序的`-f`选项在特定条件下可以绕过密码检查，而telnetd的输入校验缺陷使得攻击者能够注入这一选项。这种利用两个系统组件“设计结合”的逻辑，加上Telnet协议作为遗留协议长期处于低关注度和低维护状态，使得该漏洞得以潜伏长达11年。

**POC有效性分析**
所提供的POC名为“CVE-2026-24061 Scanner”，虽然我们只获得了其`README.md`文件，但其详细描述表明这是一个高度有效且文档完善的工具，专为漏洞研究和授权测试设计。该扫描器支持多种目标输入形式，包括单个IP地址、CIDR范围以及来自文件的目标列表，这对于大规模评估至关重要。一个核心功能是它能够动态生成并测试多种利用载荷，例如`USER=-f root`、`USER=-f admin`以及带有`--`或`-p`等变体的载荷，覆盖了潜在的多种攻击向量。扫描器通过在推测成功登录后执行`id`和`whoami`等命令来验证是否获得了root权限，从而提供漏洞利用成功的具体证据。此外，它还包含检测23端口上SSH服务的实用功能以避免误报，并支持并行执行以提高效率。输出结果采用颜色编码以清晰指示易受攻击的目标，并可保存为JSON格式，便于后续分析。基于`README.md`的描述，该POC似乎是一个成熟的扫描器，能够可靠地识别并演示CVE-2026-24061的root级认证绕过。

**利用步骤**
1.  **目标识别**：攻击者首先识别运行GNU InetUtils telnetd服务并监听TCP 23端口的目标系统。该POC扫描器可辅助完成此步骤。
2.  **建立连接**：攻击者通过Telnet协议向目标系统的23端口发起连接。
3.  **环境变量协商**：在Telnet协议协商过程中，攻击者发送`NEW_ENVIRON`选项。
4.  **载荷注入**：在`NEW_ENVIRON`选项中，攻击者注入一个精心构造的`USER`环境变量。最关键的载荷通常是`USER=-f root`。根据目标配置或特定`login`程序的行为，也可能尝试其他变体，如`USER=-f admin`。
5.  **认证绕过**：易受攻击的telnetd服务接收到这个构造的`USER`变量。由于缺乏足够的输入清理，它将`-f root`（或类似值）直接作为参数传递给`/usr/bin/login`程序。
6.  **获取Root Shell**：`login`程序在接收到`-f root`参数后，会绕过传统的用户密码认证（尤其是针对`root`用户），直接向攻击者授予一个root权限的shell。
7.  **后续利用**：攻击者获得对受损系统的完全root访问权限，可以执行任意命令、安装后门、窃取数据或进一步渗透网络。

**投毒风险分析**
对“CVE-2026-24061 Scanner”的投毒风险评估仅基于提供的`README.md`文件，因为未能获取实际的可执行代码或源代码进行审查。这一限制使得无法进行代码层面的恶意载荷或隐藏功能分析。然而，根据`README.md`中呈现的详细信息，该扫描器本身被“投毒”的风险被评估为较低，约为10%。

风险评估为低的主要原因在于该工具的明确透明度和道德立场。`README.md`中包含一个显著的“⚠️ AVISO LEGAL MUITO IMPORTANTE ⚠️”部分，明确指出该工具“仅用于教育、安全研究、漏洞分析和授权测试目的”。它明确警告任何“未经授权的使用”均属非法，并声明作者对滥用、法律后果或恶意利用不承担任何责任。这种强烈的、公开的免责声明是合法、道德开发的安全工具的典型特征，旨在负责任地披露和用于防御目的，而非用于隐蔽的恶意活动。

此外，`README.md`公开致谢“Hakai Security”团队提供的“卓越技术分析和概念验证”，并提供了其详细文章的直接链接。这种透明地承认和链接漏洞利用向量的基础研究的做法，是信誉良好的安全研究的标志。它允许用户交叉验证扫描器操作的技术基础，从而显著降低该工具秘密偏离恶意意图的可能性。

扫描器所描述的功能也与合法的安全评估工具一致，包括支持多种目标输入（IP、CIDR、文件列表）、动态生成多种利用载荷（如“-f root”、“-f admin”等）、通过执行`id`和`whoami`命令实时验证root权限、检测23端口的SSH服务以避免误报、并行执行能力以及结构化的JSON输出结果。`README`中没有提及任何可疑行为，例如代码混淆、未经授权的外部网络回调、试图安装与telnetd漏洞无关的持久性后门、集成加密货币挖矿脚本或任何形式的勒索软件。该工具的声明目的在于**检测和演示**telnetd认证绕过，而非为实现除验证漏洞之外的邪恶意图而利用系统。

尽管缺乏源代码进行直接审计是一个重大限制，但现有文档强烈表明扫描器本身的投毒风险较低。它似乎是一个用于合法测试中发现和证明已知漏洞的工具，而非传递次级恶意载荷的载体。然而，至关重要的是，任何从非官方来源下载的工具，即使是带有良好`README`的工具，都存在固有的风险。用户应始终保持警惕，从受信任的仓库获取此类工具，并在可能的情况下，在关键环境中执行前进行自身的安全分析（例如沙箱测试、网络流量监控、逆向工程）。10%的风险反映了在没有代码审查情况下的固有不确定性，但被详细`README`中显示出的合法意图强烈抵消。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
