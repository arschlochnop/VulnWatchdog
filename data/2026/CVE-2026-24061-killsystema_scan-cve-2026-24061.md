## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 参数注入

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 参数注入

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程访问, 无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用 (Scanner)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

该漏洞，编号为CVE-2026-24061，是影响GNU InetUtils套件中telnetd服务的一个严重远程认证绕过缺陷。GNU InetUtils telnetd是一个远程登录守护进程，通常在TCP 23端口上提供基于Telnet协议的明文终端接入能力。此漏洞的核心在于telnetd在调用后端`/usr/bin/login`程序进行用户登录处理时，未能对客户端传入的环境变量进行充分的验证和过滤。具体而言，它存在一个严重的参数注入（Argument Injection）缺陷，导致攻击者可以构造恶意的`USER`环境变量值（例如`-f root`）。当telnetd将此值传递给`login`程序时，`-f root`会被错误地解释为`login`程序的有效参数，从而欺骗`login`程序，使其在未经认证的情况下直接授予攻击者root权限。此漏洞影响GNU InetUtils从1.9.3版本到2.7版本（含）的所有版本。它在CVSS评分系统中被评为9.8分（满分10.0分），表明其具有极高的危害性。据报道，该漏洞已潜伏11年，影响范围广阔，波及数千万设备，包括大量物联网设备、老旧路由器、嵌入式系统和工业PLC等。此外，该漏洞已在野外被活跃利用，CISA KEV（已知被利用漏洞目录）自2026年1月起已将其列入，GreyNoise也持续检测到针对该漏洞的日常攻击尝试，证实了其现实世界的威胁程度和易利用性。

所提供的POC是一个名为“CVE-2026-24061 Scanner”的工具的`README.md`文件，详细描述了一个功能全面且高度有效的漏洞扫描与验证工具。该扫描器旨在发现并确认目标系统上是否存在GNU InetUtils telnetd的远程认证绕过漏洞（CVE-2026-24061）。其有效性体现在多个方面：它支持多种灵活的目标输入方式，包括单个IP地址、CIDR范围（如/24、/16）以及包含目标列表的文本文件，这使其适用于从小规模到大规模的网络安全评估。该工具能够动态生成并尝试多种恶意`USER`环境变量payload，包括`-f root`、`-f admin`等常见变体，以及利用`--`或`-p`等参数的更多构造，以最大化利用成功的可能性。此外，用户可以通过`--users`选项自定义用户列表，进行更具针对性的测试。该扫描器的核心有效性在于其具备真实的root权限验证功能，通过在成功登录后执行`id`和`whoami`等命令，确保了所获得的shell确实拥有root权限，从而避免了误报并提供了可靠的验证结果。其他增强功能包括捕获Telnet banner、检测SSH服务在23端口的存在以避免不必要的测试、支持并行执行（可通过`-w`参数调整并发数）以提高效率，以及提供彩色高亮输出和JSON格式的结果保存。这些特性共同构成了一个功能强大、用户友好且经过精心设计的安全工具，能够准确、高效地识别和验证CVE-2026-24061漏洞，对于防御性安全团队及时发现并修复风险资产具有极高的价值。

攻击者利用CVE-2026-24061漏洞的步骤相对简单，通常无需复杂的工具或深入的技术知识即可实施：
1.  **目标识别**：攻击者首先需要通过互联网扫描等方式，发现运行着暴露在公网上的GNU InetUtils telnetd服务的系统。这类服务通常监听TCP 23端口。
2.  **建立连接**：一旦识别出潜在的脆弱目标，攻击者会使用标准的Telnet客户端，与目标服务器的23端口建立连接。
3.  **环境变量注入**：在Telnet会话的协商阶段，如果服务器支持`NEW-ENVIRON`选项，攻击者便可以注入一个特制的`USER`环境变量。最常见的恶意payload是`USER=-f root`。
4.  **参数注入与认证绕过**：服务器上的telnetd进程在接收到这个包含恶意`USER`环境变量的连接请求后，会将其值（例如`-f root`）作为命令行参数直接传递给本地的`/usr/bin/login`程序。由于`login`程序没有对传入的参数进行充分的验证，它会将`-f root`解释为一个合法的“快速登录”指令，并错误地将攻击者视为已经通过认证的root用户。
5.  **获取Root Shell**：最终，`login`程序被欺骗，攻击者无需提供任何密码，即可直接获得目标系统的root权限shell。这意味着攻击者能够完全控制受感染的系统，包括执行任意命令、访问所有文件和安装恶意软件等。整个过程无需任何预认证凭证，且可通过自动化脚本实现，大大降低了攻击门槛。

基于对所提供的POC代码（实际上是该工具的`README.md`文件）的分析，投毒风险被评估为极低，约为5%。该`README.md`文件包含明确而强烈的法律和道德声明，指出该工具“专门用于教育目的、安全研究、漏洞分析和授权测试”，并严厉警告任何未经授权的使用均为犯罪行为，甚至援引了巴西刑法典（Art. 154-A）和国际法条文。作者明确声明不对任何不当使用、造成的损害、IP封锁或法律后果负责。这种透明且负责任的声明是合法安全研究工具的典型特征。此外，`README`文件还公开致谢Hakai Security团队提供了核心技术分析和概念验证，并提供了其研究博客文章的链接，这增加了工具来源的透明度和可信度，允许用户独立验证其技术基础。描述的扫描器功能——如目标枚举、多样化payload生成、真实的root权限验证以及各种性能优化——完全符合合法安全评估工具的范畴。这些功能旨在帮助安全专业人员识别和缓解漏洞，而非传播恶意内容或进行未经授权的攻击。由于我们未收到实际的源代码进行详细的静态或动态分析，因此无法百分之百排除所有潜在风险。然而，仅从`README`文件的专业性、明确的道德指南以及对外部研究的引用来看，没有任何迹象表明这是一个“投毒”工具。它符合防御性安全研究工具的特征，旨在提高系统的安全性，而非构成新的威胁。因此，其投毒风险非常低。

**项目地址:** https://hakaisecurity.io/cve-2026-24061-execucao-remota-de-codigo-no-telnetd-analise-tecnica-e-prova-de-conceito/research-blog/

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
