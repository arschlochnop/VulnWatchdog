## CVE-2026-21858 - n8n 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-21858

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** n8n

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 未披露

**利用条件:** 无需认证, 远程可利用

**POC 可用性:** 9/10

**POC 类型:** 概念验证 (Scanner)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

POC有效性分析: 提供的POC是一个Docker化的Python安全扫描器，名为“Ni8mare Scanner”。其`Dockerfile`详细展示了如何构建一个用于检测CVE-2026-21858的容器镜像。该`Dockerfile`使用Python 3.11-slim作为基础镜像，通过多阶段构建优化了镜像大小，并遵循了良好的安全实践，如创建并使用非root用户`scanner`来运行应用。依赖项通过`pip wheel`预构建并安装，而非直接在运行时下载。`README.md`明确指出这是一个“Ethical Security Scanner”，旨在帮助用户检测n8n实例是否存在CVE-2026-21858漏洞。虽然扫描器的核心逻辑（`scripts/n8n_scanner.py`）未直接提供，但其完善的容器化配置和明确的文档表明这是一个功能完整、设计良好的漏洞检测工具。它作为概念验证，有效地证明了该漏洞的存在性和可检测性，是用于防御性安全研究的高质量POC。

利用步骤: CVE-2026-21858，代号“Ni8mare”，是n8n自动化平台中一个CVSS评分高达10.0的严重远程代码执行（RCE）漏洞。该漏洞是一个无需身份验证即可利用的攻击链。根据威胁情报分析，攻击过程通常始于对n8n表单（Form）节点和Webhook请求处理机制的滥用。攻击者利用`Content-Type`混淆（Content-Type confusion）或不当的路径控制漏洞，通过特定的HTTP请求绕过认证，实现未经授权的任意文件访问。这允许攻击者读取服务器上的敏感文件，例如配置文件、API密钥、会话令牌或内部数据。获取这些敏感信息后，攻击者可以进一步利用这些凭证伪造会话或执行特权操作。结合其他漏洞，例如沙箱绕过技术，攻击者最终能够在n8n实例所在的服务器上执行任意代码，从而获得对服务器的完全控制。由于初始入口点无需认证且可通过公开暴露的Web服务访问，使得该漏洞的攻击复杂度极低，可被广泛且自动化地利用。

投毒风险分析: 提供的POC代码是一个名为“Ni8mare Scanner”的Docker化Python安全扫描器，其明确声明为“Ethical Security Scanner”。通过对其`Dockerfile`和`README.md`的深入分析，可以判断该POC的代码质量高，结构清晰，且完全遵循标准的Python和Docker最佳实践。`Dockerfile`主要负责设置一个干净的Python运行环境，安装必要的依赖，并将扫描器脚本复制到容器中。它特意创建了一个非root用户`scanner`来运行应用程序，这显著降低了潜在的容器逃逸或权限提升风险。整个构建和运行过程透明，没有发现任何可疑的外部请求、加密代码、代码混淆技术或未声明的二进制文件。依赖项通过预构建的whl文件安装，避免了运行时从未知源下载代码的风险。`README.md`和`Dockerfile`中的标签信息都明确强调这是一个用于道德安全研究的漏洞扫描器，旨在帮助用户检测其n8n实例是否存在CVE-2026-21858漏洞。综合来看，该POC没有表现出任何恶意行为的迹象。它的设计宗旨是用于漏洞检测，而非恶意利用或投毒。因此，该POC的投毒风险评定为0%。

**项目地址:** 无

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-21858
