## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 参数注入

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 参数注入

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程, 无需认证, 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析: 提供的Dockerfile和README构成了一个功能完整且文档详尽的CVE-2026-24061漏洞概念验证（POC）。Dockerfile基于Ubuntu 24.04环境，通过明确指令安装了特定版本的inetutils-inetd和inetutils-telnetd（版本2.5），这些版本恰好位于受影响的1.9.3至2.7范围内。其安装方式是拷贝本地预编译的.deb包，确保了漏洞环境的可控性和复现性。Dockerfile还正确配置了inetd.conf文件以启动telnetd服务，并在调试模式下运行inetutils-inetd，便于观察服务日志。README文件则详细指导用户如何使用Docker Compose启动漏洞环境，并提供了关于漏洞原理、工作机制和利用方式的清晰解释。这种结构化的POC设计，使得环境搭建、漏洞复现和验证过程都非常直观和高效，充分证明了其有效性。

利用步骤: CVE-2026-24061的利用核心在于telnetd在调用底层login程序时存在的参数注入缺陷。具体利用步骤如下：
1.  **搭建漏洞环境**: 首先，按照README的指示，在本地下载POC代码仓库，并执行`docker compose up -d --build`命令。这将在Docker环境中启动一个包含易受攻击的GNU InetUtils telnetd服务的容器，通常监听在宿主机的2323端口（具体端口可能根据docker-compose.yml配置而异）。
2.  **连接Telnet服务**: 使用Telnet客户端连接到运行中的漏洞服务。例如，如果服务在本地的2323端口，则执行`telnet 127.0.0.1 2323`。
3.  **执行认证绕过**: 漏洞利用的关键在于构造恶意的`USER`环境变量。当telnetd以`-a`（自动登录）选项启动时，它会从`USER`环境变量中获取用户名，并将其传递给系统底层的`login`程序。攻击者可以注入一个特殊的`USER`值，例如`USER=-f root`。其中的`-f`是`login`程序的一个选项，允许不经密码验证直接以指定用户（此处为`root`）身份登录。由于telnetd在将`USER`变量传递给`login`程序时未进行充分的参数净化，导致`-f root`被`login`程序错误地解析为合法参数，从而绕过认证过程，直接获得目标系统的root权限shell。整个过程无需任何有效凭证，攻击复杂度极低。

投毒风险分析: 对提供的POC代码和相关文件进行分析，投毒风险评估为低（10%）。主要依据如下：
1.  **代码来源与结构清晰**: POC的核心由`Dockerfile`和`README.md`组成。`Dockerfile`清晰地定义了环境构建步骤，包括基于`ubuntu:24.04`镜像，设置`DEBIAN_FRONTEND=noninteractive`环境变量，拷贝本地`.deb`包（`inetutils-inetd_2.5.deb`和`inetutils-telnetd_2.5.deb`）并使用`apt-get install`进行安装。随后，它配置了`/etc/inetd.conf`以使`inetd`守护进程能够启动`telnetd`服务，并进行了常规的包清理。这些指令都是标准且透明的，没有任何代码混淆或隐藏恶意逻辑的迹象。启动命令`CMD ["/usr/sbin/inetutils-inetd", "-d"]`也明确了其调试和监听端口的目的。
2.  **无外部恶意资源引用**: `Dockerfile`中并未包含任何从不可信外部源下载或执行脚本的指令（例如通过`curl | bash`或其他非官方软件源）。它依赖于预先提供的本地`.deb`包进行安装，这要求用户从可信来源获取这些包，本身不包含通过网络引入恶意代码的机制。这大大降低了引入供应链攻击的风险，因为所有的安装内容都已包含在POC自身或其明确指定的本地依赖中。
3.  **行为可预期**: `Dockerfile`和`CMD`指令的唯一目的是构建一个特定版本的`GNU InetUtils telnetd`服务，使其处于已知易受攻击的状态，并使其能够被外部访问以验证漏洞。容器内没有执行任何超出漏洞演示和测试范围的活动，例如连接到C2服务器、执行加密货币挖矿、窃取敏感数据或部署后门等。其行为完全符合安全研究和漏洞复现的目的。
4.  **README说明详尽**: `README.md`提供了详尽的漏洞原理、影响范围、利用方式以及环境搭建步骤。其内容完全专注于安全研究和漏洞复现，没有诱导用户执行危险操作或访问恶意链接的迹象。其中引用的外部链接（如GitHub仓库、Butian论坛）也都是安全社区常用的可信资源，不属于恶意软件分发渠道。
综上所述，该POC代码的透明度高、行为可预期、不引入外部恶意资源，且文档齐全，表明其主要目的是用于漏洞演示和安全研究，因此被评估为低投毒风险。在使用时，用户仍需确保其所依赖的本地`.deb`包来源可靠，以防范可能的供应链攻击。

**项目地址:** https://github.com/yanxinwu946/CVE-2026-24061--telnetd

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
