## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 无需认证，可通过网络远程访问Telnet服务 (TCP 23端口)

**POC 可用性:** 9

**POC 类型:** 概念验证 (包含完整漏洞环境搭建)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是一个存在于GNU InetUtils telnetd服务中的严重认证绕过漏洞。该漏洞允许远程、未经认证的攻击者在无需提供任何凭证的情况下，直接获取目标系统的root权限shell。其核心原理是telnetd在调用系统登录程序(`/usr/bin/login`)进行用户身份验证时，未能对客户端传入的`USER`环境变量进行充分的校验和过滤。当telnetd配置为启用自动登录（`-a`选项）时，它会读取`USER`环境变量作为登录用户名，并直接将其作为参数传递给`/usr/bin/login`。如果攻击者通过Telnet协议的`NEW_ENVIRON`选项发送一个特制的`USER`环境变量，例如包含字符串"-f root"，`login`程序会将其解释为强制以root用户身份登录的指令，从而绕过正常的认证流程，直接授予攻击者root权限。

**POC有效性分析:**
提供的POC包含一个`Dockerfile`和一个`README.md`文件，其目的是为了搭建一个易于复现和测试CVE-2026-24061漏洞的受影响环境。`Dockerfile`的设计清晰且有效，它从Ubuntu 24.04基础镜像开始，通过`apt-get install`命令安装了特定版本的`inetutils-inetd_2.5.deb`和`inetutils-telnetd_2.5.deb`，这些`.deb`包被假定为包含有漏洞的版本，且从本地`./packages`目录拷贝。随后，`Dockerfile`配置了`inetd.conf`文件，使其监听TCP 23端口，并将Telnet服务指向`/usr/sbin/telnetd telnetd`，最后以调试模式启动`inetutils-inetd`。这成功地创建了一个运行着已知易受攻击Telnet服务的Docker容器。`README.md`文件则提供了详细的环境设置步骤（`docker compose up -d --build`）、预期的服务运行截图和端口信息，并深入解释了漏洞原理，包括`telnetd`的`-a`选项和`USER`环境变量的利用方式。尽管POC本身未直接提供客户端利用脚本，但它完整地搭建了可供利用的目标环境，并清晰地阐述了利用机制，这对于安全研究人员进行漏洞复现和分析而言，是极其高效和完整的概念验证手段。

**利用步骤:**
1.  **目标识别:** 攻击者需要识别并定位运行GNU InetUtils telnetd服务（版本范围在1.9.3至2.7之间）且可通过网络（通常是TCP 23端口）访问的目标系统。
2.  **环境搭建 (POC场景):** 若使用提供的POC，首先需要确保本地拥有`inetutils-inetd_2.5.deb`和`inetutils-telnetd_2.5.deb`包，并将它们放置在与`Dockerfile`同级的`packages`目录下。然后，在包含`Dockerfile`的目录下执行`docker compose up -d --build`命令，以启动一个已配置的、易受攻击的Telnet服务容器。服务将在Docker容器内部的23端口监听，并可能通过Docker端口映射到宿主机的特定端口（如README中提到的2323）。
3.  **漏洞利用:** 利用此漏洞的核心在于，在Telnet协议协商阶段，当服务器支持`NEW_ENVIRON`选项（RFC 1408）时，攻击者可向服务器发送一个自定义的`USER`环境变量，其值为特殊的字符串，例如"-f root"。这个值会被`telnetd`作为参数传递给`/usr/bin/login`程序。
4.  **执行攻击:** 使用一个支持Telnet `NEW_ENVIRON`选项注入的客户端（如特制的Python脚本或修改过的Telnet客户端），连接到目标Telnet服务。在协商阶段，发送Telnet `SB` (Subnegotiation) 命令，指明`NEW_ENVIRON`选项，并设置`VAR USER VAL -f root`。例如，通过Python的`telnetlib`库，可以构造相应的序列进行发送。
5.  **验证:** 成功利用后，攻击者无需输入密码即可获得目标系统的root权限shell。可以通过执行`whoami`或`id`等命令来验证当前用户是否为root。

**投毒风险分析:**
根据对提供的`Dockerfile`和`README.md`的分析，该POC的投毒风险评估为低（10%）。
*   **代码透明度:** `Dockerfile`的内容清晰可见，每一步操作都易于理解，主要包括系统更新、从本地文件安装`.deb`包、配置Telnet服务以及清理。没有发现任何代码混淆、加密或难以理解的复杂逻辑。
*   **无外部恶意引用:** `Dockerfile`中没有包含从不明或不可信的外部URL下载或执行脚本的指令。`apt-get update`和`apt-get install`是标准的包管理操作，其软件源通常是操作系统官方的信任源。`COPY ./packages/*.deb /tmp/`指令明确指出`.deb`包来源于本地，这允许用户在构建前对这些软件包进行审计，从而降低了引入恶意二进制文件的风险。
*   **无恶意行为:** 该POC的唯一目的是建立一个运行特定旧版本Telnet服务的环境，以演示已公开的CVE漏洞。它不包含任何后门、远程控制功能、数据窃取、加密货币挖矿或其他任何恶意负载。其行为与声明的目的完全一致。
*   **README文件:** `README.md`文件内容为漏洞的详细介绍、利用方式和环境搭建说明，不包含任何可执行代码或可疑链接，其中引用的GitHub和论坛链接均为常见的安全研究资源，旨在提供背景信息和更多资源。
综合来看，该POC代码是为合法防御性安全研究而设计，旨在复现和理解漏洞，而不是传播恶意软件。因此，其投毒风险极低。

**项目地址:** https://github.com/yanxinwu946/CVE-2026-24061--telnetd

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
