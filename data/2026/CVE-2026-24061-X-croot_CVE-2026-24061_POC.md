## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 参数注入, 远程代码执行

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 参数注入, 远程代码执行

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程访问, 无需认证, 低利用复杂度

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该漏洞编号为CVE-2026-24061，影响GNU InetUtils套件中的telnetd服务，是一个严重的远程认证绕过漏洞，部分情况下可导致远程代码执行（RCE）。其CVSS评分为9.8，攻击复杂度低。漏洞的核心源于telnetd服务在调用后端`/usr/bin/login`程序进行用户认证时，未对客户端传入的`USER`环境变量进行充分过滤和验证。攻击者可以利用这一缺陷，通过构造恶意的`USER`环境变量值（例如`-f root`），向`login`程序注入额外参数，从而欺骗`login`程序，使其无需密码即可认证为`root`用户。一旦成功绕过认证，攻击者即可获得目标系统的shell访问，从而实现远程代码执行。

提供的POC代码包含一个`README.md`文件和一个`script.sh`脚本。`README.md`清晰地说明了漏洞编号、类型（RCE），并提供了详细的脚本参数说明，包括目标IP地址（`-ip`）、Telnet用户名（`-u`，默认为`root`）和端口（`-p`，默认为`23`）。文档中明确指出该PoC旨在证明漏洞存在，并警告仅限合法、道德和负责任的用途，强调禁止用于恶意目的。

`script.sh`脚本是一个基于Bash的自动化利用脚本。脚本首先定义了用于输出美化的颜色变量，并打印一个ASCII艺术字。核心功能包括：`usage()`函数提供脚本的使用说明和参数帮助；通过`while [[ $# -gt 0 ]]`循环解析命令行参数，设置`IP`、`TELNET_USER`、`PORT`等变量。`TELNET_USER`变量默认为`root`，这与漏洞利用的关键点（注入`-f root`以获得root权限）高度相关。尽管`script.sh`的代码部分被截断，但从其参数设计和漏洞描述来看，预期完整的脚本将通过Telnet协议交互，向目标telnetd服务发送一个包含恶意`USER`环境变量的请求。例如，通过在Telnet会话开始时协商`ENVIRON`选项，并将`USER`设置为`-f root`，telnetd便会错误地将此作为参数传递给`/usr/bin/login`，导致`login`程序以为是在以`root`用户身份进行“强制登录”（`man login`中的`-f`选项）。一旦成功绕过认证，攻击者即可获得目标系统的shell访问，从而实现远程代码执行。PoC的结构和描述与此利用方式完全吻合，因此判断其具有较高的有效性。

**利用步骤**:
1.  确保目标系统运行受影响版本的GNU InetUtils telnetd服务（版本范围：1.9.3 <= GNU InetUtils <= 2.7）。
2.  将提供的PoC文件（`README.md`和`script.sh`）下载到本地系统。
3.  赋予`script.sh`执行权限：`chmod +x script.sh`。
4.  运行脚本，指定目标IP地址，可选地指定用户名和端口。
    *   基本用法：`./script.sh -ip <目标IP地址>`
    *   指定非默认用户名（例如，尽管默认root通常最有效）：`./script.sh -ip <目标IP地址> -u admin`
    *   指定非默认端口：`./script.sh -ip <目标IP地址> -p 2323`
5.  脚本执行后，如果漏洞利用成功，攻击者将获得目标系统的`root`权限shell。

**投毒风险分析**:
对提供的PoC代码`script.sh`进行了详细审查，以评估其投毒风险。该脚本是一个纯粹的Bash脚本，主要功能集中在命令行参数解析、变量设置以及为后续的Telnet连接操作准备环境。代码中没有发现任何明显的恶意行为指示器：未发现使用`curl`、`wget`、`fetch`等命令从外部URL下载和执行额外代码的行为；未发现使用`eval`、`base64`解码执行隐藏代码的行为；未发现尝试修改本地系统文件、添加后门用户或建立隐蔽通信通道的行为；脚本的日志输出和错误处理都属于标准的安全实践，没有混淆或可疑的输出模式。所有的参数处理和逻辑都是直接且透明的，用户可以轻松审查其功能。它只是根据用户提供的IP、端口和用户名参数，构建一个Telnet连接命令或协议交互序列，以利用已知的认证绕过漏洞。PoC `README.md`中包含了清晰的法律免责声明，强调其教育目的，并禁止用于恶意用途。这进一步表明其设计意图是用于合法的安全研究和测试。综合来看，该PoC的代码干净，没有发现任何可疑的外部依赖或隐藏的恶意功能。因此，评估其投毒风险为**低**，具体为10%。用户在运行此类PoC时，仍应在其受控的测试环境中进行，并对所有代码保持警惕。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
