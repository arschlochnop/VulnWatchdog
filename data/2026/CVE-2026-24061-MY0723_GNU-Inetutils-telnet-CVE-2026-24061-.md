## CVE-2026-24061 - GNU InetUtils Telnetd 认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 远程, 无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061是一个影响GNU InetUtils Telnetd服务的高度严重认证绕过漏洞，CVSS评分高达9.8。该漏洞允许未经身份验证的远程攻击者通过向目标Telnetd服务注入特定环境变量来获取系统root权限。漏洞的根本原因在于Telnetd服务在调用/usr/bin/login程序进行用户登录时，未能对客户端传入的USER环境变量进行充分的校验和过滤。攻击者可以利用基于RFC 1572标准的Telnet NEW-ENVIRON协议选项，发送包含恶意值（如"-f root"）的自定义USER环境变量。当Telnetd将这个未经验证的USER变量作为参数传递给/usr/bin/login时，login程序会将其解释为命令行的-f root参数。-f参数通常用于跳过密码验证并强制以指定用户身份登录，从而导致系统在没有凭据的情况下直接授予攻击者root权限的shell。此漏洞能够潜伏长达11年，主要原因在于其利用逻辑依赖于Telnetd服务与login程序这两个系统组件的“设计结合”，且Telnet作为一种遗留协议，长期处于低关注度和低维护状态。受影响的版本范围是GNU InetUtils 1.9.3到2.7（含）。

**POC有效性分析:**
所提供的POC是一个名为“CVE-2026-24061 GNU Inetutils Telnetd 认证绕过漏洞检测工具”的Python脚本。该工具功能完善，文档齐全，旨在准确检测目标系统是否存在此漏洞。它支持多线程批量检测、智能漏洞识别、详细输出模式、结果导出以及跨平台运行。工具的核心检测逻辑基于对RFC 1572 Telnet NEW-ENVIRON协议的实现，向目标Telnetd服务发送恶意构造的USER环境变量，并随后解析Telnet响应，查找uid=0和gid=0等关键特征。这些特征是成功获取root权限后在shell中通常会显示的用户和组ID。该工具的检测逻辑被明确分为“确认漏洞”（同时检测到uid=0和gid=0）、“高度可疑”（检测到uid=0和root用户）以及“需确认”（仅检测到uid=0）等多种状态，显示其严谨性。其清晰的参数设置和使用指南进一步验证了其作为有效漏洞检测工具的可用性和可靠性。因此，该POC被认为是一个高质量、功能完整的检测工具，能够有效地验证CVE-2026-24061漏洞的存在性，并间接证明了其利用方法的有效性。

**利用步骤:**
1.  **目标识别**: 攻击者首先通过扫描等方式识别运行GNU InetUtils Telnetd服务的目标系统，通常监听TCP 23端口。
2.  **建立连接**: 攻击者使用Telnet客户端或自定义工具连接到目标系统的Telnet服务。
3.  **协议协商**: 在Telnet协议协商阶段，攻击者发起NEW-ENVIRON (RFC 1572) 选项的协商。
4.  **环境变量注入**: 攻击者通过NEW-ENVIRON选项，将恶意的USER环境变量注入到Telnet会话中，其值为"-f root"。
5.  **命令执行与认证绕过**: Telnetd服务接收到USER环境变量后，在调用/usr/bin/login程序时，未对USER变量进行转义或过滤，直接将其作为参数传递，导致执行/bin/login -f root命令。
6.  **获取Root Shell**: 由于-f参数的作用，login程序跳过常规的密码验证流程，直接以root用户身份启动shell，从而使攻击者无需任何凭据即可获得目标系统的root权限。

**投毒风险分析:**
提供的POC代码是一个专业的漏洞检测工具，旨在帮助用户识别系统中是否存在CVE-2026-24061漏洞。根据其README.md文件内容，该工具的功能、设计理念和实现细节均透明且专注于漏洞检测。代码清晰地描述了其技术原理和检测逻辑，不包含任何代码混淆、可疑的外部依赖（除可选的colorama用于Windows颜色支持外）或未声明的恶意行为。其检测机制是基于对Telnet协议标准和特定环境变量注入的实现，并通过检查uid=0/gid=0等系统响应来判断漏洞是否存在，这是一种标准的漏洞确认方法，而非投毒行为。项目文档中未提及任何下载外部脚本、连接未知C2服务器或进行数据窃取、加密货币挖矿等恶意活动。因此，从现有的信息来看，该POC代码本身不具有投毒性质，其作为防御性安全研究工具的风险评级为低。然而，任何从互联网下载并执行的代码都存在潜在风险，建议使用者在执行前自行审计代码或在隔离环境中运行，以确保安全。

**项目地址:** 

**漏洞详情:** 
