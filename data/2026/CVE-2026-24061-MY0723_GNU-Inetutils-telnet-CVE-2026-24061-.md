## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过, 环境变量注入, 权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过, 环境变量注入, 权限提升

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 至 2.7 (含)

**利用条件:** 远程访问 (Telnetd 监听 TCP 23 端口), 无需认证, 低攻击复杂度

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

此漏洞编号为CVE-2026-24061，影响GNU InetUtils套件中的Telnetd服务，该服务通常监听TCP 23端口，提供基于Telnet协议的明文终端接入。该漏洞的CVSS评分高达9.8，被评定为严重级别。漏洞的根本原因在于Telnetd在调用后端`/usr/bin/login`程序进行用户登录时，未能正确处理客户端通过RFC 1572 NEW-ENVIRON协议传入的`USER`环境变量。攻击者可以构造恶意的`USER`环境变量值（例如`USER=-f root`），利用参数注入缺陷欺骗`/bin/login`程序，使其执行类似于`/bin/login -f root`的命令。其中，`-f`参数允许跳过密码验证，直接登录指定用户，而`root`则指定了目标用户。因此，远程攻击者无需任何凭证即可绕过认证，直接获取目标系统的root权限。

**POC有效性分析：**
提供的POC是一个名为`CVE-2026-24061.py`的Python检测工具，旨在验证目标系统是否存在此认证绕过漏洞。该工具功能完善，具备多线程批量检测、智能漏洞识别（基于`uid=0/gid=0`特征）、详细输出模式和结果导出等特性，并且跨平台支持。它严格遵循RFC 1572 Telnet协议标准，主动向目标Telnetd服务发起连接并尝试注入`USER=-f root`环境变量。之后，工具会解析Telnet会话的响应，检查是否存在`uid=0`和`gid=0`等字符串以确认是否成功获取了root权限。其检测逻辑清晰，通过多重条件判断来区分“确认漏洞”、“高度可疑”和“需确认”等状态，表明其对漏洞的识别准确度高且具有良好的可操作性。该工具不仅验证了认证绕过，还进一步确认了权限提升至root的实际效果，因此被归类为“完整利用”类型的POC，而不是简单的概念验证。其详细的文档和使用说明也大大提升了其实用性和可信度。

**利用步骤：**
攻击者首先通过网络扫描或信息收集，识别出运行GNU InetUtils Telnetd服务且版本在1.9.3至2.7（含）之间的潜在目标。一旦确认目标，攻击者会利用特制的Telnet客户端或脚本连接到目标的TCP 23端口。在Telnet协议协商阶段（特别是利用NEW-ENVIRON扩展），攻击者会发送一个包含恶意`USER`环境变量（值为`-f root`）的请求。Telnetd服务接收到此请求后，由于参数处理不当，会将`-f root`作为参数传递给其调用的`/usr/bin/login`程序。`login`程序会误将`-f root`解析为合法参数，从而跳过正常的密码认证流程，直接授予以`root`身份登录的权限。攻击者随后即可获得目标系统的root shell访问。本POC工具通过模拟这一过程，注入特定环境变量后，分析Telnet会话的响应，例如检查输出中是否存在`uid=0`和`gid=0`等字符串，来判断漏洞是否被成功利用，从而确认目标系统存在认证绕过并可获得root权限。

**投毒风险分析：**
根据提供的POC代码描述（README.md文件）和其功能特性，评估此POC的投毒风险为低，定为10%。该POC被明确描述为一个“检测工具”，其核心目的是帮助用户识别和验证CVE-2026-24061漏洞，而非进行恶意攻击。README文件中详细阐述了漏洞原理、检测机制、系统要求和使用方法，内容透明、清晰。它利用了标准的Telnet协议和RFC 1572规范，通过环境变量注入来触发并验证漏洞。没有迹象表明该工具包含代码混淆、嵌入恶意有效载荷、下载外部可疑脚本、执行非预期的系统命令、或进行未经授权的数据收集或回传。所依赖的Python标准库和可选的`colorama`库（用于Windows颜色支持）均为无害的常用组件。图像链接指向GitHub用户附件，但这些图片内容显示的是工具的运行截图和流程图，未显示恶意代码或链接。尽管如此，作为一项通用安全实践，任何下载自第三方的工具，即使表面无害，也建议在受控环境中运行，并对源代码进行审查，以确保其仅执行预期功能，避免潜在的供应链攻击风险。但就目前所提供的资料而言，该POC的投毒风险极低。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
