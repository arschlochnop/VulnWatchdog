## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 权限提升

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU Inetutils <= 2.7

**利用条件:** 远程利用, 无需认证, 存在Telnet服务并监听23端口, 通过Telnet NEW_ENVIRON选项注入USER环境变量

**POC 可用性:** 9/10

**POC 类型:** 概念验证 (检测工具)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2026-24061是一个影响GNU InetUtils套件中telnetd服务的严重远程认证绕过漏洞。该漏洞的CVSS评分为9.8分（满分10.0分），表明其具有极高的危害性和易利用性。受影响的版本范围是GNU InetUtils 1.9.3至2.7（含）。漏洞的核心在于telnetd在调用/usr/bin/login进行用户登录时，未能正确处理客户端通过Telnet协议的NEW_ENVIRON选项传入的USER环境变量。攻击者可以构造一个特殊的USER环境变量值，例如"-f root"，从而欺骗底层的/usr/bin/login程序，使其在未经验证的情况下直接授予攻击者root权限的shell。此漏洞无需任何用户凭证，攻击者只需通过网络远程连接到目标系统的Telnet服务（通常监听TCP 23端口）即可成功利用。

**POC有效性分析：**
所提供的POC代码是一个Python脚本，名为`inetutils-telnet-cve-2026-24061-check.py`，其作用是针对CVE-2026-24061漏洞进行被动式检测。该工具并非一个攻击性利用程序，而是专门设计用于防御性安全研究、DevOps流水线和基础设施审计。脚本能够：1) 检测系统上是否存在`telnet`程序；2) 识别`telnet`的实现是否为`GNU inetutils`；3) 提取已安装的`telnet`版本号；4) 根据漏洞的受影响版本范围（1.9.3 – 2.7）判断系统是否存在漏洞。它支持生成人类可读和JSON格式的输出，并可配置CI/CD退出码，以便在检测到脆弱版本时自动触发流水线失败。项目文档清晰地声明该工具“不进行利用”、“不进行模糊测试”、“不发送畸形网络流量”、“不与服务交互”，仅执行“只读检测”。作为一个检测漏洞存在性的概念验证工具，它功能完整，代码逻辑清晰，文档详尽，易于使用和集成，能够高效帮助组织评估其系统的脆弱性。因此，该POC在作为防御性检测工具方面，质量评分为9/10。

**利用步骤：**
1.  攻击者通过网络连接到目标服务器开放的Telnet服务端口（默认为TCP/23）。
2.  在Telnet协议的协商阶段，攻击者利用Telnet的NEW_ENVIRON选项，发送一个特制的`USER`环境变量，其值为`"-f root"`。
3.  受影响版本的`GNU InetUtils telnetd`在接收到此环境变量后，会将其不加过滤地传递给底层的`/usr/bin/login`程序。
4.  `/usr/bin/login`程序被`"-f root"`参数欺骗，误认为用户已通过某种特殊机制（如本地控制台或受信任的su操作）认证，从而绕过正常的认证流程。
5.  `/usr/bin/login`程序随后会直接启动一个`root`权限的`shell`，并将其返回给远程攻击者，导致攻击者获得目标系统的最高权限。整个过程无需任何密码或凭证。

**投毒风险分析：**
对提供的Python POC代码进行分析后，评估其投毒风险为0%（极低）。该POC是一个纯粹的防御性检测工具，其设计宗旨和代码实现均明确排除了任何恶意行为。代码逻辑专注于本地系统信息收集，例如通过执行`dpkg -S /usr/sbin/telnetd`或`telnet --version`等命令来查询`telnet`程序及其版本信息。它不包含任何涉及：外部网络请求（除初始化`os`和`sys`等标准库外）、下载外部可执行文件或脚本、代码混淆、使用`eval()`等高风险函数、或任何可能导致系统损害或数据泄露的操作。项目的README文件也清晰地阐明了该工具的“只读检测”性质，并承诺“不进行利用”，“不进行模糊测试”，“不发送畸形网络流量”等。因此，该POC代码是安全、透明的，用于识别漏洞风险，不会在集成或执行过程中引入任何供应链投毒风险。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
