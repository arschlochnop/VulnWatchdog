## CVE-2026-24061 - GNU InetUtils Telnetd 认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过

**影响应用:** GNU InetUtils Telnetd

**危害等级:** 严重高危

**CVSS评分:** 9.8

**影响版本:** 1.9.3 <= GNU InetUtils <= 2.7

**利用条件:** 远程无认证访问，通过Telnet协议发送特定环境变量值

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-24061表示GNU InetUtils Telnetd中存在一个严重的远程认证绕过漏洞，影响1.9.3到2.7（含）的所有版本。该漏洞的CVSS评分高达9.8，凸显了其潜在的毁灭性影响。远程未认证攻击者可以利用此漏洞绕过正常的登录过程，从而在受影响的系统上获得任意代码执行能力，通常是root权限。该漏洞的利用机制在于Telnetd服务与`login`程序之间的交互。具体来说，在Telnet协议协商期间，当Telnetd服务器支持`NEW_ENVIRON`选项时，攻击者可以构造并发送一个恶意的`USER`环境变量。通过在该变量中嵌入特定参数（例如“-f root”），攻击者可以欺骗`login`程序，使其误认为是一个合法的特权用户（如root）正在尝试登录，从而无需任何预先的认证凭据即可获得shell。该漏洞的长期潜伏（据报道长达11年）归因于Telnet作为遗留协议长期处于低关注度和低维护状态，以及两个看似不相关的系统组件之间的微妙结合。该漏洞的“零认证”和“远程提权”特性使其对任何运行受影响版本GNU InetUtils Telnetd的系统都构成极高的威胁。

所提供的“POC代码”实际上是一个名为`inetutils-telnet-cve-2026-24061-check.py`的强大检测工具。其附带的`README.md`明确阐明了其目的：“一个安全、被动的检测工具，用于识别CVE-2026-24061的潜在暴露。”关键在于，它声明“不利用漏洞”，只执行“只读检测”，不进行模糊测试或发送畸形网络流量。该工具的功能包括几个关键步骤：首先检测`telnet`工具的存在，识别它是否为GNU inetutils实现，然后提取安装的版本号。最后，它将此版本与已知的易受攻击范围（1.9.3至2.7）进行比较，以确定系统的漏洞状态。该工具专为防御性安全环境中的实际使用而设计，提供人类可读和JSON输出选项，并支持无缝集成到CI/CD管道中。它使用非零退出代码来指示漏洞检测，从而能够在构建或部署过程中自动失败。虽然它没有演示漏洞本身的利用机制，但它为安全团队和DevOps专业人员提供了一种高效、可靠且用户友好的方法，以在其基础设施中识别和评估其对CVE-2026-24061的暴露程度。因此，作为一种检测机制，其质量极佳，通过清晰的文档和实用性充分实现了其既定目标。

**利用步骤（基于公开信息，非提供的POC）：**
利用CVE-2026-24061相对简单，因为它攻击复杂度低且无需认证。一般步骤如下：
1.  **目标识别：** 攻击者首先识别运行GNU InetUtils Telnetd服务且可远程访问的目标系统。网络扫描工具可用于发现开放的Telnet端口（通常为23）。
2.  **版本检查（可选但推荐）：** 虽然并非严格要求，但检查Telnetd版本（如果可能，例如通过banner抓取或其他侦察）可确认目标位于易受攻击范围1.9.3至2.7内。防御者可使用提供的检测工具进行此目的。
3.  **建立连接：** 攻击者向目标系统上的脆弱服务发起标准Telnet连接。
4.  **环境变量操纵：** 在Telnet协议的协商阶段，特别是当Telnetd服务器指示支持`NEW_ENVIRON`选项时，攻击者发送一个精心构造的`USER`环境变量。
5.  **有效载荷递送：** `USER`环境变量的值被仔细构造，以包含底层`login`程序会误解的参数。公开讨论中常见的载荷是“-f root”，它可以欺骗`login`程序将连接视为root用户的尝试，从而绕过凭据检查。
6.  **获取Root Shell：** `login`程序成功处理恶意`USER`环境变量后，攻击者无需提供任何有效凭据即可在目标系统上获得具有root权限的shell，从而完全控制被攻陷的机器。

**投毒风险分析：**
所提供的“POC代码”（`inetutils-telnet-cve-2026-24061-check.py`）的`README.md`明确说明了其作为“安全、被动检测工具”的功能。它强烈声明其非恶意性质：“无利用”、“无模糊测试”、“无畸形网络流量”和“无服务交互”。它旨在“仅进行只读检测”，专注于识别`telnet`实现和版本。基于此明确描述，即关于代码行为的主要信息来源，该特定工具被“投毒”（例如，后门、恶意软件、加密货币挖矿程序）或从事混淆的有害活动的风险被认为是极低的，估计为5%。该工具的既定目的符合防御性安全实践，并且在提供的文本中没有迹象表明存在外部脚本包含、可疑网络请求或对不可信输入使用`eval`等函数，这些都是常见的投毒危险信号。然而，作为通用的安全最佳实践，任何外部代码，即使是出于防御目的，也应在部署或执行前由组织的安全团队独立审查。此低风险评估的前提是实际的Python代码忠实地遵循其`README.md`中所述的行为。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
