## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 权限提升

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 权限提升

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 到 2.7 (含)

**利用条件:** 远程无认证访问，目标系统运行受影响的Telnetd服务，且相关login程序未正确处理环境变量

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2026-24061 是一个影响 GNU InetUtils telnetd 服务的高度严重漏洞，CVSS 评分为 9.8 分。该漏洞允许远程、未经认证的攻击者绕过 Telnetd 服务的登录机制，直接获取目标系统的 root 权限。此漏洞在公开披露前已潜伏长达11年，其利用逻辑依赖于Telnet协议、`login`程序的参数处理以及GNU InetUtils telnetd对客户端传入环境变量的安全校验缺失。特别是在处理 Telnet `NEW_ENVIRON` 选项时，`telnetd` 未能正确过滤或校验客户端发送的 `USER` 环境变量，导致其可被注入恶意参数，最终传递给底层的 `login` 程序，从而实现认证绕过。受影响的版本范围是 GNU InetUtils 的 1.9.3 到 2.7 版本（含）。

**POC有效性分析**

提供的POC代码是一个名为 `inetutils-telnet-cve-2026-24061-check.py` 的 Python 脚本，它并非一个攻击性利用工具，而是一个专门用于检测系统是否存在 CVE-2026-24061 漏洞潜在暴露的防御性安全工具。该工具的设计理念是安全、被动，旨在不进行任何形式的漏洞利用、模糊测试、恶意网络流量或服务交互，仅通过“只读检测”来评估系统的脆弱性。其核心功能包括：首先，它检测系统上 `telnet` 客户端或服务（通常指 telnetd 守护进程）是否存在；其次，它尝试识别 `telnet` 的具体实现是否为 GNU inetutils 项目提供；然后，精确提取已安装的 `telnet` 版本号；最后，将检测到的版本号与已知的受影响版本范围（1.9.3 – 2.7）进行比对，以确定系统是否易受攻击。该工具输出格式灵活，可生成人类可读的报告或标准JSON格式，后者特别适用于集成到自动化流程中。此外，它还支持 CI/CD 集成，在检测到存在漏洞的版本时，会返回非零退出状态码，允许自动化流水线（如 GitHub Actions）在发现安全风险时自动失败，从而及时发出警报并阻止部署。鉴于其清晰的文档说明、明确的检测逻辑和对安全性的强调，该POC作为防御性检测工具，是完全有效且功能完整的，可用于评估目标系统是否存在此漏洞的风险。

**利用步骤**

攻击者利用 CVE-2026-24061 漏洞的典型步骤如下：

1.  **建立连接**：攻击者首先通过 Telnet 客户端连接到目标服务器的 Telnet 服务（默认监听 TCP 23 端口）。
2.  **协商环境变量**：在 Telnet 协议的初始协商阶段，攻击者会发送 `NEW_ENVIRON` 选项，表明客户端希望在登录过程中传递环境变量。
3.  **构造恶意USER变量**：攻击者构造一个恶意的 `USER` 环境变量。通常，该变量会被设置为类似 `"-f root"` 的字符串。这里的 `-f` 是 `login` 命令的一个参数，它通常用于绕过密码验证直接登录指定用户（`login -f username`）。
4.  **Telnetd处理**：GNU InetUtils `telnetd` 服务在接收到客户端发送的 `USER` 环境变量后，由于缺乏充分的输入校验和过滤机制，会直接将其作为参数传递给 `/usr/bin/login` 程序。这是漏洞的核心所在，即未对外部输入进行安全处理。
5.  **`login`程序被欺骗**：`login` 程序收到 `"-f root"` 作为参数时，会将其误解释为 `login -f root`，从而在没有要求密码的情况下，直接为攻击者创建一个 `root` 用户的 shell 会话。
6.  **获得root权限**：攻击者成功绕过认证，获得目标系统上的 `root` 权限 shell，从而完全控制服务器，执行任意命令或进行数据窃取等恶意操作。

**投毒风险分析**

根据提供的 `README.md` 文件内容，该 POC 工具的投毒风险极低，可视为 0%。项目明确声明其核心目的在于“安全、被动地检测”潜在的漏洞暴露，并严格遵循“不进行漏洞利用”、“不进行模糊测试”、“不发送恶意网络流量”、“不与服务交互”的原则。该工具被明确描述为“只读检测”，这意味着它不会修改系统文件、安装后门或执行任何具有破坏性的操作。它专注于分析本地系统上的 `telnet` 程序的版本信息，不涉及任何远程执行、下载外部资源或执行高风险操作。代码旨在为DevOps流程、基础设施审计和防御性安全组合提供支持，其设计意图完全是良性的。因此，用户可以相对放心地运行此检测工具，它不会对系统造成任何恶意影响或引入后门。该工具不包含任何代码混淆、可疑的外部依赖项或可能导致系统被“投毒”的行为。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
