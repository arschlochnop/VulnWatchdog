## CVE-2026-24061 - GNU InetUtils telnetd 身份认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 身份认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 关键级

**CVSS评分:** 9.8

**影响版本:** ≤ 2.7

**利用条件:** 无需认证，Telnet服务在TCP/23端口可达

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5

## 详情

CVE-2026-24061是一个影响GNU InetUtils telnetd服务的关键级远程认证绕过漏洞，CVSS评分高达9.8。该漏洞潜伏了大约11年，允许未经身份验证的远程攻击者绕过telnetd的登录机制，直接获取目标系统的root权限。漏洞的根本原因在于telnetd在调用`/bin/login`进行用户登录时，未对客户端通过Telnet NEW-ENVIRON协商传入的`USER`环境变量进行有效校验与过滤，直接将其作为参数传递，从而导致参数注入，使`/bin/login`在没有密码的情况下授予root权限。

**POC有效性分析:**
提供的PoC（概念验证代码）是一个完整的Python 3利用脚本，利用了标准库`telnetlib`，确保了其功能完整性和高可用性。PoC的说明清晰地指出，利用过程是“瞬间完成”的，无需“暴力破解”或“任何凭据”，这与漏洞的严重性及其“低”攻击复杂度相符。其核心机制是通过Telnet NEW-ENVIRON选项发送`USER=-f root`，这使得易受攻击的telnetd服务执行`/bin/login -f root`命令。`/bin/login`程序的`-f`（force）标志会跳过认证过程，直接为`root`用户提供一个交互式shell。PoC的README文件还提到该漏洞“已在野外被观察到利用”，并且“在默认的Debian/Ubuntu `inetutils-telnetd`安装上有效”，这些信息进一步证实了PoC的实用性和高成功率。预期结果显示能够获取`uid=0(root) gid=0(root)`的输出，明确证明了成功获取了root权限。

**利用步骤:**
利用CVE-2026-24061，通过此PoC获取root权限的步骤如下：
1.  **环境准备:** 攻击者需要一台安装了Python 3的机器。目标系统必须运行易受攻击的`GNU InetUtils telnetd`版本（具体为`≤ 2.7`），并且其Telnet服务（TCP/23端口）必须可从攻击者的机器访问。
2.  **执行PoC:** 攻击者通过命令行简单运行提供的Python脚本`cve-2026-24061.py`，并指定目标IP地址（可选端口，默认为23）：
    ```bash
    python3 cve-2026-24061.py 192.168.1.100
    ```
    或指定主机名和端口：
    ```bash
    python3 cve-2026-24061.py example.com 23
    ```
3.  **漏洞利用:** PoC脚本将与目标Telnet服务建立连接。在Telnet会话协商过程中，它会利用NEW-ENVIRON选项将`USER`环境变量设置为`-f root`。由于易受攻击的`telnetd`守护进程没有对这个变量进行适当的清理，它会将此值直接传递给`/bin/login`程序。这将导致执行`/bin/login -f root`，从而绕过标准的认证机制，直接为攻击者提供一个交互式的root shell。
4.  **获取Root Shell:** 成功利用后，攻击者将获得目标系统上具有root权限的交互式命令行界面。PoC的输出将显示连接成功并进入交互式shell（通常以`#`符号表示），攻击者可在此执行任意root权限命令。

**投毒风险分析:**
根据提供的PoC README和描述，该PoC的投毒风险评估为极低（约为5%）。这一判断基于以下关键因素：
1.  **代码透明度和清晰度:** PoC的README文件详细解释了漏洞的技术原理和利用机制，包括核心的`USER=-f root`注入方式以及`/bin/login -f root`的执行结果。这种高透明度显著降低了代码中隐藏恶意功能的可能性。
2.  **依赖性:** PoC明确指出仅依赖Python 3和标准库`telnetlib`。使用标准内置库大大降低了通过第三方依赖引入恶意代码的风险。除了与目标Telnet服务器的直接通信外，没有迹象表明PoC会进行其他外部网络请求或使用可疑模块。
3.  **功能范围限定:** 该PoC的明确目的是演示和利用CVE-2026-24061漏洞，以获取目标系统的root shell。其行为完全符合这一目标，并且在功能上没有超出漏洞利用的范畴。没有证据表明它会执行额外的恶意活动，例如植入后门、进行加密货币挖矿、数据窃取或发起拒绝服务攻击。其输出结果是获得root shell，这是漏洞利用的直接后果，而非PoC自身携带的恶意负载。
4.  **无混淆:** 提供的描述未暗示代码存在混淆。清晰易懂的代码是缺乏恶意意图的有力指标，因为代码混淆通常用于掩盖恶意行为。
综上所述，尽管在执行任何PoC之前都应进行全面的代码审查，但根据现有信息，此PoC是一个合法且“干净”的工具，专为防御性安全研究和漏洞测试而设计。其低投毒风险得益于其明确的用途、透明的实现方式以及对标准、可验证组件的依赖。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
