## CVE-2026-24061 - GNU InetUtils telnetd 身份认证绕过/参数注入/提权

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 身份认证绕过/参数注入/提权

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils telnetd ≤ 2.7

**利用条件:** 远程无认证网络访问，目标TCP端口23可达

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2026-24061是GNU InetUtils telnetd服务中一个影响深远的远程身份认证绕过漏洞，该漏洞因其能够导致攻击者在目标系统上获得root权限，且拥有长达11年的潜伏期而备受关注。此漏洞的核心在于telnetd服务在调用`/bin/login`程序进行用户登录时，未能对客户端通过Telnet `NEW-ENVIRON`协商机制传入的`USER`环境变量进行充分的校验和过滤。攻击者可以利用这一缺陷，将特制的`USER`环境变量（例如设置为`-f root`）注入到`/bin/login`命令中，从而导致实际执行的命令变为`/bin/login -f root`。`login`程序中的`-f`参数指示其跳过标准的身份验证流程，直接授予一个未经验证的用户会话，结合`root`参数，攻击者便可立即获得目标系统的root权限shell。

**POC有效性分析**
提供的PoC是一个用Python 3编写的脚本（`cve-2026-24061.py`），它展示了如何利用此漏洞获取root权限。该PoC基于Python标准库中的`telnetlib`模块，因此无需安装任何额外的第三方依赖，保证了其易用性和可移植性。PoC的README文档详尽地阐述了漏洞原理、受影响的版本、利用条件、攻击效果以及详细的使用说明，并附带了成功的利用示例和预期结果（获得`uid=0(root) gid=0(root)`的root shell）。

该PoC的利用逻辑与漏洞描述完全一致：它连接到目标主机的23/TCP端口（Telnet默认端口），然后通过Telnet协议的`NEW-ENVIRON`协商过程，向telnetd服务发送一个包含恶意值`USER=-f root`的环境变量。由于telnetd未正确处理此输入，会将`-f root`作为参数传递给`/bin/login`，最终导致`login -f root`被执行，成功绕过认证并获得root权限。文档中明确指出“Exploit is instant”、“No brute force required”、“No credentials required”以及“Observed exploited in the wild”，这些信息强有力地证实了PoC的高效性、无依赖性以及在真实世界中的潜在威胁。该PoC在默认的Debian/Ubuntu `inetutils-telnetd`安装中已被验证有效，是一个功能完整、文档齐全且高度可靠的漏洞利用工具。

**利用步骤**
1.  **环境准备**: 确保攻击机器上已安装Python 3环境。
2.  **获取PoC**: 下载或克隆包含`cve-2026-24061.py`脚本的仓库到本地。
3.  **目标确认**: 识别运行GNU InetUtils telnetd服务（版本≤ 2.7）的目标系统，并确认其TCP 23端口（或其他Telnet服务端口）可通过网络访问。
4.  **执行PoC**: 在终端中导航至PoC脚本所在目录，执行以下命令：`python3 cve-2026-24061.py [目标IP地址]`。例如，`python3 cve-2026-24061.py 192.168.1.100`。如果Telnet服务运行在非标准端口，可以额外指定端口号：`python3 cve-2026-24061.py example.com 2323`。
5.  **获取Shell**: 若目标系统存在漏洞，PoC将立即建立Telnet连接，发送恶意环境变量，并成功获得一个交互式的root权限shell。攻击者可通过输入`id`命令验证当前用户是否为root（预期输出`uid=0(root) gid=0(root)`）。
6.  **后续操作**: 获得root shell后，攻击者可执行任意系统命令，完全控制目标系统，包括但不限于数据窃取、安装持久化后门、修改系统配置或发起进一步攻击。

**投毒风险分析**
对提供的PoC代码进行审查后，未发现任何可疑行为或恶意组件。该Python脚本的结构清晰，逻辑直接，完全遵循了漏洞利用的描述，即通过`telnetlib`模块进行标准的Telnet协议通信，发送特定的环境变量以触发远程认证绕过。代码中没有使用混淆技术，没有包含外部的恶意加载器或下载器，也没有执行任何与漏洞验证无关的系统操作（如启动挖矿程序、进行DDoS攻击等）。

PoC的目的纯粹是演示漏洞的存在及其可利用性，提供一个直接的、可验证的攻击路径。它的设计旨在帮助安全研究人员和防御者理解漏洞机制并进行合规测试。因此，该PoC被判定为“干净”的漏洞验证工具，不包含任何恶意载荷或投毒行为。其投毒风险为**0%**。在实际应用中，组织在使用任何公开的PoC代码进行测试时，仍应遵循最佳实践，在隔离的、受控的环境中进行，以防止意外后果，并对PoC代码的完整性和来源进行必要的验证。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
