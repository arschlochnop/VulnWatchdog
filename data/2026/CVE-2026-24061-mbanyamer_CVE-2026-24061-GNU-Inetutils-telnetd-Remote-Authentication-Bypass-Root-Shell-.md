## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** ≤ 2.7

**利用条件:** 远程无认证，目标监听TCP 23端口，可通过互联网直接利用

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5

## 详情

CVE-2026-24061是GNU InetUtils telnetd服务中的一个关键远程认证绕过漏洞。该漏洞的根本原因在于telnetd在处理Telnet协议的NEW-ENVIRON选项时，未对客户端发送的USER环境变量进行充分的清理和校验。当攻击者构造一个恶意的USER环境变量，例如设置为"-f root"时，telnetd会将此值直接传递给其内部调用的/bin/login程序。根据Unix/Linux系统的惯例，/bin/login命令的-f参数意味着“不进行认证”，允许用户直接登录。因此，通过这种参数注入的方式，攻击者可以在无需任何凭据的情况下，直接获取目标系统上的root权限交互式Shell。

**POC有效性分析**
所提供的POC是一个基于Python 3和其标准库telnetlib的完整利用工具。它精确地模拟了Telnet客户端与服务器的交互过程，并在NEW-ENVIRON协商阶段注入了恶意参数USER=-f root。POC的README文件详细阐述了漏洞的原理、影响、受影响版本和利用方式，与公开的漏洞信息高度一致。该POC的特点是“即时（instant）”利用，无需暴力破解，无需任何凭证，且已在默认的Debian/Ubuntu系统上的inetutils-telnetd安装中被证实有效。其明确的使用说明和预期输出（直接获得root权限的shell，可通过id命令验证uid=0）表明其具有极高的可靠性和易用性。该POC提供了一个直观且功能完整的攻击流程图，清晰地展示了攻击者如何通过telnetd和/bin/login的交互最终获得root shell。

**利用步骤**
1.  **确认目标**：识别运行GNU InetUtils telnetd ≤ 2.7版本且TCP 23端口对外开放的目标系统。
2.  **准备环境**：确保本地攻击机器已安装Python 3，并且telnetlib库可用（通常为Python标准库，无需额外安装）。
3.  **获取POC**：下载并保存POC脚本文件，例如命名为`cve-2026-24061.py`。
4.  **执行攻击**：在命令行终端中，使用Python 3执行POC脚本，并指定目标IP地址，例如：`python3 cve-2026-24061.py <目标IP地址>`。如果目标telnet服务运行在非标准端口，可以额外指定端口号，例如：`python3 cve-2026-24061.py <目标IP地址> 2323`。
5.  **验证结果**：如果目标存在漏洞，POC脚本将迅速建立连接、发送恶意环境参数，并直接返回一个具有root权限的交互式Shell。在Shell中输入`id`命令，如果显示`uid=0(root) gid=0(root)`，则表示利用成功。

**投毒风险分析**
该POC的投毒风险被评估为极低（5%）。主要基于以下几点考量：
*   **代码透明度与清晰度**：POC的README文件提供了极其详细且透明的漏洞原理、技术细节和利用方法描述。虽然没有直接提供Python代码本身，但对其行为的描述非常具体，足以让人理解其工作原理，且不含任何模糊或误导性信息。
*   **无外部依赖**：POC明确指出，除了Python 3及其内置的`telnetlib`库之外，无需任何外部第三方依赖。这显著降低了通过引入恶意库而导致投毒的风险。
*   **功能单一且符合预期**：POC的核心功能是利用特定的Telnet协议弱点，旨在获取目标系统的root权限shell。其预期行为与所描述的漏洞利用过程完全一致，没有迹象表明它会执行额外的、与漏洞利用无关的恶意操作，例如数据窃取、后门植入或系统破坏。
*   **无混淆/加密**：README中没有提及或暗示POC代码使用了任何形式的代码混淆、加密或其他隐藏恶意意图的技术，代码逻辑预计是直接且易于审计的。鉴于其简单性，即使没有直接代码，也可以合理推断其风险极低。
综上所述，该POC似乎是一个设计良好、目的纯粹的漏洞验证和利用工具，符合合法的防御性安全研究范畴。在实际使用前，尽管风险很低，仍建议在受控环境中进行测试，并对代码（如果可获取）进行快速的安全审计，以确保其行为完全符合预期。

**项目地址:** None

**漏洞详情:** https://www.cnvd.org.cn/flaw/show/CNVD-2026-05940
