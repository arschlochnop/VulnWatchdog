## CVE-2026-21858 - n8n 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-21858

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** n8n

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 未知

**利用条件:** 无需认证, 远程访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2026-21858，亦称“Ni8mare”，是n8n自动化工作流平台中一个高危远程代码执行漏洞。该漏洞允许未经认证的远程攻击者完全控制受影响的n8n实例，对系统安全构成严重威胁。

POC有效性分析: 提供的`Dockerfile`和`README.md`构建了一个名为“Ni8mare Scanner”的检测工具，旨在合规地扫描n8n实例以发现此漏洞。尽管提供的代码是扫描器，但搜索结果[7]明确指出在GitHub上存在一个完整的利用工具：`https://github.com/Chocapikk/CVE-2026-21858.git`。该工具的`exploit.py`脚本能够通过发送特定请求，实现任意文件读取（例如`/etc/passwd`），这通常是远程代码执行的直接证据或前置条件。这表明该漏洞存在公开且功能完善的利用代码，POC有效性高，可实际验证漏洞存在。

利用步骤: 攻击者首先通过`git clone https://github.com/Chocapikk/CVE-2026-21858.git`获取利用代码。随后，使用类似`python exploit.py http://<目标地址>:5678 /form/vulnerable-form --read /etc/passwd`的命令即可对目标n8n实例进行攻击，读取敏感文件。这利用过程简单直接，无需认证，表明攻击复杂度极低。

投毒风险分析: 针对本报告提供的`Dockerfile`和`README.md`代码片段，其旨在构建一个合法的漏洞扫描工具。代码结构清晰，使用了多阶段构建、非root用户运行等安全实践。所有依赖项均通过`pip wheel`在本地构建并安装，没有发现从不可信外部源直接执行脚本或存在代码混淆的情况。`README.md`也明确声明其为“Ethical Security Scanner”。因此，运行此特定的扫描器代码本身的投毒风险极低。然而，对于搜索结果中提到的完整利用代码，鉴于其不在分析范围内，建议用户在运行任何第三方POC代码时，务必在隔离环境中进行并仔细审查代码，以防潜在的恶意行为。

**项目地址:** https://github.com/Chocapikk/CVE-2026-21858.git

**漏洞详情:** 未知
