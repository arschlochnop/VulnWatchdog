## CVE-2026-21858 - n8n (工作流自动化平台) RCE (远程代码执行)

**漏洞编号:** CVE-2026-21858

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n (工作流自动化平台)

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 所有早于修复版本的 n8n 实例 (具体见官方公告 GHSA-v4pr-fm98-w9pg)

**利用条件:** 无需身份验证，可直接通过网络访问受影响的 n8n 实例及其 Webhook 端口

**POC 可用性:** 3/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开的漏洞描述和研究报告（代号为 Ni8mare），CVE-2026-21858 是一个存在于 n8n 核心 Webhook 处理机制中的严重漏洞。该漏洞源于系统在处理基于表单的文件上传请求时，未能对 Content-Type 头部进行严格的安全验证。攻击者可以通过发送构造精良的 multipart/form-data 请求，绕过现有的身份验证中间件。通过这种绕过，攻击者能够将恶意脚本文件上传至系统内部目录或通过 Node.js 的执行上下文直接运行任意命令。目前的 POC 文档仅提供了基础的调用逻辑和命令行说明，并未展示完整的 Exploit Payload 细节，但由于其利用点位于通用的 Webhook 触发器中，漏洞的触发路径极其直接且稳定。利用步骤：1. 攻击者首先识别互联网上暴露的自托管 n8n 实例；2. 针对特定的 Webhook 端点（尤其是启用表单功能的端点）构造一个包含恶意 Payload 的 POST 请求；3. 在请求头中操纵 Content-Type 字段以绕过验证逻辑；4. 服务器解析该请求时触发文件操作或代码执行逻辑，从而在主机系统上获得 Shell 权限。由于 n8n 广泛用于处理敏感的自动化任务，一旦被攻破，攻击者将获得对所有连接的服务凭据、数据库连接和内部工作流的完全访问权限。投毒风险分析：针对此类 CVSS 10.0 的高价值漏洞，投毒风险主要集中在虚假的脚本工具和伪造的修复程序中。当前提供的 POC 代码片段虽然目前仅表现为 README 文档，但引用的 python 脚本（CVE-2026-21858.py）在 GitHub 等公开平台上极易被恶意替换。高风险投毒行为通常包括：在利用脚本中嵌入 Base64 编码的混淆反弹 Shell，这些 Shell 在攻击者试图攻击目标时，会优先连接到投毒者的 C2 服务器。此外，由于该漏洞属于近期披露，许多安全研究员会寻找一键式 Exploit，投毒者可能发布伪装成利用工具的 PE 文件或包含后门的 Python 包依赖。目前该 POC 框架结构清晰，引用的链接均指向权威研究机构 Cyera 和 n8n 官方仓库，展现了较高的防御研究参考价值，未发现明显混淆代码，但由于缺乏核心 Python 代码，用户在下载此类工具时应严格审计脚本中的网络请求部分，防止敏感凭据泄露或被反向控制。建议仅参考官方补丁进行修复，避免在生产环境直接运行未经审计的第三方脚本。

**项目地址:** /tmp/vulnwatchdog_f735e937539571747b59c82b34e251a8/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2026-21858](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2026-21858)
