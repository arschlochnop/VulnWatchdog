## CVE-2026-20841 - Microsoft Windows Notepad (新版，通过Microsoft Store分发) 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-20841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Notepad (新版，通过Microsoft Store分发)

**危害等级:** 高危

**CVSS评分:** 8.8

**影响版本:** 新版Windows记事本应用 (Microsoft Store版本), 影响Windows 10/11

**利用条件:** 攻击者需诱导用户打开特制恶意Markdown文件，并点击其中的恶意链接。在某些情况下（如`file:///`协议），可能需要用户二次点击或绕过安全警告。利用此漏洞要求受害者系统安装了相应解释器（如Python/Java）以静默执行特定脚本类型，或在点击后绕过Windows安全警告。需要网络连接以获取远程payload或应用包。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2026-20841是一个影响Microsoft Windows内置记事本应用程序的高危远程代码执行（RCE）漏洞，CVSS评分为8.8分。该漏洞主要影响通过Microsoft Store分发的新版记事本（Windows 10/11）。记事本在处理Markdown内容的可点击链接时，未能充分验证URL协议，导致攻击者能够构造恶意协议链接，诱导用户通过Ctrl+点击触发任意协议处理程序，进而实现远程代码执行。微软已确认此漏洞存在在野利用。

此POC代码质量很高，通过Node.js (`poc.js`) 和 Python (`poc.py`) 脚本生成包含恶意链接的Markdown文件 (`poc.md`)，清晰演示了漏洞利用。POC提供了三种主要攻击向量：1. **远程载荷执行 (`file:///`)**: 利用UNC路径从攻击者服务器获取并执行载荷。2. **应用侧载 (`ms-appinstaller://`)**: 诱导安装恶意`.appx`或`.msix`包。3. **本地二进制执行 (`file://`)**: 启动受害者系统上已存在的任意可执行文件。POC还指出局限性，如特定危险扩展名会触发Windows安全警告，而Python/Java等解释器文件若环境存在可静默执行；漏洞利用通常需要用户主动打开特制Markdown文件并进行Ctrl+点击操作。

**利用步骤：**
1.  **准备**：攻击者设置WebDAV服务器承载恶意载荷（如Python脚本），并使用POC脚本生成特制`poc.md`文件。
2.  **传递**：攻击者通过社会工程学手段（如邮件、IM）将`poc.md`发送给目标用户。
3.  **交互**：受害者在受影响的记事本中打开`poc.md`，记事本渲染出恶意链接。
4.  **触发**：受害者被诱导`Ctrl+Click`恶意链接。
5.  **执行**：记事本调用系统协议处理程序，执行链接目标：
    *   `file:///`链接尝试下载并执行远程载荷（如`payload.py`）。
    *   `ms-appinstaller://`启动App Installer安装恶意应用。
    *   `file://`启动本地可执行文件。
6.  **危害**：载荷执行后，攻击者可在受害者系统上进行任意恶意操作。

**投毒风险分析：**

对CVE-2026-20841的POC代码（包括`poc.js`、`poc.py`、`hello.py`和`hello.vbs`）进行评估，其投毒风险被判定为0%，属于低风险范畴。这里的“投毒风险”特指POC代码本身是否包含恶意、隐藏或未经授权的行为。

`poc.js`和`poc.py`脚本的功能仅限于生成一个本地Markdown文件（`poc.md`），不执行任何外部网络请求（除利用场景中受害者连接攻击者服务器外），不含混淆代码，亦无尝试修改系统配置、安装后门等恶意活动。代码逻辑清晰透明，主要为构造漏洞利用所需的输入文件。

示例载荷`hello.py`和`hello.vbs`也具有明确意图。`hello.py`通过Python的`ctypes`调用Windows API显示一个消息框；`hello.vbs`则使用VBScript的`MsgBox`函数显示类似消息。两者皆为无害的“Hello World”式载荷，旨在验证漏洞利用成功获取代码执行的能力，不具备破坏性。

POC的README文档明确了其非原创发现的性质，并包含免责声明及使用注意事项，如“测试仅限于虚拟机”。这体现了作者负责任的态度，旨在提供研究和防御工具，而非传播恶意软件。

综上所述，该POC代码自身不含恶意载荷、混淆、隐蔽通信或未经授权的系统修改。它是一个纯粹的功能性工具，用于重现和理解CVE-2026-20841漏洞。因此，安全研究人员在遵循隔离环境运行的良好实践下，可安全地分析和运行此POC代码。需明确区分：漏洞本身允许攻击者执行有害操作，但这与POC代码本身的清洁性是两个独立概念。本分析侧重于POC代码自身的风险，而非漏洞利用的潜在威胁。

**项目地址:** 未提供

**漏洞详情:** https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841
