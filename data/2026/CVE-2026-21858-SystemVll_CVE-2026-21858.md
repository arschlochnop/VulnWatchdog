## CVE-2026-21858 - n8n Workflow Automation Platform 远程代码执行 (RCE)

**漏洞编号:** CVE-2026-21858

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** n8n Workflow Automation Platform

**危害等级:** 高危/Critical

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 1.65.0 - 1.120.x

**利用条件:** 无需认证 (Unauthenticated)，通过网络可访问 (Network Access)，无需用户交互 (No User Interaction)

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

POC有效性分析：提供的POC是一个名为“CVE-2026-21858”的“n8n Workflow Automation Platform - Remote Code Execution”安全研究工具的README文档。该文档详细阐述了漏洞摘要、受影响版本、技术分析、利用前提、安装、使用方法、输出参考、检测方法、缓解措施和危害指标等多个方面，结构完整且信息丰富，体现了高度的专业性。它旨在检测并利用n8n工作流自动化平台中的一个关键远程代码执行漏洞，影响版本为1.65.0至1.120.x。文档中明确指出，该工具能够识别公开可访问的n8n实例，通过特制的表单型工作流端点注入恶意负载，并最终实现对底层服务器的任意文件读写和命令执行。尽管仅提供了文档而非实际的可执行代码，但其详尽的描述和操作指南（包括系统要求、安装步骤、使用命令示例等）表明这是一个设计完善、旨在实现完整功能利用的工具。文档中还涵盖了攻击复杂性、身份验证要求、用户交互要求等关键利用细节，并列出了CVSS评分和CWE分类，为安全研究人员提供了全面的技术参考。工具的预期输出和检测方法也得到了说明，进一步证实了其作为有效安全研究工具的可靠性。鉴于该README文档的全面性和专业性，我们可以合理判断其所描述的POC是具备高度有效性和实用性的。

利用步骤：CVE-2026-21858，代号“Ni8mare”，是n8n工作流自动化平台中发现的一个极其严重的安全漏洞。此漏洞已获得CVSSv3.1评分10.0（满分），被归类为CWE-94（代码生成控制不当），允许未经身份验证的远程攻击者完全控制受影响的n8n实例。该漏洞的根本原因在于n8n的表单型工作流执行引擎在处理用户提交数据时，未能对输入参数进行充分、安全的验证和净化，导致恶意输入可以在内部执行上下文中被不当地处理。多个研究报告指出，这是一个复杂的漏洞链，通常涉及以下关键步骤：
1.  **初始访问与识别**: 攻击者首先通过网络识别并定位一个可公开访问的、运行着受影响版本（1.65.0至1.120.x）的n8n实例。此过程无需任何身份验证凭证。
2.  **利用Webhook/表单节点**: 攻击者利用n8n中的Webhook请求处理不当和表单节点（Form node）的输入校验缺陷。关键攻击点在于“Content-Type混淆”和“路径控制”。攻击者可发送特制的HTTP请求，绕过Content-Type检查，上传或访问任意文件。
3.  **任意文件读写**: 结合Content-Type混淆和路径控制漏洞，攻击者可以读取服务器上的敏感文件（如配置文件、令牌、密钥），甚至写入恶意文件到指定路径。搜索结果提到可能存在“任意文件读取 → Token伪造 → 沙箱绕过 → RCE”的完整漏洞链。
4.  **沙箱绕过与令牌伪造**: 如果n8n运行在沙箱环境中，攻击者会进一步利用漏洞绕过沙箱限制。通过读取到的敏感信息（如会话令牌、API密钥），攻击者可以伪造有效的用户会话或API请求，进一步提升权限。
5.  **远程代码执行 (RCE)**: 一旦绕过认证和沙箱，攻击者可以在n8n服务账户的权限下，通过注入恶意负载到表单输入字段或工作流配置中，执行任意的系统命令。这通常通过利用Node.js或底层操作系统命令执行的特性实现。
6.  **完全系统控制**: 恶意代码的成功执行将导致底层服务器的完全控制，包括数据泄露、任意文件修改、部署持久性后门、甚至将受感染的n8n实例作为跳板进一步攻击内部网络资源。
该漏洞的攻击复杂度为“低”，无需认证或用户交互，使得其在野外被利用的风险极高。

投毒风险分析：提供的POC内容仅为一个名为`README.md`的文本文件，并非任何可执行代码或脚本。该`README`文件是针对CVE-2026-21858漏洞的一个详细的安全研究工具说明文档。从其内容来看，该文档结构清晰、信息专业，完全符合一个合法且高质量的安全研究或漏洞检测工具的文档规范。文档中未包含任何可疑的代码混淆片段、恶意链接、外部可执行脚本的引用，也没有任何暗示恶意行为的指令或引导。它全面且客观地说明了漏洞的性质、受影响版本、技术分析、利用方式、潜在影响、检测方法以及缓解措施，旨在帮助用户理解并防御该关键漏洞。因此，仅基于这个README文档本身进行分析，它并不构成任何投毒风险，可以视为安全且无害的。然而，值得注意的是，任何从非官方或不可信来源获取的实际POC代码（即便其文档看起来合法）都应进行严格的代码审计。在获取到实际的可执行POC代码时，必须对其进行沙箱环境下的运行测试和静态/动态分析，以检查是否存在隐藏的恶意载荷（如后门、加密货币挖矿程序、信息窃取模块、与未知C2服务器通信、文件篡改等）、代码混淆、调用非标准库或执行可疑系统命令等行为。在当前仅提供文档的情况下，由于没有任何可执行或可被利用的代码组件，投毒风险评定为0%。

**项目地址:** 

**漏洞详情:** 
