## CVE-2026-21858 - n8n Workflow Automation Platform 远程代码执行(RCE)

**漏洞编号:** CVE-2026-21858

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** n8n Workflow Automation Platform

**危害等级:** 高危/严重

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**影响版本:** 1.65.0 - 1.120.x (修复于 >= 1.121.0)

**利用条件:** 无需认证、网络可访问、无需用户交互，目标n8n实例需暴露Webhook或表单端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

该POC代码实际上是一份详细的`README.md`文档，它描述了一个用于检测CVE-2026-21858的“安全研究工具”。文档内容极为全面，涵盖了漏洞摘要、CVSS评分、CWE分类、受影响产品及版本、技术分析、利用条件、安装及使用指南、检测方法、缓解措施和IOCs。如此详细的说明，表明该工具的设计思路和功能实现已非常成熟。尽管未提供实际可执行代码，但文档对漏洞的根源、攻击向量、利用复杂度的深入解析，以及清晰的检测与利用步骤描述，都强烈暗示了该工具的完整性和高有效性。它能够帮助安全研究人员准确识别N8N自动化平台中的易受攻击实例，并可能进一步验证远程代码执行的能力，具有高度的实用价值和可操作性。

攻击者首先会识别出互联网上公开暴露的n8n实例，特别是那些开放了Webhook或表单端点的服务。利用的关键在于n8n的表单节点在处理HTTP请求时，未能对`Content-Type`头部进行充分验证，并盲目信任`req.body.files`对象的内容。攻击者可通过精心构造特殊的JSON请求，实现类型混淆，从而操纵文件路径参数。通过在表单输入字段中注入恶意负载，未经身份验证的攻击者能够以n8n服务账户的权限在底层系统上执行任意代码。一旦RCE成功，攻击者便可读取、修改文件，甚至完全控制n8n实例。鉴于n8n通常会存储如API令牌、OAuth凭证等敏感信息，这可能导致攻击者以受害实例为跳板，进一步渗透到企业内部网络或云环境中，获取更多敏感数据或发起更深层次的攻击。

针对当前提供的POC内容（仅为`README.md`文档），其直接投毒风险极低（评估为5%）。`README.md`文件本身不包含任何可执行代码、二进制程序或外部脚本调用，因此无法通过代码混淆、注入恶意功能或执行隐蔽操作来构成直接威胁。该文档清晰地阐述了漏洞细节和工具用法，没有任何可疑或非安全研究相关的指示。然而，这种低风险评估仅限于此文档本身。如果用户依据`README.md`的指引去获取或执行其描述的“安全研究工具”的实际代码，那么该代码的来源和内容就需要进行严格审查。从非官方或不受信任的渠道下载的工具代码，可能已被恶意篡改，包含后门、恶意软件或其他意图不良的功能。因此，虽然`README.md`无害，但用户在实际部署和使用此类工具时，务必保持高度警惕，并通过官方或可信渠道获取代码，并进行必要的安全审计。

**项目地址:** None

**漏洞详情:** https://avd.aliyun.com/detail?id=AVD-2026-21858
