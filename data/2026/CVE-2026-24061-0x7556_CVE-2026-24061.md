## CVE-2026-24061 - GNU InetUtils telnetd 远程认证绕过, 提权, 远程代码执行

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 远程认证绕过, 提权, 远程代码执行

**影响应用:** GNU InetUtils telnetd

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils versions 1.9.3 to 2.7 (excluding 2.8 and later), specifically telnetd versions prior to 2.6

**利用条件:** 无需认证, 远程网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该漏洞，编号为CVE-2026-24061，被称之为“核弹级”漏洞，影响了GNU InetUtils套件中的Telnetd服务。Telnetd是Linux和Unix-like系统上提供远程登录功能的守护进程，监听TCP 23端口，允许客户端通过Telnet协议进行明文终端接入。此漏洞的CVSS评分高达9.8，表明其具有极高的危害性。它是一个远程认证绕过漏洞，允许未认证的远程攻击者直接获取受影响系统的root权限。据报道，该漏洞已潜伏长达11年，其利用逻辑依赖于Telnetd服务与系统`/usr/bin/login`程序之间的“设计结合”以及对遗留协议Telnet的长期低关注度。

漏洞的深层原因在于Telnetd服务在调用`/usr/bin/login`程序进行用户登录时，未能对客户端传入的特定环境变量进行充分的校验或清理。具体来说，攻击者可以通过Telnet协议的`NEW_ENVIRON`选项，发送一个特制的`USER`环境变量。当这个`USER`变量被设置为例如`"-f root"`时，`telnetd`服务在处理过程中，会将`-f root`作为参数直接传递给`/usr/bin/login`。`/usr/bin/login`程序在接收到`-f`参数时，会跳过通常的用户认证流程（`-f`通常用于跳过`/etc/nologin`检查），并直接尝试以`root`身份登录。由于没有进行凭证验证，攻击者便能成功欺骗`login`程序，从而在无需任何密码的情况下获得目标系统的root权限shell。

**POC有效性分析:**
所提供的POC信息来源于GitHub仓库`0x7556/CVE-2026-24061`的`README.md`文件。该`README`明确指出这是一个针对CVE-2026-24061的Telnet RCE（远程代码执行）漏洞利用工具，支持Linux、macOS和Windows平台。它提供了清晰的使用说明：`go-telnet-exploit <host> [-p <port>]`。更重要的是，`README`中包含了两张截图，分别标记为“Check”和“Exploit”。“Check”截图很可能展示了对目标系统漏洞的检测功能，例如识别Telnetd版本或验证漏洞是否存在；而“Exploit”截图则似乎显示了成功获取root权限后的效果，例如一个root权限的shell提示符或执行任意命令的输出。这些信息强烈表明这是一个功能完整且可用的漏洞利用工具，很可能是一个用Go语言编写的编译型程序。清晰的用法说明和直观的利用成功截图，使其被评估为高可用性的POC。因此，POC质量评分为9/10，表明其是一个功能完整、易于理解和使用的漏洞利用代码。

**利用步骤:**
1.  **目标识别**: 攻击者首先通过端口扫描等方式，识别出网络中运行着Telnetd服务（默认TCP 23端口）且版本处于受影响范围内的目标系统。
2.  **验证漏洞**: 使用如POC中所示的`go-telnet-exploit`工具连接到目标Telnet服务。该工具的“Check”功能可能用于探测目标是否易受攻击，例如检查Telnetd版本或尝试发送初步的恶意选项以观察响应。
3.  **发送恶意环境变量**: 一旦确认目标系统脆弱，攻击者通过Telnet连接发送一个特制的`NEW_ENVIRON`选项。在此选项中，`USER`环境变量被设置为`"-f root"`。
4.  **获取Root Shell**: Telnetd服务接收到此恶意环境变量后，会将其不加过滤地传递给`/usr/bin/login`程序。`login`程序误解`-f root`为合法参数，跳过认证过程，并直接以root用户身份为攻击者分配一个shell。此时，攻击者即可在目标系统上执行任意命令，完全控制系统。

**投毒风险分析:**
基于当前提供的输入数据，即POC项目的`README.md`文件和截图，对`go-telnet-exploit`工具的投毒风险评估为低（10%）。这个风险评估主要考虑到以下几点：首先，我们并未获得`go-telnet-exploit`工具的实际可执行文件或其Go语言源代码，因此无法进行直接的代码审查，来检查是否存在恶意代码、后门、远程回连、数据窃取或其他非预期的行为。然而，根据`README`文件的描述，该POC旨在利用CVE-2026-24061实现远程认证绕过和提权，其利用逻辑是基于公开的漏洞原理和技术细节。`README`本身没有包含任何可疑的脚本、混淆代码片段、或指向外部恶意资源的链接。它仅描述了漏洞的利用方式及其参数使用。这里需要明确区分“POC验证的后门代码”和“投毒代码”。通过该漏洞利用，攻击者确实能够获得root权限，这本身就意味着系统被完全控制，可以被攻击者植入后门。但这属于漏洞利用成功的后果，而非POC代码本身被恶意植入额外无关功能的“投毒”。主要的风险点在于，如果攻击者下载了来自非官方或不可信源的已编译`go-telnet-exploit`二进制文件，该文件可能已经被恶意篡改，包含了除了漏洞利用功能之外的额外恶意载荷。在缺乏源代码审计的情况下，任何第三方编译的二进制都应被视为潜在风险。鉴于现有信息未直接显示POC文档或其所描述的工具本身具有额外的恶意功能，且其主要目的在于验证和利用已知漏洞，因此我们判定其内嵌“投毒”的风险较低。建议使用者务必从可信来源获取此类工具，并对二进制文件进行哈希校验或自行编译。

**项目地址:** https://github.com/0x7556/CVE-2026-24061

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
