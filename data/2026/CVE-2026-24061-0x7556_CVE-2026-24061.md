## CVE-2026-24061 - GNU InetUtils telnetd 认证绕过/权限提升/远程代码执行 (RCE)

**漏洞编号:** CVE-2026-24061

**漏洞类型:** 认证绕过/权限提升/远程代码执行 (RCE)

**影响应用:** GNU InetUtils telnetd

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** GNU InetUtils 1.9.3 到 2.7 (含)

**利用条件:** 远程未授权访问，目标系统需运行受影响版本的Telnetd服务（默认TCP 23端口）

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Exploit)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2026-24061是一个针对GNU InetUtils telnetd服务的远程认证绕过和权限提升漏洞，最终可导致远程代码执行（RCE）。该漏洞的CVSS评分为9.8分，属于极高危漏洞。其核心根源在于telnetd服务在调用`/usr/bin/login`程序进行用户认证时，未能对客户端传入的`USER`环境变量进行充分的校验和过滤。Telnet协议中存在一个`NEW_ENVIRON`选项，允许客户端向服务器发送自定义环境变量。攻击者可以利用此机制，在`USER`环境变量中注入恶意参数，例如`"-f root"`。当telnetd将这个未经验证的`USER`变量作为参数直接传递给`login`程序时，`login`程序会将`"-f root"`解释为一个合法的命令行参数，从而在不要求密码或任何凭证的情况下，直接为攻击者授予`root`权限的shell。

该漏洞能潜伏长达11年，主要原因在于Telnet作为一个遗留协议，长期处于低关注度和低维护力的状态，且其利用逻辑依赖于Telnetd与`login`程序两个系统组件之间的“设计结合”缺陷，而非单一组件的明显弱点。受影响的版本范围是GNU InetUtils 1.9.3到2.7（含）的所有版本。

POC有效性分析：根据提供的`README.md`文件，该POC项目明确标注为“CVE-2026-24061 Telnet RCE Exploit For Linux MacOS Windows”，并指明支持GNU InetUtils 1.9.3至2.7版本。`README.md`中包含了“Usage: go-telnet-exploit <host> [-p <port>]”的使用说明，并提供了“Check”和“Exploit”的截图链接。这些信息共同表明，该POC是一个功能完整的、可用于远程代码执行的攻击工具，并且是跨平台（Go语言编译）的。截图的存在进一步验证了其功能性和实际利用效果，表明攻击者可以利用该工具进行漏洞检测和实际的远程提权，最终获得目标系统的`root`权限。这使得该漏洞的威胁等级极高，因为攻击者无需任何认证即可获得目标系统的最高权限。

**利用步骤：**
1.  **目标识别:** 攻击者首先使用端口扫描工具（如Nmap）识别互联网上运行GNU InetUtils telnetd服务的Linux、macOS或Windows系统。这些服务通常监听TCP 23端口。
2.  **POC获取与准备:** 从GitHub仓库下载`go-telnet-exploit`工具的源代码并编译，或者直接获取已编译的二进制文件。
3.  **执行攻击:** 攻击者在命令行中执行`go-telnet-exploit`，指定目标主机的IP地址或域名，例如 `./go-telnet-exploit 192.168.1.100`。如果telnetd运行在非标准端口，可以使用`-p`参数指定。
4.  **恶意负载注入:** `go-telnet-exploit`工具会与目标telnetd服务建立连接，并通过Telnet协议的`NEW_ENVIRON`选项发送一个特制的`USER`环境变量。该环境变量的值中会包含`"-f root"`等恶意参数。
5.  **漏洞触发:** 目标系统上的telnetd服务接收到这个未经净化的`USER`环境变量后，直接将其作为参数传递给`/usr/bin/login`程序。
6.  **认证绕过与提权:** `/usr/bin/login`程序在处理这些参数时，会将`"-f root"`解释为以root用户身份登录的指令，从而绕过正常的密码验证流程。
7.  **获取Root Shell/RCE:** 攻击者随即获得目标系统的root权限shell，或者可以执行任意系统命令，实现完整的远程代码执行，彻底控制受害系统。

**投毒风险分析：**
针对此CVE的POC代码（特别是`README.md`文件）本身是干净的，不包含任何恶意脚本、混淆代码或可疑的外部链接。因此，基于提供的`README.md`内容，直接投毒风险评估为低（10%）。然而，`README.md`中明确指向了一个外部GitHub仓库（`https://github.com/0x7556/CVE-2026-24061`），该仓库预计包含实际的Go语言编写的攻击工具二进制文件或源代码。任何从外部来源（包括GitHub）下载并执行POC，特别是编译好的二进制文件时，都存在固有的供应链投毒风险。恶意行为者可能会在POC中植入后门、加密货币挖矿程序、勒索软件或其他恶意软件。为了规避此类风险，组织和安全研究人员务必遵循以下最佳实践：
1.  **代码审查:** 如果POC提供源代码，应彻底审查代码，查找可疑功能、异常网络请求或系统修改行为。
2.  **沙箱环境:** 在隔离的沙箱环境（例如虚拟机，并限制其对生产网络的访问）中执行任何外部POC，并监控其行为和网络流量。
3.  **来源验证:** 优先使用官方安全补丁和厂商建议，而非依赖未经验证的公开POC。对下载的POC进行哈希校验，并与可信来源（如官方发布者）提供的哈希值进行比对，以确保完整性。

**项目地址:** https://github.com/0x7556/CVE-2026-24061

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2026-24061
