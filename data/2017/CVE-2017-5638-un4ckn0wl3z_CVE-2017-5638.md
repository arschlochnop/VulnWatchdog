# CVE-2017-5638

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-5638-Badbird3_CVE-2017-5638.md](../2017/CVE-2017-5638-Badbird3_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #2

**来源**: [CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md](../2017/CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是一个 Apache Struts2 的远程代码执行漏洞，存在于 Jakarta Multipart parser 中。由于不正确的异常处理和错误消息生成，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头来执行任意命令。从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞利用的有效性非常高，因为在2017年3月已经被广泛利用。漏洞利用代码中的`CVE-2017-5638ApacheStruts.py`脚本通过构造包含OGNL表达式的Content-Type头来触发漏洞，从而执行任意命令。利用方式是通过发送一个精心构造的HTTP请求，其中Content-Type头包含一个OGNL表达式，该表达式允许攻击者执行任意系统命令。

**有效性:**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的有效性非常高，且POC代码能够复现。

**投毒风险:**
POC代码主要功能是发送恶意请求并执行命令。虽然存在一定的风险（例如，命令执行不当导致系统不稳定），但不存在明显的恶意投毒代码。代码结构较为清晰，主要包含参数解析、payload生成和请求发送三个部分。代码中可能的风险点在于，攻击者可以利用此代码执行任意命令，因此存在滥用的风险。但代码本身的功能是为了验证漏洞，并无主动传播恶意代码的功能。我给出的投毒风险评估为5%，主要考虑是：

*   代码作者可能会在代码中添加一些隐藏的后门代码，例如，收集目标服务器的信息并发送到攻击者的服务器，或者在目标服务器上安装恶意软件。
*   代码用户可能会在使用代码时，不小心执行了恶意命令，从而导致系统被入侵。

**利用方式:**
1.  **目标确定:** 确定目标服务器上运行的Apache Struts2版本是否在受影响范围内（2.3.x before 2.3.32 或 2.5.x before 2.5.10.1）。
2.  **Payload构造:** 使用POC代码中的`creating_payload`函数构造包含恶意命令的OGNL表达式payload。 例如：要执行 `whoami` 命令，使用 `-c whoami` 参数。
3.  **请求发送:** 使用POC代码中的`execute`函数，将构造好的payload作为Content-Type头的值，发送HTTP请求到目标服务器的`.action`文件。POC代码会打印命令执行的结果。
4.  **结果分析:** 分析命令执行的结果，判断漏洞是否成功利用。

总而言之，该漏洞利用代码的有效性高，但存在较低的投毒风险。使用时务必谨慎，并确保在授权的环境下进行。


**项目地址:** [FredBrave/CVE-2017-5638-ApacheStruts2.3.5](https://github.com/FredBrave/CVE-2017-5638-ApacheStruts2.3.5)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #3

**来源**: [CVE-2017-5638-Iletee_struts2-rce.md](../2017/CVE-2017-5638-Iletee_struts2-rce.md)

## CVE-2017-5638-Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且可通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理不当。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2017-5638是一个被广泛利用的漏洞。存在公开可用的PoC代码，并且Metasploit框架中也存在利用模块，因此该漏洞的利用有效性很高。

提供的Dockerfile和Jenkinsfile用于构建和部署一个Struts2应用，但本身不包含漏洞利用代码。而是提供了一个包含漏洞的Struts2环境，方便演示和复现。

**投毒风险：**

虽然提供的Dockerfile和Jenkinsfile本身不包含明显的恶意代码，但存在一定的投毒风险：

*   **依赖风险：** Dockerfile中使用了`tomcat:7`镜像，存在该镜像可能包含已知漏洞的风险。Jenkinsfile中maven deploy可能会将构建的组件上传到外部maven仓库，若该仓库被入侵，则存在组件投毒的风险
*   **间接投毒：** Dockerfile中的`COPY target/struts2-rest-showcase.war /usr/local/tomcat/webapps/ROOT.war`，如果`struts2-rest-showcase.war`本身被替换为包含恶意代码的版本，则可能造成投毒。Jenkinsfile拉取的scm如果被恶意人员修改，则存在投毒风险。
*   **Jenkinsfile风险:** Jenkinsfile 中的`postGitHub` 函数，使用了github api token，若该token泄露，则可能导致项目代码被篡改。

综合评估，投毒风险大约为10%，主要来自于依赖风险和构建过程中的潜在恶意代码注入。

**利用方式：**

利用CVE-2017-5638漏洞的典型方式如下：

1.  **构造恶意HTTP请求：**  攻击者构造包含恶意Ognl表达式的Content-Type头部的HTTP请求。
2.  **发送请求：**  将构造好的HTTP请求发送到存在漏洞的Struts2服务器。
3.  **远程代码执行：**  Struts2服务器解析Content-Type头部时，会执行其中的恶意Ognl表达式，从而导致远程代码执行。

攻击者可以通过远程代码执行在服务器上执行任意命令，例如反弹shell、读取敏感文件、修改系统配置等。

一些公开的PoC利用了`#cmd=`字符串来执行系统命令，如`Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW; #cmd=whoami`



**项目地址:** [Iletee/struts2-rce](https://github.com/Iletee/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #4

**来源**: [CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md](../2017/CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且对外开放HTTP端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是 Apache Struts 2 Jakarta Multipart parser 中的一个远程代码执行漏洞。该漏洞是由于在文件上传过程中，对Content-Type、Content-Disposition或Content-Length HTTP header处理不当造成的，攻击者可以通过构造恶意的HTTP头部，利用OGNL表达式注入执行任意命令。

**有效性：** 根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索引擎结果中包含多个关于CVE-2017-5638的PoC和分析，说明该漏洞已经被广泛研究和利用。POC代码通过构造包含恶意OGNL表达式的Content-Type头部，发送POST请求到存在漏洞的Apache Struts2应用，从而执行任意命令。

**投毒风险：**  分析提供的`exploit.py.txt`和`README.md`文件。`README.md`文件只是漏洞利用说明，不包含任何代码。`exploit.py.txt` 文件中的Python代码用于利用 CVE-2017-5638 漏洞。代码首先定义了目标URL和包含恶意 OGNL 表达式的 payload。Payload 构造了一个命令执行的 OGNL 表达式，并在目标系统上执行 `ls /` 命令，将输出返回到响应中。然后，它使用 `requests` 库发送一个包含恶意 header 的 POST 请求到目标 URL。代码没有发现任何隐藏的或恶意的后门或投毒代码。payload 的目的是执行命令，而不是植入长期存在的恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **构造恶意HTTP头部：** 攻击者构造包含恶意OGNL表达式的Content-Type、Content-Disposition或Content-Length HTTP头部。在该POC中，恶意代码位于Content-Type头中。
2.  **发送请求：** 攻击者将构造好的HTTP请求发送到存在漏洞的Apache Struts2应用。
3.  **命令执行：** Struts2应用在处理请求时，由于错误的异常处理和错误消息生成，会将恶意OGNL表达式解析并执行，从而导致远程代码执行。在该POC中，执行了`ls /`命令。
4.  **获取结果：** 攻击者从HTTP响应中获取命令执行的结果。

**项目地址:** [MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION](https://github.com/MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #5

**来源**: [CVE-2017-5638-Nithylesh_web-application-firewall-.md](../2017/CVE-2017-5638-Nithylesh_web-application-firewall-.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性:**
提供的`vulnerable.py`脚本可以有效利用此漏洞，通过设置恶意的`Content-Type`头，向目标服务器发送包含OGNL表达式的HTTP请求，从而执行任意命令。

**投毒风险:**
仓库中存在投毒代码的风险较低，约10%。分析如下：
  * `server.py`文件模拟了一个简单的WAF，但其阻止模式相当基础，可能被绕过。
  * `vulnerable.py`脚本是漏洞利用的核心，其本身的目的就是执行任意命令，这使得判断其中是否包含恶意代码变得困难。尽管如此，脚本逻辑相对清晰，主要是构造payload发送请求并打印响应。但是依旧存在以下情况:
  * 存在隐藏的反向shell或者其他恶意指令的可能，但需要进一步分析才能确定。

**利用方式:**
1.  攻击者发送特制的HTTP请求，该请求的`Content-Type`头包含恶意的OGNL表达式。
2.  Struts2框架在处理multipart请求时，会解析`Content-Type`头。
3.  由于漏洞存在，OGNL表达式会被执行，从而在服务器上执行攻击者指定的命令。
4.  `vulnerable.py` 脚本通过 `check_vulnerability` 和 `execute_command` 函数展示了如何构造包含恶意OGNL表达式的 `Content-Type` 头并发送请求。

**优先级排序理由:**
搜索引擎结果提供了漏洞的基本信息和利用场景，但漏洞利用代码 `vulnerable.py` 更为关键，因为它直接展示了漏洞的利用方式。漏洞库信息作为补充，提供了漏洞影响的版本范围和基本描述。


**项目地址:** [Nithylesh/web-application-firewall-](https://github.com/Nithylesh/web-application-firewall-)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #6

**来源**: [CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md](../2017/CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且允许通过HTTP请求与目标交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞存在于 Jakarta Multipart parser 中，由于其在处理文件上传时的异常处理和错误消息生成不正确导致。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头，在服务器上执行任意命令。

**有效性：**

提供的PoC代码通过修改Content-Type头部，利用OGNL表达式注入恶意代码，从而实现远程代码执行。根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，因此PoC代码的有效性较高。

**投毒风险：**

PoC 代码本身是为了利用漏洞而编写的，其目的是执行任意命令。 从提供的代码来看，核心功能是构造包含恶意 OGNL 表达式的 HTTP 头部。
代码通过 Content-Type 注入 OGNL 表达式，该表达式首先获取 OgnlContext，然后清空了 OGNL 的黑名单，以便执行任意代码。接着，它使用 java.lang.ProcessBuilder 执行指定的命令，并将命令执行的结果返回。

综合分析，PoC 代码的功能是利用漏洞，而不是植入后门或进行其他恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  攻击者发送一个包含恶意Content-Type HTTP头的请求到目标服务器。
2.  恶意Content-Type头中包含OGNL表达式，该表达式能够执行任意系统命令。
3.  Struts2框架解析该请求时，会执行OGNL表达式，从而导致远程代码执行。
4.  攻击者通过执行系统命令，可以获取服务器的控制权。

**总结：**

CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单，影响广泛。提供的PoC代码可以有效利用该漏洞。该PoC代码本身没有投毒风险，但攻击者可以利用该PoC代码攻击未修复的Struts2应用。

**项目地址:** [QHxDr-dz/CVE-2017-5638](https://github.com/QHxDr-dz/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #7

**来源**: [CVE-2017-5638-Tankirat_CVE-2017-5638.md](../2017/CVE-2017-5638-Tankirat_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许通过HTTP进行访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 框架的 Jakarta Multipart parser 中。当处理文件上传时，由于异常处理和错误消息生成不当，攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部来执行任意命令。在野外攻击中，通常使用包含 `#cmd=` 字符串的 Content-Type 头部。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的PoC。漏洞利用代码描述了漏洞原理和利用方法，表明该漏洞的有效性较高。

**投毒风险：**
提供的漏洞利用代码（`/tmp/3bf1e344cbece4d19a9e8c32c2245913/README.md`） 主要是漏洞的介绍文档，描述了漏洞的原理、影响、利用方法、案例分析（Equifax 数据泄露），以及预防措施和参考链接。其中虽然引用了github上漏洞扫描工具，但本身readme文件不具备可执行的攻击代码。所以投毒风险较低，但不能完全排除作者通过其他方式进行投毒，比如在引用的链接中做手脚。所以评定投毒风险为10%。

**利用方式：**
1.  攻击者发送包含恶意构造的 HTTP 头部（例如，Content-Type）的请求到存在漏洞的 Apache Struts 应用。
2.  恶意的 HTTP 头部包含 Object-Graph Navigation Language (OGNL) 表达式。
3.  Struts 应用在解析 HTTP 头部时，会将 OGNL 表达式传递给 `LocalizedTextUtil.findText` 函数进行处理。
4.  `LocalizedTextUtil.findText` 函数会将 `${...}` 中的内容解释为 OGNL 表达式并执行。
5.  攻击者可以通过 OGNL 表达式执行任意系统命令，从而实现远程代码执行。

攻击成功的关键在于构造包含恶意 OGNL 表达式的 HTTP 头部，例如 `Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','vuln')}`。其中OGNL表达式可以执行任意命令，获取敏感信息，或者植入后门。

该漏洞曾被广泛利用，导致了包括 Equifax 数据泄露在内的多起重大安全事件。

**项目地址:** [Tankirat/CVE-2017-5638](https://github.com/Tankirat/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #8

**来源**: [CVE-2017-5638-Xernary_CVE-2017-5638-POC.md](../2017/CVE-2017-5638-Xernary_CVE-2017-5638-POC.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标服务器运行存在漏洞版本的Apache Struts2，且允许POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，由于错误处理和错误消息生成不当，导致攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头来执行任意命令。根据提供的漏洞库信息，漏洞的利用方式是通过在Content-Type头中包含 '#cmd=' 字符串来执行命令，并根据搜索结果确认该漏洞已被广泛利用。

**有效性：**
提供的`exploit.py`脚本通过构造包含OGNL表达式的Content-Type头来实现远程代码执行。该表达式利用OGNL绕过安全限制，执行指定的命令并将结果返回。该PoC代码的逻辑是正确的，并且与漏洞描述相符，因此有效。

**投毒风险：**
审查提供的 Dockerfile 和脚本，可以发现潜在的投毒风险。
*   `server-setup-script.sh`: 该脚本从华为云镜像下载了JDK 8u171，但是考虑到华为云镜像可能已经发生了变更（被投毒），因此存在一定的风险。此外，该脚本中没有检查下载的JDK的完整性，如果下载过程中被篡改，可能导致系统被植入后门。`pwn-page.jsp` 在服务器遭受攻击后会部署该页面。
* `exploit.py`，该脚本本身没有包含明显的恶意代码，但如果被攻击者修改，例如在执行命令之前添加下载和执行恶意文件的功能，也可能成为投毒的途径。`startup.sh` 这个脚本仅仅是用来启动 tomcat 服务。并且Dockerfile 最终启动的命令是 `CMD ["sh", "-c", "./startup.sh && bash"]`， 该命令会启动一个交互式的shell。

因此，综合评估投毒风险大约为10%。虽然没有发现直接的、明显的投毒代码，但是下载的外部资源以及执行流程存在被利用的潜在风险，需要谨慎对待。

**利用方式：**
1.  攻击者发送一个精心构造的HTTP POST请求到存在漏洞的Struts2服务器。
2.  该请求的Content-Type头包含一个恶意的OGNL表达式，该表达式利用Struts2的OGNL解析器执行任意命令。
3.  服务器执行该命令，并将结果返回给攻击者。

**总结：**
CVE-2017-5638 是一个严重的安全漏洞，利用简单，危害巨大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [Xernary/CVE-2017-5638-POC](https://github.com/Xernary/CVE-2017-5638-POC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #9

**来源**: [CVE-2017-5638-andypitcher_check_struts.md](../2017/CVE-2017-5638-andypitcher_check_struts.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP header，在服务器上执行任意命令。漏洞根源在于Struts2对Content-Type等header的处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个真实存在的且已被广泛利用的高危漏洞。网上存在大量的PoC代码，表明其有效性。

**投毒风险：**
提供的代码片段是一个GNU GPL v3许可协议。单独从这个LICENSE文件无法判断是否存在投毒代码，需要检查完整的漏洞利用程序。
然而，考虑到漏洞利用的性质（远程代码执行），如果攻击者能够控制漏洞利用代码，他们可以嵌入恶意代码，例如：

*   **植入后门：** 在目标系统上安装后门，以便长期控制。
*   **数据窃取：** 窃取目标系统上的敏感数据。
*   **恶意软件传播：** 将目标系统作为传播恶意软件的跳板。
*   **破坏系统：** 删除关键文件或使系统崩溃。

因此，在使用任何来自不可信来源的漏洞利用代码时，都必须非常谨慎，进行详细的代码审计，确保没有恶意行为。这里给出的“投毒风险”评估为10%，主要因为提供的代码段本身只是LICENSE信息，无法确定完整利用代码的安全性。需要对实际使用的利用代码进行更细致的分析。

**利用方式：**
利用方式主要通过以下步骤：

1.  **确定目标：** 确定运行存在漏洞的Apache Struts2版本的服务器。
2.  **构造恶意HTTP请求：** 构造包含恶意OGNL表达式的HTTP请求，通常在Content-Type header中，例如`Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getHeader('cmd')}`。`cmd` header 包含要执行的系统命令。
3.  **发送请求：** 将构造好的HTTP请求发送到目标服务器。
4.  **执行命令：** Struts2解析HTTP请求时，会执行恶意OGNL表达式，从而在服务器上执行攻击者指定的命令。

例如，攻击者可以使用curl命令发送包含恶意Content-Type header的请求：

```bash
curl -H 'Content-Type: %{#context["com.opensymphony.xwork2.dispatcher.HttpServletRequest"].map.class.forName("java.lang.Runtime").getRuntime().exec("id")}' http://target.com/example.action
```

此命令会在目标服务器上执行`id`命令，并将结果返回给攻击者。

总而言之，CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单且影响严重，需要及时修复。

**项目地址:** [andypitcher/check_struts](https://github.com/andypitcher/check_struts)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #10

**来源**: [CVE-2017-5638-colorblindpentester_CVE-2017-5638.md](../2017/CVE-2017-5638-colorblindpentester_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638（也称为S2-045）是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，此漏洞是有效的。搜索结果中包含了大量关于CVE-2017-5638的分析、利用和修复信息，表明这是一个真实且影响广泛的漏洞。PoC代码的存在进一步证实了其可利用性。

**投毒风险：**
提供的PoC代码本身就是利用该漏洞的脚本。要确定是否存在投毒风险，需要检查代码中是否存在恶意行为，例如下载和执行其他文件、篡改系统配置等。检查了给定的struts2_S2-045.py代码，它主要功能是构造payload执行命令，并没有发现明显的恶意投毒代码。虽然该代码可以用来执行任意命令，但这本身就是漏洞利用的目的，而不是额外添加的恶意功能。考虑到README.md文件极其简单，整个仓库并没有其他可疑文件，因此投毒风险较低，给出的估计值为5%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Jakarta Multipart parser处理HTTP请求头时。具体来说，当Struts2应用程序尝试解析包含恶意表达式的Content-Type头时，会导致OGNL表达式执行。
2.  **Payload构造：** 攻击者构造包含OGNL表达式的Content-Type头。该表达式利用Struts2的OGNL机制来绕过安全限制，并执行任意命令。
3.  **命令执行：** OGNL表达式首先获取对`OgnlContext`的引用，然后绕过默认的成员访问限制。接着，它使用`java.lang.ProcessBuilder`类来执行指定的命令。PoC中包含了针对Windows和Linux系统的不同命令执行方式。
4.  **结果返回：** 执行命令的结果通过`ServletActionContext.getResponse().getOutputStream()`获取输出流，并将命令执行的结果写入到HTTP响应中，返回给攻击者。

简单来说，利用方式就是通过精心构造的HTTP请求头，向存在漏洞的Struts2应用程序发送恶意payload，从而在服务器上执行任意命令。

**项目地址:** [colorblindpentester/CVE-2017-5638](https://github.com/colorblindpentester/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #11

**来源**: [CVE-2017-5638-haxerr9_CVE-2017-5638.md](../2017/CVE-2017-5638-haxerr9_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #12

**来源**: [CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md](../2017/CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许通过HTTP header传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 漏洞存在于Apache Struts2框架的Jakarta Multipart parser中，由于其在处理文件上传时的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP header来执行任意命令。

**有效性：**
提供的PoC代码是有效的，但它是一个安全的演示版本。它通过在Content-Type header中注入OGNL表达式，尝试设置一个自定义的HTTP响应头（X-Vuln）。如果服务器返回的响应中包含此header，则表示目标服务器可能存在漏洞。此PoC**不会**执行任何实际的恶意命令。

**投毒风险：**
分析了PoC代码和README文件，该仓库的目的是安全地演示该漏洞，而没有包含任何隐藏的或恶意的代码。没有发现任何投毒代码。因此, 投毒风险为 0%。

**利用方式：**
1.  **漏洞原理：** Struts2 使用Jakarta Multipart parser处理multipart请求，Content-Type头信息会被解析。如果Content-Type的值中包含OGNL表达式，并且OGNL表达式解析被启用，攻击者就可以利用OGNL表达式执行任意代码。
2.  **攻击方式：** 攻击者构造包含恶意OGNL表达式的Content-Type header，并发送给存在漏洞的Struts2服务器。
3.  **执行结果：** 服务器解析Content-Type header中的OGNL表达式，执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **PoC利用：** 提供的PoC利用代码通过发送包含`%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Vuln','Vulnerable')}`的Content-Type头来判断是否存在漏洞，成功则表示可能存在漏洞。

**项目地址:** [iampetru/PoC-CVE-2017-5638](https://github.com/iampetru/PoC-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #13

**来源**: [CVE-2017-5638-injcristianrojas_cve-2017-5638.md](../2017/CVE-2017-5638-injcristianrojas_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32 和 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且接受HTTP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 中的一个远程代码执行漏洞，存在于 Jakarta Multipart parser 中。当 Struts2 尝试处理文件上传时，如果 Content-Type、Content-Disposition 或 Content-Length HTTP 头部被恶意构造，将导致异常处理和错误消息生成过程出现问题，进而允许攻击者执行任意命令。

**漏洞利用方式：**

漏洞利用主要通过构造恶意的 Content-Type 头部，其中包含 OGNL 表达式。 OGNL（Object-Graph Navigation Language）是一种强大的表达式语言，用于访问和操作 Java 对象的属性。 攻击者通过在 Content-Type 头部中注入恶意的 OGNL 表达式，利用 Struts2 在解析请求时的漏洞，执行任意系统命令。

提供的漏洞利用代码包含两个 Python 脚本 (exploit1.py 和 exploit2.py)。

*   **exploit1.py:**  尝试通过在 Content-Type 中注入 OGNL 表达式，添加一个名为 "PWNED" 的 HTTP 头部，其值为 1337。这可以用来验证漏洞是否存在。
*   **exploit2.py:**  允许攻击者指定要执行的命令。 它构造一个更复杂的 OGNL 表达式，绕过某些安全限制，并使用 `java.lang.ProcessBuilder` 执行指定的命令，然后将命令的输出返回到 HTTP 响应中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞已经被广泛利用，提供的 POC 代码与已知的攻击方式一致，因此可以判断 POC 代码有效。

**投毒风险：**

提供的代码仓库包含一个 Jenkinsfile, 用于通过OWASP Dependency Check Plugin进行依赖检查, 这本身不属于投毒行为。 exploit1.py 和 exploit2.py 是利用漏洞的代码，也不构成投毒。仓库结构和代码内容来看，存在恶意投毒的可能性较低，约 5% 的可能性在于作者可能在其他未展示的文件中隐藏恶意代码，或者存在依赖污染的风险。总体而言，直接利用该仓库进行投毒的可能性较低，但仍需谨慎使用，建议在使用前进行详细的代码审计。

**项目地址:** [injcristianrojas/cve-2017-5638](https://github.com/injcristianrojas/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #14

**来源**: [CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md](../2017/CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可直接控制服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行受影响版本的Apache Struts2，并且存在文件上传功能或使用了Jakarta Multipart parser

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 框架中的一个远程代码执行漏洞，该漏洞源于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的POC是有效的。漏洞库和搜索结果都表明这是一个被广泛利用的漏洞，多个安全厂商和研究人员都发布了相关的分析和利用方法。

**投毒风险：**

分析提供的代码仓库内容，`README.md` 文件描述了漏洞信息和修复建议。`AvailableURL.txt` 包含可能存在漏洞的URL列表，`keyword.txt` 包含用于查找Struts2应用的关键词。`cmd.py` 是一个Python POC脚本，用于发送包含恶意Content-Type的HTTP请求，从而执行命令。

投毒风险较低，约为 5%。 虽然 `AvailableURL.txt` 中包含一些URL，可能被用于测试，但是这些URL并非恶意代码。 POC本身是利用漏洞执行命令，但并不包含主动植入后门或其他恶意行为的代码，因此，主要风险在于使用者可能会将此POC用于非法用途。

**利用方式：**

1.  攻击者构造包含恶意OGNL表达式的Content-Type HTTP头，例如 `Content-Type: multipart/form-data; boundary="+#cmd=whoami"`。
2.  攻击者向存在漏洞的Struts2应用发送包含上述恶意HTTP头的请求。
3.  Struts2应用使用Jakarta Multipart parser解析请求，由于Content-Type中包含恶意OGNL表达式，解析过程中会执行该表达式。
4.  服务器执行攻击者指定的命令，并将结果返回给攻击者。

提供的 `cmd.py` 脚本就是通过构造包含恶意Content-Type的HTTP请求来利用该漏洞的。

**项目地址:** [jas502n/S2-045-EXP-POC-TOOLS](https://github.com/jas502n/S2-045-EXP-POC-TOOLS)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #15

**来源**: [CVE-2017-5638-jas502n_st2-046-poc.md](../2017/CVE-2017-5638-jas502n_st2-046-poc.md)

## CVE-2017-5638 - Apache Struts2 Jakarta Multipart parser RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且对外开放HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts2 Jakarta Multipart parser 中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于文件上传过程中，对Content-Type, Content-Disposition或Content-Length等HTTP头处理不当造成的。攻击者可以通过构造恶意的HTTP头，特别是Content-Type，包含 `#cmd=` 字符串，来执行任意命令。 

**利用方式：**

提供的`exploit-cd.sh`脚本利用了Content-Disposition header中的 filename 字段，通过插入 null byte (\x00) 来触发 `InvalidFileNameException`，并利用OGNL表达式执行命令。脚本首先设置 Content-Type 为 `multipart/form-data`，然后构造包含恶意 OGNL 表达式的 payload，并将其作为 filename 的值插入到 Content-Disposition 头中。最后，使用 curl 发送包含精心构造的 HTTP 头的 POST 请求到目标 URL。payload 中，首先清空了OgnlUtil的ExcludedPackageNames和ExcludedClasses，避免了沙箱限制，然后通过ProcessBuilder执行了命令。这个脚本的有效性较高，因为它直接针对了漏洞的利用点。 `reqnull.txt` 文件也是类似的利用，只不过是预先构造的包含payload的HTTP请求。

**投毒风险：**

分析了提供的`exploit-cd.sh` 脚本和 `reqnull.txt`文件，没有发现明显的投毒代码。脚本的功能是利用漏洞执行任意命令，这本身就是漏洞利用的目的。脚本中所有的操作都是为了构造 payload 并发送请求，没有发现任何隐藏的恶意行为。因此，评估投毒风险为0%。

**项目地址:** [jas502n/st2-046-poc](https://github.com/jas502n/st2-046-poc)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #16

**来源**: [CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md](../2017/CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md)

## CVE-2017-5638-Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并可以通过HTTP请求访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Aon、Trend Micro等）以及Exploit-DB提供的PoC，该漏洞的利用是有效的。在实际环境中，CVE-2017-5638被广泛利用，造成了包括Equifax数据泄露在内的大规模安全事件。

**投毒风险：**
提供的代码库主要侧重于实时异常检测，而非直接的漏洞利用。它通过分析HTTP请求的3-gram特征，并使用Count-Min Sketch和KL散度来检测异常流量。虽然代码本身看起来没有明显的后门，但仍存在一些潜在风险，例如：

*   **依赖风险：** `requirements.txt` 如果包含恶意的第三方库，可能存在投毒风险。但提供的`requirements.txt`文件为空，降低了直接依赖投毒的风险。
*   **数据投毒：** 攻击者可能通过精心构造正常流量，污染Count-Min Sketch，降低检测准确性。由于系统依赖正常流量建立基线，通过大量伪装成正常的恶意请求，可能影响检测。
*   **日志记录：** 系统将检测结果记录到`data/detection.log`，如果日志配置不当，可能导致信息泄露或者日志文件被篡改。

综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP请求。
2.  恶意OGNL表达式位于Content-Type、Content-Disposition或Content-Length等HTTP头中。
3.  当Struts处理multipart请求时，解析这些HTTP头。
4.  Struts框架会执行恶意OGNL表达式，从而导致远程代码执行。

**缓解措施：**
*   升级Apache Struts到安全版本（>=2.3.32或>=2.5.10.1）。
*   使用Web应用防火墙（WAF）过滤恶意请求。
*   部署入侵检测系统（IDS）监控异常流量。
*   实施严格的输入验证和输出编码。

**项目地址:** [joidiego/Detection-struts-cve-2017-5638-detector](https://github.com/joidiego/Detection-struts-cve-2017-5638-detector)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #17

**来源**: [CVE-2017-5638-jongmartinez_CVE-2017-5638.md](../2017/CVE-2017-5638-jongmartinez_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且可从外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成存在缺陷，允许攻击者通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞的 PoC 代码是有效的。搜索引擎结果中多个链接表明该漏洞曾被广泛利用，并造成了严重的安全事件，如 Equifax 数据泄露事件。PoC 代码通过构造特定的 HTTP 头部，利用 OGNL 表达式注入执行系统命令，从而控制服务器。

**投毒风险评估：**

提供的 PoC 代码主要功能是利用漏洞执行命令。投毒风险评估如下：

*   **README.md:** 描述了漏洞利用方式，提供用法示例，没有发现恶意代码。
*   **cve-2017-5638.py:**  
    *   代码结构清晰，功能明确，实现了漏洞利用的核心逻辑。
    *   使用了 `requests` 库发送 HTTP 请求，符合漏洞利用的需要。
    *   OGNL 表达式的构造较为复杂，但其目的是为了绕过安全限制并执行命令。
    *   对执行命令的结果进行输出。
    *  try...except 块处理了可能的请求错误，使得程序更加健壮。
    
虽然代码功能正常，但存在以下潜在风险：

*   **命令执行权限：**  如果目标服务器以高权限运行，攻击者可以通过该漏洞获取高权限，造成更大的危害。
*   **日志记录：**  恶意利用可能被服务器日志记录，但攻击者可以尝试清除日志来隐藏踪迹。
*   **依赖风险：**  `requests` 库本身可能存在安全漏洞，间接影响该 PoC 的安全性。

综合来看，该代码主要风险在于被滥用，利用漏洞攻击目标系统，本身包含作者恶意投毒代码的可能性较低。投毒风险评估为10%。

**利用方式分析：**

1.  **构造恶意 HTTP 头部：**  攻击者通过修改 HTTP 请求的 Content-Type 头部，插入包含恶意 OGNL 表达式的字符串。
2.  **OGNL 表达式注入：**  恶意 OGNL 表达式被 Struts2 框架解析和执行，绕过安全限制，获取执行系统命令的权限。
3.  **执行任意命令：**  攻击者可以通过 OGNL 表达式执行任意系统命令，例如下载恶意文件、反弹 Shell 等。
4.  **获取服务器控制权：**  通过执行系统命令，攻击者可以获取服务器的控制权，进行恶意操作，例如数据窃取、恶意软件传播等。

**项目地址:** [jongmartinez/CVE-2017-5638](https://github.com/jongmartinez/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #18

**来源**: [CVE-2017-5638-jptr218_struts_hack.md](../2017/CVE-2017-5638-jptr218_struts_hack.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于其在处理文件上传时存在异常处理和错误消息生成方面的缺陷，允许远程攻击者通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析如下：

1.  **有效性：** 提供的POC代码通过构造包含 OGNL 表达式的 Content-Type 头部，利用 Struts 框架的漏洞执行任意命令，该方法是有效的。搜索引擎结果和漏洞库信息均表明此漏洞是一个高危且被广泛利用的远程代码执行漏洞。

2.  **投毒风险：** 投毒风险较低，约为10%。虽然该仓库提供了一个预编译的exe文件，但exe文件是一个struts漏洞利用工具,功能上与漏洞库和搜索引擎信息一致,其源代码也被一并给出。潜在的风险在于：
    *   **预编译的二进制文件可能包含恶意代码。** 虽然提供了源代码，但用户在使用前通常不会仔细审计所有代码。
    *   **Payload生成逻辑** payload.cpp 中 OGNL 表达式的构造虽然直接，但也存在被篡改以执行恶意操作的可能性。

3.  **利用方式：**
    *   攻击者发送一个特制的 HTTP 请求到目标服务器，该请求的 Content-Type 头部包含一个 OGNL 表达式。
    *   Struts 框架在处理该请求时，会解析并执行该 OGNL 表达式。
    *   攻击者可以使用 OGNL 表达式来执行任意命令，例如，通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令，从而获取对服务器的控制权。
    *   POC代码中，telnet函数建立socket链接，并持续发送payload，从而建立telnet连接，进入控制台。

 4. **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jptr218/struts_hack](https://github.com/jptr218/struts_hack)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #19

**来源**: [CVE-2017-5638-jrrombaldo_CVE-2017-5638.md](../2017/CVE-2017-5638-jrrombaldo_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #20

**来源**: [CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md](../2017/CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md)

## CVE-2017-5638 Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-5638是Apache Struts Jakarta Multipart解析器中的一个漏洞，由于不正确的异常处理和错误消息生成，允许远程攻击者通过精心构造的Content-Type、Content-Disposition或Content-Length HTTP头执行任意命令。漏洞利用方式是通过在HTTP请求头中注入OGNL表达式，服务器在解析过程中会执行该表达式，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且存在多个可用的POC。提供的POC代码`Invoke-WebRequest -Uri "http://localhost:8080/" -Method POST -Headers @{ "Content-Type" = "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('AttackSuccessTestingRCE',2*2)}.multipart/form-data" }` 尝试通过修改Content-Type头来触发漏洞，并设置一个特定的header 'AttackSuccessTestingRCE' 来检测漏洞是否被成功利用，该代码能够达到漏洞检测效果，因此该POC有效。

**投毒风险：**
提供的两个文件，一个是PowerShell命令用于测试，另一个是Jupyter Notebook，其中定义了一个 Flask 应用来模拟存在漏洞的 Struts 应用，并检测 header 中是否存在恶意代码的特征。虽然这个 Flask 应用本身是为了演示漏洞，但如果直接部署到生产环境，可能存在潜在的风险。但是代码分析来看，没有明显的恶意代码。Demos.ipynb 中的检测恶意代码的逻辑 `SUSPICIOUS_PATTERNS = ["%{", "Runtime.getRuntime", "ProcessBuilder"]`，可以检测到OGNL表达式相关的Payload。因此投毒风险存在，但不是很高，大约20%。

**利用方式：**
攻击者通过发送包含恶意OGNL表达式的HTTP请求，该表达式被注入到Content-Type、Content-Disposition 或 Content-Length 等HTTP头中。Struts在处理Multipart请求时，由于使用了存在漏洞的Jakarta Multipart解析器，会尝试解析这些头，从而触发OGNL表达式的执行。攻击者可以利用OGNL表达式执行任意系统命令，例如下载恶意软件、修改系统配置或窃取敏感数据。

**项目地址:** [kaylertee/Computer-Security-Equifax-2017](https://github.com/kaylertee/Computer-Security-Equifax-2017)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #21

**来源**: [CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md](../2017/CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md)

## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #22

**来源**: [CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md](../2017/CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md)

## CVE-2017-5638 - Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts 2，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于不正确的异常处理和错误消息生成，远程攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 标头执行任意命令。攻击者通常会在 Content-Type 标头中包含 #cmd= 字符串。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确定此漏洞是有效的。大量的公开信息和可用的POC代码表明该漏洞已被广泛研究和利用。

**投毒风险：**
提供的代码包含两个文件：dorker.py 和 exploit.py。

*   **dorker.py：** 这是一个用于搜索引擎爬取的脚本，主要用于查找可能存在漏洞的Struts 2应用。它使用Google、Bing、Yahoo和Baidu等搜索引擎来搜索特定的dorks（搜索字符串）。该脚本本身不太可能包含恶意代码，因为它主要负责信息收集。
*   **exploit.py：** 该脚本包含实际的漏洞利用代码，用于向目标系统发送恶意请求以执行任意命令。虽然脚本的主要功能是利用漏洞，但仍然存在一定的投毒风险。风险点在于执行命令的部分，如果攻击者将恶意命令嵌入到脚本中，可能会对目标系统造成损害。例如，可以修改脚本以默认执行特定的恶意操作，或者在成功利用后植入后门。

因此，虽然 `exploit.py` 的主要目的是为了利用漏洞, 但依然需要谨慎检查其执行命令的部分。`dorker.py` 脚本本身不太可能包含恶意代码。综合分析，投毒风险评估为 10%。主要风险在于，如果下载来源不可信，下载的 `exploit.py` 文件可能已经被篡改，嵌入了恶意代码。

**利用方式：**
1.  **确定目标：** 使用 `dorker.py` 脚本或其他方法查找可能存在漏洞的 Apache Struts 2 应用。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本构造包含恶意 OGNL 表达式的 HTTP 请求。恶意表达式通常嵌入在 Content-Type 标头中。
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 Struts 2 应用。
4.  **执行命令：** 如果目标系统存在漏洞，恶意 OGNL 表达式将被执行，从而导致在服务器上执行任意命令。

**项目地址:** [leandrocamposcardoso/CVE-2017-5638-Mass-Exploit](https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #23

**来源**: [CVE-2017-5638-ludy-dev_XworkStruts-RCE.md](../2017/CVE-2017-5638-ludy-dev_XworkStruts-RCE.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，并且可以通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的POC代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者通过特制的HTTP头部执行任意命令，而搜索结果中也提供了大量的分析和利用案例。POC代码通过构造含有OGNL表达式的Content-Type头部，尝试在目标服务器上写入JSP后门，验证漏洞的存在。

**投毒风险分析：**

经过对提供的POC代码进行分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标服务器上创建一个JSP文件（k22mn7.jsp），实现webshell的功能，从而验证漏洞的存在和进行进一步的利用。代码本身逻辑比较清晰，没有发现隐藏的恶意行为。 投毒风险评估为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **构造恶意HTTP请求：** 攻击者需要构造一个包含恶意OGNL表达式的HTTP请求，特别是Content-Type头部。该表达式会被Struts2框架解析执行。
2.  **利用OGNL执行代码：** 恶意OGNL表达式用于在目标服务器上执行任意代码。常见的利用方式是在服务器上写入一个webshell，或者直接执行系统命令。
3.  **访问webshell：** 如果成功写入webshell，攻击者可以通过访问webshell来控制目标服务器。 

POC代码中的OGNL表达式尝试在服务器的`/k22mn7.jsp`处写入一个JSP后门，以便进一步控制。该POC首先尝试清除ognlUtil的排除列表，然后从输入流拷贝内容到`/k22mn7.jsp`，最后输出`upload_ok`。

漏洞利用的关键在于构造能够绕过Struts2安全机制的恶意OGNL表达式，并将其插入到HTTP头部中。

**项目地址:** [ludy-dev/XworkStruts-RCE](https://github.com/ludy-dev/XworkStruts-RCE)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #24

**来源**: [CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md](../2017/CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #25

**来源**: [CVE-2017-5638-mritunjay-k_CVE-2017-5638.md](../2017/CVE-2017-5638-mritunjay-k_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #26

**来源**: [CVE-2017-5638-mthbernardes_strutszeiro.md](../2017/CVE-2017-5638-mthbernardes_strutszeiro.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过在Content-Type、Content-Disposition或Content-Length HTTP头中构造恶意OGNL表达式来执行任意命令。

**有效性分析：**
漏洞库信息、搜索引擎结果以及提供的漏洞利用代码都表明这是一个真实且高危的漏洞。搜索引擎结果中包含了漏洞的详细描述、利用方式以及受影响的版本。提供的漏洞利用代码是一个Telegram Bot，用于管理利用该漏洞创建的僵尸网络。该Bot通过Telegram命令来添加受害者服务器、执行命令等，进一步验证了漏洞的可利用性。

**投毒风险分析：**
该漏洞利用代码（strutszeiro.py及其相关文件）的投毒风险较低，约为10%。 主要风险点如下：

*   **配置文件：** `conf/token.conf` 和 `conf/group.conf` 存储了Telegram Bot的API Token和群组ID。如果攻击者控制了这些配置文件，他们可以窃取bot控制权，监控所有受害者服务器。
*   **actions.py:**botnet 方法中 cmd 的命令未校验，存在一定风险。
*  **strutszeiro.py:** 判断 chat_type 是否为 'group' ，存在一定风险，如果攻击者知道了bot token，私聊也能控制该bot。

代码本身的主要功能是利用Struts2漏洞进行远程命令执行，没有发现明显的后门或恶意代码。但是，用户需要谨慎配置Telegram Bot，并保护好API Token，防止泄露。

**利用方式：**

1.  **漏洞触发：** 攻击者发送包含恶意OGNL表达式的HTTP请求到存在漏洞的Struts2服务器。通常，这个表达式位于Content-Type头部，利用Jakarta Multipart parser的解析过程。
2.  **命令执行：** Struts2服务器在解析请求头时，会执行OGNL表达式，导致任意命令执行。
3.  **僵尸网络控制：** 提供的漏洞利用代码构建了一个Telegram Bot，攻击者可以通过该Bot远程控制受影响的服务器。
4.  **Telegram Bot命令：** 攻击者可以通过Telegram命令添加新的受害者服务器（`/add url`），在特定服务器上执行命令（`/exploit url *cmd`），在所有受害者服务器上执行命令（`/botnet cmd`），以及列出所有受害者服务器（`/list`）。

**项目地址:** [mthbernardes/strutszeiro](https://github.com/mthbernardes/strutszeiro)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #27

**来源**: [CVE-2017-5638-readloud_CVE-2017-5638.md](../2017/CVE-2017-5638-readloud_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #28

**来源**: [CVE-2017-5638-sighup1_cybersecurity-struts2.md](../2017/CVE-2017-5638-sighup1_cybersecurity-struts2.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头，特别是 Content-Type 头，其中包含 '#cmd=' 字符串，来执行任意命令。

**有效性：**
提供的 PoC 代码利用了 OGNL 表达式注入，通过修改 Content-Type 头来执行系统命令。根据漏洞库信息、搜索结果和 PoC 代码描述，该漏洞的利用方式是有效的。

**投毒风险：**
该仓库存在一定的投毒风险，评估约为10%。理由如下：
*   **免责声明：**仓库包含免责声明，这可能是为了规避潜在的法律责任，但并不能完全排除恶意目的。仓库作者声明“This is meant for educational, and research purposes only. I do not authorize or endorse any illegal or unethical use of this projects contents or information”，可能存在诱导使用者进行非法用途。
*   **不透明性：** 仓库作者在payload中调用了自定义的edu.uvu.ms.cybersecurity.Command类。如果没有对edu.uvu.ms.cybersecurity.Command类进行仔细的代码审计，可能存在恶意代码。如果 Command 类做了超出描述之外的事情（例如，记录命令、尝试提权、扫描网络等），那就存在风险。代码示例中， (#p.print('hello from MSCybersecurity'))这部分可能被替换为更具危害性的操作。
*   **依赖性：** PoC 需要 Send.jar。如果 Send.jar 来源不明或者被篡改，则可能存在安全风险。
*   **复杂性：** OGNL 表达式本身就非常复杂，容易隐藏恶意代码。 即使 payload 中的大部分逻辑看起来是良性的（例如，设置 Content-Type、清理 excludedPackageNames 等）， 仍然可能存在隐藏的、难以察觉的恶意代码片段。
*   **利用普及程度：**由于该漏洞影响广泛，并且利用代码已经公开，攻击者可以修改或者添加恶意代码，伪装成正常的 PoC，传播恶意软件或后门。

**利用方式：**
1.  攻击者发送一个特制的 HTTP 请求，该请求的 Content-Type 头包含恶意的 OGNL 表达式。
2.  Struts2 框架的 Jakarta Multipart parser 在处理该请求时，由于异常处理不当，会将 OGNL 表达式传递给 OGNL 引擎。
3.  OGNL 引擎执行该表达式，导致任意代码执行。
4.  PoC 代码展示了如何通过 OGNL 表达式来实例化 Java 类、调用方法和执行系统命令。
5.  攻击者利用该漏洞可以在服务器上执行任意命令，从而获取敏感信息、篡改数据或完全控制服务器。

**项目地址:** [sighup1/cybersecurity-struts2](https://github.com/sighup1/cybersecurity-struts2)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #29

**来源**: [CVE-2017-5638-sonatype-workshops_struts2-rce.md](../2017/CVE-2017-5638-sonatype-workshops_struts2-rce.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-5638 是 Apache Struts 2 的一个远程代码执行漏洞，源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析：

*   **Dockerfile:** 该文件用于构建包含存在漏洞的 Struts 2 应用的 Docker 镜像。它基于 tomcat:7 镜像，并将 struts2-rest-showcase.war 部署到 Tomcat 的 webapps 目录下，暴露了8080端口。这本身不是漏洞利用代码，而是漏洞测试环境的准备。
*   **Jenkinsfile:** 该文件定义了 Jenkins 构建流程，包括代码检出、Maven 构建和 Nexus Lifecycle Evaluation。它使用 Maven 打包 Struts 2 应用，但没有直接的漏洞利用代码。其中`nexusPolicyEvaluation` 可能存在风险，通过配置`iqApplication`应用ID，可能可以对应用进行安全分析。
*   **LICENSE.txt:** Apache 2.0 许可协议。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞利用的POC是存在的，并且在野外被广泛利用。提供的Dockerfile 可以搭建一个存在漏洞的环境， Jenkinsfile 是项目的构建文件，二者结合可以认为该漏洞是可以复现和利用的

**投毒风险：**
虽然提供的代码片段主要用于构建和部署存在漏洞的 Struts 2 应用，并没有明显的恶意代码。但是`Jenkinsfile`文件中的`nexusPolicyEvaluation` 可能存在风险， 通过配置恶意`iqApplication`应用ID,对构建的应用投毒，但是概率较低.

**利用方式：**
攻击者通常会发送一个包含恶意构造的 Content-Type 头部（例如，包含 `#cmd=` 字符串）的 HTTP 请求。这个恶意头部会触发 Struts 2 中的 OGNL 表达式注入，从而允许攻击者执行任意命令。具体的利用方式包括：

1.  发送包含恶意 Content-Type 头部的 HTTP 请求。
2.  利用 OGNL 表达式执行系统命令。
3.  获取服务器的控制权。

**项目地址:** [sonatype-workshops/struts2-rce](https://github.com/sonatype-workshops/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #30

**来源**: [CVE-2017-5638-tahmed11_strutsy.md](../2017/CVE-2017-5638-tahmed11_strutsy.md)

## CVE-2017-5638 Apache Struts 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.5-2.3.31, 2.5-2.5.10

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，并且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts框架中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传请求时，由于Content-Type头信息解析错误，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头信息，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞是有效的。搜索结果中提到该漏洞被广泛利用，并导致了严重的安全事件，例如Equifax数据泄露事件。提供的Python代码是一个POC，可以用于验证和利用该漏洞。

**投毒风险：**
虽然代码看起来是直接的漏洞利用程序，但是仍然存在一定的投毒风险。以下是风险评估和分析：
*   **网络请求依赖:** 代码依赖 `urllib2`，需要能够访问互联网。攻击者可能会修改代码，使其在特定条件下向恶意服务器发送敏感信息，或者从恶意服务器下载payload执行。这个风险较低，因为基本功能是命令执行。
*   **命令执行：** POC代码允许执行任意命令。如果该代码被修改并分发，攻击者可以将恶意命令硬编码到POC中，从而感染所有使用修改后POC的用户。
*   **Blind Injection 的依赖:** 代码中的blind injection依赖于外部IP并且需要apache可以读取log文件。此过程可能存在后门代码，但是需要进一步分析，才能判断。

 总体来说，该仓库中存在作者隐藏投毒代码的风险较低，大概在10%左右。 主要风险在于使用者不清楚代码逻辑，直接修改其中的cmd参数。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，特别是Content-Type头。
2.  当Struts应用解析该请求时，恶意OGNL表达式会被执行。
3.  攻击者可以利用OGNL表达式执行任意系统命令，例如反弹shell，上传恶意文件等。
4.  提供的POC代码利用了这一漏洞，通过修改Content-Type头，在目标服务器上执行指定的命令。


**项目地址:** [tahmed11/strutsy](https://github.com/tahmed11/strutsy)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #31

**来源**: [CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md](../2017/CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #32

**来源**: [CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md](../2017/CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #33

**来源**: [CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md](../2017/CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md)

# CVE-2017-5638

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-5638-Badbird3_CVE-2017-5638.md](../2017/CVE-2017-5638-Badbird3_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #2

**来源**: [CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md](../2017/CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是一个 Apache Struts2 的远程代码执行漏洞，存在于 Jakarta Multipart parser 中。由于不正确的异常处理和错误消息生成，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头来执行任意命令。从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞利用的有效性非常高，因为在2017年3月已经被广泛利用。漏洞利用代码中的`CVE-2017-5638ApacheStruts.py`脚本通过构造包含OGNL表达式的Content-Type头来触发漏洞，从而执行任意命令。利用方式是通过发送一个精心构造的HTTP请求，其中Content-Type头包含一个OGNL表达式，该表达式允许攻击者执行任意系统命令。

**有效性:**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的有效性非常高，且POC代码能够复现。

**投毒风险:**
POC代码主要功能是发送恶意请求并执行命令。虽然存在一定的风险（例如，命令执行不当导致系统不稳定），但不存在明显的恶意投毒代码。代码结构较为清晰，主要包含参数解析、payload生成和请求发送三个部分。代码中可能的风险点在于，攻击者可以利用此代码执行任意命令，因此存在滥用的风险。但代码本身的功能是为了验证漏洞，并无主动传播恶意代码的功能。我给出的投毒风险评估为5%，主要考虑是：

*   代码作者可能会在代码中添加一些隐藏的后门代码，例如，收集目标服务器的信息并发送到攻击者的服务器，或者在目标服务器上安装恶意软件。
*   代码用户可能会在使用代码时，不小心执行了恶意命令，从而导致系统被入侵。

**利用方式:**
1.  **目标确定:** 确定目标服务器上运行的Apache Struts2版本是否在受影响范围内（2.3.x before 2.3.32 或 2.5.x before 2.5.10.1）。
2.  **Payload构造:** 使用POC代码中的`creating_payload`函数构造包含恶意命令的OGNL表达式payload。 例如：要执行 `whoami` 命令，使用 `-c whoami` 参数。
3.  **请求发送:** 使用POC代码中的`execute`函数，将构造好的payload作为Content-Type头的值，发送HTTP请求到目标服务器的`.action`文件。POC代码会打印命令执行的结果。
4.  **结果分析:** 分析命令执行的结果，判断漏洞是否成功利用。

总而言之，该漏洞利用代码的有效性高，但存在较低的投毒风险。使用时务必谨慎，并确保在授权的环境下进行。


**项目地址:** [FredBrave/CVE-2017-5638-ApacheStruts2.3.5](https://github.com/FredBrave/CVE-2017-5638-ApacheStruts2.3.5)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #3

**来源**: [CVE-2017-5638-Iletee_struts2-rce.md](../2017/CVE-2017-5638-Iletee_struts2-rce.md)

## CVE-2017-5638-Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且可通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理不当。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2017-5638是一个被广泛利用的漏洞。存在公开可用的PoC代码，并且Metasploit框架中也存在利用模块，因此该漏洞的利用有效性很高。

提供的Dockerfile和Jenkinsfile用于构建和部署一个Struts2应用，但本身不包含漏洞利用代码。而是提供了一个包含漏洞的Struts2环境，方便演示和复现。

**投毒风险：**

虽然提供的Dockerfile和Jenkinsfile本身不包含明显的恶意代码，但存在一定的投毒风险：

*   **依赖风险：** Dockerfile中使用了`tomcat:7`镜像，存在该镜像可能包含已知漏洞的风险。Jenkinsfile中maven deploy可能会将构建的组件上传到外部maven仓库，若该仓库被入侵，则存在组件投毒的风险
*   **间接投毒：** Dockerfile中的`COPY target/struts2-rest-showcase.war /usr/local/tomcat/webapps/ROOT.war`，如果`struts2-rest-showcase.war`本身被替换为包含恶意代码的版本，则可能造成投毒。Jenkinsfile拉取的scm如果被恶意人员修改，则存在投毒风险。
*   **Jenkinsfile风险:** Jenkinsfile 中的`postGitHub` 函数，使用了github api token，若该token泄露，则可能导致项目代码被篡改。

综合评估，投毒风险大约为10%，主要来自于依赖风险和构建过程中的潜在恶意代码注入。

**利用方式：**

利用CVE-2017-5638漏洞的典型方式如下：

1.  **构造恶意HTTP请求：**  攻击者构造包含恶意Ognl表达式的Content-Type头部的HTTP请求。
2.  **发送请求：**  将构造好的HTTP请求发送到存在漏洞的Struts2服务器。
3.  **远程代码执行：**  Struts2服务器解析Content-Type头部时，会执行其中的恶意Ognl表达式，从而导致远程代码执行。

攻击者可以通过远程代码执行在服务器上执行任意命令，例如反弹shell、读取敏感文件、修改系统配置等。

一些公开的PoC利用了`#cmd=`字符串来执行系统命令，如`Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW; #cmd=whoami`



**项目地址:** [Iletee/struts2-rce](https://github.com/Iletee/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #4

**来源**: [CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md](../2017/CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且对外开放HTTP端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是 Apache Struts 2 Jakarta Multipart parser 中的一个远程代码执行漏洞。该漏洞是由于在文件上传过程中，对Content-Type、Content-Disposition或Content-Length HTTP header处理不当造成的，攻击者可以通过构造恶意的HTTP头部，利用OGNL表达式注入执行任意命令。

**有效性：** 根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索引擎结果中包含多个关于CVE-2017-5638的PoC和分析，说明该漏洞已经被广泛研究和利用。POC代码通过构造包含恶意OGNL表达式的Content-Type头部，发送POST请求到存在漏洞的Apache Struts2应用，从而执行任意命令。

**投毒风险：**  分析提供的`exploit.py.txt`和`README.md`文件。`README.md`文件只是漏洞利用说明，不包含任何代码。`exploit.py.txt` 文件中的Python代码用于利用 CVE-2017-5638 漏洞。代码首先定义了目标URL和包含恶意 OGNL 表达式的 payload。Payload 构造了一个命令执行的 OGNL 表达式，并在目标系统上执行 `ls /` 命令，将输出返回到响应中。然后，它使用 `requests` 库发送一个包含恶意 header 的 POST 请求到目标 URL。代码没有发现任何隐藏的或恶意的后门或投毒代码。payload 的目的是执行命令，而不是植入长期存在的恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **构造恶意HTTP头部：** 攻击者构造包含恶意OGNL表达式的Content-Type、Content-Disposition或Content-Length HTTP头部。在该POC中，恶意代码位于Content-Type头中。
2.  **发送请求：** 攻击者将构造好的HTTP请求发送到存在漏洞的Apache Struts2应用。
3.  **命令执行：** Struts2应用在处理请求时，由于错误的异常处理和错误消息生成，会将恶意OGNL表达式解析并执行，从而导致远程代码执行。在该POC中，执行了`ls /`命令。
4.  **获取结果：** 攻击者从HTTP响应中获取命令执行的结果。

**项目地址:** [MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION](https://github.com/MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #5

**来源**: [CVE-2017-5638-Nithylesh_web-application-firewall-.md](../2017/CVE-2017-5638-Nithylesh_web-application-firewall-.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性:**
提供的`vulnerable.py`脚本可以有效利用此漏洞，通过设置恶意的`Content-Type`头，向目标服务器发送包含OGNL表达式的HTTP请求，从而执行任意命令。

**投毒风险:**
仓库中存在投毒代码的风险较低，约10%。分析如下：
  * `server.py`文件模拟了一个简单的WAF，但其阻止模式相当基础，可能被绕过。
  * `vulnerable.py`脚本是漏洞利用的核心，其本身的目的就是执行任意命令，这使得判断其中是否包含恶意代码变得困难。尽管如此，脚本逻辑相对清晰，主要是构造payload发送请求并打印响应。但是依旧存在以下情况:
  * 存在隐藏的反向shell或者其他恶意指令的可能，但需要进一步分析才能确定。

**利用方式:**
1.  攻击者发送特制的HTTP请求，该请求的`Content-Type`头包含恶意的OGNL表达式。
2.  Struts2框架在处理multipart请求时，会解析`Content-Type`头。
3.  由于漏洞存在，OGNL表达式会被执行，从而在服务器上执行攻击者指定的命令。
4.  `vulnerable.py` 脚本通过 `check_vulnerability` 和 `execute_command` 函数展示了如何构造包含恶意OGNL表达式的 `Content-Type` 头并发送请求。

**优先级排序理由:**
搜索引擎结果提供了漏洞的基本信息和利用场景，但漏洞利用代码 `vulnerable.py` 更为关键，因为它直接展示了漏洞的利用方式。漏洞库信息作为补充，提供了漏洞影响的版本范围和基本描述。


**项目地址:** [Nithylesh/web-application-firewall-](https://github.com/Nithylesh/web-application-firewall-)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #6

**来源**: [CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md](../2017/CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且允许通过HTTP请求与目标交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞存在于 Jakarta Multipart parser 中，由于其在处理文件上传时的异常处理和错误消息生成不正确导致。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头，在服务器上执行任意命令。

**有效性：**

提供的PoC代码通过修改Content-Type头部，利用OGNL表达式注入恶意代码，从而实现远程代码执行。根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，因此PoC代码的有效性较高。

**投毒风险：**

PoC 代码本身是为了利用漏洞而编写的，其目的是执行任意命令。 从提供的代码来看，核心功能是构造包含恶意 OGNL 表达式的 HTTP 头部。
代码通过 Content-Type 注入 OGNL 表达式，该表达式首先获取 OgnlContext，然后清空了 OGNL 的黑名单，以便执行任意代码。接着，它使用 java.lang.ProcessBuilder 执行指定的命令，并将命令执行的结果返回。

综合分析，PoC 代码的功能是利用漏洞，而不是植入后门或进行其他恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  攻击者发送一个包含恶意Content-Type HTTP头的请求到目标服务器。
2.  恶意Content-Type头中包含OGNL表达式，该表达式能够执行任意系统命令。
3.  Struts2框架解析该请求时，会执行OGNL表达式，从而导致远程代码执行。
4.  攻击者通过执行系统命令，可以获取服务器的控制权。

**总结：**

CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单，影响广泛。提供的PoC代码可以有效利用该漏洞。该PoC代码本身没有投毒风险，但攻击者可以利用该PoC代码攻击未修复的Struts2应用。

**项目地址:** [QHxDr-dz/CVE-2017-5638](https://github.com/QHxDr-dz/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #7

**来源**: [CVE-2017-5638-Tankirat_CVE-2017-5638.md](../2017/CVE-2017-5638-Tankirat_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许通过HTTP进行访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 框架的 Jakarta Multipart parser 中。当处理文件上传时，由于异常处理和错误消息生成不当，攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部来执行任意命令。在野外攻击中，通常使用包含 `#cmd=` 字符串的 Content-Type 头部。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的PoC。漏洞利用代码描述了漏洞原理和利用方法，表明该漏洞的有效性较高。

**投毒风险：**
提供的漏洞利用代码（`/tmp/3bf1e344cbece4d19a9e8c32c2245913/README.md`） 主要是漏洞的介绍文档，描述了漏洞的原理、影响、利用方法、案例分析（Equifax 数据泄露），以及预防措施和参考链接。其中虽然引用了github上漏洞扫描工具，但本身readme文件不具备可执行的攻击代码。所以投毒风险较低，但不能完全排除作者通过其他方式进行投毒，比如在引用的链接中做手脚。所以评定投毒风险为10%。

**利用方式：**
1.  攻击者发送包含恶意构造的 HTTP 头部（例如，Content-Type）的请求到存在漏洞的 Apache Struts 应用。
2.  恶意的 HTTP 头部包含 Object-Graph Navigation Language (OGNL) 表达式。
3.  Struts 应用在解析 HTTP 头部时，会将 OGNL 表达式传递给 `LocalizedTextUtil.findText` 函数进行处理。
4.  `LocalizedTextUtil.findText` 函数会将 `${...}` 中的内容解释为 OGNL 表达式并执行。
5.  攻击者可以通过 OGNL 表达式执行任意系统命令，从而实现远程代码执行。

攻击成功的关键在于构造包含恶意 OGNL 表达式的 HTTP 头部，例如 `Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','vuln')}`。其中OGNL表达式可以执行任意命令，获取敏感信息，或者植入后门。

该漏洞曾被广泛利用，导致了包括 Equifax 数据泄露在内的多起重大安全事件。

**项目地址:** [Tankirat/CVE-2017-5638](https://github.com/Tankirat/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #8

**来源**: [CVE-2017-5638-Xernary_CVE-2017-5638-POC.md](../2017/CVE-2017-5638-Xernary_CVE-2017-5638-POC.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标服务器运行存在漏洞版本的Apache Struts2，且允许POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，由于错误处理和错误消息生成不当，导致攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头来执行任意命令。根据提供的漏洞库信息，漏洞的利用方式是通过在Content-Type头中包含 '#cmd=' 字符串来执行命令，并根据搜索结果确认该漏洞已被广泛利用。

**有效性：**
提供的`exploit.py`脚本通过构造包含OGNL表达式的Content-Type头来实现远程代码执行。该表达式利用OGNL绕过安全限制，执行指定的命令并将结果返回。该PoC代码的逻辑是正确的，并且与漏洞描述相符，因此有效。

**投毒风险：**
审查提供的 Dockerfile 和脚本，可以发现潜在的投毒风险。
*   `server-setup-script.sh`: 该脚本从华为云镜像下载了JDK 8u171，但是考虑到华为云镜像可能已经发生了变更（被投毒），因此存在一定的风险。此外，该脚本中没有检查下载的JDK的完整性，如果下载过程中被篡改，可能导致系统被植入后门。`pwn-page.jsp` 在服务器遭受攻击后会部署该页面。
* `exploit.py`，该脚本本身没有包含明显的恶意代码，但如果被攻击者修改，例如在执行命令之前添加下载和执行恶意文件的功能，也可能成为投毒的途径。`startup.sh` 这个脚本仅仅是用来启动 tomcat 服务。并且Dockerfile 最终启动的命令是 `CMD ["sh", "-c", "./startup.sh && bash"]`， 该命令会启动一个交互式的shell。

因此，综合评估投毒风险大约为10%。虽然没有发现直接的、明显的投毒代码，但是下载的外部资源以及执行流程存在被利用的潜在风险，需要谨慎对待。

**利用方式：**
1.  攻击者发送一个精心构造的HTTP POST请求到存在漏洞的Struts2服务器。
2.  该请求的Content-Type头包含一个恶意的OGNL表达式，该表达式利用Struts2的OGNL解析器执行任意命令。
3.  服务器执行该命令，并将结果返回给攻击者。

**总结：**
CVE-2017-5638 是一个严重的安全漏洞，利用简单，危害巨大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [Xernary/CVE-2017-5638-POC](https://github.com/Xernary/CVE-2017-5638-POC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #9

**来源**: [CVE-2017-5638-andypitcher_check_struts.md](../2017/CVE-2017-5638-andypitcher_check_struts.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP header，在服务器上执行任意命令。漏洞根源在于Struts2对Content-Type等header的处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个真实存在的且已被广泛利用的高危漏洞。网上存在大量的PoC代码，表明其有效性。

**投毒风险：**
提供的代码片段是一个GNU GPL v3许可协议。单独从这个LICENSE文件无法判断是否存在投毒代码，需要检查完整的漏洞利用程序。
然而，考虑到漏洞利用的性质（远程代码执行），如果攻击者能够控制漏洞利用代码，他们可以嵌入恶意代码，例如：

*   **植入后门：** 在目标系统上安装后门，以便长期控制。
*   **数据窃取：** 窃取目标系统上的敏感数据。
*   **恶意软件传播：** 将目标系统作为传播恶意软件的跳板。
*   **破坏系统：** 删除关键文件或使系统崩溃。

因此，在使用任何来自不可信来源的漏洞利用代码时，都必须非常谨慎，进行详细的代码审计，确保没有恶意行为。这里给出的“投毒风险”评估为10%，主要因为提供的代码段本身只是LICENSE信息，无法确定完整利用代码的安全性。需要对实际使用的利用代码进行更细致的分析。

**利用方式：**
利用方式主要通过以下步骤：

1.  **确定目标：** 确定运行存在漏洞的Apache Struts2版本的服务器。
2.  **构造恶意HTTP请求：** 构造包含恶意OGNL表达式的HTTP请求，通常在Content-Type header中，例如`Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getHeader('cmd')}`。`cmd` header 包含要执行的系统命令。
3.  **发送请求：** 将构造好的HTTP请求发送到目标服务器。
4.  **执行命令：** Struts2解析HTTP请求时，会执行恶意OGNL表达式，从而在服务器上执行攻击者指定的命令。

例如，攻击者可以使用curl命令发送包含恶意Content-Type header的请求：

```bash
curl -H 'Content-Type: %{#context["com.opensymphony.xwork2.dispatcher.HttpServletRequest"].map.class.forName("java.lang.Runtime").getRuntime().exec("id")}' http://target.com/example.action
```

此命令会在目标服务器上执行`id`命令，并将结果返回给攻击者。

总而言之，CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单且影响严重，需要及时修复。

**项目地址:** [andypitcher/check_struts](https://github.com/andypitcher/check_struts)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #10

**来源**: [CVE-2017-5638-colorblindpentester_CVE-2017-5638.md](../2017/CVE-2017-5638-colorblindpentester_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638（也称为S2-045）是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，此漏洞是有效的。搜索结果中包含了大量关于CVE-2017-5638的分析、利用和修复信息，表明这是一个真实且影响广泛的漏洞。PoC代码的存在进一步证实了其可利用性。

**投毒风险：**
提供的PoC代码本身就是利用该漏洞的脚本。要确定是否存在投毒风险，需要检查代码中是否存在恶意行为，例如下载和执行其他文件、篡改系统配置等。检查了给定的struts2_S2-045.py代码，它主要功能是构造payload执行命令，并没有发现明显的恶意投毒代码。虽然该代码可以用来执行任意命令，但这本身就是漏洞利用的目的，而不是额外添加的恶意功能。考虑到README.md文件极其简单，整个仓库并没有其他可疑文件，因此投毒风险较低，给出的估计值为5%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Jakarta Multipart parser处理HTTP请求头时。具体来说，当Struts2应用程序尝试解析包含恶意表达式的Content-Type头时，会导致OGNL表达式执行。
2.  **Payload构造：** 攻击者构造包含OGNL表达式的Content-Type头。该表达式利用Struts2的OGNL机制来绕过安全限制，并执行任意命令。
3.  **命令执行：** OGNL表达式首先获取对`OgnlContext`的引用，然后绕过默认的成员访问限制。接着，它使用`java.lang.ProcessBuilder`类来执行指定的命令。PoC中包含了针对Windows和Linux系统的不同命令执行方式。
4.  **结果返回：** 执行命令的结果通过`ServletActionContext.getResponse().getOutputStream()`获取输出流，并将命令执行的结果写入到HTTP响应中，返回给攻击者。

简单来说，利用方式就是通过精心构造的HTTP请求头，向存在漏洞的Struts2应用程序发送恶意payload，从而在服务器上执行任意命令。

**项目地址:** [colorblindpentester/CVE-2017-5638](https://github.com/colorblindpentester/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #11

**来源**: [CVE-2017-5638-haxerr9_CVE-2017-5638.md](../2017/CVE-2017-5638-haxerr9_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #12

**来源**: [CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md](../2017/CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许通过HTTP header传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 漏洞存在于Apache Struts2框架的Jakarta Multipart parser中，由于其在处理文件上传时的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP header来执行任意命令。

**有效性：**
提供的PoC代码是有效的，但它是一个安全的演示版本。它通过在Content-Type header中注入OGNL表达式，尝试设置一个自定义的HTTP响应头（X-Vuln）。如果服务器返回的响应中包含此header，则表示目标服务器可能存在漏洞。此PoC**不会**执行任何实际的恶意命令。

**投毒风险：**
分析了PoC代码和README文件，该仓库的目的是安全地演示该漏洞，而没有包含任何隐藏的或恶意的代码。没有发现任何投毒代码。因此, 投毒风险为 0%。

**利用方式：**
1.  **漏洞原理：** Struts2 使用Jakarta Multipart parser处理multipart请求，Content-Type头信息会被解析。如果Content-Type的值中包含OGNL表达式，并且OGNL表达式解析被启用，攻击者就可以利用OGNL表达式执行任意代码。
2.  **攻击方式：** 攻击者构造包含恶意OGNL表达式的Content-Type header，并发送给存在漏洞的Struts2服务器。
3.  **执行结果：** 服务器解析Content-Type header中的OGNL表达式，执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **PoC利用：** 提供的PoC利用代码通过发送包含`%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Vuln','Vulnerable')}`的Content-Type头来判断是否存在漏洞，成功则表示可能存在漏洞。

**项目地址:** [iampetru/PoC-CVE-2017-5638](https://github.com/iampetru/PoC-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #13

**来源**: [CVE-2017-5638-injcristianrojas_cve-2017-5638.md](../2017/CVE-2017-5638-injcristianrojas_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32 和 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且接受HTTP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 中的一个远程代码执行漏洞，存在于 Jakarta Multipart parser 中。当 Struts2 尝试处理文件上传时，如果 Content-Type、Content-Disposition 或 Content-Length HTTP 头部被恶意构造，将导致异常处理和错误消息生成过程出现问题，进而允许攻击者执行任意命令。

**漏洞利用方式：**

漏洞利用主要通过构造恶意的 Content-Type 头部，其中包含 OGNL 表达式。 OGNL（Object-Graph Navigation Language）是一种强大的表达式语言，用于访问和操作 Java 对象的属性。 攻击者通过在 Content-Type 头部中注入恶意的 OGNL 表达式，利用 Struts2 在解析请求时的漏洞，执行任意系统命令。

提供的漏洞利用代码包含两个 Python 脚本 (exploit1.py 和 exploit2.py)。

*   **exploit1.py:**  尝试通过在 Content-Type 中注入 OGNL 表达式，添加一个名为 "PWNED" 的 HTTP 头部，其值为 1337。这可以用来验证漏洞是否存在。
*   **exploit2.py:**  允许攻击者指定要执行的命令。 它构造一个更复杂的 OGNL 表达式，绕过某些安全限制，并使用 `java.lang.ProcessBuilder` 执行指定的命令，然后将命令的输出返回到 HTTP 响应中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞已经被广泛利用，提供的 POC 代码与已知的攻击方式一致，因此可以判断 POC 代码有效。

**投毒风险：**

提供的代码仓库包含一个 Jenkinsfile, 用于通过OWASP Dependency Check Plugin进行依赖检查, 这本身不属于投毒行为。 exploit1.py 和 exploit2.py 是利用漏洞的代码，也不构成投毒。仓库结构和代码内容来看，存在恶意投毒的可能性较低，约 5% 的可能性在于作者可能在其他未展示的文件中隐藏恶意代码，或者存在依赖污染的风险。总体而言，直接利用该仓库进行投毒的可能性较低，但仍需谨慎使用，建议在使用前进行详细的代码审计。

**项目地址:** [injcristianrojas/cve-2017-5638](https://github.com/injcristianrojas/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #14

**来源**: [CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md](../2017/CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可直接控制服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行受影响版本的Apache Struts2，并且存在文件上传功能或使用了Jakarta Multipart parser

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 框架中的一个远程代码执行漏洞，该漏洞源于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的POC是有效的。漏洞库和搜索结果都表明这是一个被广泛利用的漏洞，多个安全厂商和研究人员都发布了相关的分析和利用方法。

**投毒风险：**

分析提供的代码仓库内容，`README.md` 文件描述了漏洞信息和修复建议。`AvailableURL.txt` 包含可能存在漏洞的URL列表，`keyword.txt` 包含用于查找Struts2应用的关键词。`cmd.py` 是一个Python POC脚本，用于发送包含恶意Content-Type的HTTP请求，从而执行命令。

投毒风险较低，约为 5%。 虽然 `AvailableURL.txt` 中包含一些URL，可能被用于测试，但是这些URL并非恶意代码。 POC本身是利用漏洞执行命令，但并不包含主动植入后门或其他恶意行为的代码，因此，主要风险在于使用者可能会将此POC用于非法用途。

**利用方式：**

1.  攻击者构造包含恶意OGNL表达式的Content-Type HTTP头，例如 `Content-Type: multipart/form-data; boundary="+#cmd=whoami"`。
2.  攻击者向存在漏洞的Struts2应用发送包含上述恶意HTTP头的请求。
3.  Struts2应用使用Jakarta Multipart parser解析请求，由于Content-Type中包含恶意OGNL表达式，解析过程中会执行该表达式。
4.  服务器执行攻击者指定的命令，并将结果返回给攻击者。

提供的 `cmd.py` 脚本就是通过构造包含恶意Content-Type的HTTP请求来利用该漏洞的。

**项目地址:** [jas502n/S2-045-EXP-POC-TOOLS](https://github.com/jas502n/S2-045-EXP-POC-TOOLS)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #15

**来源**: [CVE-2017-5638-jas502n_st2-046-poc.md](../2017/CVE-2017-5638-jas502n_st2-046-poc.md)

## CVE-2017-5638 - Apache Struts2 Jakarta Multipart parser RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且对外开放HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts2 Jakarta Multipart parser 中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于文件上传过程中，对Content-Type, Content-Disposition或Content-Length等HTTP头处理不当造成的。攻击者可以通过构造恶意的HTTP头，特别是Content-Type，包含 `#cmd=` 字符串，来执行任意命令。 

**利用方式：**

提供的`exploit-cd.sh`脚本利用了Content-Disposition header中的 filename 字段，通过插入 null byte (\x00) 来触发 `InvalidFileNameException`，并利用OGNL表达式执行命令。脚本首先设置 Content-Type 为 `multipart/form-data`，然后构造包含恶意 OGNL 表达式的 payload，并将其作为 filename 的值插入到 Content-Disposition 头中。最后，使用 curl 发送包含精心构造的 HTTP 头的 POST 请求到目标 URL。payload 中，首先清空了OgnlUtil的ExcludedPackageNames和ExcludedClasses，避免了沙箱限制，然后通过ProcessBuilder执行了命令。这个脚本的有效性较高，因为它直接针对了漏洞的利用点。 `reqnull.txt` 文件也是类似的利用，只不过是预先构造的包含payload的HTTP请求。

**投毒风险：**

分析了提供的`exploit-cd.sh` 脚本和 `reqnull.txt`文件，没有发现明显的投毒代码。脚本的功能是利用漏洞执行任意命令，这本身就是漏洞利用的目的。脚本中所有的操作都是为了构造 payload 并发送请求，没有发现任何隐藏的恶意行为。因此，评估投毒风险为0%。

**项目地址:** [jas502n/st2-046-poc](https://github.com/jas502n/st2-046-poc)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #16

**来源**: [CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md](../2017/CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md)

## CVE-2017-5638-Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并可以通过HTTP请求访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Aon、Trend Micro等）以及Exploit-DB提供的PoC，该漏洞的利用是有效的。在实际环境中，CVE-2017-5638被广泛利用，造成了包括Equifax数据泄露在内的大规模安全事件。

**投毒风险：**
提供的代码库主要侧重于实时异常检测，而非直接的漏洞利用。它通过分析HTTP请求的3-gram特征，并使用Count-Min Sketch和KL散度来检测异常流量。虽然代码本身看起来没有明显的后门，但仍存在一些潜在风险，例如：

*   **依赖风险：** `requirements.txt` 如果包含恶意的第三方库，可能存在投毒风险。但提供的`requirements.txt`文件为空，降低了直接依赖投毒的风险。
*   **数据投毒：** 攻击者可能通过精心构造正常流量，污染Count-Min Sketch，降低检测准确性。由于系统依赖正常流量建立基线，通过大量伪装成正常的恶意请求，可能影响检测。
*   **日志记录：** 系统将检测结果记录到`data/detection.log`，如果日志配置不当，可能导致信息泄露或者日志文件被篡改。

综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP请求。
2.  恶意OGNL表达式位于Content-Type、Content-Disposition或Content-Length等HTTP头中。
3.  当Struts处理multipart请求时，解析这些HTTP头。
4.  Struts框架会执行恶意OGNL表达式，从而导致远程代码执行。

**缓解措施：**
*   升级Apache Struts到安全版本（>=2.3.32或>=2.5.10.1）。
*   使用Web应用防火墙（WAF）过滤恶意请求。
*   部署入侵检测系统（IDS）监控异常流量。
*   实施严格的输入验证和输出编码。

**项目地址:** [joidiego/Detection-struts-cve-2017-5638-detector](https://github.com/joidiego/Detection-struts-cve-2017-5638-detector)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #17

**来源**: [CVE-2017-5638-jongmartinez_CVE-2017-5638.md](../2017/CVE-2017-5638-jongmartinez_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且可从外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成存在缺陷，允许攻击者通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞的 PoC 代码是有效的。搜索引擎结果中多个链接表明该漏洞曾被广泛利用，并造成了严重的安全事件，如 Equifax 数据泄露事件。PoC 代码通过构造特定的 HTTP 头部，利用 OGNL 表达式注入执行系统命令，从而控制服务器。

**投毒风险评估：**

提供的 PoC 代码主要功能是利用漏洞执行命令。投毒风险评估如下：

*   **README.md:** 描述了漏洞利用方式，提供用法示例，没有发现恶意代码。
*   **cve-2017-5638.py:**  
    *   代码结构清晰，功能明确，实现了漏洞利用的核心逻辑。
    *   使用了 `requests` 库发送 HTTP 请求，符合漏洞利用的需要。
    *   OGNL 表达式的构造较为复杂，但其目的是为了绕过安全限制并执行命令。
    *   对执行命令的结果进行输出。
    *  try...except 块处理了可能的请求错误，使得程序更加健壮。
    
虽然代码功能正常，但存在以下潜在风险：

*   **命令执行权限：**  如果目标服务器以高权限运行，攻击者可以通过该漏洞获取高权限，造成更大的危害。
*   **日志记录：**  恶意利用可能被服务器日志记录，但攻击者可以尝试清除日志来隐藏踪迹。
*   **依赖风险：**  `requests` 库本身可能存在安全漏洞，间接影响该 PoC 的安全性。

综合来看，该代码主要风险在于被滥用，利用漏洞攻击目标系统，本身包含作者恶意投毒代码的可能性较低。投毒风险评估为10%。

**利用方式分析：**

1.  **构造恶意 HTTP 头部：**  攻击者通过修改 HTTP 请求的 Content-Type 头部，插入包含恶意 OGNL 表达式的字符串。
2.  **OGNL 表达式注入：**  恶意 OGNL 表达式被 Struts2 框架解析和执行，绕过安全限制，获取执行系统命令的权限。
3.  **执行任意命令：**  攻击者可以通过 OGNL 表达式执行任意系统命令，例如下载恶意文件、反弹 Shell 等。
4.  **获取服务器控制权：**  通过执行系统命令，攻击者可以获取服务器的控制权，进行恶意操作，例如数据窃取、恶意软件传播等。

**项目地址:** [jongmartinez/CVE-2017-5638](https://github.com/jongmartinez/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #18

**来源**: [CVE-2017-5638-jptr218_struts_hack.md](../2017/CVE-2017-5638-jptr218_struts_hack.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于其在处理文件上传时存在异常处理和错误消息生成方面的缺陷，允许远程攻击者通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析如下：

1.  **有效性：** 提供的POC代码通过构造包含 OGNL 表达式的 Content-Type 头部，利用 Struts 框架的漏洞执行任意命令，该方法是有效的。搜索引擎结果和漏洞库信息均表明此漏洞是一个高危且被广泛利用的远程代码执行漏洞。

2.  **投毒风险：** 投毒风险较低，约为10%。虽然该仓库提供了一个预编译的exe文件，但exe文件是一个struts漏洞利用工具,功能上与漏洞库和搜索引擎信息一致,其源代码也被一并给出。潜在的风险在于：
    *   **预编译的二进制文件可能包含恶意代码。** 虽然提供了源代码，但用户在使用前通常不会仔细审计所有代码。
    *   **Payload生成逻辑** payload.cpp 中 OGNL 表达式的构造虽然直接，但也存在被篡改以执行恶意操作的可能性。

3.  **利用方式：**
    *   攻击者发送一个特制的 HTTP 请求到目标服务器，该请求的 Content-Type 头部包含一个 OGNL 表达式。
    *   Struts 框架在处理该请求时，会解析并执行该 OGNL 表达式。
    *   攻击者可以使用 OGNL 表达式来执行任意命令，例如，通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令，从而获取对服务器的控制权。
    *   POC代码中，telnet函数建立socket链接，并持续发送payload，从而建立telnet连接，进入控制台。

 4. **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jptr218/struts_hack](https://github.com/jptr218/struts_hack)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #19

**来源**: [CVE-2017-5638-jrrombaldo_CVE-2017-5638.md](../2017/CVE-2017-5638-jrrombaldo_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #20

**来源**: [CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md](../2017/CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md)

## CVE-2017-5638 Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-5638是Apache Struts Jakarta Multipart解析器中的一个漏洞，由于不正确的异常处理和错误消息生成，允许远程攻击者通过精心构造的Content-Type、Content-Disposition或Content-Length HTTP头执行任意命令。漏洞利用方式是通过在HTTP请求头中注入OGNL表达式，服务器在解析过程中会执行该表达式，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且存在多个可用的POC。提供的POC代码`Invoke-WebRequest -Uri "http://localhost:8080/" -Method POST -Headers @{ "Content-Type" = "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('AttackSuccessTestingRCE',2*2)}.multipart/form-data" }` 尝试通过修改Content-Type头来触发漏洞，并设置一个特定的header 'AttackSuccessTestingRCE' 来检测漏洞是否被成功利用，该代码能够达到漏洞检测效果，因此该POC有效。

**投毒风险：**
提供的两个文件，一个是PowerShell命令用于测试，另一个是Jupyter Notebook，其中定义了一个 Flask 应用来模拟存在漏洞的 Struts 应用，并检测 header 中是否存在恶意代码的特征。虽然这个 Flask 应用本身是为了演示漏洞，但如果直接部署到生产环境，可能存在潜在的风险。但是代码分析来看，没有明显的恶意代码。Demos.ipynb 中的检测恶意代码的逻辑 `SUSPICIOUS_PATTERNS = ["%{", "Runtime.getRuntime", "ProcessBuilder"]`，可以检测到OGNL表达式相关的Payload。因此投毒风险存在，但不是很高，大约20%。

**利用方式：**
攻击者通过发送包含恶意OGNL表达式的HTTP请求，该表达式被注入到Content-Type、Content-Disposition 或 Content-Length 等HTTP头中。Struts在处理Multipart请求时，由于使用了存在漏洞的Jakarta Multipart解析器，会尝试解析这些头，从而触发OGNL表达式的执行。攻击者可以利用OGNL表达式执行任意系统命令，例如下载恶意软件、修改系统配置或窃取敏感数据。

**项目地址:** [kaylertee/Computer-Security-Equifax-2017](https://github.com/kaylertee/Computer-Security-Equifax-2017)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #21

**来源**: [CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md](../2017/CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md)

## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #22

**来源**: [CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md](../2017/CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md)

## CVE-2017-5638 - Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts 2，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于不正确的异常处理和错误消息生成，远程攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 标头执行任意命令。攻击者通常会在 Content-Type 标头中包含 #cmd= 字符串。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确定此漏洞是有效的。大量的公开信息和可用的POC代码表明该漏洞已被广泛研究和利用。

**投毒风险：**
提供的代码包含两个文件：dorker.py 和 exploit.py。

*   **dorker.py：** 这是一个用于搜索引擎爬取的脚本，主要用于查找可能存在漏洞的Struts 2应用。它使用Google、Bing、Yahoo和Baidu等搜索引擎来搜索特定的dorks（搜索字符串）。该脚本本身不太可能包含恶意代码，因为它主要负责信息收集。
*   **exploit.py：** 该脚本包含实际的漏洞利用代码，用于向目标系统发送恶意请求以执行任意命令。虽然脚本的主要功能是利用漏洞，但仍然存在一定的投毒风险。风险点在于执行命令的部分，如果攻击者将恶意命令嵌入到脚本中，可能会对目标系统造成损害。例如，可以修改脚本以默认执行特定的恶意操作，或者在成功利用后植入后门。

因此，虽然 `exploit.py` 的主要目的是为了利用漏洞, 但依然需要谨慎检查其执行命令的部分。`dorker.py` 脚本本身不太可能包含恶意代码。综合分析，投毒风险评估为 10%。主要风险在于，如果下载来源不可信，下载的 `exploit.py` 文件可能已经被篡改，嵌入了恶意代码。

**利用方式：**
1.  **确定目标：** 使用 `dorker.py` 脚本或其他方法查找可能存在漏洞的 Apache Struts 2 应用。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本构造包含恶意 OGNL 表达式的 HTTP 请求。恶意表达式通常嵌入在 Content-Type 标头中。
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 Struts 2 应用。
4.  **执行命令：** 如果目标系统存在漏洞，恶意 OGNL 表达式将被执行，从而导致在服务器上执行任意命令。

**项目地址:** [leandrocamposcardoso/CVE-2017-5638-Mass-Exploit](https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #23

**来源**: [CVE-2017-5638-ludy-dev_XworkStruts-RCE.md](../2017/CVE-2017-5638-ludy-dev_XworkStruts-RCE.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，并且可以通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的POC代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者通过特制的HTTP头部执行任意命令，而搜索结果中也提供了大量的分析和利用案例。POC代码通过构造含有OGNL表达式的Content-Type头部，尝试在目标服务器上写入JSP后门，验证漏洞的存在。

**投毒风险分析：**

经过对提供的POC代码进行分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标服务器上创建一个JSP文件（k22mn7.jsp），实现webshell的功能，从而验证漏洞的存在和进行进一步的利用。代码本身逻辑比较清晰，没有发现隐藏的恶意行为。 投毒风险评估为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **构造恶意HTTP请求：** 攻击者需要构造一个包含恶意OGNL表达式的HTTP请求，特别是Content-Type头部。该表达式会被Struts2框架解析执行。
2.  **利用OGNL执行代码：** 恶意OGNL表达式用于在目标服务器上执行任意代码。常见的利用方式是在服务器上写入一个webshell，或者直接执行系统命令。
3.  **访问webshell：** 如果成功写入webshell，攻击者可以通过访问webshell来控制目标服务器。 

POC代码中的OGNL表达式尝试在服务器的`/k22mn7.jsp`处写入一个JSP后门，以便进一步控制。该POC首先尝试清除ognlUtil的排除列表，然后从输入流拷贝内容到`/k22mn7.jsp`，最后输出`upload_ok`。

漏洞利用的关键在于构造能够绕过Struts2安全机制的恶意OGNL表达式，并将其插入到HTTP头部中。

**项目地址:** [ludy-dev/XworkStruts-RCE](https://github.com/ludy-dev/XworkStruts-RCE)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #24

**来源**: [CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md](../2017/CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #25

**来源**: [CVE-2017-5638-mritunjay-k_CVE-2017-5638.md](../2017/CVE-2017-5638-mritunjay-k_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #26

**来源**: [CVE-2017-5638-mthbernardes_strutszeiro.md](../2017/CVE-2017-5638-mthbernardes_strutszeiro.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过在Content-Type、Content-Disposition或Content-Length HTTP头中构造恶意OGNL表达式来执行任意命令。

**有效性分析：**
漏洞库信息、搜索引擎结果以及提供的漏洞利用代码都表明这是一个真实且高危的漏洞。搜索引擎结果中包含了漏洞的详细描述、利用方式以及受影响的版本。提供的漏洞利用代码是一个Telegram Bot，用于管理利用该漏洞创建的僵尸网络。该Bot通过Telegram命令来添加受害者服务器、执行命令等，进一步验证了漏洞的可利用性。

**投毒风险分析：**
该漏洞利用代码（strutszeiro.py及其相关文件）的投毒风险较低，约为10%。 主要风险点如下：

*   **配置文件：** `conf/token.conf` 和 `conf/group.conf` 存储了Telegram Bot的API Token和群组ID。如果攻击者控制了这些配置文件，他们可以窃取bot控制权，监控所有受害者服务器。
*   **actions.py:**botnet 方法中 cmd 的命令未校验，存在一定风险。
*  **strutszeiro.py:** 判断 chat_type 是否为 'group' ，存在一定风险，如果攻击者知道了bot token，私聊也能控制该bot。

代码本身的主要功能是利用Struts2漏洞进行远程命令执行，没有发现明显的后门或恶意代码。但是，用户需要谨慎配置Telegram Bot，并保护好API Token，防止泄露。

**利用方式：**

1.  **漏洞触发：** 攻击者发送包含恶意OGNL表达式的HTTP请求到存在漏洞的Struts2服务器。通常，这个表达式位于Content-Type头部，利用Jakarta Multipart parser的解析过程。
2.  **命令执行：** Struts2服务器在解析请求头时，会执行OGNL表达式，导致任意命令执行。
3.  **僵尸网络控制：** 提供的漏洞利用代码构建了一个Telegram Bot，攻击者可以通过该Bot远程控制受影响的服务器。
4.  **Telegram Bot命令：** 攻击者可以通过Telegram命令添加新的受害者服务器（`/add url`），在特定服务器上执行命令（`/exploit url *cmd`），在所有受害者服务器上执行命令（`/botnet cmd`），以及列出所有受害者服务器（`/list`）。

**项目地址:** [mthbernardes/strutszeiro](https://github.com/mthbernardes/strutszeiro)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #27

**来源**: [CVE-2017-5638-readloud_CVE-2017-5638.md](../2017/CVE-2017-5638-readloud_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #28

**来源**: [CVE-2017-5638-sighup1_cybersecurity-struts2.md](../2017/CVE-2017-5638-sighup1_cybersecurity-struts2.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头，特别是 Content-Type 头，其中包含 '#cmd=' 字符串，来执行任意命令。

**有效性：**
提供的 PoC 代码利用了 OGNL 表达式注入，通过修改 Content-Type 头来执行系统命令。根据漏洞库信息、搜索结果和 PoC 代码描述，该漏洞的利用方式是有效的。

**投毒风险：**
该仓库存在一定的投毒风险，评估约为10%。理由如下：
*   **免责声明：**仓库包含免责声明，这可能是为了规避潜在的法律责任，但并不能完全排除恶意目的。仓库作者声明“This is meant for educational, and research purposes only. I do not authorize or endorse any illegal or unethical use of this projects contents or information”，可能存在诱导使用者进行非法用途。
*   **不透明性：** 仓库作者在payload中调用了自定义的edu.uvu.ms.cybersecurity.Command类。如果没有对edu.uvu.ms.cybersecurity.Command类进行仔细的代码审计，可能存在恶意代码。如果 Command 类做了超出描述之外的事情（例如，记录命令、尝试提权、扫描网络等），那就存在风险。代码示例中， (#p.print('hello from MSCybersecurity'))这部分可能被替换为更具危害性的操作。
*   **依赖性：** PoC 需要 Send.jar。如果 Send.jar 来源不明或者被篡改，则可能存在安全风险。
*   **复杂性：** OGNL 表达式本身就非常复杂，容易隐藏恶意代码。 即使 payload 中的大部分逻辑看起来是良性的（例如，设置 Content-Type、清理 excludedPackageNames 等）， 仍然可能存在隐藏的、难以察觉的恶意代码片段。
*   **利用普及程度：**由于该漏洞影响广泛，并且利用代码已经公开，攻击者可以修改或者添加恶意代码，伪装成正常的 PoC，传播恶意软件或后门。

**利用方式：**
1.  攻击者发送一个特制的 HTTP 请求，该请求的 Content-Type 头包含恶意的 OGNL 表达式。
2.  Struts2 框架的 Jakarta Multipart parser 在处理该请求时，由于异常处理不当，会将 OGNL 表达式传递给 OGNL 引擎。
3.  OGNL 引擎执行该表达式，导致任意代码执行。
4.  PoC 代码展示了如何通过 OGNL 表达式来实例化 Java 类、调用方法和执行系统命令。
5.  攻击者利用该漏洞可以在服务器上执行任意命令，从而获取敏感信息、篡改数据或完全控制服务器。

**项目地址:** [sighup1/cybersecurity-struts2](https://github.com/sighup1/cybersecurity-struts2)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #29

**来源**: [CVE-2017-5638-sonatype-workshops_struts2-rce.md](../2017/CVE-2017-5638-sonatype-workshops_struts2-rce.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-5638 是 Apache Struts 2 的一个远程代码执行漏洞，源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析：

*   **Dockerfile:** 该文件用于构建包含存在漏洞的 Struts 2 应用的 Docker 镜像。它基于 tomcat:7 镜像，并将 struts2-rest-showcase.war 部署到 Tomcat 的 webapps 目录下，暴露了8080端口。这本身不是漏洞利用代码，而是漏洞测试环境的准备。
*   **Jenkinsfile:** 该文件定义了 Jenkins 构建流程，包括代码检出、Maven 构建和 Nexus Lifecycle Evaluation。它使用 Maven 打包 Struts 2 应用，但没有直接的漏洞利用代码。其中`nexusPolicyEvaluation` 可能存在风险，通过配置`iqApplication`应用ID，可能可以对应用进行安全分析。
*   **LICENSE.txt:** Apache 2.0 许可协议。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞利用的POC是存在的，并且在野外被广泛利用。提供的Dockerfile 可以搭建一个存在漏洞的环境， Jenkinsfile 是项目的构建文件，二者结合可以认为该漏洞是可以复现和利用的

**投毒风险：**
虽然提供的代码片段主要用于构建和部署存在漏洞的 Struts 2 应用，并没有明显的恶意代码。但是`Jenkinsfile`文件中的`nexusPolicyEvaluation` 可能存在风险， 通过配置恶意`iqApplication`应用ID,对构建的应用投毒，但是概率较低.

**利用方式：**
攻击者通常会发送一个包含恶意构造的 Content-Type 头部（例如，包含 `#cmd=` 字符串）的 HTTP 请求。这个恶意头部会触发 Struts 2 中的 OGNL 表达式注入，从而允许攻击者执行任意命令。具体的利用方式包括：

1.  发送包含恶意 Content-Type 头部的 HTTP 请求。
2.  利用 OGNL 表达式执行系统命令。
3.  获取服务器的控制权。

**项目地址:** [sonatype-workshops/struts2-rce](https://github.com/sonatype-workshops/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #30

**来源**: [CVE-2017-5638-tahmed11_strutsy.md](../2017/CVE-2017-5638-tahmed11_strutsy.md)

## CVE-2017-5638 Apache Struts 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.5-2.3.31, 2.5-2.5.10

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，并且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts框架中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传请求时，由于Content-Type头信息解析错误，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头信息，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞是有效的。搜索结果中提到该漏洞被广泛利用，并导致了严重的安全事件，例如Equifax数据泄露事件。提供的Python代码是一个POC，可以用于验证和利用该漏洞。

**投毒风险：**
虽然代码看起来是直接的漏洞利用程序，但是仍然存在一定的投毒风险。以下是风险评估和分析：
*   **网络请求依赖:** 代码依赖 `urllib2`，需要能够访问互联网。攻击者可能会修改代码，使其在特定条件下向恶意服务器发送敏感信息，或者从恶意服务器下载payload执行。这个风险较低，因为基本功能是命令执行。
*   **命令执行：** POC代码允许执行任意命令。如果该代码被修改并分发，攻击者可以将恶意命令硬编码到POC中，从而感染所有使用修改后POC的用户。
*   **Blind Injection 的依赖:** 代码中的blind injection依赖于外部IP并且需要apache可以读取log文件。此过程可能存在后门代码，但是需要进一步分析，才能判断。

 总体来说，该仓库中存在作者隐藏投毒代码的风险较低，大概在10%左右。 主要风险在于使用者不清楚代码逻辑，直接修改其中的cmd参数。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，特别是Content-Type头。
2.  当Struts应用解析该请求时，恶意OGNL表达式会被执行。
3.  攻击者可以利用OGNL表达式执行任意系统命令，例如反弹shell，上传恶意文件等。
4.  提供的POC代码利用了这一漏洞，通过修改Content-Type头，在目标服务器上执行指定的命令。


**项目地址:** [tahmed11/strutsy](https://github.com/tahmed11/strutsy)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #31

**来源**: [CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md](../2017/CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #32

**来源**: [CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md](../2017/CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #33

**来源**: [CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md](../2017/CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md)

# CVE-2017-5638

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-5638-Badbird3_CVE-2017-5638.md](../2017/CVE-2017-5638-Badbird3_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #2

**来源**: [CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md](../2017/CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是一个 Apache Struts2 的远程代码执行漏洞，存在于 Jakarta Multipart parser 中。由于不正确的异常处理和错误消息生成，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头来执行任意命令。从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞利用的有效性非常高，因为在2017年3月已经被广泛利用。漏洞利用代码中的`CVE-2017-5638ApacheStruts.py`脚本通过构造包含OGNL表达式的Content-Type头来触发漏洞，从而执行任意命令。利用方式是通过发送一个精心构造的HTTP请求，其中Content-Type头包含一个OGNL表达式，该表达式允许攻击者执行任意系统命令。

**有效性:**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的有效性非常高，且POC代码能够复现。

**投毒风险:**
POC代码主要功能是发送恶意请求并执行命令。虽然存在一定的风险（例如，命令执行不当导致系统不稳定），但不存在明显的恶意投毒代码。代码结构较为清晰，主要包含参数解析、payload生成和请求发送三个部分。代码中可能的风险点在于，攻击者可以利用此代码执行任意命令，因此存在滥用的风险。但代码本身的功能是为了验证漏洞，并无主动传播恶意代码的功能。我给出的投毒风险评估为5%，主要考虑是：

*   代码作者可能会在代码中添加一些隐藏的后门代码，例如，收集目标服务器的信息并发送到攻击者的服务器，或者在目标服务器上安装恶意软件。
*   代码用户可能会在使用代码时，不小心执行了恶意命令，从而导致系统被入侵。

**利用方式:**
1.  **目标确定:** 确定目标服务器上运行的Apache Struts2版本是否在受影响范围内（2.3.x before 2.3.32 或 2.5.x before 2.5.10.1）。
2.  **Payload构造:** 使用POC代码中的`creating_payload`函数构造包含恶意命令的OGNL表达式payload。 例如：要执行 `whoami` 命令，使用 `-c whoami` 参数。
3.  **请求发送:** 使用POC代码中的`execute`函数，将构造好的payload作为Content-Type头的值，发送HTTP请求到目标服务器的`.action`文件。POC代码会打印命令执行的结果。
4.  **结果分析:** 分析命令执行的结果，判断漏洞是否成功利用。

总而言之，该漏洞利用代码的有效性高，但存在较低的投毒风险。使用时务必谨慎，并确保在授权的环境下进行。


**项目地址:** [FredBrave/CVE-2017-5638-ApacheStruts2.3.5](https://github.com/FredBrave/CVE-2017-5638-ApacheStruts2.3.5)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #3

**来源**: [CVE-2017-5638-Iletee_struts2-rce.md](../2017/CVE-2017-5638-Iletee_struts2-rce.md)

## CVE-2017-5638-Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且可通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理不当。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2017-5638是一个被广泛利用的漏洞。存在公开可用的PoC代码，并且Metasploit框架中也存在利用模块，因此该漏洞的利用有效性很高。

提供的Dockerfile和Jenkinsfile用于构建和部署一个Struts2应用，但本身不包含漏洞利用代码。而是提供了一个包含漏洞的Struts2环境，方便演示和复现。

**投毒风险：**

虽然提供的Dockerfile和Jenkinsfile本身不包含明显的恶意代码，但存在一定的投毒风险：

*   **依赖风险：** Dockerfile中使用了`tomcat:7`镜像，存在该镜像可能包含已知漏洞的风险。Jenkinsfile中maven deploy可能会将构建的组件上传到外部maven仓库，若该仓库被入侵，则存在组件投毒的风险
*   **间接投毒：** Dockerfile中的`COPY target/struts2-rest-showcase.war /usr/local/tomcat/webapps/ROOT.war`，如果`struts2-rest-showcase.war`本身被替换为包含恶意代码的版本，则可能造成投毒。Jenkinsfile拉取的scm如果被恶意人员修改，则存在投毒风险。
*   **Jenkinsfile风险:** Jenkinsfile 中的`postGitHub` 函数，使用了github api token，若该token泄露，则可能导致项目代码被篡改。

综合评估，投毒风险大约为10%，主要来自于依赖风险和构建过程中的潜在恶意代码注入。

**利用方式：**

利用CVE-2017-5638漏洞的典型方式如下：

1.  **构造恶意HTTP请求：**  攻击者构造包含恶意Ognl表达式的Content-Type头部的HTTP请求。
2.  **发送请求：**  将构造好的HTTP请求发送到存在漏洞的Struts2服务器。
3.  **远程代码执行：**  Struts2服务器解析Content-Type头部时，会执行其中的恶意Ognl表达式，从而导致远程代码执行。

攻击者可以通过远程代码执行在服务器上执行任意命令，例如反弹shell、读取敏感文件、修改系统配置等。

一些公开的PoC利用了`#cmd=`字符串来执行系统命令，如`Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW; #cmd=whoami`



**项目地址:** [Iletee/struts2-rce](https://github.com/Iletee/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #4

**来源**: [CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md](../2017/CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且对外开放HTTP端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是 Apache Struts 2 Jakarta Multipart parser 中的一个远程代码执行漏洞。该漏洞是由于在文件上传过程中，对Content-Type、Content-Disposition或Content-Length HTTP header处理不当造成的，攻击者可以通过构造恶意的HTTP头部，利用OGNL表达式注入执行任意命令。

**有效性：** 根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索引擎结果中包含多个关于CVE-2017-5638的PoC和分析，说明该漏洞已经被广泛研究和利用。POC代码通过构造包含恶意OGNL表达式的Content-Type头部，发送POST请求到存在漏洞的Apache Struts2应用，从而执行任意命令。

**投毒风险：**  分析提供的`exploit.py.txt`和`README.md`文件。`README.md`文件只是漏洞利用说明，不包含任何代码。`exploit.py.txt` 文件中的Python代码用于利用 CVE-2017-5638 漏洞。代码首先定义了目标URL和包含恶意 OGNL 表达式的 payload。Payload 构造了一个命令执行的 OGNL 表达式，并在目标系统上执行 `ls /` 命令，将输出返回到响应中。然后，它使用 `requests` 库发送一个包含恶意 header 的 POST 请求到目标 URL。代码没有发现任何隐藏的或恶意的后门或投毒代码。payload 的目的是执行命令，而不是植入长期存在的恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **构造恶意HTTP头部：** 攻击者构造包含恶意OGNL表达式的Content-Type、Content-Disposition或Content-Length HTTP头部。在该POC中，恶意代码位于Content-Type头中。
2.  **发送请求：** 攻击者将构造好的HTTP请求发送到存在漏洞的Apache Struts2应用。
3.  **命令执行：** Struts2应用在处理请求时，由于错误的异常处理和错误消息生成，会将恶意OGNL表达式解析并执行，从而导致远程代码执行。在该POC中，执行了`ls /`命令。
4.  **获取结果：** 攻击者从HTTP响应中获取命令执行的结果。

**项目地址:** [MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION](https://github.com/MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #5

**来源**: [CVE-2017-5638-Nithylesh_web-application-firewall-.md](../2017/CVE-2017-5638-Nithylesh_web-application-firewall-.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性:**
提供的`vulnerable.py`脚本可以有效利用此漏洞，通过设置恶意的`Content-Type`头，向目标服务器发送包含OGNL表达式的HTTP请求，从而执行任意命令。

**投毒风险:**
仓库中存在投毒代码的风险较低，约10%。分析如下：
  * `server.py`文件模拟了一个简单的WAF，但其阻止模式相当基础，可能被绕过。
  * `vulnerable.py`脚本是漏洞利用的核心，其本身的目的就是执行任意命令，这使得判断其中是否包含恶意代码变得困难。尽管如此，脚本逻辑相对清晰，主要是构造payload发送请求并打印响应。但是依旧存在以下情况:
  * 存在隐藏的反向shell或者其他恶意指令的可能，但需要进一步分析才能确定。

**利用方式:**
1.  攻击者发送特制的HTTP请求，该请求的`Content-Type`头包含恶意的OGNL表达式。
2.  Struts2框架在处理multipart请求时，会解析`Content-Type`头。
3.  由于漏洞存在，OGNL表达式会被执行，从而在服务器上执行攻击者指定的命令。
4.  `vulnerable.py` 脚本通过 `check_vulnerability` 和 `execute_command` 函数展示了如何构造包含恶意OGNL表达式的 `Content-Type` 头并发送请求。

**优先级排序理由:**
搜索引擎结果提供了漏洞的基本信息和利用场景，但漏洞利用代码 `vulnerable.py` 更为关键，因为它直接展示了漏洞的利用方式。漏洞库信息作为补充，提供了漏洞影响的版本范围和基本描述。


**项目地址:** [Nithylesh/web-application-firewall-](https://github.com/Nithylesh/web-application-firewall-)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #6

**来源**: [CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md](../2017/CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且允许通过HTTP请求与目标交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞存在于 Jakarta Multipart parser 中，由于其在处理文件上传时的异常处理和错误消息生成不正确导致。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头，在服务器上执行任意命令。

**有效性：**

提供的PoC代码通过修改Content-Type头部，利用OGNL表达式注入恶意代码，从而实现远程代码执行。根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，因此PoC代码的有效性较高。

**投毒风险：**

PoC 代码本身是为了利用漏洞而编写的，其目的是执行任意命令。 从提供的代码来看，核心功能是构造包含恶意 OGNL 表达式的 HTTP 头部。
代码通过 Content-Type 注入 OGNL 表达式，该表达式首先获取 OgnlContext，然后清空了 OGNL 的黑名单，以便执行任意代码。接着，它使用 java.lang.ProcessBuilder 执行指定的命令，并将命令执行的结果返回。

综合分析，PoC 代码的功能是利用漏洞，而不是植入后门或进行其他恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  攻击者发送一个包含恶意Content-Type HTTP头的请求到目标服务器。
2.  恶意Content-Type头中包含OGNL表达式，该表达式能够执行任意系统命令。
3.  Struts2框架解析该请求时，会执行OGNL表达式，从而导致远程代码执行。
4.  攻击者通过执行系统命令，可以获取服务器的控制权。

**总结：**

CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单，影响广泛。提供的PoC代码可以有效利用该漏洞。该PoC代码本身没有投毒风险，但攻击者可以利用该PoC代码攻击未修复的Struts2应用。

**项目地址:** [QHxDr-dz/CVE-2017-5638](https://github.com/QHxDr-dz/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #7

**来源**: [CVE-2017-5638-Tankirat_CVE-2017-5638.md](../2017/CVE-2017-5638-Tankirat_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许通过HTTP进行访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 框架的 Jakarta Multipart parser 中。当处理文件上传时，由于异常处理和错误消息生成不当，攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部来执行任意命令。在野外攻击中，通常使用包含 `#cmd=` 字符串的 Content-Type 头部。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的PoC。漏洞利用代码描述了漏洞原理和利用方法，表明该漏洞的有效性较高。

**投毒风险：**
提供的漏洞利用代码（`/tmp/3bf1e344cbece4d19a9e8c32c2245913/README.md`） 主要是漏洞的介绍文档，描述了漏洞的原理、影响、利用方法、案例分析（Equifax 数据泄露），以及预防措施和参考链接。其中虽然引用了github上漏洞扫描工具，但本身readme文件不具备可执行的攻击代码。所以投毒风险较低，但不能完全排除作者通过其他方式进行投毒，比如在引用的链接中做手脚。所以评定投毒风险为10%。

**利用方式：**
1.  攻击者发送包含恶意构造的 HTTP 头部（例如，Content-Type）的请求到存在漏洞的 Apache Struts 应用。
2.  恶意的 HTTP 头部包含 Object-Graph Navigation Language (OGNL) 表达式。
3.  Struts 应用在解析 HTTP 头部时，会将 OGNL 表达式传递给 `LocalizedTextUtil.findText` 函数进行处理。
4.  `LocalizedTextUtil.findText` 函数会将 `${...}` 中的内容解释为 OGNL 表达式并执行。
5.  攻击者可以通过 OGNL 表达式执行任意系统命令，从而实现远程代码执行。

攻击成功的关键在于构造包含恶意 OGNL 表达式的 HTTP 头部，例如 `Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','vuln')}`。其中OGNL表达式可以执行任意命令，获取敏感信息，或者植入后门。

该漏洞曾被广泛利用，导致了包括 Equifax 数据泄露在内的多起重大安全事件。

**项目地址:** [Tankirat/CVE-2017-5638](https://github.com/Tankirat/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #8

**来源**: [CVE-2017-5638-Xernary_CVE-2017-5638-POC.md](../2017/CVE-2017-5638-Xernary_CVE-2017-5638-POC.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标服务器运行存在漏洞版本的Apache Struts2，且允许POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，由于错误处理和错误消息生成不当，导致攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头来执行任意命令。根据提供的漏洞库信息，漏洞的利用方式是通过在Content-Type头中包含 '#cmd=' 字符串来执行命令，并根据搜索结果确认该漏洞已被广泛利用。

**有效性：**
提供的`exploit.py`脚本通过构造包含OGNL表达式的Content-Type头来实现远程代码执行。该表达式利用OGNL绕过安全限制，执行指定的命令并将结果返回。该PoC代码的逻辑是正确的，并且与漏洞描述相符，因此有效。

**投毒风险：**
审查提供的 Dockerfile 和脚本，可以发现潜在的投毒风险。
*   `server-setup-script.sh`: 该脚本从华为云镜像下载了JDK 8u171，但是考虑到华为云镜像可能已经发生了变更（被投毒），因此存在一定的风险。此外，该脚本中没有检查下载的JDK的完整性，如果下载过程中被篡改，可能导致系统被植入后门。`pwn-page.jsp` 在服务器遭受攻击后会部署该页面。
* `exploit.py`，该脚本本身没有包含明显的恶意代码，但如果被攻击者修改，例如在执行命令之前添加下载和执行恶意文件的功能，也可能成为投毒的途径。`startup.sh` 这个脚本仅仅是用来启动 tomcat 服务。并且Dockerfile 最终启动的命令是 `CMD ["sh", "-c", "./startup.sh && bash"]`， 该命令会启动一个交互式的shell。

因此，综合评估投毒风险大约为10%。虽然没有发现直接的、明显的投毒代码，但是下载的外部资源以及执行流程存在被利用的潜在风险，需要谨慎对待。

**利用方式：**
1.  攻击者发送一个精心构造的HTTP POST请求到存在漏洞的Struts2服务器。
2.  该请求的Content-Type头包含一个恶意的OGNL表达式，该表达式利用Struts2的OGNL解析器执行任意命令。
3.  服务器执行该命令，并将结果返回给攻击者。

**总结：**
CVE-2017-5638 是一个严重的安全漏洞，利用简单，危害巨大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [Xernary/CVE-2017-5638-POC](https://github.com/Xernary/CVE-2017-5638-POC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #9

**来源**: [CVE-2017-5638-andypitcher_check_struts.md](../2017/CVE-2017-5638-andypitcher_check_struts.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP header，在服务器上执行任意命令。漏洞根源在于Struts2对Content-Type等header的处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个真实存在的且已被广泛利用的高危漏洞。网上存在大量的PoC代码，表明其有效性。

**投毒风险：**
提供的代码片段是一个GNU GPL v3许可协议。单独从这个LICENSE文件无法判断是否存在投毒代码，需要检查完整的漏洞利用程序。
然而，考虑到漏洞利用的性质（远程代码执行），如果攻击者能够控制漏洞利用代码，他们可以嵌入恶意代码，例如：

*   **植入后门：** 在目标系统上安装后门，以便长期控制。
*   **数据窃取：** 窃取目标系统上的敏感数据。
*   **恶意软件传播：** 将目标系统作为传播恶意软件的跳板。
*   **破坏系统：** 删除关键文件或使系统崩溃。

因此，在使用任何来自不可信来源的漏洞利用代码时，都必须非常谨慎，进行详细的代码审计，确保没有恶意行为。这里给出的“投毒风险”评估为10%，主要因为提供的代码段本身只是LICENSE信息，无法确定完整利用代码的安全性。需要对实际使用的利用代码进行更细致的分析。

**利用方式：**
利用方式主要通过以下步骤：

1.  **确定目标：** 确定运行存在漏洞的Apache Struts2版本的服务器。
2.  **构造恶意HTTP请求：** 构造包含恶意OGNL表达式的HTTP请求，通常在Content-Type header中，例如`Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getHeader('cmd')}`。`cmd` header 包含要执行的系统命令。
3.  **发送请求：** 将构造好的HTTP请求发送到目标服务器。
4.  **执行命令：** Struts2解析HTTP请求时，会执行恶意OGNL表达式，从而在服务器上执行攻击者指定的命令。

例如，攻击者可以使用curl命令发送包含恶意Content-Type header的请求：

```bash
curl -H 'Content-Type: %{#context["com.opensymphony.xwork2.dispatcher.HttpServletRequest"].map.class.forName("java.lang.Runtime").getRuntime().exec("id")}' http://target.com/example.action
```

此命令会在目标服务器上执行`id`命令，并将结果返回给攻击者。

总而言之，CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单且影响严重，需要及时修复。

**项目地址:** [andypitcher/check_struts](https://github.com/andypitcher/check_struts)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #10

**来源**: [CVE-2017-5638-colorblindpentester_CVE-2017-5638.md](../2017/CVE-2017-5638-colorblindpentester_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638（也称为S2-045）是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，此漏洞是有效的。搜索结果中包含了大量关于CVE-2017-5638的分析、利用和修复信息，表明这是一个真实且影响广泛的漏洞。PoC代码的存在进一步证实了其可利用性。

**投毒风险：**
提供的PoC代码本身就是利用该漏洞的脚本。要确定是否存在投毒风险，需要检查代码中是否存在恶意行为，例如下载和执行其他文件、篡改系统配置等。检查了给定的struts2_S2-045.py代码，它主要功能是构造payload执行命令，并没有发现明显的恶意投毒代码。虽然该代码可以用来执行任意命令，但这本身就是漏洞利用的目的，而不是额外添加的恶意功能。考虑到README.md文件极其简单，整个仓库并没有其他可疑文件，因此投毒风险较低，给出的估计值为5%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Jakarta Multipart parser处理HTTP请求头时。具体来说，当Struts2应用程序尝试解析包含恶意表达式的Content-Type头时，会导致OGNL表达式执行。
2.  **Payload构造：** 攻击者构造包含OGNL表达式的Content-Type头。该表达式利用Struts2的OGNL机制来绕过安全限制，并执行任意命令。
3.  **命令执行：** OGNL表达式首先获取对`OgnlContext`的引用，然后绕过默认的成员访问限制。接着，它使用`java.lang.ProcessBuilder`类来执行指定的命令。PoC中包含了针对Windows和Linux系统的不同命令执行方式。
4.  **结果返回：** 执行命令的结果通过`ServletActionContext.getResponse().getOutputStream()`获取输出流，并将命令执行的结果写入到HTTP响应中，返回给攻击者。

简单来说，利用方式就是通过精心构造的HTTP请求头，向存在漏洞的Struts2应用程序发送恶意payload，从而在服务器上执行任意命令。

**项目地址:** [colorblindpentester/CVE-2017-5638](https://github.com/colorblindpentester/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #11

**来源**: [CVE-2017-5638-haxerr9_CVE-2017-5638.md](../2017/CVE-2017-5638-haxerr9_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #12

**来源**: [CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md](../2017/CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许通过HTTP header传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 漏洞存在于Apache Struts2框架的Jakarta Multipart parser中，由于其在处理文件上传时的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP header来执行任意命令。

**有效性：**
提供的PoC代码是有效的，但它是一个安全的演示版本。它通过在Content-Type header中注入OGNL表达式，尝试设置一个自定义的HTTP响应头（X-Vuln）。如果服务器返回的响应中包含此header，则表示目标服务器可能存在漏洞。此PoC**不会**执行任何实际的恶意命令。

**投毒风险：**
分析了PoC代码和README文件，该仓库的目的是安全地演示该漏洞，而没有包含任何隐藏的或恶意的代码。没有发现任何投毒代码。因此, 投毒风险为 0%。

**利用方式：**
1.  **漏洞原理：** Struts2 使用Jakarta Multipart parser处理multipart请求，Content-Type头信息会被解析。如果Content-Type的值中包含OGNL表达式，并且OGNL表达式解析被启用，攻击者就可以利用OGNL表达式执行任意代码。
2.  **攻击方式：** 攻击者构造包含恶意OGNL表达式的Content-Type header，并发送给存在漏洞的Struts2服务器。
3.  **执行结果：** 服务器解析Content-Type header中的OGNL表达式，执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **PoC利用：** 提供的PoC利用代码通过发送包含`%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Vuln','Vulnerable')}`的Content-Type头来判断是否存在漏洞，成功则表示可能存在漏洞。

**项目地址:** [iampetru/PoC-CVE-2017-5638](https://github.com/iampetru/PoC-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #13

**来源**: [CVE-2017-5638-injcristianrojas_cve-2017-5638.md](../2017/CVE-2017-5638-injcristianrojas_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32 和 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且接受HTTP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 中的一个远程代码执行漏洞，存在于 Jakarta Multipart parser 中。当 Struts2 尝试处理文件上传时，如果 Content-Type、Content-Disposition 或 Content-Length HTTP 头部被恶意构造，将导致异常处理和错误消息生成过程出现问题，进而允许攻击者执行任意命令。

**漏洞利用方式：**

漏洞利用主要通过构造恶意的 Content-Type 头部，其中包含 OGNL 表达式。 OGNL（Object-Graph Navigation Language）是一种强大的表达式语言，用于访问和操作 Java 对象的属性。 攻击者通过在 Content-Type 头部中注入恶意的 OGNL 表达式，利用 Struts2 在解析请求时的漏洞，执行任意系统命令。

提供的漏洞利用代码包含两个 Python 脚本 (exploit1.py 和 exploit2.py)。

*   **exploit1.py:**  尝试通过在 Content-Type 中注入 OGNL 表达式，添加一个名为 "PWNED" 的 HTTP 头部，其值为 1337。这可以用来验证漏洞是否存在。
*   **exploit2.py:**  允许攻击者指定要执行的命令。 它构造一个更复杂的 OGNL 表达式，绕过某些安全限制，并使用 `java.lang.ProcessBuilder` 执行指定的命令，然后将命令的输出返回到 HTTP 响应中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞已经被广泛利用，提供的 POC 代码与已知的攻击方式一致，因此可以判断 POC 代码有效。

**投毒风险：**

提供的代码仓库包含一个 Jenkinsfile, 用于通过OWASP Dependency Check Plugin进行依赖检查, 这本身不属于投毒行为。 exploit1.py 和 exploit2.py 是利用漏洞的代码，也不构成投毒。仓库结构和代码内容来看，存在恶意投毒的可能性较低，约 5% 的可能性在于作者可能在其他未展示的文件中隐藏恶意代码，或者存在依赖污染的风险。总体而言，直接利用该仓库进行投毒的可能性较低，但仍需谨慎使用，建议在使用前进行详细的代码审计。

**项目地址:** [injcristianrojas/cve-2017-5638](https://github.com/injcristianrojas/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #14

**来源**: [CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md](../2017/CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可直接控制服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行受影响版本的Apache Struts2，并且存在文件上传功能或使用了Jakarta Multipart parser

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 框架中的一个远程代码执行漏洞，该漏洞源于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的POC是有效的。漏洞库和搜索结果都表明这是一个被广泛利用的漏洞，多个安全厂商和研究人员都发布了相关的分析和利用方法。

**投毒风险：**

分析提供的代码仓库内容，`README.md` 文件描述了漏洞信息和修复建议。`AvailableURL.txt` 包含可能存在漏洞的URL列表，`keyword.txt` 包含用于查找Struts2应用的关键词。`cmd.py` 是一个Python POC脚本，用于发送包含恶意Content-Type的HTTP请求，从而执行命令。

投毒风险较低，约为 5%。 虽然 `AvailableURL.txt` 中包含一些URL，可能被用于测试，但是这些URL并非恶意代码。 POC本身是利用漏洞执行命令，但并不包含主动植入后门或其他恶意行为的代码，因此，主要风险在于使用者可能会将此POC用于非法用途。

**利用方式：**

1.  攻击者构造包含恶意OGNL表达式的Content-Type HTTP头，例如 `Content-Type: multipart/form-data; boundary="+#cmd=whoami"`。
2.  攻击者向存在漏洞的Struts2应用发送包含上述恶意HTTP头的请求。
3.  Struts2应用使用Jakarta Multipart parser解析请求，由于Content-Type中包含恶意OGNL表达式，解析过程中会执行该表达式。
4.  服务器执行攻击者指定的命令，并将结果返回给攻击者。

提供的 `cmd.py` 脚本就是通过构造包含恶意Content-Type的HTTP请求来利用该漏洞的。

**项目地址:** [jas502n/S2-045-EXP-POC-TOOLS](https://github.com/jas502n/S2-045-EXP-POC-TOOLS)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #15

**来源**: [CVE-2017-5638-jas502n_st2-046-poc.md](../2017/CVE-2017-5638-jas502n_st2-046-poc.md)

## CVE-2017-5638 - Apache Struts2 Jakarta Multipart parser RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且对外开放HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts2 Jakarta Multipart parser 中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于文件上传过程中，对Content-Type, Content-Disposition或Content-Length等HTTP头处理不当造成的。攻击者可以通过构造恶意的HTTP头，特别是Content-Type，包含 `#cmd=` 字符串，来执行任意命令。 

**利用方式：**

提供的`exploit-cd.sh`脚本利用了Content-Disposition header中的 filename 字段，通过插入 null byte (\x00) 来触发 `InvalidFileNameException`，并利用OGNL表达式执行命令。脚本首先设置 Content-Type 为 `multipart/form-data`，然后构造包含恶意 OGNL 表达式的 payload，并将其作为 filename 的值插入到 Content-Disposition 头中。最后，使用 curl 发送包含精心构造的 HTTP 头的 POST 请求到目标 URL。payload 中，首先清空了OgnlUtil的ExcludedPackageNames和ExcludedClasses，避免了沙箱限制，然后通过ProcessBuilder执行了命令。这个脚本的有效性较高，因为它直接针对了漏洞的利用点。 `reqnull.txt` 文件也是类似的利用，只不过是预先构造的包含payload的HTTP请求。

**投毒风险：**

分析了提供的`exploit-cd.sh` 脚本和 `reqnull.txt`文件，没有发现明显的投毒代码。脚本的功能是利用漏洞执行任意命令，这本身就是漏洞利用的目的。脚本中所有的操作都是为了构造 payload 并发送请求，没有发现任何隐藏的恶意行为。因此，评估投毒风险为0%。

**项目地址:** [jas502n/st2-046-poc](https://github.com/jas502n/st2-046-poc)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #16

**来源**: [CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md](../2017/CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md)

## CVE-2017-5638-Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并可以通过HTTP请求访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Aon、Trend Micro等）以及Exploit-DB提供的PoC，该漏洞的利用是有效的。在实际环境中，CVE-2017-5638被广泛利用，造成了包括Equifax数据泄露在内的大规模安全事件。

**投毒风险：**
提供的代码库主要侧重于实时异常检测，而非直接的漏洞利用。它通过分析HTTP请求的3-gram特征，并使用Count-Min Sketch和KL散度来检测异常流量。虽然代码本身看起来没有明显的后门，但仍存在一些潜在风险，例如：

*   **依赖风险：** `requirements.txt` 如果包含恶意的第三方库，可能存在投毒风险。但提供的`requirements.txt`文件为空，降低了直接依赖投毒的风险。
*   **数据投毒：** 攻击者可能通过精心构造正常流量，污染Count-Min Sketch，降低检测准确性。由于系统依赖正常流量建立基线，通过大量伪装成正常的恶意请求，可能影响检测。
*   **日志记录：** 系统将检测结果记录到`data/detection.log`，如果日志配置不当，可能导致信息泄露或者日志文件被篡改。

综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP请求。
2.  恶意OGNL表达式位于Content-Type、Content-Disposition或Content-Length等HTTP头中。
3.  当Struts处理multipart请求时，解析这些HTTP头。
4.  Struts框架会执行恶意OGNL表达式，从而导致远程代码执行。

**缓解措施：**
*   升级Apache Struts到安全版本（>=2.3.32或>=2.5.10.1）。
*   使用Web应用防火墙（WAF）过滤恶意请求。
*   部署入侵检测系统（IDS）监控异常流量。
*   实施严格的输入验证和输出编码。

**项目地址:** [joidiego/Detection-struts-cve-2017-5638-detector](https://github.com/joidiego/Detection-struts-cve-2017-5638-detector)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #17

**来源**: [CVE-2017-5638-jongmartinez_CVE-2017-5638.md](../2017/CVE-2017-5638-jongmartinez_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且可从外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成存在缺陷，允许攻击者通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞的 PoC 代码是有效的。搜索引擎结果中多个链接表明该漏洞曾被广泛利用，并造成了严重的安全事件，如 Equifax 数据泄露事件。PoC 代码通过构造特定的 HTTP 头部，利用 OGNL 表达式注入执行系统命令，从而控制服务器。

**投毒风险评估：**

提供的 PoC 代码主要功能是利用漏洞执行命令。投毒风险评估如下：

*   **README.md:** 描述了漏洞利用方式，提供用法示例，没有发现恶意代码。
*   **cve-2017-5638.py:**  
    *   代码结构清晰，功能明确，实现了漏洞利用的核心逻辑。
    *   使用了 `requests` 库发送 HTTP 请求，符合漏洞利用的需要。
    *   OGNL 表达式的构造较为复杂，但其目的是为了绕过安全限制并执行命令。
    *   对执行命令的结果进行输出。
    *  try...except 块处理了可能的请求错误，使得程序更加健壮。
    
虽然代码功能正常，但存在以下潜在风险：

*   **命令执行权限：**  如果目标服务器以高权限运行，攻击者可以通过该漏洞获取高权限，造成更大的危害。
*   **日志记录：**  恶意利用可能被服务器日志记录，但攻击者可以尝试清除日志来隐藏踪迹。
*   **依赖风险：**  `requests` 库本身可能存在安全漏洞，间接影响该 PoC 的安全性。

综合来看，该代码主要风险在于被滥用，利用漏洞攻击目标系统，本身包含作者恶意投毒代码的可能性较低。投毒风险评估为10%。

**利用方式分析：**

1.  **构造恶意 HTTP 头部：**  攻击者通过修改 HTTP 请求的 Content-Type 头部，插入包含恶意 OGNL 表达式的字符串。
2.  **OGNL 表达式注入：**  恶意 OGNL 表达式被 Struts2 框架解析和执行，绕过安全限制，获取执行系统命令的权限。
3.  **执行任意命令：**  攻击者可以通过 OGNL 表达式执行任意系统命令，例如下载恶意文件、反弹 Shell 等。
4.  **获取服务器控制权：**  通过执行系统命令，攻击者可以获取服务器的控制权，进行恶意操作，例如数据窃取、恶意软件传播等。

**项目地址:** [jongmartinez/CVE-2017-5638](https://github.com/jongmartinez/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #18

**来源**: [CVE-2017-5638-jptr218_struts_hack.md](../2017/CVE-2017-5638-jptr218_struts_hack.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于其在处理文件上传时存在异常处理和错误消息生成方面的缺陷，允许远程攻击者通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析如下：

1.  **有效性：** 提供的POC代码通过构造包含 OGNL 表达式的 Content-Type 头部，利用 Struts 框架的漏洞执行任意命令，该方法是有效的。搜索引擎结果和漏洞库信息均表明此漏洞是一个高危且被广泛利用的远程代码执行漏洞。

2.  **投毒风险：** 投毒风险较低，约为10%。虽然该仓库提供了一个预编译的exe文件，但exe文件是一个struts漏洞利用工具,功能上与漏洞库和搜索引擎信息一致,其源代码也被一并给出。潜在的风险在于：
    *   **预编译的二进制文件可能包含恶意代码。** 虽然提供了源代码，但用户在使用前通常不会仔细审计所有代码。
    *   **Payload生成逻辑** payload.cpp 中 OGNL 表达式的构造虽然直接，但也存在被篡改以执行恶意操作的可能性。

3.  **利用方式：**
    *   攻击者发送一个特制的 HTTP 请求到目标服务器，该请求的 Content-Type 头部包含一个 OGNL 表达式。
    *   Struts 框架在处理该请求时，会解析并执行该 OGNL 表达式。
    *   攻击者可以使用 OGNL 表达式来执行任意命令，例如，通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令，从而获取对服务器的控制权。
    *   POC代码中，telnet函数建立socket链接，并持续发送payload，从而建立telnet连接，进入控制台。

 4. **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jptr218/struts_hack](https://github.com/jptr218/struts_hack)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #19

**来源**: [CVE-2017-5638-jrrombaldo_CVE-2017-5638.md](../2017/CVE-2017-5638-jrrombaldo_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #20

**来源**: [CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md](../2017/CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md)

## CVE-2017-5638 Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-5638是Apache Struts Jakarta Multipart解析器中的一个漏洞，由于不正确的异常处理和错误消息生成，允许远程攻击者通过精心构造的Content-Type、Content-Disposition或Content-Length HTTP头执行任意命令。漏洞利用方式是通过在HTTP请求头中注入OGNL表达式，服务器在解析过程中会执行该表达式，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且存在多个可用的POC。提供的POC代码`Invoke-WebRequest -Uri "http://localhost:8080/" -Method POST -Headers @{ "Content-Type" = "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('AttackSuccessTestingRCE',2*2)}.multipart/form-data" }` 尝试通过修改Content-Type头来触发漏洞，并设置一个特定的header 'AttackSuccessTestingRCE' 来检测漏洞是否被成功利用，该代码能够达到漏洞检测效果，因此该POC有效。

**投毒风险：**
提供的两个文件，一个是PowerShell命令用于测试，另一个是Jupyter Notebook，其中定义了一个 Flask 应用来模拟存在漏洞的 Struts 应用，并检测 header 中是否存在恶意代码的特征。虽然这个 Flask 应用本身是为了演示漏洞，但如果直接部署到生产环境，可能存在潜在的风险。但是代码分析来看，没有明显的恶意代码。Demos.ipynb 中的检测恶意代码的逻辑 `SUSPICIOUS_PATTERNS = ["%{", "Runtime.getRuntime", "ProcessBuilder"]`，可以检测到OGNL表达式相关的Payload。因此投毒风险存在，但不是很高，大约20%。

**利用方式：**
攻击者通过发送包含恶意OGNL表达式的HTTP请求，该表达式被注入到Content-Type、Content-Disposition 或 Content-Length 等HTTP头中。Struts在处理Multipart请求时，由于使用了存在漏洞的Jakarta Multipart解析器，会尝试解析这些头，从而触发OGNL表达式的执行。攻击者可以利用OGNL表达式执行任意系统命令，例如下载恶意软件、修改系统配置或窃取敏感数据。

**项目地址:** [kaylertee/Computer-Security-Equifax-2017](https://github.com/kaylertee/Computer-Security-Equifax-2017)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #21

**来源**: [CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md](../2017/CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md)

## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #22

**来源**: [CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md](../2017/CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md)

## CVE-2017-5638 - Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts 2，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于不正确的异常处理和错误消息生成，远程攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 标头执行任意命令。攻击者通常会在 Content-Type 标头中包含 #cmd= 字符串。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确定此漏洞是有效的。大量的公开信息和可用的POC代码表明该漏洞已被广泛研究和利用。

**投毒风险：**
提供的代码包含两个文件：dorker.py 和 exploit.py。

*   **dorker.py：** 这是一个用于搜索引擎爬取的脚本，主要用于查找可能存在漏洞的Struts 2应用。它使用Google、Bing、Yahoo和Baidu等搜索引擎来搜索特定的dorks（搜索字符串）。该脚本本身不太可能包含恶意代码，因为它主要负责信息收集。
*   **exploit.py：** 该脚本包含实际的漏洞利用代码，用于向目标系统发送恶意请求以执行任意命令。虽然脚本的主要功能是利用漏洞，但仍然存在一定的投毒风险。风险点在于执行命令的部分，如果攻击者将恶意命令嵌入到脚本中，可能会对目标系统造成损害。例如，可以修改脚本以默认执行特定的恶意操作，或者在成功利用后植入后门。

因此，虽然 `exploit.py` 的主要目的是为了利用漏洞, 但依然需要谨慎检查其执行命令的部分。`dorker.py` 脚本本身不太可能包含恶意代码。综合分析，投毒风险评估为 10%。主要风险在于，如果下载来源不可信，下载的 `exploit.py` 文件可能已经被篡改，嵌入了恶意代码。

**利用方式：**
1.  **确定目标：** 使用 `dorker.py` 脚本或其他方法查找可能存在漏洞的 Apache Struts 2 应用。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本构造包含恶意 OGNL 表达式的 HTTP 请求。恶意表达式通常嵌入在 Content-Type 标头中。
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 Struts 2 应用。
4.  **执行命令：** 如果目标系统存在漏洞，恶意 OGNL 表达式将被执行，从而导致在服务器上执行任意命令。

**项目地址:** [leandrocamposcardoso/CVE-2017-5638-Mass-Exploit](https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #23

**来源**: [CVE-2017-5638-ludy-dev_XworkStruts-RCE.md](../2017/CVE-2017-5638-ludy-dev_XworkStruts-RCE.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，并且可以通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的POC代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者通过特制的HTTP头部执行任意命令，而搜索结果中也提供了大量的分析和利用案例。POC代码通过构造含有OGNL表达式的Content-Type头部，尝试在目标服务器上写入JSP后门，验证漏洞的存在。

**投毒风险分析：**

经过对提供的POC代码进行分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标服务器上创建一个JSP文件（k22mn7.jsp），实现webshell的功能，从而验证漏洞的存在和进行进一步的利用。代码本身逻辑比较清晰，没有发现隐藏的恶意行为。 投毒风险评估为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **构造恶意HTTP请求：** 攻击者需要构造一个包含恶意OGNL表达式的HTTP请求，特别是Content-Type头部。该表达式会被Struts2框架解析执行。
2.  **利用OGNL执行代码：** 恶意OGNL表达式用于在目标服务器上执行任意代码。常见的利用方式是在服务器上写入一个webshell，或者直接执行系统命令。
3.  **访问webshell：** 如果成功写入webshell，攻击者可以通过访问webshell来控制目标服务器。 

POC代码中的OGNL表达式尝试在服务器的`/k22mn7.jsp`处写入一个JSP后门，以便进一步控制。该POC首先尝试清除ognlUtil的排除列表，然后从输入流拷贝内容到`/k22mn7.jsp`，最后输出`upload_ok`。

漏洞利用的关键在于构造能够绕过Struts2安全机制的恶意OGNL表达式，并将其插入到HTTP头部中。

**项目地址:** [ludy-dev/XworkStruts-RCE](https://github.com/ludy-dev/XworkStruts-RCE)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #24

**来源**: [CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md](../2017/CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #25

**来源**: [CVE-2017-5638-mritunjay-k_CVE-2017-5638.md](../2017/CVE-2017-5638-mritunjay-k_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #26

**来源**: [CVE-2017-5638-mthbernardes_strutszeiro.md](../2017/CVE-2017-5638-mthbernardes_strutszeiro.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过在Content-Type、Content-Disposition或Content-Length HTTP头中构造恶意OGNL表达式来执行任意命令。

**有效性分析：**
漏洞库信息、搜索引擎结果以及提供的漏洞利用代码都表明这是一个真实且高危的漏洞。搜索引擎结果中包含了漏洞的详细描述、利用方式以及受影响的版本。提供的漏洞利用代码是一个Telegram Bot，用于管理利用该漏洞创建的僵尸网络。该Bot通过Telegram命令来添加受害者服务器、执行命令等，进一步验证了漏洞的可利用性。

**投毒风险分析：**
该漏洞利用代码（strutszeiro.py及其相关文件）的投毒风险较低，约为10%。 主要风险点如下：

*   **配置文件：** `conf/token.conf` 和 `conf/group.conf` 存储了Telegram Bot的API Token和群组ID。如果攻击者控制了这些配置文件，他们可以窃取bot控制权，监控所有受害者服务器。
*   **actions.py:**botnet 方法中 cmd 的命令未校验，存在一定风险。
*  **strutszeiro.py:** 判断 chat_type 是否为 'group' ，存在一定风险，如果攻击者知道了bot token，私聊也能控制该bot。

代码本身的主要功能是利用Struts2漏洞进行远程命令执行，没有发现明显的后门或恶意代码。但是，用户需要谨慎配置Telegram Bot，并保护好API Token，防止泄露。

**利用方式：**

1.  **漏洞触发：** 攻击者发送包含恶意OGNL表达式的HTTP请求到存在漏洞的Struts2服务器。通常，这个表达式位于Content-Type头部，利用Jakarta Multipart parser的解析过程。
2.  **命令执行：** Struts2服务器在解析请求头时，会执行OGNL表达式，导致任意命令执行。
3.  **僵尸网络控制：** 提供的漏洞利用代码构建了一个Telegram Bot，攻击者可以通过该Bot远程控制受影响的服务器。
4.  **Telegram Bot命令：** 攻击者可以通过Telegram命令添加新的受害者服务器（`/add url`），在特定服务器上执行命令（`/exploit url *cmd`），在所有受害者服务器上执行命令（`/botnet cmd`），以及列出所有受害者服务器（`/list`）。

**项目地址:** [mthbernardes/strutszeiro](https://github.com/mthbernardes/strutszeiro)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #27

**来源**: [CVE-2017-5638-readloud_CVE-2017-5638.md](../2017/CVE-2017-5638-readloud_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #28

**来源**: [CVE-2017-5638-sighup1_cybersecurity-struts2.md](../2017/CVE-2017-5638-sighup1_cybersecurity-struts2.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头，特别是 Content-Type 头，其中包含 '#cmd=' 字符串，来执行任意命令。

**有效性：**
提供的 PoC 代码利用了 OGNL 表达式注入，通过修改 Content-Type 头来执行系统命令。根据漏洞库信息、搜索结果和 PoC 代码描述，该漏洞的利用方式是有效的。

**投毒风险：**
该仓库存在一定的投毒风险，评估约为10%。理由如下：
*   **免责声明：**仓库包含免责声明，这可能是为了规避潜在的法律责任，但并不能完全排除恶意目的。仓库作者声明“This is meant for educational, and research purposes only. I do not authorize or endorse any illegal or unethical use of this projects contents or information”，可能存在诱导使用者进行非法用途。
*   **不透明性：** 仓库作者在payload中调用了自定义的edu.uvu.ms.cybersecurity.Command类。如果没有对edu.uvu.ms.cybersecurity.Command类进行仔细的代码审计，可能存在恶意代码。如果 Command 类做了超出描述之外的事情（例如，记录命令、尝试提权、扫描网络等），那就存在风险。代码示例中， (#p.print('hello from MSCybersecurity'))这部分可能被替换为更具危害性的操作。
*   **依赖性：** PoC 需要 Send.jar。如果 Send.jar 来源不明或者被篡改，则可能存在安全风险。
*   **复杂性：** OGNL 表达式本身就非常复杂，容易隐藏恶意代码。 即使 payload 中的大部分逻辑看起来是良性的（例如，设置 Content-Type、清理 excludedPackageNames 等）， 仍然可能存在隐藏的、难以察觉的恶意代码片段。
*   **利用普及程度：**由于该漏洞影响广泛，并且利用代码已经公开，攻击者可以修改或者添加恶意代码，伪装成正常的 PoC，传播恶意软件或后门。

**利用方式：**
1.  攻击者发送一个特制的 HTTP 请求，该请求的 Content-Type 头包含恶意的 OGNL 表达式。
2.  Struts2 框架的 Jakarta Multipart parser 在处理该请求时，由于异常处理不当，会将 OGNL 表达式传递给 OGNL 引擎。
3.  OGNL 引擎执行该表达式，导致任意代码执行。
4.  PoC 代码展示了如何通过 OGNL 表达式来实例化 Java 类、调用方法和执行系统命令。
5.  攻击者利用该漏洞可以在服务器上执行任意命令，从而获取敏感信息、篡改数据或完全控制服务器。

**项目地址:** [sighup1/cybersecurity-struts2](https://github.com/sighup1/cybersecurity-struts2)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #29

**来源**: [CVE-2017-5638-sonatype-workshops_struts2-rce.md](../2017/CVE-2017-5638-sonatype-workshops_struts2-rce.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-5638 是 Apache Struts 2 的一个远程代码执行漏洞，源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析：

*   **Dockerfile:** 该文件用于构建包含存在漏洞的 Struts 2 应用的 Docker 镜像。它基于 tomcat:7 镜像，并将 struts2-rest-showcase.war 部署到 Tomcat 的 webapps 目录下，暴露了8080端口。这本身不是漏洞利用代码，而是漏洞测试环境的准备。
*   **Jenkinsfile:** 该文件定义了 Jenkins 构建流程，包括代码检出、Maven 构建和 Nexus Lifecycle Evaluation。它使用 Maven 打包 Struts 2 应用，但没有直接的漏洞利用代码。其中`nexusPolicyEvaluation` 可能存在风险，通过配置`iqApplication`应用ID，可能可以对应用进行安全分析。
*   **LICENSE.txt:** Apache 2.0 许可协议。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞利用的POC是存在的，并且在野外被广泛利用。提供的Dockerfile 可以搭建一个存在漏洞的环境， Jenkinsfile 是项目的构建文件，二者结合可以认为该漏洞是可以复现和利用的

**投毒风险：**
虽然提供的代码片段主要用于构建和部署存在漏洞的 Struts 2 应用，并没有明显的恶意代码。但是`Jenkinsfile`文件中的`nexusPolicyEvaluation` 可能存在风险， 通过配置恶意`iqApplication`应用ID,对构建的应用投毒，但是概率较低.

**利用方式：**
攻击者通常会发送一个包含恶意构造的 Content-Type 头部（例如，包含 `#cmd=` 字符串）的 HTTP 请求。这个恶意头部会触发 Struts 2 中的 OGNL 表达式注入，从而允许攻击者执行任意命令。具体的利用方式包括：

1.  发送包含恶意 Content-Type 头部的 HTTP 请求。
2.  利用 OGNL 表达式执行系统命令。
3.  获取服务器的控制权。

**项目地址:** [sonatype-workshops/struts2-rce](https://github.com/sonatype-workshops/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #30

**来源**: [CVE-2017-5638-tahmed11_strutsy.md](../2017/CVE-2017-5638-tahmed11_strutsy.md)

## CVE-2017-5638 Apache Struts 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.5-2.3.31, 2.5-2.5.10

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，并且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts框架中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传请求时，由于Content-Type头信息解析错误，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头信息，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞是有效的。搜索结果中提到该漏洞被广泛利用，并导致了严重的安全事件，例如Equifax数据泄露事件。提供的Python代码是一个POC，可以用于验证和利用该漏洞。

**投毒风险：**
虽然代码看起来是直接的漏洞利用程序，但是仍然存在一定的投毒风险。以下是风险评估和分析：
*   **网络请求依赖:** 代码依赖 `urllib2`，需要能够访问互联网。攻击者可能会修改代码，使其在特定条件下向恶意服务器发送敏感信息，或者从恶意服务器下载payload执行。这个风险较低，因为基本功能是命令执行。
*   **命令执行：** POC代码允许执行任意命令。如果该代码被修改并分发，攻击者可以将恶意命令硬编码到POC中，从而感染所有使用修改后POC的用户。
*   **Blind Injection 的依赖:** 代码中的blind injection依赖于外部IP并且需要apache可以读取log文件。此过程可能存在后门代码，但是需要进一步分析，才能判断。

 总体来说，该仓库中存在作者隐藏投毒代码的风险较低，大概在10%左右。 主要风险在于使用者不清楚代码逻辑，直接修改其中的cmd参数。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，特别是Content-Type头。
2.  当Struts应用解析该请求时，恶意OGNL表达式会被执行。
3.  攻击者可以利用OGNL表达式执行任意系统命令，例如反弹shell，上传恶意文件等。
4.  提供的POC代码利用了这一漏洞，通过修改Content-Type头，在目标服务器上执行指定的命令。


**项目地址:** [tahmed11/strutsy](https://github.com/tahmed11/strutsy)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #31

**来源**: [CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md](../2017/CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #32

**来源**: [CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md](../2017/CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #33

**来源**: [CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md](../2017/CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md)

# CVE-2017-5638

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-5638-Badbird3_CVE-2017-5638.md](../2017/CVE-2017-5638-Badbird3_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #2

**来源**: [CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md](../2017/CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是一个 Apache Struts2 的远程代码执行漏洞，存在于 Jakarta Multipart parser 中。由于不正确的异常处理和错误消息生成，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头来执行任意命令。从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞利用的有效性非常高，因为在2017年3月已经被广泛利用。漏洞利用代码中的`CVE-2017-5638ApacheStruts.py`脚本通过构造包含OGNL表达式的Content-Type头来触发漏洞，从而执行任意命令。利用方式是通过发送一个精心构造的HTTP请求，其中Content-Type头包含一个OGNL表达式，该表达式允许攻击者执行任意系统命令。

**有效性:**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的有效性非常高，且POC代码能够复现。

**投毒风险:**
POC代码主要功能是发送恶意请求并执行命令。虽然存在一定的风险（例如，命令执行不当导致系统不稳定），但不存在明显的恶意投毒代码。代码结构较为清晰，主要包含参数解析、payload生成和请求发送三个部分。代码中可能的风险点在于，攻击者可以利用此代码执行任意命令，因此存在滥用的风险。但代码本身的功能是为了验证漏洞，并无主动传播恶意代码的功能。我给出的投毒风险评估为5%，主要考虑是：

*   代码作者可能会在代码中添加一些隐藏的后门代码，例如，收集目标服务器的信息并发送到攻击者的服务器，或者在目标服务器上安装恶意软件。
*   代码用户可能会在使用代码时，不小心执行了恶意命令，从而导致系统被入侵。

**利用方式:**
1.  **目标确定:** 确定目标服务器上运行的Apache Struts2版本是否在受影响范围内（2.3.x before 2.3.32 或 2.5.x before 2.5.10.1）。
2.  **Payload构造:** 使用POC代码中的`creating_payload`函数构造包含恶意命令的OGNL表达式payload。 例如：要执行 `whoami` 命令，使用 `-c whoami` 参数。
3.  **请求发送:** 使用POC代码中的`execute`函数，将构造好的payload作为Content-Type头的值，发送HTTP请求到目标服务器的`.action`文件。POC代码会打印命令执行的结果。
4.  **结果分析:** 分析命令执行的结果，判断漏洞是否成功利用。

总而言之，该漏洞利用代码的有效性高，但存在较低的投毒风险。使用时务必谨慎，并确保在授权的环境下进行。


**项目地址:** [FredBrave/CVE-2017-5638-ApacheStruts2.3.5](https://github.com/FredBrave/CVE-2017-5638-ApacheStruts2.3.5)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #3

**来源**: [CVE-2017-5638-Iletee_struts2-rce.md](../2017/CVE-2017-5638-Iletee_struts2-rce.md)

## CVE-2017-5638-Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且可通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理不当。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2017-5638是一个被广泛利用的漏洞。存在公开可用的PoC代码，并且Metasploit框架中也存在利用模块，因此该漏洞的利用有效性很高。

提供的Dockerfile和Jenkinsfile用于构建和部署一个Struts2应用，但本身不包含漏洞利用代码。而是提供了一个包含漏洞的Struts2环境，方便演示和复现。

**投毒风险：**

虽然提供的Dockerfile和Jenkinsfile本身不包含明显的恶意代码，但存在一定的投毒风险：

*   **依赖风险：** Dockerfile中使用了`tomcat:7`镜像，存在该镜像可能包含已知漏洞的风险。Jenkinsfile中maven deploy可能会将构建的组件上传到外部maven仓库，若该仓库被入侵，则存在组件投毒的风险
*   **间接投毒：** Dockerfile中的`COPY target/struts2-rest-showcase.war /usr/local/tomcat/webapps/ROOT.war`，如果`struts2-rest-showcase.war`本身被替换为包含恶意代码的版本，则可能造成投毒。Jenkinsfile拉取的scm如果被恶意人员修改，则存在投毒风险。
*   **Jenkinsfile风险:** Jenkinsfile 中的`postGitHub` 函数，使用了github api token，若该token泄露，则可能导致项目代码被篡改。

综合评估，投毒风险大约为10%，主要来自于依赖风险和构建过程中的潜在恶意代码注入。

**利用方式：**

利用CVE-2017-5638漏洞的典型方式如下：

1.  **构造恶意HTTP请求：**  攻击者构造包含恶意Ognl表达式的Content-Type头部的HTTP请求。
2.  **发送请求：**  将构造好的HTTP请求发送到存在漏洞的Struts2服务器。
3.  **远程代码执行：**  Struts2服务器解析Content-Type头部时，会执行其中的恶意Ognl表达式，从而导致远程代码执行。

攻击者可以通过远程代码执行在服务器上执行任意命令，例如反弹shell、读取敏感文件、修改系统配置等。

一些公开的PoC利用了`#cmd=`字符串来执行系统命令，如`Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW; #cmd=whoami`



**项目地址:** [Iletee/struts2-rce](https://github.com/Iletee/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #4

**来源**: [CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md](../2017/CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且对外开放HTTP端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是 Apache Struts 2 Jakarta Multipart parser 中的一个远程代码执行漏洞。该漏洞是由于在文件上传过程中，对Content-Type、Content-Disposition或Content-Length HTTP header处理不当造成的，攻击者可以通过构造恶意的HTTP头部，利用OGNL表达式注入执行任意命令。

**有效性：** 根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索引擎结果中包含多个关于CVE-2017-5638的PoC和分析，说明该漏洞已经被广泛研究和利用。POC代码通过构造包含恶意OGNL表达式的Content-Type头部，发送POST请求到存在漏洞的Apache Struts2应用，从而执行任意命令。

**投毒风险：**  分析提供的`exploit.py.txt`和`README.md`文件。`README.md`文件只是漏洞利用说明，不包含任何代码。`exploit.py.txt` 文件中的Python代码用于利用 CVE-2017-5638 漏洞。代码首先定义了目标URL和包含恶意 OGNL 表达式的 payload。Payload 构造了一个命令执行的 OGNL 表达式，并在目标系统上执行 `ls /` 命令，将输出返回到响应中。然后，它使用 `requests` 库发送一个包含恶意 header 的 POST 请求到目标 URL。代码没有发现任何隐藏的或恶意的后门或投毒代码。payload 的目的是执行命令，而不是植入长期存在的恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **构造恶意HTTP头部：** 攻击者构造包含恶意OGNL表达式的Content-Type、Content-Disposition或Content-Length HTTP头部。在该POC中，恶意代码位于Content-Type头中。
2.  **发送请求：** 攻击者将构造好的HTTP请求发送到存在漏洞的Apache Struts2应用。
3.  **命令执行：** Struts2应用在处理请求时，由于错误的异常处理和错误消息生成，会将恶意OGNL表达式解析并执行，从而导致远程代码执行。在该POC中，执行了`ls /`命令。
4.  **获取结果：** 攻击者从HTTP响应中获取命令执行的结果。

**项目地址:** [MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION](https://github.com/MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #5

**来源**: [CVE-2017-5638-Nithylesh_web-application-firewall-.md](../2017/CVE-2017-5638-Nithylesh_web-application-firewall-.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性:**
提供的`vulnerable.py`脚本可以有效利用此漏洞，通过设置恶意的`Content-Type`头，向目标服务器发送包含OGNL表达式的HTTP请求，从而执行任意命令。

**投毒风险:**
仓库中存在投毒代码的风险较低，约10%。分析如下：
  * `server.py`文件模拟了一个简单的WAF，但其阻止模式相当基础，可能被绕过。
  * `vulnerable.py`脚本是漏洞利用的核心，其本身的目的就是执行任意命令，这使得判断其中是否包含恶意代码变得困难。尽管如此，脚本逻辑相对清晰，主要是构造payload发送请求并打印响应。但是依旧存在以下情况:
  * 存在隐藏的反向shell或者其他恶意指令的可能，但需要进一步分析才能确定。

**利用方式:**
1.  攻击者发送特制的HTTP请求，该请求的`Content-Type`头包含恶意的OGNL表达式。
2.  Struts2框架在处理multipart请求时，会解析`Content-Type`头。
3.  由于漏洞存在，OGNL表达式会被执行，从而在服务器上执行攻击者指定的命令。
4.  `vulnerable.py` 脚本通过 `check_vulnerability` 和 `execute_command` 函数展示了如何构造包含恶意OGNL表达式的 `Content-Type` 头并发送请求。

**优先级排序理由:**
搜索引擎结果提供了漏洞的基本信息和利用场景，但漏洞利用代码 `vulnerable.py` 更为关键，因为它直接展示了漏洞的利用方式。漏洞库信息作为补充，提供了漏洞影响的版本范围和基本描述。


**项目地址:** [Nithylesh/web-application-firewall-](https://github.com/Nithylesh/web-application-firewall-)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #6

**来源**: [CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md](../2017/CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且允许通过HTTP请求与目标交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞存在于 Jakarta Multipart parser 中，由于其在处理文件上传时的异常处理和错误消息生成不正确导致。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头，在服务器上执行任意命令。

**有效性：**

提供的PoC代码通过修改Content-Type头部，利用OGNL表达式注入恶意代码，从而实现远程代码执行。根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，因此PoC代码的有效性较高。

**投毒风险：**

PoC 代码本身是为了利用漏洞而编写的，其目的是执行任意命令。 从提供的代码来看，核心功能是构造包含恶意 OGNL 表达式的 HTTP 头部。
代码通过 Content-Type 注入 OGNL 表达式，该表达式首先获取 OgnlContext，然后清空了 OGNL 的黑名单，以便执行任意代码。接着，它使用 java.lang.ProcessBuilder 执行指定的命令，并将命令执行的结果返回。

综合分析，PoC 代码的功能是利用漏洞，而不是植入后门或进行其他恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  攻击者发送一个包含恶意Content-Type HTTP头的请求到目标服务器。
2.  恶意Content-Type头中包含OGNL表达式，该表达式能够执行任意系统命令。
3.  Struts2框架解析该请求时，会执行OGNL表达式，从而导致远程代码执行。
4.  攻击者通过执行系统命令，可以获取服务器的控制权。

**总结：**

CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单，影响广泛。提供的PoC代码可以有效利用该漏洞。该PoC代码本身没有投毒风险，但攻击者可以利用该PoC代码攻击未修复的Struts2应用。

**项目地址:** [QHxDr-dz/CVE-2017-5638](https://github.com/QHxDr-dz/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #7

**来源**: [CVE-2017-5638-Tankirat_CVE-2017-5638.md](../2017/CVE-2017-5638-Tankirat_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许通过HTTP进行访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 框架的 Jakarta Multipart parser 中。当处理文件上传时，由于异常处理和错误消息生成不当，攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部来执行任意命令。在野外攻击中，通常使用包含 `#cmd=` 字符串的 Content-Type 头部。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的PoC。漏洞利用代码描述了漏洞原理和利用方法，表明该漏洞的有效性较高。

**投毒风险：**
提供的漏洞利用代码（`/tmp/3bf1e344cbece4d19a9e8c32c2245913/README.md`） 主要是漏洞的介绍文档，描述了漏洞的原理、影响、利用方法、案例分析（Equifax 数据泄露），以及预防措施和参考链接。其中虽然引用了github上漏洞扫描工具，但本身readme文件不具备可执行的攻击代码。所以投毒风险较低，但不能完全排除作者通过其他方式进行投毒，比如在引用的链接中做手脚。所以评定投毒风险为10%。

**利用方式：**
1.  攻击者发送包含恶意构造的 HTTP 头部（例如，Content-Type）的请求到存在漏洞的 Apache Struts 应用。
2.  恶意的 HTTP 头部包含 Object-Graph Navigation Language (OGNL) 表达式。
3.  Struts 应用在解析 HTTP 头部时，会将 OGNL 表达式传递给 `LocalizedTextUtil.findText` 函数进行处理。
4.  `LocalizedTextUtil.findText` 函数会将 `${...}` 中的内容解释为 OGNL 表达式并执行。
5.  攻击者可以通过 OGNL 表达式执行任意系统命令，从而实现远程代码执行。

攻击成功的关键在于构造包含恶意 OGNL 表达式的 HTTP 头部，例如 `Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','vuln')}`。其中OGNL表达式可以执行任意命令，获取敏感信息，或者植入后门。

该漏洞曾被广泛利用，导致了包括 Equifax 数据泄露在内的多起重大安全事件。

**项目地址:** [Tankirat/CVE-2017-5638](https://github.com/Tankirat/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #8

**来源**: [CVE-2017-5638-Xernary_CVE-2017-5638-POC.md](../2017/CVE-2017-5638-Xernary_CVE-2017-5638-POC.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标服务器运行存在漏洞版本的Apache Struts2，且允许POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，由于错误处理和错误消息生成不当，导致攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头来执行任意命令。根据提供的漏洞库信息，漏洞的利用方式是通过在Content-Type头中包含 '#cmd=' 字符串来执行命令，并根据搜索结果确认该漏洞已被广泛利用。

**有效性：**
提供的`exploit.py`脚本通过构造包含OGNL表达式的Content-Type头来实现远程代码执行。该表达式利用OGNL绕过安全限制，执行指定的命令并将结果返回。该PoC代码的逻辑是正确的，并且与漏洞描述相符，因此有效。

**投毒风险：**
审查提供的 Dockerfile 和脚本，可以发现潜在的投毒风险。
*   `server-setup-script.sh`: 该脚本从华为云镜像下载了JDK 8u171，但是考虑到华为云镜像可能已经发生了变更（被投毒），因此存在一定的风险。此外，该脚本中没有检查下载的JDK的完整性，如果下载过程中被篡改，可能导致系统被植入后门。`pwn-page.jsp` 在服务器遭受攻击后会部署该页面。
* `exploit.py`，该脚本本身没有包含明显的恶意代码，但如果被攻击者修改，例如在执行命令之前添加下载和执行恶意文件的功能，也可能成为投毒的途径。`startup.sh` 这个脚本仅仅是用来启动 tomcat 服务。并且Dockerfile 最终启动的命令是 `CMD ["sh", "-c", "./startup.sh && bash"]`， 该命令会启动一个交互式的shell。

因此，综合评估投毒风险大约为10%。虽然没有发现直接的、明显的投毒代码，但是下载的外部资源以及执行流程存在被利用的潜在风险，需要谨慎对待。

**利用方式：**
1.  攻击者发送一个精心构造的HTTP POST请求到存在漏洞的Struts2服务器。
2.  该请求的Content-Type头包含一个恶意的OGNL表达式，该表达式利用Struts2的OGNL解析器执行任意命令。
3.  服务器执行该命令，并将结果返回给攻击者。

**总结：**
CVE-2017-5638 是一个严重的安全漏洞，利用简单，危害巨大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [Xernary/CVE-2017-5638-POC](https://github.com/Xernary/CVE-2017-5638-POC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #9

**来源**: [CVE-2017-5638-andypitcher_check_struts.md](../2017/CVE-2017-5638-andypitcher_check_struts.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP header，在服务器上执行任意命令。漏洞根源在于Struts2对Content-Type等header的处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个真实存在的且已被广泛利用的高危漏洞。网上存在大量的PoC代码，表明其有效性。

**投毒风险：**
提供的代码片段是一个GNU GPL v3许可协议。单独从这个LICENSE文件无法判断是否存在投毒代码，需要检查完整的漏洞利用程序。
然而，考虑到漏洞利用的性质（远程代码执行），如果攻击者能够控制漏洞利用代码，他们可以嵌入恶意代码，例如：

*   **植入后门：** 在目标系统上安装后门，以便长期控制。
*   **数据窃取：** 窃取目标系统上的敏感数据。
*   **恶意软件传播：** 将目标系统作为传播恶意软件的跳板。
*   **破坏系统：** 删除关键文件或使系统崩溃。

因此，在使用任何来自不可信来源的漏洞利用代码时，都必须非常谨慎，进行详细的代码审计，确保没有恶意行为。这里给出的“投毒风险”评估为10%，主要因为提供的代码段本身只是LICENSE信息，无法确定完整利用代码的安全性。需要对实际使用的利用代码进行更细致的分析。

**利用方式：**
利用方式主要通过以下步骤：

1.  **确定目标：** 确定运行存在漏洞的Apache Struts2版本的服务器。
2.  **构造恶意HTTP请求：** 构造包含恶意OGNL表达式的HTTP请求，通常在Content-Type header中，例如`Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getHeader('cmd')}`。`cmd` header 包含要执行的系统命令。
3.  **发送请求：** 将构造好的HTTP请求发送到目标服务器。
4.  **执行命令：** Struts2解析HTTP请求时，会执行恶意OGNL表达式，从而在服务器上执行攻击者指定的命令。

例如，攻击者可以使用curl命令发送包含恶意Content-Type header的请求：

```bash
curl -H 'Content-Type: %{#context["com.opensymphony.xwork2.dispatcher.HttpServletRequest"].map.class.forName("java.lang.Runtime").getRuntime().exec("id")}' http://target.com/example.action
```

此命令会在目标服务器上执行`id`命令，并将结果返回给攻击者。

总而言之，CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单且影响严重，需要及时修复。

**项目地址:** [andypitcher/check_struts](https://github.com/andypitcher/check_struts)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #10

**来源**: [CVE-2017-5638-colorblindpentester_CVE-2017-5638.md](../2017/CVE-2017-5638-colorblindpentester_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638（也称为S2-045）是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，此漏洞是有效的。搜索结果中包含了大量关于CVE-2017-5638的分析、利用和修复信息，表明这是一个真实且影响广泛的漏洞。PoC代码的存在进一步证实了其可利用性。

**投毒风险：**
提供的PoC代码本身就是利用该漏洞的脚本。要确定是否存在投毒风险，需要检查代码中是否存在恶意行为，例如下载和执行其他文件、篡改系统配置等。检查了给定的struts2_S2-045.py代码，它主要功能是构造payload执行命令，并没有发现明显的恶意投毒代码。虽然该代码可以用来执行任意命令，但这本身就是漏洞利用的目的，而不是额外添加的恶意功能。考虑到README.md文件极其简单，整个仓库并没有其他可疑文件，因此投毒风险较低，给出的估计值为5%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Jakarta Multipart parser处理HTTP请求头时。具体来说，当Struts2应用程序尝试解析包含恶意表达式的Content-Type头时，会导致OGNL表达式执行。
2.  **Payload构造：** 攻击者构造包含OGNL表达式的Content-Type头。该表达式利用Struts2的OGNL机制来绕过安全限制，并执行任意命令。
3.  **命令执行：** OGNL表达式首先获取对`OgnlContext`的引用，然后绕过默认的成员访问限制。接着，它使用`java.lang.ProcessBuilder`类来执行指定的命令。PoC中包含了针对Windows和Linux系统的不同命令执行方式。
4.  **结果返回：** 执行命令的结果通过`ServletActionContext.getResponse().getOutputStream()`获取输出流，并将命令执行的结果写入到HTTP响应中，返回给攻击者。

简单来说，利用方式就是通过精心构造的HTTP请求头，向存在漏洞的Struts2应用程序发送恶意payload，从而在服务器上执行任意命令。

**项目地址:** [colorblindpentester/CVE-2017-5638](https://github.com/colorblindpentester/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #11

**来源**: [CVE-2017-5638-haxerr9_CVE-2017-5638.md](../2017/CVE-2017-5638-haxerr9_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #12

**来源**: [CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md](../2017/CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许通过HTTP header传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 漏洞存在于Apache Struts2框架的Jakarta Multipart parser中，由于其在处理文件上传时的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP header来执行任意命令。

**有效性：**
提供的PoC代码是有效的，但它是一个安全的演示版本。它通过在Content-Type header中注入OGNL表达式，尝试设置一个自定义的HTTP响应头（X-Vuln）。如果服务器返回的响应中包含此header，则表示目标服务器可能存在漏洞。此PoC**不会**执行任何实际的恶意命令。

**投毒风险：**
分析了PoC代码和README文件，该仓库的目的是安全地演示该漏洞，而没有包含任何隐藏的或恶意的代码。没有发现任何投毒代码。因此, 投毒风险为 0%。

**利用方式：**
1.  **漏洞原理：** Struts2 使用Jakarta Multipart parser处理multipart请求，Content-Type头信息会被解析。如果Content-Type的值中包含OGNL表达式，并且OGNL表达式解析被启用，攻击者就可以利用OGNL表达式执行任意代码。
2.  **攻击方式：** 攻击者构造包含恶意OGNL表达式的Content-Type header，并发送给存在漏洞的Struts2服务器。
3.  **执行结果：** 服务器解析Content-Type header中的OGNL表达式，执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **PoC利用：** 提供的PoC利用代码通过发送包含`%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Vuln','Vulnerable')}`的Content-Type头来判断是否存在漏洞，成功则表示可能存在漏洞。

**项目地址:** [iampetru/PoC-CVE-2017-5638](https://github.com/iampetru/PoC-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #13

**来源**: [CVE-2017-5638-injcristianrojas_cve-2017-5638.md](../2017/CVE-2017-5638-injcristianrojas_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32 和 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且接受HTTP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 中的一个远程代码执行漏洞，存在于 Jakarta Multipart parser 中。当 Struts2 尝试处理文件上传时，如果 Content-Type、Content-Disposition 或 Content-Length HTTP 头部被恶意构造，将导致异常处理和错误消息生成过程出现问题，进而允许攻击者执行任意命令。

**漏洞利用方式：**

漏洞利用主要通过构造恶意的 Content-Type 头部，其中包含 OGNL 表达式。 OGNL（Object-Graph Navigation Language）是一种强大的表达式语言，用于访问和操作 Java 对象的属性。 攻击者通过在 Content-Type 头部中注入恶意的 OGNL 表达式，利用 Struts2 在解析请求时的漏洞，执行任意系统命令。

提供的漏洞利用代码包含两个 Python 脚本 (exploit1.py 和 exploit2.py)。

*   **exploit1.py:**  尝试通过在 Content-Type 中注入 OGNL 表达式，添加一个名为 "PWNED" 的 HTTP 头部，其值为 1337。这可以用来验证漏洞是否存在。
*   **exploit2.py:**  允许攻击者指定要执行的命令。 它构造一个更复杂的 OGNL 表达式，绕过某些安全限制，并使用 `java.lang.ProcessBuilder` 执行指定的命令，然后将命令的输出返回到 HTTP 响应中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞已经被广泛利用，提供的 POC 代码与已知的攻击方式一致，因此可以判断 POC 代码有效。

**投毒风险：**

提供的代码仓库包含一个 Jenkinsfile, 用于通过OWASP Dependency Check Plugin进行依赖检查, 这本身不属于投毒行为。 exploit1.py 和 exploit2.py 是利用漏洞的代码，也不构成投毒。仓库结构和代码内容来看，存在恶意投毒的可能性较低，约 5% 的可能性在于作者可能在其他未展示的文件中隐藏恶意代码，或者存在依赖污染的风险。总体而言，直接利用该仓库进行投毒的可能性较低，但仍需谨慎使用，建议在使用前进行详细的代码审计。

**项目地址:** [injcristianrojas/cve-2017-5638](https://github.com/injcristianrojas/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #14

**来源**: [CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md](../2017/CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可直接控制服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行受影响版本的Apache Struts2，并且存在文件上传功能或使用了Jakarta Multipart parser

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 框架中的一个远程代码执行漏洞，该漏洞源于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的POC是有效的。漏洞库和搜索结果都表明这是一个被广泛利用的漏洞，多个安全厂商和研究人员都发布了相关的分析和利用方法。

**投毒风险：**

分析提供的代码仓库内容，`README.md` 文件描述了漏洞信息和修复建议。`AvailableURL.txt` 包含可能存在漏洞的URL列表，`keyword.txt` 包含用于查找Struts2应用的关键词。`cmd.py` 是一个Python POC脚本，用于发送包含恶意Content-Type的HTTP请求，从而执行命令。

投毒风险较低，约为 5%。 虽然 `AvailableURL.txt` 中包含一些URL，可能被用于测试，但是这些URL并非恶意代码。 POC本身是利用漏洞执行命令，但并不包含主动植入后门或其他恶意行为的代码，因此，主要风险在于使用者可能会将此POC用于非法用途。

**利用方式：**

1.  攻击者构造包含恶意OGNL表达式的Content-Type HTTP头，例如 `Content-Type: multipart/form-data; boundary="+#cmd=whoami"`。
2.  攻击者向存在漏洞的Struts2应用发送包含上述恶意HTTP头的请求。
3.  Struts2应用使用Jakarta Multipart parser解析请求，由于Content-Type中包含恶意OGNL表达式，解析过程中会执行该表达式。
4.  服务器执行攻击者指定的命令，并将结果返回给攻击者。

提供的 `cmd.py` 脚本就是通过构造包含恶意Content-Type的HTTP请求来利用该漏洞的。

**项目地址:** [jas502n/S2-045-EXP-POC-TOOLS](https://github.com/jas502n/S2-045-EXP-POC-TOOLS)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #15

**来源**: [CVE-2017-5638-jas502n_st2-046-poc.md](../2017/CVE-2017-5638-jas502n_st2-046-poc.md)

## CVE-2017-5638 - Apache Struts2 Jakarta Multipart parser RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且对外开放HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts2 Jakarta Multipart parser 中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于文件上传过程中，对Content-Type, Content-Disposition或Content-Length等HTTP头处理不当造成的。攻击者可以通过构造恶意的HTTP头，特别是Content-Type，包含 `#cmd=` 字符串，来执行任意命令。 

**利用方式：**

提供的`exploit-cd.sh`脚本利用了Content-Disposition header中的 filename 字段，通过插入 null byte (\x00) 来触发 `InvalidFileNameException`，并利用OGNL表达式执行命令。脚本首先设置 Content-Type 为 `multipart/form-data`，然后构造包含恶意 OGNL 表达式的 payload，并将其作为 filename 的值插入到 Content-Disposition 头中。最后，使用 curl 发送包含精心构造的 HTTP 头的 POST 请求到目标 URL。payload 中，首先清空了OgnlUtil的ExcludedPackageNames和ExcludedClasses，避免了沙箱限制，然后通过ProcessBuilder执行了命令。这个脚本的有效性较高，因为它直接针对了漏洞的利用点。 `reqnull.txt` 文件也是类似的利用，只不过是预先构造的包含payload的HTTP请求。

**投毒风险：**

分析了提供的`exploit-cd.sh` 脚本和 `reqnull.txt`文件，没有发现明显的投毒代码。脚本的功能是利用漏洞执行任意命令，这本身就是漏洞利用的目的。脚本中所有的操作都是为了构造 payload 并发送请求，没有发现任何隐藏的恶意行为。因此，评估投毒风险为0%。

**项目地址:** [jas502n/st2-046-poc](https://github.com/jas502n/st2-046-poc)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #16

**来源**: [CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md](../2017/CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md)

## CVE-2017-5638-Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并可以通过HTTP请求访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Aon、Trend Micro等）以及Exploit-DB提供的PoC，该漏洞的利用是有效的。在实际环境中，CVE-2017-5638被广泛利用，造成了包括Equifax数据泄露在内的大规模安全事件。

**投毒风险：**
提供的代码库主要侧重于实时异常检测，而非直接的漏洞利用。它通过分析HTTP请求的3-gram特征，并使用Count-Min Sketch和KL散度来检测异常流量。虽然代码本身看起来没有明显的后门，但仍存在一些潜在风险，例如：

*   **依赖风险：** `requirements.txt` 如果包含恶意的第三方库，可能存在投毒风险。但提供的`requirements.txt`文件为空，降低了直接依赖投毒的风险。
*   **数据投毒：** 攻击者可能通过精心构造正常流量，污染Count-Min Sketch，降低检测准确性。由于系统依赖正常流量建立基线，通过大量伪装成正常的恶意请求，可能影响检测。
*   **日志记录：** 系统将检测结果记录到`data/detection.log`，如果日志配置不当，可能导致信息泄露或者日志文件被篡改。

综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP请求。
2.  恶意OGNL表达式位于Content-Type、Content-Disposition或Content-Length等HTTP头中。
3.  当Struts处理multipart请求时，解析这些HTTP头。
4.  Struts框架会执行恶意OGNL表达式，从而导致远程代码执行。

**缓解措施：**
*   升级Apache Struts到安全版本（>=2.3.32或>=2.5.10.1）。
*   使用Web应用防火墙（WAF）过滤恶意请求。
*   部署入侵检测系统（IDS）监控异常流量。
*   实施严格的输入验证和输出编码。

**项目地址:** [joidiego/Detection-struts-cve-2017-5638-detector](https://github.com/joidiego/Detection-struts-cve-2017-5638-detector)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #17

**来源**: [CVE-2017-5638-jongmartinez_CVE-2017-5638.md](../2017/CVE-2017-5638-jongmartinez_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且可从外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成存在缺陷，允许攻击者通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞的 PoC 代码是有效的。搜索引擎结果中多个链接表明该漏洞曾被广泛利用，并造成了严重的安全事件，如 Equifax 数据泄露事件。PoC 代码通过构造特定的 HTTP 头部，利用 OGNL 表达式注入执行系统命令，从而控制服务器。

**投毒风险评估：**

提供的 PoC 代码主要功能是利用漏洞执行命令。投毒风险评估如下：

*   **README.md:** 描述了漏洞利用方式，提供用法示例，没有发现恶意代码。
*   **cve-2017-5638.py:**  
    *   代码结构清晰，功能明确，实现了漏洞利用的核心逻辑。
    *   使用了 `requests` 库发送 HTTP 请求，符合漏洞利用的需要。
    *   OGNL 表达式的构造较为复杂，但其目的是为了绕过安全限制并执行命令。
    *   对执行命令的结果进行输出。
    *  try...except 块处理了可能的请求错误，使得程序更加健壮。
    
虽然代码功能正常，但存在以下潜在风险：

*   **命令执行权限：**  如果目标服务器以高权限运行，攻击者可以通过该漏洞获取高权限，造成更大的危害。
*   **日志记录：**  恶意利用可能被服务器日志记录，但攻击者可以尝试清除日志来隐藏踪迹。
*   **依赖风险：**  `requests` 库本身可能存在安全漏洞，间接影响该 PoC 的安全性。

综合来看，该代码主要风险在于被滥用，利用漏洞攻击目标系统，本身包含作者恶意投毒代码的可能性较低。投毒风险评估为10%。

**利用方式分析：**

1.  **构造恶意 HTTP 头部：**  攻击者通过修改 HTTP 请求的 Content-Type 头部，插入包含恶意 OGNL 表达式的字符串。
2.  **OGNL 表达式注入：**  恶意 OGNL 表达式被 Struts2 框架解析和执行，绕过安全限制，获取执行系统命令的权限。
3.  **执行任意命令：**  攻击者可以通过 OGNL 表达式执行任意系统命令，例如下载恶意文件、反弹 Shell 等。
4.  **获取服务器控制权：**  通过执行系统命令，攻击者可以获取服务器的控制权，进行恶意操作，例如数据窃取、恶意软件传播等。

**项目地址:** [jongmartinez/CVE-2017-5638](https://github.com/jongmartinez/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #18

**来源**: [CVE-2017-5638-jptr218_struts_hack.md](../2017/CVE-2017-5638-jptr218_struts_hack.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于其在处理文件上传时存在异常处理和错误消息生成方面的缺陷，允许远程攻击者通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析如下：

1.  **有效性：** 提供的POC代码通过构造包含 OGNL 表达式的 Content-Type 头部，利用 Struts 框架的漏洞执行任意命令，该方法是有效的。搜索引擎结果和漏洞库信息均表明此漏洞是一个高危且被广泛利用的远程代码执行漏洞。

2.  **投毒风险：** 投毒风险较低，约为10%。虽然该仓库提供了一个预编译的exe文件，但exe文件是一个struts漏洞利用工具,功能上与漏洞库和搜索引擎信息一致,其源代码也被一并给出。潜在的风险在于：
    *   **预编译的二进制文件可能包含恶意代码。** 虽然提供了源代码，但用户在使用前通常不会仔细审计所有代码。
    *   **Payload生成逻辑** payload.cpp 中 OGNL 表达式的构造虽然直接，但也存在被篡改以执行恶意操作的可能性。

3.  **利用方式：**
    *   攻击者发送一个特制的 HTTP 请求到目标服务器，该请求的 Content-Type 头部包含一个 OGNL 表达式。
    *   Struts 框架在处理该请求时，会解析并执行该 OGNL 表达式。
    *   攻击者可以使用 OGNL 表达式来执行任意命令，例如，通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令，从而获取对服务器的控制权。
    *   POC代码中，telnet函数建立socket链接，并持续发送payload，从而建立telnet连接，进入控制台。

 4. **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jptr218/struts_hack](https://github.com/jptr218/struts_hack)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #19

**来源**: [CVE-2017-5638-jrrombaldo_CVE-2017-5638.md](../2017/CVE-2017-5638-jrrombaldo_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #20

**来源**: [CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md](../2017/CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md)

## CVE-2017-5638 Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-5638是Apache Struts Jakarta Multipart解析器中的一个漏洞，由于不正确的异常处理和错误消息生成，允许远程攻击者通过精心构造的Content-Type、Content-Disposition或Content-Length HTTP头执行任意命令。漏洞利用方式是通过在HTTP请求头中注入OGNL表达式，服务器在解析过程中会执行该表达式，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且存在多个可用的POC。提供的POC代码`Invoke-WebRequest -Uri "http://localhost:8080/" -Method POST -Headers @{ "Content-Type" = "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('AttackSuccessTestingRCE',2*2)}.multipart/form-data" }` 尝试通过修改Content-Type头来触发漏洞，并设置一个特定的header 'AttackSuccessTestingRCE' 来检测漏洞是否被成功利用，该代码能够达到漏洞检测效果，因此该POC有效。

**投毒风险：**
提供的两个文件，一个是PowerShell命令用于测试，另一个是Jupyter Notebook，其中定义了一个 Flask 应用来模拟存在漏洞的 Struts 应用，并检测 header 中是否存在恶意代码的特征。虽然这个 Flask 应用本身是为了演示漏洞，但如果直接部署到生产环境，可能存在潜在的风险。但是代码分析来看，没有明显的恶意代码。Demos.ipynb 中的检测恶意代码的逻辑 `SUSPICIOUS_PATTERNS = ["%{", "Runtime.getRuntime", "ProcessBuilder"]`，可以检测到OGNL表达式相关的Payload。因此投毒风险存在，但不是很高，大约20%。

**利用方式：**
攻击者通过发送包含恶意OGNL表达式的HTTP请求，该表达式被注入到Content-Type、Content-Disposition 或 Content-Length 等HTTP头中。Struts在处理Multipart请求时，由于使用了存在漏洞的Jakarta Multipart解析器，会尝试解析这些头，从而触发OGNL表达式的执行。攻击者可以利用OGNL表达式执行任意系统命令，例如下载恶意软件、修改系统配置或窃取敏感数据。

**项目地址:** [kaylertee/Computer-Security-Equifax-2017](https://github.com/kaylertee/Computer-Security-Equifax-2017)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #21

**来源**: [CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md](../2017/CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md)

## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #22

**来源**: [CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md](../2017/CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md)

## CVE-2017-5638 - Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts 2，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于不正确的异常处理和错误消息生成，远程攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 标头执行任意命令。攻击者通常会在 Content-Type 标头中包含 #cmd= 字符串。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确定此漏洞是有效的。大量的公开信息和可用的POC代码表明该漏洞已被广泛研究和利用。

**投毒风险：**
提供的代码包含两个文件：dorker.py 和 exploit.py。

*   **dorker.py：** 这是一个用于搜索引擎爬取的脚本，主要用于查找可能存在漏洞的Struts 2应用。它使用Google、Bing、Yahoo和Baidu等搜索引擎来搜索特定的dorks（搜索字符串）。该脚本本身不太可能包含恶意代码，因为它主要负责信息收集。
*   **exploit.py：** 该脚本包含实际的漏洞利用代码，用于向目标系统发送恶意请求以执行任意命令。虽然脚本的主要功能是利用漏洞，但仍然存在一定的投毒风险。风险点在于执行命令的部分，如果攻击者将恶意命令嵌入到脚本中，可能会对目标系统造成损害。例如，可以修改脚本以默认执行特定的恶意操作，或者在成功利用后植入后门。

因此，虽然 `exploit.py` 的主要目的是为了利用漏洞, 但依然需要谨慎检查其执行命令的部分。`dorker.py` 脚本本身不太可能包含恶意代码。综合分析，投毒风险评估为 10%。主要风险在于，如果下载来源不可信，下载的 `exploit.py` 文件可能已经被篡改，嵌入了恶意代码。

**利用方式：**
1.  **确定目标：** 使用 `dorker.py` 脚本或其他方法查找可能存在漏洞的 Apache Struts 2 应用。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本构造包含恶意 OGNL 表达式的 HTTP 请求。恶意表达式通常嵌入在 Content-Type 标头中。
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 Struts 2 应用。
4.  **执行命令：** 如果目标系统存在漏洞，恶意 OGNL 表达式将被执行，从而导致在服务器上执行任意命令。

**项目地址:** [leandrocamposcardoso/CVE-2017-5638-Mass-Exploit](https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #23

**来源**: [CVE-2017-5638-ludy-dev_XworkStruts-RCE.md](../2017/CVE-2017-5638-ludy-dev_XworkStruts-RCE.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，并且可以通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的POC代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者通过特制的HTTP头部执行任意命令，而搜索结果中也提供了大量的分析和利用案例。POC代码通过构造含有OGNL表达式的Content-Type头部，尝试在目标服务器上写入JSP后门，验证漏洞的存在。

**投毒风险分析：**

经过对提供的POC代码进行分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标服务器上创建一个JSP文件（k22mn7.jsp），实现webshell的功能，从而验证漏洞的存在和进行进一步的利用。代码本身逻辑比较清晰，没有发现隐藏的恶意行为。 投毒风险评估为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **构造恶意HTTP请求：** 攻击者需要构造一个包含恶意OGNL表达式的HTTP请求，特别是Content-Type头部。该表达式会被Struts2框架解析执行。
2.  **利用OGNL执行代码：** 恶意OGNL表达式用于在目标服务器上执行任意代码。常见的利用方式是在服务器上写入一个webshell，或者直接执行系统命令。
3.  **访问webshell：** 如果成功写入webshell，攻击者可以通过访问webshell来控制目标服务器。 

POC代码中的OGNL表达式尝试在服务器的`/k22mn7.jsp`处写入一个JSP后门，以便进一步控制。该POC首先尝试清除ognlUtil的排除列表，然后从输入流拷贝内容到`/k22mn7.jsp`，最后输出`upload_ok`。

漏洞利用的关键在于构造能够绕过Struts2安全机制的恶意OGNL表达式，并将其插入到HTTP头部中。

**项目地址:** [ludy-dev/XworkStruts-RCE](https://github.com/ludy-dev/XworkStruts-RCE)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #24

**来源**: [CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md](../2017/CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #25

**来源**: [CVE-2017-5638-mritunjay-k_CVE-2017-5638.md](../2017/CVE-2017-5638-mritunjay-k_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #26

**来源**: [CVE-2017-5638-mthbernardes_strutszeiro.md](../2017/CVE-2017-5638-mthbernardes_strutszeiro.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过在Content-Type、Content-Disposition或Content-Length HTTP头中构造恶意OGNL表达式来执行任意命令。

**有效性分析：**
漏洞库信息、搜索引擎结果以及提供的漏洞利用代码都表明这是一个真实且高危的漏洞。搜索引擎结果中包含了漏洞的详细描述、利用方式以及受影响的版本。提供的漏洞利用代码是一个Telegram Bot，用于管理利用该漏洞创建的僵尸网络。该Bot通过Telegram命令来添加受害者服务器、执行命令等，进一步验证了漏洞的可利用性。

**投毒风险分析：**
该漏洞利用代码（strutszeiro.py及其相关文件）的投毒风险较低，约为10%。 主要风险点如下：

*   **配置文件：** `conf/token.conf` 和 `conf/group.conf` 存储了Telegram Bot的API Token和群组ID。如果攻击者控制了这些配置文件，他们可以窃取bot控制权，监控所有受害者服务器。
*   **actions.py:**botnet 方法中 cmd 的命令未校验，存在一定风险。
*  **strutszeiro.py:** 判断 chat_type 是否为 'group' ，存在一定风险，如果攻击者知道了bot token，私聊也能控制该bot。

代码本身的主要功能是利用Struts2漏洞进行远程命令执行，没有发现明显的后门或恶意代码。但是，用户需要谨慎配置Telegram Bot，并保护好API Token，防止泄露。

**利用方式：**

1.  **漏洞触发：** 攻击者发送包含恶意OGNL表达式的HTTP请求到存在漏洞的Struts2服务器。通常，这个表达式位于Content-Type头部，利用Jakarta Multipart parser的解析过程。
2.  **命令执行：** Struts2服务器在解析请求头时，会执行OGNL表达式，导致任意命令执行。
3.  **僵尸网络控制：** 提供的漏洞利用代码构建了一个Telegram Bot，攻击者可以通过该Bot远程控制受影响的服务器。
4.  **Telegram Bot命令：** 攻击者可以通过Telegram命令添加新的受害者服务器（`/add url`），在特定服务器上执行命令（`/exploit url *cmd`），在所有受害者服务器上执行命令（`/botnet cmd`），以及列出所有受害者服务器（`/list`）。

**项目地址:** [mthbernardes/strutszeiro](https://github.com/mthbernardes/strutszeiro)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #27

**来源**: [CVE-2017-5638-readloud_CVE-2017-5638.md](../2017/CVE-2017-5638-readloud_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #28

**来源**: [CVE-2017-5638-sighup1_cybersecurity-struts2.md](../2017/CVE-2017-5638-sighup1_cybersecurity-struts2.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头，特别是 Content-Type 头，其中包含 '#cmd=' 字符串，来执行任意命令。

**有效性：**
提供的 PoC 代码利用了 OGNL 表达式注入，通过修改 Content-Type 头来执行系统命令。根据漏洞库信息、搜索结果和 PoC 代码描述，该漏洞的利用方式是有效的。

**投毒风险：**
该仓库存在一定的投毒风险，评估约为10%。理由如下：
*   **免责声明：**仓库包含免责声明，这可能是为了规避潜在的法律责任，但并不能完全排除恶意目的。仓库作者声明“This is meant for educational, and research purposes only. I do not authorize or endorse any illegal or unethical use of this projects contents or information”，可能存在诱导使用者进行非法用途。
*   **不透明性：** 仓库作者在payload中调用了自定义的edu.uvu.ms.cybersecurity.Command类。如果没有对edu.uvu.ms.cybersecurity.Command类进行仔细的代码审计，可能存在恶意代码。如果 Command 类做了超出描述之外的事情（例如，记录命令、尝试提权、扫描网络等），那就存在风险。代码示例中， (#p.print('hello from MSCybersecurity'))这部分可能被替换为更具危害性的操作。
*   **依赖性：** PoC 需要 Send.jar。如果 Send.jar 来源不明或者被篡改，则可能存在安全风险。
*   **复杂性：** OGNL 表达式本身就非常复杂，容易隐藏恶意代码。 即使 payload 中的大部分逻辑看起来是良性的（例如，设置 Content-Type、清理 excludedPackageNames 等）， 仍然可能存在隐藏的、难以察觉的恶意代码片段。
*   **利用普及程度：**由于该漏洞影响广泛，并且利用代码已经公开，攻击者可以修改或者添加恶意代码，伪装成正常的 PoC，传播恶意软件或后门。

**利用方式：**
1.  攻击者发送一个特制的 HTTP 请求，该请求的 Content-Type 头包含恶意的 OGNL 表达式。
2.  Struts2 框架的 Jakarta Multipart parser 在处理该请求时，由于异常处理不当，会将 OGNL 表达式传递给 OGNL 引擎。
3.  OGNL 引擎执行该表达式，导致任意代码执行。
4.  PoC 代码展示了如何通过 OGNL 表达式来实例化 Java 类、调用方法和执行系统命令。
5.  攻击者利用该漏洞可以在服务器上执行任意命令，从而获取敏感信息、篡改数据或完全控制服务器。

**项目地址:** [sighup1/cybersecurity-struts2](https://github.com/sighup1/cybersecurity-struts2)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #29

**来源**: [CVE-2017-5638-sonatype-workshops_struts2-rce.md](../2017/CVE-2017-5638-sonatype-workshops_struts2-rce.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-5638 是 Apache Struts 2 的一个远程代码执行漏洞，源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析：

*   **Dockerfile:** 该文件用于构建包含存在漏洞的 Struts 2 应用的 Docker 镜像。它基于 tomcat:7 镜像，并将 struts2-rest-showcase.war 部署到 Tomcat 的 webapps 目录下，暴露了8080端口。这本身不是漏洞利用代码，而是漏洞测试环境的准备。
*   **Jenkinsfile:** 该文件定义了 Jenkins 构建流程，包括代码检出、Maven 构建和 Nexus Lifecycle Evaluation。它使用 Maven 打包 Struts 2 应用，但没有直接的漏洞利用代码。其中`nexusPolicyEvaluation` 可能存在风险，通过配置`iqApplication`应用ID，可能可以对应用进行安全分析。
*   **LICENSE.txt:** Apache 2.0 许可协议。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞利用的POC是存在的，并且在野外被广泛利用。提供的Dockerfile 可以搭建一个存在漏洞的环境， Jenkinsfile 是项目的构建文件，二者结合可以认为该漏洞是可以复现和利用的

**投毒风险：**
虽然提供的代码片段主要用于构建和部署存在漏洞的 Struts 2 应用，并没有明显的恶意代码。但是`Jenkinsfile`文件中的`nexusPolicyEvaluation` 可能存在风险， 通过配置恶意`iqApplication`应用ID,对构建的应用投毒，但是概率较低.

**利用方式：**
攻击者通常会发送一个包含恶意构造的 Content-Type 头部（例如，包含 `#cmd=` 字符串）的 HTTP 请求。这个恶意头部会触发 Struts 2 中的 OGNL 表达式注入，从而允许攻击者执行任意命令。具体的利用方式包括：

1.  发送包含恶意 Content-Type 头部的 HTTP 请求。
2.  利用 OGNL 表达式执行系统命令。
3.  获取服务器的控制权。

**项目地址:** [sonatype-workshops/struts2-rce](https://github.com/sonatype-workshops/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #30

**来源**: [CVE-2017-5638-tahmed11_strutsy.md](../2017/CVE-2017-5638-tahmed11_strutsy.md)

## CVE-2017-5638 Apache Struts 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.5-2.3.31, 2.5-2.5.10

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，并且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts框架中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传请求时，由于Content-Type头信息解析错误，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头信息，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞是有效的。搜索结果中提到该漏洞被广泛利用，并导致了严重的安全事件，例如Equifax数据泄露事件。提供的Python代码是一个POC，可以用于验证和利用该漏洞。

**投毒风险：**
虽然代码看起来是直接的漏洞利用程序，但是仍然存在一定的投毒风险。以下是风险评估和分析：
*   **网络请求依赖:** 代码依赖 `urllib2`，需要能够访问互联网。攻击者可能会修改代码，使其在特定条件下向恶意服务器发送敏感信息，或者从恶意服务器下载payload执行。这个风险较低，因为基本功能是命令执行。
*   **命令执行：** POC代码允许执行任意命令。如果该代码被修改并分发，攻击者可以将恶意命令硬编码到POC中，从而感染所有使用修改后POC的用户。
*   **Blind Injection 的依赖:** 代码中的blind injection依赖于外部IP并且需要apache可以读取log文件。此过程可能存在后门代码，但是需要进一步分析，才能判断。

 总体来说，该仓库中存在作者隐藏投毒代码的风险较低，大概在10%左右。 主要风险在于使用者不清楚代码逻辑，直接修改其中的cmd参数。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，特别是Content-Type头。
2.  当Struts应用解析该请求时，恶意OGNL表达式会被执行。
3.  攻击者可以利用OGNL表达式执行任意系统命令，例如反弹shell，上传恶意文件等。
4.  提供的POC代码利用了这一漏洞，通过修改Content-Type头，在目标服务器上执行指定的命令。


**项目地址:** [tahmed11/strutsy](https://github.com/tahmed11/strutsy)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #31

**来源**: [CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md](../2017/CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #32

**来源**: [CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md](../2017/CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #33

**来源**: [CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md](../2017/CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md)

# CVE-2017-5638

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-5638-Badbird3_CVE-2017-5638.md](../2017/CVE-2017-5638-Badbird3_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #2

**来源**: [CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md](../2017/CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是一个 Apache Struts2 的远程代码执行漏洞，存在于 Jakarta Multipart parser 中。由于不正确的异常处理和错误消息生成，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头来执行任意命令。从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞利用的有效性非常高，因为在2017年3月已经被广泛利用。漏洞利用代码中的`CVE-2017-5638ApacheStruts.py`脚本通过构造包含OGNL表达式的Content-Type头来触发漏洞，从而执行任意命令。利用方式是通过发送一个精心构造的HTTP请求，其中Content-Type头包含一个OGNL表达式，该表达式允许攻击者执行任意系统命令。

**有效性:**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的有效性非常高，且POC代码能够复现。

**投毒风险:**
POC代码主要功能是发送恶意请求并执行命令。虽然存在一定的风险（例如，命令执行不当导致系统不稳定），但不存在明显的恶意投毒代码。代码结构较为清晰，主要包含参数解析、payload生成和请求发送三个部分。代码中可能的风险点在于，攻击者可以利用此代码执行任意命令，因此存在滥用的风险。但代码本身的功能是为了验证漏洞，并无主动传播恶意代码的功能。我给出的投毒风险评估为5%，主要考虑是：

*   代码作者可能会在代码中添加一些隐藏的后门代码，例如，收集目标服务器的信息并发送到攻击者的服务器，或者在目标服务器上安装恶意软件。
*   代码用户可能会在使用代码时，不小心执行了恶意命令，从而导致系统被入侵。

**利用方式:**
1.  **目标确定:** 确定目标服务器上运行的Apache Struts2版本是否在受影响范围内（2.3.x before 2.3.32 或 2.5.x before 2.5.10.1）。
2.  **Payload构造:** 使用POC代码中的`creating_payload`函数构造包含恶意命令的OGNL表达式payload。 例如：要执行 `whoami` 命令，使用 `-c whoami` 参数。
3.  **请求发送:** 使用POC代码中的`execute`函数，将构造好的payload作为Content-Type头的值，发送HTTP请求到目标服务器的`.action`文件。POC代码会打印命令执行的结果。
4.  **结果分析:** 分析命令执行的结果，判断漏洞是否成功利用。

总而言之，该漏洞利用代码的有效性高，但存在较低的投毒风险。使用时务必谨慎，并确保在授权的环境下进行。


**项目地址:** [FredBrave/CVE-2017-5638-ApacheStruts2.3.5](https://github.com/FredBrave/CVE-2017-5638-ApacheStruts2.3.5)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #3

**来源**: [CVE-2017-5638-Iletee_struts2-rce.md](../2017/CVE-2017-5638-Iletee_struts2-rce.md)

## CVE-2017-5638-Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且可通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理不当。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2017-5638是一个被广泛利用的漏洞。存在公开可用的PoC代码，并且Metasploit框架中也存在利用模块，因此该漏洞的利用有效性很高。

提供的Dockerfile和Jenkinsfile用于构建和部署一个Struts2应用，但本身不包含漏洞利用代码。而是提供了一个包含漏洞的Struts2环境，方便演示和复现。

**投毒风险：**

虽然提供的Dockerfile和Jenkinsfile本身不包含明显的恶意代码，但存在一定的投毒风险：

*   **依赖风险：** Dockerfile中使用了`tomcat:7`镜像，存在该镜像可能包含已知漏洞的风险。Jenkinsfile中maven deploy可能会将构建的组件上传到外部maven仓库，若该仓库被入侵，则存在组件投毒的风险
*   **间接投毒：** Dockerfile中的`COPY target/struts2-rest-showcase.war /usr/local/tomcat/webapps/ROOT.war`，如果`struts2-rest-showcase.war`本身被替换为包含恶意代码的版本，则可能造成投毒。Jenkinsfile拉取的scm如果被恶意人员修改，则存在投毒风险。
*   **Jenkinsfile风险:** Jenkinsfile 中的`postGitHub` 函数，使用了github api token，若该token泄露，则可能导致项目代码被篡改。

综合评估，投毒风险大约为10%，主要来自于依赖风险和构建过程中的潜在恶意代码注入。

**利用方式：**

利用CVE-2017-5638漏洞的典型方式如下：

1.  **构造恶意HTTP请求：**  攻击者构造包含恶意Ognl表达式的Content-Type头部的HTTP请求。
2.  **发送请求：**  将构造好的HTTP请求发送到存在漏洞的Struts2服务器。
3.  **远程代码执行：**  Struts2服务器解析Content-Type头部时，会执行其中的恶意Ognl表达式，从而导致远程代码执行。

攻击者可以通过远程代码执行在服务器上执行任意命令，例如反弹shell、读取敏感文件、修改系统配置等。

一些公开的PoC利用了`#cmd=`字符串来执行系统命令，如`Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW; #cmd=whoami`



**项目地址:** [Iletee/struts2-rce](https://github.com/Iletee/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #4

**来源**: [CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md](../2017/CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且对外开放HTTP端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是 Apache Struts 2 Jakarta Multipart parser 中的一个远程代码执行漏洞。该漏洞是由于在文件上传过程中，对Content-Type、Content-Disposition或Content-Length HTTP header处理不当造成的，攻击者可以通过构造恶意的HTTP头部，利用OGNL表达式注入执行任意命令。

**有效性：** 根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索引擎结果中包含多个关于CVE-2017-5638的PoC和分析，说明该漏洞已经被广泛研究和利用。POC代码通过构造包含恶意OGNL表达式的Content-Type头部，发送POST请求到存在漏洞的Apache Struts2应用，从而执行任意命令。

**投毒风险：**  分析提供的`exploit.py.txt`和`README.md`文件。`README.md`文件只是漏洞利用说明，不包含任何代码。`exploit.py.txt` 文件中的Python代码用于利用 CVE-2017-5638 漏洞。代码首先定义了目标URL和包含恶意 OGNL 表达式的 payload。Payload 构造了一个命令执行的 OGNL 表达式，并在目标系统上执行 `ls /` 命令，将输出返回到响应中。然后，它使用 `requests` 库发送一个包含恶意 header 的 POST 请求到目标 URL。代码没有发现任何隐藏的或恶意的后门或投毒代码。payload 的目的是执行命令，而不是植入长期存在的恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **构造恶意HTTP头部：** 攻击者构造包含恶意OGNL表达式的Content-Type、Content-Disposition或Content-Length HTTP头部。在该POC中，恶意代码位于Content-Type头中。
2.  **发送请求：** 攻击者将构造好的HTTP请求发送到存在漏洞的Apache Struts2应用。
3.  **命令执行：** Struts2应用在处理请求时，由于错误的异常处理和错误消息生成，会将恶意OGNL表达式解析并执行，从而导致远程代码执行。在该POC中，执行了`ls /`命令。
4.  **获取结果：** 攻击者从HTTP响应中获取命令执行的结果。

**项目地址:** [MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION](https://github.com/MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #5

**来源**: [CVE-2017-5638-Nithylesh_web-application-firewall-.md](../2017/CVE-2017-5638-Nithylesh_web-application-firewall-.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性:**
提供的`vulnerable.py`脚本可以有效利用此漏洞，通过设置恶意的`Content-Type`头，向目标服务器发送包含OGNL表达式的HTTP请求，从而执行任意命令。

**投毒风险:**
仓库中存在投毒代码的风险较低，约10%。分析如下：
  * `server.py`文件模拟了一个简单的WAF，但其阻止模式相当基础，可能被绕过。
  * `vulnerable.py`脚本是漏洞利用的核心，其本身的目的就是执行任意命令，这使得判断其中是否包含恶意代码变得困难。尽管如此，脚本逻辑相对清晰，主要是构造payload发送请求并打印响应。但是依旧存在以下情况:
  * 存在隐藏的反向shell或者其他恶意指令的可能，但需要进一步分析才能确定。

**利用方式:**
1.  攻击者发送特制的HTTP请求，该请求的`Content-Type`头包含恶意的OGNL表达式。
2.  Struts2框架在处理multipart请求时，会解析`Content-Type`头。
3.  由于漏洞存在，OGNL表达式会被执行，从而在服务器上执行攻击者指定的命令。
4.  `vulnerable.py` 脚本通过 `check_vulnerability` 和 `execute_command` 函数展示了如何构造包含恶意OGNL表达式的 `Content-Type` 头并发送请求。

**优先级排序理由:**
搜索引擎结果提供了漏洞的基本信息和利用场景，但漏洞利用代码 `vulnerable.py` 更为关键，因为它直接展示了漏洞的利用方式。漏洞库信息作为补充，提供了漏洞影响的版本范围和基本描述。


**项目地址:** [Nithylesh/web-application-firewall-](https://github.com/Nithylesh/web-application-firewall-)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #6

**来源**: [CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md](../2017/CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且允许通过HTTP请求与目标交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞存在于 Jakarta Multipart parser 中，由于其在处理文件上传时的异常处理和错误消息生成不正确导致。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头，在服务器上执行任意命令。

**有效性：**

提供的PoC代码通过修改Content-Type头部，利用OGNL表达式注入恶意代码，从而实现远程代码执行。根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，因此PoC代码的有效性较高。

**投毒风险：**

PoC 代码本身是为了利用漏洞而编写的，其目的是执行任意命令。 从提供的代码来看，核心功能是构造包含恶意 OGNL 表达式的 HTTP 头部。
代码通过 Content-Type 注入 OGNL 表达式，该表达式首先获取 OgnlContext，然后清空了 OGNL 的黑名单，以便执行任意代码。接着，它使用 java.lang.ProcessBuilder 执行指定的命令，并将命令执行的结果返回。

综合分析，PoC 代码的功能是利用漏洞，而不是植入后门或进行其他恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  攻击者发送一个包含恶意Content-Type HTTP头的请求到目标服务器。
2.  恶意Content-Type头中包含OGNL表达式，该表达式能够执行任意系统命令。
3.  Struts2框架解析该请求时，会执行OGNL表达式，从而导致远程代码执行。
4.  攻击者通过执行系统命令，可以获取服务器的控制权。

**总结：**

CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单，影响广泛。提供的PoC代码可以有效利用该漏洞。该PoC代码本身没有投毒风险，但攻击者可以利用该PoC代码攻击未修复的Struts2应用。

**项目地址:** [QHxDr-dz/CVE-2017-5638](https://github.com/QHxDr-dz/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #7

**来源**: [CVE-2017-5638-Tankirat_CVE-2017-5638.md](../2017/CVE-2017-5638-Tankirat_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许通过HTTP进行访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 框架的 Jakarta Multipart parser 中。当处理文件上传时，由于异常处理和错误消息生成不当，攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部来执行任意命令。在野外攻击中，通常使用包含 `#cmd=` 字符串的 Content-Type 头部。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的PoC。漏洞利用代码描述了漏洞原理和利用方法，表明该漏洞的有效性较高。

**投毒风险：**
提供的漏洞利用代码（`/tmp/3bf1e344cbece4d19a9e8c32c2245913/README.md`） 主要是漏洞的介绍文档，描述了漏洞的原理、影响、利用方法、案例分析（Equifax 数据泄露），以及预防措施和参考链接。其中虽然引用了github上漏洞扫描工具，但本身readme文件不具备可执行的攻击代码。所以投毒风险较低，但不能完全排除作者通过其他方式进行投毒，比如在引用的链接中做手脚。所以评定投毒风险为10%。

**利用方式：**
1.  攻击者发送包含恶意构造的 HTTP 头部（例如，Content-Type）的请求到存在漏洞的 Apache Struts 应用。
2.  恶意的 HTTP 头部包含 Object-Graph Navigation Language (OGNL) 表达式。
3.  Struts 应用在解析 HTTP 头部时，会将 OGNL 表达式传递给 `LocalizedTextUtil.findText` 函数进行处理。
4.  `LocalizedTextUtil.findText` 函数会将 `${...}` 中的内容解释为 OGNL 表达式并执行。
5.  攻击者可以通过 OGNL 表达式执行任意系统命令，从而实现远程代码执行。

攻击成功的关键在于构造包含恶意 OGNL 表达式的 HTTP 头部，例如 `Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','vuln')}`。其中OGNL表达式可以执行任意命令，获取敏感信息，或者植入后门。

该漏洞曾被广泛利用，导致了包括 Equifax 数据泄露在内的多起重大安全事件。

**项目地址:** [Tankirat/CVE-2017-5638](https://github.com/Tankirat/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #8

**来源**: [CVE-2017-5638-Xernary_CVE-2017-5638-POC.md](../2017/CVE-2017-5638-Xernary_CVE-2017-5638-POC.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标服务器运行存在漏洞版本的Apache Struts2，且允许POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，由于错误处理和错误消息生成不当，导致攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头来执行任意命令。根据提供的漏洞库信息，漏洞的利用方式是通过在Content-Type头中包含 '#cmd=' 字符串来执行命令，并根据搜索结果确认该漏洞已被广泛利用。

**有效性：**
提供的`exploit.py`脚本通过构造包含OGNL表达式的Content-Type头来实现远程代码执行。该表达式利用OGNL绕过安全限制，执行指定的命令并将结果返回。该PoC代码的逻辑是正确的，并且与漏洞描述相符，因此有效。

**投毒风险：**
审查提供的 Dockerfile 和脚本，可以发现潜在的投毒风险。
*   `server-setup-script.sh`: 该脚本从华为云镜像下载了JDK 8u171，但是考虑到华为云镜像可能已经发生了变更（被投毒），因此存在一定的风险。此外，该脚本中没有检查下载的JDK的完整性，如果下载过程中被篡改，可能导致系统被植入后门。`pwn-page.jsp` 在服务器遭受攻击后会部署该页面。
* `exploit.py`，该脚本本身没有包含明显的恶意代码，但如果被攻击者修改，例如在执行命令之前添加下载和执行恶意文件的功能，也可能成为投毒的途径。`startup.sh` 这个脚本仅仅是用来启动 tomcat 服务。并且Dockerfile 最终启动的命令是 `CMD ["sh", "-c", "./startup.sh && bash"]`， 该命令会启动一个交互式的shell。

因此，综合评估投毒风险大约为10%。虽然没有发现直接的、明显的投毒代码，但是下载的外部资源以及执行流程存在被利用的潜在风险，需要谨慎对待。

**利用方式：**
1.  攻击者发送一个精心构造的HTTP POST请求到存在漏洞的Struts2服务器。
2.  该请求的Content-Type头包含一个恶意的OGNL表达式，该表达式利用Struts2的OGNL解析器执行任意命令。
3.  服务器执行该命令，并将结果返回给攻击者。

**总结：**
CVE-2017-5638 是一个严重的安全漏洞，利用简单，危害巨大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [Xernary/CVE-2017-5638-POC](https://github.com/Xernary/CVE-2017-5638-POC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #9

**来源**: [CVE-2017-5638-andypitcher_check_struts.md](../2017/CVE-2017-5638-andypitcher_check_struts.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP header，在服务器上执行任意命令。漏洞根源在于Struts2对Content-Type等header的处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个真实存在的且已被广泛利用的高危漏洞。网上存在大量的PoC代码，表明其有效性。

**投毒风险：**
提供的代码片段是一个GNU GPL v3许可协议。单独从这个LICENSE文件无法判断是否存在投毒代码，需要检查完整的漏洞利用程序。
然而，考虑到漏洞利用的性质（远程代码执行），如果攻击者能够控制漏洞利用代码，他们可以嵌入恶意代码，例如：

*   **植入后门：** 在目标系统上安装后门，以便长期控制。
*   **数据窃取：** 窃取目标系统上的敏感数据。
*   **恶意软件传播：** 将目标系统作为传播恶意软件的跳板。
*   **破坏系统：** 删除关键文件或使系统崩溃。

因此，在使用任何来自不可信来源的漏洞利用代码时，都必须非常谨慎，进行详细的代码审计，确保没有恶意行为。这里给出的“投毒风险”评估为10%，主要因为提供的代码段本身只是LICENSE信息，无法确定完整利用代码的安全性。需要对实际使用的利用代码进行更细致的分析。

**利用方式：**
利用方式主要通过以下步骤：

1.  **确定目标：** 确定运行存在漏洞的Apache Struts2版本的服务器。
2.  **构造恶意HTTP请求：** 构造包含恶意OGNL表达式的HTTP请求，通常在Content-Type header中，例如`Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getHeader('cmd')}`。`cmd` header 包含要执行的系统命令。
3.  **发送请求：** 将构造好的HTTP请求发送到目标服务器。
4.  **执行命令：** Struts2解析HTTP请求时，会执行恶意OGNL表达式，从而在服务器上执行攻击者指定的命令。

例如，攻击者可以使用curl命令发送包含恶意Content-Type header的请求：

```bash
curl -H 'Content-Type: %{#context["com.opensymphony.xwork2.dispatcher.HttpServletRequest"].map.class.forName("java.lang.Runtime").getRuntime().exec("id")}' http://target.com/example.action
```

此命令会在目标服务器上执行`id`命令，并将结果返回给攻击者。

总而言之，CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单且影响严重，需要及时修复。

**项目地址:** [andypitcher/check_struts](https://github.com/andypitcher/check_struts)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #10

**来源**: [CVE-2017-5638-colorblindpentester_CVE-2017-5638.md](../2017/CVE-2017-5638-colorblindpentester_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638（也称为S2-045）是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，此漏洞是有效的。搜索结果中包含了大量关于CVE-2017-5638的分析、利用和修复信息，表明这是一个真实且影响广泛的漏洞。PoC代码的存在进一步证实了其可利用性。

**投毒风险：**
提供的PoC代码本身就是利用该漏洞的脚本。要确定是否存在投毒风险，需要检查代码中是否存在恶意行为，例如下载和执行其他文件、篡改系统配置等。检查了给定的struts2_S2-045.py代码，它主要功能是构造payload执行命令，并没有发现明显的恶意投毒代码。虽然该代码可以用来执行任意命令，但这本身就是漏洞利用的目的，而不是额外添加的恶意功能。考虑到README.md文件极其简单，整个仓库并没有其他可疑文件，因此投毒风险较低，给出的估计值为5%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Jakarta Multipart parser处理HTTP请求头时。具体来说，当Struts2应用程序尝试解析包含恶意表达式的Content-Type头时，会导致OGNL表达式执行。
2.  **Payload构造：** 攻击者构造包含OGNL表达式的Content-Type头。该表达式利用Struts2的OGNL机制来绕过安全限制，并执行任意命令。
3.  **命令执行：** OGNL表达式首先获取对`OgnlContext`的引用，然后绕过默认的成员访问限制。接着，它使用`java.lang.ProcessBuilder`类来执行指定的命令。PoC中包含了针对Windows和Linux系统的不同命令执行方式。
4.  **结果返回：** 执行命令的结果通过`ServletActionContext.getResponse().getOutputStream()`获取输出流，并将命令执行的结果写入到HTTP响应中，返回给攻击者。

简单来说，利用方式就是通过精心构造的HTTP请求头，向存在漏洞的Struts2应用程序发送恶意payload，从而在服务器上执行任意命令。

**项目地址:** [colorblindpentester/CVE-2017-5638](https://github.com/colorblindpentester/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #11

**来源**: [CVE-2017-5638-haxerr9_CVE-2017-5638.md](../2017/CVE-2017-5638-haxerr9_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #12

**来源**: [CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md](../2017/CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许通过HTTP header传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 漏洞存在于Apache Struts2框架的Jakarta Multipart parser中，由于其在处理文件上传时的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP header来执行任意命令。

**有效性：**
提供的PoC代码是有效的，但它是一个安全的演示版本。它通过在Content-Type header中注入OGNL表达式，尝试设置一个自定义的HTTP响应头（X-Vuln）。如果服务器返回的响应中包含此header，则表示目标服务器可能存在漏洞。此PoC**不会**执行任何实际的恶意命令。

**投毒风险：**
分析了PoC代码和README文件，该仓库的目的是安全地演示该漏洞，而没有包含任何隐藏的或恶意的代码。没有发现任何投毒代码。因此, 投毒风险为 0%。

**利用方式：**
1.  **漏洞原理：** Struts2 使用Jakarta Multipart parser处理multipart请求，Content-Type头信息会被解析。如果Content-Type的值中包含OGNL表达式，并且OGNL表达式解析被启用，攻击者就可以利用OGNL表达式执行任意代码。
2.  **攻击方式：** 攻击者构造包含恶意OGNL表达式的Content-Type header，并发送给存在漏洞的Struts2服务器。
3.  **执行结果：** 服务器解析Content-Type header中的OGNL表达式，执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **PoC利用：** 提供的PoC利用代码通过发送包含`%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Vuln','Vulnerable')}`的Content-Type头来判断是否存在漏洞，成功则表示可能存在漏洞。

**项目地址:** [iampetru/PoC-CVE-2017-5638](https://github.com/iampetru/PoC-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #13

**来源**: [CVE-2017-5638-injcristianrojas_cve-2017-5638.md](../2017/CVE-2017-5638-injcristianrojas_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32 和 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且接受HTTP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 中的一个远程代码执行漏洞，存在于 Jakarta Multipart parser 中。当 Struts2 尝试处理文件上传时，如果 Content-Type、Content-Disposition 或 Content-Length HTTP 头部被恶意构造，将导致异常处理和错误消息生成过程出现问题，进而允许攻击者执行任意命令。

**漏洞利用方式：**

漏洞利用主要通过构造恶意的 Content-Type 头部，其中包含 OGNL 表达式。 OGNL（Object-Graph Navigation Language）是一种强大的表达式语言，用于访问和操作 Java 对象的属性。 攻击者通过在 Content-Type 头部中注入恶意的 OGNL 表达式，利用 Struts2 在解析请求时的漏洞，执行任意系统命令。

提供的漏洞利用代码包含两个 Python 脚本 (exploit1.py 和 exploit2.py)。

*   **exploit1.py:**  尝试通过在 Content-Type 中注入 OGNL 表达式，添加一个名为 "PWNED" 的 HTTP 头部，其值为 1337。这可以用来验证漏洞是否存在。
*   **exploit2.py:**  允许攻击者指定要执行的命令。 它构造一个更复杂的 OGNL 表达式，绕过某些安全限制，并使用 `java.lang.ProcessBuilder` 执行指定的命令，然后将命令的输出返回到 HTTP 响应中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞已经被广泛利用，提供的 POC 代码与已知的攻击方式一致，因此可以判断 POC 代码有效。

**投毒风险：**

提供的代码仓库包含一个 Jenkinsfile, 用于通过OWASP Dependency Check Plugin进行依赖检查, 这本身不属于投毒行为。 exploit1.py 和 exploit2.py 是利用漏洞的代码，也不构成投毒。仓库结构和代码内容来看，存在恶意投毒的可能性较低，约 5% 的可能性在于作者可能在其他未展示的文件中隐藏恶意代码，或者存在依赖污染的风险。总体而言，直接利用该仓库进行投毒的可能性较低，但仍需谨慎使用，建议在使用前进行详细的代码审计。

**项目地址:** [injcristianrojas/cve-2017-5638](https://github.com/injcristianrojas/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #14

**来源**: [CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md](../2017/CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可直接控制服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行受影响版本的Apache Struts2，并且存在文件上传功能或使用了Jakarta Multipart parser

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 框架中的一个远程代码执行漏洞，该漏洞源于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的POC是有效的。漏洞库和搜索结果都表明这是一个被广泛利用的漏洞，多个安全厂商和研究人员都发布了相关的分析和利用方法。

**投毒风险：**

分析提供的代码仓库内容，`README.md` 文件描述了漏洞信息和修复建议。`AvailableURL.txt` 包含可能存在漏洞的URL列表，`keyword.txt` 包含用于查找Struts2应用的关键词。`cmd.py` 是一个Python POC脚本，用于发送包含恶意Content-Type的HTTP请求，从而执行命令。

投毒风险较低，约为 5%。 虽然 `AvailableURL.txt` 中包含一些URL，可能被用于测试，但是这些URL并非恶意代码。 POC本身是利用漏洞执行命令，但并不包含主动植入后门或其他恶意行为的代码，因此，主要风险在于使用者可能会将此POC用于非法用途。

**利用方式：**

1.  攻击者构造包含恶意OGNL表达式的Content-Type HTTP头，例如 `Content-Type: multipart/form-data; boundary="+#cmd=whoami"`。
2.  攻击者向存在漏洞的Struts2应用发送包含上述恶意HTTP头的请求。
3.  Struts2应用使用Jakarta Multipart parser解析请求，由于Content-Type中包含恶意OGNL表达式，解析过程中会执行该表达式。
4.  服务器执行攻击者指定的命令，并将结果返回给攻击者。

提供的 `cmd.py` 脚本就是通过构造包含恶意Content-Type的HTTP请求来利用该漏洞的。

**项目地址:** [jas502n/S2-045-EXP-POC-TOOLS](https://github.com/jas502n/S2-045-EXP-POC-TOOLS)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #15

**来源**: [CVE-2017-5638-jas502n_st2-046-poc.md](../2017/CVE-2017-5638-jas502n_st2-046-poc.md)

## CVE-2017-5638 - Apache Struts2 Jakarta Multipart parser RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且对外开放HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts2 Jakarta Multipart parser 中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于文件上传过程中，对Content-Type, Content-Disposition或Content-Length等HTTP头处理不当造成的。攻击者可以通过构造恶意的HTTP头，特别是Content-Type，包含 `#cmd=` 字符串，来执行任意命令。 

**利用方式：**

提供的`exploit-cd.sh`脚本利用了Content-Disposition header中的 filename 字段，通过插入 null byte (\x00) 来触发 `InvalidFileNameException`，并利用OGNL表达式执行命令。脚本首先设置 Content-Type 为 `multipart/form-data`，然后构造包含恶意 OGNL 表达式的 payload，并将其作为 filename 的值插入到 Content-Disposition 头中。最后，使用 curl 发送包含精心构造的 HTTP 头的 POST 请求到目标 URL。payload 中，首先清空了OgnlUtil的ExcludedPackageNames和ExcludedClasses，避免了沙箱限制，然后通过ProcessBuilder执行了命令。这个脚本的有效性较高，因为它直接针对了漏洞的利用点。 `reqnull.txt` 文件也是类似的利用，只不过是预先构造的包含payload的HTTP请求。

**投毒风险：**

分析了提供的`exploit-cd.sh` 脚本和 `reqnull.txt`文件，没有发现明显的投毒代码。脚本的功能是利用漏洞执行任意命令，这本身就是漏洞利用的目的。脚本中所有的操作都是为了构造 payload 并发送请求，没有发现任何隐藏的恶意行为。因此，评估投毒风险为0%。

**项目地址:** [jas502n/st2-046-poc](https://github.com/jas502n/st2-046-poc)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #16

**来源**: [CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md](../2017/CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md)

## CVE-2017-5638-Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并可以通过HTTP请求访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Aon、Trend Micro等）以及Exploit-DB提供的PoC，该漏洞的利用是有效的。在实际环境中，CVE-2017-5638被广泛利用，造成了包括Equifax数据泄露在内的大规模安全事件。

**投毒风险：**
提供的代码库主要侧重于实时异常检测，而非直接的漏洞利用。它通过分析HTTP请求的3-gram特征，并使用Count-Min Sketch和KL散度来检测异常流量。虽然代码本身看起来没有明显的后门，但仍存在一些潜在风险，例如：

*   **依赖风险：** `requirements.txt` 如果包含恶意的第三方库，可能存在投毒风险。但提供的`requirements.txt`文件为空，降低了直接依赖投毒的风险。
*   **数据投毒：** 攻击者可能通过精心构造正常流量，污染Count-Min Sketch，降低检测准确性。由于系统依赖正常流量建立基线，通过大量伪装成正常的恶意请求，可能影响检测。
*   **日志记录：** 系统将检测结果记录到`data/detection.log`，如果日志配置不当，可能导致信息泄露或者日志文件被篡改。

综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP请求。
2.  恶意OGNL表达式位于Content-Type、Content-Disposition或Content-Length等HTTP头中。
3.  当Struts处理multipart请求时，解析这些HTTP头。
4.  Struts框架会执行恶意OGNL表达式，从而导致远程代码执行。

**缓解措施：**
*   升级Apache Struts到安全版本（>=2.3.32或>=2.5.10.1）。
*   使用Web应用防火墙（WAF）过滤恶意请求。
*   部署入侵检测系统（IDS）监控异常流量。
*   实施严格的输入验证和输出编码。

**项目地址:** [joidiego/Detection-struts-cve-2017-5638-detector](https://github.com/joidiego/Detection-struts-cve-2017-5638-detector)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #17

**来源**: [CVE-2017-5638-jongmartinez_CVE-2017-5638.md](../2017/CVE-2017-5638-jongmartinez_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且可从外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成存在缺陷，允许攻击者通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞的 PoC 代码是有效的。搜索引擎结果中多个链接表明该漏洞曾被广泛利用，并造成了严重的安全事件，如 Equifax 数据泄露事件。PoC 代码通过构造特定的 HTTP 头部，利用 OGNL 表达式注入执行系统命令，从而控制服务器。

**投毒风险评估：**

提供的 PoC 代码主要功能是利用漏洞执行命令。投毒风险评估如下：

*   **README.md:** 描述了漏洞利用方式，提供用法示例，没有发现恶意代码。
*   **cve-2017-5638.py:**  
    *   代码结构清晰，功能明确，实现了漏洞利用的核心逻辑。
    *   使用了 `requests` 库发送 HTTP 请求，符合漏洞利用的需要。
    *   OGNL 表达式的构造较为复杂，但其目的是为了绕过安全限制并执行命令。
    *   对执行命令的结果进行输出。
    *  try...except 块处理了可能的请求错误，使得程序更加健壮。
    
虽然代码功能正常，但存在以下潜在风险：

*   **命令执行权限：**  如果目标服务器以高权限运行，攻击者可以通过该漏洞获取高权限，造成更大的危害。
*   **日志记录：**  恶意利用可能被服务器日志记录，但攻击者可以尝试清除日志来隐藏踪迹。
*   **依赖风险：**  `requests` 库本身可能存在安全漏洞，间接影响该 PoC 的安全性。

综合来看，该代码主要风险在于被滥用，利用漏洞攻击目标系统，本身包含作者恶意投毒代码的可能性较低。投毒风险评估为10%。

**利用方式分析：**

1.  **构造恶意 HTTP 头部：**  攻击者通过修改 HTTP 请求的 Content-Type 头部，插入包含恶意 OGNL 表达式的字符串。
2.  **OGNL 表达式注入：**  恶意 OGNL 表达式被 Struts2 框架解析和执行，绕过安全限制，获取执行系统命令的权限。
3.  **执行任意命令：**  攻击者可以通过 OGNL 表达式执行任意系统命令，例如下载恶意文件、反弹 Shell 等。
4.  **获取服务器控制权：**  通过执行系统命令，攻击者可以获取服务器的控制权，进行恶意操作，例如数据窃取、恶意软件传播等。

**项目地址:** [jongmartinez/CVE-2017-5638](https://github.com/jongmartinez/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #18

**来源**: [CVE-2017-5638-jptr218_struts_hack.md](../2017/CVE-2017-5638-jptr218_struts_hack.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于其在处理文件上传时存在异常处理和错误消息生成方面的缺陷，允许远程攻击者通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析如下：

1.  **有效性：** 提供的POC代码通过构造包含 OGNL 表达式的 Content-Type 头部，利用 Struts 框架的漏洞执行任意命令，该方法是有效的。搜索引擎结果和漏洞库信息均表明此漏洞是一个高危且被广泛利用的远程代码执行漏洞。

2.  **投毒风险：** 投毒风险较低，约为10%。虽然该仓库提供了一个预编译的exe文件，但exe文件是一个struts漏洞利用工具,功能上与漏洞库和搜索引擎信息一致,其源代码也被一并给出。潜在的风险在于：
    *   **预编译的二进制文件可能包含恶意代码。** 虽然提供了源代码，但用户在使用前通常不会仔细审计所有代码。
    *   **Payload生成逻辑** payload.cpp 中 OGNL 表达式的构造虽然直接，但也存在被篡改以执行恶意操作的可能性。

3.  **利用方式：**
    *   攻击者发送一个特制的 HTTP 请求到目标服务器，该请求的 Content-Type 头部包含一个 OGNL 表达式。
    *   Struts 框架在处理该请求时，会解析并执行该 OGNL 表达式。
    *   攻击者可以使用 OGNL 表达式来执行任意命令，例如，通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令，从而获取对服务器的控制权。
    *   POC代码中，telnet函数建立socket链接，并持续发送payload，从而建立telnet连接，进入控制台。

 4. **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jptr218/struts_hack](https://github.com/jptr218/struts_hack)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #19

**来源**: [CVE-2017-5638-jrrombaldo_CVE-2017-5638.md](../2017/CVE-2017-5638-jrrombaldo_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #20

**来源**: [CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md](../2017/CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md)

## CVE-2017-5638 Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-5638是Apache Struts Jakarta Multipart解析器中的一个漏洞，由于不正确的异常处理和错误消息生成，允许远程攻击者通过精心构造的Content-Type、Content-Disposition或Content-Length HTTP头执行任意命令。漏洞利用方式是通过在HTTP请求头中注入OGNL表达式，服务器在解析过程中会执行该表达式，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且存在多个可用的POC。提供的POC代码`Invoke-WebRequest -Uri "http://localhost:8080/" -Method POST -Headers @{ "Content-Type" = "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('AttackSuccessTestingRCE',2*2)}.multipart/form-data" }` 尝试通过修改Content-Type头来触发漏洞，并设置一个特定的header 'AttackSuccessTestingRCE' 来检测漏洞是否被成功利用，该代码能够达到漏洞检测效果，因此该POC有效。

**投毒风险：**
提供的两个文件，一个是PowerShell命令用于测试，另一个是Jupyter Notebook，其中定义了一个 Flask 应用来模拟存在漏洞的 Struts 应用，并检测 header 中是否存在恶意代码的特征。虽然这个 Flask 应用本身是为了演示漏洞，但如果直接部署到生产环境，可能存在潜在的风险。但是代码分析来看，没有明显的恶意代码。Demos.ipynb 中的检测恶意代码的逻辑 `SUSPICIOUS_PATTERNS = ["%{", "Runtime.getRuntime", "ProcessBuilder"]`，可以检测到OGNL表达式相关的Payload。因此投毒风险存在，但不是很高，大约20%。

**利用方式：**
攻击者通过发送包含恶意OGNL表达式的HTTP请求，该表达式被注入到Content-Type、Content-Disposition 或 Content-Length 等HTTP头中。Struts在处理Multipart请求时，由于使用了存在漏洞的Jakarta Multipart解析器，会尝试解析这些头，从而触发OGNL表达式的执行。攻击者可以利用OGNL表达式执行任意系统命令，例如下载恶意软件、修改系统配置或窃取敏感数据。

**项目地址:** [kaylertee/Computer-Security-Equifax-2017](https://github.com/kaylertee/Computer-Security-Equifax-2017)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #21

**来源**: [CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md](../2017/CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md)

## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #22

**来源**: [CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md](../2017/CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md)

## CVE-2017-5638 - Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts 2，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于不正确的异常处理和错误消息生成，远程攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 标头执行任意命令。攻击者通常会在 Content-Type 标头中包含 #cmd= 字符串。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确定此漏洞是有效的。大量的公开信息和可用的POC代码表明该漏洞已被广泛研究和利用。

**投毒风险：**
提供的代码包含两个文件：dorker.py 和 exploit.py。

*   **dorker.py：** 这是一个用于搜索引擎爬取的脚本，主要用于查找可能存在漏洞的Struts 2应用。它使用Google、Bing、Yahoo和Baidu等搜索引擎来搜索特定的dorks（搜索字符串）。该脚本本身不太可能包含恶意代码，因为它主要负责信息收集。
*   **exploit.py：** 该脚本包含实际的漏洞利用代码，用于向目标系统发送恶意请求以执行任意命令。虽然脚本的主要功能是利用漏洞，但仍然存在一定的投毒风险。风险点在于执行命令的部分，如果攻击者将恶意命令嵌入到脚本中，可能会对目标系统造成损害。例如，可以修改脚本以默认执行特定的恶意操作，或者在成功利用后植入后门。

因此，虽然 `exploit.py` 的主要目的是为了利用漏洞, 但依然需要谨慎检查其执行命令的部分。`dorker.py` 脚本本身不太可能包含恶意代码。综合分析，投毒风险评估为 10%。主要风险在于，如果下载来源不可信，下载的 `exploit.py` 文件可能已经被篡改，嵌入了恶意代码。

**利用方式：**
1.  **确定目标：** 使用 `dorker.py` 脚本或其他方法查找可能存在漏洞的 Apache Struts 2 应用。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本构造包含恶意 OGNL 表达式的 HTTP 请求。恶意表达式通常嵌入在 Content-Type 标头中。
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 Struts 2 应用。
4.  **执行命令：** 如果目标系统存在漏洞，恶意 OGNL 表达式将被执行，从而导致在服务器上执行任意命令。

**项目地址:** [leandrocamposcardoso/CVE-2017-5638-Mass-Exploit](https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #23

**来源**: [CVE-2017-5638-ludy-dev_XworkStruts-RCE.md](../2017/CVE-2017-5638-ludy-dev_XworkStruts-RCE.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，并且可以通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的POC代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者通过特制的HTTP头部执行任意命令，而搜索结果中也提供了大量的分析和利用案例。POC代码通过构造含有OGNL表达式的Content-Type头部，尝试在目标服务器上写入JSP后门，验证漏洞的存在。

**投毒风险分析：**

经过对提供的POC代码进行分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标服务器上创建一个JSP文件（k22mn7.jsp），实现webshell的功能，从而验证漏洞的存在和进行进一步的利用。代码本身逻辑比较清晰，没有发现隐藏的恶意行为。 投毒风险评估为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **构造恶意HTTP请求：** 攻击者需要构造一个包含恶意OGNL表达式的HTTP请求，特别是Content-Type头部。该表达式会被Struts2框架解析执行。
2.  **利用OGNL执行代码：** 恶意OGNL表达式用于在目标服务器上执行任意代码。常见的利用方式是在服务器上写入一个webshell，或者直接执行系统命令。
3.  **访问webshell：** 如果成功写入webshell，攻击者可以通过访问webshell来控制目标服务器。 

POC代码中的OGNL表达式尝试在服务器的`/k22mn7.jsp`处写入一个JSP后门，以便进一步控制。该POC首先尝试清除ognlUtil的排除列表，然后从输入流拷贝内容到`/k22mn7.jsp`，最后输出`upload_ok`。

漏洞利用的关键在于构造能够绕过Struts2安全机制的恶意OGNL表达式，并将其插入到HTTP头部中。

**项目地址:** [ludy-dev/XworkStruts-RCE](https://github.com/ludy-dev/XworkStruts-RCE)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #24

**来源**: [CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md](../2017/CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #25

**来源**: [CVE-2017-5638-mritunjay-k_CVE-2017-5638.md](../2017/CVE-2017-5638-mritunjay-k_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #26

**来源**: [CVE-2017-5638-mthbernardes_strutszeiro.md](../2017/CVE-2017-5638-mthbernardes_strutszeiro.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过在Content-Type、Content-Disposition或Content-Length HTTP头中构造恶意OGNL表达式来执行任意命令。

**有效性分析：**
漏洞库信息、搜索引擎结果以及提供的漏洞利用代码都表明这是一个真实且高危的漏洞。搜索引擎结果中包含了漏洞的详细描述、利用方式以及受影响的版本。提供的漏洞利用代码是一个Telegram Bot，用于管理利用该漏洞创建的僵尸网络。该Bot通过Telegram命令来添加受害者服务器、执行命令等，进一步验证了漏洞的可利用性。

**投毒风险分析：**
该漏洞利用代码（strutszeiro.py及其相关文件）的投毒风险较低，约为10%。 主要风险点如下：

*   **配置文件：** `conf/token.conf` 和 `conf/group.conf` 存储了Telegram Bot的API Token和群组ID。如果攻击者控制了这些配置文件，他们可以窃取bot控制权，监控所有受害者服务器。
*   **actions.py:**botnet 方法中 cmd 的命令未校验，存在一定风险。
*  **strutszeiro.py:** 判断 chat_type 是否为 'group' ，存在一定风险，如果攻击者知道了bot token，私聊也能控制该bot。

代码本身的主要功能是利用Struts2漏洞进行远程命令执行，没有发现明显的后门或恶意代码。但是，用户需要谨慎配置Telegram Bot，并保护好API Token，防止泄露。

**利用方式：**

1.  **漏洞触发：** 攻击者发送包含恶意OGNL表达式的HTTP请求到存在漏洞的Struts2服务器。通常，这个表达式位于Content-Type头部，利用Jakarta Multipart parser的解析过程。
2.  **命令执行：** Struts2服务器在解析请求头时，会执行OGNL表达式，导致任意命令执行。
3.  **僵尸网络控制：** 提供的漏洞利用代码构建了一个Telegram Bot，攻击者可以通过该Bot远程控制受影响的服务器。
4.  **Telegram Bot命令：** 攻击者可以通过Telegram命令添加新的受害者服务器（`/add url`），在特定服务器上执行命令（`/exploit url *cmd`），在所有受害者服务器上执行命令（`/botnet cmd`），以及列出所有受害者服务器（`/list`）。

**项目地址:** [mthbernardes/strutszeiro](https://github.com/mthbernardes/strutszeiro)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #27

**来源**: [CVE-2017-5638-readloud_CVE-2017-5638.md](../2017/CVE-2017-5638-readloud_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #28

**来源**: [CVE-2017-5638-sighup1_cybersecurity-struts2.md](../2017/CVE-2017-5638-sighup1_cybersecurity-struts2.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头，特别是 Content-Type 头，其中包含 '#cmd=' 字符串，来执行任意命令。

**有效性：**
提供的 PoC 代码利用了 OGNL 表达式注入，通过修改 Content-Type 头来执行系统命令。根据漏洞库信息、搜索结果和 PoC 代码描述，该漏洞的利用方式是有效的。

**投毒风险：**
该仓库存在一定的投毒风险，评估约为10%。理由如下：
*   **免责声明：**仓库包含免责声明，这可能是为了规避潜在的法律责任，但并不能完全排除恶意目的。仓库作者声明“This is meant for educational, and research purposes only. I do not authorize or endorse any illegal or unethical use of this projects contents or information”，可能存在诱导使用者进行非法用途。
*   **不透明性：** 仓库作者在payload中调用了自定义的edu.uvu.ms.cybersecurity.Command类。如果没有对edu.uvu.ms.cybersecurity.Command类进行仔细的代码审计，可能存在恶意代码。如果 Command 类做了超出描述之外的事情（例如，记录命令、尝试提权、扫描网络等），那就存在风险。代码示例中， (#p.print('hello from MSCybersecurity'))这部分可能被替换为更具危害性的操作。
*   **依赖性：** PoC 需要 Send.jar。如果 Send.jar 来源不明或者被篡改，则可能存在安全风险。
*   **复杂性：** OGNL 表达式本身就非常复杂，容易隐藏恶意代码。 即使 payload 中的大部分逻辑看起来是良性的（例如，设置 Content-Type、清理 excludedPackageNames 等）， 仍然可能存在隐藏的、难以察觉的恶意代码片段。
*   **利用普及程度：**由于该漏洞影响广泛，并且利用代码已经公开，攻击者可以修改或者添加恶意代码，伪装成正常的 PoC，传播恶意软件或后门。

**利用方式：**
1.  攻击者发送一个特制的 HTTP 请求，该请求的 Content-Type 头包含恶意的 OGNL 表达式。
2.  Struts2 框架的 Jakarta Multipart parser 在处理该请求时，由于异常处理不当，会将 OGNL 表达式传递给 OGNL 引擎。
3.  OGNL 引擎执行该表达式，导致任意代码执行。
4.  PoC 代码展示了如何通过 OGNL 表达式来实例化 Java 类、调用方法和执行系统命令。
5.  攻击者利用该漏洞可以在服务器上执行任意命令，从而获取敏感信息、篡改数据或完全控制服务器。

**项目地址:** [sighup1/cybersecurity-struts2](https://github.com/sighup1/cybersecurity-struts2)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #29

**来源**: [CVE-2017-5638-sonatype-workshops_struts2-rce.md](../2017/CVE-2017-5638-sonatype-workshops_struts2-rce.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-5638 是 Apache Struts 2 的一个远程代码执行漏洞，源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析：

*   **Dockerfile:** 该文件用于构建包含存在漏洞的 Struts 2 应用的 Docker 镜像。它基于 tomcat:7 镜像，并将 struts2-rest-showcase.war 部署到 Tomcat 的 webapps 目录下，暴露了8080端口。这本身不是漏洞利用代码，而是漏洞测试环境的准备。
*   **Jenkinsfile:** 该文件定义了 Jenkins 构建流程，包括代码检出、Maven 构建和 Nexus Lifecycle Evaluation。它使用 Maven 打包 Struts 2 应用，但没有直接的漏洞利用代码。其中`nexusPolicyEvaluation` 可能存在风险，通过配置`iqApplication`应用ID，可能可以对应用进行安全分析。
*   **LICENSE.txt:** Apache 2.0 许可协议。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞利用的POC是存在的，并且在野外被广泛利用。提供的Dockerfile 可以搭建一个存在漏洞的环境， Jenkinsfile 是项目的构建文件，二者结合可以认为该漏洞是可以复现和利用的

**投毒风险：**
虽然提供的代码片段主要用于构建和部署存在漏洞的 Struts 2 应用，并没有明显的恶意代码。但是`Jenkinsfile`文件中的`nexusPolicyEvaluation` 可能存在风险， 通过配置恶意`iqApplication`应用ID,对构建的应用投毒，但是概率较低.

**利用方式：**
攻击者通常会发送一个包含恶意构造的 Content-Type 头部（例如，包含 `#cmd=` 字符串）的 HTTP 请求。这个恶意头部会触发 Struts 2 中的 OGNL 表达式注入，从而允许攻击者执行任意命令。具体的利用方式包括：

1.  发送包含恶意 Content-Type 头部的 HTTP 请求。
2.  利用 OGNL 表达式执行系统命令。
3.  获取服务器的控制权。

**项目地址:** [sonatype-workshops/struts2-rce](https://github.com/sonatype-workshops/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #30

**来源**: [CVE-2017-5638-tahmed11_strutsy.md](../2017/CVE-2017-5638-tahmed11_strutsy.md)

## CVE-2017-5638 Apache Struts 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.5-2.3.31, 2.5-2.5.10

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，并且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts框架中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传请求时，由于Content-Type头信息解析错误，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头信息，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞是有效的。搜索结果中提到该漏洞被广泛利用，并导致了严重的安全事件，例如Equifax数据泄露事件。提供的Python代码是一个POC，可以用于验证和利用该漏洞。

**投毒风险：**
虽然代码看起来是直接的漏洞利用程序，但是仍然存在一定的投毒风险。以下是风险评估和分析：
*   **网络请求依赖:** 代码依赖 `urllib2`，需要能够访问互联网。攻击者可能会修改代码，使其在特定条件下向恶意服务器发送敏感信息，或者从恶意服务器下载payload执行。这个风险较低，因为基本功能是命令执行。
*   **命令执行：** POC代码允许执行任意命令。如果该代码被修改并分发，攻击者可以将恶意命令硬编码到POC中，从而感染所有使用修改后POC的用户。
*   **Blind Injection 的依赖:** 代码中的blind injection依赖于外部IP并且需要apache可以读取log文件。此过程可能存在后门代码，但是需要进一步分析，才能判断。

 总体来说，该仓库中存在作者隐藏投毒代码的风险较低，大概在10%左右。 主要风险在于使用者不清楚代码逻辑，直接修改其中的cmd参数。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，特别是Content-Type头。
2.  当Struts应用解析该请求时，恶意OGNL表达式会被执行。
3.  攻击者可以利用OGNL表达式执行任意系统命令，例如反弹shell，上传恶意文件等。
4.  提供的POC代码利用了这一漏洞，通过修改Content-Type头，在目标服务器上执行指定的命令。


**项目地址:** [tahmed11/strutsy](https://github.com/tahmed11/strutsy)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #31

**来源**: [CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md](../2017/CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #32

**来源**: [CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md](../2017/CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #33

**来源**: [CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md](../2017/CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md)

# CVE-2017-5638

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-5638-Badbird3_CVE-2017-5638.md](../2017/CVE-2017-5638-Badbird3_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者可以发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，该漏洞存在于Jakarta Multipart parser中。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛利用的远程代码执行漏洞。提供的POC代码（`exploit.py`）利用了OGNL表达式注入，通过修改`Content-Type`头来执行任意命令，因此是有效的。

**投毒风险：**

分析提供的`exploit.py`代码，没有发现明显的投毒代码。代码逻辑清晰，主要功能是构造包含恶意OGNL表达式的HTTP请求，并执行命令。虽然执行命令本身具有破坏性，但这属于漏洞利用的正常行为，而非作者隐藏的恶意代码。
仓库中的`README.md`文件也只是简单说明了漏洞和原始exp的链接。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是`Content-Type`头部，其中包含OGNL表达式。
2.  该表达式会被Struts2解析执行，从而执行攻击者指定的命令。
3.  `exploit.py` 首先定义了payload, 通过一系列的ognl表达式, 清空了struts2的黑名单,绕过了沙箱, 然后通过java的ProcessBuilder执行了命令,获取response输出 
4.  攻击者可以通过该漏洞在服务器上执行任意命令，例如安装后门、窃取数据等。

总之，提供的POC代码是有效的，并且没有发现投毒风险。利用方式是通过构造恶意的HTTP请求头，实现远程代码执行。

**项目地址:** [Badbird3/CVE-2017-5638](https://github.com/Badbird3/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #2

**来源**: [CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md](../2017/CVE-2017-5638-FredBrave_CVE-2017-5638-ApacheStruts2.3.5.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标服务器运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是一个 Apache Struts2 的远程代码执行漏洞，存在于 Jakarta Multipart parser 中。由于不正确的异常处理和错误消息生成，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头来执行任意命令。从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞利用的有效性非常高，因为在2017年3月已经被广泛利用。漏洞利用代码中的`CVE-2017-5638ApacheStruts.py`脚本通过构造包含OGNL表达式的Content-Type头来触发漏洞，从而执行任意命令。利用方式是通过发送一个精心构造的HTTP请求，其中Content-Type头包含一个OGNL表达式，该表达式允许攻击者执行任意系统命令。

**有效性:**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的有效性非常高，且POC代码能够复现。

**投毒风险:**
POC代码主要功能是发送恶意请求并执行命令。虽然存在一定的风险（例如，命令执行不当导致系统不稳定），但不存在明显的恶意投毒代码。代码结构较为清晰，主要包含参数解析、payload生成和请求发送三个部分。代码中可能的风险点在于，攻击者可以利用此代码执行任意命令，因此存在滥用的风险。但代码本身的功能是为了验证漏洞，并无主动传播恶意代码的功能。我给出的投毒风险评估为5%，主要考虑是：

*   代码作者可能会在代码中添加一些隐藏的后门代码，例如，收集目标服务器的信息并发送到攻击者的服务器，或者在目标服务器上安装恶意软件。
*   代码用户可能会在使用代码时，不小心执行了恶意命令，从而导致系统被入侵。

**利用方式:**
1.  **目标确定:** 确定目标服务器上运行的Apache Struts2版本是否在受影响范围内（2.3.x before 2.3.32 或 2.5.x before 2.5.10.1）。
2.  **Payload构造:** 使用POC代码中的`creating_payload`函数构造包含恶意命令的OGNL表达式payload。 例如：要执行 `whoami` 命令，使用 `-c whoami` 参数。
3.  **请求发送:** 使用POC代码中的`execute`函数，将构造好的payload作为Content-Type头的值，发送HTTP请求到目标服务器的`.action`文件。POC代码会打印命令执行的结果。
4.  **结果分析:** 分析命令执行的结果，判断漏洞是否成功利用。

总而言之，该漏洞利用代码的有效性高，但存在较低的投毒风险。使用时务必谨慎，并确保在授权的环境下进行。


**项目地址:** [FredBrave/CVE-2017-5638-ApacheStruts2.3.5](https://github.com/FredBrave/CVE-2017-5638-ApacheStruts2.3.5)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #3

**来源**: [CVE-2017-5638-Iletee_struts2-rce.md](../2017/CVE-2017-5638-Iletee_struts2-rce.md)

## CVE-2017-5638-Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且可通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理不当。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2017-5638是一个被广泛利用的漏洞。存在公开可用的PoC代码，并且Metasploit框架中也存在利用模块，因此该漏洞的利用有效性很高。

提供的Dockerfile和Jenkinsfile用于构建和部署一个Struts2应用，但本身不包含漏洞利用代码。而是提供了一个包含漏洞的Struts2环境，方便演示和复现。

**投毒风险：**

虽然提供的Dockerfile和Jenkinsfile本身不包含明显的恶意代码，但存在一定的投毒风险：

*   **依赖风险：** Dockerfile中使用了`tomcat:7`镜像，存在该镜像可能包含已知漏洞的风险。Jenkinsfile中maven deploy可能会将构建的组件上传到外部maven仓库，若该仓库被入侵，则存在组件投毒的风险
*   **间接投毒：** Dockerfile中的`COPY target/struts2-rest-showcase.war /usr/local/tomcat/webapps/ROOT.war`，如果`struts2-rest-showcase.war`本身被替换为包含恶意代码的版本，则可能造成投毒。Jenkinsfile拉取的scm如果被恶意人员修改，则存在投毒风险。
*   **Jenkinsfile风险:** Jenkinsfile 中的`postGitHub` 函数，使用了github api token，若该token泄露，则可能导致项目代码被篡改。

综合评估，投毒风险大约为10%，主要来自于依赖风险和构建过程中的潜在恶意代码注入。

**利用方式：**

利用CVE-2017-5638漏洞的典型方式如下：

1.  **构造恶意HTTP请求：**  攻击者构造包含恶意Ognl表达式的Content-Type头部的HTTP请求。
2.  **发送请求：**  将构造好的HTTP请求发送到存在漏洞的Struts2服务器。
3.  **远程代码执行：**  Struts2服务器解析Content-Type头部时，会执行其中的恶意Ognl表达式，从而导致远程代码执行。

攻击者可以通过远程代码执行在服务器上执行任意命令，例如反弹shell、读取敏感文件、修改系统配置等。

一些公开的PoC利用了`#cmd=`字符串来执行系统命令，如`Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW; #cmd=whoami`



**项目地址:** [Iletee/struts2-rce](https://github.com/Iletee/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #4

**来源**: [CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md](../2017/CVE-2017-5638-MuhammadAbdullah192_CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION.md)

## CVE-2017-5638-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且对外开放HTTP端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是 Apache Struts 2 Jakarta Multipart parser 中的一个远程代码执行漏洞。该漏洞是由于在文件上传过程中，对Content-Type、Content-Disposition或Content-Length HTTP header处理不当造成的，攻击者可以通过构造恶意的HTTP头部，利用OGNL表达式注入执行任意命令。

**有效性：** 根据提供的漏洞信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码是有效的。搜索引擎结果中包含多个关于CVE-2017-5638的PoC和分析，说明该漏洞已经被广泛研究和利用。POC代码通过构造包含恶意OGNL表达式的Content-Type头部，发送POST请求到存在漏洞的Apache Struts2应用，从而执行任意命令。

**投毒风险：**  分析提供的`exploit.py.txt`和`README.md`文件。`README.md`文件只是漏洞利用说明，不包含任何代码。`exploit.py.txt` 文件中的Python代码用于利用 CVE-2017-5638 漏洞。代码首先定义了目标URL和包含恶意 OGNL 表达式的 payload。Payload 构造了一个命令执行的 OGNL 表达式，并在目标系统上执行 `ls /` 命令，将输出返回到响应中。然后，它使用 `requests` 库发送一个包含恶意 header 的 POST 请求到目标 URL。代码没有发现任何隐藏的或恶意的后门或投毒代码。payload 的目的是执行命令，而不是植入长期存在的恶意代码。因此，投毒风险为0%。

**利用方式：**

1.  **构造恶意HTTP头部：** 攻击者构造包含恶意OGNL表达式的Content-Type、Content-Disposition或Content-Length HTTP头部。在该POC中，恶意代码位于Content-Type头中。
2.  **发送请求：** 攻击者将构造好的HTTP请求发送到存在漏洞的Apache Struts2应用。
3.  **命令执行：** Struts2应用在处理请求时，由于错误的异常处理和错误消息生成，会将恶意OGNL表达式解析并执行，从而导致远程代码执行。在该POC中，执行了`ls /`命令。
4.  **获取结果：** 攻击者从HTTP响应中获取命令执行的结果。

**项目地址:** [MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION](https://github.com/MuhammadAbdullah192/CVE-2017-5638-Remote-Code-Execution-Apache-Struts2-EXPLOITATION)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #5

**来源**: [CVE-2017-5638-Nithylesh_web-application-firewall-.md](../2017/CVE-2017-5638-Nithylesh_web-application-firewall-.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts 2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性:**
提供的`vulnerable.py`脚本可以有效利用此漏洞，通过设置恶意的`Content-Type`头，向目标服务器发送包含OGNL表达式的HTTP请求，从而执行任意命令。

**投毒风险:**
仓库中存在投毒代码的风险较低，约10%。分析如下：
  * `server.py`文件模拟了一个简单的WAF，但其阻止模式相当基础，可能被绕过。
  * `vulnerable.py`脚本是漏洞利用的核心，其本身的目的就是执行任意命令，这使得判断其中是否包含恶意代码变得困难。尽管如此，脚本逻辑相对清晰，主要是构造payload发送请求并打印响应。但是依旧存在以下情况:
  * 存在隐藏的反向shell或者其他恶意指令的可能，但需要进一步分析才能确定。

**利用方式:**
1.  攻击者发送特制的HTTP请求，该请求的`Content-Type`头包含恶意的OGNL表达式。
2.  Struts2框架在处理multipart请求时，会解析`Content-Type`头。
3.  由于漏洞存在，OGNL表达式会被执行，从而在服务器上执行攻击者指定的命令。
4.  `vulnerable.py` 脚本通过 `check_vulnerability` 和 `execute_command` 函数展示了如何构造包含恶意OGNL表达式的 `Content-Type` 头并发送请求。

**优先级排序理由:**
搜索引擎结果提供了漏洞的基本信息和利用场景，但漏洞利用代码 `vulnerable.py` 更为关键，因为它直接展示了漏洞的利用方式。漏洞库信息作为补充，提供了漏洞影响的版本范围和基本描述。


**项目地址:** [Nithylesh/web-application-firewall-](https://github.com/Nithylesh/web-application-firewall-)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #6

**来源**: [CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md](../2017/CVE-2017-5638-QHxDr-dz_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且允许通过HTTP请求与目标交互。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞存在于 Jakarta Multipart parser 中，由于其在处理文件上传时的异常处理和错误消息生成不正确导致。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头，在服务器上执行任意命令。

**有效性：**

提供的PoC代码通过修改Content-Type头部，利用OGNL表达式注入恶意代码，从而实现远程代码执行。根据漏洞库信息和搜索结果，此漏洞在野外被广泛利用，因此PoC代码的有效性较高。

**投毒风险：**

PoC 代码本身是为了利用漏洞而编写的，其目的是执行任意命令。 从提供的代码来看，核心功能是构造包含恶意 OGNL 表达式的 HTTP 头部。
代码通过 Content-Type 注入 OGNL 表达式，该表达式首先获取 OgnlContext，然后清空了 OGNL 的黑名单，以便执行任意代码。接着，它使用 java.lang.ProcessBuilder 执行指定的命令，并将命令执行的结果返回。

综合分析，PoC 代码的功能是利用漏洞，而不是植入后门或进行其他恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  攻击者发送一个包含恶意Content-Type HTTP头的请求到目标服务器。
2.  恶意Content-Type头中包含OGNL表达式，该表达式能够执行任意系统命令。
3.  Struts2框架解析该请求时，会执行OGNL表达式，从而导致远程代码执行。
4.  攻击者通过执行系统命令，可以获取服务器的控制权。

**总结：**

CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单，影响广泛。提供的PoC代码可以有效利用该漏洞。该PoC代码本身没有投毒风险，但攻击者可以利用该PoC代码攻击未修复的Struts2应用。

**项目地址:** [QHxDr-dz/CVE-2017-5638](https://github.com/QHxDr-dz/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #7

**来源**: [CVE-2017-5638-Tankirat_CVE-2017-5638.md](../2017/CVE-2017-5638-Tankirat_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许通过HTTP进行访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 框架的 Jakarta Multipart parser 中。当处理文件上传时，由于异常处理和错误消息生成不当，攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部来执行任意命令。在野外攻击中，通常使用包含 `#cmd=` 字符串的 Content-Type 头部。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的PoC。漏洞利用代码描述了漏洞原理和利用方法，表明该漏洞的有效性较高。

**投毒风险：**
提供的漏洞利用代码（`/tmp/3bf1e344cbece4d19a9e8c32c2245913/README.md`） 主要是漏洞的介绍文档，描述了漏洞的原理、影响、利用方法、案例分析（Equifax 数据泄露），以及预防措施和参考链接。其中虽然引用了github上漏洞扫描工具，但本身readme文件不具备可执行的攻击代码。所以投毒风险较低，但不能完全排除作者通过其他方式进行投毒，比如在引用的链接中做手脚。所以评定投毒风险为10%。

**利用方式：**
1.  攻击者发送包含恶意构造的 HTTP 头部（例如，Content-Type）的请求到存在漏洞的 Apache Struts 应用。
2.  恶意的 HTTP 头部包含 Object-Graph Navigation Language (OGNL) 表达式。
3.  Struts 应用在解析 HTTP 头部时，会将 OGNL 表达式传递给 `LocalizedTextUtil.findText` 函数进行处理。
4.  `LocalizedTextUtil.findText` 函数会将 `${...}` 中的内容解释为 OGNL 表达式并执行。
5.  攻击者可以通过 OGNL 表达式执行任意系统命令，从而实现远程代码执行。

攻击成功的关键在于构造包含恶意 OGNL 表达式的 HTTP 头部，例如 `Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getSession().setAttribute('rand','vuln')}`。其中OGNL表达式可以执行任意命令，获取敏感信息，或者植入后门。

该漏洞曾被广泛利用，导致了包括 Equifax 数据泄露在内的多起重大安全事件。

**项目地址:** [Tankirat/CVE-2017-5638](https://github.com/Tankirat/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #8

**来源**: [CVE-2017-5638-Xernary_CVE-2017-5638-POC.md](../2017/CVE-2017-5638-Xernary_CVE-2017-5638-POC.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标服务器运行存在漏洞版本的Apache Struts2，且允许POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，由于错误处理和错误消息生成不当，导致攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头来执行任意命令。根据提供的漏洞库信息，漏洞的利用方式是通过在Content-Type头中包含 '#cmd=' 字符串来执行命令，并根据搜索结果确认该漏洞已被广泛利用。

**有效性：**
提供的`exploit.py`脚本通过构造包含OGNL表达式的Content-Type头来实现远程代码执行。该表达式利用OGNL绕过安全限制，执行指定的命令并将结果返回。该PoC代码的逻辑是正确的，并且与漏洞描述相符，因此有效。

**投毒风险：**
审查提供的 Dockerfile 和脚本，可以发现潜在的投毒风险。
*   `server-setup-script.sh`: 该脚本从华为云镜像下载了JDK 8u171，但是考虑到华为云镜像可能已经发生了变更（被投毒），因此存在一定的风险。此外，该脚本中没有检查下载的JDK的完整性，如果下载过程中被篡改，可能导致系统被植入后门。`pwn-page.jsp` 在服务器遭受攻击后会部署该页面。
* `exploit.py`，该脚本本身没有包含明显的恶意代码，但如果被攻击者修改，例如在执行命令之前添加下载和执行恶意文件的功能，也可能成为投毒的途径。`startup.sh` 这个脚本仅仅是用来启动 tomcat 服务。并且Dockerfile 最终启动的命令是 `CMD ["sh", "-c", "./startup.sh && bash"]`， 该命令会启动一个交互式的shell。

因此，综合评估投毒风险大约为10%。虽然没有发现直接的、明显的投毒代码，但是下载的外部资源以及执行流程存在被利用的潜在风险，需要谨慎对待。

**利用方式：**
1.  攻击者发送一个精心构造的HTTP POST请求到存在漏洞的Struts2服务器。
2.  该请求的Content-Type头包含一个恶意的OGNL表达式，该表达式利用Struts2的OGNL解析器执行任意命令。
3.  服务器执行该命令，并将结果返回给攻击者。

**总结：**
CVE-2017-5638 是一个严重的安全漏洞，利用简单，危害巨大。建议受影响的用户尽快升级到安全版本。

**项目地址:** [Xernary/CVE-2017-5638-POC](https://github.com/Xernary/CVE-2017-5638-POC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #9

**来源**: [CVE-2017-5638-andypitcher_check_struts.md](../2017/CVE-2017-5638-andypitcher_check_struts.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type, Content-Disposition, 或 Content-Length HTTP header，在服务器上执行任意命令。漏洞根源在于Struts2对Content-Type等header的处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个真实存在的且已被广泛利用的高危漏洞。网上存在大量的PoC代码，表明其有效性。

**投毒风险：**
提供的代码片段是一个GNU GPL v3许可协议。单独从这个LICENSE文件无法判断是否存在投毒代码，需要检查完整的漏洞利用程序。
然而，考虑到漏洞利用的性质（远程代码执行），如果攻击者能够控制漏洞利用代码，他们可以嵌入恶意代码，例如：

*   **植入后门：** 在目标系统上安装后门，以便长期控制。
*   **数据窃取：** 窃取目标系统上的敏感数据。
*   **恶意软件传播：** 将目标系统作为传播恶意软件的跳板。
*   **破坏系统：** 删除关键文件或使系统崩溃。

因此，在使用任何来自不可信来源的漏洞利用代码时，都必须非常谨慎，进行详细的代码审计，确保没有恶意行为。这里给出的“投毒风险”评估为10%，主要因为提供的代码段本身只是LICENSE信息，无法确定完整利用代码的安全性。需要对实际使用的利用代码进行更细致的分析。

**利用方式：**
利用方式主要通过以下步骤：

1.  **确定目标：** 确定运行存在漏洞的Apache Struts2版本的服务器。
2.  **构造恶意HTTP请求：** 构造包含恶意OGNL表达式的HTTP请求，通常在Content-Type header中，例如`Content-Type: %{#context['com.opensymphony.xwork2.dispatcher.HttpServletRequest'].getHeader('cmd')}`。`cmd` header 包含要执行的系统命令。
3.  **发送请求：** 将构造好的HTTP请求发送到目标服务器。
4.  **执行命令：** Struts2解析HTTP请求时，会执行恶意OGNL表达式，从而在服务器上执行攻击者指定的命令。

例如，攻击者可以使用curl命令发送包含恶意Content-Type header的请求：

```bash
curl -H 'Content-Type: %{#context["com.opensymphony.xwork2.dispatcher.HttpServletRequest"].map.class.forName("java.lang.Runtime").getRuntime().exec("id")}' http://target.com/example.action
```

此命令会在目标服务器上执行`id`命令，并将结果返回给攻击者。

总而言之，CVE-2017-5638是一个高危的远程代码执行漏洞，利用简单且影响严重，需要及时修复。

**项目地址:** [andypitcher/check_struts](https://github.com/andypitcher/check_struts)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #10

**来源**: [CVE-2017-5638-colorblindpentester_CVE-2017-5638.md](../2017/CVE-2017-5638-colorblindpentester_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致远程代码执行，服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638（也称为S2-045）是Apache Struts 2中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，此漏洞是有效的。搜索结果中包含了大量关于CVE-2017-5638的分析、利用和修复信息，表明这是一个真实且影响广泛的漏洞。PoC代码的存在进一步证实了其可利用性。

**投毒风险：**
提供的PoC代码本身就是利用该漏洞的脚本。要确定是否存在投毒风险，需要检查代码中是否存在恶意行为，例如下载和执行其他文件、篡改系统配置等。检查了给定的struts2_S2-045.py代码，它主要功能是构造payload执行命令，并没有发现明显的恶意投毒代码。虽然该代码可以用来执行任意命令，但这本身就是漏洞利用的目的，而不是额外添加的恶意功能。考虑到README.md文件极其简单，整个仓库并没有其他可疑文件，因此投毒风险较低，给出的估计值为5%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Jakarta Multipart parser处理HTTP请求头时。具体来说，当Struts2应用程序尝试解析包含恶意表达式的Content-Type头时，会导致OGNL表达式执行。
2.  **Payload构造：** 攻击者构造包含OGNL表达式的Content-Type头。该表达式利用Struts2的OGNL机制来绕过安全限制，并执行任意命令。
3.  **命令执行：** OGNL表达式首先获取对`OgnlContext`的引用，然后绕过默认的成员访问限制。接着，它使用`java.lang.ProcessBuilder`类来执行指定的命令。PoC中包含了针对Windows和Linux系统的不同命令执行方式。
4.  **结果返回：** 执行命令的结果通过`ServletActionContext.getResponse().getOutputStream()`获取输出流，并将命令执行的结果写入到HTTP响应中，返回给攻击者。

简单来说，利用方式就是通过精心构造的HTTP请求头，向存在漏洞的Struts2应用程序发送恶意payload，从而在服务器上执行任意命令。

**项目地址:** [colorblindpentester/CVE-2017-5638](https://github.com/colorblindpentester/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #11

**来源**: [CVE-2017-5638-haxerr9_CVE-2017-5638.md](../2017/CVE-2017-5638-haxerr9_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，且允许通过HTTP请求修改Content-Type等头部

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 的 Jakarta Multipart parser 中的远程代码执行漏洞。由于其对文件上传过程中的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性：**
提供的 Python 脚本 `CVE-2017-5638.py` 利用了该漏洞。脚本通过修改 HTTP 请求头中的 `Content-Type` 字段，嵌入 OGNL 表达式，从而在目标服务器上执行任意命令。根据漏洞描述和网络搜索结果，此漏洞利用方式是有效的。

**投毒风险：**
分析提供的代码，没有发现明显的恶意代码或后门。该脚本的主要功能是发送带有恶意构造的 HTTP 头部，以利用 Struts2 漏洞执行命令。README.md 中也声明了仅用于教育目的。因此，投毒风险较低，为0%。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  恶意表达式被嵌入到 Content-Type 头部中。
3.  当 Struts2 处理该请求时，OGNL 表达式被执行，导致远程代码执行。
4.  攻击者可以利用此漏洞在目标服务器上执行任意系统命令，例如反弹shell，植入后门等，从而完全控制服务器。

**搜索引擎结果佐证：**
搜索结果中多篇文章都提到该漏洞的利用方式是通过构造恶意的 `Content-Type` 头部来执行任意代码，这与提供的漏洞利用代码的利用方式一致。 其中，文章[webpage 6 begin] [title] Apache Struts Vulnerability (CVE-2017-5638) Exploit Traffic [description] Mar 9, 2017 — The vulnerability, CVE-2017-5638, permits unauthenticated Remote Code Execution (RCE) via a specially crafted Content-Type value in an HTTP request.  证实了这一点。

**项目地址:** [haxerr9/CVE-2017-5638](https://github.com/haxerr9/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #12

**来源**: [CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md](../2017/CVE-2017-5638-iampetru_PoC-CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且允许通过HTTP header传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 漏洞存在于Apache Struts2框架的Jakarta Multipart parser中，由于其在处理文件上传时的异常处理和错误消息生成存在缺陷，攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP header来执行任意命令。

**有效性：**
提供的PoC代码是有效的，但它是一个安全的演示版本。它通过在Content-Type header中注入OGNL表达式，尝试设置一个自定义的HTTP响应头（X-Vuln）。如果服务器返回的响应中包含此header，则表示目标服务器可能存在漏洞。此PoC**不会**执行任何实际的恶意命令。

**投毒风险：**
分析了PoC代码和README文件，该仓库的目的是安全地演示该漏洞，而没有包含任何隐藏的或恶意的代码。没有发现任何投毒代码。因此, 投毒风险为 0%。

**利用方式：**
1.  **漏洞原理：** Struts2 使用Jakarta Multipart parser处理multipart请求，Content-Type头信息会被解析。如果Content-Type的值中包含OGNL表达式，并且OGNL表达式解析被启用，攻击者就可以利用OGNL表达式执行任意代码。
2.  **攻击方式：** 攻击者构造包含恶意OGNL表达式的Content-Type header，并发送给存在漏洞的Struts2服务器。
3.  **执行结果：** 服务器解析Content-Type header中的OGNL表达式，执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **PoC利用：** 提供的PoC利用代码通过发送包含`%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Vuln','Vulnerable')}`的Content-Type头来判断是否存在漏洞，成功则表示可能存在漏洞。

**项目地址:** [iampetru/PoC-CVE-2017-5638](https://github.com/iampetru/PoC-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #13

**来源**: [CVE-2017-5638-injcristianrojas_cve-2017-5638.md](../2017/CVE-2017-5638-injcristianrojas_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32 和 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且接受HTTP请求。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 中的一个远程代码执行漏洞，存在于 Jakarta Multipart parser 中。当 Struts2 尝试处理文件上传时，如果 Content-Type、Content-Disposition 或 Content-Length HTTP 头部被恶意构造，将导致异常处理和错误消息生成过程出现问题，进而允许攻击者执行任意命令。

**漏洞利用方式：**

漏洞利用主要通过构造恶意的 Content-Type 头部，其中包含 OGNL 表达式。 OGNL（Object-Graph Navigation Language）是一种强大的表达式语言，用于访问和操作 Java 对象的属性。 攻击者通过在 Content-Type 头部中注入恶意的 OGNL 表达式，利用 Struts2 在解析请求时的漏洞，执行任意系统命令。

提供的漏洞利用代码包含两个 Python 脚本 (exploit1.py 和 exploit2.py)。

*   **exploit1.py:**  尝试通过在 Content-Type 中注入 OGNL 表达式，添加一个名为 "PWNED" 的 HTTP 头部，其值为 1337。这可以用来验证漏洞是否存在。
*   **exploit2.py:**  允许攻击者指定要执行的命令。 它构造一个更复杂的 OGNL 表达式，绕过某些安全限制，并使用 `java.lang.ProcessBuilder` 执行指定的命令，然后将命令的输出返回到 HTTP 响应中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞已经被广泛利用，提供的 POC 代码与已知的攻击方式一致，因此可以判断 POC 代码有效。

**投毒风险：**

提供的代码仓库包含一个 Jenkinsfile, 用于通过OWASP Dependency Check Plugin进行依赖检查, 这本身不属于投毒行为。 exploit1.py 和 exploit2.py 是利用漏洞的代码，也不构成投毒。仓库结构和代码内容来看，存在恶意投毒的可能性较低，约 5% 的可能性在于作者可能在其他未展示的文件中隐藏恶意代码，或者存在依赖污染的风险。总体而言，直接利用该仓库进行投毒的可能性较低，但仍需谨慎使用，建议在使用前进行详细的代码审计。

**项目地址:** [injcristianrojas/cve-2017-5638](https://github.com/injcristianrojas/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #14

**来源**: [CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md](../2017/CVE-2017-5638-jas502n_S2-045-EXP-POC-TOOLS.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可直接控制服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行受影响版本的Apache Struts2，并且存在文件上传功能或使用了Jakarta Multipart parser

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5638 是 Apache Struts2 框架中的一个远程代码执行漏洞，该漏洞源于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，在服务器上执行任意命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，此漏洞的POC是有效的。漏洞库和搜索结果都表明这是一个被广泛利用的漏洞，多个安全厂商和研究人员都发布了相关的分析和利用方法。

**投毒风险：**

分析提供的代码仓库内容，`README.md` 文件描述了漏洞信息和修复建议。`AvailableURL.txt` 包含可能存在漏洞的URL列表，`keyword.txt` 包含用于查找Struts2应用的关键词。`cmd.py` 是一个Python POC脚本，用于发送包含恶意Content-Type的HTTP请求，从而执行命令。

投毒风险较低，约为 5%。 虽然 `AvailableURL.txt` 中包含一些URL，可能被用于测试，但是这些URL并非恶意代码。 POC本身是利用漏洞执行命令，但并不包含主动植入后门或其他恶意行为的代码，因此，主要风险在于使用者可能会将此POC用于非法用途。

**利用方式：**

1.  攻击者构造包含恶意OGNL表达式的Content-Type HTTP头，例如 `Content-Type: multipart/form-data; boundary="+#cmd=whoami"`。
2.  攻击者向存在漏洞的Struts2应用发送包含上述恶意HTTP头的请求。
3.  Struts2应用使用Jakarta Multipart parser解析请求，由于Content-Type中包含恶意OGNL表达式，解析过程中会执行该表达式。
4.  服务器执行攻击者指定的命令，并将结果返回给攻击者。

提供的 `cmd.py` 脚本就是通过构造包含恶意Content-Type的HTTP请求来利用该漏洞的。

**项目地址:** [jas502n/S2-045-EXP-POC-TOOLS](https://github.com/jas502n/S2-045-EXP-POC-TOOLS)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #15

**来源**: [CVE-2017-5638-jas502n_st2-046-poc.md](../2017/CVE-2017-5638-jas502n_st2-046-poc.md)

## CVE-2017-5638 - Apache Struts2 Jakarta Multipart parser RCE

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且对外开放HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts2 Jakarta Multipart parser 中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于文件上传过程中，对Content-Type, Content-Disposition或Content-Length等HTTP头处理不当造成的。攻击者可以通过构造恶意的HTTP头，特别是Content-Type，包含 `#cmd=` 字符串，来执行任意命令。 

**利用方式：**

提供的`exploit-cd.sh`脚本利用了Content-Disposition header中的 filename 字段，通过插入 null byte (\x00) 来触发 `InvalidFileNameException`，并利用OGNL表达式执行命令。脚本首先设置 Content-Type 为 `multipart/form-data`，然后构造包含恶意 OGNL 表达式的 payload，并将其作为 filename 的值插入到 Content-Disposition 头中。最后，使用 curl 发送包含精心构造的 HTTP 头的 POST 请求到目标 URL。payload 中，首先清空了OgnlUtil的ExcludedPackageNames和ExcludedClasses，避免了沙箱限制，然后通过ProcessBuilder执行了命令。这个脚本的有效性较高，因为它直接针对了漏洞的利用点。 `reqnull.txt` 文件也是类似的利用，只不过是预先构造的包含payload的HTTP请求。

**投毒风险：**

分析了提供的`exploit-cd.sh` 脚本和 `reqnull.txt`文件，没有发现明显的投毒代码。脚本的功能是利用漏洞执行任意命令，这本身就是漏洞利用的目的。脚本中所有的操作都是为了构造 payload 并发送请求，没有发现任何隐藏的恶意行为。因此，评估投毒风险为0%。

**项目地址:** [jas502n/st2-046-poc](https://github.com/jas502n/st2-046-poc)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #16

**来源**: [CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md](../2017/CVE-2017-5638-joidiego_Detection-struts-cve-2017-5638-detector.md)

## CVE-2017-5638-Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts版本，并可以通过HTTP请求访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Aon、Trend Micro等）以及Exploit-DB提供的PoC，该漏洞的利用是有效的。在实际环境中，CVE-2017-5638被广泛利用，造成了包括Equifax数据泄露在内的大规模安全事件。

**投毒风险：**
提供的代码库主要侧重于实时异常检测，而非直接的漏洞利用。它通过分析HTTP请求的3-gram特征，并使用Count-Min Sketch和KL散度来检测异常流量。虽然代码本身看起来没有明显的后门，但仍存在一些潜在风险，例如：

*   **依赖风险：** `requirements.txt` 如果包含恶意的第三方库，可能存在投毒风险。但提供的`requirements.txt`文件为空，降低了直接依赖投毒的风险。
*   **数据投毒：** 攻击者可能通过精心构造正常流量，污染Count-Min Sketch，降低检测准确性。由于系统依赖正常流量建立基线，通过大量伪装成正常的恶意请求，可能影响检测。
*   **日志记录：** 系统将检测结果记录到`data/detection.log`，如果日志配置不当，可能导致信息泄露或者日志文件被篡改。

综合评估，投毒风险较低，约为10%。

**利用方式：**
1.  攻击者发送包含恶意OGNL表达式的HTTP请求。
2.  恶意OGNL表达式位于Content-Type、Content-Disposition或Content-Length等HTTP头中。
3.  当Struts处理multipart请求时，解析这些HTTP头。
4.  Struts框架会执行恶意OGNL表达式，从而导致远程代码执行。

**缓解措施：**
*   升级Apache Struts到安全版本（>=2.3.32或>=2.5.10.1）。
*   使用Web应用防火墙（WAF）过滤恶意请求。
*   部署入侵检测系统（IDS）监控异常流量。
*   实施严格的输入验证和输出编码。

**项目地址:** [joidiego/Detection-struts-cve-2017-5638-detector](https://github.com/joidiego/Detection-struts-cve-2017-5638-detector)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #17

**来源**: [CVE-2017-5638-jongmartinez_CVE-2017-5638.md](../2017/CVE-2017-5638-jongmartinez_CVE-2017-5638.md)

## CVE-2017-5638 - Apache Struts2 S2-045

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts2，且可从外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成存在缺陷，允许攻击者通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞的 PoC 代码是有效的。搜索引擎结果中多个链接表明该漏洞曾被广泛利用，并造成了严重的安全事件，如 Equifax 数据泄露事件。PoC 代码通过构造特定的 HTTP 头部，利用 OGNL 表达式注入执行系统命令，从而控制服务器。

**投毒风险评估：**

提供的 PoC 代码主要功能是利用漏洞执行命令。投毒风险评估如下：

*   **README.md:** 描述了漏洞利用方式，提供用法示例，没有发现恶意代码。
*   **cve-2017-5638.py:**  
    *   代码结构清晰，功能明确，实现了漏洞利用的核心逻辑。
    *   使用了 `requests` 库发送 HTTP 请求，符合漏洞利用的需要。
    *   OGNL 表达式的构造较为复杂，但其目的是为了绕过安全限制并执行命令。
    *   对执行命令的结果进行输出。
    *  try...except 块处理了可能的请求错误，使得程序更加健壮。
    
虽然代码功能正常，但存在以下潜在风险：

*   **命令执行权限：**  如果目标服务器以高权限运行，攻击者可以通过该漏洞获取高权限，造成更大的危害。
*   **日志记录：**  恶意利用可能被服务器日志记录，但攻击者可以尝试清除日志来隐藏踪迹。
*   **依赖风险：**  `requests` 库本身可能存在安全漏洞，间接影响该 PoC 的安全性。

综合来看，该代码主要风险在于被滥用，利用漏洞攻击目标系统，本身包含作者恶意投毒代码的可能性较低。投毒风险评估为10%。

**利用方式分析：**

1.  **构造恶意 HTTP 头部：**  攻击者通过修改 HTTP 请求的 Content-Type 头部，插入包含恶意 OGNL 表达式的字符串。
2.  **OGNL 表达式注入：**  恶意 OGNL 表达式被 Struts2 框架解析和执行，绕过安全限制，获取执行系统命令的权限。
3.  **执行任意命令：**  攻击者可以通过 OGNL 表达式执行任意系统命令，例如下载恶意文件、反弹 Shell 等。
4.  **获取服务器控制权：**  通过执行系统命令，攻击者可以获取服务器的控制权，进行恶意操作，例如数据窃取、恶意软件传播等。

**项目地址:** [jongmartinez/CVE-2017-5638](https://github.com/jongmartinez/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #18

**来源**: [CVE-2017-5638-jptr218_struts_hack.md](../2017/CVE-2017-5638-jptr218_struts_hack.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts，且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于其在处理文件上传时存在异常处理和错误消息生成方面的缺陷，允许远程攻击者通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析如下：

1.  **有效性：** 提供的POC代码通过构造包含 OGNL 表达式的 Content-Type 头部，利用 Struts 框架的漏洞执行任意命令，该方法是有效的。搜索引擎结果和漏洞库信息均表明此漏洞是一个高危且被广泛利用的远程代码执行漏洞。

2.  **投毒风险：** 投毒风险较低，约为10%。虽然该仓库提供了一个预编译的exe文件，但exe文件是一个struts漏洞利用工具,功能上与漏洞库和搜索引擎信息一致,其源代码也被一并给出。潜在的风险在于：
    *   **预编译的二进制文件可能包含恶意代码。** 虽然提供了源代码，但用户在使用前通常不会仔细审计所有代码。
    *   **Payload生成逻辑** payload.cpp 中 OGNL 表达式的构造虽然直接，但也存在被篡改以执行恶意操作的可能性。

3.  **利用方式：**
    *   攻击者发送一个特制的 HTTP 请求到目标服务器，该请求的 Content-Type 头部包含一个 OGNL 表达式。
    *   Struts 框架在处理该请求时，会解析并执行该 OGNL 表达式。
    *   攻击者可以使用 OGNL 表达式来执行任意命令，例如，通过 `java.lang.Runtime.getRuntime().exec()` 执行系统命令，从而获取对服务器的控制权。
    *   POC代码中，telnet函数建立socket链接，并持续发送payload，从而建立telnet连接，进入控制台。

 4. **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jptr218/struts_hack](https://github.com/jptr218/struts_hack)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #19

**来源**: [CVE-2017-5638-jrrombaldo_CVE-2017-5638.md](../2017/CVE-2017-5638-jrrombaldo_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时，对 Content-Type 等 HTTP 头部信息处理不当，导致OGNL表达式注入。

**有效性：**
根据漏洞描述和搜索结果，该漏洞利用代码（`struts-shock-validation.py`）的目的是验证目标系统是否存在 CVE-2017-5638 漏洞，而不是直接执行恶意代码。代码通过构造特定的 Content-Type 头部，其中包含OGNL表达式，尝试在 HTTP 响应头中设置一个特定的值（`STRUTS2-VALIDATION`），如果目标存在漏洞，则会成功设置，从而验证漏洞的存在。因此，此POC代码是**有效**的用于检测漏洞存在的。

**投毒风险：**
仔细分析提供的 `struts-shock-validation.py` 脚本，该脚本的功能是发送包含特定 payload 的 HTTP 请求来检测 Struts2 是否存在 CVE-2017-5638 漏洞，脚本的主要逻辑是构造包含 OGNL 表达式的 Content-Type 头部，并检查服务器的响应中是否存在特定的 HTTP 头部（`STRUTS2-VALIDATION`）。脚本本身并没有执行任何恶意操作（例如下载执行恶意代码、修改系统文件等），只是一个验证漏洞存在的工具。`README.md`也声明这是一个“无害”的验证脚本。

因此，该仓库中包含作者隐藏的投毒代码的可能性非常低，**投毒风险为0%**。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者通过构造包含恶意 OGNL 表达式的 Content-Type、Content-Disposition 或 Content-Length 等 HTTP 头部，发送到存在漏洞的 Struts2 应用。
2.  **OGNL表达式注入：** Struts2 在处理这些头部时，由于没有进行充分的验证和过滤，会将 OGNL 表达式解析并执行。
3.  **远程代码执行：** 攻击者利用 OGNL 表达式执行任意系统命令，从而获得服务器的控制权。

`struts-shock-validation.py` 脚本通过发送包含 OGNL 表达式的 Content-Type 头部，尝试在 HTTP 响应头中设置一个特定的值，以此验证目标是否存在漏洞。真正的漏洞利用会使用 OGNL 表达式执行任意系统命令。

**项目地址:** [jrrombaldo/CVE-2017-5638](https://github.com/jrrombaldo/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #20

**来源**: [CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md](../2017/CVE-2017-5638-kaylertee_Computer-Security-Equifax-2017.md)

## CVE-2017-5638 Apache Struts远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts，且允许外部访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-5638是Apache Struts Jakarta Multipart解析器中的一个漏洞，由于不正确的异常处理和错误消息生成，允许远程攻击者通过精心构造的Content-Type、Content-Disposition或Content-Length HTTP头执行任意命令。漏洞利用方式是通过在HTTP请求头中注入OGNL表达式，服务器在解析过程中会执行该表达式，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且存在多个可用的POC。提供的POC代码`Invoke-WebRequest -Uri "http://localhost:8080/" -Method POST -Headers @{ "Content-Type" = "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('AttackSuccessTestingRCE',2*2)}.multipart/form-data" }` 尝试通过修改Content-Type头来触发漏洞，并设置一个特定的header 'AttackSuccessTestingRCE' 来检测漏洞是否被成功利用，该代码能够达到漏洞检测效果，因此该POC有效。

**投毒风险：**
提供的两个文件，一个是PowerShell命令用于测试，另一个是Jupyter Notebook，其中定义了一个 Flask 应用来模拟存在漏洞的 Struts 应用，并检测 header 中是否存在恶意代码的特征。虽然这个 Flask 应用本身是为了演示漏洞，但如果直接部署到生产环境，可能存在潜在的风险。但是代码分析来看，没有明显的恶意代码。Demos.ipynb 中的检测恶意代码的逻辑 `SUSPICIOUS_PATTERNS = ["%{", "Runtime.getRuntime", "ProcessBuilder"]`，可以检测到OGNL表达式相关的Payload。因此投毒风险存在，但不是很高，大约20%。

**利用方式：**
攻击者通过发送包含恶意OGNL表达式的HTTP请求，该表达式被注入到Content-Type、Content-Disposition 或 Content-Length 等HTTP头中。Struts在处理Multipart请求时，由于使用了存在漏洞的Jakarta Multipart解析器，会尝试解析这些头，从而触发OGNL表达式的执行。攻击者可以利用OGNL表达式执行任意系统命令，例如下载恶意软件、修改系统配置或窃取敏感数据。

**项目地址:** [kaylertee/Computer-Security-Equifax-2017](https://github.com/kaylertee/Computer-Security-Equifax-2017)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #21

**来源**: [CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md](../2017/CVE-2017-5638-kloutkake_CVE-2017-5638-PoC.md)

## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #22

**来源**: [CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md](../2017/CVE-2017-5638-leandrocamposcardoso_CVE-2017-5638-Mass-Exploit.md)

## CVE-2017-5638 - Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行受影响版本的Apache Struts 2，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 存在于 Apache Struts 2 的 Jakarta Multipart parser 中，由于不正确的异常处理和错误消息生成，远程攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 标头执行任意命令。攻击者通常会在 Content-Type 标头中包含 #cmd= 字符串。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确定此漏洞是有效的。大量的公开信息和可用的POC代码表明该漏洞已被广泛研究和利用。

**投毒风险：**
提供的代码包含两个文件：dorker.py 和 exploit.py。

*   **dorker.py：** 这是一个用于搜索引擎爬取的脚本，主要用于查找可能存在漏洞的Struts 2应用。它使用Google、Bing、Yahoo和Baidu等搜索引擎来搜索特定的dorks（搜索字符串）。该脚本本身不太可能包含恶意代码，因为它主要负责信息收集。
*   **exploit.py：** 该脚本包含实际的漏洞利用代码，用于向目标系统发送恶意请求以执行任意命令。虽然脚本的主要功能是利用漏洞，但仍然存在一定的投毒风险。风险点在于执行命令的部分，如果攻击者将恶意命令嵌入到脚本中，可能会对目标系统造成损害。例如，可以修改脚本以默认执行特定的恶意操作，或者在成功利用后植入后门。

因此，虽然 `exploit.py` 的主要目的是为了利用漏洞, 但依然需要谨慎检查其执行命令的部分。`dorker.py` 脚本本身不太可能包含恶意代码。综合分析，投毒风险评估为 10%。主要风险在于，如果下载来源不可信，下载的 `exploit.py` 文件可能已经被篡改，嵌入了恶意代码。

**利用方式：**
1.  **确定目标：** 使用 `dorker.py` 脚本或其他方法查找可能存在漏洞的 Apache Struts 2 应用。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本构造包含恶意 OGNL 表达式的 HTTP 请求。恶意表达式通常嵌入在 Content-Type 标头中。
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 Struts 2 应用。
4.  **执行命令：** 如果目标系统存在漏洞，恶意 OGNL 表达式将被执行，从而导致在服务器上执行任意命令。

**项目地址:** [leandrocamposcardoso/CVE-2017-5638-Mass-Exploit](https://github.com/leandrocamposcardoso/CVE-2017-5638-Mass-Exploit)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #23

**来源**: [CVE-2017-5638-ludy-dev_XworkStruts-RCE.md](../2017/CVE-2017-5638-ludy-dev_XworkStruts-RCE.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.x (before 2.3.32) 和 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts2版本，并且可以通过HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞，源于Jakarta Multipart parser在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的POC代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者通过特制的HTTP头部执行任意命令，而搜索结果中也提供了大量的分析和利用案例。POC代码通过构造含有OGNL表达式的Content-Type头部，尝试在目标服务器上写入JSP后门，验证漏洞的存在。

**投毒风险分析：**

经过对提供的POC代码进行分析，未发现明显的投毒代码。该脚本的主要功能是利用漏洞在目标服务器上创建一个JSP文件（k22mn7.jsp），实现webshell的功能，从而验证漏洞的存在和进行进一步的利用。代码本身逻辑比较清晰，没有发现隐藏的恶意行为。 投毒风险评估为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **构造恶意HTTP请求：** 攻击者需要构造一个包含恶意OGNL表达式的HTTP请求，特别是Content-Type头部。该表达式会被Struts2框架解析执行。
2.  **利用OGNL执行代码：** 恶意OGNL表达式用于在目标服务器上执行任意代码。常见的利用方式是在服务器上写入一个webshell，或者直接执行系统命令。
3.  **访问webshell：** 如果成功写入webshell，攻击者可以通过访问webshell来控制目标服务器。 

POC代码中的OGNL表达式尝试在服务器的`/k22mn7.jsp`处写入一个JSP后门，以便进一步控制。该POC首先尝试清除ognlUtil的排除列表，然后从输入流拷贝内容到`/k22mn7.jsp`，最后输出`upload_ok`。

漏洞利用的关键在于构造能够绕过Struts2安全机制的恶意OGNL表达式，并将其插入到HTTP头部中。

**项目地址:** [ludy-dev/XworkStruts-RCE](https://github.com/ludy-dev/XworkStruts-RCE)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #24

**来源**: [CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md](../2017/CVE-2017-5638-mfdev-solution_Exploit-CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。攻击者可以通过在 Content-Type, Content-Disposition 或 Content-Length HTTP 头中注入恶意的 OGNL 表达式来执行任意命令。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过构造包含恶意 OGNL 表达式的 Content-Type 头来利用该漏洞。搜索引擎结果中的多个文章和漏洞库信息也确认了该漏洞的可利用性。

**投毒风险：**
尽管提供的代码本身是一个漏洞演示，但仔细分析该仓库，仍然存在一定的投毒风险。风险点在于 `cybersecurity-struts2-master/README.md` 文件中提及的 `ms-cybersecurity-1.jar` 和 `Send.jar`，以及 `edu.uvu.ms.cybersecurity.Command` 类。这些组件有可能包含作者有意或无意引入的后门或恶意代码。虽然 `Command` 类的功能看起来比较简单，只是打印命令，但仍有可能被作者进行修改，以执行恶意操作。

根据对整个代码库的分析，我评估存在 10% 的投毒风险。风险主要来自于可能存在于预编译的 `ms-cybersecurity-1.jar` 和 `Send.jar` 中，以及可能被篡改的 `edu.uvu.ms.cybersecurity.Command` 类。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，特别是 Content-Type 头。
2.  恶意 OGNL 表达式利用 Struts2 的 OGNL 引擎执行任意代码。
3.  攻击者可以通过 OGNL 表达式调用 `java.lang.ProcessBuilder` 类来执行系统命令，从而控制服务器。
4.  POC 使用 curl 命令发送构造好的 payload，直接执行系统命令，达到了RCE目的。

**项目地址:** [mfdev-solution/Exploit-CVE-2017-5638](https://github.com/mfdev-solution/Exploit-CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #25

**来源**: [CVE-2017-5638-mritunjay-k_CVE-2017-5638.md](../2017/CVE-2017-5638-mritunjay-k_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #26

**来源**: [CVE-2017-5638-mthbernardes_strutszeiro.md](../2017/CVE-2017-5638-mthbernardes_strutszeiro.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且允许HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过在Content-Type、Content-Disposition或Content-Length HTTP头中构造恶意OGNL表达式来执行任意命令。

**有效性分析：**
漏洞库信息、搜索引擎结果以及提供的漏洞利用代码都表明这是一个真实且高危的漏洞。搜索引擎结果中包含了漏洞的详细描述、利用方式以及受影响的版本。提供的漏洞利用代码是一个Telegram Bot，用于管理利用该漏洞创建的僵尸网络。该Bot通过Telegram命令来添加受害者服务器、执行命令等，进一步验证了漏洞的可利用性。

**投毒风险分析：**
该漏洞利用代码（strutszeiro.py及其相关文件）的投毒风险较低，约为10%。 主要风险点如下：

*   **配置文件：** `conf/token.conf` 和 `conf/group.conf` 存储了Telegram Bot的API Token和群组ID。如果攻击者控制了这些配置文件，他们可以窃取bot控制权，监控所有受害者服务器。
*   **actions.py:**botnet 方法中 cmd 的命令未校验，存在一定风险。
*  **strutszeiro.py:** 判断 chat_type 是否为 'group' ，存在一定风险，如果攻击者知道了bot token，私聊也能控制该bot。

代码本身的主要功能是利用Struts2漏洞进行远程命令执行，没有发现明显的后门或恶意代码。但是，用户需要谨慎配置Telegram Bot，并保护好API Token，防止泄露。

**利用方式：**

1.  **漏洞触发：** 攻击者发送包含恶意OGNL表达式的HTTP请求到存在漏洞的Struts2服务器。通常，这个表达式位于Content-Type头部，利用Jakarta Multipart parser的解析过程。
2.  **命令执行：** Struts2服务器在解析请求头时，会执行OGNL表达式，导致任意命令执行。
3.  **僵尸网络控制：** 提供的漏洞利用代码构建了一个Telegram Bot，攻击者可以通过该Bot远程控制受影响的服务器。
4.  **Telegram Bot命令：** 攻击者可以通过Telegram命令添加新的受害者服务器（`/add url`），在特定服务器上执行命令（`/exploit url *cmd`），在所有受害者服务器上执行命令（`/botnet cmd`），以及列出所有受害者服务器（`/list`）。

**项目地址:** [mthbernardes/strutszeiro](https://github.com/mthbernardes/strutszeiro)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #27

**来源**: [CVE-2017-5638-readloud_CVE-2017-5638.md](../2017/CVE-2017-5638-readloud_CVE-2017-5638.md)

## CVE-2017-5638 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 需要目标系统运行存在漏洞版本的Apache Struts2，并且可以通过HTTP请求访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 漏洞是由于 Apache Struts 2 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当导致的。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头，在服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者发送包含恶意构造的HTTP头的请求到目标服务器。
2.  恶意HTTP头包含OGNL表达式，Struts2会将它当做命令执行。
3.  服务器执行攻击者指定的命令。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中包含大量关于此漏洞的分析、利用和修复方案，以及实际攻击案例，表明此漏洞在野外被广泛利用。

**投毒风险：**

根据提供的Dockerfile、LICENSE、README.md文件内容判断，该仓库主要目的是验证漏洞，未发现明显的恶意代码。但是，在 `exploit/exploit.py` 中执行任意命令存在潜在风险，如果攻击者修改了此脚本并传播，可能会造成恶意利用。整体投毒风险较低，估计为10%。

**利用代码分析：**

*   **Dockerfile:** 用于构建包含漏洞环境的Docker镜像，方便漏洞验证和复现。
*   **LICENSE:** 使用MIT License，表明代码开源，允许修改和分发。
*   **README.md:** 提供了漏洞的描述、利用方法和免责声明，强调了漏洞的教育意义和潜在风险。
*   **exploit/exploit.py:**  漏洞利用脚本，允许执行任意命令。这部分存在被恶意修改的风险。

**总结：**

该漏洞是一个高危的远程代码执行漏洞，利用简单，影响广泛。虽然提供的代码仓库主要用于漏洞验证，但需要注意`exploit/exploit.py`脚本的潜在风险，避免被恶意利用。

**项目地址:** [readloud/CVE-2017-5638](https://github.com/readloud/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #28

**来源**: [CVE-2017-5638-sighup1_cybersecurity-struts2.md](../2017/CVE-2017-5638-sighup1_cybersecurity-struts2.md)

## CVE-2017-5638 - Apache Struts2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个 Apache Struts 2 框架中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误信息生成不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition 或 Content-Length HTTP 头，特别是 Content-Type 头，其中包含 '#cmd=' 字符串，来执行任意命令。

**有效性：**
提供的 PoC 代码利用了 OGNL 表达式注入，通过修改 Content-Type 头来执行系统命令。根据漏洞库信息、搜索结果和 PoC 代码描述，该漏洞的利用方式是有效的。

**投毒风险：**
该仓库存在一定的投毒风险，评估约为10%。理由如下：
*   **免责声明：**仓库包含免责声明，这可能是为了规避潜在的法律责任，但并不能完全排除恶意目的。仓库作者声明“This is meant for educational, and research purposes only. I do not authorize or endorse any illegal or unethical use of this projects contents or information”，可能存在诱导使用者进行非法用途。
*   **不透明性：** 仓库作者在payload中调用了自定义的edu.uvu.ms.cybersecurity.Command类。如果没有对edu.uvu.ms.cybersecurity.Command类进行仔细的代码审计，可能存在恶意代码。如果 Command 类做了超出描述之外的事情（例如，记录命令、尝试提权、扫描网络等），那就存在风险。代码示例中， (#p.print('hello from MSCybersecurity'))这部分可能被替换为更具危害性的操作。
*   **依赖性：** PoC 需要 Send.jar。如果 Send.jar 来源不明或者被篡改，则可能存在安全风险。
*   **复杂性：** OGNL 表达式本身就非常复杂，容易隐藏恶意代码。 即使 payload 中的大部分逻辑看起来是良性的（例如，设置 Content-Type、清理 excludedPackageNames 等）， 仍然可能存在隐藏的、难以察觉的恶意代码片段。
*   **利用普及程度：**由于该漏洞影响广泛，并且利用代码已经公开，攻击者可以修改或者添加恶意代码，伪装成正常的 PoC，传播恶意软件或后门。

**利用方式：**
1.  攻击者发送一个特制的 HTTP 请求，该请求的 Content-Type 头包含恶意的 OGNL 表达式。
2.  Struts2 框架的 Jakarta Multipart parser 在处理该请求时，由于异常处理不当，会将 OGNL 表达式传递给 OGNL 引擎。
3.  OGNL 引擎执行该表达式，导致任意代码执行。
4.  PoC 代码展示了如何通过 OGNL 表达式来实例化 Java 类、调用方法和执行系统命令。
5.  攻击者利用该漏洞可以在服务器上执行任意命令，从而获取敏感信息、篡改数据或完全控制服务器。

**项目地址:** [sighup1/cybersecurity-struts2](https://github.com/sighup1/cybersecurity-struts2)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #29

**来源**: [CVE-2017-5638-sonatype-workshops_struts2-rce.md](../2017/CVE-2017-5638-sonatype-workshops_struts2-rce.md)

## CVE-2017-5638-Apache Struts-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且攻击者能够发送恶意HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-5638 是 Apache Struts 2 的一个远程代码执行漏洞，源于 Jakarta Multipart parser 在处理文件上传时的异常处理和错误消息生成不当。攻击者可以通过构造恶意的 Content-Type、Content-Disposition 或 Content-Length HTTP 头部来执行任意命令。漏洞利用代码分析：

*   **Dockerfile:** 该文件用于构建包含存在漏洞的 Struts 2 应用的 Docker 镜像。它基于 tomcat:7 镜像，并将 struts2-rest-showcase.war 部署到 Tomcat 的 webapps 目录下，暴露了8080端口。这本身不是漏洞利用代码，而是漏洞测试环境的准备。
*   **Jenkinsfile:** 该文件定义了 Jenkins 构建流程，包括代码检出、Maven 构建和 Nexus Lifecycle Evaluation。它使用 Maven 打包 Struts 2 应用，但没有直接的漏洞利用代码。其中`nexusPolicyEvaluation` 可能存在风险，通过配置`iqApplication`应用ID，可能可以对应用进行安全分析。
*   **LICENSE.txt:** Apache 2.0 许可协议。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞利用的POC是存在的，并且在野外被广泛利用。提供的Dockerfile 可以搭建一个存在漏洞的环境， Jenkinsfile 是项目的构建文件，二者结合可以认为该漏洞是可以复现和利用的

**投毒风险：**
虽然提供的代码片段主要用于构建和部署存在漏洞的 Struts 2 应用，并没有明显的恶意代码。但是`Jenkinsfile`文件中的`nexusPolicyEvaluation` 可能存在风险， 通过配置恶意`iqApplication`应用ID,对构建的应用投毒，但是概率较低.

**利用方式：**
攻击者通常会发送一个包含恶意构造的 Content-Type 头部（例如，包含 `#cmd=` 字符串）的 HTTP 请求。这个恶意头部会触发 Struts 2 中的 OGNL 表达式注入，从而允许攻击者执行任意命令。具体的利用方式包括：

1.  发送包含恶意 Content-Type 头部的 HTTP 请求。
2.  利用 OGNL 表达式执行系统命令。
3.  获取服务器的控制权。

**项目地址:** [sonatype-workshops/struts2-rce](https://github.com/sonatype-workshops/struts2-rce)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #30

**来源**: [CVE-2017-5638-tahmed11_strutsy.md](../2017/CVE-2017-5638-tahmed11_strutsy.md)

## CVE-2017-5638 Apache Struts 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.5-2.3.31, 2.5-2.5.10

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，并且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts框架中的一个远程代码执行漏洞。该漏洞源于Jakarta Multipart parser在处理文件上传请求时，由于Content-Type头信息解析错误，导致OGNL表达式注入。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头信息，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞是有效的。搜索结果中提到该漏洞被广泛利用，并导致了严重的安全事件，例如Equifax数据泄露事件。提供的Python代码是一个POC，可以用于验证和利用该漏洞。

**投毒风险：**
虽然代码看起来是直接的漏洞利用程序，但是仍然存在一定的投毒风险。以下是风险评估和分析：
*   **网络请求依赖:** 代码依赖 `urllib2`，需要能够访问互联网。攻击者可能会修改代码，使其在特定条件下向恶意服务器发送敏感信息，或者从恶意服务器下载payload执行。这个风险较低，因为基本功能是命令执行。
*   **命令执行：** POC代码允许执行任意命令。如果该代码被修改并分发，攻击者可以将恶意命令硬编码到POC中，从而感染所有使用修改后POC的用户。
*   **Blind Injection 的依赖:** 代码中的blind injection依赖于外部IP并且需要apache可以读取log文件。此过程可能存在后门代码，但是需要进一步分析，才能判断。

 总体来说，该仓库中存在作者隐藏投毒代码的风险较低，大概在10%左右。 主要风险在于使用者不清楚代码逻辑，直接修改其中的cmd参数。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的HTTP请求，特别是Content-Type头。
2.  当Struts应用解析该请求时，恶意OGNL表达式会被执行。
3.  攻击者可以利用OGNL表达式执行任意系统命令，例如反弹shell，上传恶意文件等。
4.  提供的POC代码利用了这一漏洞，通过修改Content-Type头，在目标服务器上执行指定的命令。


**项目地址:** [tahmed11/strutsy](https://github.com/tahmed11/strutsy)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #31

**来源**: [CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md](../2017/CVE-2017-5638-testpilot031_vulnerability_struts-2.3.31.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，并且可以被网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638是Apache Struts2框架中的一个远程代码执行漏洞。该漏洞是由于Jakarta Multipart parser在处理文件上传请求时，对Content-Type等HTTP头信息处理不当，导致攻击者可以通过构造恶意的HTTP请求头，例如包含`${}`表达式或`#cmd=`字符串的Content-Type，从而执行任意系统命令。

**有效性评估：**
漏洞库信息、搜索引擎结果以及Exploit-DB中的相关资料均证实该漏洞的有效性。大量公开的PoC代码的存在进一步表明该漏洞可被利用。

**漏洞利用方式：**
1.  **构造恶意HTTP请求：**  攻击者需要构造一个包含恶意Content-Type、Content-Disposition或Content-Length HTTP头的POST请求，通常是文件上传的请求。Content-Type中包含OGNL表达式，会被Struts2解析执行，从而实现远程代码执行。
2.  **发送请求：** 将构造好的恶意HTTP请求发送给存在漏洞的Apache Struts2服务器。
3.  **代码执行：**  服务器在解析HTTP头信息时，会执行OGNL表达式，攻击者可以利用此特性执行任意系统命令，从而控制服务器。

**投毒风险分析：**
提供的Dockerfile用于构建一个包含漏洞环境的Tomcat容器，包含以下内容：
*   基础镜像: tomcat:7.0-jre8
*   生成密钥: 用于HTTPS配置，本身不构成风险。
*   部署struts2-showcase.war：一个包含Struts2示例应用的WAR包，用于演示Struts2的功能，该应用包含漏洞。
*   替换server.xml：用于配置Tomcat服务器，例如HTTPS。
Dockerfile本身不包含恶意代码，但由于其部署的struts2-showcase.war存在CVE-2017-5638漏洞，如果攻击者在不知情的情况下使用此Dockerfile构建环境进行测试，可能会被利用。存在一定被利用的风险，风险评估百分比为10%。此镜像本身更像是为了方便复现漏洞而准备的，主要风险还是来自war包内的漏洞。

**项目地址:** [testpilot031/vulnerability_struts-2.3.31](https://github.com/testpilot031/vulnerability_struts-2.3.31)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #32

**来源**: [CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md](../2017/CVE-2017-5638-toothbrushsoapflannelbiscuits_cve-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 需要目标系统运行存在漏洞的Apache Struts2版本，并且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts 2中的一个远程代码执行漏洞，存在于Jakarta Multipart parser处理文件上传时。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头部来执行任意命令。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞在野外已被积极利用，存在公开的PoC代码，因此认为提供的PoC代码是有效的。

**投毒风险：**
分析提供的Dockerfile和Java源代码，该Dockerfile构建了一个基于Tomcat的Web应用，其中包含了Struts2框架。`HelloWorldBuild.java`指定依赖的Struts2版本为2.3.31，属于漏洞影响范围。代码本身看起来是用于构建一个简单的“Hello World”应用，**未发现明显的恶意代码或后门**。因此，投毒风险较低，预估为0%。

**利用方式：**
利用方式是通过发送一个包含恶意构造的HTTP头部的请求到存在漏洞的Struts2应用。具体来说，可以通过Content-Type头部注入OGNL表达式，从而执行任意命令。攻击者通常会使用`#cmd=`或类似的语法来指定要执行的命令。例如，将`Content-Type`设置为`multipart/form-data; #cmd=whoami`，就可以执行`whoami`命令。

根据搜索结果，此漏洞影响巨大，Equifax的数据泄露事件就是由于利用了此漏洞。

**项目地址:** [toothbrushsoapflannelbiscuits/cve-2017-5638](https://github.com/toothbrushsoapflannelbiscuits/cve-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---

## POC #33

**来源**: [CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md](../2017/CVE-2017-5638-un4ckn0wl3z_CVE-2017-5638.md)

## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标服务器运行存在漏洞的Apache Struts2版本，且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。该漏洞利用的有效性高，因为网上存在大量公开的POC。提供的strustxp.py脚本通过构造包含恶意OGNL表达式的Content-Type头来实现远程代码执行。该脚本模拟了一个简单的shell环境，允许攻击者在目标服务器上执行命令。 

**漏洞利用方式：**

1.  攻击者发送包含恶意Content-Type头的HTTP请求到存在漏洞的Struts2应用。
2.  恶意Content-Type头包含一个OGNL表达式，该表达式会被Struts2解析并执行。
3.  OGNL表达式执行任意命令，例如反弹shell、读取文件等。

**投毒风险分析：**

分析提供的strustxp.py脚本，该脚本主要功能是利用CVE-2017-5638漏洞，远程执行命令。脚本本身并未发现明显的恶意代码或后门，其行为符合漏洞利用的预期。仓库中只有自述文件和exp脚本，没有其他可疑文件。因此，投毒风险评估为0%。

**总结：**

该漏洞利用的有效性高，风险等级为高危，但提供的POC代码本身不包含投毒风险。

**项目地址:** [un4ckn0wl3z/CVE-2017-5638](https://github.com/un4ckn0wl3z/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)

---



---



---



---



---



---

