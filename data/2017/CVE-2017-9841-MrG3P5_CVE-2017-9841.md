# CVE-2017-9841

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-MrG3P5_CVE-2017-9841.md](../2017/CVE-2017-9841-MrG3P5_CVE-2017-9841.md)

# CVE-2017-9841

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-MrG3P5_CVE-2017-9841.md](../2017/CVE-2017-9841-MrG3P5_CVE-2017-9841.md)

# CVE-2017-9841

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-MrG3P5_CVE-2017-9841.md](../2017/CVE-2017-9841-MrG3P5_CVE-2017-9841.md)

# CVE-2017-9841

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-MrG3P5_CVE-2017-9841.md](../2017/CVE-2017-9841-MrG3P5_CVE-2017-9841.md)

# CVE-2017-9841

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-MrG3P5_CVE-2017-9841.md](../2017/CVE-2017-9841-MrG3P5_CVE-2017-9841.md)

# CVE-2017-9841

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-MrG3P5_CVE-2017-9841.md](../2017/CVE-2017-9841-MrG3P5_CVE-2017-9841.md)

# CVE-2017-9841

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9841-Chocapikk_CVE-2017-9841.md](../2017/CVE-2017-9841-Chocapikk_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #2

**来源**: [CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md](../2017/CVE-2017-9841-Habibullah1101_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit 远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 的外部访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 版本到 5.6.3 之前的版本中。攻击者可以通过构造以 "<?php " 开头的 HTTP POST 数据，发送到暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI，从而执行任意 PHP 代码。漏洞利用方式是通过直接向存在漏洞的 eval-stdin.php 脚本发送包含恶意 PHP 代码的 POST 请求实现远程代码执行。

**有效性：**
漏洞库信息和搜索结果都表明这是一个有效的远程代码执行漏洞，存在可利用的 POC。

**投毒风险：**
提供的漏洞利用代码只是一个 LICENSE 文件，不包含任何可执行代码。 因此，判断该代码本身不存在投毒风险。

**利用方式：**
攻击者需要找到目标服务器上暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。然后，构造一个 HTTP POST 请求，请求体以 `<?php ` 开头，后面跟着要执行的 PHP 代码。 例如 `<?php system('whoami'); ?>`。将此请求发送到目标 URL 即可触发漏洞，执行攻击者设定的PHP代码。

**项目地址:** [Habibullah1101/PHPUnit-GoScan](https://github.com/Habibullah1101/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #3

**来源**: [CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md](../2017/CVE-2017-9841-K3ysTr0K3R_CVE-2017-9841-EXPLOIT.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #4

**来源**: [CVE-2017-9841-MadExploits_PHPunit-Exploit.md](../2017/CVE-2017-9841-MadExploits_PHPunit-Exploit.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且 /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 暴露在web访问下

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据，可以执行任意 PHP 代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞的 PHPUnit 版本的服务器，并且确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 可以通过 Web 访问。
2.  **构造Payload：** 构造一个以 `<?php` 开头的 PHP 代码，该代码将被执行。
3.  **发送请求：**  向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送一个 HTTP POST 请求，并将构造好的 PHP 代码放在 POST 数据中。
4.  **执行代码：** 服务器执行 POST 数据中的 PHP 代码。

**POC有效性评估：**

提供的POC代码是一个Python脚本，旨在利用 CVE-2017-9841 漏洞。脚本首先安装依赖(pycryptodome)，然后通过HTTP POST 发送包含PHP恶意代码的请求到目标服务器。根据漏洞描述和搜索结果，这个POC **有效**。

**投毒风险分析：**

该代码包含大量的混淆代码, 存在一定风险, 具体分析如下：

1.  **混淆处理：** POC 代码使用了 `pyobfuscate` (但实际上并没有看到调用)，以及大量的base64, zlib，codecs等编码混合使用, 通过字符串替换等操作,增加了代码阅读难度。
2.  **eval执行：** 存在一定的Eval函数, 存在执行恶意代码的风险。eval函数也可能是为了执行加密后的shellcode或其他恶意操作。 虽然eval可能是必须的为了将代码注入到存在漏洞的服务器, 但是也有可能混入攻击者自己的恶意代码
3.  **连接外部资源:** 没有发现连接恶意外部资源

虽然代码存在混淆，但主要功能是利用漏洞，并不能完全确定为投毒代码。混淆的目的是为了绕过检测，并非一定包含恶意行为。综合判断，认为该POC存在 **20%** 的投毒风险。

**项目地址:** [MadExploits/PHPunit-Exploit](https://github.com/MadExploits/PHPunit-Exploit)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #5

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #6

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---



---

## POC #6

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #18

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---



---

## POC #6

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #18

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---



---

## POC #6

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #18

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---



---

## POC #6

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #18

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---



---

## POC #6

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #18

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---



---

## POC #6

**来源**: [CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md](../2017/CVE-2017-9841-Pwdnx1337_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，即可以通过web访问该文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中的一个远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞存在于 PHPUnit 4.8.28 之前版本以及 5.x 系列的 5.6.3 之前版本中。攻击者可以通过向 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 `<?php` 开头的恶意 PHP 代码的 POST 请求来执行任意代码。

**漏洞利用方式:**

1.  **确定目标:**  目标服务器上必须安装了受影响版本的 PHPUnit，并且 `/vendor` 目录对外暴露，允许通过 Web 访问 `eval-stdin.php` 文件。
2.  **构造Payload:**  构造一个以 `<?php` 开头的 PHP 代码，作为 POST 请求的数据发送到目标服务器的 `eval-stdin.php` 路径。
3.  **发送请求:**  使用 POST 方法发送包含恶意 PHP 代码的请求。
4.  **执行代码:**  服务器上的 `eval-stdin.php` 脚本会执行 POST 请求中的 PHP 代码，从而导致远程代码执行。

**POC有效性评估:**

提供的 POC 代码 `phpunit.py` 的功能是：

1.  **设置目标URL：** 接收目标URL列表作为参数，读取目标URL
2.  **构造包含恶意PHP代码的POST请求:** 使用 `<?php` 开头，包含下载并执行一个名为 `ZIP.php` 文件的命令 (通过 curl 命令从 `https://raw.githubusercontent.com/Pwdny1337/ZIP/refs/heads/main/ZIP.php` 下载)。
3.  **发送POST请求:**  使用 `requests` 库向目标服务器的 `eval-stdin.php` 路径发送带有恶意PHP代码的POST请求。
4.  **验证是否成功:**  检查是否成功下载并执行了 `ZIP.php` 文件。如果状态码是200并且内容包含“PHP”，则认为漏洞利用成功。
5.  **保存结果:**  将成功利用漏洞的URL保存到 `save.txt` 和 `result/Shell_results.txt` 文件中。

此POC代码逻辑清晰，功能完整，能够有效利用该漏洞执行远程代码，所以是有效的。

**投毒风险评估:**

分析POC代码，没有发现作者植入的恶意代码，用于反制攻击者或者进行其他恶意行为。POC利用的是公开的远程代码执行漏洞，执行的代码也是从GitHub下载，虽然存在一定风险，但不能视为POC代码本身的投毒行为。因此判定投毒风险为0%。

根据搜索结果，CVE-2017-9841 漏洞曾在野外被广泛利用，攻击者经常扫描和利用此漏洞。即使在漏洞公布多年后，仍然存在攻击活动，表明一些系统仍然未修复此漏洞。

**项目地址:** [Pwdnx1337/CVE-2017-9841](https://github.com/Pwdnx1337/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #7

**来源**: [CVE-2017-9841-RandomRobbieBF_phpunit-brute.md](../2017/CVE-2017-9841-RandomRobbieBF_phpunit-brute.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器安装了存在漏洞版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php文件可以通过Web访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 4.8.28 之前版本和 5.x 5.6.3 之前版本中的 Util/PHP/eval-stdin.php 文件。该漏洞允许远程攻击者通过以 "<?php " 子字符串开头的 HTTP POST 数据执行任意 PHP 代码。该漏洞的利用方式是向暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI发送POST请求，请求体包含恶意的PHP代码。 

**POC有效性：**
根据漏洞描述和提供的POC代码，该POC有效。POC代码（phpunit-brute.py）通过尝试常见的PHPUnit安装路径，向目标URL发送包含 `<?php phpinfo();` 的POST请求，如果返回的响应中包含 “PHP License as published by the PHP Group”，则认为该路径存在漏洞。

**投毒风险：**
该POC代码的主要功能是暴力破解可能存在的漏洞路径，并发送包含phpinfo()函数的POST请求以验证漏洞是否存在。代码中存在通过HTTP请求外部github资源的行为，存在一定投毒风险，主要体现在:
1. githubusercontent内容可能被篡改,该脚本本身并不会执行任何恶意代码,但是如果githubusercontent的内容被篡改,那么该脚本的功能和预期输出将发生改变,例如将`phpinfo()`替换为其他恶意代码。
2.  该脚本会向found.txt中写入发现的URL，攻击者可以通过修改该文件来引导受害者访问恶意站点。综合判断，投毒风险较低，大约为5%。

**利用方式：**
1.  使用`phpunit-brute.py`脚本，指定目标URL（`-u` 参数）开始扫描。
2.  脚本会尝试不同的PHPUnit路径，并发送包含PHP代码的POST请求。
3.  如果脚本找到可利用的路径，会将该路径写入`found.txt`文件。
4.  攻击者可以修改POST请求中的PHP代码，执行任意命令，从而控制服务器。

**项目地址:** [RandomRobbieBF/phpunit-brute](https://github.com/RandomRobbieBF/phpunit-brute)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #8

**来源**: [CVE-2017-9841-akr3ch_CVE-2017-9841.md](../2017/CVE-2017-9841-akr3ch_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的Util/PHP/eval-stdin.php文件中。攻击者可以通过构造包含PHP代码的HTTP POST请求发送到该文件，从而执行任意PHP代码。漏洞利用代码显示，它通过向目标URL的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径发送POST请求，并在请求体中包含以"<?php"开头的PHP代码来实现远程代码执行。由于代码中没有发现任何可疑的后门或者恶意行为，因此投毒风险评估为0%。利用方式是未经授权的攻击者可以直接访问eval-stdin.php文件并执行PHP代码，无需任何身份验证。

**项目地址:** [akr3ch/CVE-2017-9841](https://github.com/akr3ch/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #9

**来源**: [CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md](../2017/CVE-2017-9841-cyberharsh_Php-unit-CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #10

**来源**: [CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md](../2017/CVE-2017-9841-drcrypterdotru_PHPUnit-GoScan.md)

## CVE-2017-9841 PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 4.8.28之前和5.x版本5.6.3之前

**利用条件:** 需要目标服务器暴露/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php路径且可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的“漏洞利用代码”判断漏洞利用有效，但“漏洞利用代码”实际上是一个Apache License的LICENSE文件，**不是真正的漏洞利用代码**，它本身没有恶意行为，所以判断投毒风险为0%。漏洞利用方式是通过向暴露的 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI发送包含 `<?php` 开头的HTTP POST数据，服务器会执行这段PHP代码，从而实现远程代码执行。

虽然给出的“漏洞利用代码”不是PoC，但搜索引擎结果和漏洞库信息都表明该漏洞是可利用的。攻击者可以通过构造包含恶意代码的POST请求发送到目标URI来利用此漏洞。漏洞利用难度在于需要找到暴露且未修复的 `eval-stdin.php` 文件。

**项目地址:** [drcrypterdotru/PHPUnit-GoScan](https://github.com/drcrypterdotru/PHPUnit-GoScan)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #11

**来源**: [CVE-2017-9841-dream434_CVE-2017-9841.md](../2017/CVE-2017-9841-dream434_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #12

**来源**: [CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md](../2017/CVE-2017-9841-incogbyte_laravel-phpunit-rce-masscaner.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器运行受影响版本的PHPUnit，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过向 `Util/PHP/eval-stdin.php` 发送以 `<?php` 开头的 HTTP POST 数据来执行任意 PHP 代码。从提供的漏洞库信息和搜索引擎结果来看，这是一个被广泛利用的漏洞。PoC代码仓库提供了一个masscanner，表明了该漏洞的可利用性。 

**有效性：**
提供的PoC代码利用了该漏洞，通过扫描目标并发送恶意payload实现远程代码执行。

**投毒风险：**
代码仓库包含 `Pipfile` 和 `Pipfile.lock`，用于管理依赖。`README.md` 描述了工具的用法，包括扫描IP范围和主机列表。`dorks.txt` 包含用于查找潜在目标的 Google dorks。`main.py` 是主脚本，负责执行扫描和利用。 `error.log` 为空，表明没有已知的报错信息

虽然看起来是一个正常的漏洞利用工具，但是代码中仍然存在一定的投毒风险：

*   **隐蔽后门：** 作者可能在 `modules/executor.py`或其他未提供的模块中添加了恶意代码，例如收集目标信息或执行其他未授权操作。由于 `modules` 文件夹中的具体文件未提供，无法完全确定。 
*   **依赖项风险：** 虽然 `Pipfile.lock` 锁定了解释和依赖项的版本，但仍然存在通过替换PyPI镜像源的方式引入恶意依赖的风险。 

综合考虑，认为存在 **10%** 的投毒风险，主要集中在 `modules` 文件夹中的脚本是否做了其他未授权的操作上。 

**利用方式：**
1.  扫描：使用提供的扫描脚本或dorks扫描互联网上暴露的、存在漏洞的PHPUnit应用。
2.  Payload构造：构造以 `<?php` 开头的 PHP 代码，例如执行系统命令的 `<?php system($_GET['cmd']); ?>`。
3.  发送请求：向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含 payload 的 HTTP POST 请求。
4.  代码执行：服务器执行 payload，攻击者可以控制服务器。

**项目地址:** [incogbyte/laravel-phpunit-rce-masscaner](https://github.com/incogbyte/laravel-phpunit-rce-masscaner)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #13

**来源**: [CVE-2017-9841-jax7sec_CVE-2017-9841.md](../2017/CVE-2017-9841-jax7sec_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #14

**来源**: [CVE-2017-9841-joelindra_Argus.md](../2017/CVE-2017-9841-joelindra_Argus.md)

## CVE-2017-9841-PHPUnit-RCE

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHPUnit

**危害等级:** 高危，可完全控制服务器

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 需要目标服务器开放/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径，且使用受影响的PHPUnit版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841是PHPUnit框架中Util/PHP/eval-stdin.php文件存在的一个远程代码执行漏洞。该漏洞允许攻击者通过向目标URL发送以"<?php "开头的HTTP POST请求数据来执行任意PHP代码。

**有效性：**

提供的漏洞利用代码(Argus PHPUnit Scanner)似乎有效。它通过尝试访问已知的`eval-stdin.php`路径，发送包含唯一指纹的PHP代码，并分析响应来验证代码执行。搜索引擎结果也表明该漏洞确实存在并且已被利用。

**投毒风险：**

尽管该漏洞利用代码主要功能是扫描和检测漏洞，并非直接利用，但仍存在一定的投毒风险。具体分析如下：

*   **风险点分析：**
    1.  **扫描器逻辑：** 扫描器本身需要发起HTTP请求，处理响应，如果作者在代码中植入恶意逻辑，例如在特定条件下修改请求头、请求体或者恶意处理响应数据，可能导致目标服务器遭受攻击或被植入后门。
    2.  **结果文件处理：** 扫描结果会被写入文件，如果这些文件处理逻辑存在漏洞（例如格式化字符串漏洞），可能被利用。
    3.  **依赖库：** 扫描器依赖于多个第三方库（requests, colorama, tqdm等）。虽然这些库本身通常是安全的，但总是存在一定的供应链风险。作者可能通过替换这些库或者引入恶意版本来投毒，影响到扫描器的行为。
*   **风险评估：**
    代码存在网络请求，存在依赖库，所以存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用了存在漏洞版本的PHPUnit，并且/vendor目录暴露在外的网站。
2.  **发送恶意请求：** 使用POST方法，向目标`eval-stdin.php`路径发送请求，请求内容以`<?php `开头，包含需要执行的PHP代码。例如：`<?php system($_GET['cmd']); ?>`
3.  **执行代码：** 目标服务器上的`eval-stdin.php`文件会执行POST数据中的PHP代码，攻击者可以通过`cmd`参数传递命令。

总体来说，虽然提供的代码是一个漏洞扫描器，但仍然存在一定的投毒风险，尤其是在使用未经验证的第三方工具时需要格外小心。建议在使用前进行代码审计，或者使用官方和信誉良好的漏洞扫描工具。

**项目地址:** [joelindra/Argus](https://github.com/joelindra/Argus)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #15

**来源**: [CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md](../2017/CVE-2017-9841-ludy-dev_PHPUnit_eval-stdin_RCE.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #16

**来源**: [CVE-2017-9841-mbrasile_CVE-2017-9841.md](../2017/CVE-2017-9841-mbrasile_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #17

**来源**: [CVE-2017-9841-mileticluka1_eval-stdin.md](../2017/CVE-2017-9841-mileticluka1_eval-stdin.md)

## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI 必须可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 中的一个远程代码执行漏洞。该漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，从而执行任意PHP代码。根据搜索引擎结果，此漏洞在过去几年中被广泛利用，表明其有效性。提供的 Ruby 脚本 `evil-eval.rb` 旨在自动化利用此漏洞。它通过构造包含 PHP 代码的 HTTP POST 请求，并将其发送到易受攻击的 `eval-stdin.php` 终端节点来实现远程代码执行。脚本允许用户执行各种命令，如 `checkconnection`（验证连接）、`privesc`（运行 LinPeas 以进行权限提升）和 `revshell`（启动反向 shell）。

**关于投毒风险：**

仔细检查提供的 Ruby 脚本 `evil-eval.rb` 和 `README.md`，未发现明显的恶意代码或后门。该脚本的主要功能是利用已知的 CVE-2017-9841 漏洞，通过构造 HTTP 请求执行系统命令或启动反向 shell。脚本中的命令如`privesc`下载并执行外部脚本（LinPeas），但下载源是明确的GitHub仓库，如果LinPeas本身存在问题，那属于另一个层面的风险。`revshell`也需要用户提供IP地址和监听端口，是常规的反向shell利用方式。因此，当前仓库中没有发现作者隐藏的投毒代码。

**漏洞利用方式：**

1.  **确定目标：** 找到运行易受攻击的 PHPUnit 版本的 Web 服务器，并且 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI 可公开访问。
2.  **构造 Payload：** 构造一个以 `<?php` 开头的 PHP 代码 Payload，该 Payload 包含要执行的恶意代码。
3.  **发送 HTTP POST 请求：** 将构造的 Payload 作为 HTTP POST 数据发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` URI。
4.  **执行代码：** 服务器上的 PHPUnit 将执行 Payload 中的 PHP 代码，从而允许攻击者远程控制服务器。
5.  **使用提供的脚本：** 运行 `evil-eval.rb` 脚本，按照提示输入目标 URL，并使用可用的命令执行各种操作，例如检查连接，尝试权限提升或启动反向 shell。

**项目地址:** [mileticluka1/eval-stdin](https://github.com/mileticluka1/eval-stdin)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

## POC #18

**来源**: [CVE-2017-9841-p1ckzi_CVE-2017-9841.md](../2017/CVE-2017-9841-p1ckzi_CVE-2017-9841.md)

## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** 4.8.28之前和5.x在5.6.3之前的版本

**利用条件:** 目标服务器运行存在漏洞的PHPUnit版本，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI可以被外部访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过向该文件发送以 `<?php` 开头的 HTTP POST 数据，来执行任意 PHP 代码。 

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用代码是有效的。它利用了 PHPUnit 的 `eval-stdin.php` 文件，该文件接受 POST 请求中的 PHP 代码并执行。通过发送特制的 POST 请求，攻击者可以执行任意命令。

**投毒风险：**
检查提供的 `phpunit-shell.py` 脚本和 `README.md`，该脚本主要功能是利用 CVE-2017-9841 漏洞执行命令。脚本本身看起来相对简单，主要通过构造 HTTP POST 请求，将 PHP 代码发送到目标服务器执行，没有发现明显的恶意代码或后门。
然而，存在以下几点需要注意：
1.  **依赖项风险：** 脚本依赖于 `requests` 和 `bs4` 模块。虽然这些模块本身通常是安全的，但如果从不可信的源安装，可能会被篡改。建议从官方 PyPI 仓库安装这些依赖项。
2.  **命令执行风险：** 该脚本允许执行任意系统命令。如果攻击者控制了该脚本或脚本运行的机器，他们可以利用此漏洞执行恶意操作。
3. **隐蔽性风险** 该脚本的作者的代码注释和README描述,存在诱导使用者使用的倾向,如果使用者没有代码审计能力,会加大被钓鱼的风险.

总体来说，`phpunit-shell.py` 脚本本身的投毒风险较低，但用户需要谨慎使用，并确保从可信的来源获取依赖项。考虑到依赖风险和隐蔽风险，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的服务器，并确认 `eval-stdin.php` 文件可以从外部访问。
2.  **构造请求：** 使用提供的 `phpunit-shell.py` 脚本或手动构造一个 HTTP POST 请求，该请求包含以 `<?php` 开头的 PHP 代码。例如：`<?php system($_GET['cmd']); ?>`。
3.  **发送请求：** 将构造的请求发送到 `eval-stdin.php` 文件的 URL。
4.  **执行命令：** 成功利用后，攻击者可以在目标服务器上执行任意命令。在上面的例子中，攻击者可以通过 URL 参数 `cmd` 来指定要执行的命令，例如 `http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php?cmd=whoami`。

**项目地址:** [p1ckzi/CVE-2017-9841](https://github.com/p1ckzi/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)

---

