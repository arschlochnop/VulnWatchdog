## CVE-2017-12149 - JBoss Application Server 反序列化/RCE

**漏洞编号:** CVE-2017-12149

**漏洞类型:** 反序列化/RCE

**影响应用:** JBoss Application Server

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P)

**影响版本:** JBoss AS 5.x, 6.x

**利用条件:** 无需认证，可通过网络访问JBoss的ReadOnlyAccessFilter组件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于JBoss AS的HttpInvoker组件中的ReadOnlyAccessFilter过滤器，其在处理HTTP请求时未对用户输入进行安全的反序列化校验，导致攻击者可以构造恶意的序列化对象发送到/invoker/readonly路径，从而在服务器端执行任意Java代码。本次分析的POC代码是一个完整的Java Swing GUI程序。代码逻辑通过MainAPP类构建图形界面，获取目标JBoss服务器的IP和端口以及用于反弹Shell的本地监听IP和端口。核心逻辑位于Payload生成类中，它将反弹Shell的Payload封装进序列化的对象，并利用HTTP POST请求发送至目标路径。从代码实现看，该POC使用了Java标准库进行网络通信（URLConnection/Socket）和图形化展示，结构清晰，针对JBoss 6.x版本的默认配置具有极高的利用成功率。利用步骤：1. 环境准备：确保目标JBoss服务器（5.x或6.x）已启动且能访问/invoker/readonly。2. 攻击机配置：在本地使用NC或其他工具监听指定端口（如1234）。3. 运行POC：打开该Java程序，在‘jboss ip/port’框输入目标地址，在‘shell ip/port’框输入攻击机IP及监听端口。4. 触发：点击‘Send’按钮，POC将自动化生成Payload、建立连接并发送，若成功，攻击机将获得目标服务器的Shell。 投毒风险分析：该POC项目主要由Java源码组成，代码可读性较高。经过对MainAPP.java及逻辑流的审查，未发现明显的恶意混淆代码或第三方库劫持行为。代码主要操作是针对用户输入的JBoss服务器IP发起HTTP POST请求，其行为符合安全研究工具的预期。然而，由于该POC采用了编译后的GUI形式发布（虽然提供了源码），在实际分发过程中，攻击者可能在生成的JAR包中植入后门代码，如隐藏的系统信息收集、攻击者C2地址的回传或修改后的字节码文件。分析发现该POC依赖于特定的Payload生成类，如果Payload类中硬编码了除用户输入以外的外部连接，则存在投毒嫌疑。目前源码层面表现为标准的漏洞验证逻辑，但在未经过全量静态扫描和动态沙箱跑测的情况下，直接运行来源不明的可执行JAR文件仍具有中低度风险。建议防御者在受控隔离环境（如虚拟机或沙箱）中运行此POC，并严格监控其网络出口流量，防止敏感信息外泄。

**项目地址:** [https://github.com/Sevck/CVE-2017-12149](https://www.google.com/search?q=https://github.com/Sevck/CVE-2017-12149)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
