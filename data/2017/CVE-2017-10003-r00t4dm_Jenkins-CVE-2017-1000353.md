# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md](../2017/CVE-2017-10003-r00t4dm_Jenkins-CVE-2017-1000353.md)

# CVE-2017-10003

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md](../2017/CVE-2017-10003-Jelc0Doesbruf_CVE-2017-1000353.md)

## CVE-2017-10003-Solaris-Network Services Library

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致敏感数据泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris基础设施

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

CVE-2017-10003 是 Oracle Sun Systems Products Suite 中 Solaris 组件（子组件：网络服务库）中的一个漏洞。受影响的版本是 10。攻击难度较高，需要低权限的攻击者登录到执行 Solaris 的基础设施才能攻击 Solaris。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些 Solaris 可访问数据的访问，以及未经授权的读取对 Solaris 可访问数据子集的访问，以及未经授权的能力导致 Solaris 的部分拒绝服务 (partial DOS)。CVSS 3.0 基本分数为 4.5（机密性、完整性和可用性影响）。CVSS 向量：（CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L）。

根据提供的漏洞利用代码，大部分是node.js代码以及docker配置，以及一些数据库文件，和CVE描述不符。该代码更像是一个使用 node.js 构建的应用程序的骨架，与 Solaris 系统漏洞利用无关。因此，提供的代码**不具有**针对 CVE-2017-10003 的有效利用价值。

**投毒风险评估：**提供的代码包含大量文件，其中存在一些可疑的文件，例如在client/public, client/src, database/seeds 等目录下存在命名不规范的 .py 或 .txt 文件。这些文件可能包含恶意代码或配置。Dockerfile 构建的镜像也存在潜在风险。因此，存在较高的投毒风险，估计概率为 95%。

**利用方式分析：**由于提供的漏洞利用代码与描述的Solaris漏洞不符，无法确定该代码的利用方式。但根据漏洞描述，该漏洞可能允许低权限用户在 Solaris 系统上执行未授权的数据修改、读取或导致部分拒绝服务攻击。如果代码有效，攻击者可能利用该漏洞提升权限或干扰系统正常运行，但是当前代码无法证实。

**项目地址:** [Jelc0Doesbruf/CVE-2017-1000353](https://github.com/Jelc0Doesbruf/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #2

**来源**: [CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md](../2017/CVE-2017-10003-Trinadh465_linux-4.1.15_CVE-2017-1000371.md)

## CVE-2017-10003-Oracle Solaris Network Services Library权限提升/信息泄露/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/信息泄露/DoS

**影响应用:** Oracle Solaris Network Services Library

**危害等级:** 中危，可能导致敏感数据泄露、部分数据篡改和部分服务拒绝

**影响版本:** 10

**利用条件:** 需要低权限用户已登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 99%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite的Solaris组件（子组件：Network Services Library）中的一个漏洞。受影响的版本是10。利用难度较高，需要低权限攻击者登录到Solaris基础设施才能利用。成功利用此漏洞可能导致未经授权的更新、插入或删除对某些Solaris可访问数据的访问，以及未经授权的读取对Solaris可访问数据的子集的访问，以及未经授权的能力导致Solaris的部分拒绝服务（部分DoS）。

**有效性：**
根据漏洞信息和搜索结果，该漏洞利用难度较高。虽然有CVE编号和漏洞描述，但没有公开可用的POC代码。提供的代码只是GPL协议的声明，不包含任何漏洞利用相关的逻辑。

**投毒风险：**
提供的代码是GPL协议声明，并非漏洞利用代码，因此不包含投毒代码，该文件本身只是开源协议的文本内容。因此，投毒风险非常低。

**利用方式：**
根据漏洞描述，攻击者需要满足以下条件才能利用该漏洞：

1.  拥有Solaris 10系统的低权限用户账号。
2.  攻击者需要能够登录到Solaris系统。
3.  攻击需要利用Network Services Library子组件的漏洞。

成功利用该漏洞后，攻击者可以：

1.  未经授权地更新、插入或删除某些Solaris可访问的数据。
2.  未经授权地读取Solaris可访问数据的子集。
3.  导致Solaris的部分拒绝服务（部分DoS）。

**总结：**
CVE-2017-10003是一个中危漏洞，但利用难度较高。当前没有可用的POC代码。提供的代码不是漏洞利用代码，而是GPL许可证文件，因此不存在投毒风险。攻击者需要拥有Solaris 10系统的低权限用户账号才能利用此漏洞，从而造成数据泄露、数据篡改或者拒绝服务。

**项目地址:** [Trinadh465/linux-4.1.15_CVE-2017-1000371](https://github.com/Trinadh465/linux-4.1.15_CVE-2017-1000371)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #3

**来源**: [CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md](../2017/CVE-2017-10003-c0d3z3r0_sudo-CVE-2017-1000367.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris权限提升/数据篡改/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致未授权数据修改、读取和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录到Solaris系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10003是Oracle Sun Systems Products Suite Solaris组件(Network Services Library子组件)中的一个漏洞。受影响的版本为10。漏洞难以利用，但低权限攻击者登录到Solaris基础设施后，可以利用该漏洞危害Solaris系统。成功利用该漏洞可能导致未经授权的更新、插入或删除Solaris可访问数据的权限，以及未经授权读取Solaris可访问数据的子集，并可能导致Solaris的部分拒绝服务(partial DOS)。

根据提供的漏洞利用代码`sudopwn.c`和`README.md`，该POC主要利用了sudo的某些特性结合inotify机制来尝试进行权限提升。该利用方式的思路是：

1.  **环境准备:** 首先，创建`/dev/shm/_tmp`目录，并分别创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/ 34873 `。
2.  **inotify监控:** 使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。
3.  **Fork子进程:**  Fork一个子进程，并将该子进程的调度策略设置为`SCHED_IDLE`，优先级设置为19。
4.  **子进程执行sudo:** 子进程休眠1秒后，使用`execlp`执行`/dev/shm/_tmp/ 34873 `，即sudo，并传递参数`-r unconfined_r /usr/bin/sum --
HELLO
WORLD
`。该命令的目的是使用sudo以`unconfined_r`角色执行`/usr/bin/sum`命令，并传入`HELLO`和`WORLD`作为输入。
5.  **父进程监控和干预:** 父进程将自身的优先级设置为-20，并循环读取inotify事件。当监听到`IN_OPEN`事件时，停止子进程，然后打开一个新的pty，并将`pts_path`设置为`/dev/pts/57`。当监听到`IN_CLOSE_NOWRITE`事件时，停止子进程，删除`/dev/shm/_tmp/_tty`符号链接，并创建一个新的符号链接指向`/etc/motd`。
6.  **利用分析:** 该POC尝试通过竞争条件和符号链接替换的方式，影响sudo的执行行为。具体来说，它尝试在sudo打开`/dev/pts/57`时，通过inotify机制捕获该事件，然后打开一个新的pty，确保sudo使用预期的tty。然后，当sudo关闭`/dev/pts/57`时，替换`/dev/shm/_tmp/_tty`符号链接，使其指向`/etc/motd`，这可能导致sudo读取`/etc/motd`的内容，从而影响其执行结果。通过指定`unconfined_r`角色，结合特殊的命令（`/usr/bin/sum`）和输入，攻击者试图绕过sudo的权限检查，从而执行未授权的操作。

**有效性:** 根据漏洞描述和代码分析，这个POC代码并非直接利用CVE-2017-10003，而是利用了另一个漏洞CVE-2017-1000367, 并且该POC依赖SELinux，并需要用户具有一定的sudo权限才能利用。根据漏洞库信息, CVE-2017-10003的利用难度为“困难”。因此，提供的POC代码可能有效，但利用条件较为苛刻。

**投毒风险:** 该代码存在一定的投毒风险，可能性评估为10%。

*   **可疑的符号链接操作:**  在`/dev/shm`目录下创建和修改符号链接具有一定的风险，如果攻击者能够控制这些符号链接的目标文件，则可能执行任意代码或读取敏感信息。
*   **竞争条件:**  POC中使用了竞争条件，这使得利用的稳定性降低。攻击者可能通过精心构造的恶意代码，提高竞争成功的概率，从而达到不可预期的目的。
*   **对sudo行为的假设:**  POC假设了sudo的特定行为，如果sudo的实现方式发生变化，则POC可能失效。攻击者可能通过修改POC，使其适应新的sudo实现，从而达到攻击目的。

但是,该漏洞利用代码主要集中在利用SELinux和sudo的特性进行权限提升,并未发现明显的后门代码.

**排序优先级:** 根据排序优先级要求,结合搜索引擎结果,代码分析以及漏洞库信息,可知该漏洞存在,但是利用有一定难度,且有较多的依赖环境和配置,POC代码并非直接针对CVE-2017-10003漏洞, 而是针对CVE-2017-1000367漏洞。

**项目地址:** [c0d3z3r0/sudo-CVE-2017-1000367](https://github.com/c0d3z3r0/sudo-CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #4

**来源**: [CVE-2017-10003-homjxi0e_CVE-2017-1000367.md](../2017/CVE-2017-10003-homjxi0e_CVE-2017-1000367.md)

## CVE-2017-1000367 - Sudo权限提升漏洞

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** 受影响版本包括Red Hat Enterprise Linux 6/7, Oracle Enterprise Linux 6/7, CentOS Linux 6/7, Debian wheezy/jessie/stretch/sid, Ubuntu 17.04/16.10/16.04 LTS/14.04 LTS, SUSE Linux Enterprise Software Development Kit 12-SP2, SUSE Linux Enterprise Server for Raspberry Pi 12-SP2, SUSE Linux Enterprise Server 12-SP2, SUSE Linux Enterprise Desktop 12-SP2, OpenSuse, Slackware, and Gentoo Linux

**利用条件:** 需要本地用户权限, 并且系统开启了SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于sudo的get_process_ttyname()函数中。该函数读取/proc/[pid]/stat文件以获取tty设备号。由于comm字段（命令的文件名）可能包含空格，导致tty设备号解析错误。攻击者可以通过创建包含空格的符号链接来执行sudo，诱使get_process_ttyname()搜索错误的tty设备号。进一步利用/dev/shm的world-writable特性，攻击者可以伪造tty设备，结合竞争条件，将任意文件指定为tty。在SELinux启用的系统中，如果用户是sudoer，但命令不授予root权限，则可以利用relabel_tty()函数打开（O_RDWR | O_NONBLOCK）伪造的tty，并将其dup2()到命令的stdin、stdout和stderr，从而覆盖任意文件（包括root拥有的文件），最终获得root权限。

**有效性:**
提供的POC代码针对 CVE-2017-1000367，看起来是有效的。代码尝试利用 /dev/shm 目录下的竞争条件来劫持 tty 设备，并覆盖文件。

**投毒风险:**
代码的README.md包含漏洞描述和受影响的系统，以及修复方法。sudopwn.c包含漏洞利用代码，创建目录和符号链接，设置进程优先级，并使用inotify来监视文件系统的变化。在fork子进程后，通过exec执行sudo命令。父进程设置更高的优先级，并循环读取inotify事件，使用kill向子进程发送信号，实现竞争条件。虽然代码比较复杂，但没有明显的后门代码，例如植入恶意指令或进行反向shell连接。风险评估为10%。

**利用方式:**
1.  创建world-writable的/dev/shm/_tmp目录。
2.  创建符号链接，将/dev/pts/57链接到/dev/shm/_tmp/_tty，/usr/bin/sudo链接到/dev/shm/_tmp/     34873 。
3.  使用inotify监控/dev/shm/_tmp目录。
4.  Fork一个子进程。
5.  在子进程中，降低优先级，然后使用带特定参数的sudo执行/dev/shm/_tmp/     34873 。
6.  在父进程中，设置更高的优先级，并循环读取inotify事件。
7.  当inotify检测到/dev/shm/_tmp目录的IN_OPEN事件时，暂停子进程(kill(pid, SIGSTOP))。
8.  通过竞争条件和tty劫持，利用relabel_tty()函数覆盖文件，获取root权限。

**项目地址:** [homjxi0e/CVE-2017-1000367](https://github.com/homjxi0e/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #5

**来源**: [CVE-2017-10003-letsr00t_CVE-2017-1000367.md](../2017/CVE-2017-10003-letsr00t_CVE-2017-1000367.md)

## CVE-2017-10003-Solaris-权限提升/DoS

**漏洞编号:** CVE-2017-10003

**漏洞类型:** 权限提升/DoS

**影响应用:** Solaris Operating System (Network Services Library)

**危害等级:** 中危，可导致敏感数据读取、修改以及部分拒绝服务

**影响版本:** 10

**利用条件:** 需要本地低权限用户登录

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，CVE-2017-10003影响Solaris 10操作系统中的网络服务库。该漏洞利用的难点在于需要本地低权限用户登录，并且难以利用。成功利用后，攻击者可以进行未授权的数据更新、插入、删除，以及读取部分敏感数据，并造成部分拒绝服务。

分析提供的漏洞利用代码 (sudopwn.c):

*   **利用方式：** 该PoC利用了`/dev/shm`目录下的共享内存特性和一个竞争条件。它首先创建`/dev/shm/_tmp`目录，并在其中创建指向`/dev/pts/57`和`/usr/bin/sudo`的符号链接（`/dev/shm/_tmp/_tty`和`/dev/shm/_tmp/     34873 `，注意sudo的符号链接文件名包含空格）。然后，它使用inotify监控`/dev/shm/_tmp`目录的`IN_OPEN`和`IN_CLOSE_NOWRITE`事件。

    子进程（通过`fork()`创建）执行`sudo -r unconfined_r /usr/bin/sum $'--\nHELLO\nWORLD\n'`。  父进程通过inotify监听子进程打开和关闭`/dev/shm/_tmp`目录下的文件的事件。当子进程打开`/dev/shm/_tmp/_tty`时，父进程使用`openpty`打开一个新的pts设备，并将其路径存储在`pts_path`中，直到其值为`/dev/pts/57`。

    当子进程关闭`/dev/shm/_tmp/_tty`时，父进程删除`/dev/shm/_tmp/_tty`，并创建一个指向`/etc/PWN`的新符号链接。 竞争条件在于，如果`sudo`在父进程替换符号链接之前打开了`/dev/shm/_tmp/_tty`，那么它会使用真正的tty。如果父进程足够快，那么`sudo`会打开指向`/etc/PWN`的符号链接。

*   **有效性：** 代码尝试劫持`sudo`命令对`/dev/shm/_tmp/_tty`的访问，通过竞争条件将`/dev/shm/_tmp/_tty`指向`/etc/PWN`，`/etc/PWN`的内容会被当成`sudo`执行命令的输入，如果`/etc/PWN`内容恶意构造，是有可能提权的。这个PoC有一定概率成功，但依赖于竞争条件，所以成功率可能不高。

*   **投毒风险：** 该PoC代码存在投毒风险的可能性较低。PoC主要逻辑是利用竞争条件进行符号链接替换，本身不包含明显的后门代码。`/etc/PWN`文件内容需要进一步分析,如果没有相关的恶意代码，则投毒风险较低。但是，不能排除作者在其他地方隐藏了恶意代码的可能性。 例如将`/etc/PWN`的内容设置成恶意代码，但是PoC本身的功能是利用漏洞，所以判断投毒的可能性较低。考虑到可能存在的隐蔽风险，评估结果为5%。

**项目地址:** [letsr00t/CVE-2017-1000367](https://github.com/letsr00t/CVE-2017-1000367)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

## POC #6

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---



---

## POC #7

**来源**: [CVE-2017-10003-vulhub_CVE-2017-1000353.md](../2017/CVE-2017-10003-vulhub_CVE-2017-1000353.md)

## CVE-2017-10003

**漏洞编号:** CVE-2017-10003

**漏洞类型:** Solaris Network Services Library 权限提升/DoS

**影响应用:** Solaris Operating System

**危害等级:** 中危，可能导致数据修改、信息泄露和部分拒绝服务

**影响版本:** 10

**利用条件:** 需要低权限用户登录Solaris 10

**POC 可用性:** 否(根据搜索结果和漏洞库信息，存在POC，但给定的代码不是该漏洞的PoC)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2017-10003是Oracle Sun Systems Products Suite (Solaris 组件中的 Network Services Library)的一个漏洞。该漏洞允许低权限的攻击者通过登录Solaris 10系统，进行未授权的数据更新、插入、删除，以及读取部分数据，还可能造成部分拒绝服务(DoS)。漏洞利用难度较高。CVSS 3.0 评分为4.5。

提供的代码与CVE-2017-1000353(Jenkins)漏洞相关，而不是CVE-2017-10003(Solaris)。该代码是一个针对Jenkins反序列化漏洞的PoC，允许远程代码执行。它包含一个`exploit.py`脚本，该脚本通过向Jenkins服务器发送特制的序列化对象来触发漏洞，最终执行任意命令。`jenkins_poc.ser`文件是序列化的payload，需要使用特定版本的Java来生成。

该Jenkins漏洞的利用方式如下：
1.  使用`CVE-2017-1000353-SNAPSHOT-all.jar`生成payload，指定要执行的命令。
2.  运行`exploit.py`脚本，将payload发送到Jenkins服务器。
3.  Jenkins服务器反序列化payload，执行指定的命令。

由于提供的代码是关于 Jenkins CVE-2017-1000353 漏洞的 PoC，因此与 Solaris CVE-2017-10003 无关。 并且该POC的代码没有检查出任何后门或恶意代码，因此投毒风险评估为0%。

**项目地址:** [vulhub/CVE-2017-1000353](https://github.com/vulhub/CVE-2017-1000353)

**漏洞详情:** [CVE-2017-10003](https://nvd.nist.gov/vuln/detail/CVE-2017-10003)

---

