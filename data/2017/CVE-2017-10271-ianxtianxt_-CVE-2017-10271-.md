# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md](../2017/CVE-2017-10271-ianxtianxt_-CVE-2017-10271-.md)

# CVE-2017-10271

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md](../2017/CVE-2017-10271-7kbstorm_WebLogic_CNVD_C2019_48814.md)

## CVE-2017-10271-WebLogic-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程代码执行漏洞，位于WLS Security组件中。未经身份验证的攻击者可以通过 T3 协议进行网络访问来利用此漏洞，从而完全控制 WebLogic 服务器。该漏洞影响的版本包括 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 和 12.2.1.2.0。 

根据提供的漏洞库信息，该漏洞容易被利用，并且攻击成功可能导致 WebLogic Server 被完全控制。利用CVSS 3.0评分，该漏洞被评为高危，可用性影响为高。该漏洞已经存在公开的exp，例如Exploit-DB上的43458和43924。

提供的漏洞利用代码 `7kbscan-WebLogic_CNVD_C_2019_48814` 看起来是一个扫描器，用于检测是否存在 CNVD-C-2019_48814 (实际上与CVE-2017-10271 相关)。由于代码本身是一个扫描器，投毒风险较低，主要风险在于扫描器是否会执行恶意命令或上传恶意文件。因此，投毒风险评估为10%。实际使用前，需要检查该扫描器是否包含除扫描外的其他恶意行为。

利用方式通常是构造恶意的 XML 格式的数据，通过 T3 协议发送到存在漏洞的 WebLogic 服务器，从而执行任意代码。攻击者可以利用该漏洞部署恶意软件、窃取敏感数据或破坏系统。

**项目地址:** [7kbstorm/WebLogic_CNVD_C2019_48814](https://github.com/7kbstorm/WebLogic_CNVD_C2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #2

**来源**: [CVE-2017-10271-Al1ex_CVE-2017-10271.md](../2017/CVE-2017-10271-Al1ex_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口 (默认7001) 或 HTTP 协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者通过T3协议或HTTP协议进行攻击，从而完全控制WebLogic Server。根据提供的漏洞库信息，该漏洞的CVSS 3.0评分为7.5，属于高危漏洞，主要影响服务器的可用性。攻击者利用该漏洞可以执行任意代码，从而获取服务器的控制权限。提供的漏洞利用代码包含一个Python脚本（weblogic_wls_wsat_exp.py），一个用于命令执行的JSP文件（exec.jsp）和一个用于检测WebLogic版本的Python脚本（weblogic_check_version.py）。

*   **有效性：** 根据提供的文件（README.md），给出的POC代码在Linux下的WebLogic 10.3.6.0测试OK，因此可以认为POC代码是有效的。
*   **投毒风险：** 提供的代码主要是漏洞利用代码和辅助脚本。`exec.jsp`允许执行命令，但属于漏洞利用的正常组成部分。`weblogic_check_version.py`用于检测WebLogic版本，`weblogic_wls_wsat_exp.py`脚本则是利用漏洞的核心。没有发现作者隐藏的恶意代码，因此投毒风险较低，为0%。
*   **利用方式：** 该漏洞的利用方式是攻击者通过构造特定的SOAP请求，利用WLS Security组件中的缺陷，绕过身份验证，最终执行任意代码。`weblogic_wls_wsat_exp.py`脚本通过发送精心构造的XML Payload到WebLogic Server的WLS Security组件，触发漏洞，然后上传`exec.jsp`或者直接执行命令。`exec.jsp`是一个简单的JSP Shell，允许攻击者通过`c`参数执行任意系统命令。

**项目地址:** [Al1ex/CVE-2017-10271](https://github.com/Al1ex/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #3

**来源**: [CVE-2017-10271-Cymmetria_weblogic_honeypot.md](../2017/CVE-2017-10271-Cymmetria_weblogic_honeypot.md)

## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #4

**来源**: [CVE-2017-10271-ETOCheney_JavaDeserialization.md](../2017/CVE-2017-10271-ETOCheney_JavaDeserialization.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标WebLogic服务器开放T3端口（默认7001），且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。该漏洞位于WLS Security组件中，攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在目标服务器上执行任意代码，从而完全控制WebLogic服务器。

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码（POC）已公开。提供的POC通过构造包含恶意XMLDecoder序列化数据的SOAP消息，发送到`wls-wsat/CoordinatorPortType`路径，触发远程代码执行。

**投毒风险：**
代码总体逻辑是扫描器，用于批量检测漏洞。主要风险点在于POC中执行的命令。
*   `java_scan.py`：主扫描脚本，负责调用nmap扫描、发送payload和监听ICMP响应。
*   `Threading.py`：线程池模块，用于多线程扫描，提高扫描效率。
*   `poc.json`和`poc_win.json`：包含payload，用于发送到目标服务器。payload中包含执行命令，如`ping`命令。如果`ping`命令被替换为恶意命令，则存在投毒风险。
POC本身包含执行系统命令的能力，攻击者可以将`ping`替换为任意恶意命令，例如下载并执行恶意程序，或者执行其他高危操作。尽管当前POC只是简单的`ping`，但存在被利用进行恶意活动的可能性。因此判断投毒风险为10%，主要集中在POC配置的恶意指令。

**利用方式：**
1.  **扫描目标：** 使用nmap或快速端口扫描功能，扫描目标IP和端口。
2.  **构造恶意请求：** 根据目标操作系统选择合适的POC（`poc.json`或`poc_win.json`）。修改POC中的`ping`命令，替换为要执行的恶意命令。
3.  **发送请求：** 将构造好的SOAP消息发送到目标WebLogic服务器的`wls-wsat/CoordinatorPortType`路径。
4.  **监听响应：** 通过监听ICMP包或者查看服务器日志，验证漏洞是否利用成功。

**注意事项：**
*   使用POC前务必修改POC中的命令，确保不会对目标系统造成不必要的损害。
*   在授权环境下进行漏洞测试。
*   及时更新WebLogic服务器补丁，修复漏洞。

**项目地址:** [ETOCheney/JavaDeserialization](https://github.com/ETOCheney/JavaDeserialization)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #5

**来源**: [CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md](../2017/CVE-2017-10271-JackyTsuuuy_weblogic_wls_rce_poc-exp.md)

## CVE-2017-10271-WebLogic-WLS-WSAT组件反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标服务器开启T3协议，或HTTP访问/wls-wsat/CoordinatorPortType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Oracle WebLogic Server的WLS Security组件中，允许未经身份验证的攻击者通过T3或HTTP协议，发送特制的SOAP请求，利用XMLDecoder反序列化漏洞执行任意代码，从而控制WebLogic Server。提供的漏洞利用代码包含两个脚本，`weblogic_getshell_exp_batch.py` 用于写入webshell并执行命令，`weblogic_wls_rce_poc_batch.py` 用于检测漏洞是否存在，通过尝试执行`touch /tmp/weblogic`命令判断。漏洞利用的有效性较高，因为漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是可利用的。从提供的代码本身来看，没有发现明显的投毒代码，`weblogic_getshell_exp_batch.py`中写入jsp木马的行为属于利用漏洞本身。利用方式是发送包含恶意序列化数据的SOAP请求到`/wls-wsat/CoordinatorPortType`接口，触发反序列化，从而执行任意代码。

**项目地址:** [JackyTsuuuy/weblogic_wls_rce_poc-exp](https://github.com/JackyTsuuuy/weblogic_wls_rce_poc-exp)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #6

**来源**: [CVE-2017-10271-Luffin_CVE-2017-10271.md](../2017/CVE-2017-10271-Luffin_CVE-2017-10271.md)

## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #7

**来源**: [CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md](../2017/CVE-2017-10271-SuperHacker-liuan_cve-2017-10271-poc.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** WebLogic Server反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未授权的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder执行任意代码，从而完全控制WebLogic Server。漏洞影响多个WebLogic Server版本，包括10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0和12.2.1.2.0。 

**有效性:** 漏洞库信息明确指出该漏洞容易被利用，且存在公开的PoC代码（Exploit-DB和GitHub链接），因此有效性较高。

**投毒风险:**  提供的代码片段是`Cargo.lock`文件，该文件用于Rust项目的依赖管理。虽然无法直接通过`Cargo.lock`文件判断是否存在投毒代码，但由于该PoC涉及到网络请求（reqwest库），理论上存在通过植入恶意依赖库或者篡改依赖库的行为实现投毒。但是从`Cargo.lock`文件中并没有发现明显的可疑库。因此，投毒的风险较低，预估为10%，主要体现在依赖库供应链投毒的可能性。

**利用方式:** 攻击者通过T3协议发送包含恶意XML数据的请求到WebLogic Server，其中XML数据利用`XMLDecoder`反序列化Java对象，并执行预先构造好的恶意命令。这些恶意命令通常用于执行任意代码，如部署webshell或执行系统命令等，最终达到控制服务器的目的。

**项目地址:** [SuperHacker-liuan/cve-2017-10271-poc](https://github.com/SuperHacker-liuan/cve-2017-10271-poc)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #8

**来源**: [CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-XHSecurity_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #9

**来源**: [CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md](../2017/CVE-2017-10271-Yuusuke4_WebLogic_CNVD_C_2019_48814.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器接管

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 存在于 Oracle WebLogic Server 的 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议利用此漏洞，从而完全控制 Oracle WebLogic Server。从漏洞库信息来看，该漏洞利用难度低，影响严重。从漏洞利用代码看，提供的 `README.md` 文件仅包含漏洞描述和扫描相关信息，并非完整的利用代码，**有效性待定**，需要进一步分析完整的POC代码。由于提供的代码不完整，判断是否存在投毒代码存在一定难度，但从提供的文件来看，风险较低，**约为10%**。利用方式为攻击者通过 T3 协议发送特制的 XML 数据，触发 WebLogic Server 的反序列化漏洞，从而执行任意代码。

**项目地址:** [Yuusuke4/WebLogic_CNVD_C_2019_48814](https://github.com/Yuusuke4/WebLogic_CNVD_C_2019_48814)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #10

**来源**: [CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md](../2017/CVE-2017-10271-ZH3FENG_PoCs-Weblogic_2017_10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #11

**来源**: [CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md](../2017/CVE-2017-10271-c0mmand3rOpSec_CVE-2017-10271.md)

## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #12

**来源**: [CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md](../2017/CVE-2017-10271-cjjduck_weblogic_wls_wsat_rce.md)

## CVE-2017-10271-WebLogic-WLS-WSAT远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要目标WebLogic服务器开放T3协议端口（通常为7001）且未打补丁。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-10271 是一个 Oracle WebLogic Server WLS Security 组件中的远程命令执行漏洞。攻击者可以利用此漏洞，通过发送恶意的 SOAP 请求到未打补丁的 WebLogic 服务器，在服务器上执行任意命令，从而完全控制服务器。

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码（`weblogic_wls_wsat_exp.py`），此漏洞的PoC代码是可用的，并且漏洞利用的有效性较高。漏洞库信息显示，该漏洞容易被利用，且成功利用可能导致服务器被接管。PoC代码中明确说明了支持的受影响版本，并提供了命令执行和上传shell的功能。

**投毒风险评估：**

提供的PoC代码中包含一个`exec.jsp`文件，用于执行任意命令。`weblogic_wls_wsat_exp.py`脚本允许上传此JSP文件或执行命令。主要风险点在于：

1.  **恶意JSP后门：**`exec.jsp`本身就是一个后门，允许攻击者在成功利用漏洞后，通过发送HTTP请求执行任意命令。虽然这个JSP是为了验证漏洞而存在，但它本身具有恶意性，需要用户自行评估并承担风险。
2.  **命令执行的风险：** 使用该脚本执行命令可能导致系统被进一步入侵。例如，攻击者可能使用该脚本下载和执行恶意软件。

因此，认为该仓库存在一定的投毒风险，风险评估为20%。

**利用方式：**

1.  **T3协议利用:** 漏洞利用通过构造特制的 SOAP 请求，利用WebLogic的WLS Security组件中的XML反序列化漏洞。攻击者通过T3协议将恶意XML数据发送到存在漏洞的WebLogic服务器。
2.  **JNDI注入:** 恶意XML数据中包含JNDI注入payload，该payload会尝试从攻击者控制的远程服务器加载并执行恶意类，从而在WebLogic服务器上执行任意命令。
3.  **命令执行/Shell上传:** PoC代码提供了两种利用方式：
    *   **命令执行:** 攻击者可以使用 `-c` 参数指定要执行的命令，并在 `-o` 参数指定的文件中接收命令执行的结果。
    *   **Shell上传:** 攻击者可以使用 `-s` 参数指定要上传的JSP文件（例如`exec.jsp`），并使用 `-o` 参数指定JSP文件的上传路径。上传成功后，攻击者可以通过访问该JSP文件来执行任意命令。

**漏洞利用步骤：**

1.  使用 `weblogic_wls_wsat_exp.py` 脚本，指定目标WebLogic服务器的IP地址和端口。
2.  选择执行命令或上传shell的方式。
3.  如果选择执行命令，则指定要执行的命令，并指定输出文件名。
4.  如果选择上传shell，则指定要上传的JSP文件，并指定上传路径。
5.  运行脚本，等待利用完成。
6.  如果上传了shell，则通过浏览器访问上传的JSP文件，并传递 `c` 参数来执行命令。

**示例：**

*   执行 `id` 命令并将结果保存到 `output.txt` 文件：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -c id -o output.txt
    ```
*   上传 `exec.jsp` 文件到 `/bea/user_projects/domains/mydomain/servers/AdminServer/tmp/_WL_Static/consoleapp/xxxxx/shell.jsp`：
    ```bash
    python weblogic_wls_wsat_exp.py -t 172.16.80.131:7001 -s exec.jsp -o shell.jsp
    ```
    然后，通过访问 `http://172.16.80.131:7001/console/shell.jsp?c=id` 来执行 `id` 命令。

**项目地址:** [cjjduck/weblogic_wls_wsat_rce](https://github.com/cjjduck/weblogic_wls_wsat_rce)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #13

**来源**: [CVE-2017-10271-cved-sources_cve-2017-10271.md](../2017/CVE-2017-10271-cved-sources_cve-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口，目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中WLS Security组件的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送恶意构造的XML消息，利用该漏洞在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和Exploit-DB中的EXP可知，此漏洞利用代码有效。

**投毒风险：**
提供的Dockerfile和README.md文件非常简单，主要用于构建包含漏洞环境的Docker镜像。Dockerfile下载并安装了python，但并未发现任何恶意代码或后门。但是考虑到镜像来自第三方，以及软件供应链的安全问题，仍然存在一定的投毒风险，例如，第三方镜像可能包含其他未知的恶意软件或配置。因此，**投毒风险评估为10%**。

**利用方式：**
1.  **利用协议：** 该漏洞通过T3协议进行利用。
2.  **漏洞原理：** 利用WebLogic Server WLS Security组件中存在的XML反序列化漏洞。
3.  **攻击步骤：** 攻击者构造包含恶意代码的XML数据，通过T3协议发送给WebLogic服务器。服务器在处理该XML数据时，会进行反序列化操作，从而执行攻击者注入的恶意代码。
4.  **利用结果：** 成功利用该漏洞可以使攻击者获得服务器的控制权，包括执行任意命令、安装后门、窃取敏感数据等。

**项目地址:** [cved-sources/cve-2017-10271](https://github.com/cved-sources/cve-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #14

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #15

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---



---

## POC #15

**来源**: [CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md](../2017/CVE-2017-10271-kbsec_Weblogic_Wsat_RCE.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制受影响的WebLogic服务器

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic服务器，通常通过T3协议 (根据漏洞库信息)，实际利用代码显示是通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向受影响的 WebLogic Server 发送特制的 XML 消息，利用此漏洞在服务器上执行任意代码。

**有效性评估：**

根据提供的漏洞库信息和漏洞利用代码，此漏洞是高危且易于利用的。漏洞库中明确指出该漏洞无需身份验证即可通过网络访问利用，成功利用可能导致服务器被完全控制。提供的POC代码，`weblogic_wsat.py`， 旨在利用此漏洞。该POC尝试了多种可能的端点，并使用XMLDecoder反序列化执行任意代码。POC代码使用 `java.lang.Runtime` 来执行命令，绕过了之前基于 `java.lang.ProcessBuilder` 的检测规则，因此具备较高的有效性。

**投毒风险评估：**

分析POC代码，投毒风险较低，估计在10%左右。 虽然该代码旨在进行远程代码执行，但没有明显的迹象表明作者有意添加恶意代码以损害攻击者的系统。潜在的风险可能在于，如果攻击者在不了解代码的情况下直接执行此脚本，他们可能会无意中执行一些未知的操作，但这种情况发生的概率相对较低。

以下是支持低投毒风险评估的理由：
*   **代码可读性：** Python 代码相对简单易懂，便于检查和审计。
*   **明确的目的：** 代码的目标是利用已知的 WebLogic 漏洞，而不是进行恶意活动。
*   **免责声明：** 代码包含了作者免责声明，表明作者不对代码的使用负责，但也暗示了代码可能存在风险。

尽管风险较低，但强烈建议在使用任何公开可用的漏洞利用代码之前，仔细审查代码，确保其安全性和完整性。

**利用方式分析：**

1.  **漏洞触发：**  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 `/wls-wsat/*` 端点。
2.  **反序列化：**  WebLogic Server 的 WLS Security 组件在处理 SOAP 请求时，会使用 XMLDecoder 反序列化 XML 数据中的 Java 对象。
3.  **代码执行：**  恶意 XML 数据构造特定的 Java 对象，例如 `java.lang.Runtime`，并利用该对象在服务器上执行任意命令。
4.  **RCE实现：**  通过 `Runtime.getRuntime().exec()` 执行操作系统命令，实现远程代码执行。

该漏洞的利用依赖于 WebLogic Server 对不安全的反序列化数据的处理，以及对 `java.lang.Runtime` 等危险类的访问。

总结：POC代码有效，投毒风险较低，利用方式清晰，可实现远程代码执行。

**项目地址:** [kbsec/Weblogic_Wsat_RCE](https://github.com/kbsec/Weblogic_Wsat_RCE)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #16

**来源**: [CVE-2017-10271-kkirsche_CVE-2017-10271.md](../2017/CVE-2017-10271-kkirsche_CVE-2017-10271.md)

## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #17

**来源**: [CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md](../2017/CVE-2017-10271-lonehand_Oracle-WebLogic-CVE-2017-10271-master.md)

## CVE-2017-10271 WebLogic WLS-WSAT 远程命令执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且存在/wls-wsat/路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个WLS-WSAT组件的远程命令执行漏洞。攻击者可以通过发送特制的SOAP消息到/wls-wsat/CoordinatorPortType等端点，利用XMLDecoder反序列化漏洞执行任意代码。漏洞利用代码中给出了构造payload的方法，以及通过上传jsp webshell 的方式获取命令执行的方式.

**有效性评估：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息表明这是一个容易利用的漏洞，可以通过网络访问T3协议进行攻击，并能导致WebLogic Server被完全控制。提供的漏洞利用代码（POC）给出了构造SOAP消息的具体方法，通过XMLDecoder反序列化漏洞执行任意代码。因此，可以判断提供的POC代码是有效的。

**投毒风险评估：**

*   **分析：**  提供的代码仓库主要包含漏洞描述、POC利用代码和一些利用截图。虽然直接执行`.jar`文件存在一定风险，但目前分析的代码内容主要集中在利用漏洞本身，没有发现明显的、与漏洞利用无关的恶意代码。
*   **风险百分比：**  10%。 主要风险在于提供的`.jar`EXP工具，可能存在未知的恶意行为，但概率较低。 另外webshell的密码可以自定义，如果自定义密码过于简单也存在安全风险。

**利用方式：**

1.  **确定目标：**  确定目标WebLogic Server的版本在受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2）。
2.  **构造Payload：**  根据提供的POC代码，构造包含恶意代码的SOAP消息。Payload利用XMLDecoder反序列化漏洞，可以执行任意Java代码。常见的利用方式包括：
    *   **写入WebShell：**  通过`java.io.PrintWriter`将包含命令执行代码的JSP文件写入到服务器的Web目录，然后通过访问该JSP文件执行系统命令。
    *   **直接执行命令：**  使用`java.lang.ProcessBuilder`直接执行系统命令。
3.  **发送Payload：**  将构造好的SOAP消息通过HTTP POST请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType、/wls-wsat/CoordinatorPortType11等端点。
4.  **执行命令/控制服务器：**  如果利用成功，可以通过访问写入的WebShell或直接执行命令来控制服务器。

**项目地址:** [lonehand/Oracle-WebLogic-CVE-2017-10271-master](https://github.com/lonehand/Oracle-WebLogic-CVE-2017-10271-master)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #18

**来源**: [CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md](../2017/CVE-2017-10271-peterpeter228_Oracle-WebLogic-CVE-2017-10271.md)

## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #19

**来源**: [CVE-2017-10271-pssss_CVE-2017-10271.md](../2017/CVE-2017-10271-pssss_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）和wls-wsat/CoordinatorPortType路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的SOAP请求，利用XMLDecoder反序列化漏洞，从而执行任意命令。该POC利用java.beans.XMLDecoder来执行命令。 

**有效性：** 提供的POC代码是有效的。它构造了一个包含恶意XML的SOAP请求，利用WebLogic Server中的XMLDecoder反序列化漏洞，执行指定的命令。  

**投毒风险：**  该仓库中的投毒风险较低。POC代码的主要功能是利用已知的WebLogic反序列化漏洞执行命令。代码中存在投毒的可能性较低，风险占比约为10%。`README.md`文件提供了一个下载补丁的链接，该链接需要人工审核安全性，如果该链接指向恶意文件，存在风险。 

**利用方式：** 
1.  攻击者需要能够访问目标WebLogic Server的T3协议端口（默认为7001）。
2.  攻击者构造一个包含恶意XML的SOAP请求，该XML利用java.beans.XMLDecoder来执行命令。
3.  攻击者将构造好的SOAP请求发送到WebLogic Server的/wls-wsat/CoordinatorPortType路径。
4.  WebLogic Server解析SOAP请求，XMLDecoder执行其中的恶意XML，从而在服务器上执行任意命令。

**项目地址:** [pssss/CVE-2017-10271](https://github.com/pssss/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #20

**来源**: [CVE-2017-10271-r4b3rt_CVE-2017-10271.md](../2017/CVE-2017-10271-r4b3rt_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic-WLS-WSAT反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议，且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，从而在受影响的WebLogic Server上执行任意代码，实现完全控制。提供的POC代码 `weblogic_wls_wsat_exp.py` 可以利用此漏洞执行命令或上传webshell。脚本`exec.jsp` 用于执行上传的webshell。`weblogic_check_version.py` 脚本用于检测目标Weblogic的版本。投毒风险较低，主要集中在webshell `exec.jsp` 的内容可能被替换为恶意代码，或者在主EXP脚本中添加连接外部恶意服务器的逻辑，但这需要仔细审查才能发现。上传的JSP Webshell是高危部分，如果被篡改则可能存在后门。

**项目地址:** [r4b3rt/CVE-2017-10271](https://github.com/r4b3rt/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #21

**来源**: [CVE-2017-10271-s3xy_CVE-2017-10271.md](../2017/CVE-2017-10271-s3xy_CVE-2017-10271.md)

## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #22

**来源**: [CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md](../2017/CVE-2017-10271-seoyoung-kang_CVE-2017-10271.md)

## CVE-2017-10271

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-10271是Oracle WebLogic Server WLS Security组件中的一个反序列化漏洞。未经身份验证的攻击者可以通过T3协议发送特制的恶意请求，利用XMLDecoder反序列化漏洞在受影响的WebLogic Server上执行任意代码，从而完全控制服务器。

**有效性分析：**
提供的POC代码（`CVE-2017-10271_Tool.py`）是一个Python脚本，它包含以下功能：
*   WebLogic服务器检测：通过探测一些WebLogic的常见路径来判断目标是否为WebLogic服务器。
*   漏洞扫描：使用特定payload进行漏洞验证。
*   文件上传测试：测试是否可以上传文件。
*   命令执行：支持反向shell和webshell上传等命令执行方式。
*   Selenium Webshell：使用Selenium在浏览器中显示webshell界面。

根据漏洞库信息和互联网上大量的相关资料，此漏洞利用代码是有效的。该漏洞已经被广泛研究和利用。

**投毒风险分析：**
审阅`CVE-2017-10271_Tool.py`代码后，发现以下潜在风险：
*   **日志记录：** 脚本会生成日志文件，记录目标URL，请求头，payload和响应内容，这本身不是恶意行为，但在渗透测试中是常规做法。
*   **Selenium Webshell：** 使用Selenium打开浏览器窗口显示webshell界面，可能存在安全风险，取决于webshell的功能和代码实现。

总的来说，该工具的主要功能是为了利用漏洞，而非进行大规模的恶意传播或破坏。作者加入恶意投毒代码的可能性较低，风险评估如下：
*   **投毒风险评估：** 2%
*   **原因：** 该工具旨在利用已知漏洞，实现远程代码执行，它的功能和实现方式都与常规渗透测试工具相符。尽管存在webshell的安全风险，但这属于利用漏洞的正常范畴。

**利用方式分析：**
该漏洞的利用方式大致如下：
1.  **目标检测：** 通过访问特定URL判断目标是否为WebLogic服务器。
2.  **构造恶意XML：** 构造包含恶意代码的XML数据，利用WebLogic Server的XMLDecoder反序列化漏洞。
3.  **发送恶意请求：** 通过T3协议将构造的恶意XML数据发送到WebLogic Server的/wls-wsat/CoordinatorPortType端点。
4.  **执行任意代码：** WebLogic Server解析恶意XML数据，执行其中的恶意代码，从而实现远程命令执行。

提供的Python脚本简化了整个过程，包括自动化的服务器检测、Payload生成、漏洞验证和命令执行等步骤。攻击者可以使用此脚本快速验证漏洞并执行攻击。

**项目地址:** [seoyoung-kang/CVE-2017-10271](https://github.com/seoyoung-kang/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #23

**来源**: [CVE-2017-10271-shack2_javaserializetools.md](../2017/CVE-2017-10271-shack2_javaserializetools.md)

## CVE-2017-10271-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问WebLogic Server的T3协议端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于WLS Security组件中。攻击者可以通过T3协议发送特制的恶意请求，未经授权即可在受影响的WebLogic服务器上执行任意代码，从而完全控制服务器。由于漏洞利用的简易性和潜在的严重影响，该漏洞被广泛利用。

提供的代码片段是Ant构建文件（build.xml）和一个manifest文件，以及一个README文件。这些文件本身不是漏洞利用代码，而是Java项目的构建配置。实际的漏洞利用代码会是一个精心构造的序列化对象，通过T3协议发送给WebLogic服务器。这些文件在漏洞利用中用于构建攻击所需的java文件。

根据漏洞库信息，此漏洞利用的有效性很高，因为CVSS评分较高，并且存在公开可用的漏洞利用代码。利用方式是构造恶意的XML数据，并将其作为序列化对象通过T3协议发送到存在漏洞的WebLogic服务器上。

提供的代码片段中，未发现明显的投毒代码。这些文件仅用于Java项目的构建。攻击者可能会将恶意代码嵌入到实际的序列化Payload中，但这取决于Payload的构造方式，与提供的文件无关。该仓库中作者隐藏投毒代码的概率为0%。

**项目地址:** [shack2/javaserializetools](https://github.com/shack2/javaserializetools)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

## POC #24

**来源**: [CVE-2017-10271-testwc_CVE-2017-10271.md](../2017/CVE-2017-10271-testwc_CVE-2017-10271.md)

## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)

---

