# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md](../2017/CVE-2017-8917-AkuCyberSec_CVE-2017-8917-Joomla-370-SQL-Injection.md)

# CVE-2017-8917

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #2

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---



---

## POC #2

**来源**: [CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md](../2017/CVE-2017-8917-BaptisteContreras_CVE-2017-8917-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要Joomla! 3.7.0版本，目标开启web服务并且可以访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本在3.7.1之前存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。提供的漏洞利用代码是一个Python脚本，针对TryHackMe Dailybugle CTF设计，但可以用于通用漏洞利用。脚本通过`com_fields`组件中的一个参数`list[fullordering]`注入SQL代码。利用方式是修改HTTP请求的参数，构造恶意的SQL查询，从而获取数据库中的敏感信息。风险包括未经授权的访问、数据窃取和潜在的Joomla!服务器完全控制。

**有效性评估：**
根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞利用代码中包含`main.py`，实现了SQL注入，并且提供了针对性的利用方式。搜索结果也表明了该漏洞的存在和危害。

**投毒风险评估：**
审查了提供的Python脚本 `main.py`，没有发现明显的恶意代码或后门。脚本主要功能是构造SQL注入payload并发送HTTP请求，目的是从目标Joomla!服务器提取数据。`docker-compose.yaml`文件用于快速部署一个存在漏洞的Joomla!环境进行测试，没有发现可疑配置。`README.md` 也声明了仅用于教育目的。

**漏洞利用方式：**
1.  确定目标Joomla!版本为3.7.0（或3.7.x且低于3.7.1）。
2.  获取CSRF Token，访问`index.php/component/users/?view=login` 获取token.
3.  使用Python脚本 `main.py`，指定目标Joomla!服务器的host、port和URI。通过`--host`参数指定目标服务器， 例如 `python3 main.py --host x.x.x.x`
4.  脚本会利用`com_fields`组件的`list[fullordering]`参数进行SQL注入。
5.  成功利用后，攻击者可以执行任意SQL查询，例如获取用户名、密码哈希等敏感信息。

**项目地址:** [BaptisteContreras/CVE-2017-8917-Joomla](https://github.com/BaptisteContreras/CVE-2017-8917-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #3

**来源**: [CVE-2017-8917-Siopy_CVE-2017-8917.md](../2017/CVE-2017-8917-Siopy_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla 3.7.0 'com_fields' SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.0 (受影响范围：3.7.x before 3.7.1)

**利用条件:** 目标服务器运行Joomla 3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-8917 是 Joomla 3.7.0 版本中 com_fields 组件的一个 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者执行任意 SQL 命令。提供的漏洞利用代码 (CVE-2017-8917.py)  利用了`com_fields` 组件中的 `list[fullordering]` 参数，通过构造恶意的 SQL 语句来提取数据库信息，包括数据库前缀、用户名、邮箱、密码哈希、数据库用户、数据库名和数据库版本。 

**有效性：**
该POC代码针对Joomla 3.7.0版本，利用了`com_fields`组件的SQL注入漏洞，通过构造特定的payload获取数据库信息，有效性较高。

**投毒风险：**
该POC代码主要用于信息提取，存在一定的风险，例如：
1.  **数据窃取风险：** 如果成功利用该漏洞，攻击者可以获取敏感的数据库信息，如用户名、密码哈希等，存在数据泄露风险。
2.  **二次利用风险：** 攻击者可能会利用获取到的信息进行二次攻击，例如破解密码、篡改数据等。

该仓库中是否存在作者隐藏的投毒代码可能性较低。该脚本的主要功能是利用已知的 SQL 注入漏洞提取数据库信息，并没有发现明显的后门或恶意代码。但仍需谨慎，可能存在编码陷阱或未知的潜在风险，例如对提取信息的处理不当，泄露攻击者的IP地址等。可能性评估：5%。

**利用方式：**
1.  确定目标Joomla网站的版本是否为3.7.0（或者3.7.x且小于3.7.1）。
2.  使用提供的Python脚本 (CVE-2017-8917.py)。
3.  运行脚本，输入目标Joomla网站的URL。
4.  脚本会利用 `com_fields` 组件的 SQL 注入漏洞，通过构造恶意的 `list[fullordering]` 参数，执行 SQL 查询并提取信息，包括数据库前缀、用户名、邮箱、密码哈希等。
5.  攻击者可以利用提取到的密码哈希进行破解，从而获得管理员权限。

**项目地址:** [Siopy/CVE-2017-8917](https://github.com/Siopy/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #4

**来源**: [CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md](../2017/CVE-2017-8917-brianwrf_Joomla3.7-SQLi-CVE-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla站点版本为3.7.0（根据POC代码推断）且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞信息和搜索结果，攻击者可以通过未明确的向量执行任意SQL命令。漏洞利用代码（CVE-2017-8917.py）利用了`com_fields`组件中的`list[fullordering]`参数，通过注入`updatexml`函数来尝试提取数据库用户信息。该脚本首先使用ZoomEye API搜索Joomla 3.7.0版本的网站，然后对搜索结果中的URL发起攻击请求。如果HTTP状态码为500，则进一步判断返回内容中是否包含XPATH错误信息，从而确定目标是否存在漏洞。如果存在漏洞，则将结果保存到`vulnerable.txt`文件中。

**有效性：** 提供的POC代码是有效的，它基于ZoomEye API搜索目标，并利用特定的URL参数进行SQL注入检测。

**投毒风险：** 仓库中存在投毒代码的风险较低，大约10%。主要风险来自ZoomEye API的使用，因为需要提供ZoomEye的用户名和密码。如果ZoomEye API本身存在安全问题，或者API密钥被泄露，可能会导致信息泄露。此外，该脚本会尝试连接到ZoomEye的服务器，可能会留下IP记录。脚本本身的代码相对简单，没有明显的恶意行为，主要风险在于依赖的服务。

**利用方式：**
1.  **信息收集：** 使用ZoomEye API搜索存在漏洞的Joomla 3.7.0网站。
2.  **漏洞触发：**  向目标URL发送包含恶意SQL注入payload的HTTP GET请求，例如：`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(1,concat(1,user()),1)`。
3.  **漏洞验证：**  通过检查HTTP响应状态码（500）和响应内容中是否包含特定的XPATH错误信息来判断漏洞是否存在。
4.  **数据提取：** 如果漏洞存在，`updatexml`函数可以被用来提取数据库中的敏感信息，例如用户名。

总体来说，利用方式比较直接，依赖于特定的URL参数和SQL注入payload。

**项目地址:** [brianwrf/Joomla3.7-SQLi-CVE-2017-8917](https://github.com/brianwrf/Joomla3.7-SQLi-CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #5

**来源**: [CVE-2017-8917-cved-sources_cve-2017-8917.md](../2017/CVE-2017-8917-cved-sources_cve-2017-8917.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要网络访问，目标Joomla!实例版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过未指定的向量执行任意SQL命令。漏洞利用代码提供了一个Dockerfile，用于构建一个存在漏洞的Joomla! 3.7.0环境，方便漏洞测试和验证。Exploit-DB上提供了利用此漏洞的PoC代码，表明该漏洞是可利用的。漏洞利用方式是通过向存在漏洞的Joomla!实例发送包含恶意SQL代码的请求，从而实现对数据库的非法操作。由于提供的Dockerfile和README.md主要用于搭建漏洞环境和提供漏洞信息，投毒风险较低，初步估计为10%，这部分风险主要来自于Dockerfile中可能存在的、用于测试或演示目的后门代码，但未明确声明为恶意投毒。

**项目地址:** [cved-sources/cve-2017-8917](https://github.com/cved-sources/cve-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #6

**来源**: [CVE-2017-8917-gloliveira1701_Joomblah.md](../2017/CVE-2017-8917-gloliveira1701_Joomblah.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的Joomla网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以通过构造恶意的SQL语句，利用`com_fields`组件的`list[fullordering]`参数，执行任意SQL命令。提供的POC代码 `joomblah.py` 旨在利用此漏洞，通过`UpdateXML`函数和注入的SQL查询，提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。该脚本首先尝试获取CSRF token，然后利用SQL注入提取数据库表名，并从中提取用户和会话信息。漏洞利用有效性较高，因为多个来源都确认了该漏洞的存在和利用方法。

关于投毒风险，快速浏览了POC代码后发现，虽然代码主要功能是利用SQL注入漏洞，但仍存在一定的风险。具体分析：
*   **依赖风险** 该脚本依赖于Python的`requests`、`re`、`argparse`、`os`、`random`、`time`和`binascii`模块。虽然这些模块通常是安全的，但如果攻击者控制了用户的环境，可能会通过修改这些模块来执行恶意代码。
*   **字符编码问题** 代码中包含字符编码转换，`value.decode('utf-8')`，这在处理特定字符集时可能引入漏洞，虽然原作者修复了此问题。
*   **不明确的异常处理** 代码中缺少适当的异常处理，可能导致脚本在遇到意外情况时崩溃或执行错误的操作。例如，如果无法连接到目标网站，脚本可能会引发未处理的异常。
*   **潜在的后门风险**  攻击者可能修改脚本，使其在成功利用漏洞后执行额外的恶意操作，例如上传后门文件或修改服务器配置，在第82行中，如果攻击者修改了返回的内容进行恶意代码的植入。

因此，虽然主要功能是漏洞利用，但仍然存在一定的投毒风险，尤其是考虑到攻击者可能修改脚本以执行其他恶意活动。总体评估投毒概率在10%左右。

利用方式总结：
1.  目标：Joomla 3.7.0网站。
2.  入口点：`com_fields`组件的`list[fullordering]`参数。
3.  攻击方式：构造恶意的SQL语句，利用`UpdateXML`函数执行SQL注入。
4.  目的：提取数据库中的敏感信息，例如用户名、密码哈希和会话信息。

**项目地址:** [gloliveira1701/Joomblah](https://github.com/gloliveira1701/Joomblah)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #7

**来源**: [CVE-2017-8917-gmohlamo_CVE-2017-8917.md](../2017/CVE-2017-8917-gmohlamo_CVE-2017-8917.md)

## CVE-2017-8917-Joomla!-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本为3.7.0，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.0版本中存在的一个SQL注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者通过未经授权的SQL命令执行来读取、修改或删除数据库中的数据。漏洞出现在`com_fields`组件中，攻击者可以利用`list[fullordering]`参数进行SQL注入攻击。

**漏洞利用方式:**

1.  攻击者构造包含恶意SQL代码的URL，利用`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`作为注入点。
2.  攻击者利用`extractvalue()`函数和`concat()`函数，将SQL查询结果注入到XML数据中，然后从响应中提取数据。POC代码使用`information_schema.tables`来获取表名，并从`{prefix}_users`表中提取用户名、邮箱和密码hash。
3.  POC代码通过循环爆破的方式，每次获取密码hash的一部分，最终获取完整的密码hash。

**有效性：**

提供的POC代码针对Joomla! 3.7.0，利用`com_fields`组件中的SQL注入漏洞。该代码能够提取数据库前缀、用户名、邮箱和密码hash，表明该POC代码是有效的。

**投毒风险：**

该漏洞利用代码本身相对简单，主要是利用SQL注入读取数据。检查了`cve20178917.py`脚本，没有发现明显的恶意代码或者后门。脚本中的依赖`art`可能存在字体方面的潜在风险，但是该风险较低。`beautifulsoup4`被广泛使用，风险更低。综合评估，投毒的风险较低，大约为10%。虽然没发现恶意代码，但由于代码来自互联网，仍需谨慎使用。


**项目地址:** [gmohlamo/CVE-2017-8917](https://github.com/gmohlamo/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #8

**来源**: [CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md](../2017/CVE-2017-8917-ionutbaltariu_joomla_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL 注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL 注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改、权限提升甚至远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要能够访问存在漏洞的 Joomla! 站点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2017-8917是Joomla! 3.7.x版本（低于3.7.1）中的一个SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未经过滤的用户输入，执行任意SQL命令。 

**有效性:** 根据搜索结果和漏洞库信息，该漏洞确实存在，并且有公开的PoC(Exploit-DB上的44358和42033)。因此，可以认为该漏洞是有效的。提供的漏洞利用代码只包含GNU GENERAL PUBLIC LICENSE，只包含软件许可协议，因此**不能直接**判断POC代码是否有效，但是可以确认POC是存在的。

**投毒风险:** 提供的代码段仅为GNU GPL许可协议，不包含任何可执行代码，因此**不存在投毒风险**。

**利用方式:** 
1.  攻击者需要找到Joomla! 3.7.x (before 3.7.1)版本的网站。
2.  确定存在漏洞的注入点，漏洞描述中未明确指出，但是搜索结果提到的是用户输入未经过滤。
3.  构造恶意的SQL语句，可能通过GET或POST参数进行传递。
4.  利用SQL注入漏洞执行任意SQL命令，例如，获取数据库中的敏感信息、修改数据或执行存储过程。
5.  如果数据库权限足够，攻击者甚至可能通过SQL注入执行操作系统命令，从而完全控制服务器。

**总结:** CVE-2017-8917是一个高危漏洞，需要尽快升级到Joomla! 3.7.1或更高版本。

**项目地址:** [ionutbaltariu/joomla_CVE-2017-8917](https://github.com/ionutbaltariu/joomla_CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #9

**来源**: [CVE-2017-8917-stefanlucas_Exploit-Joomla.md](../2017/CVE-2017-8917-stefanlucas_Exploit-Joomla.md)

## CVE-2017-8917-Joomla-SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla!站点未升级至3.7.1或更高版本，且攻击者可访问该站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（3.7.1之前）中存在的一个SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式如下：

1.  **漏洞触发点：** 漏洞存在于`com_fields`组件的`fields`视图中，通过`list[fullordering]`参数传递SQL注入payload。
2.  **利用方式：** 攻击者构造恶意的SQL查询语句，并通过`list[fullordering]`参数发送到`/index.php?option=com_fields&view=fields&layout=modal`。由于Joomla!对用户输入过滤不严格，导致SQL注入。
3.  **POC代码分析：**
    *   `joomblah.py`是一个Python脚本，用于利用CVE-2017-8917漏洞。
    *   该脚本首先获取CSRF token，然后利用`UpdateXML`函数执行SQL注入。
    *   脚本可以提取数据库表名、用户名、用户密码哈希以及session信息。
    *   `extract_token(resp)`函数用于从登录页面提取CSRF token。
    *   `joomla_370_sqli(options, sess, token, sqli)`函数负责构建和发送SQL注入payload，并解析响应以提取结果。
    *   `extract_joomla_tables`、`extract_joomla_users`和`extract_joomla_sessions`函数分别用于提取表名、用户名和session信息。
4.  **投毒风险：**
    *   虽然POC代码看起来是用于漏洞利用，但仍存在轻微的投毒风险，例如：
        *   代码中可能存在后门，允许攻击者在目标系统上执行任意代码。
        *   该代码可能被修改为删除或破坏目标系统上的数据。
        *   该代码依赖于外部库，这些库可能包含恶意代码。
    *   风险评估：虽然存在风险，但是相对较低，因为代码的主要功能是SQL注入利用，并且代码结构清晰，逻辑较为简单。需要人工审计所有依赖库，确认没有恶意行为。
5.  **有效性：** POC代码可以有效利用该漏洞，提取数据库信息。

**综上所述：**  该漏洞利用代码的有效性较高。投毒风险较低，但是代码审计人员必须审计依赖库，检查恶意行为。利用方式主要是通过构造特殊的URL参数，绕过Joomla!的输入验证机制，从而执行任意SQL命令。

**项目地址:** [stefanlucas/Exploit-Joomla](https://github.com/stefanlucas/Exploit-Joomla)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

## POC #10

**来源**: [CVE-2017-8917-xcalts_CVE-2017-8917.md](../2017/CVE-2017-8917-xcalts_CVE-2017-8917.md)

## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)

---

