## CVE-2017-12149 - JBoss Application Server Java反序列化/RCE

**漏洞编号:** CVE-2017-12149

**漏洞类型:** Java反序列化/RCE

**影响应用:** JBoss Application Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 5.x, 6.x

**利用条件:** 网络可达，目标开启了HTTPServerILServlet服务（常见于/invoker/readonly）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC提供了完整的漏洞复现环境和利用指南。通过Dockerfile构建了一个真实的JBoss AS 6.1.0环境，并手动配置了认证凭据以供研究。核心利用脚本指向了JBoss的HTTPServerILServlet接口（/invoker/readonly），该接口已知存在严重的Java反序列化漏洞。POC中使用的验证方法是典型的ysoserial payload生成方式，结合CommonsCollections6链条，通过POST二进制流触发RCE。经过审计，该POC的逻辑非常清晰：首先通过Dockerfile确保环境一致性，然后通过简单的curl命令配合生成的.ser文件执行系统命令。此利用路径在JBoss 5.x和6.x版本中极为经典且极其稳定，因为该路径默认不需要身份验证即可访问。利用步骤：1. 使用提供的Dockerfile构建并运行容器，确保JBoss服务在8080端口监听。2. 准备ysoserial工具，使用命令`java -jar ysoserial-all.jar CommonsCollections6 "touch /tmp/pwned" > poc.ser`生成用于在/tmp目录下创建文件的恶意序列化对象。3. 使用curl向目标URL `http://localhost:8080/invoker/readonly` 发送POST请求，并附带生成的二进制payload。4. 进入容器内部检查/tmp/pwned文件是否存在，以确认代码执行成功。投毒风险分析：该POC项目主要由Dockerfile、README说明文档以及基础的验证命令组成，其投毒风险极低。首先，Dockerfile直接基于官方或知名的vulhub镜像进行构建，除了修改了默认的admin密码和权限设置外，没有引入任何外部的可疑脚本或二进制文件。其次，README中推荐的验证步骤使用的是社区公认的开源安全工具ysoserial，用户需要自行下载该工具，POC并未内嵌任何编译后的Java类或混淆代码。在投毒风险评估中，重点关注的是是否存在隐蔽的网络回连、Base64加密的Shell脚本以及自动化的恶意下载行为，而本POC的所有操作均为手动执行的单行命令，透明度极高。唯一需要注意的是，用户在自行寻找ysoserial-all.jar下载源时应确保来源可靠，POC本身并不包含任何恶意投毒逻辑。作为一个专业的安全研究实验室项目，其目的是为了合法的漏洞复现和安全防御研究。

**项目地址:** [https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149](https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
