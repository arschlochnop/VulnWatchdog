## CVE-2017-12149 - JBoss Application Server (WildFly) RCE (远程代码执行)

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE (远程代码执行)

**影响应用:** JBoss Application Server (WildFly)

**危害等级:** CRITICAL

**CVSS评分:** 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P)

**影响版本:** JBoss AS 5.x, 6.x

**利用条件:** 目标服务器开启了 HttpInvoker 组件（通常在 /invoker/readonly 或 /invoker/JMXInvokerServlet 路径下），且未对反序列化输入进行过滤。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对JBoss Application Server中的CVE-2017-12149漏洞，该漏洞源于JBoss在处理HTTPSmartMethodInvocation等对象时未对外部输入进行有效的反序列化校验。提供的脚本使用了Python的httpx库进行网络通信，其核心Payload是一段经过Hex编码的Java序列化字节流。分析Payload特征码（aced0005...）可知，该POC利用了经典的Apache Commons Collections（CC链）构造攻击向量。代码中包含了‘org.apache.commons.collections.keyvalue.TiedMapEntry’、‘LazyMap’以及‘ChainedTransformer’等类名，这证实了该POC试图通过Java反序列化链触发命令执行。脚本通过向特定的URL发送POST请求并携带该恶意序列化对象，从而在目标服务器上执行代码。此POC结构清晰，采用了直接的二进制Payload注入方式，具有极高的实战化水平。利用步骤如下：1. 确认目标是否存在/invoker/readonly路径；2. 准备Python环境并安装httpx库；3. 构造特定的系统命令并将其封装进Java序列化Payload（POC中已预置部分Payload）；4. 运行脚本，通过POST方法提交Payload；5. 观察目标服务器响应或监听反弹Shell。该POC不需要任何身份认证，只要服务路径暴露即可完成攻击，自动化程度极高。【投毒风险分析】在对此POC代码的安全性审查中，主要关注点在于其二进制Payload的内容。POC中硬编码了长达数千字符的十六进制字符串（linux_payload_1等）。经过初步解码，这些Payload主要用于触发Java层的反射调用，其最终执行的命令通常是针对Linux系统的基础指令。值得警惕的是，攻击者或投毒者常在此类复杂的Hex Payload中隐藏额外的恶意指令，如自动下载并执行远程脚本（curl/wget管道执行）或安装持久化后门。虽然当前代码片段主要使用了标准的Python库（httpx, binascii, sys, re），未见明显的Python层混淆或恶意外部请求，但Hex Payload本身具有不透明性，对于不具备二进制分析能力的防御者来说存在一定的盲区。建议在使用前，通过十六进制编辑器或Java反序列化分析工具（如ysoserial分析器）对Payload进行静态还原，确保其仅执行预期的探测操作。总体而言，该脚本逻辑直观，投毒风险处于低至中等水平，主要风险集中在不可读的Payload数据中。

**项目地址:** [https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149](https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
