# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md](../2017/CVE-2017-0144-AbbeAlthany_Windows-7_och_CVE-2017-0144_Exploit.md)

# CVE-2017-0144

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #2

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---



---

## POC #2

**来源**: [CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md](../2017/CVE-2017-0144-AdityaBhatt3010_VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统需要启用SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以发送特制的报文到存在漏洞的SMBv1服务器上，从而执行任意代码。根据漏洞库信息，该漏洞影响多个版本的Windows操作系统。提供的利用代码描述了一个VAPT测试，使用Nessus扫描发现目标存在CVE-2017-0144漏洞，然后利用Metasploit框架的EternalBlue模块获取远程shell。因为利用代码仅为渗透测试报告，只包含了nmap等扫描命令, 并没有发现任何恶意的投毒代码，所以投毒风险为0%。利用方式是通过精心构造的SMB报文，触发内核漏洞，最终实现远程代码执行，控制目标机器。

**项目地址:** [AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint](https://github.com/AdityaBhatt3010/VAPT-Report-on-SMB-Exploitation-in-Windows-10-Finance-Endpoint)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #3

**来源**: [CVE-2017-0144-AnugiArrawwala_CVE-Research.md](../2017/CVE-2017-0144-AnugiArrawwala_CVE-Research.md)

## CVE-2017-0144 - Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0144

**漏洞类型:** Remote Code Execution

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者需要网络可达。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMB 数据包到目标服务器来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息，该漏洞存在已知的利用代码，并且有多个Exploit-DB条目指向该漏洞的利用方式。但是，提供的漏洞利用代码`/tmp/vulnwatchdog_fd53aea3ad6b85470a4659795ffbdbed/README.md` 只是一个README文件，指向一个TryHackMe挑战房间的视频链接，并没有提供直接的漏洞利用代码，但是侧面佐证了该漏洞的可利用性。

**投毒风险：** 因为提供的代码仅仅是README文件，而README文件指向的视频文件内容未经审核，所以存在一定的钓鱼风险，判定为存在较高的投毒风险。根据README文件及其指向的外部链接，判定投毒概率为95%。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：

1.  攻击者扫描网络以寻找易受攻击的SMBv1服务器。
2.  攻击者使用预先编写的漏洞利用程序（例如，EternalBlue）或定制的 SMB 数据包来触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而控制目标系统。通常与DoublePulsar后门结合使用。由于SMBv1的特性，利用可能需要身份验证绕过或中间人攻击。

需要注意的是，目前SMBv1已经被官方废弃，因此升级系统，禁用SMBv1服务是最好的防御手段。


**项目地址:** [AnugiArrawwala/CVE-Research](https://github.com/AnugiArrawwala/CVE-Research)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #4

**来源**: [CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-Ashwesker_Blackash-CVE-2017-0144.md)

## CVE-2017-0144 - EternalBlue: Microsoft Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可导致完全控制受影响系统。

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 和 R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold 和 R2, Windows RT 8.1, Windows 10 Gold, 1511, 和 1607 以及 Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 补丁，开放445/TCP端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以通过发送特制的 SMBv1 数据包来利用此漏洞，从而在目标系统上执行任意代码。漏洞利用通常涉及以下步骤：

1.  **协议协商：** 客户端和服务器协商 SMB 协议，确认 SMBv1 可用。
2.  **连接到 IPC$：** 攻击者连接到目标系统的 IPC$ 共享，这是一个用于 SMB 管道的匿名共享。
3.  **Trans2 会话设置：** 攻击者使用 `SMB_COM_TRANSACTION2` (0x32) 发送一个会话设置请求，其中包含一个格式错误的 FEALIST 结构，该结构的 `SizeOfListInBytes` 字段被设置为一个很大的值 (例如 0xFFFF)。
4.  **Trans2 请求溢出：** 攻击者发送多个辅助数据包，每个数据包包含一个超大的 FEALIST 和 FEA (文件扩展属性)。FEA 包含一个 `AttributeName`，其长度超过了预期，导致堆溢出。
5.  **覆盖函数指针：** 溢出覆盖内核中的函数指针。
6.  **执行 shellcode：**  被覆盖的函数指针被shellcode替换，执行shellcode后往往会安装DoublePulsar后门。
7.  **DoublePulsar 后门 (可选)：**  EternalBlue 通常与 DoublePulsar 后门一起使用，DoublePulsar 允许攻击者在 Ring-0 级别执行任意代码。

**有效性：**

提供的描述文件表明，EternalBlue 漏洞的利用已经非常成熟，存在多个可用的 PoC 和 Metasploit 模块。所以提供的POC有效。

**投毒风险：**

该markdown描述文件本身不包含可执行代码。投毒风险较低，但存在一些潜在风险：

*   **依赖外部资源：** 如果该 markdown 文件引用了外部脚本或程序，则存在这些外部资源被篡改的风险。
*   **社会工程学：** 该 markdown 文件可能包含误导性信息或链接，诱骗用户执行恶意操作。
*   **DoublePulsar 后门：** 通过EternalBlue安装的DoublePulsar是一种后门程序，可能会被攻击者用来植入恶意代码。

 综合考虑，投毒风险大概为10%。

**利用方式：**

如上所述，利用方式主要是通过构造恶意的 SMBv1 数据包，触发堆溢出，覆盖内核函数指针，并最终执行 shellcode。

**项目地址:** [Ashwesker/Blackash-CVE-2017-0144](https://github.com/Ashwesker/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #5

**来源**: [CVE-2017-0144-AtithKhawas_autoblue.md](../2017/CVE-2017-0144-AtithKhawas_autoblue.md)

## CVE-2017-0144 - EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，攻击者与目标系统网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是Microsoft Windows SMBv1服务器中的一个远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码，无需身份验证。提供的漏洞利用代码AUTOBLUE是一个自动化工具，旨在简化EternalBlue漏洞的利用过程。它利用Nmap扫描目标系统是否存在MS17-010漏洞，然后使用Metasploit的msfconsole自动启动EternalBlue漏洞利用模块。由于AUTOBLUE需要用户输入目标IP和攻击者IP，并且自动配置Metasploit模块，存在一定风险。例如，攻击者可能将自己的恶意Payload嵌入到Metasploit配置中，从而进行投毒攻击。然而，代码本身主要是自动化已知的利用方式，直接集成了Nmap和Metasploit，相对透明，因此投毒风险比例较低。

**利用方式：**

1.  **扫描：** 使用Nmap扫描目标IP地址，检测是否存在MS17-010漏洞。
2.  **配置：**  配置Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，设置RHOSTS（目标IP地址）和LHOST（攻击者IP地址）。
3.  **执行：**  执行EternalBlue漏洞利用模块，通过精心构造的SMB数据包触发漏洞，在目标系统上执行Payload（通常是一个反向Shell或Meterpreter会话）。

由于SMBv1的广泛弃用和MS17-010补丁的发布，此漏洞的利用难度有所增加，但未打补丁的旧系统仍然容易受到攻击。

**项目地址:** [AtithKhawas/autoblue](https://github.com/AtithKhawas/autoblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #6

**来源**: [CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md](../2017/CVE-2017-0144-B1ack4sh_Blackash-CVE-2017-0144.md)

## CVE-2017-0144-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且攻击者可以访问445端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows 操作系统中的 SMBv1 服务器实现中。攻击者可以发送特制的 SMB 数据包到目标系统，利用缓冲区溢出或其他内存破坏漏洞来执行任意代码。这个漏洞是 WannaCry 勒索软件和其他恶意软件攻击中使用的一个主要漏洞。根据漏洞库信息,存在多个可用的 Exploit-DB 链接（例如 42031, 42030, 41891, 41987）。这些链接提供了利用该漏洞的可能途径。提供的漏洞利用代码 `/tmp/23215dfb08e6f59cb0fbe36ac6dc5ea8/README.md` 只包含一个标题，内容为空，本身不构成任何攻击行为，因此可以忽略此POC代码的有效性。但由于此漏洞有公开的exp,所以POC是存在的，只是未提供。投毒风险较低，因为提供的 README.md 文件内容为空，基本可以忽略。但由于实际利用代码不在提供的文件中,因此实际使用的exp可能存在后门。利用方式是：攻击者构建特制的SMBv1协议数据包，发送到目标系统的445端口，触发漏洞，并在目标系统上执行恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2017-0144](https://github.com/B1ack4sh/Blackash-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #7

**来源**: [CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md](../2017/CVE-2017-0144-EEsshq_CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启 SMBv1 服务，且攻击者能够访问目标系统的 445 端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 "EternalBlue"。 攻击者可以构造特制的 SMB 数据包发送到目标系统，利用此漏洞在目标系统上执行任意代码。

**漏洞利用有效性：**
提供的漏洞利用代码（README.md）描述了使用 Metasploit 框架进行攻击的步骤。该文档详细说明了如何使用 Nmap 扫描目标系统是否存在漏洞，以及如何配置和运行 Metasploit 模块 `exploit/windows/smb/ms17_010_eternalblue`。 该利用方法基于 Metasploit 框架，是公开可用的并且被广泛使用，因此**有效性较高**。 

**投毒风险：**
虽然该仓库的README.md文件展示了漏洞利用过程，但是并没有直接包含后门代码或恶意payload。代码示例主要依赖 Metasploit 框架，而Metasploit 框架本身是合法的渗透测试工具。因此，直接的投毒代码风险较低。然而，用户在使用任何来源的攻击代码时，都应该谨慎审查，因为攻击者可能通过替换 Metasploit 的默认 Payload 或者添加额外的步骤植入后门。**投毒风险评估为 10%**，主要来自用户对 Metasploit 模块配置不当或下载来源不明的 Metasploit 模块。

**漏洞利用方式：**
1.  **网络扫描：** 使用 Nmap 等工具扫描目标网络，确定目标系统是否开启 SMBv1 服务，以及是否存在 MS17-010 漏洞。
2.  **Metasploit 利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
3.  **配置攻击参数：** 设置 `RHOSTS` 为目标 IP 地址，根据需要配置其他选项 (例如 payload 类型)。
4.  **执行攻击：** 运行 `exploit` 命令，Metasploit 将发送恶意 SMB 数据包，尝试利用漏洞。
5.  **获取 Shell：** 如果漏洞利用成功，Metasploit 将在目标系统上打开一个 Meterpreter 会话，攻击者可以通过该会话执行任意命令，完全控制目标系统。

**缓解措施：** 禁用 SMBv1 协议，安装 Microsoft 发布的 MS17-010 安全补丁。

**项目地址:** [EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution](https://github.com/EEsshq/CVE-2017-0144---EtneralBlue-MS17-010-Remote-Code-Execution)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #8

**来源**: [CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md](../2017/CVE-2017-0144-MedX267_EternalBlue-Vulnerability-Scanner.md)

## CVE-2017-0144-EternalBlue

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, 1607, and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，并且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过精心构造的SMB数据包利用此漏洞，实现在目标系统上执行任意代码。该漏洞影响多个版本的Windows操作系统，包括Windows Vista到Windows 10的早期版本以及Windows Server的多个版本。

**有效性：**
提供的Python脚本是一个EternalBlue漏洞扫描器，并非真正的exploit。它通过尝试匿名登录来检测目标系统是否启用了SMBv1，以此判断目标是否可能存在漏洞。因此，此脚本本身并不能直接执行任意代码，而是用于初步判断目标系统的脆弱性。

**投毒风险：**
代码本身是一个扫描器，主要功能是检测目标主机是否开启SMBv1并允许匿名登录。虽然扫描器本身不包含恶意代码，但使用者可能利用扫描结果针对脆弱系统进行攻击。投毒风险较低，约为10%，主要体现在：
1.  依赖的`impacket`库可能存在潜在的安全问题，但这是所有依赖库共有的风险，并非此项目特有。
2.  扫描结果可能被恶意利用，但恶意在于使用者，而非代码本身。

**利用方式：**
1.  **漏洞发现：** 使用类似提供的扫描器检测目标网络中是否存在开启SMBv1的Windows系统。
2.  **漏洞利用：** 如果检测到存在漏洞系统，则需要使用专门的EternalBlue漏洞利用工具（例如Metasploit模块）进一步攻击。这些工具通常包含漏洞利用代码，可以向目标系统发送恶意构造的SMB数据包，从而触发漏洞并执行攻击者预设的代码。
3.  **执行恶意代码：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装后门、窃取敏感信息或进行其他恶意活动。

**项目地址:** [MedX267/EternalBlue-Vulnerability-Scanner](https://github.com/MedX267/EternalBlue-Vulnerability-Scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #9

**来源**: [CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md](../2017/CVE-2017-0144-ducanh2oo3_Vulnerability-Research-CVE-2017-0144.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 且未安装 MS17-010 安全更新

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144 存在于 Windows SMBv1 服务器中，允许远程攻击者通过特制的报文执行任意代码。该漏洞被称为 EternalBlue，利用该漏洞无需用户交互即可实现远程代码执行，攻击者可以完全控制受影响的系统。 

**有效性：**
提供的漏洞利用代码（README.md 文件）描述了如何使用 Metasploit 框架中的 EternalBlue 漏洞利用模块攻击存在漏洞的 Windows 系统。该文档描述了利用过程：首先在 Kali Linux 上启动 Metasploit 控制台，然后搜索并使用 ms17_010 漏洞利用模块，设置目标 IP 地址和 payload，最后执行 exploit 以获取 Meterpreter shell。由于该漏洞利用方法基于 Metasploit 框架，且 EternalBlue 漏洞已被广泛研究和利用，因此可以判定该漏洞利用方法是有效的。

**投毒风险：**
提供的代码片段主要是一个 README.md 文件，其中包含漏洞利用的步骤说明和一些截图。该文件本身不包含任何恶意代码。但是，攻击者可能在以下方面引入投毒风险：
1.  **依赖的 Metasploit 模块：** 攻击者可能修改 Metasploit 模块，使其执行恶意操作，例如安装后门或窃取凭据。但从提供的文件来看，并没有直接修改模块。
2.  **Payload：** 攻击者可以使用恶意 payload，例如 ransomware 或键盘记录器。从提供的文件来看，payload是可以配置的，因此存在一定风险。
3.  **钓鱼：** 攻击者可能使用假的 EternalBlue 漏洞利用程序来诱骗用户运行恶意代码。但此文件仅是演示，用户需要自行配置。
综上所述，虽然 README.md 文件本身没有恶意代码，但利用过程中可能存在投毒风险。为了量化风险，我给出一个较低的概率，估计为 5%。

**利用方式：**
利用 CVE-2017-0144 的主要方式如下：
1.  **漏洞发现：** 攻击者扫描网络以查找易受攻击的 Windows 系统，这些系统启用了 SMBv1 且未安装 MS17-010 安全更新。
2.  **漏洞利用：** 攻击者使用 EternalBlue 漏洞利用程序（例如 Metasploit 模块）向目标系统发送特制的 SMB 报文。
3.  **代码执行：** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，通常是通过部署 payload（例如 Meterpreter shell）。
4.  **权限提升和横向移动：** 攻击者使用 Meterpreter shell 或其他工具来提升权限并在网络中横向移动，以访问更多系统和数据。

**项目地址:** [ducanh2oo3/Vulnerability-Research-CVE-2017-0144](https://github.com/ducanh2oo3/Vulnerability-Research-CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #10

**来源**: [CVE-2017-0144-kimocoder_eternalblue.md](../2017/CVE-2017-0144-kimocoder_eternalblue.md)

## CVE-2017-0144 - Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1 Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144（EternalBlue）是一个针对Windows SMBv1服务器的远程代码执行漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的SMB数据包在目标系统上执行任意代码。漏洞存在于SMBv1协议处理数据包的方式中，攻击者可以利用此缺陷来覆盖内存并最终获得系统控制权。提供的Python脚本 `eternalblue_scanner.py` 旨在检测目标系统是否存在此漏洞，它通过发送特定的SMB请求来检查目标系统是否易受攻击。

**有效性：**
提供的POC代码是一个扫描器，用于检测目标是否存在漏洞。漏洞利用本身需要额外的组件，例如EternalBlue的利用模块，以及DOUBLEPULSAR后门，该脚本只是检测是否存在漏洞。

**投毒风险：**
分析了提供的脚本`eternalblue_scanner.py`。该脚本主要功能是发送SMB协议数据包，根据返回结果判断目标主机是否存在MS17-010漏洞。脚本本身未发现明显的恶意代码。由于该脚本只是一个漏洞扫描工具，不包含漏洞利用代码，因此植入恶意后门的可能性较低。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的SMBv1数据包。
2.  这些数据包利用SMBv1协议中的漏洞，例如缓冲区溢出，来覆盖内存。
3.  攻击者可以将恶意代码注入到被覆盖的内存区域。
4.  当系统执行到被覆盖的内存区域时，恶意代码将被执行，从而导致远程代码执行。
5.  通常EternalBlue会配合DOUBLEPULSAR后门使用，攻击者先使用EternalBlue植入DOUBLEPULSAR后门，然后再通过DOUBLEPULSAR执行任意payload。 

**投毒风险说明：** 脚本本身扫描功能是正常的。但是，不排除作者在代码中隐藏其他不明显的功能，例如，将扫描结果发送到特定服务器。考虑到此类风险，将投毒风险评定为10%。

**项目地址:** [kimocoder/eternalblue](https://github.com/kimocoder/eternalblue)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #11

**来源**: [CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md](../2017/CVE-2017-0144-luckyman2907_SMB-Protocol-Vulnerability_CVE-2017-0144.md)

## CVE-2017-0144 Windows SMB Remote Code Execution Vulnerability (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 是一个存在于Windows SMBv1服务器中的远程代码执行漏洞。该漏洞允许远程攻击者通过精心制作的数据包执行任意代码，无需用户交互。攻击利用的是SMBv1协议中的一个缓冲区溢出缺陷。该漏洞曾被EternalBlue 武器化，并被WannaCry勒索病毒利用，造成了巨大的影响。

**有效性:**

提供的POC代码（`README.md` 文件内容）描述了如何利用Metasploit框架中的`exploit/windows/smb/ms17_010_eternalblue`模块来攻击存在漏洞的Windows系统。这是一个有效的漏洞利用方法，因为EternalBlue是公开可用的，并且Metasploit模块提供了易于使用的接口。

**投毒风险:**

该`README.md`文件本身只是一个实验指南，没有包含任何可执行代码，因此不存在投毒风险。作者没有在文档中隐藏任何恶意代码的可能性，投毒风险评估为0%。

**利用方式:**

1.  **环境准备:**搭建攻击机(Kali Linux)和靶机(存在漏洞的Windows系统)，配置IP地址，确保网络互通。
2.  **服务启动:** 在Kali Linux上启动Postgresql服务（`service postgresql start`），用于Metasploit的数据库支持。
3.  **Metasploit启动:** 启动Metasploit控制台（`msfconsole`）。
4.  **漏洞搜索:** 在Metasploit中搜索与`ms17_010`相关的模块（`search ms17_010`）。
5.  **模块选择:** 选择`exploit/windows/smb/ms17_010_eternalblue` 模块(`use 0`)。
6.  **Payload设置:**  设置payload为`windows/x64/meterpreter/reverse_tcp`。这个payload将在目标系统上执行，并建立一个反向TCP连接到攻击者机器。
7.  **参数配置:** 设置`RHOSTS` 为目标Windows系统的IP地址，`LHOST`为攻击机IP地址。
8.  **漏洞利用:** 运行`exploit`命令，Metasploit将尝试利用EternalBlue漏洞。
9.  **获取Shell:** 如果漏洞利用成功，将获得一个Meterpreter shell，可以控制目标系统。

**项目地址:** [luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144](https://github.com/luckyman2907/SMB-Protocol-Vulnerability_CVE-2017-0144)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #12

**来源**: [CVE-2017-0144-nivedh-j_EternalBlue-Explained.md](../2017/CVE-2017-0144-nivedh-j_EternalBlue-Explained.md)

## CVE-2017-0144 - Windows SMBv1 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-0144 漏洞存在于 Microsoft Windows Vista SP2; Windows Server 2008 SP2 和 R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold 和 R2; Windows RT 8.1; 以及 Windows 10 Gold、1511 和 1607; 以及 Windows Server 2016 的 SMBv1 服务器中，允许远程攻击者通过精心设计的数据包执行任意代码，也被称为“Windows SMB 远程代码执行漏洞”。该漏洞与 CVE-2017-0143、CVE-2017-0145、CVE-2017-0146 和 CVE-2017-0148 中描述的漏洞不同。

**利用方式：**

攻击者通过发送特制的 SMB 数据包到目标服务器的 SMBv1 服务，触发漏洞，从而在目标系统上执行任意代码。通常需要利用如EternalBlue等攻击框架进行利用。由于漏洞利用的复杂度较高，需要构造特殊的SMB协议数据包，因此，通常依赖成熟的漏洞利用工具。

**有效性：**

根据漏洞库信息，以及搜索结果中大量存在的公开可用的 Exploit-DB 上的漏洞利用代码（例如，https://www.exploit-db.com/exploits/41891/ 等），可以判断该漏洞存在有效的POC，且易于被利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 2.0 许可协议的内容。这意味着代码本身是开源的，并允许修改和分发。从内容本身无法判断是否存在恶意代码。需要仔细审查利用代码以及相关的框架(EternalBlue/DoublePulsar)本身，才能确定是否存在投毒风险。由于提供的代码片段仅仅是许可证，因此判定投毒风险较低。

**排序优先级依据：**

由于搜索引擎结果提供了大量的可用漏洞利用资源，因此具有最高的优先级。漏洞利用代码本身的内容是确定投毒风险的关键依据，因此也具有较高的优先级。漏洞库信息则提供了漏洞的基本描述和影响范围，优先级最低。

**项目地址:** [nivedh-j/EternalBlue-Explained](https://github.com/nivedh-j/EternalBlue-Explained)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #13

**来源**: [CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md](../2017/CVE-2017-0144-pelagornisandersi_WIndows-7-automated-exploitation-using-metasploit-framework-.md)

## CVE-2017-0144-Windows SMB 远程代码执行

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607, Windows Server 2016

**利用条件:** 需要目标系统开启SMBv1服务（默认开启），且攻击者能够访问445端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Windows SMBv1服务器中，攻击者通过发送特制的SMB数据包可以触发漏洞，实现远程代码执行。该脚本首先使用nmap扫描目标IP的445端口，如果端口开放则检查运行的服务。然后，使用nmap脚本 `smb-vuln-ms17-010` 扫描是否存在MS17-010漏洞。如果确认存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件，并使用Metasploit框架利用该漏洞获得目标系统的反向shell。

**有效性：**
该PoC脚本通过调用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块来实现漏洞利用，该模块是公开且经过验证的，因此该PoC代码的有效性较高。

**投毒风险：**
该脚本主要是通过shell脚本封装了nmap扫描和Metasploit利用，没有发现任何隐藏的恶意代码，例如下载并执行其他程序等。因此，投毒风险较低，可以判断投毒风险为0%。该脚本的目的是自动化MS17-010漏洞的检测和利用。

**利用方式：**
1.  **端口扫描：** 使用nmap扫描目标IP的445端口是否开放。
2.  **漏洞检测：** 如果445端口开放，则使用nmap的`smb-vuln-ms17-010`脚本检测目标系统是否存在MS17-010漏洞。
3.  **配置生成：** 如果确认目标系统存在漏洞，脚本会提示用户输入攻击者的IP地址和端口，然后生成一个Metasploit的资源配置文件（.rc文件）。
4.  **漏洞利用：** 脚本调用Metasploit的`msfconsole`，并加载生成的资源配置文件，Metasploit会自动运行Eternalblue漏洞利用模块，尝试获取目标系统的控制权。如果成功，攻击者可以获得目标系统的反向shell。

**项目地址:** [pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-](https://github.com/pelagornisandersi/WIndows-7-automated-exploitation-using-metasploit-framework-)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #14

**来源**: [CVE-2017-0144-peterpt_eternal_scanner.md](../2017/CVE-2017-0144-peterpt_eternal_scanner.md)

## CVE-2017-0144 Windows SMB 远程代码执行漏洞 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问目标445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞，也被称为 EternalBlue。攻击者可以通过发送特制的 SMB 数据包到受影响的系统，从而在目标系统上执行任意代码。

**漏洞利用有效性:**
漏洞库信息和大量公开的 exploit 代码 (Exploit-DB, Packet Storm Security) 表明该漏洞具有很高的可利用性。提供的 `check` 脚本片段旨在检测目标是否已修复 MS17-010 补丁，即是否存在漏洞。虽然提供的代码不包含完整的expolit，但其检测功能表明，存在相关的利用链。

**投毒风险评估:**
分析了提供的代码仓库中的文件。
*   `LICENSE`: MIT 许可证，无投毒风险。
*   `changelog.md`: 记录了工具的版本更新信息，无投毒风险。
*   `check`: Python 脚本，用于检测目标主机是否存在 MS17-010 漏洞，它通过尝试连接到目标主机的 SMB 服务并执行一些操作来判断漏洞是否存在。虽然这段代码本身没有明显的投毒行为，但存在被滥用的可能性。例如，攻击者可能使用此脚本扫描大量主机，找到存在漏洞的目标，然后进行攻击。仓库中可能存在其他组件，配合实现完整攻击功能，但此片段本身不具有投毒性，但存在被恶意利用的可能性。

总体来说，此仓库中的已知文件**投毒风险较低 (10%)**，主要风险在于利用此工具进行漏洞扫描和后续攻击。需完整分析仓库全部代码，以判断是否存在植入后门等恶意行为。 

**漏洞利用方式:**
1.  **漏洞扫描:** 使用类似 `check` 脚本的工具扫描目标网络，查找存在 CVE-2017-0144 漏洞的系统。
2.  **漏洞利用:**  利用 EternalBlue 漏洞，通过精心构造的 SMB 数据包，攻击目标系统。
3.  **代码执行:** 成功利用漏洞后，攻击者可以在目标系统上执行任意代码，例如安装恶意软件、窃取敏感信息或者控制整个系统。

**项目地址:** [peterpt/eternal_scanner](https://github.com/peterpt/eternal_scanner)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #15

**来源**: [CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md](../2017/CVE-2017-0144-quynhold_Detect-CVE-2017-0144-attack.md)

## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可访问445端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-0144，又名EternalBlue，是一个严重的Windows SMBv1服务器漏洞，允许未经身份验证的远程攻击者通过精心构造的SMB数据包执行任意代码。该漏洞存在于处理SMBv1协议的方式中，攻击者可以利用此漏洞覆盖内存并最终控制系统。 

**有效性分析:**
根据漏洞库信息和提供的利用代码，该漏洞是真实存在的，并且已经存在公开的PoC。提供的Python脚本 `detectcve20170144.py` 旨在检测网络流量中是否存在CVE-2017-0144攻击的特征，而不是直接利用该漏洞。它通过捕获网络数据包，并检测SMB协议中是否存在特定的NT状态代码 `0xc000000d` 来判断是否可能存在EternalBlue攻击。

**投毒风险分析:**
提供的Python脚本主要功能是网络流量监控和检测，它会捕获网络数据包，特别是SMB协议的数据包，然后分析其中的`smb.nt_status`字段。如果该字段包含`0xc000000d`，则认为存在EternalBlue攻击的可能。脚本会将检测到的攻击信息输出到控制台，并记录到 `log.txt` 文件中。`bcd.csv` 文件记录了所有SMB数据包的信息，可能包含敏感信息。
脚本中存在投毒的风险较低，主要风险点在于记录流量到 `bcd.csv`可能泄漏敏感信息。
经过分析，我评估此代码的投毒风险为 5%。

**利用方式分析:**
1.  **漏洞触发:**  攻击者发送特制的SMBv1数据包到目标服务器的445端口。
2.  **内存覆盖:**  该数据包会利用漏洞覆盖SMBv1服务器进程的内存。
3.  **代码执行:**  攻击者可以在被覆盖的内存中注入并执行恶意代码，从而完全控制目标系统。

**利用步骤 (基于 Metasploit):**
1.  启动Metasploit (`msfconsole`).
2.  搜索EternalBlue相关的exploit (`search eternalblue`).
3.  使用 `exploit/windows/smb/ms17_010_eternalblue` 模块 (`use exploit/windows/smb/ms17_010_eternalblue`).
4.  设置目标IP地址 (`set RHOST <target_ip>`).
5.  运行exploit (`exploit`).

**修复建议:**
1.  禁用SMBv1协议（如果可能）。
2.  安装Microsoft发布的MS17-010安全补丁。
3.  使用防火墙阻止对445端口的未经授权的访问。

**项目地址:** [quynhold/Detect-CVE-2017-0144-attack](https://github.com/quynhold/Detect-CVE-2017-0144-attack)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

## POC #16

**来源**: [CVE-2017-0144-sethwhy_BlueDoor.md](../2017/CVE-2017-0144-sethwhy_BlueDoor.md)

## CVE-2017-0144 (EternalBlue) Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用 SMBv1 协议，攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，又名 EternalBlue，是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。攻击者可以构造特制的 SMB 数据包发送到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性分析：**
提供的漏洞利用代码（来源于BlueDoor CTF挑战）实际上是一个如何利用 Metasploit 或其他工具来攻击存在 EternalBlue 漏洞的 Windows 7 系统的指南。它验证了漏洞的可利用性，提供了一步步的指导，从扫描漏洞到获得目标系统的 shell，再到权限提升和最终获取 flag。

**投毒风险分析：**
该代码主要提供的是一个 CTF 挑战的指南，其目的是帮助学习者复现漏洞利用过程。虽然直接提供的代码片段本身没有明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

*   **payload生成：** 指南中涉及使用`msfvenom`生成payload，如果用户使用错误的参数或者从不可信的源下载payload，可能导致恶意代码被注入到目标系统。
*   **Metasploit模块的信任问题：** 虽然 Metasploit 框架本身是一个合法的渗透测试工具，但用户需要确保使用的 Metasploit 模块来源可靠，避免使用被篡改的版本。
*   **依赖第三方链接：** 该文档依赖于外部链接,如google drive下载OVA文件和netlify ctf提交网站, 存在被替换为恶意链接的风险.

综合评估，该仓库中存在投毒代码的可能性较低，约为10%。风险主要来自于payload的生成、Metasploit模块的使用以及潜在的第三方链接被替换风险。

**利用方式：**
1.  **扫描漏洞：** 使用 `nmap` 等工具扫描目标系统，确认其是否开启了 SMBv1，以及是否存在 MS17-010 漏洞（EternalBlue）。
2.  **生成 Payload：** 使用 `msfvenom` 或类似工具生成一个反向 shell payload。Payload 的作用是在成功利用漏洞后，让目标系统连接到攻击者的机器，从而让攻击者获得一个 shell。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块或者其他 Python 编写的 EternalBlue 漏洞利用脚本，将 payload 发送到目标系统。
4.  **权限提升：** 在获得目标系统的 shell 之后，可能需要进行权限提升，才能执行一些需要管理员权限的操作，例如读取 flag 文件。
5.  **获取 Flag：** 导航到 flag 所在的目录（例如 `C:\Windows\System32`），读取 flag 文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)

---

