# CVE-2017-12617

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12617-DevaDJ_CVE-2017-12617.md](../2017/CVE-2017-12617-DevaDJ_CVE-2017-12617.md)

## CVE-2017-12617-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** HTTP PUTs 启用 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 是 Apache Tomcat 中的一个远程代码执行漏洞。如果 Tomcat 服务器配置允许使用 HTTP PUT 方法（例如，`readonly` 初始化参数设置为 `false`），攻击者可以上传包含恶意代码的 JSP 文件到服务器。然后，通过请求该 JSP 文件，服务器将执行其中的恶意代码，从而导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且已公开利用。提供的 POC 代码旨在验证漏洞的存在，通过上传包含特定字符串的 JSP 文件，然后检查服务器是否能返回该字符串来确认漏洞。

**投毒风险：**
POC 代码中存在一定投毒风险。虽然主要功能是验证漏洞，但也包含直接上传 JSP Webshell 的功能， 如果用户直接使用此代码，容易因为修改不当引入新的安全问题。因此，判定投毒风险为10%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行受影响的版本，并且启用了 HTTP PUT 方法（`readonly` 参数设置为 `false`）。
2.  **JSP 文件上传：** 攻击者使用 PUT 请求上传一个包含恶意代码的 JSP 文件。例如，可以使用如下请求：
    ```
    PUT /path/to/evil.jsp/ HTTP/1.1
    Content-Type: text/plain
    ... 其他头部 ...

    <% out.println("AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"); %>
    ```
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件（例如，`http://target/path/to/evil.jsp`）来触发恶意代码的执行。
4.  **远程控制：** 上传的 JSP 文件可以包含执行系统命令的代码，从而允许攻击者控制服务器。

POC代码包含了上传webshell 的功能， 使用户可以更方便的进行远程控制。


**项目地址:** [DevaDJ/CVE-2017-12617](https://github.com/DevaDJ/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #2

**来源**: [CVE-2017-12617-K3ysTr0K3R_CVE-2017-12617-EXPLOIT.md](../2017/CVE-2017-12617-K3ysTr0K3R_CVE-2017-12617-EXPLOIT.md)

## CVE-2017-12617-Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要Tomcat开启HTTP PUT方法（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12617 漏洞存在于 Apache Tomcat 的特定版本中，当 HTTP PUT 方法被启用时，攻击者可以上传包含恶意代码的 JSP 文件到服务器，并通过访问该 JSP 文件来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码（Exploit-DB:42966, 43008）。提供的 POC 代码 `CVE-2017-12617.py` 尝试利用 PUT 请求上传 JSP 文件，如果目标服务器满足漏洞条件（PUT 方法启用，readonly 设置为 false），则该 POC 代码有效。

**投毒风险：**
查看 `CVE-2017-12617.py` 代码，代码功能较为简单，上传一个jsp类型的文件,并执行,未发现任何明显的恶意代码或后门。`README.md` 文件只是简单的漏洞介绍，没有任何可疑内容。
因此，该仓库中存在作者隐藏的投毒代码的风险很低，判定为0%。

**利用方式：**
1.  **条件判断：**  需要目标 Tomcat 服务器运行在受影响的版本，并且 `readonly` 初始化参数设置为 `false`，允许 HTTP PUT 请求。
2.  **上传恶意 JSP 文件：**  使用 PUT 请求上传包含恶意代码的 JSP 文件。`CVE-2017-12617.py` 脚本中定义了`payload_file`指定上传的文件名,可以修改此变量设置文件名.
3.  **执行恶意代码：**  通过构造 URL 访问上传的 JSP 文件，触发服务器执行其中的恶意代码，从而实现远程代码执行。脚本中包含了反弹shell的代码,通过设置`lhost`和`lport`可以获取目标机器的shell.

**总结：**
该漏洞利用的关键在于利用 Tomcat 对 PUT 请求处理不当，允许未经授权的文件上传，从而为恶意代码执行打开了缺口。

**项目地址:** [K3ysTr0K3R/CVE-2017-12617-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-12617-EXPLOIT)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #3

**来源**: [CVE-2017-12617-LongWayHomie_CVE-2017-12617.md](../2017/CVE-2017-12617-LongWayHomie_CVE-2017-12617.md)

## CVE-2017-12617-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat服务器开启HTTP PUT方法（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许攻击者通过发送特制的HTTP PUT请求上传包含恶意代码的JSP文件到服务器上。上传的JSP文件随后可以被访问并执行，从而导致远程代码执行。该漏洞存在于Apache Tomcat 7.0.0 to 7.0.81, 8.0.0.RC1 to 8.0.46, 8.5.0 to 8.5.22, 9.0.0.M1 to 9.0.0 版本中，**利用方式如下：**

1.  **前提条件：** 目标Tomcat服务器的`readonly`初始化参数必须设置为`false`，即允许HTTP PUT请求。
2.  **漏洞利用：** 攻击者构造一个HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器。JSP文件中的代码会在服务器上执行。
3.  **代码分析：** 提供的PoC代码上传一个包含反弹shell的JSP文件，一旦JSP文件被访问，它将尝试建立一个与攻击者控制机器的反向TCP连接，从而允许攻击者在受害服务器上执行任意命令。
4.  **有效性：** 根据漏洞信息和提供的PoC代码，此PoC大概率有效,需目标服务器满足漏洞利用条件。
5.  **投毒风险：**  PoC代码主要功能是上传和执行JSP后门。虽然主逻辑是反弹shell，但存在一定的投毒风险，比如修改反弹shell的目标地址、端口或者添加额外的恶意代码，可能性为10%。这个比例评估了作者在反弹shell之外偷偷插入其它恶意行为的可能性。通常来说，公开的PoC为了提高可用性，会尽量避免明显的恶意行为，但不能完全排除。
6.  **缓解措施：** 升级Tomcat版本到不受影响的版本，或者将`readonly`初始化参数设置为`true`，禁用HTTP PUT方法。

**项目地址:** [LongWayHomie/CVE-2017-12617](https://github.com/LongWayHomie/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #4

**来源**: [CVE-2017-12617-cyberheartmi9_CVE-2017-12617.md](../2017/CVE-2017-12617-cyberheartmi9_CVE-2017-12617.md)

## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要Tomcat开启HTTP PUT方法（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 允许未经授权的用户通过 PUT 请求上传包含恶意代码的 JSP 文件，并在服务器上执行。利用方式如下：

1.  **漏洞条件：**
    *   目标 Tomcat 服务器运行在受影响的版本范围内。
    *   HTTP PUT 方法被启用，通常是因为`readonly`初始化参数在`Default` servlet 中被设置为`false`。

2.  **利用步骤：**
    *   攻击者构造一个恶意的 HTTP PUT 请求，将包含 JSP 代码的文件上传到服务器。该JSP文件包含攻击者想要执行的恶意代码，例如反弹shell。
    *   上传的文件名需要经过特殊构造，以绕过服务器的安全检查。常见方法包括使用`.jsp`后缀，或者利用路径穿越漏洞将文件上传到Web目录之外，然后通过其他方式访问。
    *   成功上传 JSP 文件后，攻击者通过 HTTP GET 请求访问该 JSP 文件，触发恶意代码的执行。

3.  **漏洞利用代码分析：**
    *   `tomcat-cve-2017-12617.py` 是一个 Python 脚本，用于自动化利用此漏洞。
    *   脚本接受目标 URL 作为参数，并尝试上传一个包含恶意代码的 JSP 文件。
    *   脚本的核心功能是发送 HTTP PUT 请求，将 JSP 文件上传到目标服务器，然后尝试访问该文件。

4.  **投毒风险评估：**
    *   查看代码，发现存在requests库的使用，有网络连接行为。
    *   脚本具备通过网络上传JSP文件的能力,JSP文件内容可以自定义，存在一定的投毒风险。例如，攻击者可能修改脚本，使其上传包含恶意代码的 JSP 文件，该 JSP 文件不仅包含漏洞利用代码，还包含其他恶意功能，例如收集用户信息、植入后门等。但从整体代码来看，主要还是漏洞利用本身，恶意投毒的可能性较低，估计占比10%。

总的来说，此漏洞利用方式较为直接，依赖于目标服务器的配置。POC 代码的有效性较高，但存在一定的投毒风险。使用者需要对 POC 代码进行仔细审查，确保其安全性。

**项目地址:** [cyberheartmi9/CVE-2017-12617](https://github.com/cyberheartmi9/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #5

**来源**: [CVE-2017-12617-devcoinfet_CVE-2017-12617.md](../2017/CVE-2017-12617-devcoinfet_CVE-2017-12617.md)

## CVE-2017-12617-Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat实例开启了HTTP PUT方法（readonly 初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许攻击者通过构造特制的HTTP PUT请求上传JSP文件到服务器上，然后通过访问上传的JSP文件来执行任意代码。从漏洞库信息和搜索引擎结果来看，该漏洞是一个已知且高危的漏洞，存在公开的利用代码。提供的POC代码 `apachetomcat.py` 尝试通过 PUT 方法上传包含恶意代码的 JSP 文件。代码中 `construct_put` 函数构造 PUT 请求，上传名为 `${shell_name}.jsp` 的文件，文件内容为一段简单的 JSP 代码。`main` 函数从 `apaches2.txt` 文件读取目标主机列表，并循环尝试利用漏洞。 

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是有效的，只要目标环境满足漏洞触发的条件（Tomcat版本在受影响范围内，且启用了HTTP PUT）。 POC 代码通过尝试上传JSP文件来验证漏洞。

**投毒风险：**
POC代码中存在轻微的投毒风险（约10%）。
1. `README.md`文件声明 "don't use maliciously please", 但这个声明并不代表任何实际的约束，仅仅是作者的免责声明，属于一种社会工程学上的伪装，降低用户对恶意行为的警惕性。
2. 代码中存在注释，链接到了另一个GitHub仓库 `https://raw.githubusercontent.com/cyberheartmi9/CVE-2017-12617/master/tomcat-cve-2017-12617.py`，这可能诱导用户使用其他潜在的恶意脚本。
3. POC中默认从`apaches2.txt` 读取目标，这是一个隐蔽的控制方式，攻击者可能通过修改这个文件来批量攻击。

**利用方式：**
1.  **条件判断：**  检查目标 Tomcat 服务器是否运行在受影响的版本范围内（9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81）。
2.  **PUT 权限：** 确定目标 Tomcat 服务器是否启用了 HTTP PUT 方法，这通常通过检查 `Default` servlet 的 `readonly` 初始化参数是否设置为 `false` 来判断。
3.  **JSP 上传：**  使用构造好的 HTTP PUT 请求，上传包含恶意代码的 JSP 文件到目标服务器。通常，攻击者会使用`.jsp`或者`.jspx`作为后缀, 但是由于Tomcat对后缀的处理问题， 可以使用`/`绕过。
4.  **代码执行：**  通过访问上传的 JSP 文件，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**项目地址:** [devcoinfet/CVE-2017-12617](https://github.com/devcoinfet/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #6

**来源**: [CVE-2017-12617-ducknuts_network-forensics-cve-2017-12617.md](../2017/CVE-2017-12617-ducknuts_network-forensics-cve-2017-12617.md)

## CVE-2017-12617-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要启用HTTP PUT方法 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617漏洞允许攻击者通过上传恶意JSP文件到启用了HTTP PUT的Tomcat服务器上执行任意代码。漏洞利用需要以下条件：

1.  Tomcat版本在受影响范围内 (9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81).
2.  `readonly` 初始化参数在 Default servlet 中设置为 `false`，从而启用 HTTP PUT 方法。

**利用方式：**

1.  攻击者发送一个特制的 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。
2.  上传的文件通常包含可以执行系统命令的恶意Java代码。
3.  攻击者随后通过 HTTP GET 请求访问上传的 JSP 文件。
4.  Tomcat服务器执行JSP文件中的代码，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的POC是有效的。Exploit-DB 提供了相关的利用代码 (42966, 43008)，表明该漏洞可以被成功利用。

**投毒风险：**

提供的漏洞利用代码只是一个`README.md`文件，描述为“Network forensics example”。 仅凭这个文件**很难直接判定存在投毒代码**。因为其本身不具备任何可执行或者恶意指令。该仓库可能包含网络取证相关的分析脚本或数据，但不能明确是恶意代码，所以初步估计**投毒风险较低，约为10%**。需要进一步分析该仓库中的其他文件才能更准确地评估投毒风险。存在一种可能性，即作者可能在其他的分析脚本中隐藏了恶意指令，诱导用户在分析网络流量时执行，从而感染用户系统。谨慎起见，在使用任何来自不可信来源的脚本之前，都应该仔细检查其代码。

**项目地址:** [ducknuts/network-forensics-cve-2017-12617](https://github.com/ducknuts/network-forensics-cve-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #7

**来源**: [CVE-2017-12617-jptr218_tc_hack.md](../2017/CVE-2017-12617-jptr218_tc_hack.md)

## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** HTTP PUT方法已启用 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许攻击者通过构造的HTTP PUT请求上传JSP文件到服务器，然后服务器将执行JSP文件中的任何代码，从而实现远程代码执行。

**有效性评估:**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC。提供的PoC代码利用了该漏洞，上传了一个名为hack.jsp的webshell。利用代码首先尝试建立到目标IP和端口的TCP连接。 成功建立连接后，它会发送一个HTTP PUT请求，将包含恶意Java代码的JSP文件上传到目标服务器。 然后，它尝试通过发送带有`cmd`参数的HTTP GET请求来执行该JSP文件，从而在服务器上执行任意命令。

**投毒风险评估:**
分析提供的PoC代码，主要功能是上传webshell和执行命令。投毒风险评估为10%。以下是原因：
*   该代码的功能相对明确，主要是为了利用CVE-2017-12617漏洞进行远程代码执行。
*   潜在的风险可能存在于webshell的功能上。例如，webshell可能包含后门，允许未经授权的访问。
*   `tchack.exe`是编译后的二进制文件，如果来源于不可信的仓库，存在被篡改的风险。

**利用方式:**
1.  **前提条件:** 目标Tomcat服务器运行在受影响的版本范围内，并且启用了HTTP PUT方法 (Default Servlet 的 `readonly` 参数设置为 `false`)。
2.  **上传JSP Webshell:**  攻击者使用PUT方法上传一个包含恶意代码的JSP文件，例如`hack.jsp`，到目标服务器。这个JSP文件包含可以执行系统命令的代码。
3.  **命令执行:**  攻击者通过构造一个包含命令的HTTP GET请求来访问上传的JSP文件。例如，`GET /hack.jsp?cmd=whoami HTTP/1.1`。Tomcat服务器执行JSP文件中的代码，并将命令的输出返回给攻击者。
4.  **远程控制:**  通过反复执行命令，攻击者可以实现对目标服务器的远程控制。

**项目地址:** [jptr218/tc_hack](https://github.com/jptr218/tc_hack)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #8

**来源**: [CVE-2017-12617-qiantu88_CVE-2017-12617.md](../2017/CVE-2017-12617-qiantu88_CVE-2017-12617.md)

## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat实例启用HTTP PUT方法（`readonly`初始化参数设置为`false`）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 允许未经身份验证的攻击者通过构造恶意请求上传JSP文件到服务器，并在服务器上执行任意代码。漏洞利用过程如下：

1.  **漏洞原理：** 当 Tomcat 配置允许 HTTP PUT 请求（即 `readonly` 参数设置为 `false`）时，攻击者可以利用此漏洞。
2.  **利用方式：** 攻击者发送特制的 HTTP PUT 请求，上传包含恶意代码的 JSP 文件到服务器上的任意位置。
3.  **代码分析：** 提供的 `tomcat-cve-2017-12617.py` 脚本使用 `requests` 库发送 HTTP PUT 请求来上传JSP webshell。脚本首先检查目标URL是否存在漏洞，然后可以利用该漏洞上传webshell并执行命令。
4.  **有效性：** 根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的，只要目标环境满足漏洞利用的条件。
5.  **投毒风险：** 代码相对简单，主要功能是发送PUT请求，未发现明显的恶意代码或后门。但仍存在一定的投毒风险，例如，webshell可能包含恶意代码或者脚本从外部源下载恶意payload。根据代码分析，投毒风险评定为10%。大部分代码用于发送HTTP请求和处理响应，风险主要来自于webshell本身可能存在的恶意行为。

**项目地址:** [qiantu88/CVE-2017-12617](https://github.com/qiantu88/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #9

**来源**: [CVE-2017-12617-scirusvulgaris_CVE-2017-12617.md](../2017/CVE-2017-12617-scirusvulgaris_CVE-2017-12617.md)

## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要Tomcat开启HTTP PUT方法（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞存在于 Apache Tomcat 中，当配置允许使用 HTTP PUT 方法上传文件时，攻击者可以通过构造特殊的请求上传包含恶意代码的 JSP 文件，然后通过访问该文件来执行任意代码，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息、搜索引擎结果以及提供的POC代码都明确指出该漏洞的存在以及利用方式。多个搜索引擎结果(例如：rapid7, alphabot, broadcom)都确认漏洞的存在, 并且漏洞已经被CISA加入到Known Exploited Vulnerabilities Catalog。

**投毒风险分析：**
提供的POC代码主要包含以下几个部分：
1.  **漏洞检测：** 用于检测目标URL是否存在漏洞。
2.  **Payload生成：** 生成用于执行命令的JSP webshell。
3.  **文件上传：** 通过HTTP PUT方法将JSP webshell上传到服务器。
4.  **命令执行：** 访问上传的JSP webshell，执行任意命令。

虽然POC的核心功能是利用漏洞进行攻击，但是对整个仓库进行分析，存在少量增加攻击者风险的可能性，例如：
*   **不必要的依赖:** 引入了requests库，这本身很常见，但是如果作者故意使用存在漏洞或者恶意代码的requests版本，就可能引入风险. 这部分风险占10%。

因此，整体来看，投毒风险较低，主要集中在作者可能引入的第三方恶意依赖上。

**漏洞利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在受影响的版本范围内，并且 `readonly` 初始化参数设置为 `false`，允许使用 HTTP PUT 方法上传文件。
2.  **上传恶意JSP文件：** 攻击者构造包含恶意代码的JSP文件，例如执行系统命令的webshell。
3.  **发送PUT请求：** 攻击者使用特制的HTTP PUT请求，将恶意JSP文件上传到目标服务器的Web目录中。通常会使用诸如`/shell.jsp/`或`/shell.jsp.`之类的URI绕过某些安全检查。
4.  **执行恶意代码：** 攻击者通过Web浏览器访问上传的JSP文件，服务器执行该文件中的恶意代码，从而实现远程代码执行。

**项目地址:** [scirusvulgaris/CVE-2017-12617](https://github.com/scirusvulgaris/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #10

**来源**: [CVE-2017-12617-tyranteye666_tomcat-cve-2017-12617.md](../2017/CVE-2017-12617-tyranteye666_tomcat-cve-2017-12617.md)

## CVE-2017-12617 - Apache Tomcat JSP上传RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者在服务器上执行任意代码

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要Tomcat运行在受影响版本，启用HTTP PUT方法 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许未经授权的用户通过构造恶意请求上传JSP文件到存在漏洞的Tomcat服务器上，从而导致远程代码执行。该漏洞的利用需要满足两个条件：

1.  Tomcat的版本在受影响范围内 (9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81)。
2.  `readonly` 初始化参数在 Default Servlet 中被设置为 `false`， 允许 HTTP PUT 请求。这意味着服务器允许上传文件。

**利用方式：**

1.  攻击者使用HTTP PUT请求上传包含恶意代码的JSP文件到服务器。上传的JSP文件名可以包含特殊字符以绕过某些安全检查。
2.  上传成功后，攻击者通过Web浏览器访问上传的JSP文件。 Tomcat服务器将执行JSP文件中的恶意代码，从而导致远程代码执行。

**POC有效性：**

提供的POC代码是有效的，它利用了HTTP PUT方法上传JSP webshell到目标服务器，并提供了一个交互式shell。

**投毒风险分析：**

虽然POC的主要功能是利用漏洞，但是仔细检查代码后发现，作者在脚本中包含了一个用于接收电子邮件的地址(satanclause666999@gmail.com)，用于反馈bug，这个行为可能会被滥用，比如搜集攻击目标信息，或者散布带有特定攻击目标的恶意利用。 因此，存在一定的投毒风险，但是风险较低。

**项目地址:** [tyranteye666/tomcat-cve-2017-12617](https://github.com/tyranteye666/tomcat-cve-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

## POC #11

**来源**: [CVE-2017-12617-ygouzerh_CVE-2017-12617.md](../2017/CVE-2017-12617-ygouzerh_CVE-2017-12617.md)

## CVE-2017-12617 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat服务器开启HTTP PUT方法 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器上。漏洞利用的有效性很高，因为公开的漏洞利用代码（POC）可以直接使用。根据漏洞描述和搜索引擎结果，利用此漏洞需要目标Tomcat服务器配置不当，即启用了HTTP PUT方法，且`readonly`初始化参数设置为`false`。  

**利用方式：**

1.  攻击者发送一个HTTP PUT请求，将一个JSP文件（例如`web_shell.jsp`）上传到服务器。这个JSP文件包含可以执行任意系统命令的代码。
2.  服务器将JSP文件保存到其文件系统中。
3.  攻击者通过访问上传的JSP文件的URL，触发恶意代码的执行。
4.  JSP文件中的代码允许攻击者在服务器上执行任意系统命令，从而实现远程代码执行。

**投毒风险分析：**

提供的POC代码本身的功能是验证漏洞，即上传一个webshell并执行命令。但是，其中存在一定潜在的投毒风险，主要体现在以下几个方面：

*   **webshell本身：** `web_shell.jsp` 文件是一个简易的webshell，如果被恶意使用，可能被用于进一步的攻击，例如植入后门、窃取数据等。
*   **依赖环境：**  `Makefile` 和 `attack.sh` 脚本依赖于 `curl` 和 `firefox` 等工具，如果攻击者修改这些脚本，可能会在受害者机器上执行额外的恶意操作。
*   **Docker镜像：** `victim/Dockerfile` 构建了一个包含漏洞的Tomcat环境，如果该镜像被篡改，可能会包含预先植入的恶意代码。

**投毒风险评估：**

尽管POC代码本身旨在验证漏洞，但潜在的滥用风险依然存在。我评估此仓库中存在作者隐藏的投毒代码的可能性为 10%。此评估基于以下原因：

*   POC的主要目的是演示漏洞，通常不会包含额外的恶意代码。
*   代码结构相对简单，容易进行安全审计。
*   公开的POC更容易受到安全研究人员的审查。

然而，使用者仍然需要谨慎对待，仔细审查POC代码，确保没有隐藏的恶意行为。在生产环境中部署或使用任何POC代码之前，务必进行全面的安全评估和测试。

**项目地址:** [ygouzerh/CVE-2017-12617](https://github.com/ygouzerh/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)

---

