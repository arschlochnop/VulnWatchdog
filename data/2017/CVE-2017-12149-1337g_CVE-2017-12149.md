## CVE-2017-12149 - JBoss Application Server RCE (远程代码执行)

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE (远程代码执行)

**影响应用:** JBoss Application Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** JBoss AS 5.x, JBoss AS 6.x

**利用条件:** 通过网络直接访问受影响的JBoss服务器及其 /invoker/readonly 接口。

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本POC针对的是经典的JBoss Application Server反序列化漏洞。CVE-2017-12149主要存在于JBoss的HttpInvoker组件中。该组件在处理POST请求时，未经充分验证就对请求体中的序列化对象进行反序列化，导致攻击者可以构造恶意序列化数据实现远程代码执行。分析提供的POC代码发现，它使用了Python的requests库，并构造了一个十六进制形式的硬编码payload（aced0005...）。这段payload明显是Java序列化数据的魔数开头。该payload似乎是基于Apache Commons Collections（ACC）库构造的利用链（从‘org.apache.commons.collections.keyvalue.TiedMapEntry’和‘LazyMap’等字符串可以看出）。在实际利用中，攻击者通过将此数据发送至目标的‘/invoker/readonly’接口，触发服务器端的readObject操作。如果目标环境中存在易感版本的ACC库，则会执行预定义的命令。POC代码截断部分显示了它试图在目标系统上创建文件（如/tmp/目录下的操作）。整体来看，POC逻辑闭环，能够有效验证目标是否存在反序列化漏洞，但由于payload是硬编码的十六进制字符串，其灵活性较低，如果目标Java版本或依赖库版本不匹配，可能需要重新构造payload。利用步骤：1. 确认目标JBoss服务器开启了HttpInvoker组件，且路径/invoker/readonly可访问。2. 准备Python环境并安装requests库。3. 执行脚本，将目标URL作为参数传入。4. 脚本将硬编码的恶意Java序列化数据通过POST请求发送到目标路径。5. 如果攻击成功，目标服务器将解析该对象并执行payload中封装的系统指令。投毒风险分析：该POC脚本的投毒风险评级为低。代码中主要包含的是标准的Python网络请求库（requests）和二进制处理库（binascii）。虽然脚本包含了一段较长的十六进制字符串（恶意payload），但这是漏洞利用的核心部分，用于在受害者机器上演示RCE，而非在执行脚本的研究员机器上执行恶意操作。通过对代码逻辑的静态审查，未发现诸如base64混淆执行、隐藏的socket反弹连接、或对执行者本地敏感文件的读取行为。其唯一的可疑点在于硬编码的二进制数据，但在安全研究背景下，这是此类反序列化漏洞POC的典型特征。为了安全起见，研究人员在运行此类POC时，应在隔离的沙箱环境中使用，并捕获出站流量，以确保payload的行为符合预期，避免payload中包含指向第三方服务器的恶意指令。目前看，该代码并未表现出针对POC使用者的恶意投毒意图。

**项目地址:** N/A (基于输入POC代码片段分析)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
