## CVE-2017-12149 - JBoss Application Server RCE (远程代码执行)

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE (远程代码执行)

**影响应用:** JBoss Application Server

**危害等级:** CRITICAL

**CVSS评分:** 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P)

**影响版本:** Red Hat Enterprise Application Platform 5.2; JBoss AS 3, 4, 5, 6

**利用条件:** 目标服务器开启了HttpInvoker组件，且 /invoker/readonly 或 /invoker/JMXInvokerServlet 路径可未授权访问。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC是一个典型的针对JBoss反序列化漏洞的自动化利用脚本。其核心逻辑在于利用python的subprocess模块调用外部工具ysoserial.jar生成恶意的Java序列化Payload。脚本明确指向了受影响的端点 `/invoker/readonly`，这是JBoss HttpInvoker组件的默认路径之一。通过发送POST请求并将序列化后的字节流作为Data发送，服务器在解析这些数据时会触发反序列化过程。由于JBoss早期版本在处理这些输入时未进行有效的过滤，结合CommonsCollections等常见的第三方依赖库，攻击者可以构造特定的Gadget Chain（如脚本中选用的CommonsCollections1）来实现任意系统命令执行。该脚本结构清晰，支持用户自定义目标IP、端口、协议及执行的命令，且具备基本的错误处理（如检查ysoserial路径和参数格式），实测在环境配置正确的情况下具有极高的成功率。利用步骤：1. 确保本地安装有Java环境及Python2。2. 获取并放置 ysoserial.jar 到脚本同级目录。3. 执行命令 `python jdspoc.py [目标IP:端口] "[待执行命令]"`。脚本会自动生成Payload并通过HTTP POST请求发送至目标的 /invoker/readonly 接口。4. 若服务器响应200且执行了预设命令，则漏洞利用成功。投毒风险分析：经过对提供源代码的深度静态分析，该Python脚本（jdspoc.py）表现出较高的透明度和安全性。脚本主要依赖标准库（argparse, sys, os, subprocess）和常用的第三方库（requests），未发现任何经过混淆（Obfuscation）的代码块。在网络行为方面，除了向用户指定的Target IP发送攻击Payload外，没有发现任何隐蔽的外部链接、DNS隧道泄露或向硬编码服务器上传敏感信息的逻辑。关于投毒风险的重点排查：脚本中使用了 subprocess.check_output 调用 java -jar，这是正常的利用流程，旨在生成Payload，而非在本地执行恶意代码。唯一潜在的风险点在于 ysoserial.jar 文件的来源，如果该二进制文件并非官方编译版，则可能包含针对研究者本机的后门。然而，就提供的Python源码本身而言，其逻辑纯粹，无恶意注入，投毒风险评级为低（10%），主要风险来自于用户自行获取的第三方依赖包。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
