# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

# CVE-2017-9248

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md](../2017/CVE-2017-9248-0xsharz_telerik-scanner-cve-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #2

**来源**: [CVE-2017-9248-bao7uo_dp_crypto.md](../2017/CVE-2017-9248-bao7uo_dp_crypto.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密算法缺陷

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState篡改、远程代码执行

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者可以访问该组件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的加密算法缺陷漏洞。由于 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey 未被正确保护，远程攻击者可以利用此漏洞破解加密保护机制，导致 MachineKey 泄露。泄露的 MachineKey 可被用于多种攻击，包括：

*   **任意文件上传/下载：** 攻击者可以使用泄露的 MachineKey 来加密和解密用于文件上传或下载的参数，从而绕过安全检查。
*   **跨站脚本攻击（XSS）：** 攻击者可以构造包含恶意 JavaScript 代码的 URL，并使用泄露的 MachineKey 对其进行加密。当用户访问该 URL 时，恶意代码将在用户的浏览器中执行。
*   **ViewState 篡改：** 攻击者可以修改 ViewState 数据，并在服务器端对其进行解密。这可能导致各种安全问题，例如权限提升或数据篡改。
*   **远程代码执行：** 结合其他漏洞，例如 .NET 反序列化漏洞，泄露的 MachineKey 可被用于实现远程代码执行。

根据搜索结果，该漏洞已被广泛利用，包括被 APT 组织利用。CISA 已将此漏洞添加到已知被利用的漏洞目录中。

提供的漏洞利用代码只是 Apache License 2.0 的许可协议，不包含任何漏洞利用代码或恶意代码，因此投毒风险为0%。漏洞的利用方式通常涉及暴力破解或利用已知算法弱点来恢复 MachineKey，然后使用恢复的密钥来执行上述攻击。

**项目地址:** [bao7uo/dp_crypto](https://github.com/bao7uo/dp_crypto)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #3

**来源**: [CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md](../2017/CVE-2017-9248-blacklanternsecurity_dp_cryptomg.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密密钥泄露/远程代码执行/XSS/ViewState 泄露

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露和完全控制服务器

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 目标系统使用存在漏洞的 Telerik UI for ASP.NET AJAX 组件，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件在保护 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 时存在缺陷。攻击者通过利用此漏洞，可获取加密密钥，从而导致多种攻击，例如：

*   **MachineKey 泄露：** 泄露 MachineKey 后，攻击者可以解密 ViewState，伪造身份验证票据等。
*   **任意文件上传/下载：** 攻击者可以利用 MachineKey 来绕过文件上传限制，上传恶意文件或下载敏感文件。
*   **XSS（跨站脚本攻击）：** 攻击者可以利用 MachineKey 来构造恶意的 URL 或请求，从而注入恶意脚本。
*   **ASP.NET ViewState 泄露：** 攻击者可以解密 ViewState，获取敏感信息或篡改 ViewState 数据。

**利用方式：**

1.  **密钥泄露：** 通过特定的 URL 或请求，尝试获取 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey`。
2.  **利用泄露的密钥：** 利用泄露的密钥进行后续攻击，例如：
    *   解密和篡改 ViewState。
    *   构造恶意的 HTTP 请求。
    *   上传恶意文件。

**漏洞利用代码分析：**

提供的漏洞利用代码为一个 `GNU AFFERO GENERAL PUBLIC LICENSE` 文件，它本身并不是一个漏洞利用代码，而是用于开源软件的许可协议。因此，可以判定此仓库中不存在作者隐藏的投毒代码。

**有效性：**

由于提供的代码只是一个License，无法直接评估POC的有效性。需要其他辅助的利用脚本进行评估。但是从搜索结果来看，此漏洞已经有公开的EXP且被积极利用，因此可以推断漏洞是有效的。

**投毒风险：**
提供的代码为开源许可协议，不包含任何恶意代码。因此投毒风险为0%。

**项目地址:** [blacklanternsecurity/dp_cryptomg](https://github.com/blacklanternsecurity/dp_cryptomg)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---



---

## POC #4

**来源**: [CVE-2017-9248-capt-meelo_Telewreck.md](../2017/CVE-2017-9248-capt-meelo_Telewreck.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #5

**来源**: [CVE-2017-9248-cehamod_UI_CVE-2017-9248.md](../2017/CVE-2017-9248-cehamod_UI_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #6

**来源**: [CVE-2017-9248-ictnamanh_CVE-2017-9248.md](../2017/CVE-2017-9248-ictnamanh_CVE-2017-9248.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise以及远程代码执行

**影响版本:** R2 2017 SP1 之前版本，Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX，且允许通过HTTP(S)访问`Telerik.Web.UI.DialogHandler.aspx`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 中的一个加密缺陷，由于 `Telerik.Web.UI.DialogParametersEncryptionKey` 或 `MachineKey` 未得到适当保护，攻击者可以利用此漏洞绕过加密保护机制。该漏洞可能导致多个严重后果，包括：

*   **MachineKey 泄露：** 攻击者可以获取 MachineKey，这允许他们解密和篡改 ASP.NET 应用程序的数据，例如 ViewState。
*   **任意文件上传/下载：** 攻击者可以使用泄露的密钥来上传恶意文件或下载敏感文件。
*   **跨站脚本攻击 (XSS)：** 攻击者可以注入恶意脚本到受影响的应用程序中。
*   **ASP.NET ViewState compromise：** 攻击者可以篡改 ViewState，从而控制应用程序的行为。
*   **远程代码执行 (RCE)：** 结合其他漏洞，攻击者可能最终实现远程代码执行，完全控制目标系统。

**漏洞利用方式：**

1.  **确定目标系统是否使用存在漏洞的 Telerik UI for ASP.NET AJAX 版本。**
2.  **利用漏洞泄露 MachineKey。**  根据漏洞利用代码和搜索结果，可以利用 `Telerik.Web.UI.DialogHandler.aspx` 的加密缺陷，通过构造特定的请求，根据返回的错误信息爆破 MachineKey。
3.  **利用泄露的 MachineKey 执行攻击。**  一旦获取了 MachineKey，攻击者就可以进行上述的各种攻击，例如，上传webshell，篡改ViewState等。

提供的PoC代码 `exploit.py` 的主要功能是：

*   通过发送带有加密的`dp`参数的HTTP请求到`Telerik.Web.UI.DialogHandler.aspx`，来利用加密缺陷。
*   根据服务器返回的特定的错误消息，来推断MachineKey的字符。
*   使用字典树来优化爆破过程。
*   逐步构建完整的 MachineKey。

**投毒风险评估：**

仔细分析提供的 PoC 代码，没有发现明显的投毒代码。PoC 代码的主要目的是利用漏洞，并没有尝试执行任何恶意操作，比如回连攻击者服务器，或者进行本地文件篡改等行为。但是，需要注意的是，使用 PoC 代码进行漏洞测试或攻击具有潜在风险，可能会对目标系统造成损害。

**搜索引擎结果优先级：**

搜索引擎结果确认了此漏洞的严重性，并提供了关于漏洞利用和修复的各种信息，包括 CISA 的分析报告、NVD 的漏洞描述、Telerik 官方的缓解措施、以及其他安全研究人员的分析。这些信息对于理解漏洞和评估风险非常有用。搜索结果也证实了该漏洞已被积极利用。

**综合评估：**

该漏洞是一个高危漏洞，利用代码有效，且PoC代码本身没有发现投毒风险，但是使用PoC具有潜在的攻击风险。攻击者可以利用此漏洞获取系统控制权，因此需要尽快修复。

**项目地址:** [ictnamanh/CVE-2017-9248](https://github.com/ictnamanh/CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

## POC #7

**来源**: [CVE-2017-9248-oldboysonnt_dp.md](../2017/CVE-2017-9248-oldboysonnt_dp.md)

## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞

**影响应用:** Telerik UI for ASP.NET AJAX 和 Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS或ASP.NET ViewState compromise。

**影响版本:** Telerik UI for ASP.NET AJAX 在 R2 2017 SP1 之前, Sitefinity 在 10.0.6412.0 之前

**利用条件:** 需要目标系统使用存在漏洞的Telerik UI for ASP.NET AJAX 组件，并且攻击者可以访问包含漏洞的ASP.NET页面。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2017-9248 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的密码学漏洞。该漏洞源于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。攻击者利用此漏洞可以更容易地绕过加密保护机制，从而导致 MachineKey 泄露，进而造成任意文件上传/下载、XSS 或 ASP.NET ViewState compromise。

**漏洞利用方式：**

1.  **MachineKey 泄露：** 攻击者通过利用漏洞读取或破解加密密钥（DialogParametersEncryptionKey 或 MachineKey）。从搜索引擎结果来看，可以通过暴力破解等方式获取MachineKey。
2.  **利用泄露的 MachineKey：** 获得 MachineKey 后，攻击者可以进行以下攻击：
    *   **任意文件上传/下载：** 利用 MachineKey 伪造身份，上传恶意文件或下载敏感文件。
    *   **XSS：**  构造恶意的 ViewState，其中包含 XSS payload，然后利用 MachineKey 对其进行签名，从而执行跨站脚本攻击。
    *   **ASP.NET ViewState compromise：**  篡改 ViewState，从而影响应用程序的行为。

**POC代码分析：**

提供的dp_crypto3.py是一个用于利用 CVE-2017-9248 的 Python 脚本。该脚本尝试通过差分密码分析的方式恢复加密密钥，然后使用恢复的密钥来解密或加密数据。具体步骤如下：

1.  **初始化：**  脚本首先禁用InsecureRequestWarning，然后定义了一些全局变量，例如 base64 字符集、匹配表等。
2.  **密钥恢复：**  `get_key` 函数是密钥恢复的核心。它通过发送一系列精心构造的 HTTP 请求到目标服务器，并分析服务器的响应来推断密钥的每个字符。该函数使用差分密码分析技术，通过比较不同请求的响应来确定密钥字符。
3.  **加密/解密：**  `encrypt` 函数使用恢复的密钥来加密或解密数据。

**投毒风险分析：**

代码中`verify=False` 禁用SSL证书验证，存在中间人攻击的风险，但这不是投毒。`getProxy(args.proxy)`允许用户使用代理服务器，这本身不是投毒行为，但可能被滥用。检查脚本是否存在明显的恶意代码(例如删除文件，执行系统命令等)未发现。因此，认为存在非常低的投毒风险，约为2%。主要集中在滥用代理服务器上。

**有效性分析：**

根据漏洞描述和提供的POC代码，可以判断该漏洞利用代码是有效的。它实现了利用该漏洞所需的核心步骤，即密钥恢复和数据加密/解密。漏洞库信息和搜索引擎结果也证实了该漏洞的存在和可利用性。此外，CISA的已知被利用漏洞目录中也包含此漏洞，进一步确认了其有效性。

**项目地址:** [oldboysonnt/dp](https://github.com/oldboysonnt/dp)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)

---

