## CVE-2017-7529 - Nginx Integer Overflow

**漏洞编号:** CVE-2017-7529

**漏洞类型:** Integer Overflow

**影响应用:** Nginx

**危害等级:** Sensitive information leak

**CVSS评分:** Unknown

**影响版本:** < 1.13 (Except 1.12)

**利用条件:** Specially crafted request

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2017-7529 是 Nginx 中的一个整数溢出漏洞。该漏洞源于 Nginx 在处理特制的请求时，可能导致整数溢出，从而导致范围处理不正确，进而可能导致敏感信息泄露。根据提供的POC代码，`vulnchecker.py` 脚本用于检查目标 Nginx 服务器是否存在此漏洞，而 `exploit.py` 脚本则用于利用该漏洞，读取敏感的头部信息，包括可能泄露真实 IP 地址等敏感信息。利用步骤如下：

1.  使用 `vulnchecker.py` 脚本检查目标服务器是否存在漏洞：`python3 vulnchecker.py --url <http://example.com/>`
2.  如果 `vulnchecker.py` 确认目标存在漏洞，则使用 `exploit.py` 脚本进行利用：`python3 exploit.py --url <http://example.com/>`

`exploit.py` 脚本通过构造包含特定 Range 头的 HTTP 请求，触发整数溢出，从而读取目标服务器的响应内容，其中可能包含敏感信息。

POC有效性分析：提供的POC代码通过构造特定的HTTP Range请求头，触发了Nginx的整数溢出漏洞。该漏洞允许攻击者读取服务器内存中的敏感信息，如HTTP头信息，甚至可能包括后端服务器的IP地址。`vulnchecker.py`脚本通过发送恶意请求检测是否存在漏洞，如果存在，`exploit.py`脚本将利用该漏洞。

投毒风险分析：该POC代码主要由两个Python脚本组成，依赖于 `requests` 库。代码本身相对清晰，主要功能是构造和发送 HTTP 请求，以及处理响应。投毒风险较低，但仍存在以下潜在风险点：

1.  **依赖项风险**：`requests` 库本身可能存在安全漏洞，如果使用的版本过旧，可能引入安全风险。
2.  **代码执行风险**：虽然代码主体功能是发送 HTTP 请求，但如果被恶意修改，可能包含执行任意代码的风险。例如，攻击者可能在脚本中添加恶意代码，通过 `os.system` 或 `subprocess` 等函数执行系统命令。
3.  **输出信息风险**：脚本会将服务器返回的响应内容打印到控制台，如果服务器返回的内容包含敏感信息（例如，API 密钥、数据库密码等），则可能导致信息泄露。

由于代码量较少，且主要依赖于标准库和 `requests` 库，可以认为投毒风险较低，估计为10%。

**项目地址:** https://github.com/vulhub/nginx-remote-integer-overflow

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2017-7529
