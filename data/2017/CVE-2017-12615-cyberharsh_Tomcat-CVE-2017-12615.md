# CVE-2017-12615

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12615-1337g_CVE-2017-12615.md](../2017/CVE-2017-12615-1337g_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #2

**来源**: [CVE-2017-12615-BeyondCy_CVE-2017-12615.md](../2017/CVE-2017-12615-BeyondCy_CVE-2017-12615.md)

## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #3

**来源**: [CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md](../2017/CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #4

**来源**: [CVE-2017-12615-breaktoprotect_CVE-2017-12615.md](../2017/CVE-2017-12615-breaktoprotect_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #5

**来源**: [CVE-2017-12615-cved-sources_cve-2017-12615.md](../2017/CVE-2017-12615-cved-sources_cve-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #6

**来源**: [CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md](../2017/CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md)

# CVE-2017-12615

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12615-1337g_CVE-2017-12615.md](../2017/CVE-2017-12615-1337g_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #2

**来源**: [CVE-2017-12615-BeyondCy_CVE-2017-12615.md](../2017/CVE-2017-12615-BeyondCy_CVE-2017-12615.md)

## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #3

**来源**: [CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md](../2017/CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #4

**来源**: [CVE-2017-12615-breaktoprotect_CVE-2017-12615.md](../2017/CVE-2017-12615-breaktoprotect_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #5

**来源**: [CVE-2017-12615-cved-sources_cve-2017-12615.md](../2017/CVE-2017-12615-cved-sources_cve-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #6

**来源**: [CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md](../2017/CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md)

# CVE-2017-12615

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12615-1337g_CVE-2017-12615.md](../2017/CVE-2017-12615-1337g_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #2

**来源**: [CVE-2017-12615-BeyondCy_CVE-2017-12615.md](../2017/CVE-2017-12615-BeyondCy_CVE-2017-12615.md)

## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #3

**来源**: [CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md](../2017/CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #4

**来源**: [CVE-2017-12615-breaktoprotect_CVE-2017-12615.md](../2017/CVE-2017-12615-breaktoprotect_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #5

**来源**: [CVE-2017-12615-cved-sources_cve-2017-12615.md](../2017/CVE-2017-12615-cved-sources_cve-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #6

**来源**: [CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md](../2017/CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md)

# CVE-2017-12615

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12615-1337g_CVE-2017-12615.md](../2017/CVE-2017-12615-1337g_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #2

**来源**: [CVE-2017-12615-BeyondCy_CVE-2017-12615.md](../2017/CVE-2017-12615-BeyondCy_CVE-2017-12615.md)

## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #3

**来源**: [CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md](../2017/CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #4

**来源**: [CVE-2017-12615-breaktoprotect_CVE-2017-12615.md](../2017/CVE-2017-12615-breaktoprotect_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #5

**来源**: [CVE-2017-12615-cved-sources_cve-2017-12615.md](../2017/CVE-2017-12615-cved-sources_cve-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #6

**来源**: [CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md](../2017/CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md)

# CVE-2017-12615

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12615-1337g_CVE-2017-12615.md](../2017/CVE-2017-12615-1337g_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #2

**来源**: [CVE-2017-12615-BeyondCy_CVE-2017-12615.md](../2017/CVE-2017-12615-BeyondCy_CVE-2017-12615.md)

## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #3

**来源**: [CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md](../2017/CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #4

**来源**: [CVE-2017-12615-breaktoprotect_CVE-2017-12615.md](../2017/CVE-2017-12615-breaktoprotect_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #5

**来源**: [CVE-2017-12615-cved-sources_cve-2017-12615.md](../2017/CVE-2017-12615-cved-sources_cve-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #6

**来源**: [CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md](../2017/CVE-2017-12615-cyberharsh_Tomcat-CVE-2017-12615.md)

# CVE-2017-12615

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-12615-1337g_CVE-2017-12615.md](../2017/CVE-2017-12615-1337g_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution via JSP upload

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，且启用了HTTP PUT方法（例如，通过设置`readonly`初始化参数为`false`）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。这些JSP文件随后可以被请求执行，导致服务器执行任意代码。利用此漏洞需要在Windows操作系统上运行的Apache Tomcat 7.0.0 到 7.0.79，且要满足`readonly`参数被设置为`false`而启用PUT请求。提供的POC代码 (`CVE-2017-12615.py`) 验证了此漏洞，它通过发送PUT请求上传一个包含恶意代码的JSP文件（`1337.jsp/`）。上传后，它发送一个GET请求来执行上传的JSP文件，并允许攻击者执行任意命令。从代码上看，它没有明显的投毒特征，例如恶意回连或数据窃取。`README.md` 文件简单地描述了漏洞利用的条件和方法，也没有包含任何恶意代码。

**利用方式：**

1.  **PUT请求上传JSP文件：** 攻击者使用HTTP PUT请求，将包含恶意代码的JSP文件上传到目标服务器。上传的文件名需要包含特殊字符，以绕过某些安全检查。
2.  **执行JSP文件：** 攻击者通过发送HTTP GET请求访问上传的JSP文件。Tomcat服务器会解析并执行JSP文件中的代码，从而实现远程代码执行。
3.  **命令执行：** JSP文件中包含执行系统命令的代码。POC 通过request.getParameter("cmd") 获取参数，并执行。

**项目地址:** [1337g/CVE-2017-12615](https://github.com/1337g/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #2

**来源**: [CVE-2017-12615-BeyondCy_CVE-2017-12615.md](../2017/CVE-2017-12615-BeyondCy_CVE-2017-12615.md)

## CVE-2017-12615 Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79 (Windows)

**利用条件:** 运行在Windows上，HTTP PUTs 启用（readonly 初始化参数设置为 false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 漏洞允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器。由于 Tomcat 默认配置不允许直接上传JSP，需要满足特定的前提条件，即运行在Windows系统，并且开启了HTTP PUT方法(通常通过设置readonly初始化参数为false实现)。

**有效性:**
根据漏洞描述和搜索结果，此漏洞利用代码是有效的。多个来源(如Exploit-DB, Rapid7, CISA KEV目录)表明存在公开的漏洞利用程序。

**投毒风险:**
提供的漏洞利用代码包含两个文件：一个README.md文件和一个cmd.jsp文件。
*   README.md: 包含漏洞描述、利用方法和作者信息。没有发现恶意代码。
*   cmd.jsp: 这是一个简单的webshell，允许通过`command`参数执行任意系统命令。需要提供`password`参数值为`secfree`。

虽然 `cmd.jsp` 本身是一个后门，但它符合漏洞描述中“上传JSP文件并执行”的要求，是漏洞利用的一部分。**因此，不能简单地将其判定为投毒代码。**投毒风险评估为10%，主要考虑作者是否在java -jar程序中加入其他恶意程序。因为代码不全，无法确认，所以只能假设。

**利用方式:**
1.  使用PUT请求上传`cmd.jsp`文件到目标Tomcat服务器。上传的文件名需要包含特定的扩展名，例如`.jsp`或`.jspx`，并且可能需要绕过某些文件上传限制，比如文件名末尾添加空格或点号。
2.  通过浏览器访问上传的`cmd.jsp`文件，并提供`password`和`command`参数来执行任意系统命令，例如 `http://target/cmd.jsp?password=secfree&command=whoami`。

**项目地址:** [BeyondCy/CVE-2017-12615](https://github.com/BeyondCy/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #3

**来源**: [CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md](../2017/CVE-2017-12615-Fa1c0n35_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过上传包含恶意代码的JSP文件到存在漏洞的Tomcat服务器上，从而实现远程代码执行。该漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本，并且只有当 Tomcat 运行在 Windows 系统上，并且配置允许 HTTP PUT 方法（即 readonly 初始化参数设置为 false）时才可利用。

**有效性：** 提供的POC代码是有效的。它包含两个文件：
1.  `1.jsp`：这是一个 JSP webshell，允许通过 `cmd` 参数执行任意系统命令。
2.  `README.md`：包含使用 `curl` 命令通过 HTTP PUT 请求上传 `1.jsp` 文件的指令。

**利用方式：**
1.  攻击者使用提供的 `curl` 命令，将 `1.jsp` 文件上传到 Tomcat 服务器。注意，上传路径需要以 `/` 结尾才能绕过某些安全检查。
2.  Tomcat 服务器会将上传的文件保存到 Web 应用的某个目录下。
3.  攻击者通过访问上传的 JSP 文件，并附带 `cmd` 参数，即可执行任意系统命令。例如，访问 `http://<服务器地址>:8080/1.jsp?cmd=whoami` 将会执行 `whoami` 命令，并将结果返回到浏览器。

**投毒风险：** 提供的代码中没有发现明显的投毒代码。`1.jsp` 明确地创建了一个允许执行系统命令的 Webshell。虽然使用 Webshell 本身具有安全风险，但它并不属于传统意义上的“投毒”，因为它直接实现了漏洞利用的功能，用户可以审查代码后决定是否使用。`README.md` 文件只是提供了一个漏洞利用的说明和简单的命令，也没有任何恶意代码。

**项目地址:** [Fa1c0n35/CVE-2017-12615](https://github.com/Fa1c0n35/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #4

**来源**: [CVE-2017-12615-breaktoprotect_CVE-2017-12615.md](../2017/CVE-2017-12615-breaktoprotect_CVE-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #5

**来源**: [CVE-2017-12615-cved-sources_cve-2017-12615.md](../2017/CVE-2017-12615-cved-sources_cve-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #6

**来源**: [CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md](../2017/CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md)

## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #7

**来源**: [CVE-2017-12615-ianxtianxt_CVE-2017-12615.md](../2017/CVE-2017-12615-ianxtianxt_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #8

**来源**: [CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md](../2017/CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并在服务器上执行，可能导致完全控制服务器。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，HTTP PUTs已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615是一个存在于Apache Tomcat 7.0.0到7.0.79版本的远程代码执行漏洞。当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT请求方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以通过构造特殊的请求上传JSP文件到服务器。由于Tomcat对上传的文件名处理不当，攻击者可以通过在文件名后添加斜杠`/`，空格`%20`或者`::$DATA`绕过文件类型检查，最终上传恶意的JSP文件。

**漏洞利用方式：**

1.  **条件判断：** 确认目标Tomcat服务器版本在7.0.0到7.0.79之间，运行在Windows系统上，并且HTTP PUT请求已启用。
2.  **上传JSP文件：** 使用PUT请求上传一个包含恶意代码的JSP文件，文件名需要包含`/`，`%20`或者`::$DATA`等绕过方式。例如，`shell.jsp/`，`shell.jsp%20`或者`shell.jsp::$DATA`。
3.  **执行JSP文件：** 成功上传JSP文件后，通过访问该JSP文件的URL，服务器会执行其中的恶意代码，导致远程代码执行。

**关于投毒风险的分析：**

查看提供的`TomcatScanPro.py`脚本，该脚本的主要功能是漏洞检测和利用，包括CVE-2017-12615漏洞的多种利用方式、CNVD-2020-10487漏洞利用以及弱口令爆破等。主要的投毒风险可能存在于以下几个方面：

*   **恶意WebShell内容：** 脚本在弱口令破解成功后，会尝试上传WebShell，如果WebShell的内容被替换为具有破坏性的代码，可能会对目标系统造成损害。
*   **config.yaml配置文件的恶意修改：** 如果`config.yaml`配置文件被篡改，攻击者可以修改默认的扫描行为，例如指定恶意的文件包含路径或关键字，从而在受害者不知情的情况下执行恶意操作。
*   **WAR包部署的恶意代码：** 脚本支持通过上传WAR包来获取`getshell`，如果WAR包中包含恶意代码，可能会导致更严重的后果。

**投毒风险评估：**

综合考虑以上因素，尽管脚本本身的功能是漏洞检测和利用，但潜在的投毒风险仍然存在。攻击者可以通过修改脚本中的关键配置或替换WebShell内容来达到恶意目的。因此，在使用该脚本时，务必仔细检查脚本的源代码和配置文件，确保其安全性。 这里根据代码功能和描述评估`poison`风险为 10%，主要是因为脚本本身是一个渗透测试工具，其目的是模拟攻击，因此某些操作本身就具有一定的“攻击性”，但从恶意代码植入的角度看，风险较低。


**项目地址:** [lizhianyuguangming/TomcatScanPro](https://github.com/lizhianyuguangming/TomcatScanPro)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #9

**来源**: [CVE-2017-12615-mefulton_cve-2017-12615.md](../2017/CVE-2017-12615-mefulton_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #10

**来源**: [CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md](../2017/CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，启用HTTP PUT，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12615漏洞存在于Apache Tomcat 7.0.0到7.0.79版本中。当Tomcat运行在Windows系统，且启用了HTTP PUT方法（例如，通过设置DefaultServlet的readonly初始化参数为false），攻击者可以通过构造特殊的请求上传JSP文件到服务器。上传的JSP文件随后可以被访问，并执行其中包含的任意代码，从而实现远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且DefaultServlet的`readonly`参数设置为`false`，允许HTTP PUT请求。
2.  **构造JSP Payload：** 创建一个包含恶意代码的JSP文件，例如webshell，用于执行系统命令。
3.  **上传JSP文件：** 使用HTTP PUT方法将JSP文件上传到Tomcat服务器。关键在于文件名后添加`/`，绕过某些安全检查。例如：`curl -v -X PUT "http://localhost:8080/shell.jsp/" -H "Content-Type: text/plain" --data-binary @shell.jsp`。
4.  **执行Payload：** 通过访问上传的JSP文件，传递参数执行恶意代码。例如：`http://localhost:8080/shell.jsp?cmd=id`，执行`id`命令。

**投毒风险分析：**

提供的Dockerfile构建了一个存在CVE-2017-12615漏洞的Tomcat环境，并生成一个包含flag的txt文件。代码本身是漏洞的验证和演示，没有明显的恶意投毒行为。docker-entrypoint.sh 脚本主要功能是生成flag文件，验证Tomcat和Java环境是否正确启动。`webapps/ROOT` 目录被拷贝到容器中，可能包含一些提示信息，引导使用者进行漏洞利用。整体风险较低，主要是为了演示漏洞，而非进行恶意攻击。其中`docker-entrypoint.sh` 脚本的随机值生成可能存在一定的预测性，但并不能完全控制目标系统。

尽管主要目的是漏洞演示，但存在极小的（5%）投毒风险。例如：

*   在`webapps/ROOT`目录下放置看似无害但实际会影响目标系统的JSP文件。
*   虽然`docker-entrypoint.sh`的主要目的是生成flag，但理论上也可以添加一些命令来修改系统配置，虽然目前的代码并没有这么做。生成flag的部分代码可以算作良性的'后门'，方便验证漏洞。


**项目地址:** [netw0rk7/CVE-2017-12615-Home-Lab](https://github.com/netw0rk7/CVE-2017-12615-Home-Lab)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #11

**来源**: [CVE-2017-12615-tpt11fb_AttackTomcat.md](../2017/CVE-2017-12615-tpt11fb_AttackTomcat.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #12

**来源**: [CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md](../2017/CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，并且启用了HTTP PUT方法(readonly 初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且启用了 HTTP PUT 请求方法（例如，通过设置 `readonly` 初始化参数为 `false`）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，并执行其中包含的任意代码，导致远程代码执行。

**漏洞利用方式：**
1.  **检查PUT方法是否启用：** 首先，需要确认目标 Tomcat 服务器是否允许 HTTP PUT 请求。可以通过发送 `OPTIONS` 请求，检查响应头中的 `Allow` 字段是否包含 `PUT`。
2.  **构造恶意JSP文件：** 准备一个包含恶意代码的 JSP 文件。该 JSP 文件可以使用 Java 代码执行任意命令，例如反弹 shell。
3.  **上传JSP文件：** 使用 HTTP PUT 请求将恶意 JSP 文件上传到服务器。文件名需要包含特殊的字符，例如使用时间戳命名然后加/.jsp/绕过文件类型校验。
4.  **执行JSP文件：**  通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。

**代码分析：**
提供的 Go 语言 POC 代码实现了上述漏洞利用过程。该代码首先检查目标服务器是否支持 PUT 请求，然后构造包含恶意代码的 JSP 文件，并使用 PUT 请求将其上传到服务器。上传成功后，返回 Webshell 地址。

**投毒风险：**
代码本身是一个PoC验证程序，主要功能是上传jsp webshell文件。风险较低，但是用户在使用时，可能会替换webshell里的代码，如果webshell代码被替换为恶意代码，则存在被植入恶意代码的风险。因此判定投毒风险为1%。

**项目地址:** [w0x68y/CVE-2017-12615-EXP](https://github.com/w0x68y/CVE-2017-12615-EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #13

**来源**: [CVE-2017-12615-wsg00d_cve-2017-12615.md](../2017/CVE-2017-12615-wsg00d_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许未经授权的攻击者通过上传包含恶意代码的JSP文件到受影响的Apache Tomcat服务器上，从而实现远程代码执行。利用方式如下：

1.  **漏洞原理：** 当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`实现）时，服务器允许客户端上传文件。如果对上传的文件名没有进行充分的验证，攻击者就可以上传一个带有JSP扩展名的文件（例如`shell.jsp/`），Tomcat会将该文件视为JSP文件并执行其中的代码。

2.  **POC代码分析：** 提供的Python POC脚本首先尝试使用`OPTIONS`请求获取服务器允许的HTTP方法，并检查`Allow`头是否包含`PUT`。如果支持`PUT`方法，则生成一个随机文件名（带有`.jsp/`扩展名），然后使用`PUT`请求将包含恶意JSP代码的文件上传到服务器。上传的JSP代码包含一个简单的后门，允许攻击者通过`i`参数执行任意系统命令，并通过`pwd`参数进行简单的密码验证。文件上传成功后，脚本会打印出shell的访问URL。

3.  **有效性：** 根据漏洞描述和POC代码的逻辑，POC代码是有效的。如果目标Tomcat服务器满足漏洞条件（Windows + PUT enabled + Tomcat 7.0.0-7.0.79），该POC应该能够成功上传JSP shell并执行命令。

4.  **投毒风险：** 提供的POC代码本身没有明显的投毒行为。恶意代码位于JSP shell的内容中，目的是在目标服务器上执行命令，而不是在攻击者的机器上进行任何恶意操作。因此，投毒风险评估为0%。

5.  **利用方式总结：**
    *   确定目标Tomcat服务器运行在Windows上，并且启用了HTTP PUT方法。
    *   使用POC脚本或其他HTTP客户端发送PUT请求，上传一个包含恶意JSP代码的文件，文件名以`.jsp/`结尾。
    *   通过访问上传的JSP文件（例如，`http://target/random_name.jsp?pwd=023&i=whoami`）来执行任意系统命令。

6.  **搜索结果佐证：** 搜索引擎结果表明，CVE-2017-12615是一个已知被广泛利用的高危漏洞，CISA已知漏洞利用库收录了该漏洞，并建议高优先级修复。同时也存在相关的分析文章，进一步验证了漏洞的有效性和危害性。

**项目地址:** [wsg00d/cve-2017-12615](https://github.com/wsg00d/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #14

**来源**: [CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md](../2017/CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #15

**来源**: [CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md](../2017/CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md)

## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #16

**来源**: [CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md](../2017/CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---



---

## POC #7

**来源**: [CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md](../2017/CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md)

## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #8

**来源**: [CVE-2017-12615-ianxtianxt_CVE-2017-12615.md](../2017/CVE-2017-12615-ianxtianxt_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #9

**来源**: [CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md](../2017/CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并在服务器上执行，可能导致完全控制服务器。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，HTTP PUTs已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615是一个存在于Apache Tomcat 7.0.0到7.0.79版本的远程代码执行漏洞。当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT请求方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以通过构造特殊的请求上传JSP文件到服务器。由于Tomcat对上传的文件名处理不当，攻击者可以通过在文件名后添加斜杠`/`，空格`%20`或者`::$DATA`绕过文件类型检查，最终上传恶意的JSP文件。

**漏洞利用方式：**

1.  **条件判断：** 确认目标Tomcat服务器版本在7.0.0到7.0.79之间，运行在Windows系统上，并且HTTP PUT请求已启用。
2.  **上传JSP文件：** 使用PUT请求上传一个包含恶意代码的JSP文件，文件名需要包含`/`，`%20`或者`::$DATA`等绕过方式。例如，`shell.jsp/`，`shell.jsp%20`或者`shell.jsp::$DATA`。
3.  **执行JSP文件：** 成功上传JSP文件后，通过访问该JSP文件的URL，服务器会执行其中的恶意代码，导致远程代码执行。

**关于投毒风险的分析：**

查看提供的`TomcatScanPro.py`脚本，该脚本的主要功能是漏洞检测和利用，包括CVE-2017-12615漏洞的多种利用方式、CNVD-2020-10487漏洞利用以及弱口令爆破等。主要的投毒风险可能存在于以下几个方面：

*   **恶意WebShell内容：** 脚本在弱口令破解成功后，会尝试上传WebShell，如果WebShell的内容被替换为具有破坏性的代码，可能会对目标系统造成损害。
*   **config.yaml配置文件的恶意修改：** 如果`config.yaml`配置文件被篡改，攻击者可以修改默认的扫描行为，例如指定恶意的文件包含路径或关键字，从而在受害者不知情的情况下执行恶意操作。
*   **WAR包部署的恶意代码：** 脚本支持通过上传WAR包来获取`getshell`，如果WAR包中包含恶意代码，可能会导致更严重的后果。

**投毒风险评估：**

综合考虑以上因素，尽管脚本本身的功能是漏洞检测和利用，但潜在的投毒风险仍然存在。攻击者可以通过修改脚本中的关键配置或替换WebShell内容来达到恶意目的。因此，在使用该脚本时，务必仔细检查脚本的源代码和配置文件，确保其安全性。 这里根据代码功能和描述评估`poison`风险为 10%，主要是因为脚本本身是一个渗透测试工具，其目的是模拟攻击，因此某些操作本身就具有一定的“攻击性”，但从恶意代码植入的角度看，风险较低。


**项目地址:** [lizhianyuguangming/TomcatScanPro](https://github.com/lizhianyuguangming/TomcatScanPro)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #10

**来源**: [CVE-2017-12615-mefulton_cve-2017-12615.md](../2017/CVE-2017-12615-mefulton_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #11

**来源**: [CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md](../2017/CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，启用HTTP PUT，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12615漏洞存在于Apache Tomcat 7.0.0到7.0.79版本中。当Tomcat运行在Windows系统，且启用了HTTP PUT方法（例如，通过设置DefaultServlet的readonly初始化参数为false），攻击者可以通过构造特殊的请求上传JSP文件到服务器。上传的JSP文件随后可以被访问，并执行其中包含的任意代码，从而实现远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且DefaultServlet的`readonly`参数设置为`false`，允许HTTP PUT请求。
2.  **构造JSP Payload：** 创建一个包含恶意代码的JSP文件，例如webshell，用于执行系统命令。
3.  **上传JSP文件：** 使用HTTP PUT方法将JSP文件上传到Tomcat服务器。关键在于文件名后添加`/`，绕过某些安全检查。例如：`curl -v -X PUT "http://localhost:8080/shell.jsp/" -H "Content-Type: text/plain" --data-binary @shell.jsp`。
4.  **执行Payload：** 通过访问上传的JSP文件，传递参数执行恶意代码。例如：`http://localhost:8080/shell.jsp?cmd=id`，执行`id`命令。

**投毒风险分析：**

提供的Dockerfile构建了一个存在CVE-2017-12615漏洞的Tomcat环境，并生成一个包含flag的txt文件。代码本身是漏洞的验证和演示，没有明显的恶意投毒行为。docker-entrypoint.sh 脚本主要功能是生成flag文件，验证Tomcat和Java环境是否正确启动。`webapps/ROOT` 目录被拷贝到容器中，可能包含一些提示信息，引导使用者进行漏洞利用。整体风险较低，主要是为了演示漏洞，而非进行恶意攻击。其中`docker-entrypoint.sh` 脚本的随机值生成可能存在一定的预测性，但并不能完全控制目标系统。

尽管主要目的是漏洞演示，但存在极小的（5%）投毒风险。例如：

*   在`webapps/ROOT`目录下放置看似无害但实际会影响目标系统的JSP文件。
*   虽然`docker-entrypoint.sh`的主要目的是生成flag，但理论上也可以添加一些命令来修改系统配置，虽然目前的代码并没有这么做。生成flag的部分代码可以算作良性的'后门'，方便验证漏洞。


**项目地址:** [netw0rk7/CVE-2017-12615-Home-Lab](https://github.com/netw0rk7/CVE-2017-12615-Home-Lab)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #12

**来源**: [CVE-2017-12615-tpt11fb_AttackTomcat.md](../2017/CVE-2017-12615-tpt11fb_AttackTomcat.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #13

**来源**: [CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md](../2017/CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，并且启用了HTTP PUT方法(readonly 初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且启用了 HTTP PUT 请求方法（例如，通过设置 `readonly` 初始化参数为 `false`）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，并执行其中包含的任意代码，导致远程代码执行。

**漏洞利用方式：**
1.  **检查PUT方法是否启用：** 首先，需要确认目标 Tomcat 服务器是否允许 HTTP PUT 请求。可以通过发送 `OPTIONS` 请求，检查响应头中的 `Allow` 字段是否包含 `PUT`。
2.  **构造恶意JSP文件：** 准备一个包含恶意代码的 JSP 文件。该 JSP 文件可以使用 Java 代码执行任意命令，例如反弹 shell。
3.  **上传JSP文件：** 使用 HTTP PUT 请求将恶意 JSP 文件上传到服务器。文件名需要包含特殊的字符，例如使用时间戳命名然后加/.jsp/绕过文件类型校验。
4.  **执行JSP文件：**  通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。

**代码分析：**
提供的 Go 语言 POC 代码实现了上述漏洞利用过程。该代码首先检查目标服务器是否支持 PUT 请求，然后构造包含恶意代码的 JSP 文件，并使用 PUT 请求将其上传到服务器。上传成功后，返回 Webshell 地址。

**投毒风险：**
代码本身是一个PoC验证程序，主要功能是上传jsp webshell文件。风险较低，但是用户在使用时，可能会替换webshell里的代码，如果webshell代码被替换为恶意代码，则存在被植入恶意代码的风险。因此判定投毒风险为1%。

**项目地址:** [w0x68y/CVE-2017-12615-EXP](https://github.com/w0x68y/CVE-2017-12615-EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #14

**来源**: [CVE-2017-12615-wsg00d_cve-2017-12615.md](../2017/CVE-2017-12615-wsg00d_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许未经授权的攻击者通过上传包含恶意代码的JSP文件到受影响的Apache Tomcat服务器上，从而实现远程代码执行。利用方式如下：

1.  **漏洞原理：** 当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`实现）时，服务器允许客户端上传文件。如果对上传的文件名没有进行充分的验证，攻击者就可以上传一个带有JSP扩展名的文件（例如`shell.jsp/`），Tomcat会将该文件视为JSP文件并执行其中的代码。

2.  **POC代码分析：** 提供的Python POC脚本首先尝试使用`OPTIONS`请求获取服务器允许的HTTP方法，并检查`Allow`头是否包含`PUT`。如果支持`PUT`方法，则生成一个随机文件名（带有`.jsp/`扩展名），然后使用`PUT`请求将包含恶意JSP代码的文件上传到服务器。上传的JSP代码包含一个简单的后门，允许攻击者通过`i`参数执行任意系统命令，并通过`pwd`参数进行简单的密码验证。文件上传成功后，脚本会打印出shell的访问URL。

3.  **有效性：** 根据漏洞描述和POC代码的逻辑，POC代码是有效的。如果目标Tomcat服务器满足漏洞条件（Windows + PUT enabled + Tomcat 7.0.0-7.0.79），该POC应该能够成功上传JSP shell并执行命令。

4.  **投毒风险：** 提供的POC代码本身没有明显的投毒行为。恶意代码位于JSP shell的内容中，目的是在目标服务器上执行命令，而不是在攻击者的机器上进行任何恶意操作。因此，投毒风险评估为0%。

5.  **利用方式总结：**
    *   确定目标Tomcat服务器运行在Windows上，并且启用了HTTP PUT方法。
    *   使用POC脚本或其他HTTP客户端发送PUT请求，上传一个包含恶意JSP代码的文件，文件名以`.jsp/`结尾。
    *   通过访问上传的JSP文件（例如，`http://target/random_name.jsp?pwd=023&i=whoami`）来执行任意系统命令。

6.  **搜索结果佐证：** 搜索引擎结果表明，CVE-2017-12615是一个已知被广泛利用的高危漏洞，CISA已知漏洞利用库收录了该漏洞，并建议高优先级修复。同时也存在相关的分析文章，进一步验证了漏洞的有效性和危害性。

**项目地址:** [wsg00d/cve-2017-12615](https://github.com/wsg00d/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #15

**来源**: [CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md](../2017/CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #16

**来源**: [CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md](../2017/CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md)

## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #17

**来源**: [CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md](../2017/CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---



---

## POC #7

**来源**: [CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md](../2017/CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md)

## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #8

**来源**: [CVE-2017-12615-ianxtianxt_CVE-2017-12615.md](../2017/CVE-2017-12615-ianxtianxt_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #9

**来源**: [CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md](../2017/CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并在服务器上执行，可能导致完全控制服务器。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，HTTP PUTs已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615是一个存在于Apache Tomcat 7.0.0到7.0.79版本的远程代码执行漏洞。当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT请求方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以通过构造特殊的请求上传JSP文件到服务器。由于Tomcat对上传的文件名处理不当，攻击者可以通过在文件名后添加斜杠`/`，空格`%20`或者`::$DATA`绕过文件类型检查，最终上传恶意的JSP文件。

**漏洞利用方式：**

1.  **条件判断：** 确认目标Tomcat服务器版本在7.0.0到7.0.79之间，运行在Windows系统上，并且HTTP PUT请求已启用。
2.  **上传JSP文件：** 使用PUT请求上传一个包含恶意代码的JSP文件，文件名需要包含`/`，`%20`或者`::$DATA`等绕过方式。例如，`shell.jsp/`，`shell.jsp%20`或者`shell.jsp::$DATA`。
3.  **执行JSP文件：** 成功上传JSP文件后，通过访问该JSP文件的URL，服务器会执行其中的恶意代码，导致远程代码执行。

**关于投毒风险的分析：**

查看提供的`TomcatScanPro.py`脚本，该脚本的主要功能是漏洞检测和利用，包括CVE-2017-12615漏洞的多种利用方式、CNVD-2020-10487漏洞利用以及弱口令爆破等。主要的投毒风险可能存在于以下几个方面：

*   **恶意WebShell内容：** 脚本在弱口令破解成功后，会尝试上传WebShell，如果WebShell的内容被替换为具有破坏性的代码，可能会对目标系统造成损害。
*   **config.yaml配置文件的恶意修改：** 如果`config.yaml`配置文件被篡改，攻击者可以修改默认的扫描行为，例如指定恶意的文件包含路径或关键字，从而在受害者不知情的情况下执行恶意操作。
*   **WAR包部署的恶意代码：** 脚本支持通过上传WAR包来获取`getshell`，如果WAR包中包含恶意代码，可能会导致更严重的后果。

**投毒风险评估：**

综合考虑以上因素，尽管脚本本身的功能是漏洞检测和利用，但潜在的投毒风险仍然存在。攻击者可以通过修改脚本中的关键配置或替换WebShell内容来达到恶意目的。因此，在使用该脚本时，务必仔细检查脚本的源代码和配置文件，确保其安全性。 这里根据代码功能和描述评估`poison`风险为 10%，主要是因为脚本本身是一个渗透测试工具，其目的是模拟攻击，因此某些操作本身就具有一定的“攻击性”，但从恶意代码植入的角度看，风险较低。


**项目地址:** [lizhianyuguangming/TomcatScanPro](https://github.com/lizhianyuguangming/TomcatScanPro)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #10

**来源**: [CVE-2017-12615-mefulton_cve-2017-12615.md](../2017/CVE-2017-12615-mefulton_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #11

**来源**: [CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md](../2017/CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，启用HTTP PUT，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12615漏洞存在于Apache Tomcat 7.0.0到7.0.79版本中。当Tomcat运行在Windows系统，且启用了HTTP PUT方法（例如，通过设置DefaultServlet的readonly初始化参数为false），攻击者可以通过构造特殊的请求上传JSP文件到服务器。上传的JSP文件随后可以被访问，并执行其中包含的任意代码，从而实现远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且DefaultServlet的`readonly`参数设置为`false`，允许HTTP PUT请求。
2.  **构造JSP Payload：** 创建一个包含恶意代码的JSP文件，例如webshell，用于执行系统命令。
3.  **上传JSP文件：** 使用HTTP PUT方法将JSP文件上传到Tomcat服务器。关键在于文件名后添加`/`，绕过某些安全检查。例如：`curl -v -X PUT "http://localhost:8080/shell.jsp/" -H "Content-Type: text/plain" --data-binary @shell.jsp`。
4.  **执行Payload：** 通过访问上传的JSP文件，传递参数执行恶意代码。例如：`http://localhost:8080/shell.jsp?cmd=id`，执行`id`命令。

**投毒风险分析：**

提供的Dockerfile构建了一个存在CVE-2017-12615漏洞的Tomcat环境，并生成一个包含flag的txt文件。代码本身是漏洞的验证和演示，没有明显的恶意投毒行为。docker-entrypoint.sh 脚本主要功能是生成flag文件，验证Tomcat和Java环境是否正确启动。`webapps/ROOT` 目录被拷贝到容器中，可能包含一些提示信息，引导使用者进行漏洞利用。整体风险较低，主要是为了演示漏洞，而非进行恶意攻击。其中`docker-entrypoint.sh` 脚本的随机值生成可能存在一定的预测性，但并不能完全控制目标系统。

尽管主要目的是漏洞演示，但存在极小的（5%）投毒风险。例如：

*   在`webapps/ROOT`目录下放置看似无害但实际会影响目标系统的JSP文件。
*   虽然`docker-entrypoint.sh`的主要目的是生成flag，但理论上也可以添加一些命令来修改系统配置，虽然目前的代码并没有这么做。生成flag的部分代码可以算作良性的'后门'，方便验证漏洞。


**项目地址:** [netw0rk7/CVE-2017-12615-Home-Lab](https://github.com/netw0rk7/CVE-2017-12615-Home-Lab)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #12

**来源**: [CVE-2017-12615-tpt11fb_AttackTomcat.md](../2017/CVE-2017-12615-tpt11fb_AttackTomcat.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #13

**来源**: [CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md](../2017/CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，并且启用了HTTP PUT方法(readonly 初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且启用了 HTTP PUT 请求方法（例如，通过设置 `readonly` 初始化参数为 `false`）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，并执行其中包含的任意代码，导致远程代码执行。

**漏洞利用方式：**
1.  **检查PUT方法是否启用：** 首先，需要确认目标 Tomcat 服务器是否允许 HTTP PUT 请求。可以通过发送 `OPTIONS` 请求，检查响应头中的 `Allow` 字段是否包含 `PUT`。
2.  **构造恶意JSP文件：** 准备一个包含恶意代码的 JSP 文件。该 JSP 文件可以使用 Java 代码执行任意命令，例如反弹 shell。
3.  **上传JSP文件：** 使用 HTTP PUT 请求将恶意 JSP 文件上传到服务器。文件名需要包含特殊的字符，例如使用时间戳命名然后加/.jsp/绕过文件类型校验。
4.  **执行JSP文件：**  通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。

**代码分析：**
提供的 Go 语言 POC 代码实现了上述漏洞利用过程。该代码首先检查目标服务器是否支持 PUT 请求，然后构造包含恶意代码的 JSP 文件，并使用 PUT 请求将其上传到服务器。上传成功后，返回 Webshell 地址。

**投毒风险：**
代码本身是一个PoC验证程序，主要功能是上传jsp webshell文件。风险较低，但是用户在使用时，可能会替换webshell里的代码，如果webshell代码被替换为恶意代码，则存在被植入恶意代码的风险。因此判定投毒风险为1%。

**项目地址:** [w0x68y/CVE-2017-12615-EXP](https://github.com/w0x68y/CVE-2017-12615-EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #14

**来源**: [CVE-2017-12615-wsg00d_cve-2017-12615.md](../2017/CVE-2017-12615-wsg00d_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许未经授权的攻击者通过上传包含恶意代码的JSP文件到受影响的Apache Tomcat服务器上，从而实现远程代码执行。利用方式如下：

1.  **漏洞原理：** 当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`实现）时，服务器允许客户端上传文件。如果对上传的文件名没有进行充分的验证，攻击者就可以上传一个带有JSP扩展名的文件（例如`shell.jsp/`），Tomcat会将该文件视为JSP文件并执行其中的代码。

2.  **POC代码分析：** 提供的Python POC脚本首先尝试使用`OPTIONS`请求获取服务器允许的HTTP方法，并检查`Allow`头是否包含`PUT`。如果支持`PUT`方法，则生成一个随机文件名（带有`.jsp/`扩展名），然后使用`PUT`请求将包含恶意JSP代码的文件上传到服务器。上传的JSP代码包含一个简单的后门，允许攻击者通过`i`参数执行任意系统命令，并通过`pwd`参数进行简单的密码验证。文件上传成功后，脚本会打印出shell的访问URL。

3.  **有效性：** 根据漏洞描述和POC代码的逻辑，POC代码是有效的。如果目标Tomcat服务器满足漏洞条件（Windows + PUT enabled + Tomcat 7.0.0-7.0.79），该POC应该能够成功上传JSP shell并执行命令。

4.  **投毒风险：** 提供的POC代码本身没有明显的投毒行为。恶意代码位于JSP shell的内容中，目的是在目标服务器上执行命令，而不是在攻击者的机器上进行任何恶意操作。因此，投毒风险评估为0%。

5.  **利用方式总结：**
    *   确定目标Tomcat服务器运行在Windows上，并且启用了HTTP PUT方法。
    *   使用POC脚本或其他HTTP客户端发送PUT请求，上传一个包含恶意JSP代码的文件，文件名以`.jsp/`结尾。
    *   通过访问上传的JSP文件（例如，`http://target/random_name.jsp?pwd=023&i=whoami`）来执行任意系统命令。

6.  **搜索结果佐证：** 搜索引擎结果表明，CVE-2017-12615是一个已知被广泛利用的高危漏洞，CISA已知漏洞利用库收录了该漏洞，并建议高优先级修复。同时也存在相关的分析文章，进一步验证了漏洞的有效性和危害性。

**项目地址:** [wsg00d/cve-2017-12615](https://github.com/wsg00d/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #15

**来源**: [CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md](../2017/CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #16

**来源**: [CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md](../2017/CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md)

## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #17

**来源**: [CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md](../2017/CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---



---

## POC #7

**来源**: [CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md](../2017/CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md)

## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #8

**来源**: [CVE-2017-12615-ianxtianxt_CVE-2017-12615.md](../2017/CVE-2017-12615-ianxtianxt_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #9

**来源**: [CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md](../2017/CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并在服务器上执行，可能导致完全控制服务器。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，HTTP PUTs已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615是一个存在于Apache Tomcat 7.0.0到7.0.79版本的远程代码执行漏洞。当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT请求方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以通过构造特殊的请求上传JSP文件到服务器。由于Tomcat对上传的文件名处理不当，攻击者可以通过在文件名后添加斜杠`/`，空格`%20`或者`::$DATA`绕过文件类型检查，最终上传恶意的JSP文件。

**漏洞利用方式：**

1.  **条件判断：** 确认目标Tomcat服务器版本在7.0.0到7.0.79之间，运行在Windows系统上，并且HTTP PUT请求已启用。
2.  **上传JSP文件：** 使用PUT请求上传一个包含恶意代码的JSP文件，文件名需要包含`/`，`%20`或者`::$DATA`等绕过方式。例如，`shell.jsp/`，`shell.jsp%20`或者`shell.jsp::$DATA`。
3.  **执行JSP文件：** 成功上传JSP文件后，通过访问该JSP文件的URL，服务器会执行其中的恶意代码，导致远程代码执行。

**关于投毒风险的分析：**

查看提供的`TomcatScanPro.py`脚本，该脚本的主要功能是漏洞检测和利用，包括CVE-2017-12615漏洞的多种利用方式、CNVD-2020-10487漏洞利用以及弱口令爆破等。主要的投毒风险可能存在于以下几个方面：

*   **恶意WebShell内容：** 脚本在弱口令破解成功后，会尝试上传WebShell，如果WebShell的内容被替换为具有破坏性的代码，可能会对目标系统造成损害。
*   **config.yaml配置文件的恶意修改：** 如果`config.yaml`配置文件被篡改，攻击者可以修改默认的扫描行为，例如指定恶意的文件包含路径或关键字，从而在受害者不知情的情况下执行恶意操作。
*   **WAR包部署的恶意代码：** 脚本支持通过上传WAR包来获取`getshell`，如果WAR包中包含恶意代码，可能会导致更严重的后果。

**投毒风险评估：**

综合考虑以上因素，尽管脚本本身的功能是漏洞检测和利用，但潜在的投毒风险仍然存在。攻击者可以通过修改脚本中的关键配置或替换WebShell内容来达到恶意目的。因此，在使用该脚本时，务必仔细检查脚本的源代码和配置文件，确保其安全性。 这里根据代码功能和描述评估`poison`风险为 10%，主要是因为脚本本身是一个渗透测试工具，其目的是模拟攻击，因此某些操作本身就具有一定的“攻击性”，但从恶意代码植入的角度看，风险较低。


**项目地址:** [lizhianyuguangming/TomcatScanPro](https://github.com/lizhianyuguangming/TomcatScanPro)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #10

**来源**: [CVE-2017-12615-mefulton_cve-2017-12615.md](../2017/CVE-2017-12615-mefulton_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #11

**来源**: [CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md](../2017/CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，启用HTTP PUT，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12615漏洞存在于Apache Tomcat 7.0.0到7.0.79版本中。当Tomcat运行在Windows系统，且启用了HTTP PUT方法（例如，通过设置DefaultServlet的readonly初始化参数为false），攻击者可以通过构造特殊的请求上传JSP文件到服务器。上传的JSP文件随后可以被访问，并执行其中包含的任意代码，从而实现远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且DefaultServlet的`readonly`参数设置为`false`，允许HTTP PUT请求。
2.  **构造JSP Payload：** 创建一个包含恶意代码的JSP文件，例如webshell，用于执行系统命令。
3.  **上传JSP文件：** 使用HTTP PUT方法将JSP文件上传到Tomcat服务器。关键在于文件名后添加`/`，绕过某些安全检查。例如：`curl -v -X PUT "http://localhost:8080/shell.jsp/" -H "Content-Type: text/plain" --data-binary @shell.jsp`。
4.  **执行Payload：** 通过访问上传的JSP文件，传递参数执行恶意代码。例如：`http://localhost:8080/shell.jsp?cmd=id`，执行`id`命令。

**投毒风险分析：**

提供的Dockerfile构建了一个存在CVE-2017-12615漏洞的Tomcat环境，并生成一个包含flag的txt文件。代码本身是漏洞的验证和演示，没有明显的恶意投毒行为。docker-entrypoint.sh 脚本主要功能是生成flag文件，验证Tomcat和Java环境是否正确启动。`webapps/ROOT` 目录被拷贝到容器中，可能包含一些提示信息，引导使用者进行漏洞利用。整体风险较低，主要是为了演示漏洞，而非进行恶意攻击。其中`docker-entrypoint.sh` 脚本的随机值生成可能存在一定的预测性，但并不能完全控制目标系统。

尽管主要目的是漏洞演示，但存在极小的（5%）投毒风险。例如：

*   在`webapps/ROOT`目录下放置看似无害但实际会影响目标系统的JSP文件。
*   虽然`docker-entrypoint.sh`的主要目的是生成flag，但理论上也可以添加一些命令来修改系统配置，虽然目前的代码并没有这么做。生成flag的部分代码可以算作良性的'后门'，方便验证漏洞。


**项目地址:** [netw0rk7/CVE-2017-12615-Home-Lab](https://github.com/netw0rk7/CVE-2017-12615-Home-Lab)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #12

**来源**: [CVE-2017-12615-tpt11fb_AttackTomcat.md](../2017/CVE-2017-12615-tpt11fb_AttackTomcat.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #13

**来源**: [CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md](../2017/CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，并且启用了HTTP PUT方法(readonly 初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且启用了 HTTP PUT 请求方法（例如，通过设置 `readonly` 初始化参数为 `false`）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，并执行其中包含的任意代码，导致远程代码执行。

**漏洞利用方式：**
1.  **检查PUT方法是否启用：** 首先，需要确认目标 Tomcat 服务器是否允许 HTTP PUT 请求。可以通过发送 `OPTIONS` 请求，检查响应头中的 `Allow` 字段是否包含 `PUT`。
2.  **构造恶意JSP文件：** 准备一个包含恶意代码的 JSP 文件。该 JSP 文件可以使用 Java 代码执行任意命令，例如反弹 shell。
3.  **上传JSP文件：** 使用 HTTP PUT 请求将恶意 JSP 文件上传到服务器。文件名需要包含特殊的字符，例如使用时间戳命名然后加/.jsp/绕过文件类型校验。
4.  **执行JSP文件：**  通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。

**代码分析：**
提供的 Go 语言 POC 代码实现了上述漏洞利用过程。该代码首先检查目标服务器是否支持 PUT 请求，然后构造包含恶意代码的 JSP 文件，并使用 PUT 请求将其上传到服务器。上传成功后，返回 Webshell 地址。

**投毒风险：**
代码本身是一个PoC验证程序，主要功能是上传jsp webshell文件。风险较低，但是用户在使用时，可能会替换webshell里的代码，如果webshell代码被替换为恶意代码，则存在被植入恶意代码的风险。因此判定投毒风险为1%。

**项目地址:** [w0x68y/CVE-2017-12615-EXP](https://github.com/w0x68y/CVE-2017-12615-EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #14

**来源**: [CVE-2017-12615-wsg00d_cve-2017-12615.md](../2017/CVE-2017-12615-wsg00d_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许未经授权的攻击者通过上传包含恶意代码的JSP文件到受影响的Apache Tomcat服务器上，从而实现远程代码执行。利用方式如下：

1.  **漏洞原理：** 当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`实现）时，服务器允许客户端上传文件。如果对上传的文件名没有进行充分的验证，攻击者就可以上传一个带有JSP扩展名的文件（例如`shell.jsp/`），Tomcat会将该文件视为JSP文件并执行其中的代码。

2.  **POC代码分析：** 提供的Python POC脚本首先尝试使用`OPTIONS`请求获取服务器允许的HTTP方法，并检查`Allow`头是否包含`PUT`。如果支持`PUT`方法，则生成一个随机文件名（带有`.jsp/`扩展名），然后使用`PUT`请求将包含恶意JSP代码的文件上传到服务器。上传的JSP代码包含一个简单的后门，允许攻击者通过`i`参数执行任意系统命令，并通过`pwd`参数进行简单的密码验证。文件上传成功后，脚本会打印出shell的访问URL。

3.  **有效性：** 根据漏洞描述和POC代码的逻辑，POC代码是有效的。如果目标Tomcat服务器满足漏洞条件（Windows + PUT enabled + Tomcat 7.0.0-7.0.79），该POC应该能够成功上传JSP shell并执行命令。

4.  **投毒风险：** 提供的POC代码本身没有明显的投毒行为。恶意代码位于JSP shell的内容中，目的是在目标服务器上执行命令，而不是在攻击者的机器上进行任何恶意操作。因此，投毒风险评估为0%。

5.  **利用方式总结：**
    *   确定目标Tomcat服务器运行在Windows上，并且启用了HTTP PUT方法。
    *   使用POC脚本或其他HTTP客户端发送PUT请求，上传一个包含恶意JSP代码的文件，文件名以`.jsp/`结尾。
    *   通过访问上传的JSP文件（例如，`http://target/random_name.jsp?pwd=023&i=whoami`）来执行任意系统命令。

6.  **搜索结果佐证：** 搜索引擎结果表明，CVE-2017-12615是一个已知被广泛利用的高危漏洞，CISA已知漏洞利用库收录了该漏洞，并建议高优先级修复。同时也存在相关的分析文章，进一步验证了漏洞的有效性和危害性。

**项目地址:** [wsg00d/cve-2017-12615](https://github.com/wsg00d/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #15

**来源**: [CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md](../2017/CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #16

**来源**: [CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md](../2017/CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md)

## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #17

**来源**: [CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md](../2017/CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---



---

## POC #7

**来源**: [CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md](../2017/CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md)

## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #8

**来源**: [CVE-2017-12615-ianxtianxt_CVE-2017-12615.md](../2017/CVE-2017-12615-ianxtianxt_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #9

**来源**: [CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md](../2017/CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并在服务器上执行，可能导致完全控制服务器。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，HTTP PUTs已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615是一个存在于Apache Tomcat 7.0.0到7.0.79版本的远程代码执行漏洞。当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT请求方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以通过构造特殊的请求上传JSP文件到服务器。由于Tomcat对上传的文件名处理不当，攻击者可以通过在文件名后添加斜杠`/`，空格`%20`或者`::$DATA`绕过文件类型检查，最终上传恶意的JSP文件。

**漏洞利用方式：**

1.  **条件判断：** 确认目标Tomcat服务器版本在7.0.0到7.0.79之间，运行在Windows系统上，并且HTTP PUT请求已启用。
2.  **上传JSP文件：** 使用PUT请求上传一个包含恶意代码的JSP文件，文件名需要包含`/`，`%20`或者`::$DATA`等绕过方式。例如，`shell.jsp/`，`shell.jsp%20`或者`shell.jsp::$DATA`。
3.  **执行JSP文件：** 成功上传JSP文件后，通过访问该JSP文件的URL，服务器会执行其中的恶意代码，导致远程代码执行。

**关于投毒风险的分析：**

查看提供的`TomcatScanPro.py`脚本，该脚本的主要功能是漏洞检测和利用，包括CVE-2017-12615漏洞的多种利用方式、CNVD-2020-10487漏洞利用以及弱口令爆破等。主要的投毒风险可能存在于以下几个方面：

*   **恶意WebShell内容：** 脚本在弱口令破解成功后，会尝试上传WebShell，如果WebShell的内容被替换为具有破坏性的代码，可能会对目标系统造成损害。
*   **config.yaml配置文件的恶意修改：** 如果`config.yaml`配置文件被篡改，攻击者可以修改默认的扫描行为，例如指定恶意的文件包含路径或关键字，从而在受害者不知情的情况下执行恶意操作。
*   **WAR包部署的恶意代码：** 脚本支持通过上传WAR包来获取`getshell`，如果WAR包中包含恶意代码，可能会导致更严重的后果。

**投毒风险评估：**

综合考虑以上因素，尽管脚本本身的功能是漏洞检测和利用，但潜在的投毒风险仍然存在。攻击者可以通过修改脚本中的关键配置或替换WebShell内容来达到恶意目的。因此，在使用该脚本时，务必仔细检查脚本的源代码和配置文件，确保其安全性。 这里根据代码功能和描述评估`poison`风险为 10%，主要是因为脚本本身是一个渗透测试工具，其目的是模拟攻击，因此某些操作本身就具有一定的“攻击性”，但从恶意代码植入的角度看，风险较低。


**项目地址:** [lizhianyuguangming/TomcatScanPro](https://github.com/lizhianyuguangming/TomcatScanPro)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #10

**来源**: [CVE-2017-12615-mefulton_cve-2017-12615.md](../2017/CVE-2017-12615-mefulton_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #11

**来源**: [CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md](../2017/CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，启用HTTP PUT，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12615漏洞存在于Apache Tomcat 7.0.0到7.0.79版本中。当Tomcat运行在Windows系统，且启用了HTTP PUT方法（例如，通过设置DefaultServlet的readonly初始化参数为false），攻击者可以通过构造特殊的请求上传JSP文件到服务器。上传的JSP文件随后可以被访问，并执行其中包含的任意代码，从而实现远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且DefaultServlet的`readonly`参数设置为`false`，允许HTTP PUT请求。
2.  **构造JSP Payload：** 创建一个包含恶意代码的JSP文件，例如webshell，用于执行系统命令。
3.  **上传JSP文件：** 使用HTTP PUT方法将JSP文件上传到Tomcat服务器。关键在于文件名后添加`/`，绕过某些安全检查。例如：`curl -v -X PUT "http://localhost:8080/shell.jsp/" -H "Content-Type: text/plain" --data-binary @shell.jsp`。
4.  **执行Payload：** 通过访问上传的JSP文件，传递参数执行恶意代码。例如：`http://localhost:8080/shell.jsp?cmd=id`，执行`id`命令。

**投毒风险分析：**

提供的Dockerfile构建了一个存在CVE-2017-12615漏洞的Tomcat环境，并生成一个包含flag的txt文件。代码本身是漏洞的验证和演示，没有明显的恶意投毒行为。docker-entrypoint.sh 脚本主要功能是生成flag文件，验证Tomcat和Java环境是否正确启动。`webapps/ROOT` 目录被拷贝到容器中，可能包含一些提示信息，引导使用者进行漏洞利用。整体风险较低，主要是为了演示漏洞，而非进行恶意攻击。其中`docker-entrypoint.sh` 脚本的随机值生成可能存在一定的预测性，但并不能完全控制目标系统。

尽管主要目的是漏洞演示，但存在极小的（5%）投毒风险。例如：

*   在`webapps/ROOT`目录下放置看似无害但实际会影响目标系统的JSP文件。
*   虽然`docker-entrypoint.sh`的主要目的是生成flag，但理论上也可以添加一些命令来修改系统配置，虽然目前的代码并没有这么做。生成flag的部分代码可以算作良性的'后门'，方便验证漏洞。


**项目地址:** [netw0rk7/CVE-2017-12615-Home-Lab](https://github.com/netw0rk7/CVE-2017-12615-Home-Lab)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #12

**来源**: [CVE-2017-12615-tpt11fb_AttackTomcat.md](../2017/CVE-2017-12615-tpt11fb_AttackTomcat.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #13

**来源**: [CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md](../2017/CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，并且启用了HTTP PUT方法(readonly 初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且启用了 HTTP PUT 请求方法（例如，通过设置 `readonly` 初始化参数为 `false`）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，并执行其中包含的任意代码，导致远程代码执行。

**漏洞利用方式：**
1.  **检查PUT方法是否启用：** 首先，需要确认目标 Tomcat 服务器是否允许 HTTP PUT 请求。可以通过发送 `OPTIONS` 请求，检查响应头中的 `Allow` 字段是否包含 `PUT`。
2.  **构造恶意JSP文件：** 准备一个包含恶意代码的 JSP 文件。该 JSP 文件可以使用 Java 代码执行任意命令，例如反弹 shell。
3.  **上传JSP文件：** 使用 HTTP PUT 请求将恶意 JSP 文件上传到服务器。文件名需要包含特殊的字符，例如使用时间戳命名然后加/.jsp/绕过文件类型校验。
4.  **执行JSP文件：**  通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。

**代码分析：**
提供的 Go 语言 POC 代码实现了上述漏洞利用过程。该代码首先检查目标服务器是否支持 PUT 请求，然后构造包含恶意代码的 JSP 文件，并使用 PUT 请求将其上传到服务器。上传成功后，返回 Webshell 地址。

**投毒风险：**
代码本身是一个PoC验证程序，主要功能是上传jsp webshell文件。风险较低，但是用户在使用时，可能会替换webshell里的代码，如果webshell代码被替换为恶意代码，则存在被植入恶意代码的风险。因此判定投毒风险为1%。

**项目地址:** [w0x68y/CVE-2017-12615-EXP](https://github.com/w0x68y/CVE-2017-12615-EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #14

**来源**: [CVE-2017-12615-wsg00d_cve-2017-12615.md](../2017/CVE-2017-12615-wsg00d_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许未经授权的攻击者通过上传包含恶意代码的JSP文件到受影响的Apache Tomcat服务器上，从而实现远程代码执行。利用方式如下：

1.  **漏洞原理：** 当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`实现）时，服务器允许客户端上传文件。如果对上传的文件名没有进行充分的验证，攻击者就可以上传一个带有JSP扩展名的文件（例如`shell.jsp/`），Tomcat会将该文件视为JSP文件并执行其中的代码。

2.  **POC代码分析：** 提供的Python POC脚本首先尝试使用`OPTIONS`请求获取服务器允许的HTTP方法，并检查`Allow`头是否包含`PUT`。如果支持`PUT`方法，则生成一个随机文件名（带有`.jsp/`扩展名），然后使用`PUT`请求将包含恶意JSP代码的文件上传到服务器。上传的JSP代码包含一个简单的后门，允许攻击者通过`i`参数执行任意系统命令，并通过`pwd`参数进行简单的密码验证。文件上传成功后，脚本会打印出shell的访问URL。

3.  **有效性：** 根据漏洞描述和POC代码的逻辑，POC代码是有效的。如果目标Tomcat服务器满足漏洞条件（Windows + PUT enabled + Tomcat 7.0.0-7.0.79），该POC应该能够成功上传JSP shell并执行命令。

4.  **投毒风险：** 提供的POC代码本身没有明显的投毒行为。恶意代码位于JSP shell的内容中，目的是在目标服务器上执行命令，而不是在攻击者的机器上进行任何恶意操作。因此，投毒风险评估为0%。

5.  **利用方式总结：**
    *   确定目标Tomcat服务器运行在Windows上，并且启用了HTTP PUT方法。
    *   使用POC脚本或其他HTTP客户端发送PUT请求，上传一个包含恶意JSP代码的文件，文件名以`.jsp/`结尾。
    *   通过访问上传的JSP文件（例如，`http://target/random_name.jsp?pwd=023&i=whoami`）来执行任意系统命令。

6.  **搜索结果佐证：** 搜索引擎结果表明，CVE-2017-12615是一个已知被广泛利用的高危漏洞，CISA已知漏洞利用库收录了该漏洞，并建议高优先级修复。同时也存在相关的分析文章，进一步验证了漏洞的有效性和危害性。

**项目地址:** [wsg00d/cve-2017-12615](https://github.com/wsg00d/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #15

**来源**: [CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md](../2017/CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #16

**来源**: [CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md](../2017/CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md)

## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #17

**来源**: [CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md](../2017/CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---



---

## POC #7

**来源**: [CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md](../2017/CVE-2017-12615-edyekomu_CVE-2017-12615-PoC.md)

## CVE-2017-12615-Apache Tomcat Windows RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT请求启用(readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于Apache Tomcat 7.0.0 到 7.0.79版本，当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以利用此漏洞。

**利用方式：**
1.  **上传JSP文件：** 攻击者构造一个特制的HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器上。
2.  **利用双后缀绕过：** 如果服务器对上传的文件类型有检查，攻击者可以通过使用双后缀名（例如`test.jsp.`或者`test.jsp%20`）来绕过这些检查。
3.  **执行恶意代码：** 上传成功后，攻击者可以通过访问上传的JSP文件，触发服务器执行其中的恶意代码，从而获得服务器的控制权。

**有效性：**
提供的POC代码看起来是有效的。它包含一个Dockerfile，用于构建一个包含漏洞Tomcat版本的Docker镜像，并将`readonly`参数设置为`false`。`docker-compose.yml`文件简化了环境设置。README提供了环境搭建和漏洞利用的明确步骤，并指出了此漏洞出现的必要条件。

**投毒风险：**
仔细检查了Dockerfile，`docker-compose.yml`，`web.xml`和`README.md`，未发现任何明显的恶意代码。Dockerfile中只是指定了Tomcat的版本和配置。`web.xml`文件用于设置`readonly`参数，允许PUT请求。因此，该POC的投毒风险较低。考虑到作者声明仅为学习和教育目的，且代码内容较为直接，投毒风险评估为0%。

**总结：**
该漏洞允许未经授权的用户上传JSP文件并在服务器上执行，从而实现远程代码执行。POC代码提供了可重复且易于使用的环境，使研究人员能够理解和测试此漏洞。

**项目地址:** [edyekomu/CVE-2017-12615-PoC](https://github.com/edyekomu/CVE-2017-12615-PoC)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #8

**来源**: [CVE-2017-12615-ianxtianxt_CVE-2017-12615.md](../2017/CVE-2017-12615-ianxtianxt_CVE-2017-12615.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #9

**来源**: [CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md](../2017/CVE-2017-12615-lizhianyuguangming_TomcatScanPro.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并在服务器上执行，可能导致完全控制服务器。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上的Apache Tomcat 7.0.0 to 7.0.79，HTTP PUTs已启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615是一个存在于Apache Tomcat 7.0.0到7.0.79版本的远程代码执行漏洞。当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT请求方法（通常通过设置`readonly`初始化参数为`false`来实现）时，攻击者可以通过构造特殊的请求上传JSP文件到服务器。由于Tomcat对上传的文件名处理不当，攻击者可以通过在文件名后添加斜杠`/`，空格`%20`或者`::$DATA`绕过文件类型检查，最终上传恶意的JSP文件。

**漏洞利用方式：**

1.  **条件判断：** 确认目标Tomcat服务器版本在7.0.0到7.0.79之间，运行在Windows系统上，并且HTTP PUT请求已启用。
2.  **上传JSP文件：** 使用PUT请求上传一个包含恶意代码的JSP文件，文件名需要包含`/`，`%20`或者`::$DATA`等绕过方式。例如，`shell.jsp/`，`shell.jsp%20`或者`shell.jsp::$DATA`。
3.  **执行JSP文件：** 成功上传JSP文件后，通过访问该JSP文件的URL，服务器会执行其中的恶意代码，导致远程代码执行。

**关于投毒风险的分析：**

查看提供的`TomcatScanPro.py`脚本，该脚本的主要功能是漏洞检测和利用，包括CVE-2017-12615漏洞的多种利用方式、CNVD-2020-10487漏洞利用以及弱口令爆破等。主要的投毒风险可能存在于以下几个方面：

*   **恶意WebShell内容：** 脚本在弱口令破解成功后，会尝试上传WebShell，如果WebShell的内容被替换为具有破坏性的代码，可能会对目标系统造成损害。
*   **config.yaml配置文件的恶意修改：** 如果`config.yaml`配置文件被篡改，攻击者可以修改默认的扫描行为，例如指定恶意的文件包含路径或关键字，从而在受害者不知情的情况下执行恶意操作。
*   **WAR包部署的恶意代码：** 脚本支持通过上传WAR包来获取`getshell`，如果WAR包中包含恶意代码，可能会导致更严重的后果。

**投毒风险评估：**

综合考虑以上因素，尽管脚本本身的功能是漏洞检测和利用，但潜在的投毒风险仍然存在。攻击者可以通过修改脚本中的关键配置或替换WebShell内容来达到恶意目的。因此，在使用该脚本时，务必仔细检查脚本的源代码和配置文件，确保其安全性。 这里根据代码功能和描述评估`poison`风险为 10%，主要是因为脚本本身是一个渗透测试工具，其目的是模拟攻击，因此某些操作本身就具有一定的“攻击性”，但从恶意代码植入的角度看，风险较低。


**项目地址:** [lizhianyuguangming/TomcatScanPro](https://github.com/lizhianyuguangming/TomcatScanPro)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #10

**来源**: [CVE-2017-12615-mefulton_cve-2017-12615.md](../2017/CVE-2017-12615-mefulton_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT请求已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器。由于Tomcat配置不当，允许PUT请求并且未对上传的文件类型进行严格的校验，导致攻击者可以绕过限制上传JSP文件。上传的JSP文件会被Tomcat服务器解析执行，从而导致远程代码执行。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的，并且存在公开的漏洞利用代码。提供的POC代码（tomcatexploit.py）利用了Tomcat 7.0.0-7.0.79版本中的文件类型扩展名绕过漏洞。该POC需要目标系统启用PUT请求，并且运行在Windows系统上。成功利用后，攻击者可以上传任意JSP文件，并在服务器上执行。

**投毒风险：** 检查提供的POC代码（tomcatexploit.py）发现，该脚本的主要功能是发送HTTP PUT请求来上传JSP文件。代码中没有发现任何隐藏的或恶意的代码逻辑，例如反弹shell、下载恶意文件等。因此，该POC代码本身不包含投毒代码的风险。投毒风险评估为0%。

**利用方式：**
1.  **条件判断:** 确认目标Tomcat服务器运行在Windows系统上，并且启用了HTTP PUT请求方法。
2.  **构造请求:** 使用POC代码（tomcatexploit.py）或类似的工具，指定目标IP地址、端口、本地JSP文件路径和远程文件名。
3.  **上传JSP:** POC代码将读取本地JSP文件内容，并通过HTTP PUT请求上传到目标服务器。
4.  **触发执行:** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**缓解措施：**
*   升级到Tomcat 7.0.80或更高版本。
*   禁用HTTP PUT请求方法，或者配置严格的文件类型校验规则。
*   限制对Web应用程序目录的写入权限。

**项目地址:** [mefulton/cve-2017-12615](https://github.com/mefulton/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #11

**来源**: [CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md](../2017/CVE-2017-12615-netw0rk7_CVE-2017-12615-Home-Lab.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，启用HTTP PUT，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12615漏洞存在于Apache Tomcat 7.0.0到7.0.79版本中。当Tomcat运行在Windows系统，且启用了HTTP PUT方法（例如，通过设置DefaultServlet的readonly初始化参数为false），攻击者可以通过构造特殊的请求上传JSP文件到服务器。上传的JSP文件随后可以被访问，并执行其中包含的任意代码，从而实现远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且DefaultServlet的`readonly`参数设置为`false`，允许HTTP PUT请求。
2.  **构造JSP Payload：** 创建一个包含恶意代码的JSP文件，例如webshell，用于执行系统命令。
3.  **上传JSP文件：** 使用HTTP PUT方法将JSP文件上传到Tomcat服务器。关键在于文件名后添加`/`，绕过某些安全检查。例如：`curl -v -X PUT "http://localhost:8080/shell.jsp/" -H "Content-Type: text/plain" --data-binary @shell.jsp`。
4.  **执行Payload：** 通过访问上传的JSP文件，传递参数执行恶意代码。例如：`http://localhost:8080/shell.jsp?cmd=id`，执行`id`命令。

**投毒风险分析：**

提供的Dockerfile构建了一个存在CVE-2017-12615漏洞的Tomcat环境，并生成一个包含flag的txt文件。代码本身是漏洞的验证和演示，没有明显的恶意投毒行为。docker-entrypoint.sh 脚本主要功能是生成flag文件，验证Tomcat和Java环境是否正确启动。`webapps/ROOT` 目录被拷贝到容器中，可能包含一些提示信息，引导使用者进行漏洞利用。整体风险较低，主要是为了演示漏洞，而非进行恶意攻击。其中`docker-entrypoint.sh` 脚本的随机值生成可能存在一定的预测性，但并不能完全控制目标系统。

尽管主要目的是漏洞演示，但存在极小的（5%）投毒风险。例如：

*   在`webapps/ROOT`目录下放置看似无害但实际会影响目标系统的JSP文件。
*   虽然`docker-entrypoint.sh`的主要目的是生成flag，但理论上也可以添加一些命令来修改系统配置，虽然目前的代码并没有这么做。生成flag的部分代码可以算作良性的'后门'，方便验证漏洞。


**项目地址:** [netw0rk7/CVE-2017-12615-Home-Lab](https://github.com/netw0rk7/CVE-2017-12615-Home-Lab)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #12

**来源**: [CVE-2017-12615-tpt11fb_AttackTomcat.md](../2017/CVE-2017-12615-tpt11fb_AttackTomcat.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #13

**来源**: [CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md](../2017/CVE-2017-12615-w0x68y_CVE-2017-12615-EXP.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，并且启用了HTTP PUT方法(readonly 初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且启用了 HTTP PUT 请求方法（例如，通过设置 `readonly` 初始化参数为 `false`）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，并执行其中包含的任意代码，导致远程代码执行。

**漏洞利用方式：**
1.  **检查PUT方法是否启用：** 首先，需要确认目标 Tomcat 服务器是否允许 HTTP PUT 请求。可以通过发送 `OPTIONS` 请求，检查响应头中的 `Allow` 字段是否包含 `PUT`。
2.  **构造恶意JSP文件：** 准备一个包含恶意代码的 JSP 文件。该 JSP 文件可以使用 Java 代码执行任意命令，例如反弹 shell。
3.  **上传JSP文件：** 使用 HTTP PUT 请求将恶意 JSP 文件上传到服务器。文件名需要包含特殊的字符，例如使用时间戳命名然后加/.jsp/绕过文件类型校验。
4.  **执行JSP文件：**  通过 Web 浏览器访问上传的 JSP 文件，触发恶意代码的执行，从而实现远程代码执行。

**代码分析：**
提供的 Go 语言 POC 代码实现了上述漏洞利用过程。该代码首先检查目标服务器是否支持 PUT 请求，然后构造包含恶意代码的 JSP 文件，并使用 PUT 请求将其上传到服务器。上传成功后，返回 Webshell 地址。

**投毒风险：**
代码本身是一个PoC验证程序，主要功能是上传jsp webshell文件。风险较低，但是用户在使用时，可能会替换webshell里的代码，如果webshell代码被替换为恶意代码，则存在被植入恶意代码的风险。因此判定投毒风险为1%。

**项目地址:** [w0x68y/CVE-2017-12615-EXP](https://github.com/w0x68y/CVE-2017-12615-EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #14

**来源**: [CVE-2017-12615-wsg00d_cve-2017-12615.md](../2017/CVE-2017-12615-wsg00d_cve-2017-12615.md)

## CVE-2017-12615 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法启用（readonly初始化参数设置为false）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许未经授权的攻击者通过上传包含恶意代码的JSP文件到受影响的Apache Tomcat服务器上，从而实现远程代码执行。利用方式如下：

1.  **漏洞原理：** 当Tomcat运行在Windows操作系统上，并且启用了HTTP PUT方法（通常通过设置`readonly`初始化参数为`false`实现）时，服务器允许客户端上传文件。如果对上传的文件名没有进行充分的验证，攻击者就可以上传一个带有JSP扩展名的文件（例如`shell.jsp/`），Tomcat会将该文件视为JSP文件并执行其中的代码。

2.  **POC代码分析：** 提供的Python POC脚本首先尝试使用`OPTIONS`请求获取服务器允许的HTTP方法，并检查`Allow`头是否包含`PUT`。如果支持`PUT`方法，则生成一个随机文件名（带有`.jsp/`扩展名），然后使用`PUT`请求将包含恶意JSP代码的文件上传到服务器。上传的JSP代码包含一个简单的后门，允许攻击者通过`i`参数执行任意系统命令，并通过`pwd`参数进行简单的密码验证。文件上传成功后，脚本会打印出shell的访问URL。

3.  **有效性：** 根据漏洞描述和POC代码的逻辑，POC代码是有效的。如果目标Tomcat服务器满足漏洞条件（Windows + PUT enabled + Tomcat 7.0.0-7.0.79），该POC应该能够成功上传JSP shell并执行命令。

4.  **投毒风险：** 提供的POC代码本身没有明显的投毒行为。恶意代码位于JSP shell的内容中，目的是在目标服务器上执行命令，而不是在攻击者的机器上进行任何恶意操作。因此，投毒风险评估为0%。

5.  **利用方式总结：**
    *   确定目标Tomcat服务器运行在Windows上，并且启用了HTTP PUT方法。
    *   使用POC脚本或其他HTTP客户端发送PUT请求，上传一个包含恶意JSP代码的文件，文件名以`.jsp/`结尾。
    *   通过访问上传的JSP文件（例如，`http://target/random_name.jsp?pwd=023&i=whoami`）来执行任意系统命令。

6.  **搜索结果佐证：** 搜索引擎结果表明，CVE-2017-12615是一个已知被广泛利用的高危漏洞，CISA已知漏洞利用库收录了该漏洞，并建议高优先级修复。同时也存在相关的分析文章，进一步验证了漏洞的有效性和危害性。

**项目地址:** [wsg00d/cve-2017-12615](https://github.com/wsg00d/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #15

**来源**: [CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md](../2017/CVE-2017-12615-wudidwo_CVE-2017-12615-poc.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #16

**来源**: [CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md](../2017/CVE-2017-12615-xiaokp7_Tomcat_PUT_GUI_EXP.md)

## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

## POC #17

**来源**: [CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md](../2017/CVE-2017-12615-zi0Black_POC-CVE-2017-12615-or-CVE-2017-12717.md)

## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)

---

