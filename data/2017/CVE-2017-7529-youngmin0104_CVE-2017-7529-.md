## CVE-2017-7529 - Nginx 信息泄露

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 信息泄露

**影响应用:** Nginx

**危害等级:** 高

**CVSS评分:** 7.5 (根据搜索结果综合判断)

**影响版本:** Nginx 1.13.2 及之前版本

**利用条件:** 无需认证，通过发送特制的HTTP Range请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2017-7529是Nginx中的一个越界读取缓存漏洞，存在于range filter中。攻击者可以通过构造包含特殊range的HTTP头部的恶意请求来触发该漏洞，导致服务器返回缓存中不应被访问的内存数据，从而泄露敏感信息。该漏洞是由于在处理HTTP Range头部时，整数溢出漏洞，导致计算错误，从而读取了超出预期范围的内存区域。

POC有效性分析：
提供的POC代码包括Dockerfile、docker-compose.yml、nginx.conf、index.html和README.md，以及poc.py。这些文件共同构成了一个完整的可复现漏洞环境。docker-compose.yml用于快速启动包含漏洞版本的Nginx服务器。README.md文件详细描述了漏洞原理、利用方法和修复建议。poc.py是一个Python脚本，用于自动检测和利用该漏洞，发送特制的Range请求并验证漏洞是否存在，如果存在则提取部分泄露的数据。通过执行curl命令`curl -v -H "Range: bytes=-9223372036854,5" http://your-ip:8080/`或者运行poc.py脚本，可以验证目标服务器是否存在此漏洞。如果服务器返回206状态码，并且响应体中包含不应该泄露的数据，则表明漏洞存在，POC有效。

利用步骤：
1. 搭建漏洞环境：使用提供的Dockerfile和docker-compose.yml在本地或者服务器上启动一个存在漏洞的Nginx实例。
2. 发送恶意请求：使用curl命令或者poc.py脚本向目标服务器发送包含特定Range头部的HTTP请求。
3. 分析响应：检查服务器的响应状态码是否为206，以及响应体中是否包含预期之外的数据。
4. 提取敏感信息：如果漏洞存在，可以尝试修改Range头部，提取更多敏感信息。

投毒风险分析：
该POC的投毒风险较低，主要原因如下：
1. 代码清晰：提供的Python脚本（poc.py）代码结构清晰，主要使用了requests库发送HTTP请求，没有发现任何恶意代码或后门。
2. 标准库：脚本只使用了Python的标准库和requests库，没有依赖任何第三方的高风险库。
3. 无可疑行为：脚本的功能单一，只负责发送特定的HTTP请求并分析响应，没有进行任何文件操作、系统调用或者网络扫描等可疑行为。
4. Dockerfile和docker-compose.yml文件也只用于搭建漏洞环境，没有包含任何恶意配置或操作。
5. README.md文件主要用于描述漏洞原理和利用方法，没有包含任何恶意链接或代码。
虽然投毒风险较低，但仍然需要注意以下几点：
1. 在生产环境中，不要直接使用未经审核的POC代码。
2. 在搭建漏洞环境时，尽量使用隔离的网络环境，避免对生产环境造成影响。
3. 定期检查服务器的安全日志，及时发现和处理异常行为。

**项目地址:** https://github.com/liusec/CVE-2017-7529

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2017-7529
