## CVE-2017-7529 - Nginx Integer Overflow

**漏洞编号:** CVE-2017-7529

**漏洞类型:** Integer Overflow

**影响应用:** Nginx

**危害等级:** High

**CVSS评分:** 7.5

**影响版本:** Nginx versions before 1.13.3

**利用条件:** Requires network access to a server utilizing Nginx and the ability to send crafted HTTP requests. No authentication is needed.

**POC 可用性:** 8/10

**POC 类型:** Complete Exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2017-7529 is an integer overflow vulnerability in the range filter of Nginx. This vulnerability allows an attacker to potentially read sensitive information from the Nginx cache by crafting a malicious HTTP request with a specially constructed Range header. The vulnerability occurs because the range filter does not properly handle large or negative range values, leading to an integer overflow that can cause Nginx to read data beyond the intended buffer. 

The provided POC code demonstrates the vulnerability by sending a crafted HTTP request with a Range header that triggers the integer overflow. The script takes a target URL as input and constructs a Range header with large negative values. Upon receiving this request, a vulnerable Nginx server may return cached content from other requests, potentially exposing sensitive information such as API keys, session tokens, or other confidential data. The script verifies the vulnerability by checking the HTTP response status code and examining the 'Content-Range' header and the response body. If the status code is 206 (Partial Content) and the response body contains the 'Content-Range' header, the script identifies the target as vulnerable. The script then prints the HTTP headers and the response body, demonstrating the successful exploitation of the vulnerability.

**Exploitation steps:**

1.  Run the provided python script `POC_CVE-2017-7529.py` with the target URL as an argument.
2.  The script crafts a malicious HTTP request with a Range header containing large negative values designed to trigger an integer overflow.
3.  The script sends the crafted request to the target Nginx server.
4.  The script analyzes the response to determine if the vulnerability is present. Specifically, it checks for a 206 status code and the presence of the 'Content-Range' header in the response.
5.  If the vulnerability is confirmed, the script prints the HTTP headers and the content of the response, showcasing the potential leakage of sensitive information.

**投毒风险分析:**

The provided POC has a low poisoning risk for the following reasons:

1.  **Clear Code:** The code is written in a straightforward manner, primarily using the `requests` library to send HTTP requests and standard logging for output. There are no obfuscated or intentionally misleading sections.
2.  **No External Dependencies:** The script relies only on the `requests` library, a common and trusted Python package for handling HTTP requests. It does not include any calls to external scripts or download any additional resources from the internet.
3.  **Benign Actions:** The script's primary purpose is to demonstrate a vulnerability by sending a specially crafted HTTP request and analyzing the response. It does not attempt to modify any system files, install any malicious software, or perform any other actions that could harm the target system.
4.  **Limited Scope:** The script's functionality is limited to sending HTTP requests and printing the response. It does not attempt to escalate privileges, gain unauthorized access, or perform any other malicious activities.
5.  **No Code Injection:** The script doesn't use any dynamic code execution functions (like `eval` or `exec`) which could be exploited to inject malicious code. All executed code is present within the original script.
6. The curl command generated by the script, while potentially containing sensitive information if the exploit is successful, is printed to standard output and not executed directly by the script. Thus, it does not pose an additional poisoning risk. The risk is therefore low, approximately 10%.

**项目地址:** https://github.com/liusec/CVE-2017-7529

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2017-7529
