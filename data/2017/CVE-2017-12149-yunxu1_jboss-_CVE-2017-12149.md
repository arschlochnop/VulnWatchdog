## CVE-2017-12149 - JBoss Application Server RCE (远程代码执行)

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE (远程代码执行)

**影响应用:** JBoss Application Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** JBoss AS 5.x / 6.x

**利用条件:** 目标系统开启了HttpInvoker组件，且未对外部输入的序列化对象进行过滤，通常监听在8080端口的/invoker/ReadOnlyAccessFilter接口。

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2017-12149是一个存在于Red Hat JBoss Application Server 5.x和6.x版本中的高危反序列化漏洞。该漏洞源于JBoss的HttpInvoker组件在处理包含恶意的序列化对象的HTTP请求时，未能进行有效的过滤和校验。攻击者可以通过发送特定的POST请求到受影响的端点（如/invoker/ReadOnlyAccessFilter），将精心构造的恶意Java对象注入到服务器中。当服务器尝试对这些对象进行反序列化时，会触发预设的恶意代码执行，从而允许攻击者在服务器上下文执行任意系统命令。该漏洞的根源在于Java原生反序列化机制的滥用，结合了公共库（如Apache Commons Collections）中的‘Gadget Chains’，使得原本用于数据传输的接口变成了攻击入口。在本POC分析中，该工具采用了封装好的.jar文件形式，通过命令行接收目标URL。其内部逻辑是构造一个针对JBoss特定接口的序列化Payload，通过HTTP POST方法发送。如果目标系统存在漏洞，Payload执行后会返回特定的特征字符串（如poc中的vuln6581...jboss），从而验证漏洞的存在性。这种验证方式直接且有效，具备极高的实战参考价值。对于防御方而言，该漏洞的修复建议通常是升级到受支持的版本，或者直接删除、限制对HttpInvoker组件的访问。\n\n关于投毒风险分析，本POC主要以编译后的JAR包和README文档形式存在。在安全性审查中，此类经过编译的可执行文件（.jar）相比于纯文本脚本具有更高的黑盒属性。虽然README显示的用法是合法的漏洞验证过程，但由于JAR包内包含Apache Commons Collections等复杂类库，且无法直接审阅底层源码，存在被二次打包并植入恶意逻辑的可能性。投毒者可能会修改Payload生成的逻辑，使其在攻击目标系统的同时，也向攻击者的机器反向建立连接（反弹Shell），或者在本地运行环境下窃取环境变量和开发者的凭证。目前的输入数据中，POC代码结构中包含了标准的Apache开源协议文件和README，表现出较强的伪装性。分析显示，风险点主要集中在verify_CVE-2017-12149.jar这一二进制文件上，而非明文脚本。在使用此类工具时，必须在完全隔离的沙箱环境中运行，并监控其网络流量，防止其产生非预期的外连请求。总体投毒风险评估为15%，属于较低水平，主要风险来源于二进制文件的不可见性，而非已发现的显性恶意行为。建议防御研究人员使用反编译工具（如jd-gui）对JAR包进行静态扫描后再行测试。

**项目地址:** [https://github.com/vulnhub/jboss-_CVE-2017-12149](https://www.google.com/search?q=https://github.com/vulnhub/jboss-_CVE-2017-12149) (推测地址)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
