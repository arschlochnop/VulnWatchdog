## CVE-2017-12149 - Red Hat JBoss Application Server RCE/反序列化漏洞

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE/反序列化漏洞

**影响应用:** Red Hat JBoss Application Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** JBoss AS 5.x, 6.x

**利用条件:** 通过网络访问JBoss应用服务器的ReadOnlyAccessFilter组件，通常位于/invoker/readonly路径。

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞源于JBoss AS 5.x和6.x中ReadOnlyAccessFilter组件对用户提供的序列化对象缺乏过滤。攻击者可以通过向/invoker/readonly接口发送精心构造的HTTP POST请求，利用Java反序列化机制执行任意命令。提供的POC代码包含一个名为'verify_CVE-2017-12149.jar'的可执行文件及部分Apache Commons Collections库代码。经分析，该验证脚本通过向目标URL发送包含预定义载荷的序列化对象，若服务器返回特定的特征字符串'vuln6581362514513155613jboss'，则证明漏洞存在。利用步骤如下：1. 确认目标JBoss服务器版本及/invoker/readonly路径是否可访问；2. 使用Java环境运行该JAR包，格式为'java -jar verify_CVE-2017-12149.jar [URL]'；3. 观察控制台输出，确认是否触发成功。此利用链非常成熟，攻击门槛极低，只需单一POST请求即可完成漏洞探测。 投毒风险分析：该POC项目包含了编译好的二进制文件（JAR包）以及大量混杂的第三方库代码（如Commons Collections）。投毒风险主要集中在以下几点：首先，直接提供编译好的JAR包而非源代码增加了静态审计的难度，恶意开发者可能在JAR包中植入窃取凭据或建立持久性后门的逻辑。其次，README中展示的返回结果'vuln6581362514513155613'虽然看起来是随机字符串，但需要警惕其是否为隐藏的通信协议指令。然而，从目前的公开搜索结果和文件结构看，该POC更像是安全研究人员整合的测试工具。由于JAR文件具有执行任意本地代码的能力，建议在隔离环境（沙箱）中使用。项目的Apache Commons Collections目录部分虽然是标准的开源库文件，但这种将大量库代码与扫描器混放的做法常见于某些恶意软件的伪装手段，需防范依赖投毒或DLL/Jar劫持风险。

**项目地址:** [https://github.com/vulnwatchdog/jboss-_CVE-2017-12149](https://www.google.com/search?q=https://github.com/vulnwatchdog/jboss-_CVE-2017-12149)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
