## CVE-2017-7529 - Nginx 信息泄露

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 信息泄露

**影响应用:** Nginx

**危害等级:** 中

**CVSS评分:** 7.5

**影响版本:** 0.5.6 to 1.13.2

**利用条件:** 需要网络访问，目标服务器开启缓存。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2017-7529 是 Nginx 范围过滤器模块中的整数溢出漏洞，允许攻击者通过构造恶意 Range 请求头，越界读取缓存中的敏感信息。该漏洞存在于 Nginx 0.5.6 到 1.13.2 版本中。

POC有效性分析：
提供的POC代码（CVE-2017-7529_PoC.py）是一个完整的漏洞利用程序，它利用精心构造的HTTP Range头来触发整数溢出。POC首先检查目标URL是否存在Content-Length头，如果存在则从中计算所需参数，然后发送包含恶意Range头的请求。通过检查响应状态码是否为206以及响应文本中是否存在“Content-Range”，来判断目标是否易受攻击。如果判断为易受攻击，它会重复发送请求，并将响应内容存储在缓冲区中，最终以十六进制转储形式输出泄露的数据。代码中包含 hexdump 函数，可用于直观地查看泄露的内存内容。

利用步骤：
1. 确保目标 Nginx 服务器版本在 0.5.6 到 1.13.2 之间，并且启用了缓存功能。
2. 使用提供的 POC 脚本（CVE-2017-7529_PoC.py）指定目标 URL 作为参数运行。
3. 脚本将自动检测目标是否易受攻击，如果易受攻击，则会发送恶意请求并显示泄露的内存内容。
4. 分析泄露的内存内容，查找敏感信息，例如会话 cookie、API 密钥或其他敏感数据。

投毒风险分析：
此POC的投毒风险较低。该脚本主要使用标准 Python 库（urllib.parse、requests、argparse、colorama、termcolor），没有执行任何潜在的恶意操作，例如写入文件、执行系统命令或连接到外部服务器。代码结构清晰，易于理解，没有发现任何混淆或隐藏的恶意代码。该脚本的目的是读取服务器缓存中的数据，而不是修改或破坏服务器。脚本中对 colorama 和 termcolor 库的依赖是为了提供彩色输出，这不会引入任何安全风险。此外，该脚本在接收到键盘中断信号时会优雅地退出，避免了潜在的资源泄漏或崩溃。
综合来看，此POC的投毒风险较低，可以安全地用于漏洞验证和研究。

**项目地址:** https://github.com/liusec/CVE-2017-7529

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2017-7529
