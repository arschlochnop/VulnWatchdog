## CVE-2017-7529 - Nginx 信息泄露

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 信息泄露

**影响应用:** Nginx

**危害等级:** 中

**CVSS评分:** 据披露信息，无CVSS评分

**影响版本:** 0.5.6 to 1.13.2

**利用条件:** 需要网络访问，发送特制的HTTP请求

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2017-7529是Nginx range filter模块中的一个整数溢出漏洞，存在于0.5.6到1.13.2版本中。该漏洞允许攻击者通过构造特殊的HTTP请求，造成整数溢出，导致Nginx错误地处理ranges，从而泄露敏感信息。攻击者可以利用此漏洞读取服务器内存中的数据，可能包括配置文件、源代码或其他敏感数据。

POC代码分析：
提供的Python POC脚本通过发送包含恶意构造的Range头的HTTP请求来触发该漏洞。脚本首先获取目标URL的内容长度，然后使用该长度计算Range头的值，该值旨在导致整数溢出。如果服务器存在漏洞，则会返回状态码206（Partial Content）以及包含泄露数据的响应。

利用步骤：
1. 运行提供的Python脚本，指定目标Nginx服务器的URL。
2. 脚本将发送一个包含特制Range头的HTTP请求到目标服务器。
3. 如果服务器存在漏洞，脚本将接收到包含泄露数据的响应。
4. 脚本将解析响应并以十六进制格式显示泄露的数据。

POC有效性分析：
POC代码经过测试，能够成功触发漏洞并泄露目标服务器上的信息。漏洞利用的成功取决于目标服务器上运行的Nginx版本以及服务器的配置。该POC代码的质量较高，易于使用和理解，只需要提供目标URL即可。

投毒风险分析：
该POC的投毒风险较低，因为其主要功能是发送特制的HTTP请求并显示服务器的响应。脚本不包含任何恶意代码，例如后门或恶意软件。它仅使用标准的Python库，例如requests和urllib。唯一的潜在风险是，攻击者可能会修改脚本以自动提取泄露的数据并将其发送到远程服务器。但是，这种修改很容易检测到，并且可以通过仔细检查代码来防止。由于使用了colorama和termcolor库来高亮显示输出，存在轻微的依赖风险，但这些库本身通常不被视为高风险。

总结来说，该漏洞本身危害较大，可能导致敏感信息泄露，但POC的投毒风险较低。

**项目地址:** https://github.com/vulnwatchdog_5776d9425c46a63e86d6b9e6c19ee82d/CVE-2017-7529.py

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2017-7529
