## CVE-2017-12149 - JBoss Application Server RCE/反序列化漏洞

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE/反序列化漏洞

**影响应用:** JBoss Application Server

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P)

**影响版本:** Red Hat JBoss Enterprise Application Platform 5.x

**利用条件:** 目标系统开启了ReadOnlyAccessFilter过滤器，且/invoker/ReadOnlyAccessFilter接口可被外部访问。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个针对JBoss Application Server（EAP 5.x版本）经典反序列化漏洞（CVE-2017-12149）的自动化工具。该漏洞的核心在于JBoss的HTTP Invoker组件在处理ReadOnlyAccessFilter时，未能对用户提交的序列化数据进行安全过滤，导致攻击者可以构造恶意的序列化对象进行远程命令执行。从提供的Java源码分析，Payload.java使用了Apache Commons Collections库中的Transformer链（如ChainedTransformer, InvokerTransformer等）构建典型的CC链攻击载荷。代码逻辑清晰地展示了如何根据目标操作系统（Linux/Windows）动态生成不同的字节码并执行。该POC通过序列化后的TiedMapEntry和LazyMap触发漏洞。利用步骤如下：首先，攻击者需要探测目标的/invoker/ReadOnlyAccessFilter接口是否存在；其次，POC会提示输入目标URL；随后，POC会自动发送探测载荷（如whoami）来识别操作系统环境；最后，攻击者根据识别结果选择操作系统类型，并输入需要执行的任意系统命令，POC将其封装在序列化对象中并发送至服务器端触发执行。此POC集成了操作系统识别和交互式Shell功能，极大降低了利用门槛，属于功能完备的漏洞利用脚本。 \n\n投毒风险分析：经过对源码的初步审计，该POC项目表现出较低的投毒风险。代码主要使用标准的Java反序列化构造方式和反射机制，未发现明显的恶意二阶段Payload植入。虽然在Payload.java中出现了硬编码的字节码数组（Classofbyte），但经过解密和逻辑推断，这些字节码是用于在目标机上实现RunCheckConfig功能的漏洞验证代码，属于Exploit的组成部分，而非针对攻击者本机的后门。README提到该工具是基于前人的源码修改，移除了图形化界面并增强了交互性。需要警惕的是，由于该POC涉及硬编码的二进制字节流，在没有完全反汇编所有字节码之前，不能排除其在特定条件下执行非预期行为的可能性。此外，交互式Shell的实现依赖于网络回连或特定回显逻辑，防御者在使用此类现成的二进制工具时，应在隔离环境（沙箱）中运行，并监控其是否产生了指向非目标IP的异常流量。总体而言，该代码逻辑公开透明，未见混淆或恶意混淆逻辑，属于相对安全的防御性研究样本，但仍需防范供应链中可能存在的二次修改投毒。

**项目地址:** [https://github.com/yunxu1/jboss-cve-2017-12149](https://www.google.com/search?q=https://github.com/yunxu1/jboss-cve-2017-12149) (参考原作者)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
