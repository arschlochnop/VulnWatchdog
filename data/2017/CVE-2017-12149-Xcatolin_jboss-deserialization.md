## CVE-2017-12149 - JBoss Application Server RCE (不安全的反序列化)

**漏洞编号:** CVE-2017-12149

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** JBoss Application Server

**危害等级:** CRITICAL

**CVSS评分:** 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P)

**影响版本:** JBoss AS 5.x, 6.x; Red Hat Enterprise Application Platform 5.2

**利用条件:** 无需身份验证，可通过网络访问目标服务器的 HTTP Invoker 服务接口

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2017-12149是一个存在于JBoss Application Server中的严重安全漏洞，其根本原因在于处理HTTP请求头中的序列化对象时缺乏适当的验证。具体而言，该漏洞位于`ReadOnlyAccessFilter`类的`doFilter`方法中，它会尝试反序列化来自客户端提交的数据。攻击者可以通过发送特制的、包含恶意Java序列化对象的HTTP POST请求到`/invoker/readonly`接口，从而在受影响的服务器上执行任意代码。本POC提供了一个完整的Docker实验环境，这对于漏洞研究极具价值。POC有效性分析：提供的Dockerfile不仅定义了操作系统的基础镜像，还详细说明了安装JDK 1.6和JBoss 6.0.0.Final的过程。由于该漏洞在现代版本的JBoss中已被修复且Java版本限制严格，这种特定的实验环境构建脚本显著降低了复现难度。通过wget下载官方发行包并配合sha1校验，确保了环境的可靠性。利用步骤如下：首先，防御人员需按照README指示获取特定的Oracle JDK 6安装包（由于许可证限制无法直接包含）；其次，执行`docker build`构建镜像并使用`docker run`映射8080端口启动服务；最后，使用现有的反序列化工具（如ysoserial）生成针对CommonsCollections链的Payload，并向目标的`/invoker/readonly`路径发送POST请求即可获取Shell。该漏洞在历史上曾被勒索软件团伙大规模利用，具有极高的实战参考意义。投毒风险分析：该POC项目的投毒风险处于极低水平（约10%）。代码结构透明，Dockerfile中的指令均为标准操作，如yum安装工具、设置环境变量、解压官方软件包等。虽然使用了`wget`从外部链接获取JBoss发行版，但链接指向的是SourceForge官方镜像站，且脚本中包含`sha1sum`校验步骤，这是一种良好的安全实践，有效防止了下载过程中的中间人攻击或供应链篡改。README文档详细且符合逻辑，没有引导用户运行经过混淆的二进制文件或执行不明来源的Shell脚本。唯一需要注意的是，用户在寻找配套的漏洞利用工具（如Payload生成器）时应从可信来源下载，因为虽然环境搭建代码是安全的，但攻击载荷本身可能携带后门。整体而言，该仓库是一个纯粹的防御性教育资源，未发现恶意代码注入、敏感信息外传或隐藏的远程控制指令，适合安全团队进行防御演练和特征检测规则的提取。

**项目地址:** [https://github.com/Xcatolin/jboss-deserialization](https://github.com/Xcatolin/jboss-deserialization)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
