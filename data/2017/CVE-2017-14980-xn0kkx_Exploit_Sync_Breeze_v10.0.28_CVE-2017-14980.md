# CVE-2017-14980

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-14980-LipeOzyy_CVE-2017-14980_syncbreeze_10.0.28_bof.md](../2017/CVE-2017-14980-LipeOzyy_CVE-2017-14980_syncbreeze_10.0.28_bof.md)

## CVE-2017-14980-Sync Breeze Enterprise-缓冲区溢出

**漏洞编号:** CVE-2017-14980

**漏洞类型:** 缓冲区溢出

**影响应用:** Sync Breeze Enterprise

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.0.28

**利用条件:** 需要网络访问目标Sync Breeze Enterprise服务器，并且服务器的/login接口存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-14980 是 Sync Breeze Enterprise 10.0.28 版本中的一个缓冲区溢出漏洞，存在于/login接口。攻击者可以通过向username参数发送超长字符串来触发该漏洞。提供的漏洞利用代码 exploit.c 演示了如何利用此漏洞。漏洞利用方法如下：

1.  **漏洞原理：** 由于 Sync Breeze Enterprise 在处理登录请求时，对 username 或 password 参数的长度没有进行充分的验证，导致攻击者可以发送一个超长的username参数，覆盖栈上的数据，从而控制程序的执行流程。
2.  **利用过程：**
    *   攻击者需要首先编译提供的 exploit.c 文件。编译命令是 `gcc exploit.c -o exploit`。
    *   修改 exploit.c 文件中的 `SERVER_IP` 为目标 Sync Breeze Enterprise 服务器的 IP 地址，并设置好shell_reverse_tcp的`LHOST`和`LPORT`。
    *   执行编译后的 exploit 文件 `./exploit`，程序会向目标服务器的 /login 接口发送一个精心构造的 HTTP POST 请求。
    *   这个 POST 请求的 password 字段包含一个超长的字符串，其中包含了用于覆盖 EIP 寄存器的地址以及 shellcode。
    *   服务器在处理请求时，由于缓冲区溢出漏洞，EIP 寄存器会被覆盖为攻击者控制的地址，从而执行 shellcode。
    *   shellcode 会反弹一个 shell 到攻击者的机器，攻击者就可以在目标服务器上执行任意命令。

3.  **有效性评估：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是真实存在的，且漏洞利用代码可以有效利用该漏洞实现远程代码执行。

4.  **投毒风险评估：** exploit.c 代码本身的功能是实现漏洞利用，主要逻辑是构造payload发送到目标机器上，使其产生缓冲区溢出。虽然shellcode部分，可以植入恶意代码，但提供的exp已经明确说明了shellcode的功能(反弹shell)，因此判定为投毒代码的概率较低。但是，shellcode本身是否完全符合描述需要进一步分析。结合代码分析来看，存在投毒风险，因为这个shellcode反弹shell之后，攻击者完全可以做任何事情，但是不是作者预先埋好的后门，不属于投毒。shellcode的部分是可以使用msfvenom生成的，灵活性高，所以这部分判定为有一定风险。

**结论：**该漏洞真实存在，可以被成功利用。虽然提供的EXP有一定风险,需要使用者自行检测shellcode的安全问题，但是总体风险还是比较低。


**项目地址:** [LipeOzyy/CVE-2017-14980_syncbreeze_10.0.28_bof](https://github.com/LipeOzyy/CVE-2017-14980_syncbreeze_10.0.28_bof)

**漏洞详情:** [CVE-2017-14980](https://nvd.nist.gov/vuln/detail/CVE-2017-14980)

---

## POC #2

**来源**: [CVE-2017-14980-TheDarthMole_CVE-2017-14980.md](../2017/CVE-2017-14980-TheDarthMole_CVE-2017-14980.md)

## CVE-2017-14980-Sync Breeze Enterprise-缓冲区溢出

**漏洞编号:** CVE-2017-14980

**漏洞类型:** 缓冲区溢出

**影响应用:** Sync Breeze Enterprise

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.0.28 (也可能影响其他版本，如9.4.28, 10.1.16)

**利用条件:** 需要网络访问目标Sync Breeze Enterprise的Web服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-14980是Sync Breeze Enterprise 10.0.28版本中存在的一个缓冲区溢出漏洞。攻击者可以通过向`/login`端点的`username`参数发送超长字符串来触发该漏洞，导致程序崩溃或者执行恶意代码。 

**有效性：**
根据漏洞信息和提供的POC代码，此漏洞是有效的。搜索引擎结果中多个来源都确认了该漏洞的存在，并且提供了受影响的版本信息。`exploit.py`脚本通过精心构造的HTTP POST请求，包含溢出`username`参数，尝试覆盖返回地址并执行shellcode，证明了漏洞的可利用性。

**投毒风险：**
评估`exploit.py`的内容，存在极低的投毒风险。主要的风险点在于shellcode (payload)部分。当前提供的shellcode是使用`msfvenom`生成的反向shell的payload，连接到攻击者的`192.168.0.86:9001`。 如果攻击者的IP和端口被修改为恶意地址，则该payload可能被利用植入后门。`fuzzer.py` 脚本是一个简单的fuzzer，用于确定崩溃时输入的大小，本身无投毒风险。
`README.md`文件只是漏洞的简单描述，不构成投毒。

**利用方式：**
1.  **漏洞定位：** 漏洞存在于Sync Breeze Enterprise的Web登录界面，具体是`/login`端点。
2.  **请求构造：**  攻击者构造一个HTTP POST请求，其中`username`参数包含一个长字符串，长度超过预期的缓冲区大小。
3.  **缓冲区溢出：**  超长字符串覆盖了栈上的返回地址。
4.  **Payload注入：**  在溢出字符串中，包含shellcode，并将其放置在覆盖返回地址之前。
5.  **执行控制劫持：**  服务器尝试返回时，执行流程被劫持到shellcode，从而执行攻击者提供的恶意代码（在本例中，是一个反向shell）。
6.  **利用Badchars：** 注意到`exploit.py`中考虑了badchars，这是缓冲区溢出漏洞利用中常见的步骤，目的是避免shellcode被截断或损坏。通过`msfvenom`生成payload时，需要排除这些badchars。
7. **绕过方式** 考虑到目标可能存在的安全措施,如DEP或ASLR,当前脚本利用硬编码的返回地址(`retn = "\x83\x0c\x09\x10"`)，所以可能需要绕过地址空间布局随机化 (ASLR)。如果ASLR启用，则需要找到其他方法来获取可预测的地址，例如info leak漏洞或者在未启用ASLR的模块中寻找gadgets.

**项目地址:** [TheDarthMole/CVE-2017-14980](https://github.com/TheDarthMole/CVE-2017-14980)

**漏洞详情:** [CVE-2017-14980](https://nvd.nist.gov/vuln/detail/CVE-2017-14980)

---

