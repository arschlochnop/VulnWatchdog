## CVE-2017-12149 - Red Hat JBoss Application Server (AS) 反序列化漏洞

**漏洞编号:** CVE-2017-12149

**漏洞类型:** 反序列化漏洞

**影响应用:** Red Hat JBoss Application Server (AS)

**危害等级:** CRITICAL

**CVSS评分:** 7.5 (CVSS:2.0/AV:N/AC:L/Au:N/C:P/I:P/A:P)

**影响版本:** JBoss AS 5.x, JBoss AS 6.x

**利用条件:** 无需认证，可通过网络访问受影响服务器的 /invoker/readonly 接口

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于JBoss AS的HttpInvoker组件中，具体路径通常为/invoker/readonly。该接口在处理POST请求时，会对客户端发送的序列化数据进行反序列化操作。由于JBoss在处理此类请求时缺乏必要的安全过滤，攻击者可以构造包含恶意Payload的序列化对象发送至该接口，从而在服务端触发反序列化并执行任意代码。本POC代码属于初级检测脚本，其逻辑非常简单：通过向目标URL的/invoker/readonly发送一个空的POST请求，并根据返回的HTTP状态码进行判断。如果服务器返回500 Internal Server Error，脚本则认为该接口存在并可能触发了反序列化异常，从而标记目标可能存在漏洞。需要注意的是，这种检测方式存在一定的误报率，因为它仅检测接口的存在性和基础响应，并没有真正注入Payload来验证RCE的执行结果。在实际防御性测试中，应进一步使用诸如ysoserial生成的CommonsCollections利用链来验证命令执行的真实性。利用步骤：1. 确认目标环境为JBoss AS 5.x或6.x；2. 构造指向/invoker/readonly或/invoker/JMXInvokerServlet的POST请求；3. 使用Java反序列化利用工具生成恶意的二进制序列化数据；4. 将数据通过HTTP POST发送至目标路径；5. 观察目标服务器是否执行了预定命令（如反弹Shell或写入文件）。投毒风险分析：该POC代码结构极其简单，使用了Python的标准库requests和sys。代码逻辑清晰透明，未发现任何代码混淆、外部恶意URL调用或未授权的系统修改行为。POC的功能仅限于发送一个标准的HTTP POST请求并打印响应结果。由于代码中没有包含任何复杂的二进制Payload，也没有尝试连接除用户输入参数以外的其他IP地址，因此其作为恶意投毒媒介的可能性极低。在威胁情报评估中，此类脚本被视为低风险的扫描工具。防御人员在使用时只需确保运行环境隔离，防止针对扫描器本身的潜在反向攻击。该代码不包含恶意后门逻辑，也不涉及敏感数据的非法外传，属于安全的防御性研究脚本。建议在内部测试环境中使用，并配合流量监测设备观察500状态码的触发频率，以识别潜在的扫描攻击。对于JBoss服务器，最根本的防御措施是禁用HttpInvoker服务或对该路径实施严格的访问控制限制，并升级到不受影响的版本。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2017-12149](https://nvd.nist.gov/vuln/detail/CVE-2017-12149)
