# CVE-2017-7921

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7921-201646613_CVE-2017-7921.md](../2017/CVE-2017-7921-201646613_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开放HTTP端口(通常是80端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个Hikvision摄像机中发现的不当身份验证漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL来访问敏感信息或执行特权操作。根据提供的POC代码，利用方式如下：

1.  **漏洞利用方式：**
    *   通过发送包含`auth=YWRtaW46MTEK`的特殊构造的HTTP请求到特定的URL，例如`/Security/users`、`/onvif-http/snapshot`或`/System/configurationFile`，可以绕过身份验证。
    *   `/Security/users` URL用于获取摄像机的用户列表。
    *   `/onvif-http/snapshot` URL用于获取摄像头的快照。
    *   `/System/configurationFile` URL用于下载摄像机的配置文件。

2.  **有效性：**
    *   提供的POC代码似乎是有效的。它使用`requests`库发送HTTP请求，并检查响应状态代码以确定漏洞是否存在。如果状态代码为200，则认为漏洞存在，然后根据设定的level参数，执行后续操作，如获取用户名，下载配置文件，抓取快照等。
    * 搜索引擎结果中也明确说明了该漏洞的存在性以及未授权访问的可能性。

3.  **投毒风险：**
    *   代码中存在轻微的投毒风险。主要体现在对异常的处理上不够严谨，虽然存在`try...except`块，但只是简单的打印错误信息，没有进行更详细的错误处理或日志记录。此外，`decrypt_configurationFile.py`模块是否安全未知，如果此模块本身被篡改，则可能存在投毒行为。代码会把目标和端口写入fail.txt或succeed.txt。恶意攻击者可能会用这些文件来进行下一步的攻击。
    *   从整体上看，该脚本主要功能是漏洞利用，不太可能包含恶意投毒代码。初步评估投毒风险较低，约为5%。

**项目地址:** [201646613/CVE-2017-7921](https://github.com/201646613/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #2

**来源**: [CVE-2017-7921-AnonkiGroup_AnonHik.md](../2017/CVE-2017-7921-AnonkiGroup_AnonHik.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** 受影响版本：DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络可达，且目标设备运行受影响的固件版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 是 Hikvision 摄像机中存在的一个不当身份验证漏洞。攻击者可以通过构造特定的 URL，绕过身份验证，未经授权访问摄像头的快照。提供的 POC 代码 `AnonHik.py` 通过向目标摄像头的 `/onvif-http/snapshot` 路径发送包含硬编码凭据 `admin:11` 的请求，尝试获取快照。如果摄像头存在漏洞，则会返回快照并保存到本地。分析`AnonHik.py`脚本，该脚本主要功能是发送带有硬编码用户名密码（admin:11）的URL请求，并没有发现恶意代码，`README.md`文件只是简单的描述和演示，所以投毒风险判断为0%。利用方式主要是通过未授权访问`/onvif-http/snapshot`，获得摄像头快照。

**项目地址:** [AnonkiGroup/AnonHik](https://github.com/AnonkiGroup/AnonHik)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #3

**来源**: [CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md](../2017/CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision摄像机

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞版本，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以利用此漏洞在未经授权的情况下访问摄像机信息，甚至提升权限。根据漏洞库信息，多个型号和版本的摄像机受到影响。搜索结果表明该漏洞允许未经身份验证的信息泄露，甚至允许访问摄像机快照。提供的POC代码是一个Go语言编写的工具，可以用于检测漏洞、爆破密码和进行漏洞利用（Exp）。

**有效性评估：**
根据提供的漏洞信息，搜索引擎结果和漏洞利用代码，可以判断POC代码有效。因为漏洞库和搜索引擎结果都确认了漏洞的存在，并且提供了相关的分析和利用方法。POC代码提供了验证漏洞、密码爆破的功能，如果能够成功利用，则能够证明该漏洞是有效的。

**投毒风险分析：**
该POC代码存在一定的投毒风险，约10%。主要基于以下几点：
1.  代码中包含密码爆破模块，可能被用于非法用途。
2.  虽然代码提供了POC和EXP，但EXP部分代码未全部展示，存在隐藏恶意行为的可能。但是从代码整体来看，该项目更偏向于漏洞验证和利用，恶意投毒的可能性不高。

**利用方式：**
1.  **信息收集：** 使用POC中的扫描模块，确定目标设备是否存在CVE-2017-7921漏洞。
2.  **未授权访问：** 利用POC代码尝试直接访问受影响的摄像机，获取敏感信息或快照。
3.  **密码爆破：** 如果直接利用失败，则使用POC中的密码爆破模块，尝试破解摄像机的管理员密码。
4.  **权限提升：** 成功破解密码后，登录摄像机管理界面，提升用户权限，获取更高的控制权。

**项目地址:** [BurnyMcDull/CVE-2017-7921](https://github.com/BurnyMcDull/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #4

**来源**: [CVE-2017-7921-GabrielAvls_CVE-2017-7921.md](../2017/CVE-2017-7921-GabrielAvls_CVE-2017-7921.md)

## CVE-2017-7921 Hikvision Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** Improper Authentication

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升，获取敏感信息，远程代码执行（取决于具体配置）

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的固件版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是一个Hikvision摄像头的身份验证绕过漏洞。攻击者可以未经授权访问摄像头的敏感信息，甚至可以修改摄像头的配置。

**有效性：**
提供的POC代码看起来是有效的。它利用了CVE-2017-7921漏洞，允许攻击者下载和解密配置文件（包含管理员密码），下载图像，并将图像转换为视频。利用代码包括使用`openssl`解密配置文件的功能，这表明该漏洞可能允许未经身份验证地访问配置文件。 搜索引擎结果也表明存在可用的EXP，进一步佐证了有效性。

**投毒风险：**
虽然代码的功能与漏洞描述相符，且包含必要的警告信息，但仍然存在一定的投毒风险。 主要风险点在于：
1.  **依赖包安全：** 脚本依赖多个第三方Python库（requests, opencv-python, numpy, scikit-image）。如果这些库被恶意篡改（供应链攻击），可能会导致执行恶意代码。虽然`requirements.txt`文件本身没有直接的投毒代码，但不能保证这些库在PyPI上的安全性。
2.  **外部命令执行：** 脚本使用`openssl`命令进行解密。如果系统上的`openssl`命令被替换为恶意程序，可能导致安全问题。
3.  **`find_user_credentials` 函数：** 虽然代码片段不完整，但其目标是从解密数据中提取用户名和密码。 如果此过程设计不当，可能会引入漏洞或为后续攻击铺平道路。

综合来看，投毒风险较低，大概为10%。因为POC代码主要依赖已知漏洞和标准库，没有明显的恶意代码。 但是，使用者仍然需要谨慎，确保依赖项的安全性，并仔细审查代码。

**利用方式：**
1.  **配置信息泄露：** 攻击者使用脚本下载并解密摄像头的配置文件，获取管理员密码。
2.  **图像抓取：** 攻击者可以连续下载摄像头的图像，进行监视或收集证据。
3.  **视频生成：** 攻击者可以将下载的图像转换为视频，方便查看和分析。
4.  **权限提升：** 通过泄露的管理员密码，攻击者可以登录摄像头并获得管理员权限，从而完全控制摄像头。

**项目地址:** [GabrielAvls/CVE-2017-7921](https://github.com/GabrielAvls/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #5

**来源**: [CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md)

# CVE-2017-7921

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7921-201646613_CVE-2017-7921.md](../2017/CVE-2017-7921-201646613_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开放HTTP端口(通常是80端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个Hikvision摄像机中发现的不当身份验证漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL来访问敏感信息或执行特权操作。根据提供的POC代码，利用方式如下：

1.  **漏洞利用方式：**
    *   通过发送包含`auth=YWRtaW46MTEK`的特殊构造的HTTP请求到特定的URL，例如`/Security/users`、`/onvif-http/snapshot`或`/System/configurationFile`，可以绕过身份验证。
    *   `/Security/users` URL用于获取摄像机的用户列表。
    *   `/onvif-http/snapshot` URL用于获取摄像头的快照。
    *   `/System/configurationFile` URL用于下载摄像机的配置文件。

2.  **有效性：**
    *   提供的POC代码似乎是有效的。它使用`requests`库发送HTTP请求，并检查响应状态代码以确定漏洞是否存在。如果状态代码为200，则认为漏洞存在，然后根据设定的level参数，执行后续操作，如获取用户名，下载配置文件，抓取快照等。
    * 搜索引擎结果中也明确说明了该漏洞的存在性以及未授权访问的可能性。

3.  **投毒风险：**
    *   代码中存在轻微的投毒风险。主要体现在对异常的处理上不够严谨，虽然存在`try...except`块，但只是简单的打印错误信息，没有进行更详细的错误处理或日志记录。此外，`decrypt_configurationFile.py`模块是否安全未知，如果此模块本身被篡改，则可能存在投毒行为。代码会把目标和端口写入fail.txt或succeed.txt。恶意攻击者可能会用这些文件来进行下一步的攻击。
    *   从整体上看，该脚本主要功能是漏洞利用，不太可能包含恶意投毒代码。初步评估投毒风险较低，约为5%。

**项目地址:** [201646613/CVE-2017-7921](https://github.com/201646613/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #2

**来源**: [CVE-2017-7921-AnonkiGroup_AnonHik.md](../2017/CVE-2017-7921-AnonkiGroup_AnonHik.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** 受影响版本：DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络可达，且目标设备运行受影响的固件版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 是 Hikvision 摄像机中存在的一个不当身份验证漏洞。攻击者可以通过构造特定的 URL，绕过身份验证，未经授权访问摄像头的快照。提供的 POC 代码 `AnonHik.py` 通过向目标摄像头的 `/onvif-http/snapshot` 路径发送包含硬编码凭据 `admin:11` 的请求，尝试获取快照。如果摄像头存在漏洞，则会返回快照并保存到本地。分析`AnonHik.py`脚本，该脚本主要功能是发送带有硬编码用户名密码（admin:11）的URL请求，并没有发现恶意代码，`README.md`文件只是简单的描述和演示，所以投毒风险判断为0%。利用方式主要是通过未授权访问`/onvif-http/snapshot`，获得摄像头快照。

**项目地址:** [AnonkiGroup/AnonHik](https://github.com/AnonkiGroup/AnonHik)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #3

**来源**: [CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md](../2017/CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision摄像机

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞版本，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以利用此漏洞在未经授权的情况下访问摄像机信息，甚至提升权限。根据漏洞库信息，多个型号和版本的摄像机受到影响。搜索结果表明该漏洞允许未经身份验证的信息泄露，甚至允许访问摄像机快照。提供的POC代码是一个Go语言编写的工具，可以用于检测漏洞、爆破密码和进行漏洞利用（Exp）。

**有效性评估：**
根据提供的漏洞信息，搜索引擎结果和漏洞利用代码，可以判断POC代码有效。因为漏洞库和搜索引擎结果都确认了漏洞的存在，并且提供了相关的分析和利用方法。POC代码提供了验证漏洞、密码爆破的功能，如果能够成功利用，则能够证明该漏洞是有效的。

**投毒风险分析：**
该POC代码存在一定的投毒风险，约10%。主要基于以下几点：
1.  代码中包含密码爆破模块，可能被用于非法用途。
2.  虽然代码提供了POC和EXP，但EXP部分代码未全部展示，存在隐藏恶意行为的可能。但是从代码整体来看，该项目更偏向于漏洞验证和利用，恶意投毒的可能性不高。

**利用方式：**
1.  **信息收集：** 使用POC中的扫描模块，确定目标设备是否存在CVE-2017-7921漏洞。
2.  **未授权访问：** 利用POC代码尝试直接访问受影响的摄像机，获取敏感信息或快照。
3.  **密码爆破：** 如果直接利用失败，则使用POC中的密码爆破模块，尝试破解摄像机的管理员密码。
4.  **权限提升：** 成功破解密码后，登录摄像机管理界面，提升用户权限，获取更高的控制权。

**项目地址:** [BurnyMcDull/CVE-2017-7921](https://github.com/BurnyMcDull/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #4

**来源**: [CVE-2017-7921-GabrielAvls_CVE-2017-7921.md](../2017/CVE-2017-7921-GabrielAvls_CVE-2017-7921.md)

## CVE-2017-7921 Hikvision Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** Improper Authentication

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升，获取敏感信息，远程代码执行（取决于具体配置）

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的固件版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是一个Hikvision摄像头的身份验证绕过漏洞。攻击者可以未经授权访问摄像头的敏感信息，甚至可以修改摄像头的配置。

**有效性：**
提供的POC代码看起来是有效的。它利用了CVE-2017-7921漏洞，允许攻击者下载和解密配置文件（包含管理员密码），下载图像，并将图像转换为视频。利用代码包括使用`openssl`解密配置文件的功能，这表明该漏洞可能允许未经身份验证地访问配置文件。 搜索引擎结果也表明存在可用的EXP，进一步佐证了有效性。

**投毒风险：**
虽然代码的功能与漏洞描述相符，且包含必要的警告信息，但仍然存在一定的投毒风险。 主要风险点在于：
1.  **依赖包安全：** 脚本依赖多个第三方Python库（requests, opencv-python, numpy, scikit-image）。如果这些库被恶意篡改（供应链攻击），可能会导致执行恶意代码。虽然`requirements.txt`文件本身没有直接的投毒代码，但不能保证这些库在PyPI上的安全性。
2.  **外部命令执行：** 脚本使用`openssl`命令进行解密。如果系统上的`openssl`命令被替换为恶意程序，可能导致安全问题。
3.  **`find_user_credentials` 函数：** 虽然代码片段不完整，但其目标是从解密数据中提取用户名和密码。 如果此过程设计不当，可能会引入漏洞或为后续攻击铺平道路。

综合来看，投毒风险较低，大概为10%。因为POC代码主要依赖已知漏洞和标准库，没有明显的恶意代码。 但是，使用者仍然需要谨慎，确保依赖项的安全性，并仔细审查代码。

**利用方式：**
1.  **配置信息泄露：** 攻击者使用脚本下载并解密摄像头的配置文件，获取管理员密码。
2.  **图像抓取：** 攻击者可以连续下载摄像头的图像，进行监视或收集证据。
3.  **视频生成：** 攻击者可以将下载的图像转换为视频，方便查看和分析。
4.  **权限提升：** 通过泄露的管理员密码，攻击者可以登录摄像头并获得管理员权限，从而完全控制摄像头。

**项目地址:** [GabrielAvls/CVE-2017-7921](https://github.com/GabrielAvls/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #5

**来源**: [CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md)

# CVE-2017-7921

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7921-201646613_CVE-2017-7921.md](../2017/CVE-2017-7921-201646613_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开放HTTP端口(通常是80端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个Hikvision摄像机中发现的不当身份验证漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL来访问敏感信息或执行特权操作。根据提供的POC代码，利用方式如下：

1.  **漏洞利用方式：**
    *   通过发送包含`auth=YWRtaW46MTEK`的特殊构造的HTTP请求到特定的URL，例如`/Security/users`、`/onvif-http/snapshot`或`/System/configurationFile`，可以绕过身份验证。
    *   `/Security/users` URL用于获取摄像机的用户列表。
    *   `/onvif-http/snapshot` URL用于获取摄像头的快照。
    *   `/System/configurationFile` URL用于下载摄像机的配置文件。

2.  **有效性：**
    *   提供的POC代码似乎是有效的。它使用`requests`库发送HTTP请求，并检查响应状态代码以确定漏洞是否存在。如果状态代码为200，则认为漏洞存在，然后根据设定的level参数，执行后续操作，如获取用户名，下载配置文件，抓取快照等。
    * 搜索引擎结果中也明确说明了该漏洞的存在性以及未授权访问的可能性。

3.  **投毒风险：**
    *   代码中存在轻微的投毒风险。主要体现在对异常的处理上不够严谨，虽然存在`try...except`块，但只是简单的打印错误信息，没有进行更详细的错误处理或日志记录。此外，`decrypt_configurationFile.py`模块是否安全未知，如果此模块本身被篡改，则可能存在投毒行为。代码会把目标和端口写入fail.txt或succeed.txt。恶意攻击者可能会用这些文件来进行下一步的攻击。
    *   从整体上看，该脚本主要功能是漏洞利用，不太可能包含恶意投毒代码。初步评估投毒风险较低，约为5%。

**项目地址:** [201646613/CVE-2017-7921](https://github.com/201646613/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #2

**来源**: [CVE-2017-7921-AnonkiGroup_AnonHik.md](../2017/CVE-2017-7921-AnonkiGroup_AnonHik.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** 受影响版本：DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络可达，且目标设备运行受影响的固件版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 是 Hikvision 摄像机中存在的一个不当身份验证漏洞。攻击者可以通过构造特定的 URL，绕过身份验证，未经授权访问摄像头的快照。提供的 POC 代码 `AnonHik.py` 通过向目标摄像头的 `/onvif-http/snapshot` 路径发送包含硬编码凭据 `admin:11` 的请求，尝试获取快照。如果摄像头存在漏洞，则会返回快照并保存到本地。分析`AnonHik.py`脚本，该脚本主要功能是发送带有硬编码用户名密码（admin:11）的URL请求，并没有发现恶意代码，`README.md`文件只是简单的描述和演示，所以投毒风险判断为0%。利用方式主要是通过未授权访问`/onvif-http/snapshot`，获得摄像头快照。

**项目地址:** [AnonkiGroup/AnonHik](https://github.com/AnonkiGroup/AnonHik)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #3

**来源**: [CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md](../2017/CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision摄像机

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞版本，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以利用此漏洞在未经授权的情况下访问摄像机信息，甚至提升权限。根据漏洞库信息，多个型号和版本的摄像机受到影响。搜索结果表明该漏洞允许未经身份验证的信息泄露，甚至允许访问摄像机快照。提供的POC代码是一个Go语言编写的工具，可以用于检测漏洞、爆破密码和进行漏洞利用（Exp）。

**有效性评估：**
根据提供的漏洞信息，搜索引擎结果和漏洞利用代码，可以判断POC代码有效。因为漏洞库和搜索引擎结果都确认了漏洞的存在，并且提供了相关的分析和利用方法。POC代码提供了验证漏洞、密码爆破的功能，如果能够成功利用，则能够证明该漏洞是有效的。

**投毒风险分析：**
该POC代码存在一定的投毒风险，约10%。主要基于以下几点：
1.  代码中包含密码爆破模块，可能被用于非法用途。
2.  虽然代码提供了POC和EXP，但EXP部分代码未全部展示，存在隐藏恶意行为的可能。但是从代码整体来看，该项目更偏向于漏洞验证和利用，恶意投毒的可能性不高。

**利用方式：**
1.  **信息收集：** 使用POC中的扫描模块，确定目标设备是否存在CVE-2017-7921漏洞。
2.  **未授权访问：** 利用POC代码尝试直接访问受影响的摄像机，获取敏感信息或快照。
3.  **密码爆破：** 如果直接利用失败，则使用POC中的密码爆破模块，尝试破解摄像机的管理员密码。
4.  **权限提升：** 成功破解密码后，登录摄像机管理界面，提升用户权限，获取更高的控制权。

**项目地址:** [BurnyMcDull/CVE-2017-7921](https://github.com/BurnyMcDull/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #4

**来源**: [CVE-2017-7921-GabrielAvls_CVE-2017-7921.md](../2017/CVE-2017-7921-GabrielAvls_CVE-2017-7921.md)

## CVE-2017-7921 Hikvision Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** Improper Authentication

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升，获取敏感信息，远程代码执行（取决于具体配置）

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的固件版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是一个Hikvision摄像头的身份验证绕过漏洞。攻击者可以未经授权访问摄像头的敏感信息，甚至可以修改摄像头的配置。

**有效性：**
提供的POC代码看起来是有效的。它利用了CVE-2017-7921漏洞，允许攻击者下载和解密配置文件（包含管理员密码），下载图像，并将图像转换为视频。利用代码包括使用`openssl`解密配置文件的功能，这表明该漏洞可能允许未经身份验证地访问配置文件。 搜索引擎结果也表明存在可用的EXP，进一步佐证了有效性。

**投毒风险：**
虽然代码的功能与漏洞描述相符，且包含必要的警告信息，但仍然存在一定的投毒风险。 主要风险点在于：
1.  **依赖包安全：** 脚本依赖多个第三方Python库（requests, opencv-python, numpy, scikit-image）。如果这些库被恶意篡改（供应链攻击），可能会导致执行恶意代码。虽然`requirements.txt`文件本身没有直接的投毒代码，但不能保证这些库在PyPI上的安全性。
2.  **外部命令执行：** 脚本使用`openssl`命令进行解密。如果系统上的`openssl`命令被替换为恶意程序，可能导致安全问题。
3.  **`find_user_credentials` 函数：** 虽然代码片段不完整，但其目标是从解密数据中提取用户名和密码。 如果此过程设计不当，可能会引入漏洞或为后续攻击铺平道路。

综合来看，投毒风险较低，大概为10%。因为POC代码主要依赖已知漏洞和标准库，没有明显的恶意代码。 但是，使用者仍然需要谨慎，确保依赖项的安全性，并仔细审查代码。

**利用方式：**
1.  **配置信息泄露：** 攻击者使用脚本下载并解密摄像头的配置文件，获取管理员密码。
2.  **图像抓取：** 攻击者可以连续下载摄像头的图像，进行监视或收集证据。
3.  **视频生成：** 攻击者可以将下载的图像转换为视频，方便查看和分析。
4.  **权限提升：** 通过泄露的管理员密码，攻击者可以登录摄像头并获得管理员权限，从而完全控制摄像头。

**项目地址:** [GabrielAvls/CVE-2017-7921](https://github.com/GabrielAvls/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #5

**来源**: [CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md)

# CVE-2017-7921

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7921-201646613_CVE-2017-7921.md](../2017/CVE-2017-7921-201646613_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开放HTTP端口(通常是80端口)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个Hikvision摄像机中发现的不当身份验证漏洞。该漏洞允许未经身份验证的攻击者通过构造特定的URL来访问敏感信息或执行特权操作。根据提供的POC代码，利用方式如下：

1.  **漏洞利用方式：**
    *   通过发送包含`auth=YWRtaW46MTEK`的特殊构造的HTTP请求到特定的URL，例如`/Security/users`、`/onvif-http/snapshot`或`/System/configurationFile`，可以绕过身份验证。
    *   `/Security/users` URL用于获取摄像机的用户列表。
    *   `/onvif-http/snapshot` URL用于获取摄像头的快照。
    *   `/System/configurationFile` URL用于下载摄像机的配置文件。

2.  **有效性：**
    *   提供的POC代码似乎是有效的。它使用`requests`库发送HTTP请求，并检查响应状态代码以确定漏洞是否存在。如果状态代码为200，则认为漏洞存在，然后根据设定的level参数，执行后续操作，如获取用户名，下载配置文件，抓取快照等。
    * 搜索引擎结果中也明确说明了该漏洞的存在性以及未授权访问的可能性。

3.  **投毒风险：**
    *   代码中存在轻微的投毒风险。主要体现在对异常的处理上不够严谨，虽然存在`try...except`块，但只是简单的打印错误信息，没有进行更详细的错误处理或日志记录。此外，`decrypt_configurationFile.py`模块是否安全未知，如果此模块本身被篡改，则可能存在投毒行为。代码会把目标和端口写入fail.txt或succeed.txt。恶意攻击者可能会用这些文件来进行下一步的攻击。
    *   从整体上看，该脚本主要功能是漏洞利用，不太可能包含恶意投毒代码。初步评估投毒风险较低，约为5%。

**项目地址:** [201646613/CVE-2017-7921](https://github.com/201646613/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #2

**来源**: [CVE-2017-7921-AnonkiGroup_AnonHik.md](../2017/CVE-2017-7921-AnonkiGroup_AnonHik.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** 受影响版本：DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络可达，且目标设备运行受影响的固件版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 是 Hikvision 摄像机中存在的一个不当身份验证漏洞。攻击者可以通过构造特定的 URL，绕过身份验证，未经授权访问摄像头的快照。提供的 POC 代码 `AnonHik.py` 通过向目标摄像头的 `/onvif-http/snapshot` 路径发送包含硬编码凭据 `admin:11` 的请求，尝试获取快照。如果摄像头存在漏洞，则会返回快照并保存到本地。分析`AnonHik.py`脚本，该脚本主要功能是发送带有硬编码用户名密码（admin:11）的URL请求，并没有发现恶意代码，`README.md`文件只是简单的描述和演示，所以投毒风险判断为0%。利用方式主要是通过未授权访问`/onvif-http/snapshot`，获得摄像头快照。

**项目地址:** [AnonkiGroup/AnonHik](https://github.com/AnonkiGroup/AnonHik)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #3

**来源**: [CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md](../2017/CVE-2017-7921-BurnyMcDull_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision摄像机

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞版本，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以利用此漏洞在未经授权的情况下访问摄像机信息，甚至提升权限。根据漏洞库信息，多个型号和版本的摄像机受到影响。搜索结果表明该漏洞允许未经身份验证的信息泄露，甚至允许访问摄像机快照。提供的POC代码是一个Go语言编写的工具，可以用于检测漏洞、爆破密码和进行漏洞利用（Exp）。

**有效性评估：**
根据提供的漏洞信息，搜索引擎结果和漏洞利用代码，可以判断POC代码有效。因为漏洞库和搜索引擎结果都确认了漏洞的存在，并且提供了相关的分析和利用方法。POC代码提供了验证漏洞、密码爆破的功能，如果能够成功利用，则能够证明该漏洞是有效的。

**投毒风险分析：**
该POC代码存在一定的投毒风险，约10%。主要基于以下几点：
1.  代码中包含密码爆破模块，可能被用于非法用途。
2.  虽然代码提供了POC和EXP，但EXP部分代码未全部展示，存在隐藏恶意行为的可能。但是从代码整体来看，该项目更偏向于漏洞验证和利用，恶意投毒的可能性不高。

**利用方式：**
1.  **信息收集：** 使用POC中的扫描模块，确定目标设备是否存在CVE-2017-7921漏洞。
2.  **未授权访问：** 利用POC代码尝试直接访问受影响的摄像机，获取敏感信息或快照。
3.  **密码爆破：** 如果直接利用失败，则使用POC中的密码爆破模块，尝试破解摄像机的管理员密码。
4.  **权限提升：** 成功破解密码后，登录摄像机管理界面，提升用户权限，获取更高的控制权。

**项目地址:** [BurnyMcDull/CVE-2017-7921](https://github.com/BurnyMcDull/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #4

**来源**: [CVE-2017-7921-GabrielAvls_CVE-2017-7921.md](../2017/CVE-2017-7921-GabrielAvls_CVE-2017-7921.md)

## CVE-2017-7921 Hikvision Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** Improper Authentication

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升，获取敏感信息，远程代码执行（取决于具体配置）

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的固件版本，并且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是一个Hikvision摄像头的身份验证绕过漏洞。攻击者可以未经授权访问摄像头的敏感信息，甚至可以修改摄像头的配置。

**有效性：**
提供的POC代码看起来是有效的。它利用了CVE-2017-7921漏洞，允许攻击者下载和解密配置文件（包含管理员密码），下载图像，并将图像转换为视频。利用代码包括使用`openssl`解密配置文件的功能，这表明该漏洞可能允许未经身份验证地访问配置文件。 搜索引擎结果也表明存在可用的EXP，进一步佐证了有效性。

**投毒风险：**
虽然代码的功能与漏洞描述相符，且包含必要的警告信息，但仍然存在一定的投毒风险。 主要风险点在于：
1.  **依赖包安全：** 脚本依赖多个第三方Python库（requests, opencv-python, numpy, scikit-image）。如果这些库被恶意篡改（供应链攻击），可能会导致执行恶意代码。虽然`requirements.txt`文件本身没有直接的投毒代码，但不能保证这些库在PyPI上的安全性。
2.  **外部命令执行：** 脚本使用`openssl`命令进行解密。如果系统上的`openssl`命令被替换为恶意程序，可能导致安全问题。
3.  **`find_user_credentials` 函数：** 虽然代码片段不完整，但其目标是从解密数据中提取用户名和密码。 如果此过程设计不当，可能会引入漏洞或为后续攻击铺平道路。

综合来看，投毒风险较低，大概为10%。因为POC代码主要依赖已知漏洞和标准库，没有明显的恶意代码。 但是，使用者仍然需要谨慎，确保依赖项的安全性，并仔细审查代码。

**利用方式：**
1.  **配置信息泄露：** 攻击者使用脚本下载并解密摄像头的配置文件，获取管理员密码。
2.  **图像抓取：** 攻击者可以连续下载摄像头的图像，进行监视或收集证据。
3.  **视频生成：** 攻击者可以将下载的图像转换为视频，方便查看和分析。
4.  **权限提升：** 通过泄露的管理员密码，攻击者可以登录摄像头并获得管理员权限，从而完全控制摄像头。

**项目地址:** [GabrielAvls/CVE-2017-7921](https://github.com/GabrielAvls/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #5

**来源**: [CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-JrDw0_CVE-2017-7921-EXP.md)

## CVE-2017-7921-Hikvision摄像头身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的Hikvision摄像头固件版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于特定 Hikvision IP 摄像头中，允许未经身份验证的访问。攻击者可以利用 `auth` 参数绕过身份验证，例如通过构造 `http://camera.ip/System/configurationFile?auth=YWRtaW46MTEK`  来下载包含用户名和密码的摄像头配置文件。PoC 代码尝试使用此漏洞读取配置文件并提取用户名和密码。利用方式是发送带有特定`auth`参数的HTTP GET请求，该参数包含base64编码的"admin:11\n"。如果成功，服务器将返回加密的配置文件，PoC对其进行解密并提取用户名和密码。虽然PoC的主要目的是演示漏洞，但存在轻微的投毒风险的可能性，例如包含恶意链接或旨在收集目标信息的代码，因此投毒风险估计为10%。

**有效性：** 根据漏洞描述和提供的PoC代码，该PoC代码有效。它利用了身份验证绕过漏洞，通过构造包含base64编码凭据的URL来访问敏感信息。

**投毒风险：**PoC代码本身看起来主要是利用漏洞，没有明显的恶意行为。但是，仍然需要警惕，因为存在以下风险：

*   **依赖项风险：** PoC代码依赖于外部库（例如`requests`、`Crypto.Cipher`、`fire`）。恶意作者可能会修改这些库以包含后门。
*   **信息收集：** 该PoC可能无意中收集有关目标系统的信息，并将其发送给攻击者。
*   **代码执行：** 虽然不太可能，但如果PoC代码被修改为执行任意代码，则可能存在投毒风险。

考虑到这些因素，PoC投毒风险评估为10%。

**利用方式：**

1.  **目标确定：** 确定运行易受攻击的Hikvision摄像头固件版本的IP地址。
2.  **漏洞利用：** 使用PoC代码，通过构造的URL（例如`http://camera.ip/System/configurationFile?auth=YWRtaW46MTEK`）发送HTTP GET请求。
3.  **配置数据解密：** PoC代码解密返回的配置文件。
4.  **凭据提取：** PoC代码提取用户名和密码。
5.  **权限提升/信息泄露：** 使用提取的凭据以管理员权限访问摄像头，或利用泄露的信息进行其他攻击。

**项目地址:** [JrDw0/CVE-2017-7921-EXP](https://github.com/JrDw0/CVE-2017-7921-EXP)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #6

**来源**: [CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md](../2017/CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md)

## CVE-2017-7921 - Hikvision摄像机未授权访问漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启Web服务且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7921存在于多个Hikvision摄像机型号中，是一个未授权访问漏洞。攻击者无需身份验证即可访问敏感信息或提升权限。

**有效性：**

根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该漏洞是有效的。搜索结果中多个链接都指向了该漏洞的详细描述和分析，并有博客文章提供了如何识别和利用该漏洞的信息。PoC代码尝试通过特定的URL（/Security/users, /System/configurationFile, /onvif-http/snapshot）绕过身份验证，从而获取用户信息、配置文件或摄像机快照。如果目标摄像机存在漏洞，PoC代码很可能会成功利用。

**投毒风险：**

PoC代码主要功能是发送HTTP请求，解析响应，并提取敏感信息。代码中存在加解密函数`decrypt` 和 `xore`, 存在利用漏洞获取用户密码等敏感信息的可能, 但不属于投毒代码。该代码只是为了验证漏洞的存在而编写的，本身不太可能包含恶意代码。因此,投毒风险较低，大概为1%。

**利用方式：**

1.  **确定目标：** 确定目标Hikvision摄像机的IP地址和端口号。
2.  **版本确认：** 确认目标摄像机的固件版本是否在受影响的范围内。
3.  **发送未授权请求：** 使用PoC代码中提供的URL（例如`/Security/users?auth=YWRtaW46MTEK`）向目标摄像机发送未授权请求。
4.  **获取敏感信息：** 如果漏洞存在，摄像机将返回包含用户信息、配置文件或快照图像的数据。
5.  **权限提升（理论上）：** 虽然PoC代码主要演示了信息泄露，但漏洞描述中提到可能导致权限提升。攻击者可以利用泄露的信息进一步尝试获取设备的控制权。

**搜索引擎结果优先级：**
搜索结果提供了漏洞的详细信息，利用方法，受影响范围等信息，因此优先级最高。
**漏洞利用代码优先级：**
PoC代码验证了漏洞的存在，并提供了一种利用漏洞的途径，优先级次之。
**漏洞库信息优先级：**
漏洞库信息提供了漏洞的基本描述和受影响的产品，优先级最低。

**项目地址:** [K3ysTr0K3R/CVE-2017-7921-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-7921-EXPLOIT)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #7

**来源**: [CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md](../2017/CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md)

## CVE-2017-7921-Hikvision摄像机身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530等多个系列产品

**利用条件:** 目标设备需位于网络中，且漏洞版本存在。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision摄像机中发现的一个身份验证绕过漏洞。攻击者可以利用此漏洞，在无需提供有效凭据的情况下，获取设备的未授权访问权限，从而提升权限并访问敏感信息，甚至可能篡改设备配置。漏洞存在于多个系列的Hikvision摄像机固件版本中。根据漏洞利用代码，该漏洞可以通过发送特制的请求绕过身份验证。

**有效性：**
根据漏洞信息和搜索结果显示，此漏洞已经公开披露，并且存在可用的PoC代码。该PoC代码提供了一个Golang实现的利用程序，支持CVE-2017-7921漏洞利用模式和暴力破解模式，说明该漏洞利用的有效性较高。

**投毒风险：**
分析提供的PoC代码，主要功能是漏洞利用和密码爆破。其中，`README.md` 文件提供了详细的构建和使用说明，`go.mod` 和 `go.sum` 文件是Go语言的依赖管理文件，`LICENSE`文件是MIT开源协议。 代码本身看起来像是为了利用这个漏洞而设计的，用于测试和渗透目的。虽然PoC代码本身的功能是实现漏洞利用，但是任何来源不明的代码都存在潜在的风险。 漏洞利用代码使用了github.com上的第三方库，如果这些库被投毒，也可能会影响使用此exp的使用者。综合评估，投毒风险为10%。

**利用方式：**
利用方式主要有两种：
1.  **CVE-2017-7921漏洞利用模式：** 通过发送特定的恶意构造的请求，绕过身份验证，直接获取设备的访问权限。PoC代码中`-e`参数指定此模式，需要指定目标IP和端口。
2.  **暴力破解模式：** 如果直接利用漏洞不可行，PoC代码也支持通过暴力破解来尝试破解设备的密码。PoC代码中`-b`参数指定此模式，需要提供密码字典文件或单个密码，以及目标IP和端口。

攻击者可以通过以下步骤利用该漏洞：
1.  确定目标Hikvision摄像机的IP地址和端口。
2.  使用PoC代码，选择CVE-2017-7921模式或者暴力破解模式。
3.  如果选择CVE-2017-7921模式，直接运行PoC代码即可尝试绕过身份验证。
4.  如果选择暴力破解模式，需要准备密码字典文件，并指定密码字典的路径。
5.  运行PoC代码，等待破解结果。

**项目地址:** [MisakaMikato/cve-2017-7921-golang](https://github.com/MisakaMikato/cve-2017-7921-golang)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #8

**来源**: [CVE-2017-7921-aengussong_hikvision_probe.md](../2017/CVE-2017-7921-aengussong_hikvision_probe.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需开启web服务并且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个存在于多个Hikvision摄像机型号和固件版本中的不当身份验证漏洞。攻击者可以利用此漏洞绕过身份验证，获取敏感信息或提升权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的PoC代码可用。`hikvision_identifier.py` 脚本用于识别存在漏洞的 Hikvision 设备，通过检查 HTTP 响应头中的 `Server` 字段或页面内容中是否包含 `/doc/page/login.asp?_` 来判断。 `hikvision_probe.py` 和 `CVE_2017_7921.py` 用于进一步探测是否存在漏洞，尝试访问一些包含默认认证信息的URL，例如 `/System/time?auth=YWRtaW46UEtTOHVpTWg1UUk4`。如果成功访问，则表明设备存在漏洞。

**投毒风险：**

我分析了提供的PoC代码，并未发现明显的恶意代码。主要功能是发送HTTP请求并检查响应。其中`hikvision_identifier.py`，`hikvision_probe.py`，`CVE_2017_7921.py`脚本中都存在发送网络请求, 存在一定的风险，即作者可以收集用户探测目标，但是从代码功能来看，更倾向于漏洞验证，综上，投毒风险较低。风险概率：5%。

**利用方式：**

1.  **设备识别：** 使用`hikvision_identifier.py`脚本扫描目标网络，识别存在漏洞的Hikvision设备。
2.  **漏洞探测：** 使用`hikvision_probe.py`脚本，它调用`CVE_2017_7921.py`中的`probe_keys`函数，尝试使用默认的`auth`参数访问敏感接口，例如`/System/time`、`/Security/users`、`/System/deviceInfo`等。这些接口返回的信息可能包含设备配置、用户信息等敏感数据。
3.  **权限提升/信息窃取：** 如果漏洞探测成功，攻击者可以使用已泄露的信息（如用户名密码），或者直接利用未授权访问的接口，来提升权限或窃取敏感信息。

总而言之，该漏洞的利用方式相对简单，只需发送特定的HTTP请求即可。因此，成功利用的可能性较高。

**项目地址:** [aengussong/hikvision_probe](https://github.com/aengussong/hikvision_probe)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #9

**来源**: [CVE-2017-7921-b3pwn3d_CVE-2017-7921.md](../2017/CVE-2017-7921-b3pwn3d_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致未授权访问、信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备在受影响的版本范围内，且允许网络访问HTTP(默认80端口)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision相机中存在的一个不当身份验证漏洞。攻击者可以通过构造特殊的HTTP请求绕过身份验证，获取敏感信息，例如用户名和密码，或者提升权限。

**漏洞利用方式：**
1.  攻击者发送一个包含特定`auth`参数的HTTP GET请求到`/Security/users`和`/System/configurationFile`这两个URL。例如：`http://<IP>:<PORT>/Security/users?auth=YWRtaW46MTEK` 和 `http://<IP>:<PORT>/System/configurationFile?auth=YWRtaW46MTEK`
2.  如果设备存在漏洞，服务器会返回包含用户信息的XML或配置文件。
3.  利用脚本中的`config_decryptor`函数解密配置文件中的用户名和密码。

**有效性评估：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码的有效性较高。搜索结果显示，多个来源证实了该漏洞的存在，并且有公开的漏洞利用方法。

**投毒风险评估：**
代码分析表明存在轻微的投毒风险。`exploit_detect.py` 主要功能是检测漏洞和提取凭据。然而，`save_to_file` 函数的存在可能被滥用。攻击者如果控制了该脚本的使用环境，可能会通过修改脚本，将扫描结果发送到攻击者控制的服务器，或者植入其他恶意代码。因此，投毒风险评估为10%。脚本本身利用了已知的漏洞，但其结果收集和处理部分存在潜在的风险。


**项目地址:** [b3pwn3d/CVE-2017-7921](https://github.com/b3pwn3d/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #10

**来源**: [CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Configuration Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于某些版本的 Hikvision IP 摄像头中，允许未经身份验证的攻击者绕过身份验证并下载包含敏感信息的配置文件。根据提供的漏洞利用代码，该漏洞通过在 URL 中提供一个特定的 base64 编码字符串（`auth=YWRtaW46MTEK`）来利用，从而允许下载配置文件。提供的 Python 脚本 `decrypt_configurationFile.py` 用于解密此配置文件。脚本使用 AES 解密（ECB 模式，密钥硬编码为 `279977f62f6cfd2d91cd75b889ce0c9a`）和 XOR 运算（密钥为 `0x73, 0x8B, 0x55, 0x44`）来提取有意义的字符串。有效性：根据漏洞信息和搜索引擎结果，此 POC 有效，可以绕过身份验证并解密敏感配置数据。投毒风险：代码中存在硬编码密钥，虽然这不是恶意投毒，但降低了安全性，如果攻击者修改默认密钥并传播，可能导致只有特定攻击者能利用。脚本本身的功能是解密配置文件，而不是执行恶意操作，因此直接投毒的风险较低。但存在修改脚本以包含其他恶意功能的潜在风险。这里判断投毒风险为5%主要是考虑到存在被其他攻击者修改脚本，放入其他后门的可能性。

**项目地址:** [chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #11

**来源**: [CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md](../2017/CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md)

## CVE-2017-7921 - Hikvision IP Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 权限提升/认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可导致完全控制设备、敏感信息泄露

**影响版本:** 受影响版本见漏洞库信息和漏洞利用代码的描述。

**利用条件:** 目标设备使用受影响的固件版本，且Web端口（通常为80/443）可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 漏洞存在于 Hikvision IP 摄像头中，由于身份验证不当导致。攻击者无需任何凭据即可利用此漏洞，通过发送特制的 HTTP 请求到 `/Security/users` 接口来修改现有用户的密码，包括管理员密码，从而完全控制设备。漏洞利用代码 `main.py` 脚本首先从 `ip.txt` 文件读取 IP 地址列表。然后，对于每个 IP 地址，它通过构造的URL下载配置文件，使用AES解密，再通过XOR解密，最后提取配置文件中的字符串。URL中`auth=YWRtaW46MTEK`绕过认证获取配置文件，获取敏感信息，例如用户名和密码。根据漏洞描述和POC代码，该漏洞利用方式有效。代码中没有发现明显的投毒行为。脚本只是尝试下载、解密和分析设备配置文件。

**项目地址:** [initon/Hikvision---CVE-2017-7921](https://github.com/initon/Hikvision---CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #12

**来源**: [CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md)

## CVE-2017-7921 - 海康威视摄像机不当身份验证漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** 海康威视摄像机

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问目标摄像机，目标摄像机存在漏洞且未修复。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以通过在请求中包含特定的 'auth' 参数（包含base64编码的'用户名:密码'字符串，密码可以任意），绕过身份验证，获取管理员权限。利用此漏洞，攻击者可以访问敏感信息，如摄像机配置，甚至可以修改摄像机固件，导致设备永久损坏或植入恶意代码。

**漏洞利用方式:**

1.  **身份验证绕过:**  攻击者构造包含`auth=YWRtaW46MTEK`参数的HTTP请求，其中`YWRtaW46MTEK`是`admin:11`的Base64编码。由于漏洞的存在，摄像机会错误地认为攻击者已通过身份验证。
2.  **配置信息获取:** 通过访问`http://<camera_ip>/System/configurationFile?auth=YWRtaW46MTEK`端点，攻击者可以下载摄像机的配置信息。
3.  **权限提升:** 攻击者利用绕过的身份验证，可以执行需要管理员权限的操作，例如添加新用户或修改摄像机设置。

**有效性:**

提供的PoC代码 `CVE_2017_7921_EXP.py` 看起来是有效的，它利用了上述漏洞，尝试通过发送包含`auth`参数的请求来获取摄像机的配置信息，并尝试提取用户名和密码。

**投毒风险:**

该PoC代码主要功能是利用漏洞进行信息收集，而非直接植入后门。但是,代码中包含一些潜在的风险，例如：

*   **依赖外部库:** 代码依赖于 `requests` 和 `pycryptodome` 库。虽然这些库本身很常用，但如果攻击者控制了代码的运行环境，可能会通过替换这些库来引入恶意代码。
*   **配置解析:** 代码解析摄像机的配置信息，这可能暴露敏感信息。如果攻击者修改代码，可以将这些信息发送到远程服务器。
*   **异常处理:** 代码中的异常处理相对简单，可能存在未考虑到的异常情况，攻击者可以利用这些异常来执行恶意操作。

总体来说，直接的投毒风险较低（约为5%），主要是代码本身可能被滥用或者被修改后用于其他恶意目的。

**项目地址:** [inj3ction/CVE-2017-7921-EXP](https://github.com/inj3ction/CVE-2017-7921-EXP)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #13

**来源**: [CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md](../2017/CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md)

## CVE-2017-7921-Hikvision Cameras-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问，目标设备运行受影响版本的Hikvision摄像头

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于 Hikvision 摄像头中，由于不当的身份验证，未经身份验证的攻击者可以访问摄像头快照。PoC 代码通过向 `/onvif-http/snapshot?auth=YWRtaW46MTEK` 发送 HTTP GET 请求来利用此漏洞，其中 `YWRtaW46MTEK` 是经过 Base64 编码的用户名 admin 和密码 11。如果状态码为 200 且内容长度大于 100，则认为目标易受攻击。PoC 代码使用多线程加速扫描，并将易受攻击的 URL 写入 vulnerable.txt 文件。

**有效性：**
根据漏洞信息和搜索引擎结果，此 PoC 似乎有效，因为它可以利用身份验证绕过漏洞来获取摄像头快照。

**投毒风险：**
PoC 代码本身主要用于检测漏洞。虽然没有明显的恶意代码，但存在轻微的投毒风险（10%）。
*   该脚本在 vulnerable.txt 文件中追加 URL，如果被大规模利用，可能造成隐私泄露。
*   依赖 `requirements.txt` 安装第三方库，可能存在依赖包被篡改的风险。
*   目标IP列表targets.txt，如果被替换为蜜罐或者恶意IP地址，可能导致扫描者暴露自身。

**利用方式：**
1.  攻击者需要一个包含目标 Hikvision 摄像头 IP 地址的列表（targets.txt）。
2.  攻击者运行 PoC 脚本，脚本会并发地向目标 IP 地址发送特制的 HTTP 请求。
3.  如果摄像头存在漏洞，攻击者可以未经身份验证地访问摄像头快照，或者通过尝试其他的ONVIF接口进行控制。
4.  PoC 会将所有被发现存在漏洞的摄像头的地址保存到 vulnerable.txt 文件中， 方便攻击者后续利用。

**项目地址:** [kooroshsanaei/HikVision-CVE-2017-7921](https://github.com/kooroshsanaei/HikVision-CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #14

**来源**: [CVE-2017-7921-krypton612_hikivision.md](../2017/CVE-2017-7921-krypton612_hikivision.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制和拒绝服务

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备运行受影响的固件版本，并且可以通过HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是 Hikvision IP 摄像机中发现的一个严重漏洞，它允许未经身份验证的攻击者绕过身份验证，并获取对敏感信息的访问权限或提升权限。

**漏洞利用方式：**

该漏洞通过在 URL 中附加特定的字符串 `?auth=YWRtaW46MTEK` 来实现未经授权的访问。这个字符串充当后门，允许攻击者访问各种敏感端点，而无需有效的身份验证。

**利用步骤：**

1.  **确定目标：** 识别运行易受攻击的 Hikvision 摄像机固件版本的设备。
2.  **构造恶意 URL：** 将 `?auth=YWRtaW46MTEK` 附加到摄像机 HTTP/HTTPS URL 的末尾，然后附加目标端点。
3.  **发送请求：** 使用 curl 或任何其他 HTTP 客户端发送构造的 URL 请求。
4.  **获取信息或执行操作：** 根据所使用的端点，攻击者可以检索敏感信息（如设备信息、用户列表、配置文件）或执行操作（如重启或恢复出厂设置）。

**脚本分析：**

*   `exploit.sh` 脚本通过命令行参数获取目标主机、端口和 SSL 设置。它构造带有后门的 URL，然后使用 `curl` 命令发送请求。脚本检查 HTTP 状态码以确定目标是否易受攻击。如果易受攻击，脚本会下载配置文件，并尝试使用 `config-decryptor.py` 脚本对其进行解密，如果解密成功,会提取用户名和密码。
*   `config-decryptor.py` 脚本用于解密下载的配置文件。它使用 AES 解密和 XOR 运算来提取可读信息。这个脚本中没有明显的投毒代码，但要注意该脚本用于处理从目标设备获取的配置信息，可能存在被利用来进行后续攻击的风险。

**投毒风险分析：**

`exploit.sh`脚本本身主要通过拼接URL和调用`curl`获取数据，风险较低。`config-decryptor.py`脚本用于解密配置文件，其中用到了固定的密钥，脚本没有联网行为，恶意修改解密逻辑的可能性较低。整体代码的投毒风险较低,大约为5%。主要是需要人工分析解密后的配置信息,存在人为投毒的风险。


**项目地址:** [krypton612/hikivision](https://github.com/krypton612/hikivision)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #15

**来源**: [CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md](../2017/CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Config Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备位于网络上且可访问,并且运行受影响的固件版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于多个Hikvision IP摄像头型号中，是一个身份验证绕过漏洞。攻击者可以利用该漏洞，通过构造特定的URL（例如`/System/configurationFile?auth=YWRtaW46MTEK`）来下载摄像头的配置文件。这个配置文件包含加密的用户信息。提供的Python脚本`decrypt_configurationFile.py`旨在解密下载的配置文件。脚本首先使用AES算法（ECB模式）和一个硬编码的密钥`279977f62f6cfd2d91cd75b889ce0c9a`来解密配置文件内容，然后使用一个简单的异或操作进行进一步解密。最后，它提取解密后的字符串。虽然核心的解密逻辑看似合理，但存在一些潜在的风险。脚本中硬编码了解密密钥，这使得攻击者可以轻松解密任何通过该漏洞获取的配置文件。投毒风险较低，因为脚本主要功能是解密，但依赖于固定的密钥和算法，如果密钥被替换，则可能被用来收集解密信息或进行其他恶意活动。`strings` 函数在提取字符串时，采用了一个相当宽泛的字符集，这可能导致提取出一些不必要的或潜在的恶意数据。 漏洞利用方式是首先利用未经身份验证的配置下载漏洞，然后使用提供的脚本解密配置文件。尽管如此，该脚本的作者可能通过更改 `strings` 函数来匹配特定格式或者使用不同编码来影响解密结果。

**项目地址:** [lastvocher/Hikvision-CVE-2017-7921-decryptor](https://github.com/lastvocher/Hikvision-CVE-2017-7921-decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #16

**来源**: [CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921-Hikvision摄像机认证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需要存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921存在于特定版本的海康威视IP摄像头中，允许未经过身份验证的攻击者通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）下载包含敏感信息的配置文件。该配置文件使用弱加密，攻击者可以使用提供的python脚本进行解密，获取用户名和密码等敏感信息。

**有效性：**
提供的POC代码 `decrypt_configurationFile.py` 用于解密通过漏洞下载的配置文件，因此是有效的。

**投毒风险：**
代码主要功能是解密配置文件，没有发现明显的恶意代码或后门。代码结构清晰，逻辑简单，依赖的库 `pycryptodome` 是一个常见的密码学库。因此，投毒风险较低。

**利用方式：**
1.  构造包含特定base64字符串的URL，例如 `/System/configurationFile?auth=YWRtaW46MTEK`，向目标设备发送请求，下载配置文件。
2.  使用提供的 `decrypt_configurationFile.py` 脚本解密下载的配置文件。
3.  从解密后的配置文件中提取敏感信息，例如用户名和密码。
4.  使用提取的凭据登录设备，或利用其他漏洞进行进一步的攻击。

**项目地址:** [p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #17

**来源**: [CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md](../2017/CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md)

## CVE-2017-7921-Hikvision摄像头未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启HTTP服务且存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 是 Hikvision 摄像头中存在的未授权访问漏洞。漏洞利用代码显示，攻击者可以通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）绕过身份验证，直接访问设备的配置文件。`download.py` 脚本通过读取 IP 地址列表，循环尝试利用该漏洞下载配置文件。`decrypt.py`脚本用于解密下载的配置文件。攻击者可以从中获取敏感信息，如用户名、密码等。

**利用方式：**

1.  准备目标 IP 地址列表。
2.  运行 `download.py` 脚本，该脚本会尝试下载每个 IP 地址对应的摄像头的配置文件。
3.  如果成功下载了配置文件，则使用 `decrypt.py` 脚本进行解密，获取敏感信息。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。

**投毒风险：**

虽然主要功能是实现漏洞利用，但是依旧存在一定的投毒风险。例如:

*   `download.py`脚本中的`dowloadSnapshotImg`函数的功能是下载快照图片，存在被修改为下载恶意文件并执行的风险。
*   脚本中使用的硬编码密钥，存在被替换为恶意密钥的风险，导致解密后的配置文件包含恶意内容。
*   `ip` 文件中IP地址的真实性未知。

因此，综合评估，投毒风险为10%。

**项目地址:** [yousouf-Tasfin/cve-2017-7921-Mass-Exploit](https://github.com/yousouf-Tasfin/cve-2017-7921-Mass-Exploit)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---



---

## POC #6

**来源**: [CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md](../2017/CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md)

## CVE-2017-7921 - Hikvision摄像机未授权访问漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启Web服务且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7921存在于多个Hikvision摄像机型号中，是一个未授权访问漏洞。攻击者无需身份验证即可访问敏感信息或提升权限。

**有效性：**

根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该漏洞是有效的。搜索结果中多个链接都指向了该漏洞的详细描述和分析，并有博客文章提供了如何识别和利用该漏洞的信息。PoC代码尝试通过特定的URL（/Security/users, /System/configurationFile, /onvif-http/snapshot）绕过身份验证，从而获取用户信息、配置文件或摄像机快照。如果目标摄像机存在漏洞，PoC代码很可能会成功利用。

**投毒风险：**

PoC代码主要功能是发送HTTP请求，解析响应，并提取敏感信息。代码中存在加解密函数`decrypt` 和 `xore`, 存在利用漏洞获取用户密码等敏感信息的可能, 但不属于投毒代码。该代码只是为了验证漏洞的存在而编写的，本身不太可能包含恶意代码。因此,投毒风险较低，大概为1%。

**利用方式：**

1.  **确定目标：** 确定目标Hikvision摄像机的IP地址和端口号。
2.  **版本确认：** 确认目标摄像机的固件版本是否在受影响的范围内。
3.  **发送未授权请求：** 使用PoC代码中提供的URL（例如`/Security/users?auth=YWRtaW46MTEK`）向目标摄像机发送未授权请求。
4.  **获取敏感信息：** 如果漏洞存在，摄像机将返回包含用户信息、配置文件或快照图像的数据。
5.  **权限提升（理论上）：** 虽然PoC代码主要演示了信息泄露，但漏洞描述中提到可能导致权限提升。攻击者可以利用泄露的信息进一步尝试获取设备的控制权。

**搜索引擎结果优先级：**
搜索结果提供了漏洞的详细信息，利用方法，受影响范围等信息，因此优先级最高。
**漏洞利用代码优先级：**
PoC代码验证了漏洞的存在，并提供了一种利用漏洞的途径，优先级次之。
**漏洞库信息优先级：**
漏洞库信息提供了漏洞的基本描述和受影响的产品，优先级最低。

**项目地址:** [K3ysTr0K3R/CVE-2017-7921-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-7921-EXPLOIT)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #7

**来源**: [CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md](../2017/CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md)

## CVE-2017-7921-Hikvision摄像机身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530等多个系列产品

**利用条件:** 目标设备需位于网络中，且漏洞版本存在。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision摄像机中发现的一个身份验证绕过漏洞。攻击者可以利用此漏洞，在无需提供有效凭据的情况下，获取设备的未授权访问权限，从而提升权限并访问敏感信息，甚至可能篡改设备配置。漏洞存在于多个系列的Hikvision摄像机固件版本中。根据漏洞利用代码，该漏洞可以通过发送特制的请求绕过身份验证。

**有效性：**
根据漏洞信息和搜索结果显示，此漏洞已经公开披露，并且存在可用的PoC代码。该PoC代码提供了一个Golang实现的利用程序，支持CVE-2017-7921漏洞利用模式和暴力破解模式，说明该漏洞利用的有效性较高。

**投毒风险：**
分析提供的PoC代码，主要功能是漏洞利用和密码爆破。其中，`README.md` 文件提供了详细的构建和使用说明，`go.mod` 和 `go.sum` 文件是Go语言的依赖管理文件，`LICENSE`文件是MIT开源协议。 代码本身看起来像是为了利用这个漏洞而设计的，用于测试和渗透目的。虽然PoC代码本身的功能是实现漏洞利用，但是任何来源不明的代码都存在潜在的风险。 漏洞利用代码使用了github.com上的第三方库，如果这些库被投毒，也可能会影响使用此exp的使用者。综合评估，投毒风险为10%。

**利用方式：**
利用方式主要有两种：
1.  **CVE-2017-7921漏洞利用模式：** 通过发送特定的恶意构造的请求，绕过身份验证，直接获取设备的访问权限。PoC代码中`-e`参数指定此模式，需要指定目标IP和端口。
2.  **暴力破解模式：** 如果直接利用漏洞不可行，PoC代码也支持通过暴力破解来尝试破解设备的密码。PoC代码中`-b`参数指定此模式，需要提供密码字典文件或单个密码，以及目标IP和端口。

攻击者可以通过以下步骤利用该漏洞：
1.  确定目标Hikvision摄像机的IP地址和端口。
2.  使用PoC代码，选择CVE-2017-7921模式或者暴力破解模式。
3.  如果选择CVE-2017-7921模式，直接运行PoC代码即可尝试绕过身份验证。
4.  如果选择暴力破解模式，需要准备密码字典文件，并指定密码字典的路径。
5.  运行PoC代码，等待破解结果。

**项目地址:** [MisakaMikato/cve-2017-7921-golang](https://github.com/MisakaMikato/cve-2017-7921-golang)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #8

**来源**: [CVE-2017-7921-aengussong_hikvision_probe.md](../2017/CVE-2017-7921-aengussong_hikvision_probe.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需开启web服务并且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个存在于多个Hikvision摄像机型号和固件版本中的不当身份验证漏洞。攻击者可以利用此漏洞绕过身份验证，获取敏感信息或提升权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的PoC代码可用。`hikvision_identifier.py` 脚本用于识别存在漏洞的 Hikvision 设备，通过检查 HTTP 响应头中的 `Server` 字段或页面内容中是否包含 `/doc/page/login.asp?_` 来判断。 `hikvision_probe.py` 和 `CVE_2017_7921.py` 用于进一步探测是否存在漏洞，尝试访问一些包含默认认证信息的URL，例如 `/System/time?auth=YWRtaW46UEtTOHVpTWg1UUk4`。如果成功访问，则表明设备存在漏洞。

**投毒风险：**

我分析了提供的PoC代码，并未发现明显的恶意代码。主要功能是发送HTTP请求并检查响应。其中`hikvision_identifier.py`，`hikvision_probe.py`，`CVE_2017_7921.py`脚本中都存在发送网络请求, 存在一定的风险，即作者可以收集用户探测目标，但是从代码功能来看，更倾向于漏洞验证，综上，投毒风险较低。风险概率：5%。

**利用方式：**

1.  **设备识别：** 使用`hikvision_identifier.py`脚本扫描目标网络，识别存在漏洞的Hikvision设备。
2.  **漏洞探测：** 使用`hikvision_probe.py`脚本，它调用`CVE_2017_7921.py`中的`probe_keys`函数，尝试使用默认的`auth`参数访问敏感接口，例如`/System/time`、`/Security/users`、`/System/deviceInfo`等。这些接口返回的信息可能包含设备配置、用户信息等敏感数据。
3.  **权限提升/信息窃取：** 如果漏洞探测成功，攻击者可以使用已泄露的信息（如用户名密码），或者直接利用未授权访问的接口，来提升权限或窃取敏感信息。

总而言之，该漏洞的利用方式相对简单，只需发送特定的HTTP请求即可。因此，成功利用的可能性较高。

**项目地址:** [aengussong/hikvision_probe](https://github.com/aengussong/hikvision_probe)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #9

**来源**: [CVE-2017-7921-b3pwn3d_CVE-2017-7921.md](../2017/CVE-2017-7921-b3pwn3d_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致未授权访问、信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备在受影响的版本范围内，且允许网络访问HTTP(默认80端口)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision相机中存在的一个不当身份验证漏洞。攻击者可以通过构造特殊的HTTP请求绕过身份验证，获取敏感信息，例如用户名和密码，或者提升权限。

**漏洞利用方式：**
1.  攻击者发送一个包含特定`auth`参数的HTTP GET请求到`/Security/users`和`/System/configurationFile`这两个URL。例如：`http://<IP>:<PORT>/Security/users?auth=YWRtaW46MTEK` 和 `http://<IP>:<PORT>/System/configurationFile?auth=YWRtaW46MTEK`
2.  如果设备存在漏洞，服务器会返回包含用户信息的XML或配置文件。
3.  利用脚本中的`config_decryptor`函数解密配置文件中的用户名和密码。

**有效性评估：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码的有效性较高。搜索结果显示，多个来源证实了该漏洞的存在，并且有公开的漏洞利用方法。

**投毒风险评估：**
代码分析表明存在轻微的投毒风险。`exploit_detect.py` 主要功能是检测漏洞和提取凭据。然而，`save_to_file` 函数的存在可能被滥用。攻击者如果控制了该脚本的使用环境，可能会通过修改脚本，将扫描结果发送到攻击者控制的服务器，或者植入其他恶意代码。因此，投毒风险评估为10%。脚本本身利用了已知的漏洞，但其结果收集和处理部分存在潜在的风险。


**项目地址:** [b3pwn3d/CVE-2017-7921](https://github.com/b3pwn3d/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #10

**来源**: [CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Configuration Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于某些版本的 Hikvision IP 摄像头中，允许未经身份验证的攻击者绕过身份验证并下载包含敏感信息的配置文件。根据提供的漏洞利用代码，该漏洞通过在 URL 中提供一个特定的 base64 编码字符串（`auth=YWRtaW46MTEK`）来利用，从而允许下载配置文件。提供的 Python 脚本 `decrypt_configurationFile.py` 用于解密此配置文件。脚本使用 AES 解密（ECB 模式，密钥硬编码为 `279977f62f6cfd2d91cd75b889ce0c9a`）和 XOR 运算（密钥为 `0x73, 0x8B, 0x55, 0x44`）来提取有意义的字符串。有效性：根据漏洞信息和搜索引擎结果，此 POC 有效，可以绕过身份验证并解密敏感配置数据。投毒风险：代码中存在硬编码密钥，虽然这不是恶意投毒，但降低了安全性，如果攻击者修改默认密钥并传播，可能导致只有特定攻击者能利用。脚本本身的功能是解密配置文件，而不是执行恶意操作，因此直接投毒的风险较低。但存在修改脚本以包含其他恶意功能的潜在风险。这里判断投毒风险为5%主要是考虑到存在被其他攻击者修改脚本，放入其他后门的可能性。

**项目地址:** [chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #11

**来源**: [CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md](../2017/CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md)

## CVE-2017-7921 - Hikvision IP Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 权限提升/认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可导致完全控制设备、敏感信息泄露

**影响版本:** 受影响版本见漏洞库信息和漏洞利用代码的描述。

**利用条件:** 目标设备使用受影响的固件版本，且Web端口（通常为80/443）可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 漏洞存在于 Hikvision IP 摄像头中，由于身份验证不当导致。攻击者无需任何凭据即可利用此漏洞，通过发送特制的 HTTP 请求到 `/Security/users` 接口来修改现有用户的密码，包括管理员密码，从而完全控制设备。漏洞利用代码 `main.py` 脚本首先从 `ip.txt` 文件读取 IP 地址列表。然后，对于每个 IP 地址，它通过构造的URL下载配置文件，使用AES解密，再通过XOR解密，最后提取配置文件中的字符串。URL中`auth=YWRtaW46MTEK`绕过认证获取配置文件，获取敏感信息，例如用户名和密码。根据漏洞描述和POC代码，该漏洞利用方式有效。代码中没有发现明显的投毒行为。脚本只是尝试下载、解密和分析设备配置文件。

**项目地址:** [initon/Hikvision---CVE-2017-7921](https://github.com/initon/Hikvision---CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #12

**来源**: [CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md)

## CVE-2017-7921 - 海康威视摄像机不当身份验证漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** 海康威视摄像机

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问目标摄像机，目标摄像机存在漏洞且未修复。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以通过在请求中包含特定的 'auth' 参数（包含base64编码的'用户名:密码'字符串，密码可以任意），绕过身份验证，获取管理员权限。利用此漏洞，攻击者可以访问敏感信息，如摄像机配置，甚至可以修改摄像机固件，导致设备永久损坏或植入恶意代码。

**漏洞利用方式:**

1.  **身份验证绕过:**  攻击者构造包含`auth=YWRtaW46MTEK`参数的HTTP请求，其中`YWRtaW46MTEK`是`admin:11`的Base64编码。由于漏洞的存在，摄像机会错误地认为攻击者已通过身份验证。
2.  **配置信息获取:** 通过访问`http://<camera_ip>/System/configurationFile?auth=YWRtaW46MTEK`端点，攻击者可以下载摄像机的配置信息。
3.  **权限提升:** 攻击者利用绕过的身份验证，可以执行需要管理员权限的操作，例如添加新用户或修改摄像机设置。

**有效性:**

提供的PoC代码 `CVE_2017_7921_EXP.py` 看起来是有效的，它利用了上述漏洞，尝试通过发送包含`auth`参数的请求来获取摄像机的配置信息，并尝试提取用户名和密码。

**投毒风险:**

该PoC代码主要功能是利用漏洞进行信息收集，而非直接植入后门。但是,代码中包含一些潜在的风险，例如：

*   **依赖外部库:** 代码依赖于 `requests` 和 `pycryptodome` 库。虽然这些库本身很常用，但如果攻击者控制了代码的运行环境，可能会通过替换这些库来引入恶意代码。
*   **配置解析:** 代码解析摄像机的配置信息，这可能暴露敏感信息。如果攻击者修改代码，可以将这些信息发送到远程服务器。
*   **异常处理:** 代码中的异常处理相对简单，可能存在未考虑到的异常情况，攻击者可以利用这些异常来执行恶意操作。

总体来说，直接的投毒风险较低（约为5%），主要是代码本身可能被滥用或者被修改后用于其他恶意目的。

**项目地址:** [inj3ction/CVE-2017-7921-EXP](https://github.com/inj3ction/CVE-2017-7921-EXP)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #13

**来源**: [CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md](../2017/CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md)

## CVE-2017-7921-Hikvision Cameras-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问，目标设备运行受影响版本的Hikvision摄像头

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于 Hikvision 摄像头中，由于不当的身份验证，未经身份验证的攻击者可以访问摄像头快照。PoC 代码通过向 `/onvif-http/snapshot?auth=YWRtaW46MTEK` 发送 HTTP GET 请求来利用此漏洞，其中 `YWRtaW46MTEK` 是经过 Base64 编码的用户名 admin 和密码 11。如果状态码为 200 且内容长度大于 100，则认为目标易受攻击。PoC 代码使用多线程加速扫描，并将易受攻击的 URL 写入 vulnerable.txt 文件。

**有效性：**
根据漏洞信息和搜索引擎结果，此 PoC 似乎有效，因为它可以利用身份验证绕过漏洞来获取摄像头快照。

**投毒风险：**
PoC 代码本身主要用于检测漏洞。虽然没有明显的恶意代码，但存在轻微的投毒风险（10%）。
*   该脚本在 vulnerable.txt 文件中追加 URL，如果被大规模利用，可能造成隐私泄露。
*   依赖 `requirements.txt` 安装第三方库，可能存在依赖包被篡改的风险。
*   目标IP列表targets.txt，如果被替换为蜜罐或者恶意IP地址，可能导致扫描者暴露自身。

**利用方式：**
1.  攻击者需要一个包含目标 Hikvision 摄像头 IP 地址的列表（targets.txt）。
2.  攻击者运行 PoC 脚本，脚本会并发地向目标 IP 地址发送特制的 HTTP 请求。
3.  如果摄像头存在漏洞，攻击者可以未经身份验证地访问摄像头快照，或者通过尝试其他的ONVIF接口进行控制。
4.  PoC 会将所有被发现存在漏洞的摄像头的地址保存到 vulnerable.txt 文件中， 方便攻击者后续利用。

**项目地址:** [kooroshsanaei/HikVision-CVE-2017-7921](https://github.com/kooroshsanaei/HikVision-CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #14

**来源**: [CVE-2017-7921-krypton612_hikivision.md](../2017/CVE-2017-7921-krypton612_hikivision.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制和拒绝服务

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备运行受影响的固件版本，并且可以通过HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是 Hikvision IP 摄像机中发现的一个严重漏洞，它允许未经身份验证的攻击者绕过身份验证，并获取对敏感信息的访问权限或提升权限。

**漏洞利用方式：**

该漏洞通过在 URL 中附加特定的字符串 `?auth=YWRtaW46MTEK` 来实现未经授权的访问。这个字符串充当后门，允许攻击者访问各种敏感端点，而无需有效的身份验证。

**利用步骤：**

1.  **确定目标：** 识别运行易受攻击的 Hikvision 摄像机固件版本的设备。
2.  **构造恶意 URL：** 将 `?auth=YWRtaW46MTEK` 附加到摄像机 HTTP/HTTPS URL 的末尾，然后附加目标端点。
3.  **发送请求：** 使用 curl 或任何其他 HTTP 客户端发送构造的 URL 请求。
4.  **获取信息或执行操作：** 根据所使用的端点，攻击者可以检索敏感信息（如设备信息、用户列表、配置文件）或执行操作（如重启或恢复出厂设置）。

**脚本分析：**

*   `exploit.sh` 脚本通过命令行参数获取目标主机、端口和 SSL 设置。它构造带有后门的 URL，然后使用 `curl` 命令发送请求。脚本检查 HTTP 状态码以确定目标是否易受攻击。如果易受攻击，脚本会下载配置文件，并尝试使用 `config-decryptor.py` 脚本对其进行解密，如果解密成功,会提取用户名和密码。
*   `config-decryptor.py` 脚本用于解密下载的配置文件。它使用 AES 解密和 XOR 运算来提取可读信息。这个脚本中没有明显的投毒代码，但要注意该脚本用于处理从目标设备获取的配置信息，可能存在被利用来进行后续攻击的风险。

**投毒风险分析：**

`exploit.sh`脚本本身主要通过拼接URL和调用`curl`获取数据，风险较低。`config-decryptor.py`脚本用于解密配置文件，其中用到了固定的密钥，脚本没有联网行为，恶意修改解密逻辑的可能性较低。整体代码的投毒风险较低,大约为5%。主要是需要人工分析解密后的配置信息,存在人为投毒的风险。


**项目地址:** [krypton612/hikivision](https://github.com/krypton612/hikivision)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #15

**来源**: [CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md](../2017/CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Config Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备位于网络上且可访问,并且运行受影响的固件版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于多个Hikvision IP摄像头型号中，是一个身份验证绕过漏洞。攻击者可以利用该漏洞，通过构造特定的URL（例如`/System/configurationFile?auth=YWRtaW46MTEK`）来下载摄像头的配置文件。这个配置文件包含加密的用户信息。提供的Python脚本`decrypt_configurationFile.py`旨在解密下载的配置文件。脚本首先使用AES算法（ECB模式）和一个硬编码的密钥`279977f62f6cfd2d91cd75b889ce0c9a`来解密配置文件内容，然后使用一个简单的异或操作进行进一步解密。最后，它提取解密后的字符串。虽然核心的解密逻辑看似合理，但存在一些潜在的风险。脚本中硬编码了解密密钥，这使得攻击者可以轻松解密任何通过该漏洞获取的配置文件。投毒风险较低，因为脚本主要功能是解密，但依赖于固定的密钥和算法，如果密钥被替换，则可能被用来收集解密信息或进行其他恶意活动。`strings` 函数在提取字符串时，采用了一个相当宽泛的字符集，这可能导致提取出一些不必要的或潜在的恶意数据。 漏洞利用方式是首先利用未经身份验证的配置下载漏洞，然后使用提供的脚本解密配置文件。尽管如此，该脚本的作者可能通过更改 `strings` 函数来匹配特定格式或者使用不同编码来影响解密结果。

**项目地址:** [lastvocher/Hikvision-CVE-2017-7921-decryptor](https://github.com/lastvocher/Hikvision-CVE-2017-7921-decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #16

**来源**: [CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921-Hikvision摄像机认证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需要存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921存在于特定版本的海康威视IP摄像头中，允许未经过身份验证的攻击者通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）下载包含敏感信息的配置文件。该配置文件使用弱加密，攻击者可以使用提供的python脚本进行解密，获取用户名和密码等敏感信息。

**有效性：**
提供的POC代码 `decrypt_configurationFile.py` 用于解密通过漏洞下载的配置文件，因此是有效的。

**投毒风险：**
代码主要功能是解密配置文件，没有发现明显的恶意代码或后门。代码结构清晰，逻辑简单，依赖的库 `pycryptodome` 是一个常见的密码学库。因此，投毒风险较低。

**利用方式：**
1.  构造包含特定base64字符串的URL，例如 `/System/configurationFile?auth=YWRtaW46MTEK`，向目标设备发送请求，下载配置文件。
2.  使用提供的 `decrypt_configurationFile.py` 脚本解密下载的配置文件。
3.  从解密后的配置文件中提取敏感信息，例如用户名和密码。
4.  使用提取的凭据登录设备，或利用其他漏洞进行进一步的攻击。

**项目地址:** [p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #17

**来源**: [CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md](../2017/CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md)

## CVE-2017-7921-Hikvision摄像头未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启HTTP服务且存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 是 Hikvision 摄像头中存在的未授权访问漏洞。漏洞利用代码显示，攻击者可以通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）绕过身份验证，直接访问设备的配置文件。`download.py` 脚本通过读取 IP 地址列表，循环尝试利用该漏洞下载配置文件。`decrypt.py`脚本用于解密下载的配置文件。攻击者可以从中获取敏感信息，如用户名、密码等。

**利用方式：**

1.  准备目标 IP 地址列表。
2.  运行 `download.py` 脚本，该脚本会尝试下载每个 IP 地址对应的摄像头的配置文件。
3.  如果成功下载了配置文件，则使用 `decrypt.py` 脚本进行解密，获取敏感信息。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。

**投毒风险：**

虽然主要功能是实现漏洞利用，但是依旧存在一定的投毒风险。例如:

*   `download.py`脚本中的`dowloadSnapshotImg`函数的功能是下载快照图片，存在被修改为下载恶意文件并执行的风险。
*   脚本中使用的硬编码密钥，存在被替换为恶意密钥的风险，导致解密后的配置文件包含恶意内容。
*   `ip` 文件中IP地址的真实性未知。

因此，综合评估，投毒风险为10%。

**项目地址:** [yousouf-Tasfin/cve-2017-7921-Mass-Exploit](https://github.com/yousouf-Tasfin/cve-2017-7921-Mass-Exploit)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---



---

## POC #6

**来源**: [CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md](../2017/CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md)

## CVE-2017-7921 - Hikvision摄像机未授权访问漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启Web服务且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7921存在于多个Hikvision摄像机型号中，是一个未授权访问漏洞。攻击者无需身份验证即可访问敏感信息或提升权限。

**有效性：**

根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该漏洞是有效的。搜索结果中多个链接都指向了该漏洞的详细描述和分析，并有博客文章提供了如何识别和利用该漏洞的信息。PoC代码尝试通过特定的URL（/Security/users, /System/configurationFile, /onvif-http/snapshot）绕过身份验证，从而获取用户信息、配置文件或摄像机快照。如果目标摄像机存在漏洞，PoC代码很可能会成功利用。

**投毒风险：**

PoC代码主要功能是发送HTTP请求，解析响应，并提取敏感信息。代码中存在加解密函数`decrypt` 和 `xore`, 存在利用漏洞获取用户密码等敏感信息的可能, 但不属于投毒代码。该代码只是为了验证漏洞的存在而编写的，本身不太可能包含恶意代码。因此,投毒风险较低，大概为1%。

**利用方式：**

1.  **确定目标：** 确定目标Hikvision摄像机的IP地址和端口号。
2.  **版本确认：** 确认目标摄像机的固件版本是否在受影响的范围内。
3.  **发送未授权请求：** 使用PoC代码中提供的URL（例如`/Security/users?auth=YWRtaW46MTEK`）向目标摄像机发送未授权请求。
4.  **获取敏感信息：** 如果漏洞存在，摄像机将返回包含用户信息、配置文件或快照图像的数据。
5.  **权限提升（理论上）：** 虽然PoC代码主要演示了信息泄露，但漏洞描述中提到可能导致权限提升。攻击者可以利用泄露的信息进一步尝试获取设备的控制权。

**搜索引擎结果优先级：**
搜索结果提供了漏洞的详细信息，利用方法，受影响范围等信息，因此优先级最高。
**漏洞利用代码优先级：**
PoC代码验证了漏洞的存在，并提供了一种利用漏洞的途径，优先级次之。
**漏洞库信息优先级：**
漏洞库信息提供了漏洞的基本描述和受影响的产品，优先级最低。

**项目地址:** [K3ysTr0K3R/CVE-2017-7921-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-7921-EXPLOIT)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #7

**来源**: [CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md](../2017/CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md)

## CVE-2017-7921-Hikvision摄像机身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530等多个系列产品

**利用条件:** 目标设备需位于网络中，且漏洞版本存在。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision摄像机中发现的一个身份验证绕过漏洞。攻击者可以利用此漏洞，在无需提供有效凭据的情况下，获取设备的未授权访问权限，从而提升权限并访问敏感信息，甚至可能篡改设备配置。漏洞存在于多个系列的Hikvision摄像机固件版本中。根据漏洞利用代码，该漏洞可以通过发送特制的请求绕过身份验证。

**有效性：**
根据漏洞信息和搜索结果显示，此漏洞已经公开披露，并且存在可用的PoC代码。该PoC代码提供了一个Golang实现的利用程序，支持CVE-2017-7921漏洞利用模式和暴力破解模式，说明该漏洞利用的有效性较高。

**投毒风险：**
分析提供的PoC代码，主要功能是漏洞利用和密码爆破。其中，`README.md` 文件提供了详细的构建和使用说明，`go.mod` 和 `go.sum` 文件是Go语言的依赖管理文件，`LICENSE`文件是MIT开源协议。 代码本身看起来像是为了利用这个漏洞而设计的，用于测试和渗透目的。虽然PoC代码本身的功能是实现漏洞利用，但是任何来源不明的代码都存在潜在的风险。 漏洞利用代码使用了github.com上的第三方库，如果这些库被投毒，也可能会影响使用此exp的使用者。综合评估，投毒风险为10%。

**利用方式：**
利用方式主要有两种：
1.  **CVE-2017-7921漏洞利用模式：** 通过发送特定的恶意构造的请求，绕过身份验证，直接获取设备的访问权限。PoC代码中`-e`参数指定此模式，需要指定目标IP和端口。
2.  **暴力破解模式：** 如果直接利用漏洞不可行，PoC代码也支持通过暴力破解来尝试破解设备的密码。PoC代码中`-b`参数指定此模式，需要提供密码字典文件或单个密码，以及目标IP和端口。

攻击者可以通过以下步骤利用该漏洞：
1.  确定目标Hikvision摄像机的IP地址和端口。
2.  使用PoC代码，选择CVE-2017-7921模式或者暴力破解模式。
3.  如果选择CVE-2017-7921模式，直接运行PoC代码即可尝试绕过身份验证。
4.  如果选择暴力破解模式，需要准备密码字典文件，并指定密码字典的路径。
5.  运行PoC代码，等待破解结果。

**项目地址:** [MisakaMikato/cve-2017-7921-golang](https://github.com/MisakaMikato/cve-2017-7921-golang)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #8

**来源**: [CVE-2017-7921-aengussong_hikvision_probe.md](../2017/CVE-2017-7921-aengussong_hikvision_probe.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需开启web服务并且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个存在于多个Hikvision摄像机型号和固件版本中的不当身份验证漏洞。攻击者可以利用此漏洞绕过身份验证，获取敏感信息或提升权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的PoC代码可用。`hikvision_identifier.py` 脚本用于识别存在漏洞的 Hikvision 设备，通过检查 HTTP 响应头中的 `Server` 字段或页面内容中是否包含 `/doc/page/login.asp?_` 来判断。 `hikvision_probe.py` 和 `CVE_2017_7921.py` 用于进一步探测是否存在漏洞，尝试访问一些包含默认认证信息的URL，例如 `/System/time?auth=YWRtaW46UEtTOHVpTWg1UUk4`。如果成功访问，则表明设备存在漏洞。

**投毒风险：**

我分析了提供的PoC代码，并未发现明显的恶意代码。主要功能是发送HTTP请求并检查响应。其中`hikvision_identifier.py`，`hikvision_probe.py`，`CVE_2017_7921.py`脚本中都存在发送网络请求, 存在一定的风险，即作者可以收集用户探测目标，但是从代码功能来看，更倾向于漏洞验证，综上，投毒风险较低。风险概率：5%。

**利用方式：**

1.  **设备识别：** 使用`hikvision_identifier.py`脚本扫描目标网络，识别存在漏洞的Hikvision设备。
2.  **漏洞探测：** 使用`hikvision_probe.py`脚本，它调用`CVE_2017_7921.py`中的`probe_keys`函数，尝试使用默认的`auth`参数访问敏感接口，例如`/System/time`、`/Security/users`、`/System/deviceInfo`等。这些接口返回的信息可能包含设备配置、用户信息等敏感数据。
3.  **权限提升/信息窃取：** 如果漏洞探测成功，攻击者可以使用已泄露的信息（如用户名密码），或者直接利用未授权访问的接口，来提升权限或窃取敏感信息。

总而言之，该漏洞的利用方式相对简单，只需发送特定的HTTP请求即可。因此，成功利用的可能性较高。

**项目地址:** [aengussong/hikvision_probe](https://github.com/aengussong/hikvision_probe)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #9

**来源**: [CVE-2017-7921-b3pwn3d_CVE-2017-7921.md](../2017/CVE-2017-7921-b3pwn3d_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致未授权访问、信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备在受影响的版本范围内，且允许网络访问HTTP(默认80端口)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision相机中存在的一个不当身份验证漏洞。攻击者可以通过构造特殊的HTTP请求绕过身份验证，获取敏感信息，例如用户名和密码，或者提升权限。

**漏洞利用方式：**
1.  攻击者发送一个包含特定`auth`参数的HTTP GET请求到`/Security/users`和`/System/configurationFile`这两个URL。例如：`http://<IP>:<PORT>/Security/users?auth=YWRtaW46MTEK` 和 `http://<IP>:<PORT>/System/configurationFile?auth=YWRtaW46MTEK`
2.  如果设备存在漏洞，服务器会返回包含用户信息的XML或配置文件。
3.  利用脚本中的`config_decryptor`函数解密配置文件中的用户名和密码。

**有效性评估：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码的有效性较高。搜索结果显示，多个来源证实了该漏洞的存在，并且有公开的漏洞利用方法。

**投毒风险评估：**
代码分析表明存在轻微的投毒风险。`exploit_detect.py` 主要功能是检测漏洞和提取凭据。然而，`save_to_file` 函数的存在可能被滥用。攻击者如果控制了该脚本的使用环境，可能会通过修改脚本，将扫描结果发送到攻击者控制的服务器，或者植入其他恶意代码。因此，投毒风险评估为10%。脚本本身利用了已知的漏洞，但其结果收集和处理部分存在潜在的风险。


**项目地址:** [b3pwn3d/CVE-2017-7921](https://github.com/b3pwn3d/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #10

**来源**: [CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Configuration Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于某些版本的 Hikvision IP 摄像头中，允许未经身份验证的攻击者绕过身份验证并下载包含敏感信息的配置文件。根据提供的漏洞利用代码，该漏洞通过在 URL 中提供一个特定的 base64 编码字符串（`auth=YWRtaW46MTEK`）来利用，从而允许下载配置文件。提供的 Python 脚本 `decrypt_configurationFile.py` 用于解密此配置文件。脚本使用 AES 解密（ECB 模式，密钥硬编码为 `279977f62f6cfd2d91cd75b889ce0c9a`）和 XOR 运算（密钥为 `0x73, 0x8B, 0x55, 0x44`）来提取有意义的字符串。有效性：根据漏洞信息和搜索引擎结果，此 POC 有效，可以绕过身份验证并解密敏感配置数据。投毒风险：代码中存在硬编码密钥，虽然这不是恶意投毒，但降低了安全性，如果攻击者修改默认密钥并传播，可能导致只有特定攻击者能利用。脚本本身的功能是解密配置文件，而不是执行恶意操作，因此直接投毒的风险较低。但存在修改脚本以包含其他恶意功能的潜在风险。这里判断投毒风险为5%主要是考虑到存在被其他攻击者修改脚本，放入其他后门的可能性。

**项目地址:** [chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #11

**来源**: [CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md](../2017/CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md)

## CVE-2017-7921 - Hikvision IP Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 权限提升/认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可导致完全控制设备、敏感信息泄露

**影响版本:** 受影响版本见漏洞库信息和漏洞利用代码的描述。

**利用条件:** 目标设备使用受影响的固件版本，且Web端口（通常为80/443）可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 漏洞存在于 Hikvision IP 摄像头中，由于身份验证不当导致。攻击者无需任何凭据即可利用此漏洞，通过发送特制的 HTTP 请求到 `/Security/users` 接口来修改现有用户的密码，包括管理员密码，从而完全控制设备。漏洞利用代码 `main.py` 脚本首先从 `ip.txt` 文件读取 IP 地址列表。然后，对于每个 IP 地址，它通过构造的URL下载配置文件，使用AES解密，再通过XOR解密，最后提取配置文件中的字符串。URL中`auth=YWRtaW46MTEK`绕过认证获取配置文件，获取敏感信息，例如用户名和密码。根据漏洞描述和POC代码，该漏洞利用方式有效。代码中没有发现明显的投毒行为。脚本只是尝试下载、解密和分析设备配置文件。

**项目地址:** [initon/Hikvision---CVE-2017-7921](https://github.com/initon/Hikvision---CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #12

**来源**: [CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md)

## CVE-2017-7921 - 海康威视摄像机不当身份验证漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** 海康威视摄像机

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问目标摄像机，目标摄像机存在漏洞且未修复。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以通过在请求中包含特定的 'auth' 参数（包含base64编码的'用户名:密码'字符串，密码可以任意），绕过身份验证，获取管理员权限。利用此漏洞，攻击者可以访问敏感信息，如摄像机配置，甚至可以修改摄像机固件，导致设备永久损坏或植入恶意代码。

**漏洞利用方式:**

1.  **身份验证绕过:**  攻击者构造包含`auth=YWRtaW46MTEK`参数的HTTP请求，其中`YWRtaW46MTEK`是`admin:11`的Base64编码。由于漏洞的存在，摄像机会错误地认为攻击者已通过身份验证。
2.  **配置信息获取:** 通过访问`http://<camera_ip>/System/configurationFile?auth=YWRtaW46MTEK`端点，攻击者可以下载摄像机的配置信息。
3.  **权限提升:** 攻击者利用绕过的身份验证，可以执行需要管理员权限的操作，例如添加新用户或修改摄像机设置。

**有效性:**

提供的PoC代码 `CVE_2017_7921_EXP.py` 看起来是有效的，它利用了上述漏洞，尝试通过发送包含`auth`参数的请求来获取摄像机的配置信息，并尝试提取用户名和密码。

**投毒风险:**

该PoC代码主要功能是利用漏洞进行信息收集，而非直接植入后门。但是,代码中包含一些潜在的风险，例如：

*   **依赖外部库:** 代码依赖于 `requests` 和 `pycryptodome` 库。虽然这些库本身很常用，但如果攻击者控制了代码的运行环境，可能会通过替换这些库来引入恶意代码。
*   **配置解析:** 代码解析摄像机的配置信息，这可能暴露敏感信息。如果攻击者修改代码，可以将这些信息发送到远程服务器。
*   **异常处理:** 代码中的异常处理相对简单，可能存在未考虑到的异常情况，攻击者可以利用这些异常来执行恶意操作。

总体来说，直接的投毒风险较低（约为5%），主要是代码本身可能被滥用或者被修改后用于其他恶意目的。

**项目地址:** [inj3ction/CVE-2017-7921-EXP](https://github.com/inj3ction/CVE-2017-7921-EXP)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #13

**来源**: [CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md](../2017/CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md)

## CVE-2017-7921-Hikvision Cameras-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问，目标设备运行受影响版本的Hikvision摄像头

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于 Hikvision 摄像头中，由于不当的身份验证，未经身份验证的攻击者可以访问摄像头快照。PoC 代码通过向 `/onvif-http/snapshot?auth=YWRtaW46MTEK` 发送 HTTP GET 请求来利用此漏洞，其中 `YWRtaW46MTEK` 是经过 Base64 编码的用户名 admin 和密码 11。如果状态码为 200 且内容长度大于 100，则认为目标易受攻击。PoC 代码使用多线程加速扫描，并将易受攻击的 URL 写入 vulnerable.txt 文件。

**有效性：**
根据漏洞信息和搜索引擎结果，此 PoC 似乎有效，因为它可以利用身份验证绕过漏洞来获取摄像头快照。

**投毒风险：**
PoC 代码本身主要用于检测漏洞。虽然没有明显的恶意代码，但存在轻微的投毒风险（10%）。
*   该脚本在 vulnerable.txt 文件中追加 URL，如果被大规模利用，可能造成隐私泄露。
*   依赖 `requirements.txt` 安装第三方库，可能存在依赖包被篡改的风险。
*   目标IP列表targets.txt，如果被替换为蜜罐或者恶意IP地址，可能导致扫描者暴露自身。

**利用方式：**
1.  攻击者需要一个包含目标 Hikvision 摄像头 IP 地址的列表（targets.txt）。
2.  攻击者运行 PoC 脚本，脚本会并发地向目标 IP 地址发送特制的 HTTP 请求。
3.  如果摄像头存在漏洞，攻击者可以未经身份验证地访问摄像头快照，或者通过尝试其他的ONVIF接口进行控制。
4.  PoC 会将所有被发现存在漏洞的摄像头的地址保存到 vulnerable.txt 文件中， 方便攻击者后续利用。

**项目地址:** [kooroshsanaei/HikVision-CVE-2017-7921](https://github.com/kooroshsanaei/HikVision-CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #14

**来源**: [CVE-2017-7921-krypton612_hikivision.md](../2017/CVE-2017-7921-krypton612_hikivision.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制和拒绝服务

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备运行受影响的固件版本，并且可以通过HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是 Hikvision IP 摄像机中发现的一个严重漏洞，它允许未经身份验证的攻击者绕过身份验证，并获取对敏感信息的访问权限或提升权限。

**漏洞利用方式：**

该漏洞通过在 URL 中附加特定的字符串 `?auth=YWRtaW46MTEK` 来实现未经授权的访问。这个字符串充当后门，允许攻击者访问各种敏感端点，而无需有效的身份验证。

**利用步骤：**

1.  **确定目标：** 识别运行易受攻击的 Hikvision 摄像机固件版本的设备。
2.  **构造恶意 URL：** 将 `?auth=YWRtaW46MTEK` 附加到摄像机 HTTP/HTTPS URL 的末尾，然后附加目标端点。
3.  **发送请求：** 使用 curl 或任何其他 HTTP 客户端发送构造的 URL 请求。
4.  **获取信息或执行操作：** 根据所使用的端点，攻击者可以检索敏感信息（如设备信息、用户列表、配置文件）或执行操作（如重启或恢复出厂设置）。

**脚本分析：**

*   `exploit.sh` 脚本通过命令行参数获取目标主机、端口和 SSL 设置。它构造带有后门的 URL，然后使用 `curl` 命令发送请求。脚本检查 HTTP 状态码以确定目标是否易受攻击。如果易受攻击，脚本会下载配置文件，并尝试使用 `config-decryptor.py` 脚本对其进行解密，如果解密成功,会提取用户名和密码。
*   `config-decryptor.py` 脚本用于解密下载的配置文件。它使用 AES 解密和 XOR 运算来提取可读信息。这个脚本中没有明显的投毒代码，但要注意该脚本用于处理从目标设备获取的配置信息，可能存在被利用来进行后续攻击的风险。

**投毒风险分析：**

`exploit.sh`脚本本身主要通过拼接URL和调用`curl`获取数据，风险较低。`config-decryptor.py`脚本用于解密配置文件，其中用到了固定的密钥，脚本没有联网行为，恶意修改解密逻辑的可能性较低。整体代码的投毒风险较低,大约为5%。主要是需要人工分析解密后的配置信息,存在人为投毒的风险。


**项目地址:** [krypton612/hikivision](https://github.com/krypton612/hikivision)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #15

**来源**: [CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md](../2017/CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Config Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备位于网络上且可访问,并且运行受影响的固件版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于多个Hikvision IP摄像头型号中，是一个身份验证绕过漏洞。攻击者可以利用该漏洞，通过构造特定的URL（例如`/System/configurationFile?auth=YWRtaW46MTEK`）来下载摄像头的配置文件。这个配置文件包含加密的用户信息。提供的Python脚本`decrypt_configurationFile.py`旨在解密下载的配置文件。脚本首先使用AES算法（ECB模式）和一个硬编码的密钥`279977f62f6cfd2d91cd75b889ce0c9a`来解密配置文件内容，然后使用一个简单的异或操作进行进一步解密。最后，它提取解密后的字符串。虽然核心的解密逻辑看似合理，但存在一些潜在的风险。脚本中硬编码了解密密钥，这使得攻击者可以轻松解密任何通过该漏洞获取的配置文件。投毒风险较低，因为脚本主要功能是解密，但依赖于固定的密钥和算法，如果密钥被替换，则可能被用来收集解密信息或进行其他恶意活动。`strings` 函数在提取字符串时，采用了一个相当宽泛的字符集，这可能导致提取出一些不必要的或潜在的恶意数据。 漏洞利用方式是首先利用未经身份验证的配置下载漏洞，然后使用提供的脚本解密配置文件。尽管如此，该脚本的作者可能通过更改 `strings` 函数来匹配特定格式或者使用不同编码来影响解密结果。

**项目地址:** [lastvocher/Hikvision-CVE-2017-7921-decryptor](https://github.com/lastvocher/Hikvision-CVE-2017-7921-decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #16

**来源**: [CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921-Hikvision摄像机认证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需要存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921存在于特定版本的海康威视IP摄像头中，允许未经过身份验证的攻击者通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）下载包含敏感信息的配置文件。该配置文件使用弱加密，攻击者可以使用提供的python脚本进行解密，获取用户名和密码等敏感信息。

**有效性：**
提供的POC代码 `decrypt_configurationFile.py` 用于解密通过漏洞下载的配置文件，因此是有效的。

**投毒风险：**
代码主要功能是解密配置文件，没有发现明显的恶意代码或后门。代码结构清晰，逻辑简单，依赖的库 `pycryptodome` 是一个常见的密码学库。因此，投毒风险较低。

**利用方式：**
1.  构造包含特定base64字符串的URL，例如 `/System/configurationFile?auth=YWRtaW46MTEK`，向目标设备发送请求，下载配置文件。
2.  使用提供的 `decrypt_configurationFile.py` 脚本解密下载的配置文件。
3.  从解密后的配置文件中提取敏感信息，例如用户名和密码。
4.  使用提取的凭据登录设备，或利用其他漏洞进行进一步的攻击。

**项目地址:** [p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #17

**来源**: [CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md](../2017/CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md)

## CVE-2017-7921-Hikvision摄像头未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启HTTP服务且存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 是 Hikvision 摄像头中存在的未授权访问漏洞。漏洞利用代码显示，攻击者可以通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）绕过身份验证，直接访问设备的配置文件。`download.py` 脚本通过读取 IP 地址列表，循环尝试利用该漏洞下载配置文件。`decrypt.py`脚本用于解密下载的配置文件。攻击者可以从中获取敏感信息，如用户名、密码等。

**利用方式：**

1.  准备目标 IP 地址列表。
2.  运行 `download.py` 脚本，该脚本会尝试下载每个 IP 地址对应的摄像头的配置文件。
3.  如果成功下载了配置文件，则使用 `decrypt.py` 脚本进行解密，获取敏感信息。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。

**投毒风险：**

虽然主要功能是实现漏洞利用，但是依旧存在一定的投毒风险。例如:

*   `download.py`脚本中的`dowloadSnapshotImg`函数的功能是下载快照图片，存在被修改为下载恶意文件并执行的风险。
*   脚本中使用的硬编码密钥，存在被替换为恶意密钥的风险，导致解密后的配置文件包含恶意内容。
*   `ip` 文件中IP地址的真实性未知。

因此，综合评估，投毒风险为10%。

**项目地址:** [yousouf-Tasfin/cve-2017-7921-Mass-Exploit](https://github.com/yousouf-Tasfin/cve-2017-7921-Mass-Exploit)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---



---

## POC #6

**来源**: [CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md](../2017/CVE-2017-7921-K3ysTr0K3R_CVE-2017-7921-EXPLOIT.md)

## CVE-2017-7921 - Hikvision摄像机未授权访问漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启Web服务且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7921存在于多个Hikvision摄像机型号中，是一个未授权访问漏洞。攻击者无需身份验证即可访问敏感信息或提升权限。

**有效性：**

根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该漏洞是有效的。搜索结果中多个链接都指向了该漏洞的详细描述和分析，并有博客文章提供了如何识别和利用该漏洞的信息。PoC代码尝试通过特定的URL（/Security/users, /System/configurationFile, /onvif-http/snapshot）绕过身份验证，从而获取用户信息、配置文件或摄像机快照。如果目标摄像机存在漏洞，PoC代码很可能会成功利用。

**投毒风险：**

PoC代码主要功能是发送HTTP请求，解析响应，并提取敏感信息。代码中存在加解密函数`decrypt` 和 `xore`, 存在利用漏洞获取用户密码等敏感信息的可能, 但不属于投毒代码。该代码只是为了验证漏洞的存在而编写的，本身不太可能包含恶意代码。因此,投毒风险较低，大概为1%。

**利用方式：**

1.  **确定目标：** 确定目标Hikvision摄像机的IP地址和端口号。
2.  **版本确认：** 确认目标摄像机的固件版本是否在受影响的范围内。
3.  **发送未授权请求：** 使用PoC代码中提供的URL（例如`/Security/users?auth=YWRtaW46MTEK`）向目标摄像机发送未授权请求。
4.  **获取敏感信息：** 如果漏洞存在，摄像机将返回包含用户信息、配置文件或快照图像的数据。
5.  **权限提升（理论上）：** 虽然PoC代码主要演示了信息泄露，但漏洞描述中提到可能导致权限提升。攻击者可以利用泄露的信息进一步尝试获取设备的控制权。

**搜索引擎结果优先级：**
搜索结果提供了漏洞的详细信息，利用方法，受影响范围等信息，因此优先级最高。
**漏洞利用代码优先级：**
PoC代码验证了漏洞的存在，并提供了一种利用漏洞的途径，优先级次之。
**漏洞库信息优先级：**
漏洞库信息提供了漏洞的基本描述和受影响的产品，优先级最低。

**项目地址:** [K3ysTr0K3R/CVE-2017-7921-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-7921-EXPLOIT)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #7

**来源**: [CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md](../2017/CVE-2017-7921-MisakaMikato_cve-2017-7921-golang.md)

## CVE-2017-7921-Hikvision摄像机身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530等多个系列产品

**利用条件:** 目标设备需位于网络中，且漏洞版本存在。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision摄像机中发现的一个身份验证绕过漏洞。攻击者可以利用此漏洞，在无需提供有效凭据的情况下，获取设备的未授权访问权限，从而提升权限并访问敏感信息，甚至可能篡改设备配置。漏洞存在于多个系列的Hikvision摄像机固件版本中。根据漏洞利用代码，该漏洞可以通过发送特制的请求绕过身份验证。

**有效性：**
根据漏洞信息和搜索结果显示，此漏洞已经公开披露，并且存在可用的PoC代码。该PoC代码提供了一个Golang实现的利用程序，支持CVE-2017-7921漏洞利用模式和暴力破解模式，说明该漏洞利用的有效性较高。

**投毒风险：**
分析提供的PoC代码，主要功能是漏洞利用和密码爆破。其中，`README.md` 文件提供了详细的构建和使用说明，`go.mod` 和 `go.sum` 文件是Go语言的依赖管理文件，`LICENSE`文件是MIT开源协议。 代码本身看起来像是为了利用这个漏洞而设计的，用于测试和渗透目的。虽然PoC代码本身的功能是实现漏洞利用，但是任何来源不明的代码都存在潜在的风险。 漏洞利用代码使用了github.com上的第三方库，如果这些库被投毒，也可能会影响使用此exp的使用者。综合评估，投毒风险为10%。

**利用方式：**
利用方式主要有两种：
1.  **CVE-2017-7921漏洞利用模式：** 通过发送特定的恶意构造的请求，绕过身份验证，直接获取设备的访问权限。PoC代码中`-e`参数指定此模式，需要指定目标IP和端口。
2.  **暴力破解模式：** 如果直接利用漏洞不可行，PoC代码也支持通过暴力破解来尝试破解设备的密码。PoC代码中`-b`参数指定此模式，需要提供密码字典文件或单个密码，以及目标IP和端口。

攻击者可以通过以下步骤利用该漏洞：
1.  确定目标Hikvision摄像机的IP地址和端口。
2.  使用PoC代码，选择CVE-2017-7921模式或者暴力破解模式。
3.  如果选择CVE-2017-7921模式，直接运行PoC代码即可尝试绕过身份验证。
4.  如果选择暴力破解模式，需要准备密码字典文件，并指定密码字典的路径。
5.  运行PoC代码，等待破解结果。

**项目地址:** [MisakaMikato/cve-2017-7921-golang](https://github.com/MisakaMikato/cve-2017-7921-golang)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #8

**来源**: [CVE-2017-7921-aengussong_hikvision_probe.md](../2017/CVE-2017-7921-aengussong_hikvision_probe.md)

## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需开启web服务并且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个存在于多个Hikvision摄像机型号和固件版本中的不当身份验证漏洞。攻击者可以利用此漏洞绕过身份验证，获取敏感信息或提升权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的PoC代码可用。`hikvision_identifier.py` 脚本用于识别存在漏洞的 Hikvision 设备，通过检查 HTTP 响应头中的 `Server` 字段或页面内容中是否包含 `/doc/page/login.asp?_` 来判断。 `hikvision_probe.py` 和 `CVE_2017_7921.py` 用于进一步探测是否存在漏洞，尝试访问一些包含默认认证信息的URL，例如 `/System/time?auth=YWRtaW46UEtTOHVpTWg1UUk4`。如果成功访问，则表明设备存在漏洞。

**投毒风险：**

我分析了提供的PoC代码，并未发现明显的恶意代码。主要功能是发送HTTP请求并检查响应。其中`hikvision_identifier.py`，`hikvision_probe.py`，`CVE_2017_7921.py`脚本中都存在发送网络请求, 存在一定的风险，即作者可以收集用户探测目标，但是从代码功能来看，更倾向于漏洞验证，综上，投毒风险较低。风险概率：5%。

**利用方式：**

1.  **设备识别：** 使用`hikvision_identifier.py`脚本扫描目标网络，识别存在漏洞的Hikvision设备。
2.  **漏洞探测：** 使用`hikvision_probe.py`脚本，它调用`CVE_2017_7921.py`中的`probe_keys`函数，尝试使用默认的`auth`参数访问敏感接口，例如`/System/time`、`/Security/users`、`/System/deviceInfo`等。这些接口返回的信息可能包含设备配置、用户信息等敏感数据。
3.  **权限提升/信息窃取：** 如果漏洞探测成功，攻击者可以使用已泄露的信息（如用户名密码），或者直接利用未授权访问的接口，来提升权限或窃取敏感信息。

总而言之，该漏洞的利用方式相对简单，只需发送特定的HTTP请求即可。因此，成功利用的可能性较高。

**项目地址:** [aengussong/hikvision_probe](https://github.com/aengussong/hikvision_probe)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #9

**来源**: [CVE-2017-7921-b3pwn3d_CVE-2017-7921.md](../2017/CVE-2017-7921-b3pwn3d_CVE-2017-7921.md)

## CVE-2017-7921-Hikvision-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致未授权访问、信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备在受影响的版本范围内，且允许网络访问HTTP(默认80端口)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision相机中存在的一个不当身份验证漏洞。攻击者可以通过构造特殊的HTTP请求绕过身份验证，获取敏感信息，例如用户名和密码，或者提升权限。

**漏洞利用方式：**
1.  攻击者发送一个包含特定`auth`参数的HTTP GET请求到`/Security/users`和`/System/configurationFile`这两个URL。例如：`http://<IP>:<PORT>/Security/users?auth=YWRtaW46MTEK` 和 `http://<IP>:<PORT>/System/configurationFile?auth=YWRtaW46MTEK`
2.  如果设备存在漏洞，服务器会返回包含用户信息的XML或配置文件。
3.  利用脚本中的`config_decryptor`函数解密配置文件中的用户名和密码。

**有效性评估：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码的有效性较高。搜索结果显示，多个来源证实了该漏洞的存在，并且有公开的漏洞利用方法。

**投毒风险评估：**
代码分析表明存在轻微的投毒风险。`exploit_detect.py` 主要功能是检测漏洞和提取凭据。然而，`save_to_file` 函数的存在可能被滥用。攻击者如果控制了该脚本的使用环境，可能会通过修改脚本，将扫描结果发送到攻击者控制的服务器，或者植入其他恶意代码。因此，投毒风险评估为10%。脚本本身利用了已知的漏洞，但其结果收集和处理部分存在潜在的风险。


**项目地址:** [b3pwn3d/CVE-2017-7921](https://github.com/b3pwn3d/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #10

**来源**: [CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-chrisjd20_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Configuration Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于某些版本的 Hikvision IP 摄像头中，允许未经身份验证的攻击者绕过身份验证并下载包含敏感信息的配置文件。根据提供的漏洞利用代码，该漏洞通过在 URL 中提供一个特定的 base64 编码字符串（`auth=YWRtaW46MTEK`）来利用，从而允许下载配置文件。提供的 Python 脚本 `decrypt_configurationFile.py` 用于解密此配置文件。脚本使用 AES 解密（ECB 模式，密钥硬编码为 `279977f62f6cfd2d91cd75b889ce0c9a`）和 XOR 运算（密钥为 `0x73, 0x8B, 0x55, 0x44`）来提取有意义的字符串。有效性：根据漏洞信息和搜索引擎结果，此 POC 有效，可以绕过身份验证并解密敏感配置数据。投毒风险：代码中存在硬编码密钥，虽然这不是恶意投毒，但降低了安全性，如果攻击者修改默认密钥并传播，可能导致只有特定攻击者能利用。脚本本身的功能是解密配置文件，而不是执行恶意操作，因此直接投毒的风险较低。但存在修改脚本以包含其他恶意功能的潜在风险。这里判断投毒风险为5%主要是考虑到存在被其他攻击者修改脚本，放入其他后门的可能性。

**项目地址:** [chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #11

**来源**: [CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md](../2017/CVE-2017-7921-initon_Hikvision---CVE-2017-7921.md)

## CVE-2017-7921 - Hikvision IP Camera Improper Authentication

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 权限提升/认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可导致完全控制设备、敏感信息泄露

**影响版本:** 受影响版本见漏洞库信息和漏洞利用代码的描述。

**利用条件:** 目标设备使用受影响的固件版本，且Web端口（通常为80/443）可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 漏洞存在于 Hikvision IP 摄像头中，由于身份验证不当导致。攻击者无需任何凭据即可利用此漏洞，通过发送特制的 HTTP 请求到 `/Security/users` 接口来修改现有用户的密码，包括管理员密码，从而完全控制设备。漏洞利用代码 `main.py` 脚本首先从 `ip.txt` 文件读取 IP 地址列表。然后，对于每个 IP 地址，它通过构造的URL下载配置文件，使用AES解密，再通过XOR解密，最后提取配置文件中的字符串。URL中`auth=YWRtaW46MTEK`绕过认证获取配置文件，获取敏感信息，例如用户名和密码。根据漏洞描述和POC代码，该漏洞利用方式有效。代码中没有发现明显的投毒行为。脚本只是尝试下载、解密和分析设备配置文件。

**项目地址:** [initon/Hikvision---CVE-2017-7921](https://github.com/initon/Hikvision---CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #12

**来源**: [CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md](../2017/CVE-2017-7921-inj3ction_CVE-2017-7921-EXP.md)

## CVE-2017-7921 - 海康威视摄像机不当身份验证漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** 海康威视摄像机

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问目标摄像机，目标摄像机存在漏洞且未修复。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以通过在请求中包含特定的 'auth' 参数（包含base64编码的'用户名:密码'字符串，密码可以任意），绕过身份验证，获取管理员权限。利用此漏洞，攻击者可以访问敏感信息，如摄像机配置，甚至可以修改摄像机固件，导致设备永久损坏或植入恶意代码。

**漏洞利用方式:**

1.  **身份验证绕过:**  攻击者构造包含`auth=YWRtaW46MTEK`参数的HTTP请求，其中`YWRtaW46MTEK`是`admin:11`的Base64编码。由于漏洞的存在，摄像机会错误地认为攻击者已通过身份验证。
2.  **配置信息获取:** 通过访问`http://<camera_ip>/System/configurationFile?auth=YWRtaW46MTEK`端点，攻击者可以下载摄像机的配置信息。
3.  **权限提升:** 攻击者利用绕过的身份验证，可以执行需要管理员权限的操作，例如添加新用户或修改摄像机设置。

**有效性:**

提供的PoC代码 `CVE_2017_7921_EXP.py` 看起来是有效的，它利用了上述漏洞，尝试通过发送包含`auth`参数的请求来获取摄像机的配置信息，并尝试提取用户名和密码。

**投毒风险:**

该PoC代码主要功能是利用漏洞进行信息收集，而非直接植入后门。但是,代码中包含一些潜在的风险，例如：

*   **依赖外部库:** 代码依赖于 `requests` 和 `pycryptodome` 库。虽然这些库本身很常用，但如果攻击者控制了代码的运行环境，可能会通过替换这些库来引入恶意代码。
*   **配置解析:** 代码解析摄像机的配置信息，这可能暴露敏感信息。如果攻击者修改代码，可以将这些信息发送到远程服务器。
*   **异常处理:** 代码中的异常处理相对简单，可能存在未考虑到的异常情况，攻击者可以利用这些异常来执行恶意操作。

总体来说，直接的投毒风险较低（约为5%），主要是代码本身可能被滥用或者被修改后用于其他恶意目的。

**项目地址:** [inj3ction/CVE-2017-7921-EXP](https://github.com/inj3ction/CVE-2017-7921-EXP)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #13

**来源**: [CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md](../2017/CVE-2017-7921-kooroshsanaei_HikVision-CVE-2017-7921.md)

## CVE-2017-7921-Hikvision Cameras-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问，目标设备运行受影响版本的Hikvision摄像头

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于 Hikvision 摄像头中，由于不当的身份验证，未经身份验证的攻击者可以访问摄像头快照。PoC 代码通过向 `/onvif-http/snapshot?auth=YWRtaW46MTEK` 发送 HTTP GET 请求来利用此漏洞，其中 `YWRtaW46MTEK` 是经过 Base64 编码的用户名 admin 和密码 11。如果状态码为 200 且内容长度大于 100，则认为目标易受攻击。PoC 代码使用多线程加速扫描，并将易受攻击的 URL 写入 vulnerable.txt 文件。

**有效性：**
根据漏洞信息和搜索引擎结果，此 PoC 似乎有效，因为它可以利用身份验证绕过漏洞来获取摄像头快照。

**投毒风险：**
PoC 代码本身主要用于检测漏洞。虽然没有明显的恶意代码，但存在轻微的投毒风险（10%）。
*   该脚本在 vulnerable.txt 文件中追加 URL，如果被大规模利用，可能造成隐私泄露。
*   依赖 `requirements.txt` 安装第三方库，可能存在依赖包被篡改的风险。
*   目标IP列表targets.txt，如果被替换为蜜罐或者恶意IP地址，可能导致扫描者暴露自身。

**利用方式：**
1.  攻击者需要一个包含目标 Hikvision 摄像头 IP 地址的列表（targets.txt）。
2.  攻击者运行 PoC 脚本，脚本会并发地向目标 IP 地址发送特制的 HTTP 请求。
3.  如果摄像头存在漏洞，攻击者可以未经身份验证地访问摄像头快照，或者通过尝试其他的ONVIF接口进行控制。
4.  PoC 会将所有被发现存在漏洞的摄像头的地址保存到 vulnerable.txt 文件中， 方便攻击者后续利用。

**项目地址:** [kooroshsanaei/HikVision-CVE-2017-7921](https://github.com/kooroshsanaei/HikVision-CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #14

**来源**: [CVE-2017-7921-krypton612_hikivision.md](../2017/CVE-2017-7921-krypton612_hikivision.md)

## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制和拒绝服务

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备运行受影响的固件版本，并且可以通过HTTP/HTTPS访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 是 Hikvision IP 摄像机中发现的一个严重漏洞，它允许未经身份验证的攻击者绕过身份验证，并获取对敏感信息的访问权限或提升权限。

**漏洞利用方式：**

该漏洞通过在 URL 中附加特定的字符串 `?auth=YWRtaW46MTEK` 来实现未经授权的访问。这个字符串充当后门，允许攻击者访问各种敏感端点，而无需有效的身份验证。

**利用步骤：**

1.  **确定目标：** 识别运行易受攻击的 Hikvision 摄像机固件版本的设备。
2.  **构造恶意 URL：** 将 `?auth=YWRtaW46MTEK` 附加到摄像机 HTTP/HTTPS URL 的末尾，然后附加目标端点。
3.  **发送请求：** 使用 curl 或任何其他 HTTP 客户端发送构造的 URL 请求。
4.  **获取信息或执行操作：** 根据所使用的端点，攻击者可以检索敏感信息（如设备信息、用户列表、配置文件）或执行操作（如重启或恢复出厂设置）。

**脚本分析：**

*   `exploit.sh` 脚本通过命令行参数获取目标主机、端口和 SSL 设置。它构造带有后门的 URL，然后使用 `curl` 命令发送请求。脚本检查 HTTP 状态码以确定目标是否易受攻击。如果易受攻击，脚本会下载配置文件，并尝试使用 `config-decryptor.py` 脚本对其进行解密，如果解密成功,会提取用户名和密码。
*   `config-decryptor.py` 脚本用于解密下载的配置文件。它使用 AES 解密和 XOR 运算来提取可读信息。这个脚本中没有明显的投毒代码，但要注意该脚本用于处理从目标设备获取的配置信息，可能存在被利用来进行后续攻击的风险。

**投毒风险分析：**

`exploit.sh`脚本本身主要通过拼接URL和调用`curl`获取数据，风险较低。`config-decryptor.py`脚本用于解密配置文件，其中用到了固定的密钥，脚本没有联网行为，恶意修改解密逻辑的可能性较低。整体代码的投毒风险较低,大约为5%。主要是需要人工分析解密后的配置信息,存在人为投毒的风险。


**项目地址:** [krypton612/hikivision](https://github.com/krypton612/hikivision)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #15

**来源**: [CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md](../2017/CVE-2017-7921-lastvocher_Hikvision-CVE-2017-7921-decryptor.md)

## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Config Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备位于网络上且可访问,并且运行受影响的固件版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于多个Hikvision IP摄像头型号中，是一个身份验证绕过漏洞。攻击者可以利用该漏洞，通过构造特定的URL（例如`/System/configurationFile?auth=YWRtaW46MTEK`）来下载摄像头的配置文件。这个配置文件包含加密的用户信息。提供的Python脚本`decrypt_configurationFile.py`旨在解密下载的配置文件。脚本首先使用AES算法（ECB模式）和一个硬编码的密钥`279977f62f6cfd2d91cd75b889ce0c9a`来解密配置文件内容，然后使用一个简单的异或操作进行进一步解密。最后，它提取解密后的字符串。虽然核心的解密逻辑看似合理，但存在一些潜在的风险。脚本中硬编码了解密密钥，这使得攻击者可以轻松解密任何通过该漏洞获取的配置文件。投毒风险较低，因为脚本主要功能是解密，但依赖于固定的密钥和算法，如果密钥被替换，则可能被用来收集解密信息或进行其他恶意活动。`strings` 函数在提取字符串时，采用了一个相当宽泛的字符集，这可能导致提取出一些不必要的或潜在的恶意数据。 漏洞利用方式是首先利用未经身份验证的配置下载漏洞，然后使用提供的脚本解密配置文件。尽管如此，该脚本的作者可能通过更改 `strings` 函数来匹配特定格式或者使用不同编码来影响解密结果。

**项目地址:** [lastvocher/Hikvision-CVE-2017-7921-decryptor](https://github.com/lastvocher/Hikvision-CVE-2017-7921-decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #16

**来源**: [CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md](../2017/CVE-2017-7921-p4tq_hikvision_CVE-2017-7921_auth_bypass_config_decryptor.md)

## CVE-2017-7921-Hikvision摄像机认证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需要存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921存在于特定版本的海康威视IP摄像头中，允许未经过身份验证的攻击者通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）下载包含敏感信息的配置文件。该配置文件使用弱加密，攻击者可以使用提供的python脚本进行解密，获取用户名和密码等敏感信息。

**有效性：**
提供的POC代码 `decrypt_configurationFile.py` 用于解密通过漏洞下载的配置文件，因此是有效的。

**投毒风险：**
代码主要功能是解密配置文件，没有发现明显的恶意代码或后门。代码结构清晰，逻辑简单，依赖的库 `pycryptodome` 是一个常见的密码学库。因此，投毒风险较低。

**利用方式：**
1.  构造包含特定base64字符串的URL，例如 `/System/configurationFile?auth=YWRtaW46MTEK`，向目标设备发送请求，下载配置文件。
2.  使用提供的 `decrypt_configurationFile.py` 脚本解密下载的配置文件。
3.  从解密后的配置文件中提取敏感信息，例如用户名和密码。
4.  使用提取的凭据登录设备，或利用其他漏洞进行进一步的攻击。

**项目地址:** [p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

## POC #17

**来源**: [CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md](../2017/CVE-2017-7921-yousouf-Tasfin_cve-2017-7921-Mass-Exploit.md)

## CVE-2017-7921-Hikvision摄像头未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启HTTP服务且存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 是 Hikvision 摄像头中存在的未授权访问漏洞。漏洞利用代码显示，攻击者可以通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）绕过身份验证，直接访问设备的配置文件。`download.py` 脚本通过读取 IP 地址列表，循环尝试利用该漏洞下载配置文件。`decrypt.py`脚本用于解密下载的配置文件。攻击者可以从中获取敏感信息，如用户名、密码等。

**利用方式：**

1.  准备目标 IP 地址列表。
2.  运行 `download.py` 脚本，该脚本会尝试下载每个 IP 地址对应的摄像头的配置文件。
3.  如果成功下载了配置文件，则使用 `decrypt.py` 脚本进行解密，获取敏感信息。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。

**投毒风险：**

虽然主要功能是实现漏洞利用，但是依旧存在一定的投毒风险。例如:

*   `download.py`脚本中的`dowloadSnapshotImg`函数的功能是下载快照图片，存在被修改为下载恶意文件并执行的风险。
*   脚本中使用的硬编码密钥，存在被替换为恶意密钥的风险，导致解密后的配置文件包含恶意内容。
*   `ip` 文件中IP地址的真实性未知。

因此，综合评估，投毒风险为10%。

**项目地址:** [yousouf-Tasfin/cve-2017-7921-Mass-Exploit](https://github.com/yousouf-Tasfin/cve-2017-7921-Mass-Exploit)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)

---

