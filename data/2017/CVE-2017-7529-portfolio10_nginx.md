## CVE-2017-7529 - Nginx 越界读取

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 越界读取

**影响应用:** Nginx

**危害等级:** 高危

**CVSS评分:** 7.5 (根据搜索结果综合判断)

**影响版本:** Nginx 0.5.6 – 1.13.2 (根据vulhub)

**利用条件:** 需要开启proxy_cache，且攻击者可以发送特制的HTTP Range请求

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2017-7529是Nginx中的一个越界读取缓存漏洞。该漏洞存在于Nginx的range filter中，由于处理HTTP头中Range字段不当导致。攻击者可以通过发送特制的HTTP Range请求，触发整数溢出，从而读取到缓存中的其他敏感信息。

POC有效性分析：
提供的POC代码由Dockerfile, docker-compose.yml, poc.py, conf.d/default.conf组成。Dockerfile定义了运行POC所需的环境，docker-compose.yml编排了Nginx服务和相关的配置，poc.py是漏洞利用脚本，default.conf是Nginx的配置文件。利用步骤如下：
1.  使用docker-compose启动Nginx服务。
2.  运行poc.py脚本，指定目标URL。脚本会计算出合适的Range头，并发送请求。
3.  如果漏洞存在，Nginx会返回缓存中其他数据，证明POC有效。

POC代码使用Python编写，主要功能是发送带有特制Range头的HTTP请求。首先，脚本接收目标URL作为参数。然后，它获取目标URL的内容长度，并根据内容长度计算出Range头的值。最后，脚本发送带有Range头的HTTP请求，并将响应内容打印出来。

该POC的有效性较高，因为它模拟了真实的攻击场景，并且可以成功读取到缓存中的其他信息。但是，该POC也有一些限制。例如，它只能读取缓存中的信息，而不能修改缓存中的信息。此外，该POC只能在特定的Nginx版本上运行。

利用步骤：
1. 搭建存在漏洞的Nginx环境，开启proxy_cache功能。
2. 准备一个可以被缓存的资源。
3. 使用POC脚本，指定目标URL和offset，发送恶意构造的Range请求。
4. 检查响应内容，如果包含其他缓存资源的内容，则漏洞利用成功。

投毒风险分析：
该POC的投毒风险较低，因为它的代码比较简单，并且只使用了标准库。该POC没有包含任何恶意代码，例如后门或病毒。但是，该POC仍然存在一定的风险。例如，攻击者可能会修改该POC的代码，使其包含恶意代码。此外，攻击者可能会使用该POC攻击其他系统。该POC本身的功能是利用Nginx的漏洞读取缓存中的数据，本身不包含植入后门或者执行恶意代码的功能。代码中涉及的requests库是常用的HTTP请求库，没有发现可疑的函数调用或者外部脚本引用。

风险主要来自于如果攻击者修改了poc.py，例如添加了将读取到的信息发送到恶意服务器的代码，或者直接在目标服务器上执行命令，那么就存在投毒的风险。但从目前的代码来看，投毒风险较低，主要集中在利用该漏洞进行信息泄露的可能性。

综合来看，该POC的投毒风险较低，约为10%。

**项目地址:** https://github.com/liusec/CVE-2017-7529

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2017-7529
