# CVE-2017-7269

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7269-Al1ex_CVE-2017-7269.md](../2017/CVE-2017-7269-Al1ex_CVE-2017-7269.md)

## CVE-2017-7269 Microsoft IIS WebDav ScStoragePathFromUrl Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 开启WebDAV服务的IIS 6.0

**利用条件:** 需要目标服务器开启WebDAV服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0 WebDAV服务中的缓冲区溢出漏洞。攻击者可以通过发送一个包含特制`If:`头的`PROPFIND`请求来利用此漏洞，其中`If:`头包含一个超长的URL，导致`ScStoragePathFromUrl`函数处理时发生缓冲区溢出，从而执行任意代码。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞被广泛报告和利用，存在公开可用的POC，并且Metasploit框架中也存在相应的利用模块。因此，可以认为提供的POC代码是有效的。

**投毒风险评估：**

提供的POC代码是一个Metasploit模块，主要功能是构造恶意的HTTP请求来触发缓冲区溢出。代码中包含一些用于计算缓冲区大小和构造溢出数据的逻辑，以及用于执行payload的部分。经过分析，没有发现明显的恶意代码或后门，该exp主要通过精心构造的payload实现攻击目的，没有发现隐藏的、非预期的恶意行为。因此，投毒风险较低。

**利用方式分析：**

1.  **漏洞触发：** 攻击者向目标IIS 6.0服务器发送一个`PROPFIND`请求，该请求的`If:` header 包含一个以`http://`开头的极长的URL。
2.  **缓冲区溢出：** IIS 6.0的WebDAV服务中的`ScStoragePathFromUrl`函数在处理该URL时，由于未正确检查URL的长度，导致缓冲区溢出。
3.  **代码执行：** 攻击者可以通过控制溢出的数据来覆盖内存中的关键区域，例如函数返回地址，从而执行任意代码。
4.  **Payload执行：** Metasploit模块通常会将shellcode作为payload注入到溢出缓冲区中，当程序执行到被覆盖的返回地址时，shellcode会被执行，从而允许攻击者在目标服务器上运行任意命令。
5.  **利用细节：**
    * 模块中可以自定义HttpHost和PhysicalPathLength两个参数. PhysicalPathLength的值需要根据目标服务器的物理路径长度进行调整，如果配置不正确，可能导致利用失败。
    * Payload使用了AlphanumUnicodeMixed编码,为了绕过某些检测.
    * 利用过程中需要确保目标服务器开启了WebDAV服务。

**项目地址:** [Al1ex/CVE-2017-7269](https://github.com/Al1ex/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #2

**来源**: [CVE-2017-7269-Cappricio-Securities_CVE-2017-7269.md](../2017/CVE-2017-7269-Cappricio-Securities_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行未打补丁的 Microsoft IIS 6.0，并且启用了 WebDAV 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中 ScStoragePathFromUrl 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制 'If:' 头部的 PROPFIND 请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Python脚本），可以判断该漏洞利用是有效的。多个来源表明该漏洞已被广泛利用，并且存在公开的 Metasploit 模块和 Python 脚本。

**投毒风险：**
提供的漏洞利用代码主要是一个漏洞扫描器，用于检测目标是否存在 CVE-2017-7269 漏洞。 通过快速浏览，发现该脚本还集成了 Telegram 通知功能。虽然没有发现明显的恶意代码，但依然存在一定的风险，例如：
*   **依赖风险：** 该脚本依赖于多个Python库，这些库可能存在安全问题，或者被恶意篡改。
*   **Telegram API 密钥泄露：** 如果攻击者获取了用于Telegram通知的 API 密钥，则可以滥用该功能。
*   **报告欺骗：** 扫描器可能会产生误报或者漏报，攻击者可能会利用此弱点。
*   **信息收集：** 该工具可能会收集目标服务器的信息并发送到外部服务器(通过Telegram)。

综合考虑，投毒风险评定为10%，主要是由于脚本依赖项和潜在的滥用风险。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP PROPFIND 请求，该请求包含一个特别长的 'If:' 头部。该头部的内容以 "If: <http://" 开头。
2.  当 IIS 6.0 的 WebDAV 服务处理这个请求时，`ScStoragePathFromUrl` 函数会因为没有正确检查输入长度而发生缓冲区溢出。
3.  攻击者可以通过精心设计的溢出数据覆盖内存中的关键区域，例如函数返回地址。
4.  通过控制返回地址，攻击者可以将程序执行流程劫持到预先设定的恶意代码，从而在目标服务器上执行任意命令。

**项目地址:** [Cappricio-Securities/CVE-2017-7269](https://github.com/Cappricio-Securities/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #3

**来源**: [CVE-2017-7269-ThanHuuTuan_CVE-2017-7269.md](../2017/CVE-2017-7269-ThanHuuTuan_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，且WebDAV服务已启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是Microsoft IIS 6.0中WebDAV服务`ScStoragePathFromUrl`函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含特别构造的“If:”头部的PROPFIND请求，触发缓冲区溢出，从而在目标系统上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息明确指出该漏洞在野外被利用。搜索结果显示，在漏洞公布后的一段时间内，出现了多次利用该漏洞进行攻击的活动，包括挖矿等。

**投毒风险评估：**
提供的POC代码(`/tmp/3af7177f0aabdb4a97a12f1832e1516f/webdav-validation.py`) 主要是用来验证目标服务器是否存在CVE-2017-7269漏洞。该脚本的功能是发送特定格式的HTTP请求，然后根据服务器的响应来判断漏洞是否存在。该脚本本身并没有包含任何恶意代码，因此投毒风险评估为0%。

**利用方式分析：**
1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的“If:”头部包含一个超长的字符串。
2.  当IIS 6.0处理该请求时，`ScStoragePathFromUrl`函数会将“If:”头部的内容复制到缓冲区中，由于没有进行充分的边界检查，导致缓冲区溢出。
3.  攻击者可以通过控制溢出的内容，覆盖内存中的关键数据，例如函数返回地址，从而劫持程序的执行流程。
4.  攻击者可以将shellcode注入到内存中，并将返回地址指向shellcode的起始地址，当函数返回时，shellcode就会被执行，从而实现远程代码执行。

**项目地址:** [ThanHuuTuan/CVE-2017-7269](https://github.com/ThanHuuTuan/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #4

**来源**: [CVE-2017-7269-VanishedPeople_CVE-2017-7269.md](../2017/CVE-2017-7269-VanishedPeople_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0 WebDAV

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行着易受攻击的IIS 6.0，并且WebDAV服务已启用。需要网络可达性，并能发送特制的HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 ScStoragePathFromUrl 函数中的一个缓冲区溢出漏洞。攻击者可以通过发送包含一个长 "If: <http://" 开头的 header 的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。提供的漏洞利用代码 CVE-2017-7269.py 实现了该漏洞的利用，通过构造特定的 HTTP 请求，覆盖内存中的返回地址，跳转到攻击者控制的代码区域。该POC代码首先定义了溢出所需的payload，包含了大量的十六进制数据，这部分数据是用于覆盖栈上的数据，其中需要特别关注的是返回地址。LHOST和LPORT参数用于指定反弹shell的地址和端口。代码本身并没有明显的投毒特征，例如执行恶意操作或上传后门，因此投毒风险较低。搜索引擎结果表明该漏洞已被广泛利用，并有多个公开的Exploit可用。

**项目地址:** [VanishedPeople/CVE-2017-7269](https://github.com/VanishedPeople/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #5

**来源**: [CVE-2017-7269-caicai1355_CVE-2017-7269-exploit.md](../2017/CVE-2017-7269-caicai1355_CVE-2017-7269-exploit.md)

## CVE-2017-7269-IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务启用。攻击者需要能够向目标服务器发送HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的一个缓冲区溢出漏洞。该漏洞存在于`ScStoragePathFromUrl`函数中，允许远程攻击者通过发送包含特制 `If:` 头的 `PROPFIND` 请求来执行任意代码。PoC 利用代码通过构造一个超长的 `If:` 头，导致缓冲区溢出，覆盖内存中的重要区域，从而实现代码执行。

**有效性：**
从漏洞描述和搜索引擎结果来看，该漏洞影响 IIS 6.0，并且有公开的 PoC。提供的代码看起来是可用的 PoC 的修改版本。因此，可以认为该 PoC 在目标环境满足漏洞利用条件的情况下是有效的。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意投毒代码。虽然代码本身可以用于攻击目的，但没有发现任何试图在受害者系统上植入后门或执行其他恶意行为的迹象。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP `PROPFIND` 请求，其中包含一个超长的 `If:` 头。
2.  超长的 `If:` 头会触发 `ScStoragePathFromUrl` 函数中的缓冲区溢出。
3.  溢出允许攻击者覆盖内存中的重要区域，例如函数返回地址。
4.  攻击者可以使用溢出来控制程序执行流程，执行任意代码。
5.  PoC 提供的代码计算一些值并通过字符转义嵌入到`If:`头中,以此绕过某些检测,实现执行命令。
6.  该exp执行命令长度有限,最多8个字符。

**项目地址:** [caicai1355/CVE-2017-7269-exploit](https://github.com/caicai1355/CVE-2017-7269-exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #6

**来源**: [CVE-2017-7269-eliuha_webdav_exploit.md](../2017/CVE-2017-7269-eliuha_webdav_exploit.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的 ScStoragePathFromUrl 函数存在缓冲区溢出漏洞。攻击者可以通过发送特制的 PROPFIND 请求，并在请求头中包含一个以 “If: <http://” 开头的超长字符串，触发漏洞，导致缓冲区溢出，从而执行任意代码。提供的 exploit.py 脚本基于已公开的漏洞利用代码，通过构造包含大量 Unicode 字符的长 “If:” 头部的 PROPFIND 请求，发送到目标服务器的 WebDAV 服务，触发缓冲区溢出。由于缓冲区溢出发生在服务进程中，攻击者可以利用溢出覆盖内存中的返回地址，将程序执行流程重定向到攻击者控制的代码区域，从而实现远程代码执行。搜索引擎结果表明，该漏洞在野外被广泛利用，例如用于挖矿等恶意活动。该代码存在投毒风险较低，主要风险在于目标服务器必须存在漏洞。

**项目地址:** [eliuha/webdav_exploit](https://github.com/eliuha/webdav_exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #7

**来源**: [CVE-2017-7269-g0rx_iis6-exploit-2017-CVE-2017-7269.md](../2017/CVE-2017-7269-g0rx_iis6-exploit-2017-CVE-2017-7269.md)

## CVE-2017-7269-IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行存在漏洞的 IIS 6.0 WebDAV 服务，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 漏洞是 Microsoft IIS 6.0 WebDAV 服务中 `ScStoragePathFromUrl` 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制的 `If:` 头部的 `PROPFIND` 请求，造成缓冲区溢出，从而执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已经存在公开的利用代码，并且在野外被利用过。Rapid7 Metasploit 框架中也包含该漏洞的利用模块，表明该漏洞的有效性较高。

**投毒风险：**

提供的 POC 代码是一个 Python 脚本，用于发送包含特定 shellcode 的 `PROPFIND` 请求。该 shellcode 的作用是建立反向 shell 连接。对 shellcode 的分析表明，它尝试连接到攻击者指定的 IP 地址和端口，执行 cmd.exe。 该代码没有发现明显的恶意行为，因此投毒风险较低. 根据人工review代码,未发现任何投毒代码. 

**利用方式：**

1.  攻击者构建一个包含超长 `If:` 头部的 `PROPFIND` 请求，头部的内容精心构造，用于触发 `ScStoragePathFromUrl` 函数的缓冲区溢出。
2.  在超长头部中，包含 shellcode，用于在目标系统上执行恶意代码。
3.  攻击者将构造的 `PROPFIND` 请求发送给存在漏洞的 IIS 6.0 服务器。
4.  服务器处理请求时，`ScStoragePathFromUrl` 函数发生缓冲区溢出，shellcode 被执行。
5.  Shellcode 建立与攻击者控制的 IP 地址和端口的反向 shell 连接，从而允许攻击者远程控制目标系统。

**项目地址:** [g0rx/iis6-exploit-2017-CVE-2017-7269](https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #8

**来源**: [CVE-2017-7269-geniuszly_CVE-2017-7269.md](../2017/CVE-2017-7269-geniuszly_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务已启用。需要向服务器发送特制的PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 存在于 Microsoft IIS 6.0 的 WebDAV 服务中的 `ScStoragePathFromUrl` 函数中。攻击者可以发送一个包含长 "If: <http://" 开头的 header 的 PROPFIND 请求，导致缓冲区溢出，从而允许远程执行任意代码。

**有效性:**

漏洞库信息和搜索结果表明该漏洞确实存在并且已被积极利用。提供的POC代码 `GenWebDavIISExploit.py` 旨在生成利用此漏洞的有效载荷。 exploit-db 上也有公开的exploit（例如，41992 和 41738）。所以该POC代码有效

**投毒风险:**

通过分析提供的 `GenWebDavIISExploit.py` 代码，该脚本主要功能是生成用于利用 CVE-2017-7269 漏洞的恶意数据包。 它接受目标 IP 地址、端口以及反向连接的 IP 地址和端口作为参数，生成包含 shellcode 的 PROPFIND 请求。 没有发现该代码直接包含恶意或后门行为。Shellcode 部分用于建立反向连接，而不是执行任何有害操作。代码主要通过溢出缓冲区执行Shellcode来发起反向连接，完成漏洞利用。

**利用方式:**

1.  **确定目标:** 找到运行易受攻击的 IIS 6.0 版本的服务器。根据搜索结果，即使在漏洞发布后，仍然存在暴露的实例。
2.  **准备反向连接:** 设置一个监听器（例如，使用 `netcat` 或 Metasploit）来接收来自目标服务器的反向连接。
3.  **生成利用代码:** 使用 `GenWebDavIISExploit.py` 脚本，指定目标 IP 地址、端口和反向连接的 IP 地址和端口，生成利用代码
4.  **发送恶意请求:** 使用生成的payload向目标服务器发送 PROPFIND 请求。 "If: <http://" header 包含精心设计的溢出数据，包括 shellcode。
5.  **执行代码:** 成功利用后，目标服务器将执行 shellcode，从而建立与攻击者的反向连接。攻击者现在可以在受感染的系统上执行命令。

**项目地址:** [geniuszly/CVE-2017-7269](https://github.com/geniuszly/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #9

**来源**: [CVE-2017-7269-h3x0v3rl0rd_CVE-2017-7269.md](../2017/CVE-2017-7269-h3x0v3rl0rd_CVE-2017-7269.md)

## CVE-2017-7269-IIS6-缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行的是存在漏洞的IIS 6.0版本，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0中的缓冲区溢出漏洞。该漏洞位于WebDAV服务的`ScStoragePathFromUrl`函数中。远程攻击者可以通过发送包含一个长`If: <http://`起始的头的`PROPFIND`请求，利用此漏洞执行任意代码。

**有效性：**
提供的漏洞利用代码(`ii6_reverse_shell.py`)尝试利用CVE-2017-7269漏洞在易受攻击的IIS 6.0服务器上执行反向shell。漏洞库信息和搜索结果表明该漏洞真实存在且已被广泛利用。

**投毒风险：**
分析提供的`ii6_reverse_shell.py`代码，该脚本的主要目的是创建一个反向shell。虽然反向shell本身可以用于恶意目的，但代码中没有明显的迹象表明作者有意添加了任何额外的投毒代码。代码的核心功能是利用缓冲区溢出漏洞，在目标系统上执行预定义的shellcode，该shellcode尝试连接到攻击者指定的IP地址和端口。没有发现尝试进行额外恶意活动的迹象,例如上传信息，安装恶意程序等。

**利用方式：**
1.  攻击者构造一个恶意的`PROPFIND`请求，其中`If:`头包含一个超长的URL字符串。
2.  当IIS 6.0处理此请求时，`ScStoragePathFromUrl`函数内的缓冲区溢出漏洞会被触发。
3.  通过控制溢出，攻击者可以将恶意shellcode注入到进程的内存中，并劫持程序的执行流程。
4.  提供的漏洞利用代码中的shellcode会尝试建立一个反向shell连接到攻击者指定的IP地址和端口，从而允许攻击者远程控制受感染的服务器。

**项目地址:** [h3x0v3rl0rd/CVE-2017-7269](https://github.com/h3x0v3rl0rd/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #10

**来源**: [CVE-2017-7269-homjxi0e_cve-2017-7269.md](../2017/CVE-2017-7269-homjxi0e_cve-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并启用了WebDAV服务。攻击者需要能够发送HTTP PROPFIND请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是一个存在于 Microsoft IIS 6.0 WebDAV 服务 ScStoragePathFromUrl 函数中的缓冲区溢出漏洞。攻击者可以通过发送一个包含过长 'If: <http://' 头部的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。从搜索引擎结果来看，此漏洞在野外被广泛利用，包括用于挖矿恶意软件的传播。提供的漏洞利用代码仅为漏洞描述文件，本身不包含可执行的利用代码，因此投毒风险较低。利用方式是构造特制的HTTP PROPFIND请求，在'If'头部包含超长字符串，溢出ScStoragePathFromUrl函数的缓冲区，覆盖内存中的重要数据，最终实现远程代码执行。

**项目地址:** [homjxi0e/cve-2017-7269](https://github.com/homjxi0e/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #11

**来源**: [CVE-2017-7269-lcatro_CVE-2017-7269-Echo-PoC.md](../2017/CVE-2017-7269-lcatro_CVE-2017-7269-Echo-PoC.md)

# CVE-2017-7269

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7269-Al1ex_CVE-2017-7269.md](../2017/CVE-2017-7269-Al1ex_CVE-2017-7269.md)

## CVE-2017-7269 Microsoft IIS WebDav ScStoragePathFromUrl Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 开启WebDAV服务的IIS 6.0

**利用条件:** 需要目标服务器开启WebDAV服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0 WebDAV服务中的缓冲区溢出漏洞。攻击者可以通过发送一个包含特制`If:`头的`PROPFIND`请求来利用此漏洞，其中`If:`头包含一个超长的URL，导致`ScStoragePathFromUrl`函数处理时发生缓冲区溢出，从而执行任意代码。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞被广泛报告和利用，存在公开可用的POC，并且Metasploit框架中也存在相应的利用模块。因此，可以认为提供的POC代码是有效的。

**投毒风险评估：**

提供的POC代码是一个Metasploit模块，主要功能是构造恶意的HTTP请求来触发缓冲区溢出。代码中包含一些用于计算缓冲区大小和构造溢出数据的逻辑，以及用于执行payload的部分。经过分析，没有发现明显的恶意代码或后门，该exp主要通过精心构造的payload实现攻击目的，没有发现隐藏的、非预期的恶意行为。因此，投毒风险较低。

**利用方式分析：**

1.  **漏洞触发：** 攻击者向目标IIS 6.0服务器发送一个`PROPFIND`请求，该请求的`If:` header 包含一个以`http://`开头的极长的URL。
2.  **缓冲区溢出：** IIS 6.0的WebDAV服务中的`ScStoragePathFromUrl`函数在处理该URL时，由于未正确检查URL的长度，导致缓冲区溢出。
3.  **代码执行：** 攻击者可以通过控制溢出的数据来覆盖内存中的关键区域，例如函数返回地址，从而执行任意代码。
4.  **Payload执行：** Metasploit模块通常会将shellcode作为payload注入到溢出缓冲区中，当程序执行到被覆盖的返回地址时，shellcode会被执行，从而允许攻击者在目标服务器上运行任意命令。
5.  **利用细节：**
    * 模块中可以自定义HttpHost和PhysicalPathLength两个参数. PhysicalPathLength的值需要根据目标服务器的物理路径长度进行调整，如果配置不正确，可能导致利用失败。
    * Payload使用了AlphanumUnicodeMixed编码,为了绕过某些检测.
    * 利用过程中需要确保目标服务器开启了WebDAV服务。

**项目地址:** [Al1ex/CVE-2017-7269](https://github.com/Al1ex/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #2

**来源**: [CVE-2017-7269-Cappricio-Securities_CVE-2017-7269.md](../2017/CVE-2017-7269-Cappricio-Securities_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行未打补丁的 Microsoft IIS 6.0，并且启用了 WebDAV 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中 ScStoragePathFromUrl 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制 'If:' 头部的 PROPFIND 请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Python脚本），可以判断该漏洞利用是有效的。多个来源表明该漏洞已被广泛利用，并且存在公开的 Metasploit 模块和 Python 脚本。

**投毒风险：**
提供的漏洞利用代码主要是一个漏洞扫描器，用于检测目标是否存在 CVE-2017-7269 漏洞。 通过快速浏览，发现该脚本还集成了 Telegram 通知功能。虽然没有发现明显的恶意代码，但依然存在一定的风险，例如：
*   **依赖风险：** 该脚本依赖于多个Python库，这些库可能存在安全问题，或者被恶意篡改。
*   **Telegram API 密钥泄露：** 如果攻击者获取了用于Telegram通知的 API 密钥，则可以滥用该功能。
*   **报告欺骗：** 扫描器可能会产生误报或者漏报，攻击者可能会利用此弱点。
*   **信息收集：** 该工具可能会收集目标服务器的信息并发送到外部服务器(通过Telegram)。

综合考虑，投毒风险评定为10%，主要是由于脚本依赖项和潜在的滥用风险。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP PROPFIND 请求，该请求包含一个特别长的 'If:' 头部。该头部的内容以 "If: <http://" 开头。
2.  当 IIS 6.0 的 WebDAV 服务处理这个请求时，`ScStoragePathFromUrl` 函数会因为没有正确检查输入长度而发生缓冲区溢出。
3.  攻击者可以通过精心设计的溢出数据覆盖内存中的关键区域，例如函数返回地址。
4.  通过控制返回地址，攻击者可以将程序执行流程劫持到预先设定的恶意代码，从而在目标服务器上执行任意命令。

**项目地址:** [Cappricio-Securities/CVE-2017-7269](https://github.com/Cappricio-Securities/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #3

**来源**: [CVE-2017-7269-ThanHuuTuan_CVE-2017-7269.md](../2017/CVE-2017-7269-ThanHuuTuan_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，且WebDAV服务已启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是Microsoft IIS 6.0中WebDAV服务`ScStoragePathFromUrl`函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含特别构造的“If:”头部的PROPFIND请求，触发缓冲区溢出，从而在目标系统上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息明确指出该漏洞在野外被利用。搜索结果显示，在漏洞公布后的一段时间内，出现了多次利用该漏洞进行攻击的活动，包括挖矿等。

**投毒风险评估：**
提供的POC代码(`/tmp/3af7177f0aabdb4a97a12f1832e1516f/webdav-validation.py`) 主要是用来验证目标服务器是否存在CVE-2017-7269漏洞。该脚本的功能是发送特定格式的HTTP请求，然后根据服务器的响应来判断漏洞是否存在。该脚本本身并没有包含任何恶意代码，因此投毒风险评估为0%。

**利用方式分析：**
1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的“If:”头部包含一个超长的字符串。
2.  当IIS 6.0处理该请求时，`ScStoragePathFromUrl`函数会将“If:”头部的内容复制到缓冲区中，由于没有进行充分的边界检查，导致缓冲区溢出。
3.  攻击者可以通过控制溢出的内容，覆盖内存中的关键数据，例如函数返回地址，从而劫持程序的执行流程。
4.  攻击者可以将shellcode注入到内存中，并将返回地址指向shellcode的起始地址，当函数返回时，shellcode就会被执行，从而实现远程代码执行。

**项目地址:** [ThanHuuTuan/CVE-2017-7269](https://github.com/ThanHuuTuan/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #4

**来源**: [CVE-2017-7269-VanishedPeople_CVE-2017-7269.md](../2017/CVE-2017-7269-VanishedPeople_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0 WebDAV

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行着易受攻击的IIS 6.0，并且WebDAV服务已启用。需要网络可达性，并能发送特制的HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 ScStoragePathFromUrl 函数中的一个缓冲区溢出漏洞。攻击者可以通过发送包含一个长 "If: <http://" 开头的 header 的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。提供的漏洞利用代码 CVE-2017-7269.py 实现了该漏洞的利用，通过构造特定的 HTTP 请求，覆盖内存中的返回地址，跳转到攻击者控制的代码区域。该POC代码首先定义了溢出所需的payload，包含了大量的十六进制数据，这部分数据是用于覆盖栈上的数据，其中需要特别关注的是返回地址。LHOST和LPORT参数用于指定反弹shell的地址和端口。代码本身并没有明显的投毒特征，例如执行恶意操作或上传后门，因此投毒风险较低。搜索引擎结果表明该漏洞已被广泛利用，并有多个公开的Exploit可用。

**项目地址:** [VanishedPeople/CVE-2017-7269](https://github.com/VanishedPeople/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #5

**来源**: [CVE-2017-7269-caicai1355_CVE-2017-7269-exploit.md](../2017/CVE-2017-7269-caicai1355_CVE-2017-7269-exploit.md)

## CVE-2017-7269-IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务启用。攻击者需要能够向目标服务器发送HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的一个缓冲区溢出漏洞。该漏洞存在于`ScStoragePathFromUrl`函数中，允许远程攻击者通过发送包含特制 `If:` 头的 `PROPFIND` 请求来执行任意代码。PoC 利用代码通过构造一个超长的 `If:` 头，导致缓冲区溢出，覆盖内存中的重要区域，从而实现代码执行。

**有效性：**
从漏洞描述和搜索引擎结果来看，该漏洞影响 IIS 6.0，并且有公开的 PoC。提供的代码看起来是可用的 PoC 的修改版本。因此，可以认为该 PoC 在目标环境满足漏洞利用条件的情况下是有效的。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意投毒代码。虽然代码本身可以用于攻击目的，但没有发现任何试图在受害者系统上植入后门或执行其他恶意行为的迹象。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP `PROPFIND` 请求，其中包含一个超长的 `If:` 头。
2.  超长的 `If:` 头会触发 `ScStoragePathFromUrl` 函数中的缓冲区溢出。
3.  溢出允许攻击者覆盖内存中的重要区域，例如函数返回地址。
4.  攻击者可以使用溢出来控制程序执行流程，执行任意代码。
5.  PoC 提供的代码计算一些值并通过字符转义嵌入到`If:`头中,以此绕过某些检测,实现执行命令。
6.  该exp执行命令长度有限,最多8个字符。

**项目地址:** [caicai1355/CVE-2017-7269-exploit](https://github.com/caicai1355/CVE-2017-7269-exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #6

**来源**: [CVE-2017-7269-eliuha_webdav_exploit.md](../2017/CVE-2017-7269-eliuha_webdav_exploit.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的 ScStoragePathFromUrl 函数存在缓冲区溢出漏洞。攻击者可以通过发送特制的 PROPFIND 请求，并在请求头中包含一个以 “If: <http://” 开头的超长字符串，触发漏洞，导致缓冲区溢出，从而执行任意代码。提供的 exploit.py 脚本基于已公开的漏洞利用代码，通过构造包含大量 Unicode 字符的长 “If:” 头部的 PROPFIND 请求，发送到目标服务器的 WebDAV 服务，触发缓冲区溢出。由于缓冲区溢出发生在服务进程中，攻击者可以利用溢出覆盖内存中的返回地址，将程序执行流程重定向到攻击者控制的代码区域，从而实现远程代码执行。搜索引擎结果表明，该漏洞在野外被广泛利用，例如用于挖矿等恶意活动。该代码存在投毒风险较低，主要风险在于目标服务器必须存在漏洞。

**项目地址:** [eliuha/webdav_exploit](https://github.com/eliuha/webdav_exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #7

**来源**: [CVE-2017-7269-g0rx_iis6-exploit-2017-CVE-2017-7269.md](../2017/CVE-2017-7269-g0rx_iis6-exploit-2017-CVE-2017-7269.md)

## CVE-2017-7269-IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行存在漏洞的 IIS 6.0 WebDAV 服务，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 漏洞是 Microsoft IIS 6.0 WebDAV 服务中 `ScStoragePathFromUrl` 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制的 `If:` 头部的 `PROPFIND` 请求，造成缓冲区溢出，从而执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已经存在公开的利用代码，并且在野外被利用过。Rapid7 Metasploit 框架中也包含该漏洞的利用模块，表明该漏洞的有效性较高。

**投毒风险：**

提供的 POC 代码是一个 Python 脚本，用于发送包含特定 shellcode 的 `PROPFIND` 请求。该 shellcode 的作用是建立反向 shell 连接。对 shellcode 的分析表明，它尝试连接到攻击者指定的 IP 地址和端口，执行 cmd.exe。 该代码没有发现明显的恶意行为，因此投毒风险较低. 根据人工review代码,未发现任何投毒代码. 

**利用方式：**

1.  攻击者构建一个包含超长 `If:` 头部的 `PROPFIND` 请求，头部的内容精心构造，用于触发 `ScStoragePathFromUrl` 函数的缓冲区溢出。
2.  在超长头部中，包含 shellcode，用于在目标系统上执行恶意代码。
3.  攻击者将构造的 `PROPFIND` 请求发送给存在漏洞的 IIS 6.0 服务器。
4.  服务器处理请求时，`ScStoragePathFromUrl` 函数发生缓冲区溢出，shellcode 被执行。
5.  Shellcode 建立与攻击者控制的 IP 地址和端口的反向 shell 连接，从而允许攻击者远程控制目标系统。

**项目地址:** [g0rx/iis6-exploit-2017-CVE-2017-7269](https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #8

**来源**: [CVE-2017-7269-geniuszly_CVE-2017-7269.md](../2017/CVE-2017-7269-geniuszly_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务已启用。需要向服务器发送特制的PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 存在于 Microsoft IIS 6.0 的 WebDAV 服务中的 `ScStoragePathFromUrl` 函数中。攻击者可以发送一个包含长 "If: <http://" 开头的 header 的 PROPFIND 请求，导致缓冲区溢出，从而允许远程执行任意代码。

**有效性:**

漏洞库信息和搜索结果表明该漏洞确实存在并且已被积极利用。提供的POC代码 `GenWebDavIISExploit.py` 旨在生成利用此漏洞的有效载荷。 exploit-db 上也有公开的exploit（例如，41992 和 41738）。所以该POC代码有效

**投毒风险:**

通过分析提供的 `GenWebDavIISExploit.py` 代码，该脚本主要功能是生成用于利用 CVE-2017-7269 漏洞的恶意数据包。 它接受目标 IP 地址、端口以及反向连接的 IP 地址和端口作为参数，生成包含 shellcode 的 PROPFIND 请求。 没有发现该代码直接包含恶意或后门行为。Shellcode 部分用于建立反向连接，而不是执行任何有害操作。代码主要通过溢出缓冲区执行Shellcode来发起反向连接，完成漏洞利用。

**利用方式:**

1.  **确定目标:** 找到运行易受攻击的 IIS 6.0 版本的服务器。根据搜索结果，即使在漏洞发布后，仍然存在暴露的实例。
2.  **准备反向连接:** 设置一个监听器（例如，使用 `netcat` 或 Metasploit）来接收来自目标服务器的反向连接。
3.  **生成利用代码:** 使用 `GenWebDavIISExploit.py` 脚本，指定目标 IP 地址、端口和反向连接的 IP 地址和端口，生成利用代码
4.  **发送恶意请求:** 使用生成的payload向目标服务器发送 PROPFIND 请求。 "If: <http://" header 包含精心设计的溢出数据，包括 shellcode。
5.  **执行代码:** 成功利用后，目标服务器将执行 shellcode，从而建立与攻击者的反向连接。攻击者现在可以在受感染的系统上执行命令。

**项目地址:** [geniuszly/CVE-2017-7269](https://github.com/geniuszly/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #9

**来源**: [CVE-2017-7269-h3x0v3rl0rd_CVE-2017-7269.md](../2017/CVE-2017-7269-h3x0v3rl0rd_CVE-2017-7269.md)

## CVE-2017-7269-IIS6-缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行的是存在漏洞的IIS 6.0版本，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0中的缓冲区溢出漏洞。该漏洞位于WebDAV服务的`ScStoragePathFromUrl`函数中。远程攻击者可以通过发送包含一个长`If: <http://`起始的头的`PROPFIND`请求，利用此漏洞执行任意代码。

**有效性：**
提供的漏洞利用代码(`ii6_reverse_shell.py`)尝试利用CVE-2017-7269漏洞在易受攻击的IIS 6.0服务器上执行反向shell。漏洞库信息和搜索结果表明该漏洞真实存在且已被广泛利用。

**投毒风险：**
分析提供的`ii6_reverse_shell.py`代码，该脚本的主要目的是创建一个反向shell。虽然反向shell本身可以用于恶意目的，但代码中没有明显的迹象表明作者有意添加了任何额外的投毒代码。代码的核心功能是利用缓冲区溢出漏洞，在目标系统上执行预定义的shellcode，该shellcode尝试连接到攻击者指定的IP地址和端口。没有发现尝试进行额外恶意活动的迹象,例如上传信息，安装恶意程序等。

**利用方式：**
1.  攻击者构造一个恶意的`PROPFIND`请求，其中`If:`头包含一个超长的URL字符串。
2.  当IIS 6.0处理此请求时，`ScStoragePathFromUrl`函数内的缓冲区溢出漏洞会被触发。
3.  通过控制溢出，攻击者可以将恶意shellcode注入到进程的内存中，并劫持程序的执行流程。
4.  提供的漏洞利用代码中的shellcode会尝试建立一个反向shell连接到攻击者指定的IP地址和端口，从而允许攻击者远程控制受感染的服务器。

**项目地址:** [h3x0v3rl0rd/CVE-2017-7269](https://github.com/h3x0v3rl0rd/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #10

**来源**: [CVE-2017-7269-homjxi0e_cve-2017-7269.md](../2017/CVE-2017-7269-homjxi0e_cve-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并启用了WebDAV服务。攻击者需要能够发送HTTP PROPFIND请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是一个存在于 Microsoft IIS 6.0 WebDAV 服务 ScStoragePathFromUrl 函数中的缓冲区溢出漏洞。攻击者可以通过发送一个包含过长 'If: <http://' 头部的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。从搜索引擎结果来看，此漏洞在野外被广泛利用，包括用于挖矿恶意软件的传播。提供的漏洞利用代码仅为漏洞描述文件，本身不包含可执行的利用代码，因此投毒风险较低。利用方式是构造特制的HTTP PROPFIND请求，在'If'头部包含超长字符串，溢出ScStoragePathFromUrl函数的缓冲区，覆盖内存中的重要数据，最终实现远程代码执行。

**项目地址:** [homjxi0e/cve-2017-7269](https://github.com/homjxi0e/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #11

**来源**: [CVE-2017-7269-lcatro_CVE-2017-7269-Echo-PoC.md](../2017/CVE-2017-7269-lcatro_CVE-2017-7269-Echo-PoC.md)

# CVE-2017-7269

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2017-7269-Al1ex_CVE-2017-7269.md](../2017/CVE-2017-7269-Al1ex_CVE-2017-7269.md)

## CVE-2017-7269 Microsoft IIS WebDav ScStoragePathFromUrl Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 开启WebDAV服务的IIS 6.0

**利用条件:** 需要目标服务器开启WebDAV服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0 WebDAV服务中的缓冲区溢出漏洞。攻击者可以通过发送一个包含特制`If:`头的`PROPFIND`请求来利用此漏洞，其中`If:`头包含一个超长的URL，导致`ScStoragePathFromUrl`函数处理时发生缓冲区溢出，从而执行任意代码。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞被广泛报告和利用，存在公开可用的POC，并且Metasploit框架中也存在相应的利用模块。因此，可以认为提供的POC代码是有效的。

**投毒风险评估：**

提供的POC代码是一个Metasploit模块，主要功能是构造恶意的HTTP请求来触发缓冲区溢出。代码中包含一些用于计算缓冲区大小和构造溢出数据的逻辑，以及用于执行payload的部分。经过分析，没有发现明显的恶意代码或后门，该exp主要通过精心构造的payload实现攻击目的，没有发现隐藏的、非预期的恶意行为。因此，投毒风险较低。

**利用方式分析：**

1.  **漏洞触发：** 攻击者向目标IIS 6.0服务器发送一个`PROPFIND`请求，该请求的`If:` header 包含一个以`http://`开头的极长的URL。
2.  **缓冲区溢出：** IIS 6.0的WebDAV服务中的`ScStoragePathFromUrl`函数在处理该URL时，由于未正确检查URL的长度，导致缓冲区溢出。
3.  **代码执行：** 攻击者可以通过控制溢出的数据来覆盖内存中的关键区域，例如函数返回地址，从而执行任意代码。
4.  **Payload执行：** Metasploit模块通常会将shellcode作为payload注入到溢出缓冲区中，当程序执行到被覆盖的返回地址时，shellcode会被执行，从而允许攻击者在目标服务器上运行任意命令。
5.  **利用细节：**
    * 模块中可以自定义HttpHost和PhysicalPathLength两个参数. PhysicalPathLength的值需要根据目标服务器的物理路径长度进行调整，如果配置不正确，可能导致利用失败。
    * Payload使用了AlphanumUnicodeMixed编码,为了绕过某些检测.
    * 利用过程中需要确保目标服务器开启了WebDAV服务。

**项目地址:** [Al1ex/CVE-2017-7269](https://github.com/Al1ex/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #2

**来源**: [CVE-2017-7269-Cappricio-Securities_CVE-2017-7269.md](../2017/CVE-2017-7269-Cappricio-Securities_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行未打补丁的 Microsoft IIS 6.0，并且启用了 WebDAV 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中 ScStoragePathFromUrl 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制 'If:' 头部的 PROPFIND 请求，利用该漏洞在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（Python脚本），可以判断该漏洞利用是有效的。多个来源表明该漏洞已被广泛利用，并且存在公开的 Metasploit 模块和 Python 脚本。

**投毒风险：**
提供的漏洞利用代码主要是一个漏洞扫描器，用于检测目标是否存在 CVE-2017-7269 漏洞。 通过快速浏览，发现该脚本还集成了 Telegram 通知功能。虽然没有发现明显的恶意代码，但依然存在一定的风险，例如：
*   **依赖风险：** 该脚本依赖于多个Python库，这些库可能存在安全问题，或者被恶意篡改。
*   **Telegram API 密钥泄露：** 如果攻击者获取了用于Telegram通知的 API 密钥，则可以滥用该功能。
*   **报告欺骗：** 扫描器可能会产生误报或者漏报，攻击者可能会利用此弱点。
*   **信息收集：** 该工具可能会收集目标服务器的信息并发送到外部服务器(通过Telegram)。

综合考虑，投毒风险评定为10%，主要是由于脚本依赖项和潜在的滥用风险。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP PROPFIND 请求，该请求包含一个特别长的 'If:' 头部。该头部的内容以 "If: <http://" 开头。
2.  当 IIS 6.0 的 WebDAV 服务处理这个请求时，`ScStoragePathFromUrl` 函数会因为没有正确检查输入长度而发生缓冲区溢出。
3.  攻击者可以通过精心设计的溢出数据覆盖内存中的关键区域，例如函数返回地址。
4.  通过控制返回地址，攻击者可以将程序执行流程劫持到预先设定的恶意代码，从而在目标服务器上执行任意命令。

**项目地址:** [Cappricio-Securities/CVE-2017-7269](https://github.com/Cappricio-Securities/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #3

**来源**: [CVE-2017-7269-ThanHuuTuan_CVE-2017-7269.md](../2017/CVE-2017-7269-ThanHuuTuan_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，且WebDAV服务已启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是Microsoft IIS 6.0中WebDAV服务`ScStoragePathFromUrl`函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含特别构造的“If:”头部的PROPFIND请求，触发缓冲区溢出，从而在目标系统上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息明确指出该漏洞在野外被利用。搜索结果显示，在漏洞公布后的一段时间内，出现了多次利用该漏洞进行攻击的活动，包括挖矿等。

**投毒风险评估：**
提供的POC代码(`/tmp/3af7177f0aabdb4a97a12f1832e1516f/webdav-validation.py`) 主要是用来验证目标服务器是否存在CVE-2017-7269漏洞。该脚本的功能是发送特定格式的HTTP请求，然后根据服务器的响应来判断漏洞是否存在。该脚本本身并没有包含任何恶意代码，因此投毒风险评估为0%。

**利用方式分析：**
1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的“If:”头部包含一个超长的字符串。
2.  当IIS 6.0处理该请求时，`ScStoragePathFromUrl`函数会将“If:”头部的内容复制到缓冲区中，由于没有进行充分的边界检查，导致缓冲区溢出。
3.  攻击者可以通过控制溢出的内容，覆盖内存中的关键数据，例如函数返回地址，从而劫持程序的执行流程。
4.  攻击者可以将shellcode注入到内存中，并将返回地址指向shellcode的起始地址，当函数返回时，shellcode就会被执行，从而实现远程代码执行。

**项目地址:** [ThanHuuTuan/CVE-2017-7269](https://github.com/ThanHuuTuan/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #4

**来源**: [CVE-2017-7269-VanishedPeople_CVE-2017-7269.md](../2017/CVE-2017-7269-VanishedPeople_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0 WebDAV

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行着易受攻击的IIS 6.0，并且WebDAV服务已启用。需要网络可达性，并能发送特制的HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 ScStoragePathFromUrl 函数中的一个缓冲区溢出漏洞。攻击者可以通过发送包含一个长 "If: <http://" 开头的 header 的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。提供的漏洞利用代码 CVE-2017-7269.py 实现了该漏洞的利用，通过构造特定的 HTTP 请求，覆盖内存中的返回地址，跳转到攻击者控制的代码区域。该POC代码首先定义了溢出所需的payload，包含了大量的十六进制数据，这部分数据是用于覆盖栈上的数据，其中需要特别关注的是返回地址。LHOST和LPORT参数用于指定反弹shell的地址和端口。代码本身并没有明显的投毒特征，例如执行恶意操作或上传后门，因此投毒风险较低。搜索引擎结果表明该漏洞已被广泛利用，并有多个公开的Exploit可用。

**项目地址:** [VanishedPeople/CVE-2017-7269](https://github.com/VanishedPeople/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #5

**来源**: [CVE-2017-7269-caicai1355_CVE-2017-7269-exploit.md](../2017/CVE-2017-7269-caicai1355_CVE-2017-7269-exploit.md)

## CVE-2017-7269-IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务启用。攻击者需要能够向目标服务器发送HTTP PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的一个缓冲区溢出漏洞。该漏洞存在于`ScStoragePathFromUrl`函数中，允许远程攻击者通过发送包含特制 `If:` 头的 `PROPFIND` 请求来执行任意代码。PoC 利用代码通过构造一个超长的 `If:` 头，导致缓冲区溢出，覆盖内存中的重要区域，从而实现代码执行。

**有效性：**
从漏洞描述和搜索引擎结果来看，该漏洞影响 IIS 6.0，并且有公开的 PoC。提供的代码看起来是可用的 PoC 的修改版本。因此，可以认为该 PoC 在目标环境满足漏洞利用条件的情况下是有效的。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意投毒代码。虽然代码本身可以用于攻击目的，但没有发现任何试图在受害者系统上植入后门或执行其他恶意行为的迹象。

**利用方式：**
1.  攻击者构造一个恶意的 HTTP `PROPFIND` 请求，其中包含一个超长的 `If:` 头。
2.  超长的 `If:` 头会触发 `ScStoragePathFromUrl` 函数中的缓冲区溢出。
3.  溢出允许攻击者覆盖内存中的重要区域，例如函数返回地址。
4.  攻击者可以使用溢出来控制程序执行流程，执行任意代码。
5.  PoC 提供的代码计算一些值并通过字符转义嵌入到`If:`头中,以此绕过某些检测,实现执行命令。
6.  该exp执行命令长度有限,最多8个字符。

**项目地址:** [caicai1355/CVE-2017-7269-exploit](https://github.com/caicai1355/CVE-2017-7269-exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #6

**来源**: [CVE-2017-7269-eliuha_webdav_exploit.md](../2017/CVE-2017-7269-eliuha_webdav_exploit.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 WebDAV 服务中的 ScStoragePathFromUrl 函数存在缓冲区溢出漏洞。攻击者可以通过发送特制的 PROPFIND 请求，并在请求头中包含一个以 “If: <http://” 开头的超长字符串，触发漏洞，导致缓冲区溢出，从而执行任意代码。提供的 exploit.py 脚本基于已公开的漏洞利用代码，通过构造包含大量 Unicode 字符的长 “If:” 头部的 PROPFIND 请求，发送到目标服务器的 WebDAV 服务，触发缓冲区溢出。由于缓冲区溢出发生在服务进程中，攻击者可以利用溢出覆盖内存中的返回地址，将程序执行流程重定向到攻击者控制的代码区域，从而实现远程代码执行。搜索引擎结果表明，该漏洞在野外被广泛利用，例如用于挖矿等恶意活动。该代码存在投毒风险较低，主要风险在于目标服务器必须存在漏洞。

**项目地址:** [eliuha/webdav_exploit](https://github.com/eliuha/webdav_exploit)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #7

**来源**: [CVE-2017-7269-g0rx_iis6-exploit-2017-CVE-2017-7269.md](../2017/CVE-2017-7269-g0rx_iis6-exploit-2017-CVE-2017-7269.md)

## CVE-2017-7269-IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行存在漏洞的 IIS 6.0 WebDAV 服务，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 漏洞是 Microsoft IIS 6.0 WebDAV 服务中 `ScStoragePathFromUrl` 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制的 `If:` 头部的 `PROPFIND` 请求，造成缓冲区溢出，从而执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已经存在公开的利用代码，并且在野外被利用过。Rapid7 Metasploit 框架中也包含该漏洞的利用模块，表明该漏洞的有效性较高。

**投毒风险：**

提供的 POC 代码是一个 Python 脚本，用于发送包含特定 shellcode 的 `PROPFIND` 请求。该 shellcode 的作用是建立反向 shell 连接。对 shellcode 的分析表明，它尝试连接到攻击者指定的 IP 地址和端口，执行 cmd.exe。 该代码没有发现明显的恶意行为，因此投毒风险较低. 根据人工review代码,未发现任何投毒代码. 

**利用方式：**

1.  攻击者构建一个包含超长 `If:` 头部的 `PROPFIND` 请求，头部的内容精心构造，用于触发 `ScStoragePathFromUrl` 函数的缓冲区溢出。
2.  在超长头部中，包含 shellcode，用于在目标系统上执行恶意代码。
3.  攻击者将构造的 `PROPFIND` 请求发送给存在漏洞的 IIS 6.0 服务器。
4.  服务器处理请求时，`ScStoragePathFromUrl` 函数发生缓冲区溢出，shellcode 被执行。
5.  Shellcode 建立与攻击者控制的 IP 地址和端口的反向 shell 连接，从而允许攻击者远程控制目标系统。

**项目地址:** [g0rx/iis6-exploit-2017-CVE-2017-7269](https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #8

**来源**: [CVE-2017-7269-geniuszly_CVE-2017-7269.md](../2017/CVE-2017-7269-geniuszly_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务已启用。需要向服务器发送特制的PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 存在于 Microsoft IIS 6.0 的 WebDAV 服务中的 `ScStoragePathFromUrl` 函数中。攻击者可以发送一个包含长 "If: <http://" 开头的 header 的 PROPFIND 请求，导致缓冲区溢出，从而允许远程执行任意代码。

**有效性:**

漏洞库信息和搜索结果表明该漏洞确实存在并且已被积极利用。提供的POC代码 `GenWebDavIISExploit.py` 旨在生成利用此漏洞的有效载荷。 exploit-db 上也有公开的exploit（例如，41992 和 41738）。所以该POC代码有效

**投毒风险:**

通过分析提供的 `GenWebDavIISExploit.py` 代码，该脚本主要功能是生成用于利用 CVE-2017-7269 漏洞的恶意数据包。 它接受目标 IP 地址、端口以及反向连接的 IP 地址和端口作为参数，生成包含 shellcode 的 PROPFIND 请求。 没有发现该代码直接包含恶意或后门行为。Shellcode 部分用于建立反向连接，而不是执行任何有害操作。代码主要通过溢出缓冲区执行Shellcode来发起反向连接，完成漏洞利用。

**利用方式:**

1.  **确定目标:** 找到运行易受攻击的 IIS 6.0 版本的服务器。根据搜索结果，即使在漏洞发布后，仍然存在暴露的实例。
2.  **准备反向连接:** 设置一个监听器（例如，使用 `netcat` 或 Metasploit）来接收来自目标服务器的反向连接。
3.  **生成利用代码:** 使用 `GenWebDavIISExploit.py` 脚本，指定目标 IP 地址、端口和反向连接的 IP 地址和端口，生成利用代码
4.  **发送恶意请求:** 使用生成的payload向目标服务器发送 PROPFIND 请求。 "If: <http://" header 包含精心设计的溢出数据，包括 shellcode。
5.  **执行代码:** 成功利用后，目标服务器将执行 shellcode，从而建立与攻击者的反向连接。攻击者现在可以在受感染的系统上执行命令。

**项目地址:** [geniuszly/CVE-2017-7269](https://github.com/geniuszly/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #9

**来源**: [CVE-2017-7269-h3x0v3rl0rd_CVE-2017-7269.md](../2017/CVE-2017-7269-h3x0v3rl0rd_CVE-2017-7269.md)

## CVE-2017-7269-IIS6-缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行的是存在漏洞的IIS 6.0版本，且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0中的缓冲区溢出漏洞。该漏洞位于WebDAV服务的`ScStoragePathFromUrl`函数中。远程攻击者可以通过发送包含一个长`If: <http://`起始的头的`PROPFIND`请求，利用此漏洞执行任意代码。

**有效性：**
提供的漏洞利用代码(`ii6_reverse_shell.py`)尝试利用CVE-2017-7269漏洞在易受攻击的IIS 6.0服务器上执行反向shell。漏洞库信息和搜索结果表明该漏洞真实存在且已被广泛利用。

**投毒风险：**
分析提供的`ii6_reverse_shell.py`代码，该脚本的主要目的是创建一个反向shell。虽然反向shell本身可以用于恶意目的，但代码中没有明显的迹象表明作者有意添加了任何额外的投毒代码。代码的核心功能是利用缓冲区溢出漏洞，在目标系统上执行预定义的shellcode，该shellcode尝试连接到攻击者指定的IP地址和端口。没有发现尝试进行额外恶意活动的迹象,例如上传信息，安装恶意程序等。

**利用方式：**
1.  攻击者构造一个恶意的`PROPFIND`请求，其中`If:`头包含一个超长的URL字符串。
2.  当IIS 6.0处理此请求时，`ScStoragePathFromUrl`函数内的缓冲区溢出漏洞会被触发。
3.  通过控制溢出，攻击者可以将恶意shellcode注入到进程的内存中，并劫持程序的执行流程。
4.  提供的漏洞利用代码中的shellcode会尝试建立一个反向shell连接到攻击者指定的IP地址和端口，从而允许攻击者远程控制受感染的服务器。

**项目地址:** [h3x0v3rl0rd/CVE-2017-7269](https://github.com/h3x0v3rl0rd/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #10

**来源**: [CVE-2017-7269-homjxi0e_cve-2017-7269.md](../2017/CVE-2017-7269-homjxi0e_cve-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并启用了WebDAV服务。攻击者需要能够发送HTTP PROPFIND请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7269 是一个存在于 Microsoft IIS 6.0 WebDAV 服务 ScStoragePathFromUrl 函数中的缓冲区溢出漏洞。攻击者可以通过发送一个包含过长 'If: <http://' 头部的 PROPFIND 请求，触发缓冲区溢出，从而执行任意代码。从搜索引擎结果来看，此漏洞在野外被广泛利用，包括用于挖矿恶意软件的传播。提供的漏洞利用代码仅为漏洞描述文件，本身不包含可执行的利用代码，因此投毒风险较低。利用方式是构造特制的HTTP PROPFIND请求，在'If'头部包含超长字符串，溢出ScStoragePathFromUrl函数的缓冲区，覆盖内存中的重要数据，最终实现远程代码执行。

**项目地址:** [homjxi0e/cve-2017-7269](https://github.com/homjxi0e/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #11

**来源**: [CVE-2017-7269-nika0x38_CVE-2017-7269.md](../2017/CVE-2017-7269-nika0x38_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 `ScStoragePathFromUrl` 函数的一个缓冲区溢出漏洞。攻击者可以发送特制的 PROPFIND 请求，其中包含一个以 "If: <http://" 开头的长 header，来触发漏洞，最终导致任意代码执行。

**有效性评估：**
漏洞库信息和搜索引擎结果均表明该漏洞已被广泛利用。存在公开可用的 Exploit-DB 脚本 (例如，Exploit-DB 41738 和 41992) 和 Metasploit 模块，证明了该漏洞的有效性。

**投毒风险分析：**
提供的 "Cargo.lock" 文件仅是 Rust 项目的依赖锁定文件，用于确保构建的可重复性。它本身不包含任何可执行代码。但是，该项目 `cve-2017-7269` 依赖于多个crates, 作者可能通过污染依赖项的方式进行投毒, 比如篡改 `clap`, `anyhow` 等库.
评估存在投毒风险，主要是因为:
1.  **供应链攻击可能性：** 通过篡改依赖项进行攻击是软件供应链攻击的常见手段。
2.  **依赖项复杂性：**  Rust 项目依赖关系复杂，手动审查所有依赖项以发现恶意代码非常困难。

但是，从 `Cargo.lock` 本身无法直接判断是否存在恶意代码。需要进一步检查项目源代码以及各个依赖项的源代码才能确定是否存在投毒行为。目前仅根据依赖关系进行推断，投毒风险的概率较低，约为10%。

**利用方式分析：**
1.  **攻击向量：** 远程攻击，通过发送特制的 HTTP PROPFIND 请求。
2.  **攻击目标：** 运行在 Windows Server 2003 R2 上的 IIS 6.0 服务器。
3.  **漏洞位置：** `ScStoragePathFromUrl` 函数中的缓冲区。
4.  **触发条件：**  `If:` header 长度超过缓冲区大小。
5.  **结果：** 远程代码执行，攻击者可以在服务器上执行任意代码。

攻击者可以通过构造恶意的 `If:` header，向易受攻击的服务器发送 PROPFIND 请求，覆盖缓冲区并劫持程序控制流。根据搜索结果，该漏洞曾被用于挖掘 Electroneum 币。

**项目地址:** [nika0x38/CVE-2017-7269](https://github.com/nika0x38/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #12

**来源**: [CVE-2017-7269-slimpagey_IIS_6.0_WebDAV_Ruby.md](../2017/CVE-2017-7269-slimpagey_IIS_6.0_WebDAV_Ruby.md)

## CVE-2017-7269

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 需要目标服务器运行存在漏洞的IIS 6.0，并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0 WebDAV服务中的缓冲区溢出漏洞。具体来说，`ScStoragePathFromUrl`函数在处理PROPFIND请求中以“If: <http://”开头的长header时存在缺陷，未进行充分的长度验证，导致缓冲区溢出。远程攻击者可以通过发送特制的PROPFIND请求，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**
从漏洞库信息和搜索结果来看，CVE-2017-7269是一个已经公开披露且被广泛利用的漏洞。提供的漏洞利用代码（exploit.rb）针对此漏洞，利用Ruby编写，通过发送特制的HTTP请求触发缓冲区溢出，从而执行预定义的shellcode。搜索结果中，有多个文章和报告表明该漏洞已被用于实际攻击，例如挖矿等。

**投毒风险评估：**
检查提供的`exploit.rb`代码，发现它允许用户指定payload类型，包括calc.exe、BSOD（蓝屏死机）、msg（显示消息框）、cmd（执行命令并关闭）和adm（添加本地管理员账户）。 这些payload都是标准的功能型payload，并无明显恶意行为。需要注意的是cmd和adm payload允许执行任意命令,具有潜在的风险，但这不是投毒行为，因为利用方式已经很明确的列出来了.
该漏洞利用代码的主要风险在于，如果攻击者在不了解shellcode具体作用的情况下执行了exploit，可能会导致系统不稳定（如BSOD）。代码本身存在一些混淆，增加了一些风险。
综合评估，存在少量投毒风险。 此风险主要是由于漏洞利用者对shellcode的不了解所导致。

**利用方式：**
1.  **目标确认：** 确认目标服务器正在运行存在漏洞的IIS 6.0，且启用了WebDAV服务。
2.  **漏洞利用：** 使用提供的`exploit.rb`脚本，指定目标IP地址、端口和所需payload。
3.  **Payload选择：** 根据攻击目标，选择合适的payload。例如，使用calc payload测试漏洞，使用cmd或adm payload执行恶意操作（如安装后门或添加管理员账户）。
4.  **执行：** 运行脚本，向目标服务器发送包含恶意header的PROPFIND请求，触发缓冲区溢出。
5.  **代码执行：** 如果利用成功，目标服务器将执行预定义的shellcode，完成攻击目标。

**优先级排序:**
如先前所述，搜索引擎结果，漏洞利用代码和漏洞库信息在确定漏洞的严重性，有效性和风险方面，是依此递减的。
* 搜索引擎结果展现该漏洞已经被利用，且有对应的挖矿攻击. * 漏洞利用代码表明已经有可用的exp. * 漏洞库信息提供了漏洞的详细描述.

**项目地址:** [slimpagey/IIS_6.0_WebDAV_Ruby](https://github.com/slimpagey/IIS_6.0_WebDAV_Ruby)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #13

**来源**: [CVE-2017-7269-zcgonvh_cve-2017-7269-tool.md](../2017/CVE-2017-7269-zcgonvh_cve-2017-7269-tool.md)

## CVE-2017-7269-Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行存在漏洞的IIS 6.0，且WebDAV服务启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 ScStoragePathFromUrl 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含过长 "If: <http://" 开头的 header 的 PROPFIND 请求，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出此漏洞在野外被利用过，并且提供了多个Exploit-DB的链接，Rapid7的漏洞数据库也确认了此漏洞的存在。搜索引擎结果显示，该漏洞在2018年被大规模利用，用于挖矿等恶意活动。提供的C#代码实现了漏洞的利用，可以上传webshell或执行shellcode。

**投毒风险分析：**

检查提供的C# POC 代码，发现代码主要功能是：
1.  发送特制的HTTP PROPFIND请求，触发WebDAV服务的缓冲区溢出漏洞。
2.  允许用户指定Host, Port, Scheme等参数定制HTTP Header。
3.  支持上传Webshell到服务器，并指定webshell的路径。
4.  支持执行shellcode。

代码中包含`check_exit_process` 和 `check_exit_thread` 字符串，这些字符串是shellcode的一部分，用于检测漏洞利用是否成功，并在需要时退出进程或线程。这不属于投毒代码，而是漏洞利用过程中的一部分。

代码中没有发现明显的恶意行为或者后门代码，例如反弹shell、信息收集等。但是，由于代码本身就是用于远程代码执行的漏洞利用程序，所以如果被恶意使用者利用，上传恶意webshell或执行恶意shellcode，仍然存在被投毒的风险。因此，判定存在10%的投毒风险，主要来自使用者。

**利用方式：**

1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的 "If: <http://" header 包含一个超长的字符串。
2.  当 IIS 6.0 处理该请求时，ScStoragePathFromUrl 函数会将该URL复制到缓冲区中，由于没有进行长度检查，导致缓冲区溢出。
3.  攻击者可以通过精心构造溢出数据，覆盖内存中的关键区域，例如函数返回地址。
4.  通过控制返回地址，攻击者可以劫持程序的执行流程，执行预先准备好的shellcode，从而在目标系统上执行任意代码。
5.  攻击者可以利用此漏洞安装webshell，以便长期控制目标服务器，或者执行挖矿程序等恶意活动。

**项目地址:** [zcgonvh/cve-2017-7269-tool](https://github.com/zcgonvh/cve-2017-7269-tool)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #14

**来源**: [CVE-2017-7269-zcgonvh_cve-2017-7269.md](../2017/CVE-2017-7269-zcgonvh_cve-2017-7269.md)

## CVE-2017-7269 Microsoft IIS WebDav ScStoragePathFromUrl Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标服务器运行Windows Server 2003 R2，且IIS 6.0的WebDAV服务开启。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7269是Microsoft IIS 6.0 WebDAV服务中ScStoragePathFromUrl函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送一个特制的PROPFIND请求，其中包含一个以 "If: <http://" 开头的超长header，来触发该漏洞。这个长header导致ScStoragePathFromUrl函数在处理URL时发生缓冲区溢出，从而允许攻击者执行任意代码。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并且已经被公开利用。提供的漏洞利用代码（Metasploit模块的Ruby代码）是一个可用的POC，可以用于验证和利用该漏洞。

**投毒风险评估：**

根据提供的代码片段，初步评估投毒风险较低，约为5%。该代码看起来是Metasploit模块的修改版本，主要修复了原始模块在某些情况下无法正常工作的问题，并添加了`PhysicalPathLength`和`HttpHost`两个选项，增加了漏洞利用的灵活性，以适应不同物理路径长度和主机绑定的情况。

代码中没有发现明显的恶意代码或后门，但仍需注意以下几点：

*   **EncoderType**设置的是`Msf::Encoder::Type::AlphanumUnicodeMixed`，这意味着payload会被编码成Unicode，可能会增加分析难度。
*   **EncoderOptions**中设置了`BufferRegister`为`ESI`，这指定了payload存储的寄存器，可能会影响漏洞利用的稳定性。
*  **PrependMigrateProc** 设置为`calc`, 这只是为了测试, 实际利用中需要更改.

**利用方式分析：**

1.  攻击者构造一个恶意的PROPFIND请求，并在请求头中包含一个以 "If: <http://" 开头的超长header。
2.  长header的长度超过ScStoragePathFromUrl函数的缓冲区大小，导致缓冲区溢出。
3.  溢出数据覆盖了关键的内存区域，包括返回地址等。
4.  攻击者通过控制溢出数据，将返回地址指向恶意代码（payload）的地址。
5.  当ScStoragePathFromUrl函数返回时，程序执行流程跳转到payload，从而执行攻击者预先设定的恶意代码，实现远程代码执行。
6. 通过设置`PhysicalPathLength`和`HttpHost`可以精确定位目标环境，提升利用成功率。

**总结：**

CVE-2017-7269是一个高危的远程代码执行漏洞，由于存在公开可用的POC，并且该漏洞已经被广泛利用，因此需要及时修复。评估的POC代码本身投毒风险较低，主要是在原有的POC基础上进行功能增强和适配性改进。但应加强安全审计。

**项目地址:** [zcgonvh/cve-2017-7269](https://github.com/zcgonvh/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---



---

## POC #12

**来源**: [CVE-2017-7269-nika0x38_CVE-2017-7269.md](../2017/CVE-2017-7269-nika0x38_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 `ScStoragePathFromUrl` 函数的一个缓冲区溢出漏洞。攻击者可以发送特制的 PROPFIND 请求，其中包含一个以 "If: <http://" 开头的长 header，来触发漏洞，最终导致任意代码执行。

**有效性评估：**
漏洞库信息和搜索引擎结果均表明该漏洞已被广泛利用。存在公开可用的 Exploit-DB 脚本 (例如，Exploit-DB 41738 和 41992) 和 Metasploit 模块，证明了该漏洞的有效性。

**投毒风险分析：**
提供的 "Cargo.lock" 文件仅是 Rust 项目的依赖锁定文件，用于确保构建的可重复性。它本身不包含任何可执行代码。但是，该项目 `cve-2017-7269` 依赖于多个crates, 作者可能通过污染依赖项的方式进行投毒, 比如篡改 `clap`, `anyhow` 等库.
评估存在投毒风险，主要是因为:
1.  **供应链攻击可能性：** 通过篡改依赖项进行攻击是软件供应链攻击的常见手段。
2.  **依赖项复杂性：**  Rust 项目依赖关系复杂，手动审查所有依赖项以发现恶意代码非常困难。

但是，从 `Cargo.lock` 本身无法直接判断是否存在恶意代码。需要进一步检查项目源代码以及各个依赖项的源代码才能确定是否存在投毒行为。目前仅根据依赖关系进行推断，投毒风险的概率较低，约为10%。

**利用方式分析：**
1.  **攻击向量：** 远程攻击，通过发送特制的 HTTP PROPFIND 请求。
2.  **攻击目标：** 运行在 Windows Server 2003 R2 上的 IIS 6.0 服务器。
3.  **漏洞位置：** `ScStoragePathFromUrl` 函数中的缓冲区。
4.  **触发条件：**  `If:` header 长度超过缓冲区大小。
5.  **结果：** 远程代码执行，攻击者可以在服务器上执行任意代码。

攻击者可以通过构造恶意的 `If:` header，向易受攻击的服务器发送 PROPFIND 请求，覆盖缓冲区并劫持程序控制流。根据搜索结果，该漏洞曾被用于挖掘 Electroneum 币。

**项目地址:** [nika0x38/CVE-2017-7269](https://github.com/nika0x38/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #13

**来源**: [CVE-2017-7269-slimpagey_IIS_6.0_WebDAV_Ruby.md](../2017/CVE-2017-7269-slimpagey_IIS_6.0_WebDAV_Ruby.md)

## CVE-2017-7269

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 需要目标服务器运行存在漏洞的IIS 6.0，并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0 WebDAV服务中的缓冲区溢出漏洞。具体来说，`ScStoragePathFromUrl`函数在处理PROPFIND请求中以“If: <http://”开头的长header时存在缺陷，未进行充分的长度验证，导致缓冲区溢出。远程攻击者可以通过发送特制的PROPFIND请求，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**
从漏洞库信息和搜索结果来看，CVE-2017-7269是一个已经公开披露且被广泛利用的漏洞。提供的漏洞利用代码（exploit.rb）针对此漏洞，利用Ruby编写，通过发送特制的HTTP请求触发缓冲区溢出，从而执行预定义的shellcode。搜索结果中，有多个文章和报告表明该漏洞已被用于实际攻击，例如挖矿等。

**投毒风险评估：**
检查提供的`exploit.rb`代码，发现它允许用户指定payload类型，包括calc.exe、BSOD（蓝屏死机）、msg（显示消息框）、cmd（执行命令并关闭）和adm（添加本地管理员账户）。 这些payload都是标准的功能型payload，并无明显恶意行为。需要注意的是cmd和adm payload允许执行任意命令,具有潜在的风险，但这不是投毒行为，因为利用方式已经很明确的列出来了.
该漏洞利用代码的主要风险在于，如果攻击者在不了解shellcode具体作用的情况下执行了exploit，可能会导致系统不稳定（如BSOD）。代码本身存在一些混淆，增加了一些风险。
综合评估，存在少量投毒风险。 此风险主要是由于漏洞利用者对shellcode的不了解所导致。

**利用方式：**
1.  **目标确认：** 确认目标服务器正在运行存在漏洞的IIS 6.0，且启用了WebDAV服务。
2.  **漏洞利用：** 使用提供的`exploit.rb`脚本，指定目标IP地址、端口和所需payload。
3.  **Payload选择：** 根据攻击目标，选择合适的payload。例如，使用calc payload测试漏洞，使用cmd或adm payload执行恶意操作（如安装后门或添加管理员账户）。
4.  **执行：** 运行脚本，向目标服务器发送包含恶意header的PROPFIND请求，触发缓冲区溢出。
5.  **代码执行：** 如果利用成功，目标服务器将执行预定义的shellcode，完成攻击目标。

**优先级排序:**
如先前所述，搜索引擎结果，漏洞利用代码和漏洞库信息在确定漏洞的严重性，有效性和风险方面，是依此递减的。
* 搜索引擎结果展现该漏洞已经被利用，且有对应的挖矿攻击. * 漏洞利用代码表明已经有可用的exp. * 漏洞库信息提供了漏洞的详细描述.

**项目地址:** [slimpagey/IIS_6.0_WebDAV_Ruby](https://github.com/slimpagey/IIS_6.0_WebDAV_Ruby)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #14

**来源**: [CVE-2017-7269-zcgonvh_cve-2017-7269-tool.md](../2017/CVE-2017-7269-zcgonvh_cve-2017-7269-tool.md)

## CVE-2017-7269-Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行存在漏洞的IIS 6.0，且WebDAV服务启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 ScStoragePathFromUrl 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含过长 "If: <http://" 开头的 header 的 PROPFIND 请求，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出此漏洞在野外被利用过，并且提供了多个Exploit-DB的链接，Rapid7的漏洞数据库也确认了此漏洞的存在。搜索引擎结果显示，该漏洞在2018年被大规模利用，用于挖矿等恶意活动。提供的C#代码实现了漏洞的利用，可以上传webshell或执行shellcode。

**投毒风险分析：**

检查提供的C# POC 代码，发现代码主要功能是：
1.  发送特制的HTTP PROPFIND请求，触发WebDAV服务的缓冲区溢出漏洞。
2.  允许用户指定Host, Port, Scheme等参数定制HTTP Header。
3.  支持上传Webshell到服务器，并指定webshell的路径。
4.  支持执行shellcode。

代码中包含`check_exit_process` 和 `check_exit_thread` 字符串，这些字符串是shellcode的一部分，用于检测漏洞利用是否成功，并在需要时退出进程或线程。这不属于投毒代码，而是漏洞利用过程中的一部分。

代码中没有发现明显的恶意行为或者后门代码，例如反弹shell、信息收集等。但是，由于代码本身就是用于远程代码执行的漏洞利用程序，所以如果被恶意使用者利用，上传恶意webshell或执行恶意shellcode，仍然存在被投毒的风险。因此，判定存在10%的投毒风险，主要来自使用者。

**利用方式：**

1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的 "If: <http://" header 包含一个超长的字符串。
2.  当 IIS 6.0 处理该请求时，ScStoragePathFromUrl 函数会将该URL复制到缓冲区中，由于没有进行长度检查，导致缓冲区溢出。
3.  攻击者可以通过精心构造溢出数据，覆盖内存中的关键区域，例如函数返回地址。
4.  通过控制返回地址，攻击者可以劫持程序的执行流程，执行预先准备好的shellcode，从而在目标系统上执行任意代码。
5.  攻击者可以利用此漏洞安装webshell，以便长期控制目标服务器，或者执行挖矿程序等恶意活动。

**项目地址:** [zcgonvh/cve-2017-7269-tool](https://github.com/zcgonvh/cve-2017-7269-tool)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #15

**来源**: [CVE-2017-7269-zcgonvh_cve-2017-7269.md](../2017/CVE-2017-7269-zcgonvh_cve-2017-7269.md)

## CVE-2017-7269 Microsoft IIS WebDav ScStoragePathFromUrl Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标服务器运行Windows Server 2003 R2，且IIS 6.0的WebDAV服务开启。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7269是Microsoft IIS 6.0 WebDAV服务中ScStoragePathFromUrl函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送一个特制的PROPFIND请求，其中包含一个以 "If: <http://" 开头的超长header，来触发该漏洞。这个长header导致ScStoragePathFromUrl函数在处理URL时发生缓冲区溢出，从而允许攻击者执行任意代码。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并且已经被公开利用。提供的漏洞利用代码（Metasploit模块的Ruby代码）是一个可用的POC，可以用于验证和利用该漏洞。

**投毒风险评估：**

根据提供的代码片段，初步评估投毒风险较低，约为5%。该代码看起来是Metasploit模块的修改版本，主要修复了原始模块在某些情况下无法正常工作的问题，并添加了`PhysicalPathLength`和`HttpHost`两个选项，增加了漏洞利用的灵活性，以适应不同物理路径长度和主机绑定的情况。

代码中没有发现明显的恶意代码或后门，但仍需注意以下几点：

*   **EncoderType**设置的是`Msf::Encoder::Type::AlphanumUnicodeMixed`，这意味着payload会被编码成Unicode，可能会增加分析难度。
*   **EncoderOptions**中设置了`BufferRegister`为`ESI`，这指定了payload存储的寄存器，可能会影响漏洞利用的稳定性。
*  **PrependMigrateProc** 设置为`calc`, 这只是为了测试, 实际利用中需要更改.

**利用方式分析：**

1.  攻击者构造一个恶意的PROPFIND请求，并在请求头中包含一个以 "If: <http://" 开头的超长header。
2.  长header的长度超过ScStoragePathFromUrl函数的缓冲区大小，导致缓冲区溢出。
3.  溢出数据覆盖了关键的内存区域，包括返回地址等。
4.  攻击者通过控制溢出数据，将返回地址指向恶意代码（payload）的地址。
5.  当ScStoragePathFromUrl函数返回时，程序执行流程跳转到payload，从而执行攻击者预先设定的恶意代码，实现远程代码执行。
6. 通过设置`PhysicalPathLength`和`HttpHost`可以精确定位目标环境，提升利用成功率。

**总结：**

CVE-2017-7269是一个高危的远程代码执行漏洞，由于存在公开可用的POC，并且该漏洞已经被广泛利用，因此需要及时修复。评估的POC代码本身投毒风险较低，主要是在原有的POC基础上进行功能增强和适配性改进。但应加强安全审计。

**项目地址:** [zcgonvh/cve-2017-7269](https://github.com/zcgonvh/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---



---

## POC #12

**来源**: [CVE-2017-7269-nika0x38_CVE-2017-7269.md](../2017/CVE-2017-7269-nika0x38_CVE-2017-7269.md)

## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 `ScStoragePathFromUrl` 函数的一个缓冲区溢出漏洞。攻击者可以发送特制的 PROPFIND 请求，其中包含一个以 "If: <http://" 开头的长 header，来触发漏洞，最终导致任意代码执行。

**有效性评估：**
漏洞库信息和搜索引擎结果均表明该漏洞已被广泛利用。存在公开可用的 Exploit-DB 脚本 (例如，Exploit-DB 41738 和 41992) 和 Metasploit 模块，证明了该漏洞的有效性。

**投毒风险分析：**
提供的 "Cargo.lock" 文件仅是 Rust 项目的依赖锁定文件，用于确保构建的可重复性。它本身不包含任何可执行代码。但是，该项目 `cve-2017-7269` 依赖于多个crates, 作者可能通过污染依赖项的方式进行投毒, 比如篡改 `clap`, `anyhow` 等库.
评估存在投毒风险，主要是因为:
1.  **供应链攻击可能性：** 通过篡改依赖项进行攻击是软件供应链攻击的常见手段。
2.  **依赖项复杂性：**  Rust 项目依赖关系复杂，手动审查所有依赖项以发现恶意代码非常困难。

但是，从 `Cargo.lock` 本身无法直接判断是否存在恶意代码。需要进一步检查项目源代码以及各个依赖项的源代码才能确定是否存在投毒行为。目前仅根据依赖关系进行推断，投毒风险的概率较低，约为10%。

**利用方式分析：**
1.  **攻击向量：** 远程攻击，通过发送特制的 HTTP PROPFIND 请求。
2.  **攻击目标：** 运行在 Windows Server 2003 R2 上的 IIS 6.0 服务器。
3.  **漏洞位置：** `ScStoragePathFromUrl` 函数中的缓冲区。
4.  **触发条件：**  `If:` header 长度超过缓冲区大小。
5.  **结果：** 远程代码执行，攻击者可以在服务器上执行任意代码。

攻击者可以通过构造恶意的 `If:` header，向易受攻击的服务器发送 PROPFIND 请求，覆盖缓冲区并劫持程序控制流。根据搜索结果，该漏洞曾被用于挖掘 Electroneum 币。

**项目地址:** [nika0x38/CVE-2017-7269](https://github.com/nika0x38/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #13

**来源**: [CVE-2017-7269-slimpagey_IIS_6.0_WebDAV_Ruby.md](../2017/CVE-2017-7269-slimpagey_IIS_6.0_WebDAV_Ruby.md)

## CVE-2017-7269

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 需要目标服务器运行存在漏洞的IIS 6.0，并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269是一个存在于Microsoft IIS 6.0 WebDAV服务中的缓冲区溢出漏洞。具体来说，`ScStoragePathFromUrl`函数在处理PROPFIND请求中以“If: <http://”开头的长header时存在缺陷，未进行充分的长度验证，导致缓冲区溢出。远程攻击者可以通过发送特制的PROPFIND请求，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**
从漏洞库信息和搜索结果来看，CVE-2017-7269是一个已经公开披露且被广泛利用的漏洞。提供的漏洞利用代码（exploit.rb）针对此漏洞，利用Ruby编写，通过发送特制的HTTP请求触发缓冲区溢出，从而执行预定义的shellcode。搜索结果中，有多个文章和报告表明该漏洞已被用于实际攻击，例如挖矿等。

**投毒风险评估：**
检查提供的`exploit.rb`代码，发现它允许用户指定payload类型，包括calc.exe、BSOD（蓝屏死机）、msg（显示消息框）、cmd（执行命令并关闭）和adm（添加本地管理员账户）。 这些payload都是标准的功能型payload，并无明显恶意行为。需要注意的是cmd和adm payload允许执行任意命令,具有潜在的风险，但这不是投毒行为，因为利用方式已经很明确的列出来了.
该漏洞利用代码的主要风险在于，如果攻击者在不了解shellcode具体作用的情况下执行了exploit，可能会导致系统不稳定（如BSOD）。代码本身存在一些混淆，增加了一些风险。
综合评估，存在少量投毒风险。 此风险主要是由于漏洞利用者对shellcode的不了解所导致。

**利用方式：**
1.  **目标确认：** 确认目标服务器正在运行存在漏洞的IIS 6.0，且启用了WebDAV服务。
2.  **漏洞利用：** 使用提供的`exploit.rb`脚本，指定目标IP地址、端口和所需payload。
3.  **Payload选择：** 根据攻击目标，选择合适的payload。例如，使用calc payload测试漏洞，使用cmd或adm payload执行恶意操作（如安装后门或添加管理员账户）。
4.  **执行：** 运行脚本，向目标服务器发送包含恶意header的PROPFIND请求，触发缓冲区溢出。
5.  **代码执行：** 如果利用成功，目标服务器将执行预定义的shellcode，完成攻击目标。

**优先级排序:**
如先前所述，搜索引擎结果，漏洞利用代码和漏洞库信息在确定漏洞的严重性，有效性和风险方面，是依此递减的。
* 搜索引擎结果展现该漏洞已经被利用，且有对应的挖矿攻击. * 漏洞利用代码表明已经有可用的exp. * 漏洞库信息提供了漏洞的详细描述.

**项目地址:** [slimpagey/IIS_6.0_WebDAV_Ruby](https://github.com/slimpagey/IIS_6.0_WebDAV_Ruby)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #14

**来源**: [CVE-2017-7269-zcgonvh_cve-2017-7269-tool.md](../2017/CVE-2017-7269-zcgonvh_cve-2017-7269-tool.md)

## CVE-2017-7269-Microsoft IIS 6.0 WebDAV Buffer Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** IIS 6.0 on Windows Server 2003 R2

**利用条件:** 目标服务器运行存在漏洞的IIS 6.0，且WebDAV服务启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7269 是 Microsoft IIS 6.0 中 WebDAV 服务 ScStoragePathFromUrl 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含过长 "If: <http://" 开头的 header 的 PROPFIND 请求，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断此漏洞的POC代码是有效的。漏洞库信息明确指出此漏洞在野外被利用过，并且提供了多个Exploit-DB的链接，Rapid7的漏洞数据库也确认了此漏洞的存在。搜索引擎结果显示，该漏洞在2018年被大规模利用，用于挖矿等恶意活动。提供的C#代码实现了漏洞的利用，可以上传webshell或执行shellcode。

**投毒风险分析：**

检查提供的C# POC 代码，发现代码主要功能是：
1.  发送特制的HTTP PROPFIND请求，触发WebDAV服务的缓冲区溢出漏洞。
2.  允许用户指定Host, Port, Scheme等参数定制HTTP Header。
3.  支持上传Webshell到服务器，并指定webshell的路径。
4.  支持执行shellcode。

代码中包含`check_exit_process` 和 `check_exit_thread` 字符串，这些字符串是shellcode的一部分，用于检测漏洞利用是否成功，并在需要时退出进程或线程。这不属于投毒代码，而是漏洞利用过程中的一部分。

代码中没有发现明显的恶意行为或者后门代码，例如反弹shell、信息收集等。但是，由于代码本身就是用于远程代码执行的漏洞利用程序，所以如果被恶意使用者利用，上传恶意webshell或执行恶意shellcode，仍然存在被投毒的风险。因此，判定存在10%的投毒风险，主要来自使用者。

**利用方式：**

1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的 "If: <http://" header 包含一个超长的字符串。
2.  当 IIS 6.0 处理该请求时，ScStoragePathFromUrl 函数会将该URL复制到缓冲区中，由于没有进行长度检查，导致缓冲区溢出。
3.  攻击者可以通过精心构造溢出数据，覆盖内存中的关键区域，例如函数返回地址。
4.  通过控制返回地址，攻击者可以劫持程序的执行流程，执行预先准备好的shellcode，从而在目标系统上执行任意代码。
5.  攻击者可以利用此漏洞安装webshell，以便长期控制目标服务器，或者执行挖矿程序等恶意活动。

**项目地址:** [zcgonvh/cve-2017-7269-tool](https://github.com/zcgonvh/cve-2017-7269-tool)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

## POC #15

**来源**: [CVE-2017-7269-zcgonvh_cve-2017-7269.md](../2017/CVE-2017-7269-zcgonvh_cve-2017-7269.md)

## CVE-2017-7269 Microsoft IIS WebDav ScStoragePathFromUrl Overflow

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.0 (Windows Server 2003 R2)

**利用条件:** 目标服务器运行Windows Server 2003 R2，且IIS 6.0的WebDAV服务开启。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7269是Microsoft IIS 6.0 WebDAV服务中ScStoragePathFromUrl函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送一个特制的PROPFIND请求，其中包含一个以 "If: <http://" 开头的超长header，来触发该漏洞。这个长header导致ScStoragePathFromUrl函数在处理URL时发生缓冲区溢出，从而允许攻击者执行任意代码。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并且已经被公开利用。提供的漏洞利用代码（Metasploit模块的Ruby代码）是一个可用的POC，可以用于验证和利用该漏洞。

**投毒风险评估：**

根据提供的代码片段，初步评估投毒风险较低，约为5%。该代码看起来是Metasploit模块的修改版本，主要修复了原始模块在某些情况下无法正常工作的问题，并添加了`PhysicalPathLength`和`HttpHost`两个选项，增加了漏洞利用的灵活性，以适应不同物理路径长度和主机绑定的情况。

代码中没有发现明显的恶意代码或后门，但仍需注意以下几点：

*   **EncoderType**设置的是`Msf::Encoder::Type::AlphanumUnicodeMixed`，这意味着payload会被编码成Unicode，可能会增加分析难度。
*   **EncoderOptions**中设置了`BufferRegister`为`ESI`，这指定了payload存储的寄存器，可能会影响漏洞利用的稳定性。
*  **PrependMigrateProc** 设置为`calc`, 这只是为了测试, 实际利用中需要更改.

**利用方式分析：**

1.  攻击者构造一个恶意的PROPFIND请求，并在请求头中包含一个以 "If: <http://" 开头的超长header。
2.  长header的长度超过ScStoragePathFromUrl函数的缓冲区大小，导致缓冲区溢出。
3.  溢出数据覆盖了关键的内存区域，包括返回地址等。
4.  攻击者通过控制溢出数据，将返回地址指向恶意代码（payload）的地址。
5.  当ScStoragePathFromUrl函数返回时，程序执行流程跳转到payload，从而执行攻击者预先设定的恶意代码，实现远程代码执行。
6. 通过设置`PhysicalPathLength`和`HttpHost`可以精确定位目标环境，提升利用成功率。

**总结：**

CVE-2017-7269是一个高危的远程代码执行漏洞，由于存在公开可用的POC，并且该漏洞已经被广泛利用，因此需要及时修复。评估的POC代码本身投毒风险较低，主要是在原有的POC基础上进行功能增强和适配性改进。但应加强安全审计。

**项目地址:** [zcgonvh/cve-2017-7269](https://github.com/zcgonvh/cve-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)

---

