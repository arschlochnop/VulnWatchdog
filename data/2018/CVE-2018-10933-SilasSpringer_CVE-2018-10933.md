## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 0.6.0 及以上版本，0.7.6 之前版本，0.8.4 之前版本

**利用条件:** 目标服务器运行受影响版本的 libssh 服务，并开启了服务器模式；攻击者需能通过网络访问 SSH 端口。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞的根源在于 libssh 服务端状态机逻辑错误。在身份验证流程中，如果客户端直接向服务端发送 SSH2_MSG_USERAUTH_SUCCESS 消息（原本应由服务端在验证成功后发送），服务端会错误地跳过验证逻辑，直接进入已认证状态。提供的 POC 包含一个 Dockerfile 环境和 README 说明。Dockerfile 基于 vulhub/libssh:0.8.1 构建，这是一个已知的漏洞靶场镜像，具有高度的可靠性。代码逻辑通过软链接和 flag.txt 模拟了 CTF 场景，验证了攻击者在绕过身份验证后具有执行命令（如 find, stat）的能力。该利用方式不依赖于特定的弱密码或配置错误，而是协议实现层面的缺陷，因此利用成功率极高，且过程极其简单，仅需发送特定的协议包即可获取服务器的 Shell 访问权限。利用步骤：1. 使用 Docker 构建并启动受影响的 libssh 容器环境。2. 编写或使用现有的 Python 脚本（如 libsshauthbypass.py），利用 paramiko 或原生 socket 构造 SSH 握手。3. 在身份验证阶段，不发送 SSH2_MSG_USERAUTH_REQUEST，而是直接发送包含 MSG_USERAUTH_SUCCESS 字节的报文。4. 一旦服务端响应成功，攻击者即可通过建立的通道发送命令，例如执行 'whoami' 或寻找系统中的敏感文件。投毒风险分析：该 POC 代码主要由 Dockerfile 和 README 组成，不包含复杂的二进制文件或加密的混淆脚本。代码逻辑清晰透明，Dockerfile 使用了公开且信誉良好的 vulhub 基础镜像。README 中提到的 Python 脚本虽然在截断内容中未完全展示，但从其描述的命令行用法看，属于标准的渗透测试工具逻辑。风险评估为极低（5%），主要的潜在风险在于用户可能从第三方非官方渠道下载配套的 `libsshauthbypass.py` 脚本，如果该脚本被植入恶意后门（如反弹 Shell 到攻击者服务器或窃取本地凭证），则会产生风险。但在目前的结构化输入中，所有组件均指向教育和 CTF 竞赛用途，未发现针对研究员环境的恶意破坏行为。建议在使用此类 POC 时，始终在隔离的虚拟机或容器环境中运行，并对 Python 脚本的 socket 通信逻辑进行审计，确保其目的仅限于目标主机的漏洞验证。

**项目地址:** [https://github.com/vulhub/vulhub/tree/master/libssh/CVE-2018-10933](https://github.com/vulhub/vulhub/tree/master/libssh/CVE-2018-10933)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-10933](https://nvd.nist.gov/vuln/detail/cve-2018-10933)
