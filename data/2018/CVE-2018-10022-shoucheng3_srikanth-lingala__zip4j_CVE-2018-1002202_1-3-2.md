# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

# CVE-2018-10022

> ğŸ“¦ è¯¥CVEæœ‰ **5** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002203.md)

## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLibç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** node-unzipper/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸”zipæ–‡ä»¶åŒ…å«æ¶æ„æ„é€ çš„è·¯å¾„

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204æ˜¯`adm-zip` npmåº“åœ¨0.4.9ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚CVE-2018-1002208æ˜¯SharpZipLibåœ¨1.0 RC1ä¹‹å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨çš„ç›®å½•éå†æ¼æ´ã€‚ä¸¤ä¸ªæ¼æ´éƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨zipå½’æ¡£ä¸­ä½¿ç”¨`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯`node-unzipper`çš„ä¸€ä¸ªä»“åº“ä¿¡æ¯ï¼Œè¡¨æ˜è¯¥åº“æ˜¯`node-unzip`çš„ä¸€ä¸ªforkï¼Œå¹¶ä¿®å¤äº†ä¸€äº›bugã€‚ä½†æ˜¯ï¼Œ**ç”±äº`node-unzipper`åº“ç‰ˆæœ¬å°äº0.4.9ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨ç›®å½•éå†æ¼æ´**ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šæ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚`../../../../tmp/evil.txt`ï¼‰çš„zipæ–‡ä»¶ï¼Œä¸Šä¼ å¹¶ä½¿ç”¨å­˜åœ¨æ¼æ´çš„`node-unzipper`ç‰ˆæœ¬è§£å‹ï¼Œå³å¯å°†æ–‡ä»¶å†™å…¥åˆ°æœåŠ¡å™¨ä»»æ„ä½ç½®ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè¯¥ä»“åº“çš„`README.md`ä¸­åŒ…å«å¤§é‡npmåŒ…çš„ä½¿ç”¨æ–¹æ³•,ä½†licenseæ–‡ä»¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„å¯ç–‘è¡Œä¸º, ä½†æ˜¯ä½œä¸ºè¾…åŠ©å·¥å…·,å­˜åœ¨è¢«æ¶æ„ä½¿ç”¨çš„é£é™©, ä»£ç æœ¬èº«æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†å­˜åœ¨è¢«æ»¥ç”¨é£é™©ï¼Œå› æ­¤è®¾ç½®ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #2

**æ¥æº**: [CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md](../2018/CVE-2018-10022-ossf-cve-benchmark_CVE-2018-1002204.md)

## CVE-2018-10022 ç³»åˆ—æ¼æ´ï¼ˆæ¨æµ‹ï¼‰

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•ç©¿è¶Š/ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“åº”ç”¨:** å¯èƒ½å—å½±å“çš„åº“åŒ…æ‹¬adm-zip, SharpZipLibç­‰

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“çš„ç‰ˆæœ¬æ ¹æ®å…·ä½“CVEè€Œå®šï¼Œä¾‹å¦‚adm-zip < 0.4.9ï¼ŒSharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–å¤„ç†æ¶æ„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** éƒ¨åˆ†å¯ç”¨ï¼Œéœ€è¦æ ¹æ®å…·ä½“CVEæ„é€ ZIPæ–‡ä»¶

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022 ç›¸å…³çš„æ¼æ´æ˜¯ä¸€ç³»åˆ—ä¸ ZIP æ–‡ä»¶å¤„ç†ç›¸å…³çš„ç›®å½•ç©¿è¶Šæ¼æ´ã€‚ å…¶ä¸­ï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“åœ¨ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `../` å†™å…¥ä»»æ„æ–‡ä»¶ã€‚ CVE-2018-1002208 æè¿°äº† SharpZipLib åœ¨ 1.0 RC1 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç±»ä¼¼çš„æ¼æ´ã€‚æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZIP æ–‡ä»¶æ ¼å¼è§„èŒƒï¼ˆAPPNOTE.TXTï¼‰ã€‚è™½ç„¶å®ƒæœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä½†ç†è§£ ZIP æ–‡ä»¶æ ¼å¼å¯¹äºæ„é€ åˆ©ç”¨è¿™äº›æ¼æ´çš„ POC æ˜¯è‡³å…³é‡è¦çš„ã€‚ åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ„é€ åŒ…å«æ¶æ„æ–‡ä»¶è·¯å¾„ï¼ˆåŒ…å«`../`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œå½“ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„ ZIP åº“è§£å‹è¯¥æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚ æŠ•æ¯’é£é™©ï¼šè™½ç„¶æä¾›çš„ APPNOTE.TXT æ–‡ä»¶æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½åœ¨å…¶ä»–æ­£å¸¸çš„ ZIP æ–‡ä»¶ä¸­åµŒå…¥åŒ…å«æ¶æ„è·¯å¾„çš„æ–‡ä»¶ï¼Œè¯±å¯¼ç”¨æˆ·æˆ–ç³»ç»Ÿè§£å‹æ‰§è¡Œï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚è¿™é‡Œçš„ 10% è¡¨ç¤ºå­˜åœ¨è¿™ç§å¯èƒ½æ€§ï¼Œä½†éœ€è¦å…·ä½“åˆ†æZIPæ–‡ä»¶çš„å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [ossf-cve-benchmark/CVE-2018-1002204](https://github.com/ossf-cve-benchmark/CVE-2018-1002204)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #3

**æ¥æº**: [CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md](../2018/CVE-2018-10022-shoucheng3_codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5.md)

## CVE-2018-10022

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip/SharpZipLib

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä»»æ„æ–‡ä»¶å†™å…¥

**å½±å“ç‰ˆæœ¬:** adm-zip < 0.4.9, SharpZipLib < 1.0 RC1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ä¸Šä¼ æ¶æ„æ„é€ çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-10022å®é™…ä¸Šæ˜¯æŒ‡å¤šä¸ªä¸åŒçš„æ¼æ´ï¼Œå…¶ä¸­CVE-2018-1002204å½±å“`adm-zip` npmåº“ï¼Œè€ŒCVE-2018-1002208å½±å“`SharpZipLib`åº“ã€‚è¿™ä¸¤ä¸ªæ¼æ´éƒ½å±äºç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ZIPæ–‡ä»¶ä¸­æ„é€ åŒ…å«`../`ï¼ˆç‚¹ç‚¹æ–œæ ï¼‰çš„æ–‡ä»¶è·¯å¾„ï¼Œä»è€Œå°†æ–‡ä»¶å†™å…¥åˆ°ä»»æ„ä½ç½®ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯Apache Licenseçš„æ–‡æœ¬ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç”¨äºç›´æ¥éªŒè¯æ¼æ´ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒæ˜ç¡®ï¼šæ„é€ æ¶æ„ZIPæ–‡ä»¶ï¼Œä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿï¼Œè§¦å‘è§£å‹æ“ä½œï¼Œå³å¯å†™å…¥ä»»æ„æ–‡ä»¶ã€‚é‰´äºæä¾›çš„ä»£ç åªæ˜¯LICENSEæ–‡ä»¶ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5](https://github.com/shoucheng3/codehaus-plexus__plexus-archiver_CVE-2018-1002200_3-5)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #4

**æ¥æº**: [CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md](../2018/CVE-2018-10022-shoucheng3_srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2.md)

## CVE-2018-1002202 - zip4j Path Traversal

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** è·¯å¾„éå†

**å½±å“åº”ç”¨:** zip4j

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶ã€‚

**å½±å“ç‰ˆæœ¬:** < 1.3.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿæ§åˆ¶zipæ–‡ä»¶çš„å†…å®¹ï¼Œä¾‹å¦‚ä¸Šä¼ zipæ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2018-1002202 æ˜¯ zip4j åº“ä¸­ç‰ˆæœ¬ä½äº 1.3.3 çš„ä¸€ä¸ªè·¯å¾„éå†æ¼æ´ã€‚æ ¹æ®æä¾›çš„æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡åœ¨ zip å‹ç¼©æ–‡ä»¶ä¸­åŒ…å« `../` å­—ç¬¦æ¥å†™å…¥ä»»æ„æ–‡ä»¶ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å« zip4j 1.3.2ï¼ˆæ˜“å—æ”»å‡»ï¼‰å’Œ 1.3.3ï¼ˆå·²ä¿®å¤ï¼‰çš„æºä»£ç ï¼Œä»¥åŠç›¸å…³çš„æ„å»ºæ–‡ä»¶ï¼ˆpom.xmlï¼‰å’Œè®¸å¯è¯ä¿¡æ¯ã€‚é€šè¿‡å¯¹æ¯”1.3.2å’Œ1.3.3ç‰ˆæœ¬ä»£ç ï¼Œå¯ä»¥éªŒè¯è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„ä»£ç ï¼Œæ­¤POCæ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæä¾›äº†æ˜“å—æ”»å‡»çš„zip4j 1.3.2æºä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**è¯¥ä»“åº“åŒ…å«zip4jçš„decompiledä»£ç ä»¥åŠmavené…ç½®ã€‚æ”»å‡»è€…ç†è®ºä¸Šå¯èƒ½ä¿®æ”¹è¿™äº›ä»£ç ï¼Œç„¶ååœ¨ä¸çŸ¥æƒ…çš„ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªä»“åº“çš„ä»£ç è¿›è¡Œæ„å»ºæ—¶ï¼Œå¼•å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶ä»“åº“æä¾›äº†vulnerableå’Œfixedä¸¤ä¸ªtagï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†fixedç‰ˆæœ¬çš„ä»£ç ï¼Œå¹¶åœ¨ç”¨æˆ·æ„å»ºæ—¶æ›¿æ¢æˆä¿®æ”¹åçš„ç‰ˆæœ¬ï¼Œå°±å¯èƒ½é€ æˆæŠ•æ¯’ã€‚å› æ­¤ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**æ”»å‡»è€…åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ zip æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å¸¦æœ‰ `../` è·¯å¾„çš„æ–‡ä»¶æ¡ç›®ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨æ˜“å—æ”»å‡»çš„ zip4j ç‰ˆæœ¬è§£å‹æ­¤ zip æ–‡ä»¶æ—¶ï¼Œzip4j æ²¡æœ‰æ­£ç¡®åœ°æ¸…ç†æ–‡ä»¶åï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶è§£å‹åçš„æ–‡ä»¶å†™å…¥ä½ç½®ï¼Œä»è€Œå†™å…¥ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2](https://github.com/shoucheng3/srikanth-lingala__zip4j_CVE-2018-1002202_1-3-2)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---



---

## POC #5

**æ¥æº**: [CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md](../2018/CVE-2018-10022-shoucheng3_zeroturnaround__zt-zip_CVE-2018-1002201_1-12.md)

## CVE-2018-1002204 adm-zip ç›®å½•éå†æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2018-10022

**æ¼æ´ç±»å‹:** ç›®å½•éå†

**å½±å“åº”ç”¨:** adm-zip npm library

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æ”»å‡»è€…å†™å…¥ä»»æ„æ–‡ä»¶

**å½±å“ç‰ˆæœ¬:** < 0.4.9

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿä¸Šä¼ æˆ–æ§åˆ¶åŒ…å«æ¶æ„è·¯å¾„çš„ZIPæ–‡ä»¶

**POC å¯ç”¨æ€§:** å¾…éªŒè¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®æœç´¢ç»“æœï¼ŒCVE-2018-1002204 æè¿°äº† adm-zip npm åº“ 0.4.9 ä¹‹å‰çš„ç‰ˆæœ¬å­˜åœ¨ç›®å½•éå†æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„è·¯å¾„ï¼ˆå¦‚ `../../../../path/to/file`ï¼‰çš„ ZIP æ–‡ä»¶ï¼Œè§£å‹æ—¶å°†æ–‡ä»¶å†™å…¥ä»»æ„ä½ç½®ï¼Œä»è€Œè¦†ç›–æ•æ„Ÿæ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚

æä¾›çš„â€œæ¼æ´åˆ©ç”¨ä»£ç â€å®é™…ä¸Šæ˜¯ ZT Zip åº“çš„ Changelog å’Œ License æ–‡ä»¶ï¼Œå¹¶éç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä½†æ˜¯ï¼Œç»“åˆ CVE ä¿¡æ¯ï¼Œå¯ä»¥æ¨æ–­åˆ©ç”¨æ–¹å¼ï¼šæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ååŒ…å«ç›®å½•éå†çš„ payloadï¼Œå½“ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ adm-zip ç‰ˆæœ¬è§£å‹æ­¤ ZIP æ–‡ä»¶æ—¶ï¼Œæ¶æ„æ–‡ä»¶ä¼šè¢«å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä»»æ„ä½ç½®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
éœ€è¦éªŒè¯ï¼Œæä¾›çš„ä»£ç ä¸æ˜¯ç›´æ¥çš„PoCï¼Œéœ€è¦æ ¹æ®æ¼æ´æè¿°æ„é€ æ¶æ„ ZIP æ–‡ä»¶æ‰èƒ½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯ Changelog å’Œ License æ–‡ä»¶ï¼Œæœ¬èº«ä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä½†æ˜¯å­˜åœ¨æå°çš„é£é™©ï¼ˆå¤§çº¦ 5%ï¼‰ï¼Œæ”»å‡»è€…å¯èƒ½åœ¨åˆæ³•çš„ä»£ç ä¸­éšè—ä¸€äº›éš¾ä»¥å¯Ÿè§‰çš„æ¶æ„ä»£ç ï¼Œä½†è¿™ç§æƒ…å†µçš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶ä¸»è¦æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰§è¡Œçš„å¯èƒ½æ€§å¾ˆä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ç³»ç»Ÿä½¿ç”¨çš„ adm-zip ç‰ˆæœ¬ä½äº 0.4.9ã€‚
2.  æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡ä»¶åçš„ ZIP æ–‡ä»¶ï¼Œä¾‹å¦‚ `evil.zip`ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæ–‡ä»¶ `../../../../tmp/evil.txt`ã€‚
3.  å¦‚æœç›®æ ‡ç³»ç»Ÿä½¿ç”¨æœ‰æ¼æ´çš„ adm-zip è§£å‹ `evil.zip`ï¼Œåˆ™ `evil.txt` ä¼šè¢«å†™å…¥åˆ° `/tmp/evil.txt`ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–ç›®æ ‡æ–‡ä»¶ã€‚

**æ’åºä¼˜å…ˆçº§:**
æœç´¢å¼•æ“ç»“æœ > æ¼æ´åˆ©ç”¨ä»£ç  > æ¼æ´åº“ä¿¡æ¯


**é¡¹ç›®åœ°å€:** [shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12](https://github.com/shoucheng3/zeroturnaround__zt-zip_CVE-2018-1002201_1-12)

**æ¼æ´è¯¦æƒ…:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)

---

