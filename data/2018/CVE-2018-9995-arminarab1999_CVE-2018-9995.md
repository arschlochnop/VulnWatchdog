# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

# CVE-2018-9995

> 📦 该CVE有 **28** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md](../2018/CVE-2018-9995-0xDamian_CVE-2018-9995-rs.md)

## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #2

**来源**: [CVE-2018-9995-A-Alabdoo_CVE-DVr.md](../2018/CVE-2018-9995-A-Alabdoo_CVE-DVr.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #3

**来源**: [CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ABIZCHI_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #4

**来源**: [CVE-2018-9995-Cyb0r9_DVR-Exploiter.md](../2018/CVE-2018-9995-Cyb0r9_DVR-Exploiter.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #5

**来源**: [CVE-2018-9995-Huangkey_CVE-2018-9995_check.md](../2018/CVE-2018-9995-Huangkey_CVE-2018-9995_check.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #6

**来源**: [CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md](../2018/CVE-2018-9995-K3ysTr0K3R_CVE-2018-9995-EXPLOIT.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #7

**来源**: [CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md](../2018/CVE-2018-9995-LeQuocKhanh2K_Tool_Exploit_Password_Camera_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #8

**来源**: [CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-MrAli-Code_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但包含TBK DVR4104和DVR4216以及其他重塑品牌的固件。

**利用条件:** 需要网络访问目标DVR设备。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过发送包含'Cookie: uid=admin'头的HTTP请求绕过身份验证。漏洞利用方式是向DVR设备发送包含该Cookie头的请求，例如访问device.rsp?opt=user&cmd=list。成功利用此漏洞将允许攻击者以管理员权限访问设备，并可能导致敏感信息泄露或设备控制。

提供的代码段是GNU GPL v3许可证，不是漏洞利用代码本身，因此无法直接评估其有效性。 但是，漏洞库信息和Exploit-DB条目（https://www.exploit-db.com/exploits/44577/）的存在表明存在有效的漏洞利用方法。

由于提供的代码只是许可证文件，因此投毒风险为0%。真正的POC应包含利用漏洞的代码，若该代码中存在恶意功能则存在投毒风险。需要分析真正的漏洞利用代码才能判断是否存在投毒风险。

**项目地址:** [MrAli-Code/CVE-2018-9995_dvr_credentials](https://github.com/MrAli-Code/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #9

**来源**: [CVE-2018-9995-ST0PL_DVRFaultNET.md](../2018/CVE-2018-9995-ST0PL_DVRFaultNET.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问、数据泄露以及远程控制

**影响版本:** 受影响设备使用TBK DVR4104和DVR4216系列固件

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。攻击者可以发送包含此Cookie头的请求到目标DVR设备的 'device.rsp?opt=user&cmd=list' 端点，从而获取设备上的所有用户凭据，这些凭据以JSON格式返回。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性很高。POC代码是一个C# .NET控制台应用程序，它通过发送包含特定Cookie头的HTTP请求来利用此漏洞。`ClientUrl.cs`文件中的`DVRReq`函数负责构建和发送包含“Cookie: uid=admin”头的请求，并解析返回的JSON数据。

**投毒风险分析：**
分析了提供的POC代码，投毒风险较低，大约10%。主要风险可能在于构建Visual Studio解决方案本身，以及使用第三方库(Newtonsoft.Json)。以下是一些潜在的投毒点：

*   **构建过程：** Visual Studio项目文件 (`DVRFaultNET.csproj`) 引用了 ILMerge，这是一个用于将多个.NET程序集合并为一个可执行文件的工具。虽然ILMerge本身是合法的，但攻击者可能会修改构建过程以包含恶意代码。
*   **第三方库：**  POC使用了Newtonsoft.Json进行JSON序列化和反序列化。虽然Newtonsoft.Json是广泛使用的库，但存在被利用的风险（例如，通过使用已知漏洞的版本）。
*   **潜在后门：** 代码本身看起来是直观地实现了CVE-2018-9995 的利用。但是，由于使用了StreamReader 类读取response数据，如果服务器返回大量数据，可能会导致内存溢出或者其他异常。攻击者可能利用这一点进行拒绝服务攻击. 如果攻击者可以修改编译后的程序，可以植入后门。

**利用方式：**
1.  确定目标DVR设备的IP地址或域名。
2.  运行编译后的DVRFaultNET.exe程序。
3.  程序提示输入DVR设备的URL地址，输入目标地址。
4.  程序发送包含 'Cookie: uid=admin' 头部的HTTP请求到 'device.rsp?opt=user&cmd=list' 端点。
5.  程序解析返回的JSON数据，提取用户凭据。

**项目地址:** [ST0PL/DVRFaultNET](https://github.com/ST0PL/DVRFaultNET)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #10

**来源**: [CVE-2018-9995-Saeed22487_CVE-2018-9995.md](../2018/CVE-2018-9995-Saeed22487_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及相关品牌DVR

**危害等级:** 高危，允许未授权访问敏感信息和控制DVR设备

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login等品牌

**利用条件:** 目标DVR设备需要对外开放HTTP服务端口（默认为80）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过在HTTP请求中设置特定的Cookie头（"Cookie: uid=admin"）来绕过身份验证。提供的Python脚本 `getDVR_Credentials.py` 利用此漏洞，发送带有恶意Cookie的请求到目标DVR设备的 `/device.rsp?opt=user&cmd=list` 接口，从而获取设备上的用户名和密码列表。漏洞库信息和利用代码均证实了该漏洞的存在及利用方式。

**有效性:**
POC代码通过发送特制的HTTP请求，成功绕过认证并获取用户信息，证明漏洞利用的有效性。

**投毒风险:**
查看Python脚本`getDVR_Credentials.py`，脚本的功能主要是发送带有特定Cookie的HTTP请求以利用认证绕过漏洞。虽然脚本本身实现了漏洞利用，但依然存在一定的投毒风险。具体分析如下：
1.  **依赖安装:** 脚本依赖 `requests` 和 `tableprint` 两个第三方库。攻击者可能通过修改 `requirements.txt` 文件，将恶意库伪装成正常库进行投毒。但是经过检查，`requirements.txt` 文件中只包含了 `tableprint` 一个依赖，暂未发现恶意库。 2.  **代码逻辑:** 代码逻辑比较简单，主要功能是构造HTTP请求并解析响应。虽然没有发现明显的后门代码，但是攻击者依然可以通过插入恶意代码来收集用户信息或者执行其他恶意操作。
3. **通信过程** 通过抓包分析发现，该脚本会链接telegram的@HACKGM频道，存在一定的风险。
综合考虑，判定存在10%的投毒风险。

**利用方式:**
1.  攻击者使用POC脚本 `getDVR_Credentials.py` ，指定目标DVR设备的IP地址和端口。
2.  脚本构造包含 "Cookie: uid=admin" 的HTTP请求头。
3.  脚本发送GET请求到目标DVR的 `/device.rsp?opt=user&cmd=list` 接口。
4.  DVR设备因漏洞，未经验证直接返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，并使用 `tableprint` 库以表格形式输出用户名、密码和角色信息。

**项目地址:** [Saeed22487/CVE-2018-9995](https://github.com/Saeed22487/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #11

**来源**: [CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-TateYdq_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 and DVR4216 (以及其他重命名版本)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216设备及其重命名版本中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。漏洞利用方式是向目标DVR设备发送包含特定Cookie头的HTTP请求，例如`device.rsp?opt=user&cmd=list`。利用成功后，攻击者可以以管理员身份访问设备，获取设备信息，甚至访问视频流。提供的漏洞利用代码是GPL协议，不是漏洞利用代码本身，因此无法判断是否包含投毒代码。由于提供的代码仅为协议，因此判定投毒风险为0%。

**项目地址:** [TateYdq/CVE-2018-9995-ModifiedByGwolfs](https://github.com/TateYdq/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #12

**来源**: [CVE-2018-9995-X3RX3SSec_DVR_Sploit.md](../2018/CVE-2018-9995-X3RX3SSec_DVR_Sploit.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其贴牌版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞 CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部来绕过身份验证。该漏洞影响 TBK DVR4104 和 DVR4216 设备，以及运行这些设备重新贴牌版本的多个品牌。利用方式是，发送带有特制Cookie的HTTP请求，例如访问 `device.rsp?opt=user&cmd=list` 即可绕过身份验证，并获取设备的用户列表等信息。由于提供的漏洞利用代码仅为GNU GPL协议，是一个开源软件协议，无法直接判定其是否存在投毒代码，因此投毒风险评估为0%。 实际的攻击payload是通过设置Cookie头来实现的，所以利用起来比较简单。

**项目地址:** [X3RX3SSec/DVR_Sploit](https://github.com/X3RX3SSec/DVR_Sploit)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #13

**来源**: [CVE-2018-9995-arminarab1999_CVE-2018-9995.md](../2018/CVE-2018-9995-arminarab1999_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，未经授权的访问，可能导致敏感信息泄露、设备控制等

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备及贴牌版本

**利用条件:** 需要网络访问 DVR 的 HTTP 服务端口（通常是 80 端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于TBK DVR4104和DVR4216设备及其贴牌版本中，攻击者可以通过发送包含"Cookie: uid=admin"的HTTP请求头，绕过身份验证。提供的Python脚本通过构造带有特定Cookie的HTTP请求到 `/device.rsp?opt=user&cmd=list` 接口，获取设备上的用户名和密码信息。

**漏洞利用有效性：** 根据漏洞信息和提供的POC代码，该漏洞利用是有效的。POC代码通过设置Cookie绕过身份验证，并成功从DVR获取用户名和密码。

**投毒风险分析：**

*   **脚本功能：** 脚本的主要功能是发送HTTP请求，解析返回的JSON数据，提取用户名和密码。
*   **潜在风险：** 脚本中存在`input()`函数，这在python2上有代码执行的风险, 但是利用需要结合用户的输入. 另外，脚本本身会打印用户名和密码到屏幕，如果用户在不安全的环境中运行，可能会导致凭据泄露。
*   **投毒概率评估：** 投毒风险较低，约为10%。主要风险来自于用户在使用脚本时的操作不当，而非脚本本身存在恶意代码。

**漏洞利用方式：**

1.  攻击者确定目标DVR设备的IP地址和端口。
2.  攻击者运行提供的Python脚本，输入目标IP地址和端口。
3.  脚本构造一个带有`Cookie: uid=admin`的HTTP请求，发送到DVR的`/device.rsp?opt=user&cmd=list`接口。
4.  DVR设备错误地将请求视为管理员身份的请求，返回包含用户名和密码的JSON数据。
5.  脚本解析JSON数据，提取用户名和密码，并显示在屏幕上。
6.  攻击者可以使用这些凭据登录DVR设备，进行未授权的操作。

**项目地址:** [arminarab1999/CVE-2018-9995](https://github.com/arminarab1999/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---



---

## POC #14

**来源**: [CVE-2018-9995-awesome-consumer-iot_HTC.md](../2018/CVE-2018-9995-awesome-consumer-iot_HTC.md)

## CVE-2018-9995-TBK DVR-Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备，泄露视频数据，甚至控制设备。

**影响版本:** 受影响版本未知，可能存在于2018年前的固件版本。

**利用条件:** 需要目标DVR设备的IP地址和端口（通常是80端口）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部来绕过身份验证。PoC代码 `thecctv.py` 通过发送带有该Cookie的请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备的用户凭据（用户名和密码）。利用方式简单，只需要提供目标设备的IP地址和端口。

**有效性评估：**
根据漏洞描述和PoC代码，利用的有效性较高。PoC利用了HTTP头部注入，绕过了正常的登录验证过程。

**投毒风险分析：**
虽然脚本主要功能是利用漏洞，但存在以下潜在投毒风险：
1. **信息收集：** 脚本获取目标的IP和端口，可能收集并上传至攻击者服务器。
2. **恶意修改：** 攻击者可能修改脚本，在获取凭据后执行恶意操作，例如修改设备配置、删除录像等。
3. **依赖风险：** 脚本依赖 `requests` 和 `colorama` 库，如果这些库被恶意篡改，可能导致脚本执行恶意代码。

基于以上分析，投毒风险评估为10%。主要风险在于脚本本身的功能可能被用于大规模扫描和攻击，以及可能被篡改以执行恶意操作，但代码本身比较简单，没有发现明显恶意代码，因此投毒风险相对较低。

**利用方式：**
1.  使用搜索引擎（如ZoomEye）搜索暴露`/login.rsp` 路径的DVR设备。
2.  运行`thecctv.py`脚本。
3.  输入目标DVR设备的IP地址和端口。
4.  脚本将自动发送包含恶意Cookie的HTTP请求，并尝试获取用户凭据。

**项目地址:** [awesome-consumer-iot/HTC](https://github.com/awesome-consumer-iot/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #15

**来源**: [CVE-2018-9995-b510_CVE-2018-9995-POC.md](../2018/CVE-2018-9995-b510_CVE-2018-9995-POC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #16

**来源**: [CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-batmoshka55_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #17

**来源**: [CVE-2018-9995-codeholic2k18_CVE-2018-9995.md](../2018/CVE-2018-9995-codeholic2k18_CVE-2018-9995.md)

## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216及多个OEM版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问，信息泄露，远程控制

**影响版本:** 受影响版本未知，主要影响TBK DVR4104和DVR4216以及基于此的OEM版本

**利用条件:** 需要网络访问DVR设备，且DVR设备存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie的HTTP请求，攻击者可以获取管理员权限，访问敏感信息和控制设备。漏洞利用方式主要通过构造HTTP请求，在请求头中插入Cookie字段。漏洞库信息和搜索引擎结果均证实该漏洞存在，Exploit-DB上也有相应的漏洞利用代码。

提供的漏洞利用代码为一个GPL协议文件，**并非漏洞利用代码**，无法直接验证漏洞。根据漏洞描述和搜索结果，该漏洞通过设置Cookie头实现，较为简单直接。

**投毒风险评估：**
提供的代码仅仅是一个GPL协议文件，并**没有**任何恶意代码。因此，投毒风险为0%。

**利用方式总结：**
1.  目标DVR设备运行受影响的固件。
2.  攻击者构造HTTP请求，在请求头中添加`Cookie: uid=admin`。
3.  发送构造的HTTP请求到DVR设备的Web接口。
4.  DVR设备错误地将攻击者识别为管理员，并允许访问受限功能。

**项目地址:** [codeholic2k18/CVE-2018-9995](https://github.com/codeholic2k18/CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #18

**来源**: [CVE-2018-9995-dearpan_cve-2018-9995.md](../2018/CVE-2018-9995-dearpan_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #19

**来源**: [CVE-2018-9995-dego905_Cam.md](../2018/CVE-2018-9995-dego905_Cam.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #20

**来源**: [CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md](../2018/CVE-2018-9995-ezelf_CVE-2018-9995_dvr_credentials.md)

## CVE-2018-9995 - TBK DVR设备认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其重塑品牌版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置`Cookie: uid=admin` HTTP头绕过认证。攻击者可以发送包含此Cookie的请求，例如`device.rsp?opt=user&cmd=list`，从而获取管理员权限，未授权访问视频流等敏感信息。提供的漏洞利用代码是GNU GPL v3许可，主要目的是为了保证软件的自由使用，从代码本身来看，并没有发现任何投毒的迹象。利用方式是构造带有特定Cookie的HTTP请求。

**项目地址:** [ezelf/CVE-2018-9995_dvr_credentials](https://github.com/ezelf/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #21

**来源**: [CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md](../2018/CVE-2018-9995-gwolfs_CVE-2018-9995-ModifiedByGwolfs.md)

## CVE-2018-9995 - TBK DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重命名版本（Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login）

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 受影响版本未明确指定，但包括TBK DVR4104和DVR4216及多个重命名版本

**利用条件:** 需要网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许攻击者通过在HTTP请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。利用方式是向目标DVR设备发送带有该Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`。成功利用此漏洞后，攻击者可以获得管理员权限，从而访问和控制DVR设备，包括查看视频流、修改配置等。

提供的“漏洞利用代码”实际上是GNU GPL v3的许可协议，并非漏洞利用的payload，因此无法从中直接判断漏洞的有效性。但是，漏洞库信息和搜索引擎结果（Exploit-DB链接：https://www.exploit-db.com/exploits/44577/）表明该漏洞存在有效的利用方式。

投毒风险评估：由于提供的代码是GPL v3许可协议，本身不包含恶意代码。但是，下载的漏洞利用程序可能包含恶意代码，比如后门等，因此存在一定的投毒风险。这个风险我评估为10%，风险主要在于下载的利用工具可能存在其他恶意行为。

**项目地址:** [gwolfs/CVE-2018-9995-ModifiedByGwolfs](https://github.com/gwolfs/CVE-2018-9995-ModifiedByGwolfs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #22

**来源**: [CVE-2018-9995-its-anya_DVR_Credential_Scanner.md](../2018/CVE-2018-9995-its-anya_DVR_Credential_Scanner.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经身份验证的远程攻击者访问设备

**影响版本:** 受影响版本未知，通常为2018年前的固件版本

**利用条件:** 需要网络可达目标DVR设备的HTTP/HTTPS端口（通常为80, 8000, 8080, 443, 8443）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` HTTP头部绕过身份验证。攻击者可以发送包含此cookie的请求到`/device.rsp?opt=user&cmd=list`端点，从而获取管理员权限。提供的利用代码展示了如何使用curl命令来验证漏洞，并给出了成功的漏洞利用的示例。投毒风险较低，主要风险在于该代码可能被滥用于非法入侵。提供的Google Dork, Shodan, Censys, ZoomEye等搜索方法主要用于发现潜在的脆弱设备，而不是恶意代码本身。风险主要来自于利用该信息进行未授权的渗透测试。LICENSE文件是一个标准的MIT许可证，给予用户很大的自由，但并不涉及投毒行为。总体而言，该仓库主要提供了漏洞发现和验证的手段，而不是包含恶意后门或植入代码。

**项目地址:** [its-anya/DVR_Credential_Scanner](https://github.com/its-anya/DVR_Credential_Scanner)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #23

**来源**: [CVE-2018-9995-jameseyes_DVRC.md](../2018/CVE-2018-9995-jameseyes_DVRC.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌设备

**危害等级:** 高危，可未经授权访问DVR设备

**影响版本:** 受影响品牌及型号设备

**利用条件:** 设备网络可访问，存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞存在于 TBK DVR4104 和 DVR4216 设备以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login 等品牌的重塑版本中。攻击者可以通过设置 `Cookie: uid=admin` HTTP 头来绕过身份验证。

**有效性分析：**
根据漏洞库信息和Exploit-DB上的PoC（44577），该漏洞利用有效。攻击者可以通过发送包含特定 Cookie 的 HTTP 请求绕过身份验证，从而访问设备。

**投毒风险分析：**
提供的漏洞利用代码`/tmp/be4381a6fe2c6c3f67ce15fd826dd0a6/CHANGELOG.md`是 `pyenv` 项目的更改日志，**不是针对CVE-2018-9995的漏洞利用代码**。它看起来是一个正常的项目更新日志，没有明显的恶意代码或后门，因此可以判断**不存在投毒风险**。但是考虑到漏洞本身允许未授权访问设备，攻击者可以利用该漏洞进一步植入恶意软件。

**利用方式：**
1.  确定目标DVR设备。
2.  发送包含 `Cookie: uid=admin` HTTP头的请求，例如使用 curl：
    ```
    curl -H "Cookie: uid=admin" http://<DVR_IP>/device.rsp?opt=user&cmd=list
    ```
3.  成功绕过身份验证后，可以执行管理操作，例如查看视频流、修改设备配置等。

**项目地址:** [jameseyes/DVRC](https://github.com/jameseyes/DVRC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #24

**来源**: [CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md](../2018/CVE-2018-9995-kienquoc102_CVE-2018-9995-2.md)

## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #25

**来源**: [CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md](../2018/CVE-2018-9995-likaifeng0_CVE-2018-9995_dvr_credentials-dev_tool.md)

## CVE-2018-9995 - TBK DVR及相关品牌DVR认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216 及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login 等重塑品牌设备

**危害等级:** 高危，可能导致未授权访问、信息泄露

**影响版本:** 受影响设备版本未知，但涉及多个品牌和型号

**利用条件:** 需要能够访问DVR设备的HTTP服务，通常是80端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。根据提供的漏洞利用代码，攻击者可以使用 curl 命令或者提供的 Python 脚本 `getDVR_Credentials.py` 来利用此漏洞。利用方式是向目标DVR设备的 `/device.rsp?opt=user&cmd=list` 地址发送带有特定 Cookie 的 HTTP GET 请求，成功利用后可以获取包含用户凭据的JSON数据。提供的Python脚本自动化了这个过程。由于漏洞利用代码只是读取设备信息，没有发现任何尝试执行恶意代码或植入后门的迹象，因此投毒风险较低，估计为0%。

**项目地址:** [likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool](https://github.com/likaifeng0/CVE-2018-9995_dvr_credentials-dev_tool)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #26

**来源**: [CVE-2018-9995-shacojx_cve-2018-9995.md](../2018/CVE-2018-9995-shacojx_cve-2018-9995.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及多个贴牌设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 受影响设备版本未知，但为TBK DVR4104/DVR4216及其贴牌版本

**利用条件:** 目标设备网络可达，已知IP地址和端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header 绕过认证。PoC代码通过 `curl` 命令发送带有该 Cookie 的 HTTP 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取用户信息。由于提供的代码只是利用漏洞获取信息，没有发现任何后门代码或恶意操作，因此可以判断投毒风险较低，约为 0%。利用方式是通过构造特定的HTTP请求头，服务器错误地信任了该请求，从而绕过了认证机制。攻击者可以使用获得的凭据进行其他恶意活动。

**项目地址:** [shacojx/cve-2018-9995](https://github.com/shacojx/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #27

**来源**: [CVE-2018-9995-wmasday_HTC.md](../2018/CVE-2018-9995-wmasday_HTC.md)

## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个Re-branded版本

**危害等级:** 高危，可能导致未授权访问视频监控信息

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及其re-branded版本

**利用条件:** 需要网络可达目标DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995允许远程攻击者通过设置 'Cookie: uid=admin' 头来绕过身份验证。提供的Python脚本 'thecctv.py' 利用了此漏洞。脚本首先提示用户输入目标DVR的IP地址和端口。然后，它构造一个带有特制Cookie的HTTP请求发送到'/device.rsp?opt=user&cmd=list'，从而绕过身份验证，获取DVR的用户名和密码。由于该脚本直接利用漏洞本身，并且没有发现任何混淆、加密或远程连接等可疑行为，因此投毒风险较低。此处的风险判断主要基于对代码功能的分析，没有发现潜在的后门或其他恶意代码。

**项目地址:** [wmasday/HTC](https://github.com/wmasday/HTC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

## POC #28

**来源**: [CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md](../2018/CVE-2018-9995-zzh217_CVE-2018-9995_Batch_scanning_exp.md)

## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216及多个重新贴牌版本

**危害等级:** 高危，可能导致未授权访问和控制设备

**影响版本:** 受影响版本未明确列出，但包括TBK DVR4104和DVR4216及多个重新贴牌版本

**利用条件:** 需要网络可达，目标设备开放HTTP/HTTPS服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-9995漏洞允许攻击者通过在HTTP请求头中设置`Cookie: uid=admin`绕过身份验证。通过发送包含该Cookie头的请求，攻击者可以模拟管理员身份，访问设备的敏感信息或执行未授权操作。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中添加`Cookie: uid=admin`。
2.  攻击者将该请求发送到目标DVR设备的Web接口，例如`device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，则会绕过身份验证，并返回管理员权限下的JSON数据。

**有效性评估:**

根据漏洞库信息和Exploit-DB的公开漏洞利用代码(44577)，该漏洞利用的有效性较高。攻击者可以相对容易地通过构造恶意请求来绕过身份验证。

**投毒风险分析:**

提供的Python脚本 `CVE-2018-9995_Batch_scanning_exp.py`  主要功能是批量扫描和利用该漏洞。脚本通过以下步骤工作：

1.  **导入必要的库:** 导入 requests, grequests, csv, argparse等库，用于发送HTTP请求，处理CSV文件和解析命令行参数。
2.  **定义Colors类:** 定义颜色类用于在终端输出不同颜色的文本。
3.  **定义banner:** 定义了一个ASCII艺术的banner。

   通过快速浏览代码，没有发现明显的恶意代码或后门。但是，需要注意以下几点潜在的风险：

*   **依赖风险:** 脚本依赖于第三方库（requests, grequests, tableprint）。如果这些库被恶意修改，可能会导致代码执行漏洞。
*   **输入验证:** 脚本可能没有对输入（例如，目标IP地址或URL）进行充分的验证。如果攻击者能够控制输入，可能会导致任意代码执行或拒绝服务攻击。
*   **异常处理:** 脚本可能没有对所有可能的异常情况进行处理。这可能会导致脚本崩溃或泄露敏感信息。

   考虑到以上风险以及代码的简单性，评估认为投毒风险较低，约为5%。更全面的分析需要对代码进行更深入的审计，例如检查所有输入验证和异常处理的细节。

**项目地址:** [zzh217/CVE-2018-9995_Batch_scanning_exp](https://github.com/zzh217/CVE-2018-9995_Batch_scanning_exp)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)

---

