## CVE-2018-10933 - libssh 身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6.x 以及 0.7.6之前的0.7.x, 0.8.4之前的0.8.x版本

**利用条件:** 远程网络访问，目标服务器运行受影响版本的libssh服务端模式

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞（CVE-2018-10933）是libssh服务端状态机逻辑错误导致的身份验证绕过。攻击者通过向服务端发送 SSH2_MSG_USERAUTH_SUCCESS 消息，而不是通常预期的 SSH2_MSG_USERAUTH_REQUEST，可以诱使服务端跳过认证过程，直接进入认证后状态。本提供的POC代码是用Rust语言编写的一个简易扫描工具。经过深度代码审计，该POC并未实现真正的漏洞利用（即发送绕过包），而是通过读取SSH Banner（版本横幅）来判断目标是否可能存在漏洞。具体逻辑在于连接目标TCP端口，获取Banner字符串，并通过字符串切分与匹配逻辑（如检查是否包含 libssh-0.6、0.7、0.8 及其细分版本号）来判定风险。虽然其逻辑比较粗糙（仅基于版本号匹配），但在识别潜在受攻击面上是有效的。代码中使用了标准的 Rust `ssh2` 库和 `clap` 命令行处理库。利用步骤通常涉及：1. 建立TCP连接；2. 初始化SSH会话；3. 发送特制的身份验证成功包；4. 开启Channel进行命令执行。但本POC仅执行到第2步的Banner读取阶段，因此属于纯粹的侦察/扫描工具，不具备实际的破坏性利用能力。其解析版本号的逻辑较为脆弱，如果Banner格式非标准可能导致解析崩溃，但作为安全审计工具已具备基础参考价值。

【投毒风险分析】本项目的投毒风险极低。首先，代码结构极其简单且透明，所有的操作均集中在 main.rs 文件中，没有隐藏的外部依赖或二进制载荷。分析 Cargo.toml 文件可见，其仅依赖于公开且信誉良好的 `ssh2` 和 `clap` 库，未发现指向恶意地址的镜像源或本地路径。代码逻辑中没有出现任何网络外联行为（除了连接用户指定的扫描目标 IP），也没有使用 `eval`、`unsafe` 块或混淆处理。扫描器仅打印 Banner 并在控制台输出 'Vulnerable' 或 'Not Vulnerable'，没有涉及敏感信息收集（如私钥泄露或环境变量读取）。唯一的潜在风险点在于用户可能从不受信任的源下载此 Cargo 项目并执行 `cargo build`，但经过审查，其构建脚本和宏均不存在。代码中包含的开发者信息 'Ivan Acosta-Rubio' 及其公司域名属于正常开发者标识，未发现恶意背景。对于防御性安全研究人员而言，这是一个安全的基准扫描器，可以在受控环境下安全运行，无需担心后门或供应链投毒风险。即使如此，在处理此类安全工具时，仍建议在隔离的沙箱或虚拟机中进行编译和执行，以符合最佳安全实践。

**项目地址:** 无

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
