## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6 及更高版本 (0.7.6, 0.8.4 之前版本已修复)

**利用条件:** 目标服务器运行受影响版本的 libssh 服务，且攻击者可以建立网络连接。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对 libssh 中的严重逻辑漏洞 CVE-2018-10933。该漏洞的核心在于 libssh 服务器端状态机处理异常。在正常的 SSH 认证流程中，客户端应发送 SSH2_MSG_USERAUTH_REQUEST 以请求认证，但由于服务端代码逻辑缺陷，如果客户端直接发送本该由服务端发出的 SSH2_MSG_USERAUTH_SUCCESS 消息，服务端会误认为认证已经成功完成，从而跳过密码或密钥校验阶段，直接进入授权状态。分析提供的代码可知，其包含两个核心组件：libSSHcheck.py 用于 Banner 检测和基础连通性测试；paramikoBypass.py 利用 paramiko 库构造并发送非预期的认证成功包。代码结构逻辑清晰，直接调用了底层协议栈函数。POC还提供了一个带有‘补丁’（实际是人为注入漏洞的修改版）的 libssh 环境用于实验，这说明该 POC 经过了实际验证，对于 0.6.0 至 0.8.3 版本之间的 libssh 具有极高的利用成功率。利用步骤如下：1. 环境准备：通过提供的 README 编译或部署受影响的 libssh 服务端镜像。2. 资产探测：运行 libSSHcheck.py 验证目标端口是否开放及 Banner 信息是否匹配。3. 漏洞触发：执行 paramikoBypass.py，脚本通过底层的 transport.auth_none 方法或手动构造消息包，在握手阶段发送 SUCCESS 指令。4. 权限维持：绕过成功后，脚本通常会直接请求 shell 通道，获取目标服务器的交互式访问权限。【投毒风险分析】从安全防御研究员的角度审视，该 POC 项目的投毒风险处于低区间（约15%）。首先，代码逻辑完全透明，主要依赖标准的 Python 库（如 paramiko, socket, argparse），未发现混淆混淆或加密的 shellcode。其次，README 中明确标注了其教育用途，并提供了合法的 libssh 源码修改说明，这种透明度是良性研究项目的特征。然而，仍需注意以下潜在风险点：1. 依赖项风险：虽然 README 提到 pip 安装，但用户在下载未经审计的第三方 PoC 仓库时，必须警惕 requirements.txt 中可能包含的恶意库版本劫持。2. 本地执行风险：POC 引导用户执行 sudo cp 命令将编译好的库移动到 /usr/local/lib，这是一个高危操作。如果预编译的 .so 文件中包含恶意逻辑（尽管本项目看起来是为了模拟漏洞），可能会导致研究者的物理机或虚拟机被植入持久化后门。3. 外部引用：项目引用了外部 Exploit-DB 链接，这增加了可信度，但在下载和运行过程中，防御人员应始终在隔离沙箱环境中操作，避免直接在生产环境执行任何第三方提供的二进制文件或带有 sudo 权限的脚本。总结而言，代码本身是干净的，但其引导的库文件安装行为需要严格审计。

**项目地址:** [https://www.exploit-db.com/exploits/45638](https://www.exploit-db.com/exploits/45638)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-10933](https://nvd.nist.gov/vuln/detail/cve-2018-10933)
