## CVE-2018-10933 - libssh 身份验证绕过/RCE

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过/RCE

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6 及更高版本

**利用条件:** 需要目标服务器运行受影响的 libssh 版本，且攻击者需具有网络访问权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：此POC脚本（bpnd-libssh）通过直接利用 libssh 协议实现的逻辑缺陷来验证 CVE-2018-10933。其核心原理是，在身份验证阶段，libssh 服务端错误地接受了本应由服务端发给客户端的 MSG_USERAUTH_SUCCESS 消息。POC 代码第 34-39 行展示了其验证逻辑：脚本初始化一个 paramiko 传输对象，在未发送任何密码或密钥的情况下，直接向服务端构造并发送一个 `paramiko.common.cMSG_USERAUTH_SUCCESS` 字节码。如果服务端存在漏洞，它会由于内部状态机未能正确处理异常逻辑，误认为身份验证已成功通过。随后，脚本尝试打开一个 session 通道，如果成功建立通道，则判定目标存在漏洞。该 POC 具备极高的有效性，因为它直接触发了漏洞发生的协议层逻辑。利用步骤：1. 准备 Python3 环境并安装 paramiko 库；2. 识别目标主机的 SSH 端口（通常为 22 或自定义端口）；3. 运行脚本 `./bpnd-libssh <目标IP> -p <端口>`；4. 脚本将自动完成 Socket 连接、发送伪造的验证成功消息并检测是否能开启会话。由于漏洞允许跳过认证过程直接获取已认证的 Shell 或执行命令，其威力巨大。投毒风险分析：该代码片段基于 Python 的标准库 socket、threading 以及广为人知的第三方库 paramiko。经过代码审计，未发现明显的恶意行为。其主要的逻辑集中在 `bpndscan_cve2018_10933` 函数中，代码结构清晰，且包含了大量的日志记录和异常处理机制。虽然工具支持扫描整个网段，属于典型的渗透测试或威胁评估工具，但并未发现其将敏感数据外传至第三方服务器的行为。由于脚本依赖于外部模块 paramiko，在实际部署时应确保从官方镜像源安装，防止依赖包劫持。总体而言，该 POC 代码本身是安全的防御性研究工具，投毒风险极低，仅有的风险在于其自动化扫描功能可能被滥用于非法探测，因此在组织内部使用时应严格遵守合规性要求。

**项目地址:** [https://github.com/blueintel/bpnd-libssh](https://www.google.com/search?q=https://github.com/blueintel/bpnd-libssh)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
