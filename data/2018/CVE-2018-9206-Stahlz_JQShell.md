## CVE-2018-9206 - blueimp jQuery File Upload 任意文件上传导致的远程代码执行 (RCE)

**漏洞编号:** CVE-2018-9206

**漏洞类型:** 任意文件上传导致的远程代码执行 (RCE)

**影响应用:** blueimp jQuery File Upload

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** <= 9.22.0

**利用条件:** 无需身份验证，需目标服务器开启PHP上传处理程序且未禁用危险函数

**POC 可用性:** 9/10

**POC 类型:** 完整利用工具

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC名为JQShell，是一个针对CVE-2018-9206漏洞武器化的Python脚本。分析代码发现，其核心逻辑高度完整且具备极强的实战性。该工具通过向目标服务器的jQuery File Upload组件发送精心构造的HTTP POST请求，利用其未对上传文件扩展名进行严格过滤的缺陷，将恶意的PHP Webshell上传到服务器。代码中集成了requests库用于处理网络通信，具备多线程处理（通过列表批量扫描）、Tor匿名代理支持以及完善的命令行交互界面。POC不仅包含文件上传逻辑，还提供了自动化的结果记录功能。由于该漏洞本质上是插件示例代码（server/php/index.php）中的逻辑错误，不依赖于jQuery前端库本身，因此只要服务器部署了受影响版本的示例代码，该POC的成功率极高，属于高价值的利用代码。利用步骤：1. 准备一个标准的PHP一句话木马或Webshell文件。2. 使用Python安装依赖库requests、pysocks、stem等。3. 配置本地Tor代理（可选）以实现匿名化。4. 执行命令：python3 jqshell.py -t <目标URL> -s <本地Shell路径>。5. 脚本将自动定位上传路径，上传文件并返回Webshell地址。投毒风险分析：经过对提供的代码段（README.md及jqshell.py部分内容）进行静态分析，目前未发现明显的恶意后门或针对研究人员的攻击负载。代码逻辑清晰，主要使用了标准的requests、subprocess和argparse库。脚本中虽然涉及了Tor控制端口（9051）的操作，但这是为了实现代理切换以规避WAF或IP封禁，属于网络攻防工具的常规功能。README中提供了详细的使用说明和免责声明，且作者信息（Joshua Whitaker）公开透明。虽然该工具被标记为“武器化”，但其主要目的是为了合法的渗透测试和漏洞验证。代码中未见混淆处理，所有操作均对用户可见。潜在风险点在于如果用户从非官方仓库下载此类工具，可能会被二次打包植入恶意脚本，但就当前代码样本而言，投毒风险处于较低水平（约10%），主要风险源于工具本身的破坏性而非针对使用者的后门。

**项目地址:** [https://github.com/Tuhinshubhra/JQShell](https://www.google.com/search?q=https://github.com/Tuhinshubhra/JQShell) (或相关镜像仓库)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-9206](https://nvd.nist.gov/vuln/detail/CVE-2018-9206)
