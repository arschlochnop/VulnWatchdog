## CVE-2018-9206 - Blueimp jQuery-File-Upload RCE (任意文件上传)

**漏洞编号:** CVE-2018-9206

**漏洞类型:** RCE (任意文件上传)

**影响应用:** Blueimp jQuery-File-Upload

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 9.22.0

**利用条件:** 无需认证，远程网络访问，且服务器端Web容器（如Apache）未通过.htaccess或其他配置禁止上传目录执行脚本。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC提供了一个完整的Docker化测试环境，基于PHP 7.2和Apache容器，模拟了该漏洞在现实环境中的核心触发机制。根据Dockerfile内容，它通过修改Apache配置文件禁用.htaccess解析（AllowOverride None），这是该漏洞被利用的关键点。该漏洞的根源在于jQuery-File-Upload插件的server/php/index.php脚本默认允许上传任何类型的文件，且未对文件后缀进行严格校验。提供的poc.sh脚本通过单个curl POST请求向服务端接口提交包含PHP恶意代码的文件，随后通过GET请求直接访问上传后的文件路径以执行代码。整个利用链条非常短促且高效，验证了该漏洞在默认配置下的高危属性。经分析，该POC结构完整，包含了环境搭建（docker-compose）、自动化利用脚本（poc.sh）以及清晰的README文档，能够稳定复现并获取WebShell，属于高质量的防御性研究样本。利用步骤：1. 使用docker-compose up -d启动预置的易受攻击Web服务；2. 识别目标接口，通常为/server/php/index.php；3. 构造一个包含PHP后门的POST请求，并将文件名后缀设为.php；4. 访问上传目录（通常为/server/php/files/）下的对应文件名，即可触发代码执行。投毒风险分析：经过对脚本代码的深度审计，该POC属于低风险等级。首先，scripts/poc.sh脚本逻辑透明，仅使用了标准的curl工具进行HTTP交互，未发现任何二进制载荷注入或Base64混淆的隐藏逻辑。其生成的PHP文件内容仅为打印一个时间戳标记和随机字符，属于无害化的概念验证代码，不具备持久化后门或横向移动特征。Dockerfile从Docker Hub官方镜像拉取，未引用第三方不明镜像源。唯一需要关注的是其README中引用的外部链接，但在自动化分析视角下，该项目的Shell脚本和Docker配置中不存在回连恶意C2、修改本地Host文件或窃取环境变量的行为。项目整体符合防御性安全研究的规范，没有发现恶意投毒的特征，可安全用于内部靶场环境建设和防御策略测试。

**项目地址:** [https://github.com/cved-sources/cve-2018-9206](https://github.com/cved-sources/cve-2018-9206)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-9206](https://nvd.nist.gov/vuln/detail/CVE-2018-9206)
