## CVE-2018-15133 - Laravel Framework RCE (远程代码执行)

**漏洞编号:** CVE-2018-15133

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Laravel Framework

**危害等级:** 高危

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

**影响版本:** Laravel <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要获取受害站点的 APP_KEY (通常位于 .env 文件或配置中)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码是针对Laravel框架在APP_KEY泄露情况下的反序列化漏洞的完整实现。分析其内部逻辑发现，该脚本高度契合Laravel底层的Session处理机制。Laravel默认使用AES-128-CBC或AES-256-CBC加密Cookie中的Session数据，且在解密后会直接进行PHP反序列化。该POC有效实现了以下核心步骤：首先，它使用PHPGGC（PHP Generic Gadget Chains）生成针对Laravel/RCE5的Gadget Chain，这是一个已知且稳定的利用链；其次，它正确模拟了Laravel的加密流程，包括生成随机IV、计算带有APP_KEY参与的HMAC-SHA256摘要（MAC），并构建符合框架解析逻辑的JSON对象。最后，通过Base64编码将整个载荷封装在X-XSRF-TOKEN头或laravel_session Cookie中。根据搜索结果，该漏洞已被Androxgh0st、PBot等多个真实威胁组织和僵尸网络（如Mozi）广泛利用，证明了此类POC在真实环境下的极高转化率和破坏力。该代码逻辑清晰，依赖项明确（需要PHPGGC），是标准的渗透测试工具。 【利用步骤】1. 攻击者通过敏感文件泄露（如.env文件）或报错页面获取目标站点的APP_KEY。2. 环境准备：确保本地安装了PHPGGC工具及Python3环境。3. 执行POC：输入目标URL、APP_KEY以及想要在服务器执行的系统命令（如whoami或反弹shell）。4. 脚本调用PHPGGC生成序列化Payload。5. 脚本对Payload进行PKCS7填充、AES加密。6. 计算IV与Ciphertext的HMAC签名以通过Laravel的完整性检查。7. 将结果编码为Base64并构造HTTP请求。8. 目标服务器接收请求，解密成功后触发反序列化，从而执行攻击者预设的Gadget Chain并导致命令执行。 【投毒风险分析】该POC本身具有较低的投毒风险。代码主要使用Python标准库（如base64, hashlib, Crypto）进行逻辑实现，没有发现明显的代码混淆、远程Shellcode下载或隐蔽的系统级后门植入行为。其主要的外部交互是调用PHPGGC工具，这是安全研究界的标准工具，并非恶意载荷。然而，风险点在于：1. 脚本中可能存在针对攻击者环境的探测，虽然此README未显示，但此类脚本常被修改后分发。2. 搜索结果显示，该CVE对应的漏洞经常与恶意软件（如Androxgh0st）关联，用户在寻找此类POC时，容易误下载到被封装在恶意二进制文件中的版本。3. 脚本虽然是一个合法的安全研究工具，但其自动化程度极高，极易被脚本小子直接用于非授权攻击。从代码合规性看，该脚本属于纯粹的功能实现，未见针对研究员终端的恶意Payload。

**项目地址:** [https://github.com/kozmic/laravel-poc-CVE-2018-15133.git](https://www.google.com/search?q=https://github.com/kozmic/laravel-poc-CVE-2018-15133.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)
