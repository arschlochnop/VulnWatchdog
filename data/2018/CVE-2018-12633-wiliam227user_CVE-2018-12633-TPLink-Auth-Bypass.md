## CVE-2018-12633 - TP-Link TL-WR840N 无线路由器 认证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-12633

**漏洞类型:** 认证绕过 (Authentication Bypass)

**影响应用:** TP-Link TL-WR840N 无线路由器

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** TL-WR840N 固件版本低于 2018年6月更新版 (内核版本 4.17.2 以前受 Linux 层面影响，但此特定 POC 针对固件 HTTPd)

**利用条件:** 无需认证，可通过网络直接访问设备的 HTTP 管理端口

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC 有效性分析：该漏洞的 POC 揭示了 TP-Link TL-WR840N 路由器固件中存在的一个严重逻辑缺陷。根据 POC 代码分析，该设备的 HTTPd 服务在处理请求时，并未采用强随机化的会话令牌（Session Token）或安全的 Cookie 机制，而是错误地依赖 HTTP 请求头中的 'Referer' 字段进行身份验证。POC 展示了如何通过简单的 `curl` 命令构造恶意的 `Referer` 头部（值为 [http://192.168.0.1/mainFrame.htm](http://192.168.0.1/mainFrame.htm)），从而诱导服务器认为请求来自于受信任的已登录管理界面。实验证明，该方法能直接越权访问敏感路径如 `/userRpm/Romfile.cfg`。此 POC 的有效性极高，因为它直接触及了嵌入式设备 Web 服务的核心逻辑漏洞，且无需复杂的内存溢出或 RCE 技术，利用门槛极低，能够稳定地获取设备配置文件。利用步骤：1. 首先通过网络扫描确认目标 TP-Link 路由器的管理 IP 地址（通常为 192.168.0.1）。2. 使用构造好的 `curl` 命令，并在 Header 中添加 `Referer: http://[IP]/mainFrame.htm`。3. 请求导出配置文件路径 `/userRpm/Romfile.cfg`。4. 将下载的加密 `.bin` 文件通过 DES 算法解密（固件通常使用硬编码密钥）。5. 从解密后的明文中提取管理员密码、PPPoE 账号、Wi-Fi 密钥等敏感信息。投毒风险分析：该 POC 仓库主要以 README 文档和技术案例研究的形式存在，代码部分仅为单行 `curl` 命令示例，因此其投毒风险极低。分析显示，项目内没有复杂的二进制执行文件、混淆脚本或外部 Shellcode 下载行为。唯一需要注意的是后续提到的 'RouterPassView' 或 '自定义 Python 解密器'，如果用户从不明第三方链接下载这些解密工具，可能会面临工具层面的投毒风险，例如解密工具中可能被植入木马以反向控制研究人员的机器。但就当前 POC 文档本身而言，其代码清晰、透明，符合安全研究规范，主要风险在于该技术可能被攻击者用于自动化大规模扫描并劫持存在漏洞的旧款家用路由器。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2018-12633-TPLink-Auth-Bypass](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2018-12633-TPLink-Auth-Bypass)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-12633](https://nvd.nist.gov/vuln/detail/CVE-2018-12633)
