## CVE-2018-2628 - Oracle WebLogic Server RCE/反序列化漏洞

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE/反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 目标服务器开启T3协议端口（默认7001），且未安装相关安全补丁。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/说明

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞的核心在于Oracle WebLogic Server的WLS Core Components组件中存在反序列化缺陷。攻击者可以通过T3协议发送精心构造的序列化Java对象，利用现有类路径下的转发或包装类绕过之前的黑名单过滤，从而在受影响的服务器上执行任意代码。从提供的POC信息看，其提供了一个基本的反弹shell思路和参考链接，具有一定的指引性。该POC通常需要配合JRMPListener等工具使用，攻击者在攻击机上监听特定端口并托管恶意对象，然后通过脚本向WebLogic T3端口发送Payload，促使服务器主动请求攻击机并完成反序列化过程。由于此漏洞利用的是核心通信协议T3且无需认证，其有效性在未打补丁的环境中极高。利用步骤如下：1. 环境准备，确认目标开启7001端口且T3协议可达；2. 使用工具如ysoserial生成包含恶意命令的Payload；3. 启动JRMP服务监听；4. 执行利用脚本将指向JRMP服务的T3数据包发送至目标WebLogic地址；5. 目标反序列化成功后触发命令执行，攻击者获取反弹Shell。该过程高度自动化，利用门槛较低，是企业内网渗透中的高价值漏洞。

投毒风险分析：针对CVE-2018-2628的公开POC中，投毒风险主要集中在利用工具包的二进制程序和Python脚本的外部加载逻辑中。由于此漏洞年代较久，网络上存在大量封装好的‘一键化利用工具’，这些工具常被恶意攻击者或‘黑产’二次打包。投毒手法通常包括：1. 在Python脚本中隐藏base64编码的恶意指令，执行利用的同时在研究员机器上建立持久化后门；2. 在生成的Payload中植入针对研究员环境的攻击载荷，而非针对目标服务器；3. 提供的预编译JAR包（如伪造的ysoserial）中包含恶意类文件，当研究员运行这些工具时，会在本地触发代码执行。虽然当前提供的README内容看起来相对清爽，仅涉及文档链接，但外部链接‘pi.wrysunnylove.cn’属于个人博客，若该域名过期被抢注或内容被篡改，极易演变为钓鱼攻击。此外，反弹shell类POC天然带有敏感操作，研究员在测试时若不仔细检查IP指向和脚本逻辑，可能误将自己机器的控制权交给第三方。建议在完全隔离的沙箱环境中使用此类POC，并对所有第三方脚本进行静态审计，特别是关注涉及socket通信、系统调用以及动态加载字节码的部分，以防被‘黑吃黑’式投毒。目前评估其投毒风险处于低至中等水平（15%），主要是因为其作为指引性文档而非混淆后的二进制工具。

**项目地址:** [https://pi.wrysunnylove.cn/archives/58](https://pi.wrysunnylove.cn/archives/58)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
