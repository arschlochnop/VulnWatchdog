## CVE-2018-2628 - Oracle WebLogic Server 反序列化漏洞

**漏洞编号:** CVE-2018-2628

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 可通过T3协议访问WebLogic服务器的7001或其他控制端口，无需身份验证。

**POC 可用性:** 4/10

**POC 类型:** 仅说明

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本POC代码实际上并非针对CVE-2018-2628 T3协议反序列化漏洞的原始利用代码，而是一个简单的Webshell客户端。分析提供的cve-2018-2628.py可知，该脚本假设目标服务器已经上传了一个名为wlscmd.jsp的后门文件，利用方式是通过HTTP GET请求发送Base64编码的命令到'tom'参数。真正的CVE-2018-2628是针对T3协议的RCE，而此脚本更像是一个后续控制工具。其代码逻辑极其简单，仅包含一个无限循环的命令交互界面。从安全研究角度看，该POC本身不具备触发CVE-2018-2628漏洞的能力，它需要用户预先拥有一个已植入后门的WebLogic环境。Readme中提到的'K8 Tools'和'Nessus Scan'截图暗示了漏洞的存在，但脚本本身并未体现T3反序列化的任何特征（如JRMP客户端或特定的序列化Payload）。因此，该POC在自动化漏洞验证中的有效性较低，仅能作为特定场景下的后门连接器使用。利用步骤：1. 在受影响的WebLogic服务器上通过其他手段（如Webshell上传）部署wlscmd.jsp；2. 运行cve-2018-2628.py脚本；3. 输入目标URL（如http://ip:port/bea_wls_internal/wlscmd.jsp）；4. 在cmd交互界面输入whoami等系统命令获取执行结果。投毒风险分析：该脚本投毒风险极低，约为5%。代码逻辑完全透明，使用了Python标准库（base64, urllib, requests），没有发现任何混淆、编码隐藏的恶意代码或尝试反向连接攻击者机器的行为。代码中唯一的输出是打印作者信息和GitHub链接，不具备窃取本地敏感信息或破坏本地系统的功能。其使用的Base64编码仅用于规避简单的WAF对明文Payload的拦截。需要注意的是，由于此类脚本通常在GitHub等开源平台流传，研究人员在使用前应始终检查是否有外部请求发送到非目标IP。本样本中，cve-2018-2628.py的功能仅限于与指定的URL进行通信。push.sh脚本是一个标准的Git操作流程，无恶意。总体而言，该项目是一个低水平的工具整合，并未包含实际的漏洞利用核心，更多地被用作渗透测试中的简易Client，而非针对CVE-2018-2628的专项Exploit。

**项目地址:** [https://github.com/jas502n/CVE-2018-2628](https://github.com/jas502n/CVE-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
