## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.2.0, 12.2.1.3.0

**利用条件:** 服务器开启T3协议端口（默认7001），且未安装相应补丁或未进行类过滤限制。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2018-2628是针对Oracle WebLogic Server WLS核心组件的一个严重反序列化漏洞。该漏洞允许攻击者通过T3协议发送精心构造的序列化对象，从而在未授权的情况下绕过补丁限制，实现在远程服务器上执行任意代码。本POC脚本分析如下：该脚本采用Python 2.7编写，核心逻辑分为两部分：首先是T3协议的手动握手（t3handshake），通过发送十六进制字符序列模拟WebLogic客户端请求；其次是构造包含恶意序列化载荷的T3请求对象。POC中定义的PAYLOAD包含了一个针对java.rmi.activation.Activator接口的RMI绕过序列化流，这种利用方式可以有效绕过WebLogic早期针对直接反序列化的防御措施。代码结构清晰，通过socket底层通信实现，具有较高的实战验证价值。在利用步骤上，攻击者首先探测目标主机的7001端口（或其他WebLogic监听端口），随后通过该脚本建立T3连接并推送payload，Payload中通常包含一个JRMP监听地址，引导目标服务器连接到攻击者控制的机器，从而完成二次反序列化攻击。经过分析，该POC代码属于标准的安全研究验证脚本，使用的库均为socket、time等标准库。虽然在PAYLOAD中包含了一个硬编码的IP地址（104.251.228.50），这通常是原作者测试环境遗留或用于演示的JRMP服务端，但在防御性研究中，将其视为投毒行为的证据不足。该脚本未见明显的代码混淆、自我复制、文件擦除或隐蔽的外连C2行为。主要的风险点在于，如果安全从业者直接运行而不修改其中的恶意IP地址，可能会导致流量泄露至第三方服务器。综合评估，该代码的安全风险主要源于漏洞本身的破坏力，而非脚本作者注入的恶意后门。在建立防御措施时，建议组织禁用不必要的T3协议，或通过设置Connection Filter限制访问来源，并及时安装Oracle官方发布的CPU补丁。

**项目地址:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
