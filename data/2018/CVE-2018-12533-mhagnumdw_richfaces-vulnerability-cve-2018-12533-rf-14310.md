# CVE-2018-12533

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-12533-Pastea_CVE-2018-12533.md](../2018/CVE-2018-12533-Pastea_CVE-2018-12533.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #2

**来源**: [CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md](../2018/CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md)

## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #3

**来源**: [CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md](../2018/CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md)

# CVE-2018-12533

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-12533-Pastea_CVE-2018-12533.md](../2018/CVE-2018-12533-Pastea_CVE-2018-12533.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #2

**来源**: [CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md](../2018/CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md)

## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #3

**来源**: [CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md](../2018/CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md)

# CVE-2018-12533

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-12533-Pastea_CVE-2018-12533.md](../2018/CVE-2018-12533-Pastea_CVE-2018-12533.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #2

**来源**: [CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md](../2018/CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md)

## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #3

**来源**: [CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md](../2018/CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md)

# CVE-2018-12533

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-12533-Pastea_CVE-2018-12533.md](../2018/CVE-2018-12533-Pastea_CVE-2018-12533.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #2

**来源**: [CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md](../2018/CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md)

## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #3

**来源**: [CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md](../2018/CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md)

# CVE-2018-12533

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-12533-Pastea_CVE-2018-12533.md](../2018/CVE-2018-12533-Pastea_CVE-2018-12533.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #2

**来源**: [CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md](../2018/CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md)

## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #3

**来源**: [CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md](../2018/CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md)

# CVE-2018-12533

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-12533-Pastea_CVE-2018-12533.md](../2018/CVE-2018-12533-Pastea_CVE-2018-12533.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，且攻击者能够通过网络访问存在漏洞的资源路径。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 漏洞存在于 JBoss RichFaces 3.1.0 到 3.3.4 版本中。未经身份验证的远程攻击者可以通过在包含 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的路径中使用 `/DATA/` 子字符串来注入 EL 表达式，从而执行任意 Java 代码 (aka RF-14310)。

**有效性：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以判定该漏洞是有效的。POC 代码展示了如何构造 EL 表达式并将其注入到 RichFaces 组件中，从而执行任意代码。

**投毒风险：**

分析提供的 POC 代码，未发现明显的恶意投毒代码。POC 的主要目的是演示如何利用 EL 表达式注入漏洞，通过修改 `TestHeader` 或执行系统命令来验证漏洞的存在。所以投毒风险为0%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于处理 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象的特定资源路径中，该路径包含 `/DATA/` 子字符串。
2.  **EL 表达式注入：** 攻击者构造包含恶意 EL 表达式的 URL 或请求参数。EL 表达式可以用于执行任意 Java 代码。
3.  **代码执行：** RichFaces 组件在处理包含恶意 EL 表达式的请求时，会解析并执行其中的 EL 表达式，从而导致任意代码执行。

**POC 代码分析：**

POC 代码构造了一个利用 `Paint2DResource$ImageData` 类的 EL 表达式注入 Payload。它首先创建了一个 `MethodExpressionImpl` 对象，其中包含要执行的 EL 表达式。然后，它使用反射来创建 `ImageData` 对象，并将恶意 EL 表达式注入到该对象中。最后，通过模拟对包含 `/DATA/` 的 URL 的访问触发该漏洞，从而执行 EL 表达式。Payload 可以修改响应头或执行任意系统命令。


**项目地址:** [Pastea/CVE-2018-12533](https://github.com/Pastea/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #2

**来源**: [CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md](../2018/CVE-2018-12533-llamaonsecurity_CVE-2018-12533.md)

## CVE-2018-12533-RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可远程代码执行

**影响版本:** 3.1.0 <= version <= 3.3.4

**利用条件:** 目标系统运行存在漏洞版本的JBoss RichFaces，且攻击者能够访问/DATA/路径。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-12533是JBoss RichFaces 3.1.0到3.3.4版本中存在的一个EL表达式注入漏洞。未经身份验证的远程攻击者可以通过在包含org.richfaces.renderkit.html.Paint2DResource$ImageData对象的路径中使用/DATA/子字符串来注入EL表达式并执行任意Java代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判定此漏洞是有效的。漏洞库信息明确指出了漏洞的存在以及受影响的版本范围。搜索引擎结果中也包含大量关于此漏洞的描述和分析文章，进一步证实了漏洞的存在。提供的漏洞利用代码包含Dockerfile和利用脚本，可以用于搭建包含漏洞的环境和生成POC URL，表明了漏洞的可利用性。

**投毒风险分析：**

漏洞利用代码仓库中存在一定投毒风险，约为10%。

*   **Dockerfile：**Dockerfile用于搭建一个存在漏洞的环境，本身不包含恶意代码。但是，它下载了JBoss和RichFaces的压缩包，如果这些压缩包被替换为恶意版本，可能导致投毒。风险较低，因为下载源是官方的。存在压缩包被中间人攻击替换的可能，但相对较低
*   **README.md：**README.md 只是提供漏洞利用说明文档，不包含可执行代码
*   **pom.xml：**pom.xml文件定义了项目依赖，如果依赖被替换为恶意版本，可能导致投毒。pom.xml中引用了多个maven仓库，存在被劫持的风险。
*   **利用代码：**利用代码用于生成包含EL表达式的URL，本身不包含恶意代码，但如果攻击者修改EL表达式，可能导致恶意代码执行。
综合来看，风险主要来自于pom.xml文件和Dockerfile下载的文件。尽管概率较低，但存在一定的投毒风险。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile搭建包含漏洞版本的JBoss RichFaces环境。
2.  **POC URL生成：** 使用提供的Java代码生成包含EL表达式的POC URL。
3.  **漏洞触发：**  将生成的POC URL发送到目标服务器。
4.  **代码执行：**  目标服务器解析URL中的EL表达式，执行攻击者指定的任意Java代码。

**项目地址:** [llamaonsecurity/CVE-2018-12533](https://github.com/llamaonsecurity/CVE-2018-12533)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---

## POC #3

**来源**: [CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md](../2018/CVE-2018-12533-mhagnumdw_richfaces-vulnerability-cve-2018-12533-rf-14310.md)

## CVE-2018-12533-JBoss RichFaces-EL表达式注入

**漏洞编号:** CVE-2018-12533

**漏洞类型:** EL表达式注入

**影响应用:** JBoss RichFaces

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.1.0 - 3.3.4

**利用条件:** 目标系统运行受影响版本的JBoss RichFaces，并且允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-12533 允许未授权的远程攻击者通过包含 `/DATA/` 子字符串的路径，以及 `org.richfaces.renderkit.html.Paint2DResource$ImageData` 对象，注入表达式语言（EL）表达式并执行任意 Java 代码。 

**有效性分析：**

提供的 POC 代码 `Generator_Paint2DResourceImageData.java` 旨在利用此漏洞。它通过构建恶意的 `ImageData` 对象，该对象包含一个 EL 表达式，该表达式使用 `ScriptEngineManager` 执行任意命令。该代码将序列化的 `ImageData` 对象进行压缩和 Base64 编码，并将其格式化为 RichFaces URL 所需的格式。通过构造特定的URL请求，将payload发送给目标服务器。目标服务器如果存在该漏洞，就会执行EL表达式，从而执行攻击者指定的命令。

**投毒风险分析：**

代码本身并没有明显的投毒行为。它的主要目的是生成利用 CVE-2018-12533 的 Payload。该脚本允许攻击者自定义要执行的命令。此仓库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式：**

1.  **构建恶意请求：** 攻击者构造一个包含特定路径（`/a4j/s/.../DATA/...seam`）的 HTTP 请求，其中包含 Base64 编码的恶意 `ImageData` 对象。此对象包含一个 EL 表达式，用于执行任意命令。
2.  **EL 表达式注入：** RichFaces 在处理此请求时，会解析 URL 中的 Base64 编码数据，并反序列化 `ImageData` 对象。由于缺少适当的输入验证，攻击者可以注入 EL 表达式。
3.  **远程代码执行：** 注入的 EL 表达式会被执行，导致服务器执行攻击者指定的任意 Java 代码，从而实现远程代码执行。

**项目地址:** [mhagnumdw/richfaces-vulnerability-cve-2018-12533-rf-14310](https://github.com/mhagnumdw/richfaces-vulnerability-cve-2018-12533-rf-14310)

**漏洞详情:** [CVE-2018-12533](https://nvd.nist.gov/vuln/detail/CVE-2018-12533)

---



---



---



---



---



---

