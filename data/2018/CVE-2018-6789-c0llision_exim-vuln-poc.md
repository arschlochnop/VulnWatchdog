# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

# CVE-2018-6789

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-6789-beraphin_CVE-2018-6789.md](../2018/CVE-2018-6789-beraphin_CVE-2018-6789.md)

## CVE-2018-6789 - Exim base64d 缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标系统运行Exim邮件服务器，且版本低于4.90.1，对外开放SMTP端口（通常是25端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6789是Exim邮件服务器base64d函数中的一个缓冲区溢出漏洞。攻击者可以通过发送特制的SMTP消息，利用base64解码过程中的漏洞触发缓冲区溢出，从而实现远程代码执行。

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC代码。多个安全厂商和研究人员都对其进行了分析和验证，例如Rapid7、Tenable等。漏洞利用代码存在于Exploit-DB(44571, 45671)中，证明该漏洞可被利用。

**投毒风险:**
提供的“漏洞利用代码”实际上只是一份GNU通用公共许可证的文本。并不能直接用于漏洞验证。因此，无法直接分析其中是否包含投毒代码。但是从整体仓库文件来看，存在投毒的可能性较低，大约为5%，因为仅仅包含协议。

**利用方式:**
1.  **漏洞点：** 漏洞存在于Exim的SMTP监听器中的`base64d`函数中。
2.  **触发条件：** 发送精心构造的包含过长base64编码数据的SMTP消息。
3.  **溢出原理：** `base64d`函数在解码过程中，由于存在Off-by-one错误，导致缓冲区溢出。
4.  **利用方式：** 攻击者可以利用此溢出覆盖堆上的内存，进而控制程序执行流程，实现远程代码执行。
5.  **利用步骤：**
    *   向目标Exim服务器发送包含恶意base64编码数据的SMTP消息。
    *   消息会被`base64d`函数处理，触发缓冲区溢出。
    *   溢出覆盖关键内存区域，例如函数返回地址。
    *   将返回地址修改为攻击者控制的地址，指向shellcode。
    *   shellcode执行，获取服务器控制权。

总的来说，CVE-2018-6789是一个严重的安全漏洞，利用难度相对较低，攻击者可以利用公开的PoC代码轻松实现远程代码执行。建议受影响的用户尽快升级到Exim 4.90.1或更高版本。

**项目地址:** [beraphin/CVE-2018-6789](https://github.com/beraphin/CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #2

**来源**: [CVE-2018-6789-c0llision_exim-vuln-poc.md](../2018/CVE-2018-6789-c0llision_exim-vuln-poc.md)

## CVE-2018-6789-Exim-base64d缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要能够通过SMTP协议与Exim服务建立连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 4.90.1 之前版本中 `base64d` 函数中存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息来触发此漏洞，从而可能导致远程代码执行。

**利用方式：**

1.  利用漏洞需要与 Exim 服务器建立 SMTP 连接。
2.  发送 `EHLO` 命令进行握手。
3.  发送 `MAIL FROM` 和 `RCPT TO` 命令指定发件人和收件人。
4.  发送精心构造的字符串到服务器，触发 `base64d` 函数中的缓冲区溢出。`poc.py` 和 `poc2.py` 脚本都尝试通过发送长字符串（包含大量 'a' 字符）来利用该漏洞。`poc.py` 和 `poc2.py` 首先发送一个较长的'a'字符串，后面跟一个\x7f字符。然后，它们发送`BDAT 1` 命令，接着是另一个字符串，其中包含用 `0xdeadbeef` 填充的区域。 最后，发送 \r\n 和换行符来完成利用。

**有效性：**

根据漏洞信息和利用代码来看，提供的 POC 代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都指向该漏洞的存在以及远程代码执行的可能性。Exploit-DB 上存在公开的 Exploit，进一步佐证了漏洞的可利用性。

**投毒风险：**

分析提供的 `poc.py` 和 `poc2.py` 代码，没有发现明显的恶意代码或后门。代码的主要目的是利用缓冲区溢出漏洞，通过发送特制的输入来覆盖内存，最终实现远程代码执行。虽然利用本身具有恶意性，但脚本本身没有额外的投毒行为。 `README.md` 文件只包含CVE编号, 无任何恶意行为。

因此，投毒风险评估为 0%。

**项目地址:** [c0llision/exim-vuln-poc](https://github.com/c0llision/exim-vuln-poc)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---



---

## POC #3

**来源**: [CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md](../2018/CVE-2018-6789-martinclauss_exim-rce-cve-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要向易受攻击的Exim服务器发送特制的SMTP消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6789 存在于Exim 4.90.1 之前的版本中，是 `base64d` 函数中的缓冲区溢出漏洞。通过发送特制的包含恶意 Base64 编码数据的 SMTP 消息，可以触发该漏洞，导致缓冲区溢出，并最终实现远程代码执行。

**有效性：**
提供的 Dockerfile 和相关文件构成了一个用于漏洞分析和利用的学习环境。它包含构建易受攻击 Exim 版本的必要组件，并集成了 pwndbg 等调试工具。 该 README.md 文件解释了如何设置环境，包括使用 Vagrant 和 Docker。因此，提供的资料**是有效的**，可以用来复现和研究 CVE-2018-6789 漏洞。

**投毒风险：**
虽然整个环境的目的是为了学习和调试漏洞，但仍需注意潜在的投毒风险。风险分析如下：
*   **Dockerfile:** Dockerfile 包含了安装 Exim 和调试工具的指令。恶意修改 Dockerfile 可能导致安装包含后门的 Exim 版本或篡改调试工具，但Dockerfile中的git checkout命令指定了pwndbg的版本, 降低了风险。
*   **Exim 源代码:**  如果提供的 Exim 源代码（通过 git submodule 获取）被篡改，可能引入后门。但是，直接修改子模块的可能性较低，因为用户通常会从官方仓库克隆。
*   **调试脚本:** `debugging/gdbinit` 和 `debugging/showmem.py` 用于 GDB 调试。 恶意修改这些脚本可能导致在调试过程中执行恶意代码。
*   **构建脚本:** `scripts/attach_exim.sh` 和 `scripts/run_exim.sh` 用于启动和附加 Exim 进程。修改这些脚本可能影响 Exim 的运行方式，但也可能被用来植入恶意代码。

综合来看，投毒风险较低，约为 10%。主要风险在于用户下载的 Exim 源代码或调试脚本可能被篡改。用户应验证 Exim 源代码的完整性，并仔细检查调试脚本的内容。

**利用方式：**
1.  **漏洞触发：** 攻击者向易受攻击的 Exim 服务器发送包含恶意 Base64 编码数据的 SMTP 消息。
2.  **缓冲区溢出：** `base64d` 函数在处理恶意数据时，由于未进行充分的边界检查，导致缓冲区溢出。
3.  **控制流劫持：** 通过覆盖缓冲区中的返回地址或其他关键数据，攻击者可以劫持程序的控制流。
4.  **远程代码执行：** 攻击者可以将控制流重定向到 shellcode 或其他恶意代码，从而在服务器上执行任意命令。

**项目地址:** [martinclauss/exim-rce-cve-2018-6789](https://github.com/martinclauss/exim-rce-cve-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #4

**来源**: [CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md](../2018/CVE-2018-6789-synacktiv_Exim-CVE-2018-6789.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Exim 4.90.1之前

**利用条件:** 需要目标Exim服务器开启SMTP监听，且版本低于4.90.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Exim的base64d函数中。攻击者可以通过发送特制的base64编码消息，导致缓冲区溢出，从而实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且有公开的PoC。提供的PoC代码包含 connect_target(), write_line(), read_line(), off_by_one()函数，用于连接目标，发送特制的base64编码消息，触发漏洞。
从Makefile和README.md文件可以看出这是一个PoC资料，用于验证CVE-2018-6789。

**投毒风险：**
通过对PoC代码进行分析，没有发现明显的投毒代码。
代码中定义了一个shellcode，该shellcode通过`${run{...}}`语法执行反向连接，但这是漏洞利用的一部分，而非恶意投毒。代码逻辑较为清晰，主要是构造溢出和执行payload，未发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**
1.  **连接目标Exim服务器：** PoC代码首先通过`connect_target()`函数连接到目标Exim服务器的SMTP端口。
2.  **发送SMTP命令：**  利用`write_line()`和`read_line()`函数与服务器进行SMTP协议交互。
3.  **触发缓冲区溢出：**  关键在于`off_by_one()`函数。该函数构造一个特定的base64编码字符串，利用Exim的base64解码函数中的一个字节溢出漏洞。通过精心计算的偏移量和目标字节，覆盖内存中的重要数据，例如`acl_pointer`。
4.  **远程代码执行：**  通过覆盖`acl_pointer`，攻击者可以控制Exim的访问控制列表处理流程，执行预定义的shellcode。这个shellcode通常用于反向连接到攻击者的服务器，从而获得一个shell。

**总结：**
该漏洞利用的有效性较高，因为有公开的PoC，并且EXP也是较为成熟的，可以直接进行复现。 投毒风险较低，因为PoC代码相对简单，易于审查。漏洞利用方式涉及精心构造的base64编码消息，需要对Exim的内存管理和访问控制机制有一定的了解。

**项目地址:** [synacktiv/Exim-CVE-2018-6789](https://github.com/synacktiv/Exim-CVE-2018-6789)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

## POC #5

**来源**: [CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md](../2018/CVE-2018-6789-thistehneisen_CVE-2018-6789-Python3.md)

## CVE-2018-6789 Exim base64d 缓冲区溢出远程代码执行漏洞

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 目标Exim服务开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 邮件服务器中 base64d 函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息利用此漏洞实现远程代码执行。根据漏洞描述和提供的利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** `base64d` 函数在解码 base64 编码的数据时，没有正确检查输入长度，导致缓冲区溢出。
2.  **利用方式：** 攻击者通过构造特殊的 base64 编码字符串，发送给 Exim 服务器。这个字符串会触发 `base64d` 函数的缓冲区溢出，覆盖内存中的数据，包括函数返回地址等关键信息。
3.  **POC 代码分析：** 提供的 Python 脚本 `exim.py` 实现了利用该漏洞的 POC。脚本通过以下步骤利用漏洞：
    *   **连接目标：** 连接到目标 Exim 服务器的 SMTP 端口（默认为 25）。
    *   **堆喷：** 通过发送 `EHLO` 命令，在堆上创建特定大小的空闲块。
    *   **单字节覆盖：** 通过精心构造的 base64 编码数据，实现单字节覆盖，扩展目标 chunk 的大小。
    *   **伪造 Chunk Header：** 覆盖堆上的 chunk header，以便能够释放扩展后的 chunk。
    *   **释放扩展 Chunk：** 释放扩展后的 chunk，造成堆的空洞。
    *   **再次填充堆：** 再次在堆上分配内存，并覆盖 chunk header，以便分配到 ACL store block。
    *   **覆盖 ACL Store Block 地址：** 覆盖 'next' 指针为ACL store block 地址
    *   **覆盖 `acl_smtp_rcpt`：** 覆盖 `acl_smtp_rcpt` 变量的值，该变量在处理 `RCPT TO` 命令时会被调用。脚本将该变量覆盖为 shell 命令，例如反弹 shell 命令。
    *   **触发漏洞：** 发送 `RCPT TO` 命令，触发 `acl_smtp_rcpt` 变量的执行，从而执行攻击者注入的 shell 命令，实现远程代码执行。

4.  **有效性：** 根据漏洞描述、搜索结果以及提供的 POC 代码，可以判定该漏洞是有效的，并且存在公开的利用代码。
5.  **投毒风险：** 检查了提供的利用代码，没有发现明显的恶意代码或者后门。虽然代码本身是为了利用漏洞，但没有发现额外的、与漏洞利用无关的恶意行为。因此，投毒风险评估为0%。该脚本的目的是验证和利用漏洞，而不是植入后门或执行其他恶意操作。

**项目地址:** [thistehneisen/CVE-2018-6789-Python3](https://github.com/thistehneisen/CVE-2018-6789-Python3)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)

---

