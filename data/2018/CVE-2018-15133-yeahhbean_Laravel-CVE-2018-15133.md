## CVE-2018-15133 - Laravel Framework 反序列化漏洞/RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞/RCE

**影响应用:** Laravel Framework

**危害等级:** 高危

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29, 5.7.x <= 5.7.27

**利用条件:** 需要获取受害服务器的 APP_KEY (配置于 .env 文件中)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Laravel框架在处理带有 X-XSRF-TOKEN 请求头时，未能正确验证解密数据的完整性，导致不信任数据被传入 unserialize() 函数。所提供的POC代码（包含Dockerfile、docker-compose.yaml和exploit.py）构成了一个完整的端到端验证环境。Dockerfile基于PHP 7.2.10-fpm，通过Composer安装了存在漏洞的具体版本 Laravel 5.7.x。其exploit.py脚本利用已知的APP_KEY对恶意构造的PHP对象进行加密和签名，生成特制的Cookie或Header发送至目标。经过实验室环境验证，该POC能够稳定触发命令执行。其核心逻辑在于利用PHP的解密机制，当解密后的明文进入unserialize时，如果框架中存在可利用的POP链（如Illuminate\Broadcasting\PendingBroadcast），即可执行任意系统命令。该POC文档齐全，包含了从环境搭建到攻击触发的详尽步骤，具有极高的实战参考价值和防御研究价值。利用步骤：1. 使用 docker-compose build 快速构建集成PHP、Nginx和受灾版Laravel的环境；2. 启动容器并获取项目生成的 APP_KEY；3. 配置 exploit.py 中的目标URL和APP_KEY；4. 运行脚本，通过HTTP POST请求发送携带恶意Payload的 X-XSRF-TOKEN；5. 在响应中确认命令执行结果。投毒风险分析：对提供的POC代码进行深度静态扫描和逻辑审查。Dockerfile部分使用了标准的Debian Stretch镜像源并切换至archive地址，属于常规的旧版本环境适配行为，未发现恶意二进制下载或隐藏的后门指令。exploit.py脚本逻辑透明，主要使用了Python的标准库（如requests, base64, hmac, hashlib）进行加密运算，未发现代码混淆、远程反弹Shell投毒或针对宿主机的敏感文件窃取行为。尽管该漏洞在历史中曾被 Androxgh0st、Mozi 和 PBot 等恶意僵尸网络利用，但当前的POC项目旨在教育和防御性研究，其代码结构符合开源安全研究规范。唯一的潜在风险在于第三方库的引用（如PHPGGC工具），但在隔离的Docker环境中使用可以有效规避对物理主机的危害。总体而言，该代码库投毒风险较低，主要风险在于其易用性可能降低攻击者的技术门槛。

**项目地址:** [https://github.com/yeahhbean/Laravel-CVE-2018-15133](https://github.com/yeahhbean/Laravel-CVE-2018-15133)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)
