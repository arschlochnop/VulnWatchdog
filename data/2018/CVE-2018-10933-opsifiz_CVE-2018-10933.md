## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6 及更高版本 (0.6.x, 0.7.x, 0.8.x)

**利用条件:** 目标服务器必须启用 libssh 服务端模式，且客户端能够建立 TCP 网络连接。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC代码针对CVE-2018-10933漏洞实现了逻辑严密的身份验证绕过流程。其核心原理利用了libssh服务器状态机实现中的逻辑缺陷：当服务器处于等待身份验证请求（SSH2_MSG_USERAUTH_REQUEST）的状态时，如果接收到客户端主动发出的身份验证成功消息（SSH2_MSG_USERAUTH_SUCCESS），服务器会错误地直接将连接状态更改为已认证，而跳过实际的凭据校验过程。代码通过Paramiko库构建了一个不符合标准协议逻辑的特定消息流，即在start_client后不发送认证请求，直接注入MSG_USERAUTH_SUCCESS字节。分析其有效性可知，该POC使用了标准socket和线程库来实现交互式Shell，逻辑清晰，在受影响的libssh版本（如0.8.3及以下）中具有极高的利用成功率，能够直接获取系统访问权限。利用步骤如下：1. 攻击者确定目标主机IP和运行libssh服务的端口（通常为22）。2. 建立基础TCP连接。3. 使用Paramiko的Transport对象初始化连接但不进行实际认证。4. 调用私有方法发送硬编码的成功状态消息。5. 发起打开会话通道、分配伪终端（PTY）及启动Shell的请求。6. 成功绕过验证后进入交互式操作阶段。投毒风险分析：该脚本代码透明度极高，主要依赖Python标准库（socket, threading, sys）和知名的第三方SSH库Paramiko，未发现任何混淆、编码或动态执行（如exec/eval）的可疑代码段。经过深入审查，脚本中不包含任何向第三方服务器发送敏感数据（如目标凭据、本地环境变量）的行为。所有的网络交互均严格限制在用户输入的目标主机之间。代码逻辑中虽然包含一个‘假认证成功’的消息发送，但这属于该特定CVE漏洞利用的技术必要手段，而非针对攻击者本人的后门。脚本未尝试在执行过程中修改系统Hosts文件、下载远程恶意载荷或在本地磁盘隐蔽处创建持久化文件。因此，从防御性安全研究的角度评估，该POC的投毒风险极低，属于安全的防御性研究工具，可用于受控环境下的漏洞验证和安全审计工作。

**项目地址:** [https://www.libssh.org/security/advisories/CVE-2018-10933.txt](https://www.libssh.org/security/advisories/CVE-2018-10933.txt)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-10933](https://nvd.nist.gov/vuln/detail/cve-2018-10933)
