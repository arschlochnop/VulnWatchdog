## CVE-2018-2628 - Oracle WebLogic Server RCE (远程代码执行)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 目标需开启T3协议端口（默认7001），且未安装相应补丁或未限制T3访问控制。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于Oracle WebLogic Server的WLS核心组件中，利用了T3协议在处理反序列化时的缺陷。提供的POC包包含检测工具、利用脚本及修改版的ysoserial。ysoserial-0.1-cve-2018-2628-all.jar是该POC的核心，通过封装JRMPClient，配合T3协议的握手过程，可以绕过之前的补丁。经过防御性分析，该POC通过脚本weblogic_poc.py向目标端口发送精心构造的T3数据包，强制服务器连接攻击者控制的JRMP监听端，从而触发反序列化导致代码执行。利用步骤：1. 启动JRMPListener监听端并指定payload，例如使用ysoserial启动。2. 使用weblogic_poc.py脚本，设置target参数为目标服务器IP和端口，设置jrmp_server参数为攻击者监听端IP。3. 脚本执行后，WebLogic将主动回连监听端并下载恶意对象，完成RCE。该漏洞利用无需认证，且针对默认配置的WebLogic极具威胁。投毒风险分析：该工具包中包含预编译的二进制文件（.jar），这是安全研究中的主要风险点。通过对ysoserial-0.1-cve-2018-2628-all.jar进行静态扫描，目前未发现明显的反连Shell或破坏本地文件的后门特征，但其引用了外部Github链接（tdy218项目），这类非官方维护的分支可能存在供应链投毒风险。脚本weblogic_poc.py为明文Python代码，逻辑透明，主要功能为Socket通信发送Hex数据流，风险极低。综合评估，该POC的投毒风险主要集中在JAR包的黑盒属性上，建议在隔离环境或沙箱中反编译后再使用。由于该漏洞年代较久，目前的POC大多已在社区公开，被二次植入后门的概率属于中低水平，但仍需警惕那些要求以root权限运行或从不明S3存储桶下载组件的变体脚本。

**项目地址:** [https://github.com/tdy218/ysoserial-cve-2018-2628](https://github.com/tdy218/ysoserial-cve-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
