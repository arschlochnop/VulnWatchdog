# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

# CVE-2018-14847

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-14847-BasuCert_WinboxPoC.md](../2018/CVE-2018-14847-BasuCert_WinboxPoC.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致任意文件读取和写入

**影响版本:** <= 6.42

**利用条件:** 需要网络访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 是 MikroTik RouterOS 中 WinBox 接口的一个目录遍历漏洞。通过构造特殊的请求，未经身份验证的远程攻击者可以读取任意文件，而已通过身份验证的攻击者可以写入任意文件。

**有效性分析：**

*   漏洞库信息明确指出该漏洞的存在，并提供了多个相关的资源链接，包括漏洞利用代码的链接。
*   搜索引擎结果也确认了该漏洞的存在，并提到了相关的利用方法和风险。
*   提供的漏洞利用代码（MACServerDiscover.py 和 MACServerExploit.py）实现了利用该漏洞读取`user.dat`文件。

综合来看，提供的 POC 代码是有效的。`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，`MACServerExploit.py` 利用 Winbox 的漏洞读取`/flash/rw/store/user.dat`，该文件包含了用户凭据。

**投毒风险分析：**

查看代码，`LICENSE`文件遵循MIT开源协议，代码本身没有明显的恶意行为，主要实现了漏洞利用。虽然不能完全排除作者隐藏的细微后门，但从代码的结构和功能来看，投毒的可能性较低。该漏洞的公开性和大量的分析报告也降低了投毒的可能性。因此，评估投毒风险为 0%。

**利用方式分析：**

1.  **设备发现:** `MACServerDiscover.py` 脚本通过广播 UDP 数据包发现局域网内的 Mikrotik 设备。
2.  **漏洞利用:**  `MACServerExploit.py` 脚本通过构造恶意请求，利用 Winbox 接口的目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **凭据提取:**  `extract_user.py`(虽然未提供，但从导入语句中得知存在)脚本用于解析 `user.dat` 文件，提取用户名和密码。

攻击者可以通过这些步骤获得 Mikrotik 路由器的管理员权限。

**项目地址:** [BasuCert/WinboxPoC](https://github.com/BasuCert/WinboxPoC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #2

**来源**: [CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md](../2018/CVE-2018-14847-K3ysTr0K3R_CVE-2018-14847-EXPLOIT.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务（默认端口8291），且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未经验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。漏洞原因是 WinBox 处理文件请求时存在目录遍历漏洞。

**漏洞利用方式：**

1.  攻击者发送特制的 WinBox 协议数据包，其中包含目录遍历的路径，例如 `../../../../flash/rw/store/user.dat`，以尝试读取敏感文件。
2.  提供的PoC代码通过构造特定的 WinBox 协议数据包，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件，该文件包含加密的用户凭据。
3.  PoC代码解密提取的凭据，并打印到控制台。

**有效性：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的PoC是有效的。搜索结果中多个链接都提到了该漏洞的存在和利用方法，并且漏洞利用代码已经实现了读取和解密用户凭据的功能。

**投毒风险：**

通过分析提供的PoC代码，大部分代码逻辑是用于构造 WinBox 协议数据包，发送到目标设备，并处理响应。主要功能集中在读取用户凭据并解密。投毒代码风险主要体现在以下几个方面：

1.  **异常处理：** PoC代码中存在 `try...except` 块，但 `except Exception` 可能捕获所有异常，包括恶意代码引起的异常，从而掩盖了恶意行为。 虽然这是为了增强程序的健壮性，但也可能被利用来隐藏恶意代码的执行。
2.  **依赖项：** PoC代码依赖 `rich` 和 `alive_progress` 库。虽然这些库本身是安全的，但如果攻击者控制了这些库的安装源，则有可能引入恶意代码。
3.  **网络连接：** PoC代码创建网络连接以发送恶意请求。如果攻击者修改了代码，可能会利用该连接下载和执行其他恶意代码。
4.  **文件操作:** 代码只读文件。

综上所述，此PoC代码存在投毒风险，但风险较低，代码中没有明显的恶意行为。绝大部分代码是为了实现漏洞利用，风险点在于异常处理和潜在的依赖库污染。风险评估为 5%。

**项目地址:** [K3ysTr0K3R/CVE-2018-14847-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-14847-EXPLOIT)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #3

**来源**: [CVE-2018-14847-Tr33-He11_winboxPOC.md](../2018/CVE-2018-14847-Tr33-He11_winboxPOC.md)

## CVE-2018-14847-MikroTik RouterOS WinBox目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，允许未授权远程读取任意文件，授权远程写入任意文件

**影响版本:** <= 6.42

**利用条件:** WinBox端口开放（通常是8291）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-14847 存在于 MikroTik RouterOS 6.42 及更早版本中。它允许未经过身份验证的远程攻击者读取任意文件，并且允许经过身份验证的远程攻击者写入任意文件。该漏洞存在于 WinBox 接口中，利用了目录遍历漏洞。根据搜索引擎结果和漏洞库信息，该漏洞已经被广泛研究，存在多个公开的 PoC 和利用代码。提供的漏洞利用代码只是一个 GNU GPL 许可证文本，本身**不包含**任何漏洞利用相关的代码，因此不能用来直接评估漏洞利用的有效性。但是，考虑到漏洞信息和众多的PoC代码仓库参考（如GitHub上的BigNerd95/WinboxExploit等），可以确定该漏洞是**有效**的。 

**漏洞利用方式：**攻击者可以通过构造包含目录遍历字符（如`../`）的恶意请求发送到 WinBox 接口，从而读取或写入目标文件。未授权的攻击者可以读取敏感配置文件，例如包含用户凭据的文件，而授权用户则可以写入任意文件，包括替换系统文件，从而实现远程代码执行。

**投毒风险：**提供的代码段只是 GPL 许可协议，不包含任何可执行的代码，因此可以认为**不存在投毒风险**。

**项目地址:** [Tr33-He11/winboxPOC](https://github.com/Tr33-He11/winboxPOC)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #4

**来源**: [CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md](../2018/CVE-2018-14847-babyshen_routeros-CVE-2018-14847-bytheway.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox端口 (通常是8291)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，而经过身份验证的攻击者可以写入任意文件。

**有效性分析：**

提供的PoC代码（`By the Way`）通过利用该漏洞读取管理员密码，然后创建一个“option”包，从而启用开发后门。攻击成功后，攻击者可以使用root用户"devel"和管理员密码通过Telnet或SSH连接。

搜索引擎结果显示，该漏洞已经被广泛披露，并且存在多个PoC。

**投毒风险分析：**

PoC代码中的主要功能是利用目录遍历漏洞提取密码并写入文件以开启后门。 潜在的投毒风险在于：

1.  **依赖Boost库：** 虽然Boost是一个常用的C++库，但如果目标系统缺少该库，编译可能会失败。这可以被视为一种轻微的阻碍，但并非恶意的投毒。
2.  **后门账户：** PoC创建了一个名为"devel"的后门账户。虽然这是PoC的核心功能，但如果攻击者将其伪装成其他用途，可能会误导用户。
3.  **潜在的拒绝服务：** 不当的文件写入操作可能导致设备不稳定或崩溃，但从代码上看，这种情况不太可能发生。

总体来说，该PoC代码的投毒风险较低，主要风险在于滥用后门账户。更准确的说，这不是投毒，而是漏洞利用本身的目的。

**利用方式：**

1.  **目录遍历：** 利用Winbox接口中的目录遍历漏洞（CVE-2018-14847）读取`/nova/etc/user`文件，从中提取加密的管理员密码。
2.  **密码破解：** 破解提取到的密码（如果需要），或者直接使用提取到的加密密码。
3.  **后门植入：** 创建一个名为“option”的包，并将后门文件写入`/flash/nova/etc/devel-login`，从而启用开发后门。
4.  **远程登录：** 使用Telnet或SSH，以root用户"devel"和管理员密码登录设备。

**项目地址:** [babyshen/routeros-CVE-2018-14847-bytheway](https://github.com/babyshen/routeros-CVE-2018-14847-bytheway)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #5

**来源**: [CVE-2018-14847-hacker30468_Mikrotik-router-hack.md](../2018/CVE-2018-14847-hacker30468_Mikrotik-router-hack.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #6

**来源**: [CVE-2018-14847-jas502n_CVE-2018-14847.md](../2018/CVE-2018-14847-jas502n_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露或任意文件写入

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响版本的RouterOS，且WinBox服务开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 是一个存在于 MikroTik RouterOS 6.42 及更早版本中的目录遍历漏洞，攻击者可以利用 WinBox 接口读取任意文件（未认证）或写入任意文件（需认证）。

**有效性：**

从漏洞库信息、搜索引擎结果以及提供的 POC 代码来看，此漏洞的利用是有效的。搜索引擎结果表明，该漏洞已经被广泛研究和利用，并且存在公开的 Metasploit 模块（webpage 7），表明其可利用性较高。提供的 POC 代码包含两个 Python 脚本 (`MACServerDiscover.py` 和 `MACServerExploit.py`) 以及 `extract_user.py` (未提供完整代码)，显示了利用此漏洞读取 `/flash/rw/store/user.dat` 文件的尝试，该文件包含用户凭据。

**投毒风险：**

`MACServerDiscover.py` 用于发现局域网内的 Mikrotik 设备，本身不具备投毒功能。 `MACServerExploit.py` 的主要功能是利用目录遍历漏洞读取 `user.dat` 文件。虽然提供的 `extract_user.py` 代码不完整，但 `MACServerExploit.py` 依赖于它进行用户凭据的提取，所以如果恶意修改 `extract_user.py` 文件，使其在提取用户凭据的同时执行其他恶意操作，则存在投毒风险。 此外，`MACServerExploit.py` 中使用了硬编码的payload a 和 b，如果修改这些payload，可能会造成未知后果。 因此，风险估计为10%。

**利用方式：**

1.  **设备发现：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 MikroTik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，通过构造包含目录遍历的恶意请求，尝试读取 `/flash/rw/store/user.dat` 文件。该脚本模拟了 WinBox 协议通信，利用了协议中存在的漏洞。
3.  **凭据提取：** 如果成功读取 `user.dat` 文件，则使用（未完整提供的）`extract_user.py` 脚本从中提取用户名和密码。

利用的关键在于构造正确的 WinBox 协议数据包，利用目录遍历绕过访问限制，读取敏感文件。该漏洞既可以未授权读取文件，也可以在认证后写入文件，因此危害较大。

**项目地址:** [jas502n/CVE-2018-14847](https://github.com/jas502n/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #7

**来源**: [CVE-2018-14847-mahmoodsabir_mikrotik-beast.md](../2018/CVE-2018-14847-mahmoodsabir_mikrotik-beast.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox Directory Traversal

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（通过写入恶意文件）

**影响版本:** <= 6.42

**利用条件:** 目标设备开启WinBox服务，攻击者需要能够访问目标设备的WinBox端口（默认为8291）。未授权访问即可利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14847 漏洞存在于 MikroTik RouterOS 的 WinBox 接口中，允许未授权的远程攻击者读取任意文件，并允许已认证的攻击者写入任意文件。该漏洞是由于 WinBox 接口中的目录遍历漏洞导致的。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出未授权攻击者可以读取任意文件，而搜索引擎结果中也包含了利用该漏洞读取密码信息的案例。提供的代码 `mikrotikbeast.py` 尝试利用该漏洞读取 `/flash/rw/store/user.dat` 文件，该文件通常包含路由器用户的用户名和加密的密码。`extract_user.py` 用于解密从 `/flash/rw/store/user.dat` 文件中提取的密码。

**投毒风险：**

虽然 `mikrotikbeast.py` 脚本旨在利用 CVE-2018-14847 读取敏感文件，`extract_user.py`旨在提取账号密码，但是无法完全排除作者在代码中隐藏恶意行为的可能性，但是可能性较低。例如，可以修改 `mikrotikbeast.py` 脚本，在成功利用漏洞后，尝试下载并执行远程恶意脚本，但这不属于漏洞本身的利用，而是漏洞被利用后的一种潜在攻击方式。代码中未发现明显的后门或恶意代码，但存在一些潜在风险。 相对来说，投毒风险较低，评估为 5%。

**利用方式：**

1.  **目标扫描：** 使用 `mikrotikbeast.py` 脚本扫描指定网段内的 MikroTik 路由器，尝试连接 WinBox 端口。
2.  **漏洞触发：**  脚本构造特殊的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 脚本将读取到的 `user.dat` 文件内容保存。
4.  **密码解密：**  使用 `extract_user.py` 脚本和 `user.dat` 文件，解密用户的用户名和密码。

总而言之，该漏洞的利用方式是通过 WinBox 协议发送包含目录遍历payload的请求，从而读取到包含加密用户凭据的敏感文件，进而解密这些凭据以获得对设备的未授权访问。

**项目地址:** [mahmoodsabir/mikrotik-beast](https://github.com/mahmoodsabir/mikrotik-beast)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #8

**来源**: [CVE-2018-14847-msterusky_WinboxExploit.md](../2018/CVE-2018-14847-msterusky_WinboxExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #9

**来源**: [CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md](../2018/CVE-2018-14847-sinichi449_Python-MikrotikLoginExploit.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问 Winbox 接口 (通常是 8291 端口)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。该漏洞存在于Winbox接口中，允许未经身份验证的远程攻击者读取任意文件，以及经过身份验证的攻击者写入任意文件。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且有公开的PoC代码可用。Tenable等安全公司已经发布了关于此漏洞的报告和利用代码。漏洞利用代码 `MACServerDiscover.py` 用于发现局域网内的MikroTik设备，而 `MACServerExploit.py` 则尝试利用该漏洞。

**利用方式：**

1.  **设备发现：** 使用`MACServerDiscover.py`脚本，通过广播在局域网内查找运行MikroTik RouterOS且Winbox服务开启的设备。这个脚本发送一个特定的广播包，然后监听来自MikroTik设备的响应，从中提取设备的MAC地址。
2.  **漏洞利用：** 使用`MACServerExploit.py`脚本，它包含硬编码的路径（`../../flash/rw/store/user.dat`），试图利用目录遍历漏洞读取存储用户凭据的`user.dat`文件。
3.  **数据提取：** 该脚本可能使用定制的 Winbox 协议与目标设备通信，发送恶意请求以读取文件内容。 `extract_user.py` 用于从读取到的`user.dat`文件中提取用户名和密码。

**投毒风险：**

审查提供的PoC代码，特别是 `MACServerExploit.py`，发现以下潜在风险：

*   **硬编码的路径：** PoC 代码依赖于已知的默认文件路径 (`../../flash/rw/store/user.dat`)。如果目标设备的配置或文件系统结构与预期不符，则利用可能会失败。利用成功与否取决于目标设备上特定文件的存在和位置。
*   **广播地址：**  该脚本默认使用广播地址 (`255.255.255.255`) 发送数据包，可能导致网络拥塞，同时增加被防火墙或入侵检测系统拦截的风险。
*   **未授权访问风险：** 成功利用此漏洞可能导致攻击者获得对路由器配置的未授权访问，从而允许他们更改设置、安装后门或执行其他恶意操作。
*    **依赖的`extract_user.py`** 作者可以在这个文件中加入恶意代码，此文件中未提供，无法判断。

尽管存在上述风险，但代码主要目的是验证漏洞的存在并提取敏感信息，没有发现明显的恶意代码注入或后门植入行为。投毒风险评估为 10%。这个评估考虑到硬编码路径，导致利用的成功率降低，而且并没有发现明显的恶意代码。但仍然需要进一步审查 `extract_user.py`。


**项目地址:** [sinichi449/Python-MikrotikLoginExploit](https://github.com/sinichi449/Python-MikrotikLoginExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---



---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---



---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---



---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---



---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---



---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---



---

## POC #10

**来源**: [CVE-2018-14847-syrex1013_MikroRoot.md](../2018/CVE-2018-14847-syrex1013_MikroRoot.md)

## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 目标设备运行MikroTik RouterOS <= 6.42，并且8291端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。未经身份验证的远程攻击者可以通过WinBox接口读取任意文件，经过身份验证的攻击者可以写入任意文件。

**有效性分析：**
提供的Python代码 `MikroRoot.py` 利用了此漏洞，它首先使用Shodan搜索暴露的MikroTik设备，然后尝试利用该漏洞从目标设备中提取用户名和密码。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用，并存在公开的PoC。

**投毒风险分析：**
代码中存在潜在的投毒风险，尽管不明显：
1.  **`extract_user.py`中的`decrypt_password`函数：**  虽然函数本身实现了密码解密逻辑，但攻击者可能利用此函数执行其他恶意操作，但这部分风险较低。
2.  **Shodan API Key：**  恶意攻击者可以伪造一个类似的脚本，要求用户提供Shodan API Key，然后使用该Key进行恶意扫描活动。
3.  **dump函数：** 提取的用户密码直接输出到屏幕，存在一定风险。恶意使用者可以修改这部分输出的代码，将抓取的数据发送到恶意服务器。
4.  **`HackRouter`函数：** 连接目标设备并发送特定的字节序列。这些字节序列是漏洞利用的核心，但恶意使用者可能修改序列，进行其他恶意操作，例如尝试写入恶意文件。
   根据现有代码分析，`MikroRoot.py`主要功能依赖于从目标设备中提取敏感信息。虽然脚本本身看起来是用来进行渗透测试的工具，但潜在的滥用风险依然存在，代码中并无明显的后门代码，判定投毒风险为10%。

**利用方式分析：**
1.  **Shodan搜索：** 使用Shodan API找到暴露在公网上的MikroTik路由器。
2.  **漏洞触发：**  通过8291端口（Winbox接口）向目标设备发送特制的请求，利用目录遍历漏洞读取 `/flash/rw/store/user.dat` 文件。
3.  **数据提取：** 从读取的文件中提取加密的用户名和密码。
4.  **密码解密：** 使用内置的解密算法解密提取的密码。
5.  **权限提升/控制：** 利用获得的用户名和密码登录设备，进行进一步的攻击，例如修改配置或安装恶意软件。根据搜索引擎结果的信息，该漏洞可能被用于安装恶意软件并形成僵尸网络。
总的来说，该漏洞利用方式较为直接，通过目录遍历读取用户数据库文件并解密，从而获取设备的控制权。

**项目地址:** [syrex1013/MikroRoot](https://github.com/syrex1013/MikroRoot)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #11

**来源**: [CVE-2018-14847-tausifzaman_CVE-2018-14847.md](../2018/CVE-2018-14847-tausifzaman_CVE-2018-14847.md)

## CVE-2018-14847 - MikroTik RouterOS WinBox 目录遍历漏洞

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS WinBox

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（基于信息泄露）

**影响版本:** <= 6.42

**利用条件:** 目标设备运行受影响的RouterOS版本，且WinBox端口（默认8291）对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS的WinBox接口中的目录遍历漏洞。未经身份验证的远程攻击者可以读取任意文件，经过身份验证的攻击者可以写入任意文件。根据漏洞库信息和搜索结果，此漏洞影响RouterOS 6.42及更早版本。

**有效性分析：**
提供的POC代码（T4.py）显示了利用此漏洞读取`/flash/rw/store/user.dat`文件的尝试，该文件可能包含用户名和密码等敏感信息。代码包含端口检查，可以一定程度上验证目标是否存活。

**投毒风险分析：**
代码主要功能是利用目录遍历漏洞读取文件，但存在以下潜在的投毒风险:
*   **依赖管理风险:**  `extract_user.py` 中的代码可能存在隐患. 需要审查 `extract_user.py` 文件的全部代码。
*   **意外行为:**  代码在异常处理方面可能存在缺陷，导致意外的文件写入或系统状态更改。
综合评估，投毒风险较低，约为10%。

**利用方式分析：**
1.  攻击者通过WinBox接口发送特制的请求，其中包含目录遍历payload（例如，`../../../../flash/rw/store/user.dat`）。
2.  RouterOS未正确验证请求中的路径，导致攻击者可以访问受限目录之外的文件。
3.  攻击者可以读取`/flash/rw/store/user.dat`文件，该文件包含加密的用户名和密码。
4.  攻击者可以使用其他工具或技术解密用户名和密码，从而获得对RouterOS设备的控制权。

**缓解措施:**
1.  升级到已修复此漏洞的RouterOS版本（高于6.42）。
2.  禁用或限制对WinBox端口的访问。

**项目地址:** [tausifzaman/CVE-2018-14847](https://github.com/tausifzaman/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

## POC #12

**来源**: [CVE-2018-14847-yukar1z0e_CVE-2018-14847.md](../2018/CVE-2018-14847-yukar1z0e_CVE-2018-14847.md)

## CVE-2018-14847-MikroTik RouterOS 目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 6.42

**利用条件:** 需要能够访问WinBox接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经验证的远程攻击者读取任意文件，以及经过身份验证的远程攻击者写入任意文件，原因是 WinBox 接口中存在目录遍历漏洞。根据搜索结果和提供的漏洞利用代码，该漏洞的利用方式是通过构造恶意的请求，利用 WinBox 接口中的目录遍历漏洞读取或写入系统中的敏感文件。提供的代码通过 SSH 连接到目标 RouterOS 设备，并尝试创建 VPN 连接，这可能被用于建立隐蔽的通信隧道，从而进行进一步的恶意活动。虽然主程序的目标是创建VPN，但存在潜在的投毒风险。例如，创建VPN使用的用户名和密码可能被硬编码为恶意值，或者在创建VPN的过程中执行其他恶意操作。由于提供的代码不完整，无法完全确定是否存在其他隐藏的恶意行为，所以投毒风险评估为 10%。

根据搜索结果，该漏洞的利用可能会导致远程代码执行攻击。

**漏洞利用方式:**

1.  **未授权读取文件:**  攻击者可以发送特制的请求到Winbox接口，利用目录遍历读取路由器上的任意文件，例如配置文件，包含用户名密码的文件等。
2.  **授权写入文件:**  攻击者在获得认证后，可以通过Winbox接口利用目录遍历漏洞写入任意文件，例如替换系统文件，植入后门。
3.  **创建 VPN 连接 (PoC 代码):** 提供的PoC代码尝试自动化利用该漏洞，通过建立SSH连接并执行命令，来在目标设备上创建VPN连接。攻击者可能利用这个VPN作为跳板进行其他攻击。

**有效性评估:**

根据漏洞信息和搜索结果，CVE-2018-14847 是一个已知且被广泛讨论的漏洞。有公开可用的漏洞利用代码，表明该漏洞具有较高的可利用性。提供的PoC代码看起来也是基于该漏洞进行利用，虽然功能上是创建VPN连接，但它验证了漏洞的可达性。

**项目地址:** [yukar1z0e/CVE-2018-14847](https://github.com/yukar1z0e/CVE-2018-14847)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)

---

