## CVE-2018-2628 - Oracle WebLogic Server (Oracle Fusion Middleware) 反序列化漏洞

**漏洞编号:** CVE-2018-2628

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server (Oracle Fusion Middleware)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 目标服务器开启T3协议（默认开启），且未安装相应补丁或未进行协议过滤。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本由Jas502n编写，针对Oracle WebLogic Server的T3协议漏洞实现Getshell功能。从代码结构看，脚本首先通过t3handshake函数与目标服务器建立T3协议握手，验证目标是否支持该协议。随后，它构造了包含恶意序列化对象的T3请求。脚本中定义的PAYLOAD包含硬编码的十六进制字节流，这是典型的JRMPClient利用方式，通过向目标发送精心构造的序列化对象，诱使WebLogic在处理反序列化时连接到攻击者控制的JRMP服务。脚本实现了完整的攻击流：从版本探测、握手到Payload投递。利用步骤：1. 攻击者准备一台运行JRMPListener的恶意服务器（如使用ysoserial）；2. 运行此脚本，指定目标IP和WebLogic端口（默认7001）；3. 脚本发送T3握手包并验证响应；4. 脚本发送序列化Payload；5. 目标WebLogic反序列化Payload后，触发回连JRMP服务器，从而加载恶意类执行任意代码。投毒风险分析：该脚本代码逻辑清晰，主要使用Python标准库socket和sys。经过审计，代码中未发现明显的恶意混淆或针对研究者本人的后门。脚本中的硬编码IP（如104.251.228.50）在注释部分出现，主要作为利用示例的残留。主要的潜在风险在于脚本使用了硬编码的十六进制Payload，这对于普通研究人员来说缺乏透明度，无法直接判断该十六进制流是否包含非预期的恶意指令。此外，脚本依赖于外部环境（需配合JRMPListener），若配合使用的Listener工具来源不明，则整体风险会升高。对于防御者而言，此脚本可以直接用于漏洞复现和安全基线校验，但建议在隔离环境中运行，并对PAYLOAD数据进行反汇编校验。

**项目地址:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
