## CVE-2018-2628 - Oracle WebLogic Server RCE (远程代码执行)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 需要网络访问WebLogic T3协议端口（通常为7001），无需预先身份认证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC是一个典型的针对WebLogic T3协议反序列化漏洞的利用程序。代码通过Java RMI和JNDI机制尝试在目标服务器上安装或调用远程对象。代码分析显示，它引入了`weblogic.jndi.WLInitialContextFactory`以及WebLogic相关的内部类，通过`Environment`对象配置提供者URL并尝试获取初始上下文。POC逻辑中包含了检查是否已安装RMI实例（`checkIsAlreadyInstalled`）以及调用RMI（`invokeRmi`）的步骤。这种方式通常用于绕过之前的补丁，利用`JRMPClient`将恶意序列化对象通过T3协议发送，诱使服务器回调攻击者控制的JRMP服务端，从而实现命令执行。该代码结构清晰，包含了命令行解析（`org.apache.commons.cli`）和SSL处理，是一个功能相对完整的渗透测试工具。其核心逻辑在于利用T3协议在处理序列化数据时的缺陷，通过特定的对象引用链触发漏洞。经过对代码片段的评估，该POC在配置好相应的WebLogic运行库环境后具有极高的有效性，能够直接针对未打补丁的WebLogic实例执行系统命令。\n\n【利用步骤】1. 准备环境：由于POC依赖WebLogic内部类，需要将相关的`weblogic.jar`等库文件加入类路径。2. 配置目标：通过命令行参数指定目标主机的IP地址和T3端口（默认7001）。3. 建立监听：在攻击机侧启动一个JRMP服务端（如使用ysoserial的JRMPListener），并携带payload。4. 执行利用：运行该Java程序，程序会尝试通过T3协议连接目标。5. 漏洞触发：程序发送构造好的序列化数据，目标服务器解析时会连接攻击者的JRMP服务端，下载并反序列化恶意对象，最终在目标服务器上执行`whoami`或指定的系统命令。\n\n【投毒风险分析】该POC代码的投毒风险评级为低（15%）。代码的主要组成部分是标准的Java开发框架和WebLogic API调用。通过审计提供的源代码片段，未发现明显的恶意混淆（如Base64加密的恶意字节码加载）、未发现隐藏的网络外联（除了针对目标的合法扫描行为）、也未发现针对研究人员机器的后门注入或敏感文件嗅探行为。其使用的`BASE64Encoder`和`Scanner`等类均属于标准开发范畴。主要的潜在风险在于：第一，该类工具往往被集成在更大的GitHub项目中，如果项目维护者在依赖库（如`pom.xml`中未显示的本地jar包）中植入恶意代码，可能导致利用时被感染；第二，虽然代码本身看起来是防御性研究或渗透测试用途，但其硬编码的命令执行逻辑如果被不当修改，可能在自动化执行脚本中产生非预期的副作用。整体而言，该代码逻辑透明，符合安全研究人员的使用习惯，不存在显著的投毒特征。

**项目地址:** [https://github.com/supeream/weblogic-exploit](https://www.google.com/search?q=https://github.com/supeream/weblogic-exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
