## CVE-2018-0114 - Cisco node-jose JWT签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT签名伪造

**影响应用:** Cisco node-jose

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** 0.11.0之前版本

**利用条件:** 无需认证，远程攻击

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2018-0114 是 Cisco node-jose 库中存在的一个漏洞，该漏洞允许未经身份验证的远程攻击者使用嵌入在令牌中的密钥重新签名令牌。漏洞原因是 node-jose 遵循 JSON Web Signature (JWS) 标准，该标准允许 JSON Web Key (JWK) 嵌入在 JWS 的 header 中。攻击者可以伪造有效的 JWS 对象，通过移除原始签名，添加新的公钥到 header 中，然后使用与 header 中公钥关联的攻击者私钥对对象进行签名。

POC 代码 `jwt-cisco-node-exploit.py` 提供了一个完整的漏洞利用示例。首先，它生成一个新的 RSA 密钥对。然后，它构造一个包含 `alg` 和 `jwk` 字段的 JWT header。`jwk` 字段包含新生成的公钥的详细信息，包括模数 `n` 和指数 `e`。接下来，它设置 payload，并构造一个未签名的 JWT 字符串，该字符串由 base64 编码的 header、一个点号和 payload 组成。最后，它使用新生成的私钥对字符串进行签名，并将签名附加到 JWT 字符串中。这个最终的 JWT 字符串可以被发送到易受攻击的 Cisco node-jose 实例，该实例会信任嵌入在 header 中的公钥，并验证攻击者生成的签名。

利用步骤如下：
1.  运行提供的 Python 脚本 `jwt-cisco-node-exploit.py`，并替换 `payload` 变量为你想要注入的恶意 payload。
2.  脚本将生成一个伪造的 JWT 令牌。
3.  将生成的 JWT 令牌发送到使用存在漏洞的 Cisco node-jose 库进行 JWT 验证的应用程序。
4.  应用程序将信任伪造的令牌，并执行攻击者指定的恶意操作。

**投毒风险分析：**
该 POC 的投毒风险较低。代码使用标准库（如 OpenSSL 和 cryptography）生成密钥和签名，没有发现明显的混淆或恶意行为。虽然攻击者可以修改 payload 来执行任意操作，但这属于漏洞本身的性质，而不是 POC 代码引入的额外风险。脚本本身的功能仅限于生成伪造的 JWT 令牌，不包含任何未经授权的系统访问、数据窃取或恶意代码执行。但是，应该注意该脚本生成的 JWT 令牌，如果被滥用，可能会导致严重的后果，例如未经授权的访问或数据篡改。因此，在测试和使用该 POC 时，必须采取适当的安全措施，并仅在授权的环境中进行操作。

**项目地址:** https://github.com/joasfar/CVE-2018-0114-Exploit

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0114
