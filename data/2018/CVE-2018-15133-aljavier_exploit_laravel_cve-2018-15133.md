## CVE-2018-15133 - Laravel Framework RCE/反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** RCE/反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危

**CVSS评分:** CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (暂定7.5-8.1)

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要获取应用程序的API_KEY (APP_KEY)；目标环境未修复反序列化校验漏洞。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于Laravel框架的解密过程中，具体位于Illuminate/Encryption/Encrypter.php。由于框架在处理HTTP请求头中的X-XSRF-TOKEN时，未经过滤直接调用unserialize()对解密后的数据进行操作，导致攻击者若掌握应用的APP_KEY，即可构造恶意的加密Payload实现远程代码执行。本次提供的POC代码（pwn_laravel.py）是一个高度集成的Python脚本，它完整实现了AES加密、HMAC签名生成以及多种Laravel RCE链（如Method 1-4，包含PendingBroadcast等）。脚本利用rich库提供了优雅的控制台输出，利用Crypto库处理底层加密，通过requests发送攻击载荷。经分析，该POC逻辑严密，能够自动计算签名并适配不同版本的gadget chain，具有极高的实战有效性。利用步骤：1. 通过信息泄露（如.env文件）获取目标的APP_KEY。2. 安装Python依赖库（rich, pycryptodome, requests）。3. 运行脚本并指定目标URL、APP_KEY及要执行的命令，例如：python pwn_laravel.py [http://target.com](http://target.com) KEY_VALUE -c 'whoami'。脚本会自动生成加密的X-XSRF-TOKEN并将其置于HTTP Header中发送，触发漏洞后回显执行结果。投毒风险分析：该POC项目来源于合法的安全研究与CTF（Hack The Box）实践，代码结构透明，主要逻辑集中在加密算法的Python实现和HTTP请求构建。经过静态代码审计，未发现混淆代码、反连特定恶意IP、窃取本地环境变量或删除系统文件的恶意后门行为。脚本中虽然使用了eval或subprocess等危险函数的触发逻辑，但这属于漏洞利用载荷的一部分，而非针对使用者本机的攻击。潜在风险点在于其依赖项安装过程及外部引用的PHPGGC工具链，建议在隔离环境（如Docker或虚拟机）中运行。由于代码清晰且遵循标准开源实践，其投毒风险评级为低（15%），主要风险源于恶意第三方可能克隆并二次修改该仓库。总体而言，该代码是安全研究员评估环境风险的有力工具。

**项目地址:** [https://github.com/aljavier/exploit_laravel_cve-2018-15133](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)
