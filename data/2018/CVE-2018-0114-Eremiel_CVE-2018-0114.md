## CVE-2018-0114 - Cisco node-jose JWT forgery

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT forgery

**影响应用:** Cisco node-jose

**危害等级:** High

**CVSS评分:** N/A

**影响版本:** < 0.11.0

**利用条件:** Remote attacker, unauthenticated

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2018-0114 is a vulnerability in the Cisco node-jose open source library before version 0.11.0 that allows an unauthenticated, remote attacker to re-sign tokens using a key that is embedded within the token. This vulnerability exists because node-jose follows the JSON Web Signature (JWS) standard for JSON Web Tokens (JWTs). This standard specifies that a JSON Web Key (JWK) representing a public key can be embedded within the header of a JWS. This public key is then trusted for verification. The provided Python POC code, cve-2018-0114.py, demonstrates the exploit. It takes a payload as input and generates a JWT with a forged signature. The script creates an RSA key pair, crafts a header containing the public key, and then signs the header and payload using the corresponding private key. The forged JWT can then be used to bypass authentication or impersonate users in systems that rely on JWTs for authentication.

**POC有效性分析:**
The provided POC code is effective in demonstrating the vulnerability. It successfully generates a forged JWT that can be used to bypass authentication or impersonate users. The code is relatively simple and easy to understand, making it accessible to a wide range of users. The script takes the payload and keysize as an argument, generates an RSA keypair, constructs the header with the public key, encodes the header and payload, signs the encoded string with the private key, and then constructs the final JWT. The core of the exploit lies in the ability to embed a public key in the JWT header, which the vulnerable application then trusts for verification. The POC code replicates this behavior, effectively demonstrating the vulnerability.

**利用步骤:**
1.  Obtain the POC code (cve-2018-0114.py) and the README.md.
2.  Install the required dependencies (rsa, base64, urllib, sys). Since the code targets Python 2.7, it is recommended to execute it within a Python 2.7 environment.
3.  Execute the script with the desired payload and keysize as arguments: `python cve-2018-0114.py <payload> <keysize>`. For instance, `python cve-2018-0114.py admin 2048` will create a forged JWT with the payload "admin" and a 2048-bit RSA key.
4.  The script will output the forged JWT.
5.  Use the forged JWT to authenticate to the vulnerable application.

**投毒风险分析:**
The provided POC code poses a low poisoning risk. The code is relatively straightforward and uses standard Python libraries such as base64, urllib, and rsa. While the `urllib.quote_plus` function used for URL encoding can be potentially misused, its usage in this script is for the legitimate purpose of encoding the generated token. The script doesn't execute any external commands or download any additional files, which reduces the likelihood of introducing malicious code. The risk is further mitigated by the fact that the core functionality involves generating cryptographic keys and signing data, which are inherently security-sensitive operations. There is a minimal risk if a malicious actor were to modify the script to include malicious payloads or alter the key generation process, however, given the code's simplicity, any such modifications would be easily detectable. Overall, the poisoning risk is estimated to be low (10%).

**项目地址:** https://github.com/OffensiveCloud/CVE-2018-0114

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
