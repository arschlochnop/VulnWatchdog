## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** 0.6.0 及更高版本，在 0.7.6 和 0.8.4 版本之前

**利用条件:** 目标服务器运行受影响版本的 libssh 服务，且攻击者可以建立网络连接。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：此POC代码针对CVE-2018-10933漏洞，该漏洞存在于libssh的服务端状态机逻辑中。漏洞的根本原因在于libssh在处理身份验证请求时，未能正确验证状态转换。正常情况下，客户端需要经过密码或密钥验证过程，但受影响的版本允许客户端直接向服务器发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息。当服务器接收到该消息时，会错误地认为身份验证已成功完成，并跳转到已验证状态，从而允许客户端在未提供任何有效凭证的情况下开启会话通道。本POC利用Python的Paramiko库手动构造并发送该特定字节码。代码逻辑清晰：首先建立基础Socket连接，初始化传输层，然后通过 `message.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)` 构造成功信号并直接发送。随后立即调用 `open_session()`，由于服务器逻辑缺陷，此时会话被成功建立，POC进一步执行用户指定的命令并读取回显。该POC直接展示了从绕过认证到远程代码执行（RCE）的完整链路，在受影响的实验室环境下具有极高的复现成功率。利用步骤：1. 确保安装了Python3及paramiko库。2. 准备受影响版本的libssh服务端环境（如版本0.8.3）。3. 运行命令 `python3 LibAuth.py --host [目标IP] -p [端口] -c "[待执行命令]"`。4. 脚本将自动连接、发送伪造的成功包并输出命令结果。投毒风险分析：经过对提供的 `LibAuth.py` 源码进行静态分析，未发现任何恶意后门或可疑的行为。代码完全依赖于标准的Python库（socket, paramiko, argparse, sys），其主要逻辑仅限于建立网络连接、构造SSH协议报文以及打印返回结果。没有任何代码尝试将敏感数据（如攻击者的环境变量、SSH密钥等）外传至第三方服务器，也没有发现任何混淆处理或动态执行（exec/eval）加密字符串的行为。代码中的 `cMSG_USERAUTH_SUCCESS` 是协议定义的常量，属于漏洞利用的必要组成部分，而非恶意负载。README文档提供的参考链接均指向知名的安全学习平台（PentesterLab）、GitHub公共仓库及官方文档，无诱导下载恶意文件的迹象。风险评级为极低，该脚本是一个纯粹的防御性研究工具或漏洞验证脚本。唯一需要注意的是，用户在执行此类网络攻击脚本时应确保在授权范围内进行，防止对生产环境造成不可逆的影响。

**项目地址:** [https://github.com/kn6869610/CVE-2018-10933](https://github.com/kn6869610/CVE-2018-10933)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-10933](https://nvd.nist.gov/vuln/detail/cve-2018-10933)
