## CVE-2018-2628 - Oracle WebLogic Server RCE (远程代码执行)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 可通过T3协议访问目标主机的7001端口，无需身份验证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC代码是一个基于Python编写的针对Oracle WebLogic T3协议反序列化漏洞的利用脚本。代码首先通过t3handshake函数与目标服务器建立T3协议握手，发送特定的十六进制序列（7433...）进行版本协商。随后，buildT3RequestObject函数构建并发送一个封装了恶意反序列化Payload的T3请求。Payload中包含了'aced0005'这一典型的Java序列化魔术头，以及针对'java.rmi.server.RemoteObjectInvocationHandler'等类的利用链。分析显示，该POC的核心逻辑在于绕过WebLogic之前的黑名单补丁，通过新的利用链触发JRMPClient，进而导致受害服务器连接攻击者的远程JRMP服务端。此脚本展示了完整的协议交互过程，具有较高的实战价值，但需要配合JRMPListener使用才能实现完整的RCE效果。代码中包含了硬编码的IP地址（104.251.228.50），这通常是该POC在流传过程中的痕迹，使用时需修改为攻击者可控的地址。【利用步骤】1. 环境准备：部署JRMPListener（如ysoserial中的工具），监听特定端口并设置待执行的系统命令。2. 修改POC：将脚本PAYLOAD部分中的硬编码IP和端口替换为监听端的地址。3. 执行攻击：使用Python运行脚本，指定目标WebLogic的IP和端口（通常为7001）。脚本将完成T3握手并注入Payload。4. 触发回调：目标服务器反序列化恶意对象后，将发起JRMP请求至监听端，从而下载并执行最终的恶意类文件。【投毒风险分析】该POC存在中等程度的投毒风险。首先，脚本中的PAYLOAD段是一串极长的、未经注释的十六进制字符串，这为隐藏恶意后门提供了天然的屏障。虽然大部分数据是标准的反序列化攻击载荷，但普通分析人员难以肉眼识别其中是否混入了针对利用者的反向连接代码。其次，代码中出现了硬编码的外部IP地址（104.251.228.50），这种行为在安全研究领域极为可疑，它可能引导初学者在不经意间将敏感数据发送至第三方服务器，或者直接成为黑客控制的傀儡机。此外，该脚本依赖于Python 2环境（从print语句及编码声明可见），其在某些环境中可能执行额外的系统命令或通过内置库下载外部脚本。考虑到此类漏洞利用工具常在非官方渠道、Telegram群组或非知名GitHub仓库传播，攻击者极易在代码中插入混淆后的base64指令或eval函数，实现对攻击者的‘黑吃黑’，建议在隔离环境中使用静态分析和动态沙箱确认其安全性。

**项目地址:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
