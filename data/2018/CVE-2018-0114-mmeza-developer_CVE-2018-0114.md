## CVE-2018-0114 - Cisco node-jose library JWT Forge

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT Forge

**影响应用:** Cisco node-jose library

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** Versions before 0.11.0

**利用条件:** No authentication required, network access

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2018-0114 is a vulnerability in the Cisco node-jose library that allows attackers to forge JWT tokens by embedding a public key in the token header. This vulnerability arises from the library's improper handling of JSON Web Key (JWK) sets, specifically its failure to adequately validate the key ID (kid) parameter and the key material within the JWK. An attacker can exploit this weakness to create a malicious JWT, embedding a crafted public key, and subsequently sign the token using the corresponding private key. When the application verifies the token, it uses the attacker-provided public key, leading to successful forgery. 

The provided POC code demonstrates the vulnerability by generating a new RSA key pair, crafting a JWT header that includes the public key in JWK format and setting the kid to match, constructing a payload with desired claims (e.g., administrator privileges), signing the token with the generated private key, and sending the forged JWT to a vulnerable application. The vulnerable application, trusting the attacker's public key, validates the forged token as legitimate, granting the attacker unauthorized access or control. 

The POC code's effectiveness is high, given that it directly exploits the identified vulnerability. The provided code contains functions for generating keys, crafting JWT tokens with embedded public keys, and interacting with vulnerable endpoints. To successfully exploit the vulnerability, the attacker needs to generate an RSA key pair. Then craft a JWT header containing the public key in JWK format and a payload with claims. Sign the JWT with the private key. Finally, send the crafted JWT to the vulnerable application. The application, upon verifying the JWT using the embedded public key, will be tricked into accepting the forged token.

投毒风险分析：The poisoning risk associated with this POC is low (15%) for several reasons. The code primarily uses standard Python libraries such as `pycryptodome`, `jwt`, `OpenSSL`, and `cryptography` for cryptographic operations and JWT manipulation. There are no indications of obfuscation or malicious intent within the code. The code focuses on exploiting a specific vulnerability related to JWT validation, rather than introducing backdoors or malicious payloads. The usage of libraries is explicit and transparent, reducing the likelihood of hidden malicious functionalities. The functions are dedicated to key generation, JWT construction, and demonstration of the forgeability issue, which are actions related to the vulnerability being tested.

**项目地址:** https://pentesterlab.com/exercises/cve-2018-0114

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
