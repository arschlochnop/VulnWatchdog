## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6.0 及以上版本，且在 0.7.6 和 0.8.4 版本之前

**利用条件:** 目标服务器运行受影响版本的 libssh 服务；攻击者拥有网络访问权限

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC利用了libssh服务器状态机中的逻辑漏洞。在正常的SSH认证流程中，客户端应发送MSG_USERAUTH_REQUEST，而该POC直接向服务器发送MSG_USERAUTH_SUCCESS消息。由于libssh状态机在处理该消息时缺乏必要的上下文校验，直接将连接状态提升为已认证，从而允许攻击者绕过身份验证并执行命令。代码通过paramiko库构造底层的SSH消息包，逻辑清晰且直接针对漏洞核心点。经分析，该代码在受影响的环境中具有极高的利用成功率。利用步骤：1. 攻击者通过socket连接到目标主机的SSH端口。2. 初始化paramiko传输层并启动客户端模式。3. 构造并发送一个MSG_USERAUTH_SUCCESS（值为52）的字节消息，欺骗服务器状态机认为认证已通过。4. 打开一个新的会话（session）并通过exec_command方法执行用户指定的任意系统命令。5. 循环读取并打印命令执行结果。投毒风险分析：该POC代码逻辑透明，主要依赖Python标准库socket和第三方成熟库paramiko。代码中不存在混淆手段、未经授权的外部网络请求或对本地系统的破坏性操作。其参数处理使用了argparse，结构规范。核心逻辑集中在通过MSG_USERAUTH_SUCCESS消息进行协议欺骗，未发现隐藏的恶意payload或后门植入行为。尽管POC本身具有强大的RCE能力，但其作为安全研究工具的属性明确，投毒风险极低。该代码属于典型的概念验证性质，主要用于安全检测和防御加固。用户在运行此类脚本时，应确保环境的可控性，避免在生产环境直接测试。

**项目地址:** [https://www.libssh.org/security/advisories/CVE-2018-10933.txt](https://www.libssh.org/security/advisories/CVE-2018-10933.txt)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
