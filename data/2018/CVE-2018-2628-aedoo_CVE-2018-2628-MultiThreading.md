## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 通过T3协议进行网络访问，无需身份验证

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本由Aedoo开发，旨在针对Oracle WebLogic Server的T3协议漏洞进行多线程扫描与验证。代码核心通过socket建立原始TCP连接，并模拟T3协议的手口（handshake）过程，发送特定的十六进制字节流。有效性体现在其使用了精确的T3请求对象构造方法，其中包含了针对反序列化漏洞的Payload。脚本中定义的PAYLOAD变量包含了一个经典的Java序列化数据包（以aced0005开头），该数据包利用了JRMPClient进行绕过。代码逻辑完整，包含了目标IP端口解析、多线程队列管理以及响应匹配（通过正则表达式匹配代理对象标志）。该脚本能够直接检测目标服务器是否存在此漏洞，且由于采用了多线程并发设计，在大规模扫描场景下具有极高的实用价值。利用步骤：1. 攻击者准备包含恶意代码的JRMP服务端。2. 运行此POC脚本，通过-f参数指定包含WebLogic服务器地址的列表。3. 脚本首先发送T3协议握手包。4. 握手成功后，脚本发送嵌入了反序列化Payload的T3请求。5. 目标服务器在反序列化该Payload时，会反向连接攻击者的JRMP服务端并加载恶意类，从而实现远程代码执行。投毒风险分析：经过对提供的POC源码进行静态分析，该代码主要使用了Python标准库如socket, threading, Queue, re和sys，未发现明显的恶意混淆或第三方不可信库调用。代码逻辑清晰，主要行为集中在网络通信和十六进制数据发送上。风险点主要在于其引用的Payload部分：Payload中包含了一个外部硬编码的IP地址（104.251.228.50），这是一个典型的JRMP交互点。在防御性研究中，如果直接运行该POC而不修改此Payload，可能会导致流量被重定向到开发者控制的服务器，存在潜在的数据泄露风险或被利用进行DDoS的可能性。然而，脚本本身并不包含自我复制、删除系统文件或加密磁盘等恶意投毒特征。对于安全研究人员而言，在使用前应将十六进制Payload中的回调地址替换为受控的本地监听环境，以确保实验安全性。综合评估，该POC属于公开的安全研究工具，投毒风险处于较低水平，但由于存在硬编码的外部连接，仍需在受控环境下审慎使用。

**项目地址:** [https://github.com/Aedoo/CVE-2018-2628-MultiThreading](https://github.com/Aedoo/CVE-2018-2628-MultiThreading)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
