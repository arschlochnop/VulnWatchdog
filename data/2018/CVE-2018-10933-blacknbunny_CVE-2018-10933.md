## CVE-2018-10933 - libssh 身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6.0 及以上版本, 在 0.7.6 和 0.8.4 版本之前

**利用条件:** 目标服务器启用了 libssh 服务端功能，且版本在受影响范围内，攻击者需具备网络访问权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC（libsshauthbypass.py）具有极高的有效性和实用价值。其核心逻辑在于利用了libssh服务端状态机中的逻辑缺陷：当客户端向服务端发送 SSH2_MSG_USERAUTH_SUCCESS 消息而非预期的 SSH2_MSG_USERAUTH_REQUEST 时，libssh服务端会错误地认为身份验证已经成功，从而跳过所有的凭据检查。POC代码使用了 Python 的 paramiko 库（或底层 socket 构造）来发送特定的 SSH 协议包。通过分析代码，程序首先建立 socket 连接，然后在 SSH 握手阶段直接注入“验证成功”的状态码。这种漏洞利用方式不依赖于弱口令或任何已知的用户凭据，只要目标版本符合（0.6.x 至 0.7.5/0.8.3），成功率接近 100%。此外，配套的 checkversionofserver.py 提供了版本指纹探测功能，通过读取服务端的 Banner 信息来预判漏洞存在性，形成了一套完整的攻击链路。该利用程序能够直接执行任意命令（如示例中的 cat /etc/passwd），危害极大。【利用步骤】1. 环境准备：安装依赖项 paramiko（建议版本 2.4.2）。2. 漏洞扫描：使用 checkversionofserver.py 探测目标主机的 22 端口或自定义 SSH 端口，确认 libssh 版本。3. 漏洞执行：运行 libsshauthbypass.py，指定 --host 参数为目标 IP，--port 为服务端口，--command 为需要执行的指令。4. 结果获取：程序将通过绕过验证的通道直接返回命令执行结果并记录到指定的日志文件中。【投毒风险分析】经过对提供的 Python 脚本进行深度静态代码审计，该 POC 项目的投毒风险评级为低（10%）。脚本逻辑清晰，使用了标准的 Python 库（socket, argparse, logging, paramiko），未发现经过 Base64 加密或混淆的代码块。代码中不存在可疑的远程回调（C2）请求、敏感目录遍历写入（除用户指定的 logfile 外）或自删除等后门行为。项目 README 文档引用了合法的 Exploit-DB 和 libssh 官方安全公告链接，显示其作为安全研究用途的意图明确。潜在的风险点在于其对第三方依赖 paramiko 的特定版本要求，在某些恶意变体中，攻击者可能会通过修改 requirements.txt 强制安装被篡改的库文件。但在当前代码样本中，逻辑完全符合公开漏洞的利用原理，未检测到恶意注入代码。建议防御者在受控沙箱环境下运行此类 POC，并重点监控异常的 SSH 协议流（即非正常握手包）。

**项目地址:** [https://www.exploit-db.com/exploits/45638](https://www.exploit-db.com/exploits/45638)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-10933](https://nvd.nist.gov/vuln/detail/cve-2018-10933)
