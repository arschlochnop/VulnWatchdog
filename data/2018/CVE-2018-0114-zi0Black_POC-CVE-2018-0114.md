## CVE-2018-0114 - Cisco node-jose JWT伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT伪造

**影响应用:** Cisco node-jose

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** < 0.11.0

**利用条件:** 无需认证，远程攻击

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2018-0114是Cisco node-jose库中存在的一个漏洞，允许未经身份验证的远程攻击者使用嵌入在令牌中的密钥重新签名令牌。此漏洞是由于node-jose遵循JSON Web Signature (JWS)标准，该标准允许将JSON Web Key (JWK)嵌入到JWS的头部。该公钥随后被信任用于验证。攻击者可以通过删除原始签名，在头部添加一个新的公钥，然后使用与嵌入在JWS头部中的公钥关联的攻击者拥有的私钥对对象进行签名，从而伪造有效的JWS对象。

POC代码分析显示，该Python脚本 `jwk-node-jose.py` 演示了如何利用此漏洞。该脚本首先生成RSA密钥对，然后构造包含攻击者公钥的恶意JWT头部。该脚本使用攻击者的私钥对修改后的JWT进行签名，从而有效地伪造令牌。脚本接受payload和key size作为参数，允许攻击者控制注入的payload和RSA密钥的大小。

利用步骤：
1. 运行 `jwk-node-jose.py` 脚本，指定payload和密钥大小。
2. 脚本将生成包含伪造签名的JWT。
3. 将伪造的JWT发送到易受攻击的node-jose服务器。
4. 服务器将信任伪造的签名，并允许攻击者执行未经授权的操作。

POC有效性分析：提供的POC代码能够成功生成有效的恶意JWT，该JWT可以绕过node-jose服务器的身份验证。PentesterLab上有一个专门的练习来学习如何利用此漏洞，进一步验证了POC的有效性。

投毒风险分析：
该POC代码使用标准的Python库（如base64、urllib和rsa），代码本身相对清晰，未发现任何可疑行为。但是，由于该脚本可以生成用于身份验证绕过的恶意JWT，因此存在被滥用的风险。如果攻击者修改脚本以包含其他恶意功能（例如，下载和执行任意代码），则投毒风险会增加。目前来看风险较低，因为代码逻辑简单，依赖标准库，未发现混淆代码和恶意行为。初始投毒风险评估为10%。

**项目地址:** https://github.com/zi0Black/POC-CVE-2018-0114

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
