## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 可通过T3协议访问WebLogic Server端口（默认7001）且未打补丁。

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本POC代码是针对Oracle WebLogic Server T3协议反序列化漏洞（CVE-2018-2628）的Python实现。代码通过socket直接构造T3协议握手包并发送加密混淆的序列化Payload。分析脚本结构，`t3handshake`函数成功实现了与WebLogic服务端的握手通讯，`buildT3RequestObject`则负责封装恶意反序列化对象。Payload部分包含硬编码的十六进制流，该流构造了RMI连接，通常用于JRMPClient反序列化利用。该POC提供了批量检测逻辑，能够有效识别目标系统是否存在由于T3协议不安全处理而导致的反序列化风险。利用步骤：1. 准备目标列表文件url.txt，格式为IP:Port。2. 运行环境需安装Python 2.x（由于代码中使用了print语句和socket编码）。3. 执行命令`python weblogic_poc-cve-2018-2628-update.py 3`，其中3为超时时间。4. 脚本会建立T3握手，发送精心构造的反序列化载荷，若服务端返回包含‘$Proxy’特征的响应，则判定存在漏洞。5. 攻击者通常会配合JRMPListener在本地开启监听，引导存在漏洞的服务端反向连接执行命令。投毒风险分析：该脚本代码逻辑相对透明，主要使用了标准库如socket、time、re和sys。然而，值得警惕的是Payload中存在硬编码的IP地址（104.251.228.50），这在安全研究中属于典型的投毒或后门行为痕迹。虽然这段载荷可能是直接复制自公开的JRMPClient利用链，但未经修改的使用会导致受害机器在触发漏洞时连接至攻击者预设的远程服务器（104.251.228.50），而非安全研究员受控的监听端。此外，README中提到的‘输出效果请自己注释’和对脚本修改的描述可能掩盖了潜在的非预期行为。虽然本脚本没有明显的本地破坏逻辑，但这种包含硬编码远程地址的POC具有较高的‘被动投毒’风险，防御人员在测试前必须通过反序列化工具（如ysoserial）重新生成指向受控地址的Payload，否则会导致安全测试流量外泄或被第三方利用。总体而言，代码本身未发现混淆或破坏性系统指令，属于中低风险，但在利用链配置上存在合规性隐患。

**项目地址:** [https://github.com/jas502n/CVE-2018-2628](https://github.com/jas502n/CVE-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
