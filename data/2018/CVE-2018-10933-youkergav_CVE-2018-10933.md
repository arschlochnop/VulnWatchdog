## CVE-2018-10933 - libssh 身份认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份认证绕过

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 0.6.0 及以上版本，并在 0.7.6 和 0.8.4 之前修复

**利用条件:** 目标系统开启了 libssh 服务端功能且版本在受影响范围内，攻击者只需网络可达即可发起攻击，无需任何凭证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC提供了一个完整的基于Docker的漏洞复现环境。其核心逻辑在于利用libssh服务器状态机在处理SSH2消息时的逻辑漏洞。正常流程中，客户端应发送SSH2_MSG_USERAUTH_REQUEST开始认证，但受影响版本的libssh服务端在接收到客户端伪造的SSH2_MSG_USERAUTH_SUCCESS（通常由服务端发给客户端表示成功的消息）时，会错误地改变其内部状态机，直接进入已认证状态。POC中包含Dockerfile、环境补丁和启动脚本，通过手动编译受影响版本的libssh并运行示例服务端程序，验证了攻击者可以绕过身份验证直接获取Shell。该漏洞在现实中极具威力，因为libssh常被集成在各种嵌入式设备和网络管理软件中。利用步骤：1. 进入POC目录的docker文件夹。2. 执行docker-compose up启动靶机环境。3. 使用攻击脚本（如Python paramiko模拟）向靶机22端口发送USERAUTH_SUCCESS报文。4. 无需密码即可建立SSH会话并执行指令。投毒风险分析：该POC包表现出较高的透明度，主要包含Dockerfile、patch补丁文件和README文档。分析其Dockerfile内容，其下载源为官方或常见的Debian镜像，依赖包安装均通过标准的apt-get完成。补丁文件（.patch）经过审计，仅涉及修改auth.c和server.c中的状态判断逻辑，以触发或模拟受影响的环境，未发现植入恶意反弹Shell或键盘记录器等恶意代码。项目引用的第三方GitHub链接（hackerhouse-opensource）为安全社区公认的知名资源。然而，由于该漏洞利用门槛极低且影响深远，此类POC常被黑客二次包装。用户在下载非官方维护的封装脚本时应警惕二进制文件替换风险。本POC由于代码清晰、逻辑符合技术预期且依赖项可控，判定为低度投毒风险，但在生产网测试前仍建议在隔离的沙箱中执行构建。

**项目地址:** [https://github.com/hackerhouse-opensource/cve-2018-10933](https://github.com/hackerhouse-opensource/cve-2018-10933)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
