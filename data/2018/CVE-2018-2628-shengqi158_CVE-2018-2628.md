## CVE-2018-2628 - Oracle WebLogic Server 反序列化远程代码执行(RCE)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** 反序列化远程代码执行(RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 目标服务器开启T3协议端口（默认7001），且未安装相应安全补丁。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码主要针对Oracle WebLogic Server的T3协议反序列化漏洞。代码通过socket建立TCP连接，并模拟WebLogic的T3握手协议（发送'74332031322e322e31...'等十六进制字符）。在成功握手后，通过buildT3RequestObject函数构造包含恶意序列化对象的T3请求。核心Payload利用了'java.rmi.activation.Activator'等类触发JRMPClient反序列化，通过导向攻击者控制的JRMP服务端实现远程代码执行。从提供的代码片段看，其包含了完整的T3握手逻辑和复杂的Payload构造过程，具有很高的实战验证价值，能够有效检测目标系统是否存在该关键漏洞。利用步骤：1. 环境准备：攻击者需准备一个恶意JRMPListener服务端（通常使用ysoserial的JRMPListener模块）。2. 配置参数：在POC脚本中设置目标WebLogic服务器的IP和端口（默认7001）。3. 执行脚本：运行Python脚本，脚本首先会发送T3协议握手包。4. 漏洞触发：握手成功后，脚本发送精心构造的T3数据包，其中嵌入了指向攻击者JRMP服务端的反序列化对象。5. 命令执行：WebLogic在处理T3请求时反序列化该对象，连接回攻击者的JRMP服务并下载执行恶意字节码。投毒风险分析：该POC代码结构相对透明，主要使用了Python的标准库socket、time和re。代码中虽然包含了大量的十六进制硬编码Payload，但这是反序列化漏洞POC的典型特征，用于模拟复杂的二进制协议。经审计，代码中存在一个注释掉的IP地址'104.251.228.50'，在分析此类POC时需注意是否会自动连接该外部地址。目前的代码逻辑显示其主要行为是向本地或指定的target发送Socket包。风险点在于该POC引用了外部链接（如微信公众号和个人博客），在下载依赖或配套工具时需警惕供应链污染。整体代码未发现明显的后门植入或对分析环境的破坏逻辑，但在执行包含大量Hex串的脚本时，仍建议在沙箱环境下运行，并利用Wireshark监控网络流向，防止Payload中隐藏了反连至非预期IP的指令。

**项目地址:** /tmp/vulnwatchdog_12c56572f2e0537ac5802b4defcf84ad/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
