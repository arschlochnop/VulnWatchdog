# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **30** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-jubeenshah_CVE-2018-15473-Exploit.md)

# CVE-2018-15473

> 📦 该CVE有 **29** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15473-0xNehru_ssh_Enum_vaild.md](../2018/CVE-2018-15473-0xNehru_ssh_Enum_vaild.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #2

**来源**: [CVE-2018-15473-0xrobiul_CVE-2018-15473.md](../2018/CVE-2018-15473-0xrobiul_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #3

**来源**: [CVE-2018-15473-4xolotl_CVE-2018-15473.md](../2018/CVE-2018-15473-4xolotl_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，攻击者可以通过探测不同的用户名，根据响应时间或错误信息差异来判断用户是否存在。

**有效性：** 根据漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高，因为存在公开可用的POC代码，并且多个安全厂商和社区都确认了该漏洞的存在。

**投毒风险：** Dockerfile 中的内容主要用于构建包含易受攻击的 OpenSSH 版本的环境，并创建了两个用户 `vulhub` 和 `example`，用于漏洞测试。创建用户和设置密码的操作属于验证漏洞环境的必要步骤。因此，该Dockerfile本身不像是投毒代码，但考虑到任何代码都存在潜在的风险（例如，精心构造的看似无害的代码），所以存在一定的投毒可能性，预估投毒风险在10%。

**利用方式：** 攻击者可以通过发送包含无效认证信息的 SSH 请求，针对大量用户名进行尝试。由于 OpenSSH 在处理无效用户名时会提前退出，导致与有效用户名的响应时间或错误信息存在差异。通过分析这些差异，攻击者可以枚举出目标系统上的有效用户名。攻击者获得用户名后，便可以配合密码爆破等其他攻击手段尝试登录系统。

**项目地址:** [4xolotl/CVE-2018-15473](https://github.com/4xolotl/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #4

**来源**: [CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md](../2018/CVE-2018-15473-66quentin_shodan-CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致信息泄露，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务端口（默认22）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者枚举目标系统上的有效用户名。该漏洞存在于 OpenSSH 7.7 及更早版本中，由于 OpenSSH 没有延迟对无效身份验证用户的退出，直到包含该请求的数据包被完全解析之后。攻击者可以通过发送特制的 SSH 请求来探测用户名是否存在。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞确实存在于 OpenSSH 7.7 及更早版本中，并且存在可用的利用代码。

提供的 POC 代码包含以下几个文件：

*   `README.md`: 包含脚本的简要说明和使用方法。
*   `cve.py`:  实现了漏洞利用的核心逻辑，通过修改 paramiko 库的行为，判断用户名是否有效。
*   `main.py`:  主脚本，用于从 Shodan 获取 IP 地址列表，并使用 `cve.py` 对这些 IP 地址进行用户枚举。
*   `users.txt`:  包含常用用户名列表，用于进行枚举。

`cve.py`脚本通过篡改`paramiko`库的`MSG_SERVICE_ACCEPT`和`MSG_USERAUTH_FAILURE`消息处理函数，使得服务器在接收到无效用户名时立即响应，从而允许攻击者区分有效和无效的用户名。具体来说，它通过覆盖 `paramiko.message.Message.add_boolean` 函数来改变数据包的结构，并通过自定义的 `invalid_username` 函数在用户名无效时抛出异常。`check_user` 函数尝试使用伪造的公钥对用户进行身份验证，根据是否抛出 `AuthenticationException` 异常来判断用户名是否存在。

**投毒风险分析：**

仔细审查提供的 POC 代码后，发现其中存在轻微的投毒风险。`main.py`脚本需要用户手动填写 Shodan API 密钥，如果用户不小心填写了错误的或者无效的 API 密钥，可能导致脚本运行失败或者泄露密钥信息。此外，`main.py` 从 Shodan 获取大量 IP 地址，并对这些 IP 地址进行扫描，可能被 Shodan 封禁 API 密钥。`cve.py` 脚本修改了 `paramiko` 库的内部行为，可能导致其他使用该库的程序出现异常。
`poison` 设置为 `5%`是因为，脚本中并没有直接的恶意代码（例如删除文件、安装后门等），但是存在可能导致API Key泄露和扫描行为被阻断的情况。因此，评估为较低的投毒风险。

**利用方式：**

1.  准备：安装必要的 Python 库 (paramiko, shodan, argparse)。
2.  配置：在 `main.py` 中填入有效的 Shodan API 密钥。
3.  执行：运行 `main.py` 脚本，它会自动从 Shodan 获取 SSH 服务器的 IP 地址列表，并使用 `cve.py` 脚本对每个 IP 地址进行用户枚举，枚举的用户名列表来自 `users.txt` 文件。
4.  结果：有效的用户名将打印到标准输出。

该漏洞的利用方式相对简单，只需要一个有效的 Shodan API 密钥和目标 SSH 服务器的 IP 地址即可。

**项目地址:** [66quentin/shodan-CVE-2018-15473](https://github.com/66quentin/shodan-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #5

**来源**: [CVE-2018-15473-Alph4Sec_ssh_enum_py.md](../2018/CVE-2018-15473-Alph4Sec_ssh_enum_py.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者通过分析 OpenSSH 服务器对无效和有效用户名请求的响应时间差异来枚举有效的用户名。该漏洞存在于 `auth2-gss.c`, `auth2-hostbased.c` 和 `auth2-pubkey.c` 文件中。

**利用方式：**

1.  攻击者使用提供的 `ssh_enum_py3.py` 脚本，该脚本基于 Python 3 和 Paramiko 库。
2.  脚本首先执行 pre-read banner 以避免 EOF/NoBanner 错误。
3.  然后，脚本针对目标 IP 地址 ( `-i` 参数) 和端口 ( `-p` 参数，默认为 22) 发送 SSH 连接尝试，使用提供的用户名列表 ( `-u` 参数)。
4.  脚本测量每个连接尝试的响应时间。
5.  通过 autotune 功能 ( `-a` 参数) 或手动设置 multiplier ( `-m` 参数) 和 threshold ( `-t` 参数)，脚本确定响应时间的 cutoff 值。
6.  如果某个用户名的响应时间超过 cutoff 值的次数超过 threshold 值，则该用户名被标记为 `likely VALID`，表明该用户可能存在。
7.  如果服务器返回一致的错误响应（例如 "AuthFailed"），则该用户被标记为 `likely INVALID`。

**有效性：**

提供的 POC 代码有效，因为它利用了 OpenSSH 在处理认证请求时的时序差异来判断用户是否存在。多个 exploit-db 链接 (`https://www.exploit-db.com/exploits/45210/`, `https://www.exploit-db.com/exploits/45233/`, `https://www.exploit-db.com/exploits/45939/`) 也表明了该漏洞的可利用性。

**投毒风险：**

代码中存在投毒代码的风险较低。代码主要实现的是一个用户枚举的工具，利用的是响应时间差异。虽然存在通过修改用户名列表等方式进行攻击的可能性，但本身代码的恶意程度较低。README.md 中也强调了要进行伦理使用。但是仍然有很小的风险，比如在autotune的时候篡改 baseline 值导致识别出错，但是这些篡改行为相对隐蔽，所以判定投毒风险为 1%。

**项目地址:** [Alph4Sec/ssh_enum_py](https://github.com/Alph4Sec/ssh_enum_py)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #6

**来源**: [CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md](../2018/CVE-2018-15473-Anonimo501_ssh_enum_users_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 允许攻击者通过发送无效的身份验证请求，根据响应时间上的差异来判断用户名是否存在。OpenSSH 7.7 之前的版本在处理身份验证请求时，对于无效用户的处理逻辑存在缺陷，未在解析完整个数据包后再进行拒绝，导致可以根据服务器的响应时间来推断用户是否存在。漏洞利用代码包含两个脚本：checker_CVE-2018-15473.py 用于检测目标是否存在漏洞，ssh_enum_users2.py 脚本利用漏洞枚举用户。 

**有效性：**  提供的POC代码（checker_CVE-2018-15473.py 和 ssh_enum_users2.py）是有效的，可以用来检测OpenSSH服务器是否存在CVE-2018-15473漏洞并枚举用户名。 checker_CVE-2018-15473.py通过尝试连接SSH服务并根据返回的异常信息判断是否存在漏洞。ssh_enum_users2.py 利用已知用户名列表，尝试连接SSH服务，根据连接成功与否来判断用户是否存在。

**投毒风险：** 代码本身的功能是漏洞检测和利用，但仍存在潜在的风险。
   * **checker_CVE-2018-15473.py:** 脚本尝试连接SSH服务，根据异常判断漏洞是否存在，风险较低。
   * **ssh_enum_users2.py:** 脚本尝试使用用户名字典连接目标SSH服务器，如果攻击者控制了字典文件，可能添加一些恶意payload（例如，尝试使用常见弱密码进行爆破），存在一定的风险。

  总体评估，由于代码的主要功能是用户枚举，直接植入后门代码的可能性较低，但通过篡改用户名字典进行投毒的风险存在，因此，投毒风险评估为 10%。

**利用方式：**
1.  使用 checker_CVE-2018-15473.py 脚本检测目标OpenSSH服务器是否存在CVE-2018-15473漏洞。
2.  如果目标存在漏洞，准备一个用户名列表。
3.  运行 ssh_enum_users2.py 脚本，指定目标IP地址和用户名列表。
4.  脚本会尝试使用用户名列表中的每个用户名连接目标SSH服务器，并根据响应时间或错误信息来判断用户是否存在。

**项目地址:** [Anonimo501/ssh_enum_users_CVE-2018-15473](https://github.com/Anonimo501/ssh_enum_users_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #7

**来源**: [CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md](../2018/CVE-2018-15473-Dirty-Racoon_CVE-2018-15473-py3.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #8

**来源**: [CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md](../2018/CVE-2018-15473-GaboLC98_userenum-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #9

**来源**: [CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md](../2018/CVE-2018-15473-MahdiOsman_CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #10

**来源**: [CVE-2018-15473-Moon1705_easy_security.md](../2018/CVE-2018-15473-Moon1705_easy_security.md)

## CVE-2018-15473-OpenSSH-用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户名枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户名时，不会延迟到数据包完全解析后才终止连接。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器的响应时间来判断用户名是否存在。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞的 POC 代码是有效的。漏洞库信息和搜索结果均表明该漏洞存在，并被广泛关注。提供的代码实现了利用该漏洞进行用户名枚举的功能，通过修改 `paramiko` 库的认证流程，可以区分有效的用户名和无效的用户名。

**投毒风险评估：**

提供的代码仓库主要包含以下几个文件：

*   `Dockerfile`: 用于构建包含所需依赖的 Docker 镜像，例如 Python3、pip、masscan 和 git。没有发现恶意行为。
*   `LICENSE`: MIT 许可证，开源许可，正常。
*   `README.md`: 描述了项目的功能，包括子域名枚举、端口扫描、CVE-2018-15473 利用、SSH 爆破、FTP 爆破和 Nikto 扫描。没有发现恶意行为。
*   `main.py`: 主程序，用于执行各种安全扫描任务，包括子域名枚举、服务扫描和 SSH 爆破。没有发现恶意行为。
*   `requirements.txt`: 列出了项目依赖的 Python 库，包括 paramiko、dnspython、requests 和 tqdm。paramiko 用于 SSH 连接，该文件本身没有恶意。
*   `ssh_brute/ssh_login_brute.py`: 实现了 CVE-2018-15473 漏洞的利用，通过修改 paramiko 库的认证流程来枚举用户名。没有发现额外的恶意代码，主要逻辑是实现漏洞利用本身。

总体而言，代码仓库的目的主要是为了方便地进行安全扫描和漏洞利用，重点在于实现既定的安全工具功能，例如子域名扫描、服务识别和漏洞验证。从代码内容来看，没有发现明显的投毒代码。用于漏洞验证的后门代码不应该被判断为投毒代码。**因此，可以判断投毒风险为0%。**

**利用方式：**

1.  **安装依赖：** 使用提供的 Dockerfile 构建环境或者手动安装 requirements.txt 中的依赖。
2.  **修改 paramiko 库：** `ssh_login_brute.py` 脚本通过修改 `paramiko` 库的 `AuthHandler._handler_table` 和 `paramiko.message.Message.add_boolean` 函数，实现了对 SSH 认证流程的控制。
3.  **发送恶意 SSH 请求：** 脚本会尝试使用不同的用户名进行 SSH 认证，由于修改了 `paramiko` 库，当使用无效用户名时，会触发 `BadUsername` 异常，从而可以区分有效和无效的用户名。
4.  **枚举用户名：** 通过捕获 `BadUsername` 异常，可以判断用户名是否存在于目标系统上，从而实现用户名枚举。
5.  **结合其他工具：** 该漏洞通常与其他攻击手段结合使用。例如，先使用该漏洞枚举用户名，然后使用密码爆破工具尝试破解用户密码。

**项目地址:** [Moon1705/easy_security](https://github.com/Moon1705/easy_security)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #11

**来源**: [CVE-2018-15473-MrDottt_CVE-2018-15473.md](../2018/CVE-2018-15473-MrDottt_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #12

**来源**: [CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md](../2018/CVE-2018-15473-NestyF_SSH_Enum_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能被用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络连通性，目标主机开启SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout 直到完全解析完包含该请求的数据包。攻击者可以利用该漏洞，通过发送特制的 SSH 请求，根据服务器响应时间的不同，判断目标主机上是否存在特定的用户名。

**有效性:**
提供的 POC 代码 `ssh_enum_usr.py` 利用了这一漏洞。它通过尝试使用无效的公钥对不同的用户名进行身份验证，并根据 `AuthenticationException` 异常来判断用户是否存在。如果服务器立即返回 `AuthenticationException`，则表示用户名无效；如果服务器花费一些时间处理请求，则表示用户名有效。因此，提供的 POC 代码是有效的。

**投毒风险:**
分析提供的代码：

*   `README.md` 只是描述了漏洞和利用方法，没有恶意代码。
*   `ssh_enum_usr.py` 主要实现了用户名枚举的功能。其中 `add_boolean` 函数被定义为空函数，旨在防止在认证过程中发送额外的布尔值，这可能是为了避免触发某些安全机制。作者通过修改`paramiko.message.Message.add_boolean`的方式存在一定风险，可能导致其他依赖`paramiko`库的程序出现异常。总体来看，核心的用户名枚举逻辑并没有明显的投毒行为。主要风险在于`paramiko`库的修改可能影响其他程序,以及脚本本身被恶意使用。脚本利用了时间差来判断用户是否存在，这种方法可能受到网络延迟和服务器负载的影响，存在误报的可能。代码中使用 colorama 库来格式化输出，但这不是安全风险。该脚本宣称仅用于教育目的。
*  总体评估，投毒风险较低，约为10%。

**利用方式:**
1.  攻击者首先需要确定目标主机上运行的 OpenSSH 版本小于等于 7.7。
2.  攻击者可以使用 POC 脚本 `ssh_enum_usr.py`，指定目标 IP 地址、端口和用户名列表。
3.  脚本会尝试使用无效的公钥对每个用户名进行身份验证。
4.  根据服务器的响应时间，脚本可以判断用户名是否存在，并将结果输出到控制台。
5.  攻击者可以将枚举到的用户名用于后续的攻击，例如暴力破解密码。

**漏洞修复建议:**
升级 OpenSSH 到 7.8 或更高版本，该版本修复了此漏洞。

**项目地址:** [NestyF/SSH_Enum_CVE-2018-15473](https://github.com/NestyF/SSH_Enum_CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #13

**来源**: [CVE-2018-15473-OmarV4066_SSHEnumKL.md](../2018/CVE-2018-15473-OmarV4066_SSHEnumKL.md)

## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #14

**来源**: [CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md](../2018/CVE-2018-15473-Rhynorater_CVE-2018-15473-Exploit.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #15

**来源**: [CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md](../2018/CVE-2018-15473-SUDORM0X_PoC-CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的远程攻击者通过探测OpenSSH服务器来枚举有效的用户名。此漏洞源于OpenSSH在处理无效用户的身份验证请求时，没有延迟到数据包完全解析完毕才进行处理。攻击者可以发送畸形的公钥身份验证请求。如果用户名无效，服务器会立即返回失败信息；如果用户名有效，服务器在解析畸形数据包时会崩溃或关闭连接，从而通过响应时间的差异或连接状态来区分有效和无效用户。提供的PoC代码 `PoC_CVE-2018-15473.py` 利用了这一漏洞。它通过尝试使用无效的公钥对用户进行身份验证，并根据服务器的响应来判断用户是否存在。该PoC代码支持单个用户名验证和使用用户名列表进行批量验证。 代码中没有发现明显的投毒代码，主要就是连接SSH服务进行用户名爆破，可以初步判定投毒风险为0。

**利用方式：**
1. 运行PoC脚本，指定目标主机、端口（默认为22）和要枚举的用户名或用户名列表。
2. 脚本会尝试使用指定的用户名进行公钥身份验证，但提供的公钥为空字节 `b''`，因此必然失败。
3. 如果服务器返回“Invalid key”的错误信息，则表示该用户名无效。
4. 如果服务器返回“Authentication failed”的错误信息，则表示该用户名有效。
5. 对于用户名列表，脚本会使用多进程并发进行枚举，提高效率。

**项目地址:** [SUDORM0X/PoC-CVE-2018-15473](https://github.com/SUDORM0X/PoC-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #16

**来源**: [CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md](../2018/CVE-2018-15473-Sait-Nuri_CVE-2018-15473.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #17

**来源**: [CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md](../2018/CVE-2018-15473-Wh1t3Fox_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #18

**来源**: [CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md](../2018/CVE-2018-15473-WildfootW_CVE-2018-15473_OpenSSH_7.7.md)

## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供用户名信息

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟无效身份验证用户的退出，导致可以通过时间差判断用户是否存在。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用代码 (ssh-username-enum.py) 通过修改 Paramiko 库来发送畸形的 SSH 数据包，并捕获服务器的响应。如果服务器立即拒绝连接，则表明用户名无效。如果服务器需要更多时间来处理请求，则表明用户名有效。利用方式清晰，针对性强，因此POC代码有效。

**投毒风险：**

漏洞利用代码 (ssh-username-enum.py) 的主要功能是利用 CVE-2018-15473 漏洞进行用户枚举。代码中存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖项：** 该脚本依赖 Paramiko 库。虽然 Paramiko 是一个常用的 SSH 库，但攻击者可能会通过修改 Paramiko 库来引入恶意代码，从而实现远程代码执行或其他恶意行为。在安装依赖项时，应验证库的来源和完整性。
2.  **异常处理：** 代码中使用了 `try...except` 块来处理可能出现的异常，例如连接错误和无效用户名。但是，如果攻击者能够构造特殊的请求，可能会绕过这些异常处理机制，从而导致程序崩溃或执行意外的代码。存在利用漏洞进行拒绝服务攻击的可能性。
3.  **Monkey Patch:** 代码使用了 monkey patch技术修改了`paramiko`内部函数，存在引入未知的安全隐患。虽然代码作者解释了原因，但是仍然需要人工审核确认。

综合以上因素，可以认为该漏洞利用代码存在较低的投毒风险 (5%)。在使用该代码时，应仔细审查代码，并确保从可信的来源获取依赖项。

**利用方式：**

1.  **目标确定：** 确定运行 OpenSSH <= 7.7 的目标主机，并且开放了 SSH 端口（通常为 22）。
2.  **用户名列表准备：** 准备一个可能的用户名列表。这个列表可以包含常见的用户名、目标组织员工姓名等。
3.  **执行漏洞利用代码：** 运行 `ssh-username-enum.py` 脚本，并指定目标主机的 IP 地址和端口，以及用户名列表。
4.  **结果分析：** 脚本会尝试使用每个用户名连接到目标主机，并根据服务器的响应时间判断用户名是否存在。
5.  **后续利用：** 获取有效的用户名列表后，攻击者可以使用其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [WildfootW/CVE-2018-15473_OpenSSH_7.7](https://github.com/WildfootW/CVE-2018-15473_OpenSSH_7.7)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #19

**来源**: [CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md](../2018/CVE-2018-15473-anonymous121029034720384234234_py-network-scanner.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络可达SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过探测OpenSSH服务器来枚举有效的用户名。该漏洞是由于OpenSSH在身份验证过程中，处理无效用户名的方式存在差异导致的。具体来说，服务器在完全解析包含身份验证请求的数据包之前，不会延迟对无效用户的退出处理。这使得攻击者可以通过测量服务器响应时间来区分有效用户名和无效用户名。

**利用方式：**

1.  攻击者向目标OpenSSH服务器发送包含无效用户名的身份验证请求。
2.  攻击者测量服务器的响应时间。
3.  重复上述步骤，尝试不同的用户名。
4.  通过比较响应时间，攻击者可以确定哪些用户名是有效的。

**有效性：**

根据漏洞库信息和Exploit-DB链接（45233, 45210, 45939），该漏洞存在可利用的PoC代码。

**投毒风险：**
提供的代码片段是 `LICENSE` 和 `README.md` 文件，本身不包含任何可执行代码，因此直接的投毒风险较低。`README.md` 文件描述了一个网络扫描和渗透测试工具包，提到了 CVE-2018-15473。如果该工具包的其他部分包含恶意代码，例如后门或信息窃取功能，那么使用该工具包就存在投毒风险。但是仅从提供的文件无法判断，需要分析整个工具包的代码。
综合判断，存在10%的投毒风险，因为无法确定该工具包其他部分的安全性，存在隐藏恶意代码的可能性。

**项目地址:** [anonymous121029034720384234234/py-network-scanner](https://github.com/anonymous121029034720384234234/py-network-scanner)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #20

**来源**: [CVE-2018-15473-coollce_CVE-2018-15473_burte.md](../2018/CVE-2018-15473-coollce_CVE-2018-15473_burte.md)

## CVE-2018-15473 OpenSSH 用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可辅助进一步攻击

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH端口（默认为22）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及更早版本中的一个用户名枚举漏洞。该漏洞允许攻击者通过区分有效和无效用户名的响应时间来枚举目标系统上的有效用户名。 

**有效性：**

提供的 Python 脚本（check.py）通过修改 `paramiko` 库的行为来利用此漏洞。它通过篡改 SSH 协议中的 `MSG_SERVICE_ACCEPT` 消息处理，以及在认证失败时提前抛出异常来实现。脚本通过尝试使用不同的用户名进行身份验证，并根据服务器的响应来判断用户名是否有效。因此，提供的PoC代码是有效的。

**投毒风险：**

检查了提供的 `check.py` 脚本和 `README.md` 文件，未发现任何明显的恶意代码或后门。脚本的功能主要是利用 CVE-2018-15473 漏洞进行用户名枚举。 脚本修改了 paramiko 库的内部函数来探测用户是否存在，没有执行任何额外的恶意操作。脚本中的 random_username_list 列表用于检测目标系统是否易受攻击，以避免将无效的结果报告为有效用户。 所以，投毒风险评估为0%。

**利用方式：**

1.  **安装依赖:**  需要安装`paramiko`库的指定版本（2.4.1）。可以使用`pip install paramiko==2.4.1`命令安装。
2.  **运行脚本:**  使用提供的`check.py`脚本，并指定目标主机名/IP地址、端口以及用户名列表或单个用户名。
3.  **指定目标:** 通过 `--hostname` 参数指定目标主机，`--port` 指定 SSH 端口 (默认 22)。
4.  **选择用户名来源:** 通过 `--username` 指定单个用户名进行验证，或者通过 `--userList` 指定包含用户名列表的文件。
5.  **获取结果:**  脚本将根据服务器的响应判断用户名是否有效，并将结果输出到控制台或指定的文件（通过 `--outputFile` 参数指定）。

总而言之，利用方式是基于 SSH 协议的差异响应，通过发送恶意构造的认证请求探测用户名是否存在。


**项目地址:** [coollce/CVE-2018-15473_burte](https://github.com/coollce/CVE-2018-15473_burte)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #21

**来源**: [CVE-2018-15473-cved-sources_cve-2018-15473.md](../2018/CVE-2018-15473-cved-sources_cve-2018-15473.md)

## CVE-2018-15473-OpenSSH-用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH端口（通常是22）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。该漏洞允许未经身份验证的攻击者通过发送大量无效用户名尝试，根据服务器响应时间差异来判断用户是否存在。

**有效性：** 提供的Dockerfile和脚本旨在创建一个包含易受攻击的OpenSSH版本的Docker容器。脚本`/build/main.sh` 会启动sshd服务, 允许进行漏洞验证。

**投毒风险：**  Dockerfile允许root用户登录，并将sshd配置为在前台运行。在`/build/main.sh`中，脚本只是不断重启sshd服务。虽然这些配置在生产环境中是不安全的，但是根据本次任务要求，考虑到本次任务重点在于验证POC，因此不应被简单判定为投毒。但是`PermitRootLogin yes` 属于危险配置，提高了被恶意利用的风险，给予10%的投毒风险评估。

**利用方式：** 攻击者可以利用此漏洞发送大量的SSH认证请求，其中包含不同的用户名。由于存在漏洞，OpenSSH会在身份验证过程的不同阶段对有效和无效用户做出不同的响应。攻击者可以通过测量这些响应的时间差异来判断用户是否存在。利用此漏洞不需要任何有效的凭据，只需能够连接到目标SSH服务器即可。这为后续的攻击，例如暴力破解密码，提供了目标用户列表。

**项目地址:** [cved-sources/cve-2018-15473](https://github.com/cved-sources/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #22

**来源**: [CVE-2018-15473-epi052_cve-2018-15473.md](../2018/CVE-2018-15473-epi052_cve-2018-15473.md)

## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开启SSH服务，且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是OpenSSH 7.7及更早版本中的一个用户枚举漏洞。此漏洞的产生原因是OpenSSH没有延迟对无效认证用户的退出，直到包含请求的数据包被完全解析之后。攻击者可以通过发送无效的认证请求，根据响应时间或者其他差异来判断用户名是否存在。

**漏洞利用的有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞是有效的。漏洞库信息明确指出OpenSSH 7.7及更早版本存在此漏洞，并且提供了多个引用链接，包括漏洞利用代码的链接。搜索引擎结果也显示了多个安全厂商和组织对该漏洞的确认和描述。提供的漏洞利用代码（`ssh-username-enum.py`）是一个Python脚本，可以利用此漏洞枚举用户名。

**投毒风险分析：**

该漏洞利用代码（`ssh-username-enum.py`）本身的功能是利用OpenSSH的用户枚举漏洞。代码主要流程是：

1.  连接到目标SSH服务器。
2.  发送无效的SSH认证请求，其中包含待测试的用户名。
3.  根据服务器的响应判断用户名是否存在。

代码中未发现明显的恶意行为，例如植入后门、篡改系统文件或者执行恶意命令。`requirements.txt`中依赖的库都是常用的Python库，例如`paramiko`用于SSH客户端功能。 `LICENSE`文件是MIT协议，比较宽松的开源协议

但是，任何漏洞利用代码都可能被滥用。攻击者可以使用此代码枚举用户名，然后结合其他漏洞或者暴力破解来进一步攻击系统。因此，使用此代码需要谨慎，并且仅在授权的环境下进行。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，初步评估为10%。主要基于以下考虑：

*   代码功能明确，实现用户枚举。
*   依赖库常用，无恶意库。
*   代码逻辑相对简单，易于审计。
*   MIT协议，作者不承担责任。

需要注意的是，这只是初步评估，不能完全排除投毒的可能性。如果使用此代码，建议进行详细的代码审计，确保其安全性。

**漏洞利用方式：**

1.  攻击者使用`ssh-username-enum.py`脚本，指定目标IP地址和用户名列表（或单个用户名）。
2.  脚本会尝试使用用户名进行SSH认证。
3.  如果用户名存在，OpenSSH服务器会返回一个特定的响应，表明用户名有效。如果用户名不存在，OpenSSH服务器会返回不同的响应。
4.  攻击者通过分析响应的差异，判断用户名是否存在。
5.  攻击者重复此过程，枚举目标系统上的所有用户名。

攻击者获得用户名列表后，可以尝试使用暴力破解、密码喷洒等技术来获取用户密码，从而进一步入侵系统。

**项目地址:** [epi052/cve-2018-15473](https://github.com/epi052/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #23

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #24

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---



---

## POC #24

**来源**: [CVE-2018-15473-makmour_open-ssh-user-enumeration.md](../2018/CVE-2018-15473-makmour_open-ssh-user-enumeration.md)

## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #25

**来源**: [CVE-2018-15473-mclbn_docker-cve-2018-15473.md](../2018/CVE-2018-15473-mclbn_docker-cve-2018-15473.md)

## CVE-2018-15473-OpenSSH用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenSSH 7.7及更早版本中。由于OpenSSH在完全解析包含请求的包之前，不会延迟无效身份验证用户的退出，攻击者可以通过发送伪造的SSH请求并观察响应时间来枚举有效的用户名。提供的Dockerfile构建了一个易受攻击的OpenSSH 7.3p1实例，用于测试用户枚举漏洞。docker-compose文件用于快速部署环境。 README.md提供了基本的使用说明。

**有效性:**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码有效。漏洞库信息明确指出OpenSSH <= 7.7存在用户枚举漏洞，搜索引擎结果也证实了这一点，并指向了多个相关的漏洞分析和利用资源。提供的Dockerfile构建了一个包含易受攻击的OpenSSH 7.3p1版本的Docker镜像，可以用于验证该漏洞。

**投毒风险:**

对提供的Dockerfile、docker-compose.yml、CentOS-Base.repo和README.md文件进行分析，没有发现明显的投毒代码。Dockerfile中的操作都是标准的软件安装和配置步骤，没有执行任何恶意操作。docker-compose.yml文件只是用于定义Docker服务的配置，也没有包含任何恶意代码。CentOS-Base.repo文件指向CentOS的官方软件仓库，不包含任何恶意软件。README.md文件只是提供了使用说明，也没有包含任何恶意代码。因此，可以认为此仓库中不存在作者隐藏的投毒代码。

**利用方式:**

1.  攻击者通过网络连接到目标OpenSSH服务。
2.  攻击者发送伪造的SSH请求，尝试使用不同的用户名进行身份验证。
3.  OpenSSH服务在处理请求时，对于无效用户名会立即返回错误信息，而对于有效用户名则会进行后续处理。
4.  攻击者通过观察响应时间或错误信息的差异，来判断用户名是否有效。
5.  通过重复上述步骤，攻击者可以枚举出目标系统上存在的用户名。

此漏洞本身不能直接导致系统被完全控制，但枚举出的用户名可以为后续的密码破解、社会工程等攻击提供有价值的信息。

**项目地址:** [mclbn/docker-cve-2018-15473](https://github.com/mclbn/docker-cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #26

**来源**: [CVE-2018-15473-moften_cve-2018-15473-poc.md](../2018/CVE-2018-15473-moften_cve-2018-15473-poc.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #27

**来源**: [CVE-2018-15473-philippedixon_CVE-2018-15473.md](../2018/CVE-2018-15473-philippedixon_CVE-2018-15473.md)

## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #28

**来源**: [CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md](../2018/CVE-2018-15473-pyperanger_CVE-2018-15473_exploit.md)

## CVE-2018-15473 - OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露用户名信息，增加暴力破解或社工攻击的成功率

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7，且可以建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及之前版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，不会延迟 bailout，导致攻击者可以通过观察服务器的响应时间差异来判断目标服务器上是否存在特定用户。提供的漏洞利用代码通过构造畸形的 SSH 数据包，并根据服务器返回的错误信息（Packet integrity error）来判断用户是否存在。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断此漏洞利用代码有效。搜索结果中的多个条目均指出了该漏洞的存在，并且提供了漏洞利用的相关信息。漏洞利用代码本身也实现了利用该漏洞进行用户枚举的逻辑。

**投毒风险评估：**

分析提供的 Perl 漏洞利用代码，该代码主要功能是构造畸形的 SSH 数据包来触发漏洞，没有发现明显的恶意代码或后门。该脚本通过修改 `Net::SSH::Perl::Auth::PublicKey::_sign_send_pubkey` 函数来发送畸形数据包，并通过hook `Net::SSH::Perl::Packet::croak`函数来判断目标是否存在用户。虽然修改了标准库函数，但是没有发现任何写入文件、执行系统命令等恶意行为。因此，可以认为该仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** OpenSSH 在处理用户身份验证请求时，如果用户不存在，会立即返回错误信息，而不会像处理存在的用户那样，继续进行后续的身份验证步骤。这个时间差异可以被攻击者利用。
2.  **利用步骤：**
    *   首先，需要安装 `Net::SSH::Perl` 模块以及相关的依赖。
    *   然后，运行提供的 Perl 脚本，指定要枚举的用户名和目标主机 IP 地址。例如：`perl CVE-2018-15473.pl root 192.168.1.100`
    *   脚本会尝试使用指定的用户名进行 SSH 身份验证，但会发送一个畸形的数据包。
    *   如果服务器返回 "Packet integrity error"，则表示该用户存在；否则，表示该用户不存在。
3.  **缓解措施：**
    *   升级 OpenSSH 到 7.8 或更高版本。
    *   使用 fail2ban 等工具来限制 SSH 身份验证尝试的频率。
    *   禁用用户名密码登录，使用 SSH 密钥进行身份验证。


**项目地址:** [pyperanger/CVE-2018-15473_exploit](https://github.com/pyperanger/CVE-2018-15473_exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #29

**来源**: [CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md](../2018/CVE-2018-15473-sergiovks_SSH-User-Enum-Python3-CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可用于后续的暴力破解或其他攻击

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH <= 7.7 版本中的一个用户名枚举漏洞。 由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出，攻击者可以通过观察服务器的响应时间来判断用户名是否存在。 漏洞利用方式：攻击者可以发送大量带有不同用户名的认证请求，通过时间差来判断用户是否存在。提供的漏洞利用代码只是一个CC0协议声明文件，不包含任何可执行代码，因此无法直接验证漏洞的有效性。但是根据漏洞库信息和搜索结果，可以确认该漏洞的存在和利用方式。因为提供的漏洞利用代码只是一个LICENSE文件，所以仓库中不存在作者隐藏的投毒代码的风险。

**项目地址:** [sergiovks/SSH-User-Enum-Python3-CVE-2018-15473](https://github.com/sergiovks/SSH-User-Enum-Python3-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

## POC #30

**来源**: [CVE-2018-15473-yZ1337_CVE-2018-15473.md](../2018/CVE-2018-15473-yZ1337_CVE-2018-15473.md)

## CVE-2018-15473-OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，信息泄露

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞存在于 OpenSSH 7.7 及更早版本中，允许未经授权的远程攻击者枚举有效用户名。该漏洞的根源在于 OpenSSH 没有延迟对无效用户的认证请求的处理，从而导致可以通过时间差异来判断用户名是否存在。

**有效性评估：**

提供的 Python 脚本 `CVE-2018-15473.py` 是一个利用此漏洞的 PoC 代码。它通过修改 `paramiko` 库的函数，并发送特制的 SSH 认证请求，根据服务器的响应时间来判断用户名是否存在。根据搜索引擎结果，以及漏洞描述，该PoC的思路是成立的，可以验证用户枚举漏洞。

**投毒风险评估：**

查看脚本内容。该脚本主要修改了 paramiko 库的处理函数，目的是为了利用时间差来判断用户名是否存在，未发现存在恶意代码或后门，判断投毒风险为 0%。 脚本包含一个LICENSE文件声明使用GNU GPL v3 协议。

**利用方式分析：**

1.  **目标确认：** 确定运行 OpenSSH 7.7 或更早版本的服务器。
2.  **PoC 准备：** 准备包含用户名列表的 wordlist 文件，或指定单个用户名。
3.  **执行 PoC：** 运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和端口，以及用户名列表或单个用户名。
4.  **结果分析：** 脚本会根据服务器的响应时间，判断用户名是否存在，并将结果打印出来。

**防御措施：**

*   升级 OpenSSH 到 7.8 或更高版本。
*   配置 SSH 失败尝试次数限制，防止暴力破解。
*   使用 fail2ban 等工具，自动屏蔽恶意 IP 地址。

**项目地址:** [yZ1337/CVE-2018-15473](https://github.com/yZ1337/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)

---

