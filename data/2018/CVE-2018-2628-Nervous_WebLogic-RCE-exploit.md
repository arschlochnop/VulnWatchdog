## CVE-2018-2628 - Oracle WebLogic Server (WLS Core Components) 反序列化远程代码执行 (RCE)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** 反序列化远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server (WLS Core Components)

**危害等级:** Critical

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 远程攻击者无需经过身份验证，但需要通过T3协议网络访问目标服务器端口（默认7001）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本是一个针对Oracle WebLogic T3协议反序列化漏洞的利用工具。通过分析代码，脚本构建了特定的T3协议握手包和经过序列化的Java对象。核心原理是利用WebLogic在处理T3协议通信时，未对入参对象进行严格过滤，导致攻击者可以绕过之前的黑名单补丁（如CVE-2015-4852的修复），通过精心构造的JRMPClient对象触发二次反序列化。此脚本支持多种功能：1. 自动处理T3握手协议；2. 支持SSL（T3s）加密通信；3. 提供命令执行（-c 参数）和操作系统类型选择（-o 参数）；4. 甚至集成了Webshell部署功能（-w 参数）。从代码逻辑看，它完整实现了从握手到Payload发送的过程，其结构清晰，使用了Python的标准socket、ssl和binascii库。对于防御者而言，该POC不仅能验证漏洞存在，还能模拟攻击者通过T3协议建立隧道并注入恶意对象的过程。利用步骤：首先，攻击者需确认目标服务器7001端口开放并运行WebLogic服务；其次，根据目标环境选择Payload（通常配合JRMPListener使用）；最后，运行脚本指定目标IP、端口、命令及相关参数。由于WLS Core Components中涉及的InboundMsgAbbrev和OutboundMsgAbbrev类存在设计缺陷，该脚本能有效穿透防护逻辑执行系统命令。投毒风险分析：经过对POC源代码的深度审计，未发现明显的恶意混淆代码、隐藏的二段下载载荷或针对执行者本机的反向连接行为。代码逻辑透明，主要使用了标准库进行网络通信。然而，该脚本包含了一个大段的硬编码十六进制字符串（packet变量），这是典型的二进制Payload封装方式。虽然这在漏洞利用程序中是标准做法，但对于安全研究员来说，这属于‘黑盒’部分，理论上可以隐藏针对研究员终端的定向攻击Payload（例如利用本地Python反序列化漏洞）。此外，脚本中提供的Webshell部署功能（-w 参数）由于涉及外部URL下载或特定JSPX代码写入，存在被篡改指向恶意源的风险。整体来看，该POC属于高质量、功能集成的安全研究工具，投毒风险较低，但在执行硬编码的十六进制Packet前，建议在隔离的沙箱环境中监控其网络流向，防止其在利用成功后偷偷向第三方地址发送敏感信息。由于其能够直接实现RCE，该脚本本身具有极高的杀伤力，在组织内部测试时应严格控制传播范围。

**项目地址:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
