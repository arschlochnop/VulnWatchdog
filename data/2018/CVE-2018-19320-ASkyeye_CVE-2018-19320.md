## CVE-2018-19320 - Gigabyte App Center, Cloud Station Server, GIGABYTE LAN Optimizer 权限提升 (Elevation of Privilege)

**漏洞编号:** CVE-2018-19320

**漏洞类型:** 权限提升 (Elevation of Privilege)

**影响应用:** Gigabyte App Center, Cloud Station Server, GIGABYTE LAN Optimizer

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Gigabyte GPCIDRV.sys 1.02 及更早版本

**利用条件:** 本地访问权限、低权限用户即可触发

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

CVE-2018-19320 存在于技嘉（Gigabyte）某些驱动程序中，特别是 gpcidrv.sys。该驱动程序公开了一个 ring0 级别的类 memcpy 功能，允许低权限的本地攻击者直接读写内核内存。通过这种能力，攻击者可以篡改关键的内核数据结构，例如禁用驱动程序强制签名（Driver Signing Enforcement, DSE），从而加载未经签名的恶意驱动程序。POC有效性分析：提供的代码为一个 Visual Studio 工程，包含了 Gigabyte_CI 核心逻辑。该代码片段显示其尝试通过特定的 IOCTL 控制码与驱动程序通信。经过分析，该 POC 通过定位内核中的系统变量（如 g_CiOptions）并将其修改为 0，从而绕过 Windows 的安全防御机制。利用步骤：1. 确保目标系统安装了受影响的技嘉驱动程序。2. 编译并运行 POC 代码。3. POC 将利用设备句柄发送 IOCTL 请求。4. 驱动程序接收请求后，在内核层执行内存拷贝，将 DSE 标志位清零。5. 攻击者此时可以加载任意未签名的驱动。投毒风险分析：该仓库代码结构清晰，使用了标准的 Visual Studio 项目文件（.sln, .vcxproj），且代码风格符合典型的安全研究开源规范。README 文档提供了明确的参考链接，指向了知名的安全机构 SecureAuth。代码中未发现混淆混淆、反调试、隐蔽网络连接或异常的文件删除行为。主要的风险点在于该漏洞常被勒索软件（如 RobbinHood）用于自带易受攻击驱动（BYOVD）攻击，因此在分析此类工具时需警惕其是否集成了恶意 payload 释放器。当前分析的代码片段显示其仅为功能性的概念验证。15% 的风险评分主要源于安全工具库常见的被恶意篡改可能，而非代码本身的恶意性。

**项目地址:** [https://github.com/BeyondBinary/CVE-2018-19320](https://www.google.com/search?q=https://github.com/BeyondBinary/CVE-2018-19320)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-19320](https://nvd.nist.gov/vuln/detail/CVE-2018-19320)
