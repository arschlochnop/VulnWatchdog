## CVE-2018-9206 - Blueimp jQuery-File-Upload 任意文件上传 (Arbitrary File Upload)

**漏洞编号:** CVE-2018-9206

**漏洞类型:** 任意文件上传 (Arbitrary File Upload)

**影响应用:** Blueimp jQuery-File-Upload

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 9.22.0

**利用条件:** Web服务器开启PHP支持且未禁用上传目录的脚本执行权限，通常与Apache配置有关。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：本漏洞源于jQuery-File-Upload组件中server/php/UploadHandler.php文件对文件上传校验不严。该组件在默认配置下允许用户上传任意类型文件到服务器。由于早期版本中缺乏对PHP文件的有效过滤，攻击者可以直接上传包含恶意Payload的PHP脚本。本次分析提供的POC代码是一个基于Docker的漏洞环境构建脚本（Dockerfile），其通过加载Ubuntu镜像并安装Apache2与PHP7.2，人为将含有漏洞的jquery-file-upload-9.0.0版本部署在/var/www/html目录下。通过对Dockerfile的审计，确认其主要目的是搭建靶场环境。利用步骤如下：1. 启动Docker容器暴露80端口；2. 访问/jquery-upload-file/server/php/接口；3. 使用HTTP POST请求向该接口发送一个Content-Type为multipart/form-data的文件包，文件名后缀为.php；4. 成功上传后，根据返回的JSON响应获取文件存储路径；5. 直接访问上传的.php文件即可实现远程代码执行。此POC有效性极高，属于标准的利用环境复现脚本。投毒风险分析：该POC项目来源于cved-sources，这是一个知名的开源漏洞环境收集项目。通过对Dockerfile内容及相关build目录文件的深度扫描，未发现混淆代码、非法反弹Shell、隐藏的二进制后门或恶意的外部下载行为。Dockerfile中使用的apt-get源为官方或标准源，环境配置指令透明，主要针对PHP的short_open_tag和错误报告进行了微调，以确保漏洞利用的演示效果。尽管仓库引用了外部GitHub地址（lcashdol/Exploits），但目前下载的构建指令均基于本地文件拷贝，不涉及实时拉取未验证的远程脚本，因此投毒风险极低（10%）。此类风险主要存在于用户自行修改build目录下的jQuery源代码并在其中植入Webshell。作为防御方，应重点监控服务器上jQuery上传路径中的可执行文件生成，并确保UploadHandler.php已升级至9.22.1以上版本，或在Web服务器层面禁用上传目录的PHP执行权限。

**项目地址:** [https://github.com/cved-sources/cve-2018-9206](https://github.com/cved-sources/cve-2018-9206)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-9206](https://nvd.nist.gov/vuln/detail/CVE-2018-9206)
