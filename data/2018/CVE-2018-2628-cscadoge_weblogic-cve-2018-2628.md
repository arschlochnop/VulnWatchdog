## CVE-2018-2628 - Oracle WebLogic Server (Fusion Middleware) 反序列化远程代码执行 (RCE)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** 反序列化远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server (Fusion Middleware)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 可通过网络访问WebLogic T3协议端口（默认7001），且无需身份验证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC代码是针对Oracle WebLogic Server T3协议反序列化漏洞的完整实现。其核心逻辑在于利用T3协议握手（74332031...）建立连接，并构造特定的T3协议请求包。代码中通过外部调用ysoserial工具生成包含JRMPClient的恶意Payload，强制受害者服务器向攻击者控制的JRMPListener发起连接。这种‘绕过式’利用方法针对的是WebLogic对内部类过滤不严的缺陷。经过代码审计，该Python脚本结构清晰，使用了socket、binascii等标准库，且逻辑符合CVE-2018-2628的利用路径：首先进行T3握手，然后发送经过序列化的包含攻击载荷的Object数据包。利用步骤如下：1. 在攻击者机器（hacker-server）上运行ysoserial.exploit.JRMPListener，监听特定端口（如2333）并设置要执行的命令。2. 在另一终端执行此Python脚本，参数包括目标WebLogic IP、端口、ysoserial路径、攻击者IP、监听端口及JRMPClient模式。3. 脚本会自动完成T3握手并注入载荷，诱导WebLogic反向连接监听端，从而触发命令执行。投毒风险分析：该POC代码展现了极高的透明度。其核心功能逻辑（生成Payload、建立T3握手、发送数据）全部明文展示，未发现任何代码混淆、base64加密的恶意指令或隐藏的网络外连行为。脚本中的os.system调用明确指向了用户指定的ysoserial路径，属于正常的利用工具调用，不构成投毒风险。代码中没有发现任何试图窃取本地环境变量、SSH密钥或向第三方服务器发送敏感数据的片段。虽然脚本包含提示用户从GitHub下载ysoserial的注释，但那是已知的安全社区工具地址，不属于恶意投毒范畴。总体而言，该代码是标准的防御性研究POC，主要用于漏洞复现和安全合规性扫描，投毒风险极低，仅需注意确保使用的ysoserial.jar文件来源可靠即可。

**项目地址:** [https://github.com/brianwrf/ysoserial/releases](https://www.google.com/search?q=https://github.com/brianwrf/ysoserial/releases)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
