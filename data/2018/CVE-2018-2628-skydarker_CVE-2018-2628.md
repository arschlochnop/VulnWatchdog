## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 可通过T3协议访问WebLogic Server端口（默认7001）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对Oracle WebLogic Server的T3协议反序列化漏洞（CVE-2018-2628）编写。代码逻辑清晰，首先通过硬编码的十六进制字节流（74332031322e322e31...）模拟T3协议的握手过程。如果服务器返回包含协议响应，则认为握手成功。随后，POC构造了一个包含恶意反序列化Payload的T3请求。观察PAYLOAD数组，其中的十六进制数据以'ACED0005'开头，这是Java序列化内容的标准头部。Payload中包含了'java.rmi.activation.Activator'等类名，这符合CVE-2018-2628利用RMI绕过WebLogic黑名单限制的典型特征。该POC通过直接操作Socket层发送精心构造的字节流，能够有效绕过部分应用层防火墙，具备很高的利用成功率。利用步骤：1. 环境准备：确保攻击机安装有Python 2.7环境。2. 目标确认：确认目标WebLogic服务器的T3协议端口（通常为7001）对外开放。3. 执行脚本：修改POC中的目标IP和端口，执行python weblogic_poc.py。4. 漏洞确认：脚本会输出'handshake successful'并发送Payload，如果目标存在漏洞且未安装补丁，则会触发远程代码执行。投毒风险分析：经过对POC源代码的审计，该脚本主要由标准的Python socket、time、re库组成，没有引入外部可疑依赖。脚本中的PAYLOAD是以硬编码十六进制字符串形式存在的，其内容指向的是Java反序列化对象。在代码注释部分发现了一个被注释掉的远程IP（104.251.228.50），这在公开POC中较为常见，通常是原作者测试时留下的痕迹，不直接等同于恶意回连。脚本逻辑中不存在读取本地敏感文件、删除系统文件或向远程服务器发送当前机器信息的恶意代码。唯一潜在的风险点在于反序列化Payload本身的黑盒性质，但在合法的防御性研究中，通过十六进制解析可见其为标准的RMI绕过利用链，而非针对研究人员主机的后门。综合评估，该POC代码逻辑透明，未见混淆或明显的恶意投毒行为，投毒风险等级为低（15%），属于正常的安全研究脚本。

**项目地址:** [https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2018-2628](https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
