## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 通过T3协议进行网络访问，无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞是Oracle WebLogic Server中T3协议处理过程中的反序列化漏洞。虽然Oracle此前曾针对CVE-2017-3248发布过补丁，但CVE-2018-2628通过利用java.rmi.activation.Activator或weblogic.jms.common.StreamMessageImpl等不同的绕过方式，重新实现了对JRMP（Java Remote Method Protocol）客户端的调用，从而绕过了黑名单限制。本次分析的POC代码结构非常完整，包含了一个基于Python的渗透测试脚本wls-cve-2018-2628-poc.py以及一个魔改版的ysoserial工具包。其核心逻辑清晰：首先，利用ysoserial中的JRMPListener在攻击者机器上开启监听并绑定执行命令；其次，通过POC脚本向目标WebLogic服务器的T3端口发送精心构造的序列化对象；最后，目标服务器在反序列化过程中会回调攻击者的JRMPListener，导致远程代码执行。经过对代码逻辑的审计，该POC直接操作T3协议头和序列化数据流，与披露的漏洞机理完全吻合，具备极高的实战有效性。利用步骤：1. 准备攻击环境，确保安装Python 2.7和JDK 1.7+。2. 部署JRMPListener，使用命令`java -cp ysoserial.jar ysoserial.exploit.JRMPListener [Port] [Gadget] [Command]`，例如在公网IP开启22801端口监听。3. 生成Payload字符串，利用JRMPClient2或JRMPClient3模块生成对应的Hex编码序列化对象。4. 修改Python脚本中的payload_str变量，填入上一步生成的Hex字符串。5. 执行攻击脚本：`python wls-cve-2018-2628-poc.py [Target_IP] [Target_Port]`。投毒风险分析：经过对提供的POC文件和配套JAR包描述的深度扫描，该项目属于透明度较高的开源研究成果。投毒风险评估为10%，属于低风险范畴。其原因如下：首先，README文档详尽，明确标注了贡献者信息（如知名研究员xxlegend、badcode）和引用来源（ysoserial），符合安全社区的规范。其次，POC脚本采用Python编写，代码逻辑直观，未发现任何混淆处理、Base64隐藏指令或异常的外部网络请求（除漏洞利用必须的T3通信和JRMP回调外）。尽管该项目提供的Release包含二进制JAR文件，通常这类文件存在静默执行后门的风险，但基于其在安全社区的广泛传播和代码逻辑的匹配度，该JAR包更像是针对WebLogic环境定制化的ysoserial工具。对于企业防御者，建议在沙箱环境中运行此类JAR包，并监控其是否产生非预期的外连请求。POC中提及的阿里云IP仅为文档示例，用户在使用时需替换为自己的监听地址。整体而言，该代码库更倾向于防御性研究工具而非恶意投毒样本。

**项目地址:** [https://github.com/tdy218/ysoserial-cve-2018-2628](https://github.com/tdy218/ysoserial-cve-2018-2628)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
