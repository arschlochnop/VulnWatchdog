## CVE-2018-19320 - Gigabyte App Center (GDRV.SYS) 内核提权/内存读取注入

**漏洞编号:** CVE-2018-19320

**漏洞类型:** 内核提权/内存读取注入

**影响应用:** Gigabyte App Center (GDRV.SYS)

**危害等级:** 高危

**CVSS评分:** CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (7.8)

**影响版本:** Gigabyte App Center v1.05.21 及更早版本中的 gdrv.sys 驱动

**利用条件:** 需要本地访问权限，能够加载或与已安装的受影响驱动程序通信

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码展现了一个典型的驱动加载器（GDRVLoader），旨在利用CVE-2018-19320漏洞。该漏洞存在于技嘉（Gigabyte）已签名的gdrv.sys驱动程序中，其暴露了类似于memcpy的ring0内存读写功能，允许具有弱权限的用户向内核地址空间写入数据。分析提供的源代码发现，项目结构完整，包含C++源文件（GDRVLoader.cpp）及完整的Visual Studio解决方案文件（.sln, .vcxproj）。核心逻辑通过DropDriverFromBytes函数释放驱动镜像到磁盘，并调用WindLoadDriver尝试加载目标驱动。这种技术通常被黑客用于‘Bring Your Own Vulnerable Driver’ (BYOVD) 攻击，即通过合法但有漏洞的签名驱动来绕过操作系统的驱动程序强制签名（DSE）保护，从而在内核层运行恶意代码。从防御角度看，该POC功能聚焦于驱动的加载与卸载控制流，是一个高度有效的漏洞验证工具。利用步骤：1. 编译GDRVLoader项目生成可执行文件；2. 准备一个待加载的未签名驱动程序；3. 在命令行执行程序，参数为目标驱动路径；4. 根据提示输入'LOAD'，程序将首先释放有漏洞的gdrv.sys驱动，利用其内核写权限关闭系统的DSE检查，随后加载未经签名的目标驱动。投毒风险分析：对该POC代码及项目文件进行静态审计，发现其代码风格简洁、逻辑透明，符合安全研究工具的特征。代码主要使用标准Windows API（如DeleteFile, printf）和自定义的驱动管理函数。风险点主要在于`#include "binary/dropper.h"`，这表明项目中嵌入了二进制字节数组，通常用于在运行时释放gdrv.sys驱动文件。虽然在本语境下这是为了实现漏洞利用自动化，但这种‘释放器’（Dropper）行为在行为分析引擎中常被标记为高风险恶意特征。然而，未发现代码中存在混淆混淆手段、反调试技巧或向外部服务器发送敏感信息的异常网络连接。该项目在GitHub上属于公开的漏洞研究仓库（如BeyondBinary），主要是为了记录和演示如何禁用DSE。总体而言，该代码作为安全研究用途的风险较低，但在生产环境中应警惕此类BYOVD工具的使用，因为它们是勒索软件（如RobbinHood）常用的攻击媒介。防御团队应重点监控C:\Windows\System32\Drivers\gdrv.sys的创建行为，并利用微软提供的驱动程序阻止列表进行拦截。

**项目地址:** [https://github.com/BeyondBinary/CVE-2018-19320](https://www.google.com/search?q=https://github.com/BeyondBinary/CVE-2018-19320)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-19320](https://nvd.nist.gov/vuln/detail/CVE-2018-19320)
