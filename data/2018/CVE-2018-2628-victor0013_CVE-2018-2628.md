## CVE-2018-2628 - Oracle WebLogic Server RCE (远程代码执行)

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 目标服务器开启T3协议且未安装相应安全补丁，攻击者需能直接访问WebLogic服务端口(默认7001)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】：此POC代码展示了针对CVE-2018-2628的典型JNDI注入与JRMP监听攻击路径。有效性核心在于利用了WebLogic T3协议在处理RMI调用时的反序列化漏洞。POC文档详细列出了利用步骤：首先使用ysoserial工具在攻击者控制的服务器上启动JRMPListener，指定相应的Payload（如CommonsCollections1）并设置待执行的系统命令；随后使用特定的Python脚本（CVE-2018-2628.py）向目标WebLogic服务器发送精心构造的T3协议封包。该封包会诱导目标服务器回连至攻击者的JRMPListener，从而触发本地的反序列化操作，执行Payload中封装的命令。从POC代码片段看，其依赖项明确（ysoserial、nc等），利用逻辑符合该漏洞的公认技术方案，具备极高的实战参考价值和复现成功率。该漏洞的根源在于WebLogic对T3协议数据流中的对象缺乏足够的黑名单过滤，导致攻击者可以绕过之前的补丁，通过JRMP远程对象实现绕过限制的类加载。利用步骤如下：1. 在JRMP主机下载并运行ysoserial.jar，开启指定端口的监听并绑定恶意Payload；2. 在攻击者主机启动nc监听反弹端口；3. 执行Python脚本指向目标WebLogic IP和端口。验证完成后可获得系统级权限 shell。 【投毒风险分析】：在对该POC及相关脚本进行安全性评估时，投毒风险评定为低（约15%）。主要的风险点在于：第一，POC中引用的‘ysoserial-master.jar’是从JitPack等第三方自动化构建平台下载的。虽然ysoserial本身是著名的开源安全工具，但如果下载源被篡改或使用了非官方维护的镜像，生成的Jar包可能被植入后门。防御者在复现时应优先从官方GitHub仓库自行编译。第二，POC中的Python脚本（CVE-2018-2628.py）未提供完整源码，在安全研究领域，此类脚本经常被恶意攻击者用来捆绑‘二段投毒’，例如在执行攻击载荷的同时，偷偷将研究员的主机信息上传至远程服务器，或者在Payload中私自添加额外的C2指令。第三，文档中提及的外部图片链接和gitter聊天插件虽为正常项目标识，但在极端环境下可能被用于流量统计。总体而言，该POC代码逻辑清晰，主要动作集中在标准的网络交互和Java反序列化负载上，未发现明显的恶意混淆代码或异常的系统敏感操作，风险处于受控范围，但建议在隔离的沙箱环境中使用自行审查过的脚本源码进行测试。

**项目地址:** [https://github.com/frohoff/ysoserial](https://github.com/frohoff/ysoserial)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
