## CVE-2018-9206 - blueimp jQuery File Upload 任意文件上传 (Arbitrary File Upload)

**漏洞编号:** CVE-2018-9206

**漏洞类型:** 任意文件上传 (Arbitrary File Upload)

**影响应用:** blueimp jQuery File Upload

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 9.22.0

**利用条件:** 服务器部署了 blueimp jQuery File Upload 插件，且 PHP 处理脚本（如 server/php/upload.class.php）处于可访问状态，且 Web 目录具有写入权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该提供的 Python 脚本是一个针对 CVE-2018-9206 的高度自动化且功能完整的利用工具。脚本通过探测常见的文件上传路径（如 /server/php/upload.class.php）来确认目标是否存在漏洞。漏洞的核心原因在于 blueimp jQuery File Upload 插件在默认配置下，其 PHP 上传处理器没有对上传文件的扩展名进行严格过滤，允许攻击者直接上传包含 PHP 代码的文件（如 .php 脚本）。脚本首先使用 HTTP HEAD 请求探测可能存在的上传接口，随后构造一个 multipart/form-data 的 POST 请求，模拟文件上传行为，将名为 'shell.php' 的文件上传到服务器。上传的内容是一个简单的 WebShell：<?php system($_GET['cmd']); ?>。脚本随后会自动在预定义的输出目录（如 /server/php/files/）中尝试访问该 WebShell，并通过发送 'id' 命令来验证利用是否成功。代码结构清晰，利用逻辑符合该漏洞的经典攻击路径，具有极高的实战有效性。\n\n【利用步骤】1. 环境准备：确定目标服务器运行着版本小于或等于 9.22.0 的 blueimp jQuery File Upload 插件。2. 路径发现：通过脚本提供的 PATHS 列表对目标主机进行路径枚举，确认上传接口地址。3. 漏洞触发：脚本向确定的上传接口发送 POST 请求，携带名为 files[] 的文件负载，其中包含恶意 PHP 代码。4. 权限维持：上传成功后，插件通常会将文件保存在服务器的 files 目录下。脚本通过 OUTPUTS 列表拼接路径，并尝试发起带有 cmd 参数的 GET 请求。5. 命令执行：如果服务器返回 200 状态码并输出了 id 命令的结果，则证明漏洞利用成功，攻击者已获得服务器的远程执行权限（RCE）。\n\n【投毒风险分析】从安全审计角度来看，该 POC 的投毒风险极低（约 5%）。分析其代码构成：首先，脚本仅使用了 Python 的标准库（requests, argparse），没有引入任何不明来源的第三方闭源库，这排除了供应链投毒的常见路径。其次，核心逻辑完全透明，所有的 HTTP 请求（HEAD, POST, GET）均清晰定义，没有进行任何形式的代码混淆或加密（如 Base64 编码的 Payload 或混淆的函数名）。脚本中包含的 WebShell 负载为最基础的命令执行代码，不具备自复制、持久化或反弹 Shell 等隐蔽特征。此外，脚本没有尝试连接除用户指定 host 以外的任何第三方外部 IP 或域名，不存在敏感数据外泄（Exfiltration）的风险。唯一的潜在风险在于，如果攻击者下载了该脚本并直接在生产环境中测试，可能会在目标服务器上留下物理文件 'shell.php'。但作为一个研究用的 POC，该代码本身是纯净且安全的，不包含针对使用者本机的恶意行为。

**项目地址:** [https://github.com/lcashdol/Exploits/tree/master/CVE-2018-9206](https://github.com/lcashdol/Exploits/tree/master/CVE-2018-9206)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-9206](https://nvd.nist.gov/vuln/detail/CVE-2018-9206)
