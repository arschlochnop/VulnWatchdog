# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

# CVE-2018-13379

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md](../2018/CVE-2018-13379-0xHunter_FortiOS-Credentials-Disclosure.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy SSL VPN Web Portal 中存在的路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。漏洞利用代码通过发送包含特殊构造的`lang`参数的请求到`/remote/fgt_lang`路径，绕过路径限制，读取`/dev/cmdb/sslvpn_websession`文件。该文件包含敏感的VPN会话信息，例如用户名和密码。利用方式为发送恶意构造的GET请求，读取目标服务器上的任意文件。代码可能存在一定的投毒风险，因为其自动从Shodan获取目标信息，并且将提取出的会话信息保存到本地文件中，这可能被用于后续的恶意活动。虽然主逻辑是漏洞利用，但存在利用结果进行后续恶意操作的可能性，风险占比10%。

**利用方式总结:**

1.  **发送恶意请求：** 攻击者发送一个包含特制`lang`参数的HTTP GET请求到`/remote/fgt_lang`路径。
2.  **路径遍历：**  `lang`参数中的`../../../..//////////dev/cmdb/sslvpn_websession`允许攻击者绕过路径限制，访问系统文件。
3.  **信息泄露：**  服务器返回`sslvpn_websession`文件的内容，其中包含敏感的VPN会话信息。
4.  **凭据窃取：**  攻击者可以解析`sslvpn_websession`文件，提取VPN用户名和密码，用于进一步的攻击。
5. **数据分析：** 代码会将提取出来的数据保存成文件，还会利用`shodan.io`进行信息收集。

**项目地址:** [0xHunter/FortiOS-Credentials-Disclosure](https://github.com/0xHunter/FortiOS-Credentials-Disclosure)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #2

**来源**: [CVE-2018-13379-B1anda0_CVE-2018-13379.md](../2018/CVE-2018-13379-B1anda0_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal，且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中 SSL VPN web portal 存在的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求，下载系统文件。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的有效性较高。搜索引擎结果中多个链接表明该漏洞已被广泛利用。提供的POC代码（CVE-2018-13379.py）通过构造包含路径遍历的 URL（/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession）来尝试读取 `sslvpn_websession` 文件。README.md文件也描述了漏洞的影响版本以及利用方法。 

**投毒风险分析：**
检查了`CVE-2018-13379.py`和`README.md`文件，没有发现任何可疑的恶意代码或者后门，代码功能清晰，就是发送包含payload的请求，判断是否是漏洞地址，然后写入到vul.txt文件中，所以投毒风险为0%。

**利用方式：**
1.  攻击者构造包含路径遍历的恶意 HTTP 请求，例如：
   `GET /remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession HTTP/1.1`
2.  如果目标系统存在漏洞，且SSL VPN web portal 开启，则会返回被请求的文件内容。
3.  攻击者可以利用此漏洞下载敏感文件，例如包含 VPN 用户凭据的文件，从而进一步入侵系统。
4.  POC脚本通过读取URL列表文件，批量测试是否存在该漏洞。

**项目地址:** [B1anda0/CVE-2018-13379](https://github.com/B1anda0/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---



---

## POC #3

**来源**: [CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md](../2018/CVE-2018-13379-Blazz3_cve2018-13379-nmap-script.md)

## CVE-2018-13379-FortiOS/FortiProxy-路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN Web Portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的HTTP请求，下载系统文件。根据搜索引擎结果，此漏洞已经被广泛利用，且有公开的PoC。Nmap脚本 `http-vuln-cve2018-13379.nse` 尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件可能包含明文的用户名和密码。利用方式是通过SSL VPN web portal发送包含特殊构造的路径的HTTP请求, 例如 `/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。PoC的有效性较高，因为该漏洞已经被证实存在且被广泛利用。投毒风险较低,因为PoC相对简单,主要功能是发送payload来尝试利用漏洞，只有一些引用链接和简单的漏洞检测逻辑,判断为存在少量投毒代码的可能性,概率为5%。

**项目地址:** [Blazz3/cve2018-13379-nmap-script](https://github.com/Blazz3/cve2018-13379-nmap-script)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #4

**来源**: [CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md](../2018/CVE-2018-13379-Zeop-CyberSec_fortios_vpnssl_traversal_leak.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #5

**来源**: [CVE-2018-13379-jpiechowka_at-doom-fortigate.md](../2018/CVE-2018-13379-jpiechowka_at-doom-fortigate.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要开启SSL VPN web portal且存在漏洞版本的FortiOS/FortiProxy实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造特制的 HTTP 请求，利用 SSL VPN web portal 下载系统文件。根据提供的漏洞利用代码，该工具 `at-doom-fortigate`  旨在通过 Tor 网络匿名扫描 Rapid7 Project Sonar 数据中易受攻击的 Fortigate 主机。它首先检查是否已连接到 Tor 网络，然后使用 Rapid7 的数据查找暴露在 10443 端口上的 Fortigate 设备。漏洞利用方式为构造恶意的 URL，利用路径遍历漏洞读取目标系统上的文件。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已经存在多年，并且有公开的利用代码，因此该POC代码在理论上是有效的，但实际利用可能需要根据目标环境进行调整。

**投毒风险分析：**
代码的功能主要是扫描和检测漏洞，并通过Tor网络进行匿名操作。从代码本身来看，没有明显的恶意行为或后门代码。主要的风险在于:
1. **依赖项风险:**  项目依赖于第三方库，例如 `github.com/rs/zerolog` 和 `github.com/tidwall/gjson`。这些库本身如果存在安全问题，可能会影响到扫描工具的安全性。
2. **数据源风险:** 工具依赖于 Rapid7 的 Sonar 数据。如果 Rapid7 的数据被篡改或者包含恶意信息，可能会导致工具的行为异常。
3. **Tor网络风险:**  虽然 Tor 可以提供匿名性，但也可能被用于恶意目的。使用 Tor 可能会增加被追踪的难度，但不能完全保证安全性。

综合来看，该仓库存在投毒代码的可能性较低，大约为10%。主要风险来自于依赖库和数据源的安全。

**利用方式总结：**
1.  使用工具 `at-doom-fortigate` 通过 Tor 网络匿名扫描 Fortigate 设备。
2.  该工具依赖于 Rapid7 Project Sonar 数据，需要下载并配置相关数据文件。
3.  工具会尝试利用 CVE-2018-13379 漏洞，通过构造包含路径遍历的 HTTP 请求来读取 Fortigate 设备的敏感文件，比如 VPN 证书或用户凭据。

**项目地址:** [jpiechowka/at-doom-fortigate](https://github.com/jpiechowka/at-doom-fortigate)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #6

**来源**: [CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md](../2018/CVE-2018-13379-k4nfr3_CVE-2018-13379-Fortinet.md)

## CVE-2018-13379-Fortinet SSL VPN 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露，包括用户名密码等

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标设备启用SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞，通过构造特制的 HTTP 资源请求，下载系统文件。从搜索结果和漏洞利用代码来看，攻击者可以通过访问`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession` 获取包含敏感信息的`sslvpn_websession`文件，其中可能包含明文存储的用户名和密码。提供的PoC代码`cve-2018-13379.py`能够自动化利用该漏洞，从目标主机下载`sslvpn_websession`文件，并解析提取用户名和密码。代码中存在一些异常处理，降低了利用的稳定性。通过代码分析，作者的`README.md`文件中没有发现明显的恶意投毒代码。投毒风险评估为10%。主要风险存在于代码的潜在后门或恶意修改，考虑到代码较为简单且有公开的漏洞信息对应，因此概率较低。

**项目地址:** [k4nfr3/CVE-2018-13379-Fortinet](https://github.com/k4nfr3/CVE-2018-13379-Fortinet)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #7

**来源**: [CVE-2018-13379-kh4sh3i_CVE-2018-13379.md](../2018/CVE-2018-13379-kh4sh3i_CVE-2018-13379.md)

## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标系统使用受影响版本的FortiOS/FortiProxy，且启用了SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是一个存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中的路径遍历漏洞。未经身份验证的攻击者可以通过构造特制的 HTTP 请求，下载系统文件。该漏洞的利用方式如下：

1.  攻击者发送包含恶意路径的HTTP请求到目标的SSL VPN web portal，例如：`https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
2.  如果目标系统存在漏洞，服务器将返回包含敏感信息的系统文件内容。
3.  POC代码通过发送包含恶意路径的GET请求，然后检查返回内容是否包含`var fgt_lang =`字符串，如果存在，则将返回内容保存到本地文件，并尝试从中提取用户名和会话token。

**有效性:**
提供的POC代码有效，可以利用此漏洞从目标系统下载`sslvpn_websession`文件，并从中提取用户名和会话token。

**投毒风险:**
该POC代码本身未发现明显的投毒代码。代码的主要功能是发送HTTP请求、保存响应和解析文件内容。其中可能存在的风险点在于，如果攻击者滥用该POC，可能会导致目标系统资源耗尽或被用于其他恶意目的。

对POC进行分析发现，脚本首先检查目标主机是否存在漏洞，然后下载 `sslvpn_websession` 文件。 接着，它解析此文件以提取用户名和会话令牌。 整个过程没有发现明显的恶意行为或后门代码。尽管如此，也不能完全排除潜在的隐蔽风险，因此将投毒风险评估为5%。此数值是基于对代码逻辑的检查，以及缺乏任何可疑或恶意的迹象。

**利用方式:**
1.  运行POC脚本，指定目标IP地址或包含IP地址列表的文件。
2.  脚本将尝试连接到目标系统的SSL VPN web portal。
3.  如果目标系统存在漏洞，脚本将下载`sslvpn_websession`文件。
4.  脚本将解析该文件，提取用户名和会话token，并将其打印到屏幕。
5.  攻击者可以使用提取的会话token重放会话，而无需提供密码。

**项目地址:** [kh4sh3i/CVE-2018-13379](https://github.com/kh4sh3i/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #8

**来源**: [CVE-2018-13379-milo2012_CVE-2018-13379.md](../2018/CVE-2018-13379-milo2012_CVE-2018-13379.md)

## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #9

**来源**: [CVE-2018-13379-nivdolgin_CVE-2018-13379.md](../2018/CVE-2018-13379-nivdolgin_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #10

**来源**: [CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md](../2018/CVE-2018-13379-pwn3z_CVE-2018-13379-FortinetVPN.md)

## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

## POC #11

**来源**: [CVE-2018-13379-yukar1z0e_CVE-2018-13379.md](../2018/CVE-2018-13379-yukar1z0e_CVE-2018-13379.md)

## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS, FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 目标开启SSL VPN web portal且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个路径遍历漏洞。未经验证的攻击者可以通过构造特殊的 HTTP 资源请求来下载系统文件。根据漏洞库信息和搜索引擎结果，此漏洞影响多个 FortiOS 和 FortiProxy 版本。虽然提供的代码只是一个 Apache 2.0 许可协议，并不是直接的利用代码，但是根据搜索结果，该漏洞的利用方式是构造包含路径遍历的 HTTP 请求，例如 `https://<目标地址>/sslvpn/portal/content/../../../../etc/passwd`。通过修改请求中的路径，攻击者可以尝试访问目标系统上的任意文件。由于漏洞已被广泛披露且存在公开的利用方法，因此有效性较高。提供的代码片段本身只是一份LICENSE文件，没有可执行的操作，不构成投毒行为。但是，实际利用时，如果下载的文件包含恶意代码，则可能间接导致投毒。

**项目地址:** [yukar1z0e/CVE-2018-13379](https://github.com/yukar1z0e/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)

---

