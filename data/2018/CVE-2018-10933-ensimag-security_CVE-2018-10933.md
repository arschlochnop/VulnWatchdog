## CVE-2018-10933 - libssh 身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 0.6.x (>= 0.6.0), 0.7.x (< 0.7.6), 0.8.x (< 0.8.4)

**利用条件:** 目标服务器运行受影响版本的 libssh 服务，无需任何有效凭证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞源于 libssh 服务端状态机逻辑错误。在身份验证过程中，如果客户端向服务器发送 SSH2_MSG_USERAUTH_SUCCESS 消息（该消息本应由服务器发送以确认成功），libssh 服务端会错误地跳过验证过程，直接将连接标记为已认证，从而允许攻击者直接创建通信通道。输入数据中的 POC 代码极其详细，提供了一个基于 Docker 的漏洞复现环境。其中 server.patch 文件通过修改 examples/ssh_server_fork.c，移除了对 sdata.authenticated 的检查，这准确地还原了该漏洞在逻辑层面上的触发点。Dockerfile 确保了编译环境（Debian Jessie）和依赖项（OpenSSL < 1.1）的一致性，使得复现过程具有极高的成功率。该漏洞利用步骤非常简单：1. 启动受影响的 libssh 服务端。2. 使用支持发送自定义 SSH 消息的脚本连接目标。3. 在进行常规握手后，不发送登录请求，而是直接发送 MSG_USERAUTH_SUCCESS。4. 成功绕过验证并执行后续命令。由于该漏洞影响底层库且利用门槛极低，其危害性极大，攻击者可以轻易获取受影响服务器的控制权。

投毒风险分析：该 POC 项目来自 Ensimag Security 教学/研究机构，其代码结构清晰，主要包含 Dockerfile、补丁文件和 LaTeX 文档源码。经过代码审计，未发现任何恶意后门或混淆行为。Dockerfile 使用官方 Debian 镜像，所有的安装包均通过 apt-get 从官方仓库获取。server.patch 仅用于演示漏洞成因，没有包含任何反弹 Shell 或恶意 Payload。项目中提供的参考链接均指向知名的安全社区（如 Vulhub、HackerHouse 和 Medium），这些来源具有较高的可信度。虽然项目中提到了使用 Shodan 搜索特定版本的服务器，但这属于安全研究中的资产发现范畴，而非 POC 本身的恶意投毒行为。总体而言，该 POC 代码是纯粹的安全研究和教学目的，代码逻辑透明，不包含外部不可控的脚本下载。唯一的小风险点在于此类漏洞环境可能被初学者误部署在公网，但作为防御性研究资源，其投毒风险处于极低水平（约 10%），主要来源于用户在使用过程中如果不慎通过第三方非官方源下载 libssh 源码包时可能引入的供应链风险。

**项目地址:** [https://github.com/ensimag-security/CVE-2018-10933](https://github.com/ensimag-security/CVE-2018-10933)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-10933](https://nvd.nist.gov/vuln/detail/cve-2018-10933)
