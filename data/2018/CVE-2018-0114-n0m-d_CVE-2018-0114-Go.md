## CVE-2018-0114 - Cisco node-jose JWT 令牌伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT 令牌伪造

**影响应用:** Cisco node-jose

**危害等级:** 高危

**CVSS评分:** 未提供，请参考NVD

**影响版本:** 受影响版本信息缺失，请参考NVD

**利用条件:** 无需认证，可远程利用

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2018-0114 漏洞存在于 Cisco 的 node-jose 库中，允许攻击者通过在令牌头中嵌入公钥来伪造 JWT 令牌。该漏洞源于 node-jose 库在验证 JWT 签名时，没有正确地验证密钥的来源，攻击者可以构造包含恶意 JWK (JSON Web Key) 的 JWT 头部，利用公钥覆盖原有的密钥，从而绕过签名验证。 

POC 有效性分析：提供的 POC 代码是一个 Go 程序，可以生成包含指定声明（claim）的 JWT 令牌。通过运行 `go run . --claim=admin` 命令，可以生成一个声明用户为 admin 的 JWT 令牌。生成的 JWT 令牌的头部包含一个 JWK，该 JWK 包含用于验证签名的公钥。利用该公钥，攻击者可以伪造任意声明的 JWT 令牌，从而绕过身份验证。代码的 README 文件提供了漏洞描述和利用方法，运行结果表明 POC 可以成功生成伪造的 JWT 令牌。

利用步骤：
1. 获取目标系统使用的 node-jose 库版本。
2. 运行 POC 代码，生成包含恶意 JWK 的 JWT 令牌。
3. 将生成的 JWT 令牌发送到目标系统。
4. 目标系统使用 JWT 令牌进行身份验证，由于签名验证被绕过，攻击者可以成功登录系统。

投毒风险分析：
该 POC 代码使用 Go 语言编写，依赖 `github.com/mbndr/figlet4go` 库来生成 banner。代码本身没有明显的恶意行为，主要功能是生成 JWT 令牌。但攻击者可能会修改代码，添加恶意功能，例如：
1. 在生成的 JWT 令牌中添加恶意声明，例如执行任意代码的声明。
2. 将生成的 JWT 令牌发送到指定的服务器。
3. 将生成的 JWT 令牌保存到本地文件。

由于代码使用了第三方库，存在一定的投毒风险。攻击者可能会通过替换第三方库来注入恶意代码。此外，代码中存在一些硬编码的字符串，攻击者可能会利用这些字符串进行攻击。综合评估，投毒风险较低，约为 15%。代码结构清晰，使用了标准的 Go 库，没有发现可疑的外部脚本调用或 eval 函数。恶意行为主要集中在篡改 JWT 的声明内容，但本身的执行流程相对安全。

**项目地址:** https://github.com/n0m-d/CVE-2018-0114-Go

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
