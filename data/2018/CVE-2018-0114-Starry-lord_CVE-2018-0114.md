## CVE-2018-0114 - Cisco node-jose JWT签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT签名伪造

**影响应用:** Cisco node-jose

**危害等级:** 高危

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

**影响版本:** 0.11.0之前

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2018-0114是Cisco node-jose库中存在的一个JWT（JSON Web Token）签名伪造漏洞。该漏洞存在于0.11.0之前的版本中。攻击者可以利用此漏洞，通过在JWT头部嵌入一个伪造的公钥，然后使用该公钥重新签名JWT，从而绕过身份验证。由于node-jose库在验证JWT签名时，如果JWT头部包含`jwk`（JSON Web Key）字段，则会使用该字段中的公钥进行验证，而不会使用预期的密钥。攻击者可以通过构造包含恶意`jwk`的JWT，将其发送到服务器，服务器会使用攻击者提供的公钥验证签名，从而使攻击者可以伪造任何用户的身份。

**POC有效性分析：**
POC代码是一个Python脚本，用于生成包含恶意`jwk`的JWT。该脚本使用`OpenSSL`和`cryptography`库生成RSA密钥对，然后将公钥嵌入到JWT头部。脚本还使用私钥对JWT进行签名。生成的JWT可以直接用于攻击易受攻击的应用程序。

**利用步骤：**
1. 运行POC脚本，生成包含恶意`jwk`的JWT。
2. 将生成的JWT发送到易受攻击的应用程序。
3. 应用程序将使用恶意`jwk`中的公钥验证签名。
4. 由于JWT是由攻击者签名的，因此验证将成功。
5. 攻击者现在可以以被攻击用户的身份访问应用程序。

**投毒风险分析：**
该POC的投毒风险较低，因为代码相对清晰，使用了标准的Python库，没有发现任何可疑行为或外部脚本调用。该脚本主要用于生成一个包含恶意公钥的JWT，目的是为了利用Cisco node-jose库中的漏洞进行身份验证绕过。虽然它可以被用于恶意目的，但代码本身没有包含任何后门或恶意载荷。因此，将此POC判定为高风险投毒是不合适的。投毒风险评估为10%。

总结：此漏洞利用难度低，危害性高，允许未经身份验证的远程攻击者伪造JWT令牌，从而绕过身份验证并获得对应用程序的未授权访问。提供的POC代码质量高，可直接用于验证和利用此漏洞。虽然存在潜在的恶意使用风险，但代码本身不包含明显的恶意行为，因此投毒风险较低。

**项目地址:** https://github.com/vulnwatchdog_a5f13707bcef690b199d561c0a37a5d2/CVE-2018-0114.py

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
