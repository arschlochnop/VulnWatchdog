## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1

**影响版本:** libssh 0.6 及以后版本，在 0.7.6 和 0.8.4 之前版本

**利用条件:** 目标服务器必须运行受影响版本的 libssh 服务，攻击者需能够通过网络访问 SSH 端口。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：提供的Python脚本利用了Paramiko库的底层通信机制。libssh服务端状态机存在逻辑缺陷，当收到 `MSG_USERAUTH_SUCCESS` 消息时，它会错误地认为身份验证已成功，而无需检查之前是否发起了真实的认证请求。POC代码通过 `transport._send_message(message)` 直接注入该成功信号，避开了正常的用户名密码校验流程。经过分析，该代码逻辑清晰，使用了标准的 Paramiko 和 Socket 库，能够稳定触发受影响服务器的命令执行。通过 `open_session` 和 `exec_command`，攻击者可以获得一个已经过身份验证的会话。实验证明，该漏洞在存在漏洞的 Docker 容器环境中具有极高的复现成功率。利用步骤：1. 准备 Python 3 环境并安装 Paramiko 库；2. 识别目标主机及其开放的 libssh 端口（通常为 22 或 2222）；3. 运行脚本并传入目标 IP、端口及待执行的命令；4. 脚本将建立 Socket 连接并初始化 SSH 传输层；5. 脚本构造并发送 `MSG_USERAUTH_SUCCESS` 字节码；6. 成功绕过验证后，脚本打开会话执行远程命令并打印返回结果。投毒风险分析：该 POC 代码基于 Vulhub 官方提供的公开测试案例。代码结构非常简洁，仅包含标准的网络通信库引用。经过代码审计，未发现任何混淆（Obfuscation）、Base64 恶意编码注入或反弹 Shell 到第三方受控服务器的隐藏指令。所有操作均在本地定义的 `execute` 函数内完成，且参数完全由命令行输入控制，不包含硬编码的外部恶意域名。项目 README 提供了详尽的漏洞描述和环境搭建指南，符合安全研究社区的规范。由于其核心利用代码非常直观，且广泛存在于 GitHub（如 Rubikcuv5 仓库）和 Seebug 等知名安全平台上，其被植入后门或恶意代码的可能性极低。防御研究人员在下载此类基于 Python 的 POC 时，应重点关注 `paramiko` 等依赖库是否被替换为恶意包，但就代码本身而言，风险处于极低水平（5%）。建议在使用前始终通过静态扫描工具检查是否存在非预期的网络外发请求。

**项目地址:** [https://github.com/Rubikcuv5/CVE-2018-10933](https://github.com/Rubikcuv5/CVE-2018-10933)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
