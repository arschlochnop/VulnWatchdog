## CVE-2018-0114 - Cisco node-jose JWT签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT签名伪造

**影响应用:** Cisco node-jose

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** < 0.11.0

**利用条件:** 无需认证，远程攻击

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2018-0114 存在于 Cisco node-jose 0.11.0 之前的版本中。该漏洞允许未经身份验证的远程攻击者使用嵌入在令牌中的密钥重新签名令牌。漏洞原因是 node-jose 遵循 JSON Web 签名 (JWS) 标准。此标准规定，表示公钥的 JSON Web Key (JWK) 可以嵌入在 JWS 的标头中。然后信任此公钥进行验证。攻击者可以通过删除原始签名，向标头添加新的公钥，然后使用与嵌入在该 JWS 标头中的公钥关联的（攻击者拥有的）私钥对该对象进行签名来利用此漏洞来伪造有效的 JWS 对象。

POC代码是一个 Ruby 脚本，用于演示如何利用此漏洞。利用步骤如下：
1.  生成RSA私钥和公钥对，私钥存储在private.pem文件中。
2.  构造包含受害者用户名的 payload。
3.  构造包含公钥信息的header，将"alg"设置为 "RS256"，将公钥的模数 "n" 和指数 "e" 编码后放入 "jwk" 字段中。
4.  使用攻击者的私钥对 header 和 payload 进行签名。
5.  生成伪造的 JWT 令牌。

POC有效性分析：该POC代码可以成功生成一个伪造的JWT令牌，该令牌可以绕过签名验证，从而允许攻击者冒充受害者。该漏洞利用简单，攻击复杂度低，影响范围广，危害性高。

投毒风险分析：此POC代码的投毒风险较低。代码使用标准的Ruby库，没有明显的恶意行为。虽然它读取名为“private.pem”的文件，但该文件是由用户生成的，而不是从外部源下载的。代码清晰易懂，没有混淆或其他可疑技术。此外，此POC的目的是演示JWT签名伪造漏洞，而不是部署后门或进行其他恶意活动，因此，投毒风险较低，大约为10%。

**项目地址:** https://github.com/vulnwatchdog/ ஜோதி

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
