# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

# CVE-2018-19422

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md](../2018/CVE-2018-19422-Drew-Alleman_CVE-2018-19422.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，允许未授权的远程攻击者执行任意PHP代码。

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 部署实例，以及可访问的/panel/uploads目录。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 `/panel/uploads` 目录中。由于 `.htaccess` 文件中缺少对 `.pht` 和 `.phar` 文件的阻止规则，远程攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的利用是有效的。搜索引擎结果中 Exploit-DB 和 GitHub 链接都指向了针对此漏洞的利用代码。

**投毒风险：**
PoC 代码的主要功能是：
1.  登录到 Subrion CMS 管理后台。
2.  上传包含 PHP 代码的 `.phar` 文件到 `/panel/uploads` 目录。
3.  通过访问上传的文件来执行其中的 PHP 代码。

代码中存在文件扩展名替换的逻辑，将 `.php` 扩展名替换为 `.phar`，这是为了绕过服务器对 `.php` 文件的限制。虽然代码本身并没有明显的恶意行为，但任何允许上传和执行代码的 PoC 都存在被滥用的风险。投毒风险较低，约为5%，主要考虑是代码相对清晰，功能集中在利用漏洞上，但任何代码都存在被修改的可能。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要使用有效的管理员用户名和密码登录到 Subrion CMS 的管理后台。
2.  **CSRF Token 获取：** 从登录页面获取CSRF token，用于绕过CSRF保护。
3.  **文件上传：** 登录后，攻击者使用修改后的文件名（例如，将 shell.php 修改为 shell.phar）将包含恶意 PHP 代码的文件上传到 `/panel/uploads` 目录。
4.  **远程代码执行：** 成功上传文件后，攻击者可以通过访问上传的文件（例如，`http://example.com/uploads/shell.phar`）来执行其中的 PHP 代码。这允许攻击者在服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2018-19422](https://github.com/Drew-Alleman/CVE-2018-19422)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #2

**来源**: [CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md](../2018/CVE-2018-19422-Swammers8_SubrionCMS-4.2.1-File-upload-RCE-auth-.md)

## CVE-2018-19422-Subrion CMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1 实例，后台用户认证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-19422 是 Subrion CMS 4.2.1 中的一个远程代码执行漏洞。该漏洞源于 `/panel/uploads` 目录未对上传的文件类型进行严格限制，导致攻击者可以通过上传包含恶意 PHP 代码的 `.pht` 或 `.phar` 文件来执行任意代码。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码。提供的 exploit.py 文件是一个 Python 脚本，它首先尝试登录到 Subrion CMS 后台，然后利用文件上传漏洞上传恶意 PHP 代码，最后通过访问上传的文件来执行代码。该脚本还包含对目标 URL 的检查，以确保 URL 以斜杠结尾，这表明作者修复了一个在使用该漏洞时的常见问题。所以POC代码是有效的。

**投毒风险分析：**

查看提供的漏洞利用代码，该代码的主要功能是利用漏洞实现远程代码执行，没有发现明显的恶意投毒代码。代码中包含登录尝试、CSRF token 获取、webshell 上传等功能，这些都是漏洞利用的正常步骤。在 `README.md` 文件中，作者也只是说明修复了一个URL的问题。虽然没有发现明显投毒代码，但仍需注意以下几点：

1.  该脚本需要提供用户名和密码才能登录后台，如果使用弱密码，可能会被攻击者利用。
2.  该脚本上传的 webshell 具有执行任意代码的能力，如果 webshell 被其他人访问，可能会导致服务器被完全控制。
3.  代码修改过的URL校验, 增加了该POC的成功率,但也可能被恶意修改后用于传播恶意软件。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，投毒风险估计在 5% 左右。

**利用方式分析：**

1.  使用提供的 `exploit.py` 脚本，指定目标 Subrion CMS 实例的 URL、用户名和密码。
2.  脚本首先尝试登录到 Subrion CMS 后台。
3.  如果登录成功，脚本会生成一个随机的 webshell 文件名，并上传包含恶意 PHP 代码的文件。
4.  上传成功后，脚本会输出 webshell 的访问 URL。
5.  攻击者可以通过访问该 URL 来执行任意 PHP 代码，从而控制服务器。

**项目地址:** [Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-](https://github.com/Swammers8/SubrionCMS-4.2.1-File-upload-RCE-auth-)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---

## POC #3

**来源**: [CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md](../2018/CVE-2018-19422-hev0x_CVE-2018-19422-SubrionCMS-RCE.md)

## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1版本，以及有效的管理员账号密码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 /panel/uploads 目录。由于 .htaccess 文件没有阻止对 .pht 和 .phar 文件的执行，远程攻击者可以通过上传包含恶意 PHP 代码的 .pht 或 .phar 文件来执行任意 PHP 代码。

**有效性：**
提供的 POC 代码 `SubrionRCE.py` 旨在利用此漏洞。它首先尝试登录到 Subrion CMS 的后台管理面板，获取 CSRF token，然后使用提供的用户名和密码进行身份验证。如果登录成功，脚本会生成一个随机名称的webshell，并尝试通过文件上传功能上传该webshell，webshell的后缀名为.pht或.phar，因为目标系统的.htaccess配置不阻止此类型的文件执行。如果上传成功，攻击者可以通过访问 webshell 的 URL 来执行任意 PHP 代码。 根据漏洞描述和 exploit-db 上的信息，此PoC的有效性高.

**投毒风险：**
检查了提供的 POC 代码 `SubrionRCE.py`。 该代码主要实现了漏洞利用逻辑，包括登录、上传webshell和执行命令等步骤。  代码中没有发现明显的恶意或隐藏功能，例如未经授权的数据收集、传播恶意软件或修改系统设置等。
 因此，此仓库中作者隐藏的投毒代码的可能性为0%。POC 仅包含用于验证和利用漏洞的代码，不包含其他恶意功能。

**利用方式：**
1.  **身份验证：** 使用提供的用户名和密码登录 Subrion CMS 的后台管理面板。
2.  **上传 Webshell：** 上传一个包含恶意 PHP 代码的 .pht 或 .phar 文件到 /panel/uploads 目录。
3.  **远程代码执行：** 通过访问上传的 webshell 的 URL 来执行任意 PHP 代码。

漏洞利用的关键是 Subrion CMS 4.2.1 版本的 .htaccess 配置不阻止对 .pht 和 .phar 文件的执行，这允许攻击者上传并执行包含恶意 PHP 代码的文件。

**项目地址:** [hev0x/CVE-2018-19422-SubrionCMS-RCE](https://github.com/hev0x/CVE-2018-19422-SubrionCMS-RCE)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)

---



---



---



---



---



---



---



---



---



---



---



---



---

