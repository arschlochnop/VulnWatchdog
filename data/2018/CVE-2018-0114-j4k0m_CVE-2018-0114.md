## CVE-2018-0114 - Cisco node-jose JWT签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT签名伪造

**影响应用:** Cisco node-jose

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 0.11之前版本

**利用条件:** 无需认证，可构造恶意JWT token

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2018-0114 存在于Cisco的node-jose库中，允许攻击者伪造恶意的JWT token。该漏洞源于JWT允许用户将公钥嵌入到token的header中（使用jwk值），而应用程序没有正确验证这些公钥的来源。攻击者可以提供自己的公钥，并使用相应的私钥对消息进行签名，从而绕过身份验证。POC代码的README.md文件详细描述了漏洞原理和修复commit。该POC可以直接利用，无需复杂的配置，只需要构造包含恶意jwk的JWT token即可。

利用步骤：
1. 构造包含恶意jwk的JWT token，将攻击者的公钥嵌入到token的header中。
2. 使用攻击者的私钥对token进行签名。
3. 将伪造的token发送给目标应用程序。
4. 如果应用程序没有正确验证token的签名和公钥，攻击者就可以绕过身份验证，冒充其他用户。

POC有效性分析：
POC代码清晰易懂，包含了漏洞描述、修复commit链接以及相关的测试用例。通过分析测试用例（test/fixtures/jws.embedded_jwk.json），可以清晰地看到如何构造包含恶意jwk的JWT token。 该POC可以直接用于验证漏洞的存在，并且可以作为开发安全测试用例的参考。

投毒风险分析：
该POC代码主要用于演示JWT签名伪造漏洞，代码清晰，只包含漏洞利用相关的逻辑，没有发现恶意行为或后门代码。代码中没有使用eval等高风险函数，也没有发现对外部脚本的引用。综上所述，该POC的投毒风险较低。

**项目地址:** https://github.com/xxx/CVE-2018-0114

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2018-0114
