## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 通过T3协议可访问WebLogic Server端口（默认7001）；目标服务器未修补或绕过补丁限制。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC集合包含了针对CVE-2018-2628的多个关键组件。核心文件pocweblogic.py是经典的基于T3协议的探测脚本。它首先通过发送‘t3 12.1.2\nAS:255\nHL:19\n\n’握手包来确认目标是否开启T3协议。随后，它构造了一个包含精心构造的反序列化Payload的RequestObject。该Payload使用了java.rmi.activation.Activator和RemoteObjectInvocationHandler的链式调用，这是由于WebLogic对之前的CVE-2017-3248补丁不完善，导致攻击者可以通过这些类绕过黑名单限制，实现远程对象绑定并触发反序列化。脚本中定义了大量的十六进制Payload流，这是典型的序列化对象二进制表达。第二个脚本getshell.py则是一个交互式的WebShell客户端，它通过向已部署的JSP木马（通常是wlscmd.jsp）发送Base64编码的‘tom’参数来执行系统命令。利用步骤如下：1. 使用pocweblogic.py检测目标是否存在漏洞，该脚本会通过T3协议发送序列化Payload，若目标返回包含‘$Proxy’特征的响应，则确认漏洞存在。2. 使用配套的二进制文件（如README中提到的exe）或利用脚本，通过JRMP服务将恶意JSP后门写入目标的bea_wls_internal目录。3. 访问部署好的JSP地址，利用getshell.py进行远程指令控制。该POC逻辑清晰，针对性强，能够有效复现漏洞。 【投毒风险分析】在对此POC包进行安全性审查时发现，虽然核心Python脚本pocweblogic.py和getshell.py的代码逻辑相对透明，主要依赖socket和requests等标准库，且未发现明显的混淆或恶意外连行为，但README中提及的‘Weblogic GetShell CVE-2018-2628.exe’存在极高的安全隐患。由于它是二进制编译文件，其内部行为不可见，很可能在执行利用过程中植入针对研究者本机的后门或窃取当前环境的敏感信息。此外，pocweblogic.py中的PAYLOAD包含硬编码的外部IP地址（如104.251.228.50），虽然这可能是原作者测试留下的JRMP服务端地址，但在未修改的情况下运行可能会导致流量意外流向第三方服务器，造成信息泄露。此外，此类针对老旧漏洞的‘优化版’工具经常被攻击者二次打包，在非官方渠道下载可能携带捆绑木马。建议防御者在受控隔离环境（如离线沙箱）中使用Python源码版进行验证，严禁直接运行其中的EXE可执行程序，并对Payload中的外部IP进行重定向或替换。总的来说，源码部分风险较低，但配套工具链风险评级为中等，需谨慎对待。

**项目地址:** [https://github.com/vulhub/vulhub/blob/master/weblogic/CVE-2018-2628/README.zh-cn.md](https://github.com/vulhub/vulhub/blob/master/weblogic/CVE-2018-2628/README.zh-cn.md)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
