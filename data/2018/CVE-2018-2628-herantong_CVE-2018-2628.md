## CVE-2018-2628 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2018-2628

**漏洞类型:** RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

**利用条件:** 目标开启T3协议端口（默认7001），且未安装相应补丁或未限制T3协议访问。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于WebLogic Server核心组件中，由于T3协议在处理Java反序列化时未对输入对象进行有效过滤，攻击者可以绕过黑名单限制，通过JRMP（Java Remote Method Protocol）发送恶意序列化对象。提供的POC代码包含两个部分：pocweblogic.py 用于漏洞检测，它模拟T3握手并发送一段包含JRMPCall的HEX字节流（PAYLOAD），通过监测响应中是否包含特定的Java代理特征（如$Proxy）来判断是否存在漏洞。getshell.py 则是利用成功后的交互式Shell客户端。利用步骤：1. 使用 pocweblogic.py 探测目标IP，确认是否存在CVE-2018-2628漏洞。2. 运行提供的二进制利用工具 "Weblogic GetShell CVE-2018-2628.exe"（注意：此步骤涉及闭源EXE，风险较高）对目标进行攻击并植入JSP后门。3. 后门植入路径通常为 /bea_wls_internal/wlscmd.jsp。4. 运行 getshell.py，输入植入的Webshell地址，通过Base64编码的指令实现远程命令执行。 投毒风险分析：该POC合集中存在明显的潜在风险。首先，README中提到的核心利用工具 "Weblogic GetShell CVE-2018-2628.exe" 是一个闭源的可执行文件，在安全研究领域，此类来源不明的二进制文件具有极高的投毒嫌疑，可能包含针对渗透测试人员主机的后门、木马或窃密插件，其风险远高于纯文本脚本。其次，提供的 Python 脚本 pocweblogic.py 虽然逻辑清晰，但在 PAYLOAD 构造中包含了硬编码的远程IP地址（如 104.251.228.50），这可能是原作者测试时留下的痕迹，也可能是用于外连的跳板。虽然脚本本身没有混淆，但依赖于外部闭源工具的行为符合典型的投毒策略，即通过开源脚本引导用户运行恶意二进制文件。建议在分析时仅参考 Python 源码逻辑，严禁在宿主机运行其中的 EXE 文件。

**项目地址:** [https://github.com/vulhub/vulhub/blob/master/weblogic/CVE-2018-2628/README.zh-cn.md](https://github.com/vulhub/vulhub/blob/master/weblogic/CVE-2018-2628/README.zh-cn.md)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2018-2628](https://nvd.nist.gov/vuln/detail/cve-2018-2628)
