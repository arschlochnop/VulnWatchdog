## CVE-2018-19320 - GIGABYTE 驱动程序 (gdrv.sys) 本地提权(LPE)

**漏洞编号:** CVE-2018-19320

**漏洞类型:** 本地提权(LPE)

**影响应用:** GIGABYTE 驱动程序 (gdrv.sys)

**危害等级:** 高危

**CVSS评分:** 7.8

**影响版本:** GIGABYTE APP Center v1.05.21及更早版本; AORUS GRAPHICS ENGINE v1.33及更早版本; XTREME GAMING ENGINE v1.25及更早版本; OC GURU II v2.08

**利用条件:** 本地用户权限，系统中存在已签名的gdrv.sys驱动程序

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于技嘉（GIGABYTE）提供的gdrv.sys驱动程序中，本质上是一个具有高度危险性的内核级memcpy功能暴露。由于驱动程序对IOCTL请求缺乏适当的访问控制和输入验证，攻击者可以利用这一特性向内核空间任意内存地址写入数据。本POC代码展示了如何利用这一特性，通过修改内核中特定的安全结构或覆盖函数指针来绕过Windows的驱动签名强制执行（DSE）机制，并最终将当前进程权限提升至SYSTEM。POC包含完整的C++项目工程，针对Windows 10 x64环境进行了适配，其核心逻辑包括通过Psapi获取内核基址、定位内核关键函数、构造特制的IOCTL包以及触发漏洞。代码结构清晰，利用流程逻辑严密，具有极高的实战参考价值和有效性。此外，该漏洞属于经典的BYOVD（Bring Your Own Vulnerable Driver）攻击模式，即便系统本身已更新，若被加载该旧版驱动，防御系统仍会面临威胁。利用步骤：1. 确认目标系统安装了受影响版本的技嘉工具软件或手动加载gdrv.sys。2. 编译并运行POC程序，程序首先会尝试获取gdrv.sys的句柄。3. 探测内核关键数据结构（如System令牌地址）。4. 发送精心构造的IOCTL请求给gdrv.sys，执行任意内存写操作。5. 将当前进程的Token替换为系统权限Token。6. 验证是否获得SYSTEM shell。投毒风险分析：该POC代码托管在GitHub的公开仓库中，经过初步静态审查，其源代码主要依赖标准的Windows API头文件（如windows.h, Psapi.h），不涉及外部混淆库或下载器行为。代码逻辑直接针对漏洞点进行利用，未发现隐藏的加密通信段或向远程服务器发送敏感信息的代码块。其包含的Visual Studio解决方案文件（.sln）和项目配置文件（.vcxproj）均为标准格式。虽然存在极低风险，即攻击者可能在Releases页面上传包含后门的预编译二进制文件，但从提供的源代码片段看，其主要目的是安全研究和漏洞演示。代码逻辑透明，开发者提供了详细的受影响版本说明和致谢信息，符合合法的安全研究规范。组织在测试此POC时，建议在隔离的虚拟机环境下自行编译源代码，以完全规避预编译二进制文件可能存在的潜在风险。

**项目地址:** [https://github.com/BeyondBinary/CVE-2018-19320](https://www.google.com/search?q=https://github.com/BeyondBinary/CVE-2018-19320)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-19320](https://nvd.nist.gov/vuln/detail/CVE-2018-19320)
