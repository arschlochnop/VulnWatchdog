## CVE-2018-19320 - Gigabyte GPCIDRV 和 GVINLOW 驱动程序 权限提升/本地内核缓冲区溢出

**漏洞编号:** CVE-2018-19320

**漏洞类型:** 权限提升/本地内核缓冲区溢出

**影响应用:** Gigabyte GPCIDRV 和 GVINLOW 驱动程序

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Gigabyte App Center 版本 v17.12.08 之前，以及包含 GPCIDRV 驱动的其他多个组件

**利用条件:** 具有本地普通用户权限，能够在系统上加载或与已存在的 Gigabyte 易损驱动程序进行通信。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞存在于技嘉（Gigabyte）受签名的驱动程序中，具体源于驱动程序提供的类似于 memcpy 的内核态函数接口。通过特定的 IOCTL 控制码，本地攻击者可以指示驱动程序将任意数据写入内核内存空间。由于该驱动程序具有合法的微软数字签名，它能够绕过现代 Windows 系统的驱动程序签名强制执行（DSE）机制。提供的 POC 代码是一个完整的 Visual Studio 工程，其通过调用 GPCIDRV.sys 的 IOCTL 功能，直接对内核内存进行写操作，从而实现对系统关键数据结构的篡改（如修改 Windows 回调函数或直接禁用 DSE 标志位）。利用步骤如下：1. 检测系统中是否存在受影响的技嘉驱动程序或手动加载该签名驱动；2. 打开驱动设备句柄；3. 构造特定的 IOCTL 请求数据包，利用内核写漏洞将恶意载荷写入 ring0 层；4. 通过该内核权限执行任意代码，如禁用反病毒软件保护、加载未经签名的 Rootkit 等。在 RobbinHood 勒索软件的实际案例中，该漏洞被用于攻击杀毒软件进程。投毒风险分析：经过对提供的 POC 工程文件（Gigabyte_CI.sln 和工程配置）的初步静态分析，该代码表现为标准的 C++ Windows 内核编程项目。工程结构清晰，未发现明显的二进制加密、混淆或隐藏的外部下载指令。虽然该工具涉及内核级操作，具有极高的破坏潜力，但其代码意图主要集中在展示如何通过易损驱动绕过 DSE。风险主要来自于该漏洞常被勒索软件利用，因此在测试时应确保在完全隔离的虚拟机环境中进行。目前的 POC 代码库未见明显的第三方后门植入或恶意凭据窃取逻辑，属于相对纯净的安全研究代码。但在实际下载编译时，需警惕预编译二进制文件的安全性。

**项目地址:** [https://github.com/BeyondBinary/CVE-2018-19320](https://www.google.com/search?q=https://github.com/BeyondBinary/CVE-2018-19320)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-19320](https://nvd.nist.gov/vuln/detail/CVE-2018-19320)
