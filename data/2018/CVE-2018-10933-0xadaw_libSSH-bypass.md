## CVE-2018-10933 - libssh 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** libssh

**危害等级:** CRITICAL

**CVSS评分:** 9.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** libssh 0.6 及更高版本；在 0.7.6 和 0.8.4 之前版本受影响

**利用条件:** 目标服务器运行受影响版本的 libssh 且开启了服务器模式，攻击者需具备网络访问权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞源于 libssh 服务端状态机逻辑缺陷。攻击者向服务端发送 SSH2_MSG_USERAUTH_SUCCESS 消息，而非预期的 SSH2_MSG_USERAUTH_REQUEST，即可诱骗服务端认为身份验证已成功，从而绕过认证过程。所提供的 POC 代码包含三个主要模块：sneak.py 利用 ipaddress 库进行 CIDR 扫描，通过读取 Banner 识别 libssh 0.6 等受影响版本；checkit.py 实现批量连接测试并尝试建立会话；checkip.py 则是针对单个目标的完整利用演示。代码中利用 paramiko 库直接构造并发送 MSG_USERAUTH_SUCCESS 字节流，随后调用 open_session() 和 exec_command('id')，这一逻辑完全符合 CVE-2018-10933 的技术原理。经分析，该 POC 逻辑清晰、依赖简单（仅需 paramiko），在受影响的环境中具有极高的利用成功率。利用步骤如下：1. 使用 sneak.py 对目标网段进行扫描，获取开放 22 端口且 Banner 匹配的 IP 列表并保存至 ipaddresslist.txt；2. 运行 checkit.py 验证列表中的目标是否真正存在状态机缺陷；3. 使用 checkip.py 对特定目标执行命令注入，获取 shell 权限。 投毒风险分析：该 POC 项目代码透明度高，逻辑直观，未发现明显的恶意混淆或第三方不可控下载行为。其代码主要依赖 Python 标准库（sys, time, ipaddress, socket）和知名的 paramiko 库。在 sneak.py 中，虽然存在文件写入操作（w+ 模式写入 ipaddresslist.txt），但这属于合法的扫描结果记录行为。checkip.py 中执行的 'id' 命令是典型的安全研究无害化验证手段。尽管该工具集成了 CIDR 扫描功能，使其具备了一定的蠕虫化攻击潜力，但这属于工具的功能特性，而非针对使用者本机的投毒行为。代码库中没有发现反弹 shell 到攻击者服务器、窃取本地 SSH 密钥或修改系统全局变量等恶意操作。因此，从防御性安全研究的角度评估，该 POC 本身投毒风险较低。但仍需注意，由于其具备批量扫描功能，使用者在法律授权范围外运行可能产生合规风险。建议在受控的沙箱环境中使用，并严格审计 paramiko 库的版本安全性，防止因依赖项被劫持而导致的二次风险。

**项目地址:** [https://github.com/vulnwatchdog/libSSH-bypass](https://www.google.com/search?q=https://github.com/vulnwatchdog/libSSH-bypass) (基于POC路径推测)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)
