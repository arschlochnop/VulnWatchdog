# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

# CVE-2019-20372

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-20372-0xleft_CVE-2019-20372.md](../2019/CVE-2019-20372-0xleft_CVE-2019-20372.md)

## CVE-2019-20372-NGINX HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要存在负载均衡或者反向代理，且存在特定的 error_page 配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 漏洞存在于 NGINX 1.17.7 之前的版本中。当 NGINX 配置了特定的 `error_page` 指令时，允许攻击者进行 HTTP 请求走私。该漏洞允许攻击者在负载均衡器或反向代理的环境下，读取未授权的网页。根据提供的POC代码，利用方式如下：

1.  **漏洞原理：** 该漏洞利用了 Nginx 在处理 `error_page` 指令时，对请求的解析不一致性。具体来说，如果 `error_page` 指令中使用了完整的 URL（例如 `http://localhost/401.html`），则 Nginx 可能会错误地处理后续的请求。
2.  **POC 代码分析：**
    *   `server.sh`：该脚本使用 Docker 构建并运行一个存在漏洞的 Nginx 服务器。
    *   `Dockerfile`：该文件定义了 Nginx 镜像，使用了 Nginx 1.17.6 版本，存在漏洞。
    *   `nginx.conf`：该文件是 Nginx 的配置文件，关键在于 `error_page 401 http://localhost/401.html;` 这一行。它将 401 错误重定向到 `http://localhost/401.html`。
    *   `exploit.py`：该 Python 脚本利用 `pwn` 库发送构造的 HTTP 请求。它发送两个连续的 GET 请求，第一个请求的目标 Host 是 `localhost`，第二个请求的目标 Host 是 `adminhost`。
3.  **利用过程：** 攻击者发送两个 HTTP 请求，第一个请求触发 `error_page`， Nginx 将其重定向到指定的 URL。由于 Nginx 对请求处理的缺陷，会将第二个请求走私到后端服务器（adminhost）。因为 error_page 使用http://url，Nginx 会将第二个请求当作一个全新的请求处理，而忽略了连接中的未处理数据。
4.  **漏洞验证：** 攻击者可以通过发送如 POC 所示的构造的 HTTP 请求，如果能够成功访问 `adminhost` 上的资源（例如获取 flag），则说明漏洞存在。
5.  **投毒风险评估：** 经过对POC代码的分析，没有发现任何明显的恶意代码或后门。该仓库仅包含用于演示和验证漏洞的必要文件。`poison` 的可能性为 0%。 搜索结果显示，该漏洞在多个安全报告和 CVE 数据库中都有记录，进一步佐证了该漏洞的存在性和利用方式。
6.  **有效性评估：** POC代码有效。 该漏洞利用了 Nginx 配置不当导致的请求走私漏洞，如果目标环境满足漏洞触发条件，则可以利用该漏洞。

**项目地址:** [0xleft/CVE-2019-20372](https://github.com/0xleft/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---



---

## POC #2

**来源**: [CVE-2019-20372-moften_CVE-2019-20372.md](../2019/CVE-2019-20372-moften_CVE-2019-20372.md)

## CVE-2019-20372-Nginx HTTP Request Smuggling

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP Request Smuggling

**影响应用:** Nginx

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.17.7

**利用条件:** 需要Nginx服务器以负载均衡方式部署，并且存在特定的error_page配置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-20372 是一个 Nginx 的 HTTP 请求走私漏洞。此漏洞存在于 Nginx 1.17.7 之前的版本中，当 Nginx 使用特定的 error_page 配置时，允许攻击者通过构造恶意 HTTP 请求，走私请求到后端服务器，从而读取未授权的页面。

**漏洞利用方式：**
1.  攻击者发送一个精心构造的 HTTP 请求，该请求会被 Nginx 部分解析。
2.  由于 error_page 配置不当，Nginx 在处理错误页面时，会将后续的请求数据错误地附加到当前的请求中。
3.  负载均衡器将这个包含“走私”请求的请求转发到后端服务器。
4.  后端服务器会按照 Nginx 错误处理后的数据解析请求，导致“走私”的请求被当做下一个请求的一部分处理，从而可能访问到其他用户的请求或执行其他恶意操作。

**POC有效性：**
提供的 POC 代码尝试利用 PUT 方法上传一个 PHP 文件到目标服务器。如果服务器存在漏洞，并且 PUT 方法被允许，那么恶意 PHP 文件可能会被成功上传并执行。

**投毒风险：**
分析提供的Python脚本，脚本的主要功能是检测Nginx的版本并尝试上传一个包含`<?php system('id'); ?>`的PHP文件，该PHP文件的目的是执行`id`命令来验证漏洞是否成功利用。这个脚本本身并没有发现恶意或隐藏的代码，它只是一个简单的漏洞验证工具，因此判定不存在投毒代码。

**项目地址:** [moften/CVE-2019-20372](https://github.com/moften/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

## POC #3

**来源**: [CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md](../2019/CVE-2019-20372-vuongnv3389-sec_CVE-2019-20372.md)

## CVE-2019-20372-NGINX-HTTP请求走私

**漏洞编号:** CVE-2019-20372

**漏洞类型:** HTTP请求走私

**影响应用:** NGINX

**危害等级:** 中危，可能导致未授权访问和信息泄露

**影响版本:** < 1.17.7

**利用条件:** 需要特定 error_page 配置和 NGINX 前端存在负载均衡器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-20372是 NGINX 在 1.17.7 之前的版本中存在的一个 HTTP 请求走私漏洞。当 Nginx 配置了特定的 `error_page` 指令时，可能允许攻击者通过构造恶意的 HTTP 请求来绕过安全策略或访问未授权的页面。漏洞利用依赖于 Nginx 对包含不同长度的请求头的处理不一致，导致请求被错误地分割和路由。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞是有效的。多个来源 (如 Red Hat, NVD, Rapid7, Acunetix) 都证实了该漏洞的存在，并提供了相关的描述和修复方案。提供的 POC 代码展示了如何利用该漏洞读取本应隐藏的页面。

**投毒风险：**
分析提供的文件 `default.conf` 和 `readme` 可以发现，`default.conf` 定义了两个 server 块：一个处理 `localhost` 的请求，另一个处理 `notlocalhost` 的请求。`localhost` server 块将所有请求返回 401 错误，并将其重定向到 `http://example.org`。`notlocalhost` server 块包含一个 location 块 `/_hidden/index.html`，返回字符串 "This should be hidden!"。`readme` 文件提供了运行 Nginx 的 Docker 命令和利用漏洞的命令。利用方式是通过发送一个精心构造的 HTTP 请求，其中包含两个 HTTP 请求：第一个请求访问 `/a` 并触发 401 错误，第二个请求访问 `/_hidden/index.html`。由于 Nginx 处理 `Content-Length` 的方式，第二个请求可能会被错误地路由到 `notlocalhost` server 块，从而允许攻击者读取隐藏的页面。 Docker命令是标准的,用于快速搭建漏洞环境。

整体来看，仓库里的代码基本是漏洞复现代码，作者没有动机在nginx配置里面投毒，所以风险极小.

**利用方式：**
1.  **配置 Nginx：** 需要存在特定的 `error_page` 配置。本例中，所有对 `/` 的请求都会返回 401，并重定向。
2.  **负载均衡器：**  漏洞通常发生在 Nginx 前端存在负载均衡器的环境中，但 POC 可以在本地复现。
3.  **构造恶意请求：**  发送包含两个 HTTP 请求的请求。第一个请求触发 `error_page`，第二个请求是被走私的请求。
4.  **读取未授权页面：** 由于请求走私，第二个请求可能被 Nginx 错误地处理，从而允许攻击者访问本不该访问的页面。攻击者能够读取 `/_hidden/index.html` 的内容,达到信息泄露的目的。

**项目地址:** [vuongnv3389-sec/CVE-2019-20372](https://github.com/vuongnv3389-sec/CVE-2019-20372)

**漏洞详情:** [CVE-2019-20372](https://nvd.nist.gov/vuln/detail/CVE-2019-20372)

---

