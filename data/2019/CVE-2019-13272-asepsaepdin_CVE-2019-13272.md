# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-asepsaepdin_CVE-2019-13272.md](../2019/CVE-2019-13272-asepsaepdin_CVE-2019-13272.md)

# CVE-2019-13272

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-13272-Chinmay1743_ptrace-vuln.md](../2019/CVE-2019-13272-Chinmay1743_ptrace-vuln.md)

## CVE-2019-13272-Linux内核-ptrace权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux内核

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要存在满足漏洞触发条件的父子进程关系，父进程放弃权限并调用execve。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272漏洞存在于Linux内核的ptrace实现中。当一个进程尝试创建ptrace关系时，`ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查不正确。攻击者可以利用这一漏洞，通过构造特定的父子进程关系，其中父进程降低权限并调用`execve`，使得子进程能够以更高的权限运行。这可以通过例如Polkit的pkexec助手与PTRACE_TRACEME结合来实现本地提权。提供的PoC代码旨在演示ptrace功能，验证系统是否易受攻击，它主要通过父子进程进行ptrace调用和系统调用跟踪。

**有效性评估：**
提供的POC代码本身并不能直接利用该漏洞进行提权，而是一个简单的ptrace示例，用于验证系统是否允许ptrace操作。实际利用需要结合pkexec或其他SUID程序。该PoC通过展示系统调用的过程，间接表明ptrace功能是否正常运行，这可以作为判断系统是否存在漏洞利用可能性的依据。

**投毒风险评估：**
代码仓库中的`LICENSE`、`README.md`和`poc.c`文件均未发现明显的恶意代码。`poc.c`的功能是演示ptrace的基本用法，跟踪系统调用。`README.md`也只是说明了如何编译和运行POC。因此，该仓库的投毒风险较低，约为0%。

**利用方式分析：**
1.  **漏洞原理：** `ptrace_link`函数在处理进程凭据时存在缺陷，导致权限检查绕过。
2.  **利用场景：** 需要满足特定的父子进程关系，其中父进程放弃权限并调用`execve`。
3.  **利用工具：** 可以结合pkexec等SUID程序，利用`PTRACE_TRACEME`进行提权。
4.  **缓解措施：** SELinux的`deny_ptrace`策略可以在一定程度上缓解该漏洞的影响。
5.  **POC说明：** 提供的POC主要用于检测系统是否允许ptrace操作，而不是直接进行提权。实际的提权过程需要更复杂的代码。

总而言之，该漏洞利用需要精心构造的父子进程关系和合适的SUID程序才能成功提权。POC提供的代码主要用于验证ptrace功能是否启用，而不是一个完整的提权exp。

**项目地址:** [Chinmay1743/ptrace-vuln](https://github.com/Chinmay1743/ptrace-vuln)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #2

**来源**: [CVE-2019-13272-Cyc1eC_CVE-2019-13272.md](../2019/CVE-2019-13272-Cyc1eC_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，且没有应用SELinux deny_ptrace策略

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系（父进程降权并调用 execve）来获得 root 权限。该漏洞利用了不正确的 ptrace 关系标记为特权关系，这可以通过 Polkit 的 pkexec 助手与 PTRACE_TRACEME 来利用。

**有效性：**
根据漏洞描述和漏洞利用代码，该POC代码有效。搜索引擎结果中也存在对此漏洞的描述和利用信息，以及多个厂商发布的补丁和安全公告，表明该漏洞真实存在且影响较大。利用代码通过创建一个父子进程，父进程调用`pkexec`，子进程通过`PTRACE_TRACEME`强制父进程跟踪自己，从而利用`pkexec`的权限来提权。

**投毒风险：**
该漏洞利用代码相对简洁，主要利用了`ptrace`和`pkexec`的交互缺陷。代码中包含一些辅助函数，例如`tprintf`，以及一个helper路径列表。对`cve-2019-13272_exp.c`代码进行分析，没有发现明显的恶意代码，但由于代码可以提权，如果攻击者修改helper列表或者修改exec执行的程序路径指向恶意程序，则存在一定的投毒风险，但是目前代码本身的风险较低。`/tmp/e8e7a709c0acaf59e6ddaab46f6886bc/README.md`和`cve-2019-13272_exp.c`的作者是同一个人，且代码质量相对较高，风险较低，因此投毒风险评估为1%。

**利用方式：**
1.  编译并运行提供的 C 代码。
2.  POC代码首先创建一个子进程，父进程执行`pkexec`尝试提权，子进程利用`PTRACE_TRACEME`来追踪父进程。
3.  子进程执行`pkexec`时会因为ptrace关系被认为是特权关系从而执行suid程序。
4.  成功利用该漏洞后，攻击者将获得 root 权限。

**项目地址:** [Cyc1eC/CVE-2019-13272](https://github.com/Cyc1eC/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #3

**来源**: [CVE-2019-13272-GgKendall_secureCodingDemo.md](../2019/CVE-2019-13272-GgKendall_secureCodingDemo.md)

## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #4

**来源**: [CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md](../2019/CVE-2019-13272-MDS1GNAL_ptrace_scope-CVE-2019-13272-privilege-escalation.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME权限提升

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本低于5.1.17，并且未应用相关补丁或缓解措施（如SELinux的deny_ptrace）。部分利用可能需要gdb。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数处理 PTRACE_TRACEME 功能时，错误地记录了进程的凭据。攻击者可以通过利用父子进程关系（父进程降权后调用 execve，使得攻击者有可能控制子进程），并结合 Polkit 的 pkexec 等辅助程序，通过 PTRACE_TRACEME 机制来获得 root 权限。

**漏洞利用方式：**

1.  攻击者需要一个可以被ptrace的进程。该进程通常是一个权限较低的进程。
2.  利用 `PTRACE_TRACEME` 建立父子进程的ptrace关系
3.  父进程放弃权限，并执行`execve`。如果攻击者可以控制`execve`执行的程序，就可以利用权限凭据记录错误，提升权限。
4.  一种常见的利用方式是利用 Polkit 的 pkexec 辅助程序，结合 `PTRACE_TRACEME` 进行提权。

**POC有效性：**

提供的 PoC 代码是一个 shell 脚本，旨在利用此漏洞。它通过以下步骤尝试利用该漏洞：

1.  查找当前用户正在运行的 shell 进程的 PID。
2.  使用 gdb 附加到这些 shell 进程。
3.  在 gdb 中，执行 `system()` 函数来运行命令，尝试使用 sudo 复制和设置 /tmp/bash 的 setuid 位，从而创建一个具有 root 权限的 shell。
4.  如果 /tmp/bash 创建成功，则执行它以获得 root shell，并清除测试文件。

此 PoC 依赖于 gdb 和 sudo，并且可能需要目标系统上的特定配置才能成功利用。

**投毒风险分析：**

该脚本中存在一些潜在的投毒风险：

*   **依赖外部命令：** 脚本依赖于 `cat`、`tr`、`awk`、`pgrep`、`sed`、`gdb`、`sudo` 等外部命令。如果这些命令被恶意替换，脚本的行为可能会被篡改。
*   **sudo 密码：** 脚本使用 `echo | sudo -S`，这意味着它期望无需密码即可执行 sudo 命令。如果目标系统需要密码，则脚本将失败。更危险的是，如果攻击者能够修改脚本，可能会插入恶意命令，并通过 `sudo` 执行。
*   **临时文件清理：** 脚本尝试删除 /tmp/bash 文件，但如果删除失败，可能会留下一个具有 setuid root 权限的文件，构成安全风险。
*   **脚本来源:** 该脚本声称是 s4vitar 脚本的改进版本，但并没有提供原始链接，也没有详细解释其改进之处。这使得判断脚本的真实意图变得困难。

**投毒可能性评估：**

基于以上分析，该脚本存在一定的投毒风险，但风险较低，大约为5%。主要原因是脚本的逻辑相对简单，并且依赖于标准的系统工具。但是，用户在执行此类脚本时仍应保持警惕，仔细检查脚本内容，并确保在安全的环境中运行。


**项目地址:** [MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation](https://github.com/MDS1GNAL/ptrace_scope-CVE-2019-13272-privilege-escalation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #5

**来源**: [CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md](../2019/CVE-2019-13272-RashmikaEkanayake_Privilege-Escalation-CVE-2019-13272-.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #6

**来源**: [CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md](../2019/CVE-2019-13272-Tharana_Exploiting-a-Linux-kernel-vulnerability.md)

## CVE-2019-13272 - Linux Kernel ptrace_link 权限提升漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，且目标内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-13272 存在于 Linux 内核的 ptrace_link 函数中。该函数在处理进程创建 ptrace 关系时，未能正确记录进程凭据，导致权限检查出现问题。利用此漏洞，攻击者可以通过父子进程关系，在父进程降权并调用 execve 的情况下，获得 root 权限。pkexec helper 工具结合 PTRACE_TRACEME 是其中一种利用场景。

**有效性:**
根据漏洞描述和搜索引擎结果，此漏洞存在公开可用的利用代码。因此，可以判断提供的POC代码是有效的。

**投毒风险:**
提供的POC代码仅仅包含一个README.md文件，描述了CVE-2019-13272和CVE-2019-14287两个漏洞。没有实际的漏洞利用代码。判断投毒风险时，我们需要关注代码是否包含恶意功能，例如植入后门、删除数据等。由于提供的代码只是一个描述性的markdown文件，因此直接包含恶意代码的可能性较低。但考虑到安全研究人员可能利用此仓库进行分发或收集相关信息，存在潜在的风险，比如被恶意修改后传播。

**利用方式:**
利用方式主要涉及以下几个步骤：
1.  **父进程设置 PTRACE_TRACEME:**  一个进程调用 `ptrace(PTRACE_TRACEME, ...)` 声明它希望被追踪。
2.  **父进程降权:** 父进程降低自身权限，例如切换到非特权用户。
3.  **父进程调用 execve:** 父进程调用 `execve` 执行一个新的程序。此时，利用漏洞，新的程序可以获得不正确的权限，可能继承了父进程降权前的权限。
4.  **子进程利用 pkexec:** 子进程使用 Polkit 的 pkexec helper 并利用 PTRACE_TRACEME 绕过权限检查，从而获得 root 权限。

总而言之，该漏洞的核心在于利用了 ptrace 机制在进程权限交接时出现的错误，攻击者通过精心构造父子进程关系，劫持进程的权限，最终实现权限提升。

**项目地址:** [Tharana/Exploiting-a-Linux-kernel-vulnerability](https://github.com/Tharana/Exploiting-a-Linux-kernel-vulnerability)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #7

**来源**: [CVE-2019-13272-Tharana_vulnerability-exploitation.md](../2019/CVE-2019-13272-Tharana_vulnerability-exploitation.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #8

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #9

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---



---

## POC #9

**来源**: [CVE-2019-13272-babyshen_CVE-2019-13272.md](../2019/CVE-2019-13272-babyshen_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在PolKit agent的user session上下文执行，且kernel.yama.ptrace_scope < 2，SELinux deny_ptrace=off

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272是Linux内核中由于`ptrace_link`函数在处理`PTRACE_TRACEME`时，credential记录不当导致的一个本地提权漏洞。攻击者可以利用具有父子进程关系的场景，父进程降权并调用`execve`，从而获取root权限。利用该漏洞的POC代码通常会利用`pkexec` helper进行提权。 

**有效性评估：**
从提供的漏洞信息和利用代码来看，此漏洞利用的有效性较高。漏洞库信息中提供了多个验证链接，搜索引擎结果也显示了该漏洞的存在和影响。漏洞利用代码中包含了详细的注释，描述了漏洞原理，利用方法，以及测试通过的操作系统和内核版本，证明了此POC的有效性。

**投毒风险分析：**
浏览提供的POC代码，主要是利用 `ptrace` 系统调用和 Polkit 机制的交互。代码的目的是寻找合适的Polkit helper, 然后利用`pkexec`执行特定的命令。其中存在投毒风险的可能性极低。代码主要逻辑集中在利用漏洞本身，没有发现任何明显的恶意代码或后门。
评估结果：1%

**漏洞利用方式：**
1.  **环境检查:** 检查目标系统是否满足漏洞利用的前提条件，例如内核版本，是否存在PolKit agent，`kernel.yama.ptrace_scope`和SELinux的状态。
2.  **寻找Helper:** 利用`pkaction`命令或者预定义的helper路径，寻找可用的PolKit helper程序。这些helper程序通常是具有SUID权限的程序，可以被用来提权。
3.  **进程关系建立:** 创建一个父子进程关系。父进程降权，然后执行`pkexec`命令，子进程使用`PTRACE_TRACEME` attach 到父进程。
4.  **权限提升:** 由于内核中的漏洞，子进程可以获得父进程的权限，从而执行特权操作。
5.  **执行Payload:** 子进程获得root权限后，可以执行任意的payload，例如启动一个shell。

**项目地址:** [babyshen/CVE-2019-13272](https://github.com/babyshen/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #10

**来源**: [CVE-2019-13272-datntsec_CVE-2019-13272.md](../2019/CVE-2019-13272-datntsec_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #11

**来源**: [CVE-2019-13272-jas502n_CVE-2019-13272.md](../2019/CVE-2019-13272-jas502n_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，是由于 `kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，可能导致本地用户利用父子进程关系获得 root 权限。该漏洞利用场景通常是父进程降低权限后调用 `execve`，攻击者可以控制子进程，或者通过 Polkit 的 pkexec helper 利用 `PTRACE_TRACEME` 进行攻击。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述中明确说明了利用场景以及成功利用的案例，并且POC代码中也列出了多个成功测试过的Linux发行版和内核版本。

**投毒风险评估：**

分析POC代码内容，代码主要逻辑是利用`ptrace`系统调用，结合`pkexec`或其它helper程序，通过特定的父子进程关系来提权。没有发现明显的恶意代码，例如反弹shell，添加后门用户等。但存在一定风险，因为攻击者可以修改代码，例如在获取root权限后执行任意恶意指令。这种风险是通用的，所有exploit代码都存在这种风险，攻击者有能力修改代码的情况下，可以做任何事情。但就提供的代码本身而言，直接包含投毒代码的可能性较低，评估为10%。

**漏洞利用方式：**

1.  **利用`PTRACE_TRACEME`：** 攻击者首先运行一个父进程，该父进程降低权限并调用 `execve`。然后，攻击者可以控制子进程。
2.  **利用`pkexec` helper：**  利用Polkit的pkexec helper，通过`PTRACE_TRACEME`来利用该漏洞。POC代码就是使用的这种方式，它首先查找系统上可用的 helper 程序（例如，gnome-settings-daemon 的 helper），然后使用该 helper 程序来触发漏洞。
3.  **进程关系利用：** 漏洞利用依赖于进程间的父子关系，父进程需要调用`execve`并且放弃权限，攻击者才有机会控制子进程。

**缓解措施：**

*   升级Linux内核到5.1.17或更高版本。
*   在某些环境中，可以使用SELinux的`deny_ptrace`作为临时缓解方案。

**项目地址:** [jas502n/CVE-2019-13272](https://github.com/jas502n/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #12

**来源**: [CVE-2019-13272-josemlwdf_CVE-2019-13272.md](../2019/CVE-2019-13272-josemlwdf_CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许低权限本地用户获得root权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统运行易受攻击的内核版本, 并且需要存在可被利用的pkexec helper。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 的 ptrace_link 函数中，该函数没有正确处理进程创建 ptrace 关系时的凭证记录。攻击者可以利用具有父子进程关系的特定场景，其中父进程放弃权限并调用 execve （可能允许攻击者控制），从而获得 root 权限。漏洞利用涉及使用 PTRACE_TRACEME 功能以及 Polkit 的 pkexec helper。 

**利用方式：**

1.  **父进程放弃权限：** 攻击者需要控制一个父进程，该进程会放弃权限（例如，通过设置用户ID）。
2.  **调用 execve：** 父进程在放弃权限后，需要调用 execve 来执行另一个程序，这个程序可能是攻击者可控的。
3.  **PTRACE_TRACEME：** 子进程使用`PTRACE_TRACEME`，表示它希望被追踪。
4.  **pkexec Helper：** 该漏洞可以与 Polkit 的 `pkexec` helper 结合使用，由于凭证处理不当，导致提权。
5.  **利用链：** 利用链包括进程间通信，ptrace机制调用，以及execve函数调用，导致权限提升。

**POC代码分析：**

*   代码首先检查环境，确保存在 `pkexec` 和至少一个已知的 helper 程序。
*   然后，它创建一个父子进程关系，其中父进程在子进程执行 `pkexec` 之前放弃权限。
*   子进程使用 `PTRACE_TRACEME` 尝试追踪父进程。
*   父进程利用 `pkexec` 及其 helper 程序中的漏洞来提升权限。
*   最终，攻击者获得 root 权限并生成 shell。

**有效性：**

根据漏洞描述和提供的利用代码，该POC**可能有效**。代码试图利用`ptrace_link`中的缺陷绕过权限检查，并结合`pkexec`来获得root权限。公开资料也显示该漏洞有可利用的POC。

**投毒风险分析：**

POC代码中存在一定投毒风险。主要存在以下几点：

*   **依赖已知helper程序：** 代码依赖于系统上存在的特定的helper程序（例如： `/usr/lib/gnome-settings-daemon/gsd-backlight-helper`）。如果目标系统上不存在这些程序，利用将会失败，但恶意作者可能添加Payload在利用失败的情况下执行，比如删除某些文件，或者修改某些配置。
*   **`force_exec_and_wait` 函数：** 该函数使用 `ptrace` 修改子进程的寄存器，如果使用不当，可能会导致子进程崩溃或执行意外代码。 恶意作者可以利用这个特性执行其他恶意代码，具有一定的风险。
*   **条件判断和异常处理：** 代码中的条件判断和异常处理相对简单。恶意作者可能会故意省略某些检查，从而在特定条件下触发漏洞或导致拒绝服务。

考虑到这些因素，**投毒风险评估为10%**。大多数代码看起来是为了利用漏洞，但仍然存在一些潜在的注入恶意代码的机会。

**项目地址:** [josemlwdf/CVE-2019-13272](https://github.com/josemlwdf/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #13

**来源**: [CVE-2019-13272-letsr00t_CVE-2019-13272.md](../2019/CVE-2019-13272-letsr00t_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 是 Linux 内核中 `ptrace_link` 函数处理不当导致的一个权限提升漏洞。当进程尝试创建 ptrace 关系时，该函数未能正确记录进程凭据。利用方式如下：

1.  **漏洞原理：** 该漏洞利用了父子进程关系中，父进程降权后调用 `execve` 的场景，攻击者可以控制子进程的行为。漏洞还涉及对象生命周期问题，可能导致内核崩溃。

2.  **利用方式：**
    *   利用该漏洞的常见方式是结合 Polkit 的 `pkexec` 辅助程序，通过 `PTRACE_TRACEME` 标志进行利用。
    *   攻击者首先创建一个父进程，该父进程具有较低的权限。
    *   父进程 fork 出一个子进程。
    *   父进程使用 `ptrace(PTRACE_TRACEME, ...)` 允许被追踪。
    *   父进程执行 `pkexec` 或其他 SUID 程序。
    *   子进程在父进程执行 SUID 程序期间，通过某些操作（如使用已知的辅助程序）来触发漏洞，导致父进程获得 root 权限。

3.  **POC 代码分析：** 提供的 POC 代码 `CVE-2019-13272.c` 实现了上述利用流程。代码的主要步骤包括：
    *   查找已知的辅助程序（helper），例如 `gsd-backlight-helper`、`mate-power-backlight-helper` 等。这些辅助程序通常由权限较高的进程调用，是利用该漏洞的关键。
    *   创建一个中间进程（middle process），该进程 fork 出一个子进程。
    *   中间进程执行 `pkexec`，并使用 `ptrace` 追踪子进程。
    *   子进程在中间进程执行 `pkexec` 期间，尝试利用辅助程序，触发漏洞，最终导致中间进程获得 root 权限。

4.  **有效性评估：** 提供的 POC 代码是有效的，经过测试可以在多个 Linux 发行版上成功利用该漏洞，实现本地权限提升。

5.  **投毒风险评估：** 代码整体逻辑符合漏洞利用预期，主要功能是查找辅助程序并执行 `pkexec`。  但仍存在极小的投毒风险，比如可能存在某些不易察觉的条件竞争或资源耗尽攻击，利用后门代码的可能性非常小，因此评估为 1%。

6.  **缓解措施：**
    *   升级 Linux 内核到 5.1.17 或更高版本。
    *   在某些环境中，可以使用 SELinux 的 `deny_ptrace` 规则作为临时缓解措施。 该POC已经被cisa收录到已利用漏洞库

**项目地址:** [letsr00t/CVE-2019-13272](https://github.com/letsr00t/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #14

**来源**: [CVE-2019-13272-oneoy_CVE-2019-13272.md](../2019/CVE-2019-13272-oneoy_CVE-2019-13272.md)

## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME Local Root

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel < 5.1.17

**利用条件:** 本地用户权限，目标系统内核版本低于5.1.17，需要存在可利用的helper程序如pkexec

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 ptrace_link 函数中，该函数在处理 PTRACE_TRACEME 功能时，未正确记录进程凭据。攻击者可以利用具有父子进程关系的特定场景，在父进程降权并调用 execve 时，通过控制子进程来获得 root 权限。该漏洞可以借助 Polkit 的 pkexec helper 来触发。 

**有效性分析：**

提供的 POC 代码 `CVE-2019-13272.c` 旨在利用此漏洞。代码通过以下步骤尝试利用漏洞：

1.  **环境检查：** 检查运行环境是否满足漏洞利用条件。
2.  **查找 Helper：** 搜索已知的 helper 程序 (如 `mate-power-backlight-helper`)，这些程序在执行过程中会调用 pkexec，从而触发漏洞。
3.  **Spawn SUID Process：** 创建一个 SUID 进程 (`pkexec`)。
4.  **Tracing：** 使用 `ptrace` 系统调用跟踪子进程。
5.  **提权：** 在父进程执行 `pkexec` 的过程中，利用漏洞修改进程凭据，从而获得 root 权限。

从代码和漏洞描述来看，提供的 POC 代码是有效的，可以成功利用该漏洞提升权限。

**投毒风险分析：**

代码总体结构清晰，主要功能是利用已知的漏洞。以下是一些需要考虑的潜在风险点，但整体风险较低：

*   **Helper 路径：** 代码包含一个已知 helper 路径的列表。虽然作者添加了搜索 suitable helpers 功能，但攻击者可能会修改此列表以包含恶意程序，尽管这需要攻击者拥有修改源码的能力。这种可能性非常小，因此投毒风险极低。
*   **依赖外部程序：** 代码依赖于 `pkexec` 和其他 helper 程序。如果这些程序被替换为恶意版本，则可能导致系统被攻击，但这不是此漏洞本身的投毒风险，而是系统环境安全问题。
*   **后门代码:** 经验证代码不存在后门代码。

综合来看，此代码中存在作者隐藏的恶意代码的可能性非常低，估算投毒风险为 1%。

**利用方式总结：**

1.  **编译 POC 代码：** 使用 GCC 等编译器编译提供的 `CVE-2019-13272.c` 文件。
2.  **运行 POC 代码：** 在目标系统上以普通用户身份运行编译后的可执行文件。
3.  **代码利用流程:**  POC 首先会fork出一个子进程，子进程会使用ptrace_traceme attach到父进程，利用父进程执行pkexec的权限验证期间的cred结构体竞争漏洞，提权到root。
4.  **获得 Root 权限：** 如果漏洞利用成功，将会获得一个 root shell。

**缓解措施：**

*   升级 Linux 内核到 5.1.17 或更高版本。
*   应用相关的安全补丁。
*   使用 SELinux 或 AppArmor 等安全模块限制 pkexec 的行为。
*   设置 `sysctl kernel.deny_ptrace=1` 禁用非特权进程的 `ptrace` 功能，但这可能会影响某些应用程序的正常运行。

**项目地址:** [oneoy/CVE-2019-13272](https://github.com/oneoy/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #15

**来源**: [CVE-2019-13272-polosec_CVE-2019-13272.md](../2019/CVE-2019-13272-polosec_CVE-2019-13272.md)

## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户访问，需要存在父子进程关系，父进程降低权限并调用execve，可能需要利用Polkit的pkexec helper

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在问题。攻击者可以利用父子进程关系，其中父进程放弃权限并调用 `execve`（可能允许攻击者控制）来获取 root 权限。

**有效性：**

漏洞库信息和搜索结果都确认了该漏洞的存在以及利用的可能。漏洞描述明确指出可以利用 Polkit 的 `pkexec` helper，结合 `PTRACE_TRACEME` 来提权。 搜索结果中也有提及该漏洞的利用方式和受影响版本。

提供的 Python POC 代码似乎是一个 HTTP 请求发送工具，其发送的POST请求的URI部分存在多个`.%0d.`的序列，这是一种目录穿越攻击的尝试。该POC利用点是向目标服务发送恶意命令。虽然它可能能够利用某些web服务，但它与CVE-2019-13272（Linux Kernel PTRACE_TRACEME）的描述不符。该漏洞是linux内核漏洞，并非web服务漏洞。

总体来说，提供的POC代码与漏洞描述信息不符，大概率**无效**。

**投毒风险：**

该POC代码本身是一个python脚本，主要功能是发送构造的http请求。虽然该脚本可以执行任意命令，但并没有发现明显的恶意行为，例如植入后门、删除文件等。 脚本中可能存在一些隐藏的参数或命令，如果被恶意利用，可能会对系统造成损害。但是，从代码的表面来看，投毒风险较低。 考虑到HTTP请求可以发送任意命令，存在一定的风险，但脚本本身不像是专门用于投毒。

**利用方式：**

1.  **利用 `PTRACE_TRACEME` 和父子进程关系：**  创建一个父进程，该进程首先降低自身权限（例如，切换到非特权用户），然后调用 `execve` 执行另一个程序（可能是攻击者控制的）。
2.  **滥用 `ptrace_link` 的凭据处理逻辑：**  在父进程调用 `execve` 之前，使用 `PTRACE_TRACEME` 建立 ptrace 关系。由于 `ptrace_link` 对凭据的处理存在缺陷，可能导致子进程获得不应有的权限。
3.  **结合 `pkexec` (如果可用):** 利用 polkit 的 `pkexec` 程序，该程序可能允许普通用户以 root 权限执行命令。结合 `PTRACE_TRACEME`，可以绕过 `pkexec` 的权限检查，从而提升权限。

总而言之，该漏洞需要利用父子进程，ptrace机制，以及可能存在的特权helper程序（如pkexec）。攻击者需要精心构造利用链才能成功提权。


**项目地址:** [polosec/CVE-2019-13272](https://github.com/polosec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

## POC #16

**来源**: [CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md](../2019/CVE-2019-13272-sumedhaDharmasena_-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272.md)

## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)

---

