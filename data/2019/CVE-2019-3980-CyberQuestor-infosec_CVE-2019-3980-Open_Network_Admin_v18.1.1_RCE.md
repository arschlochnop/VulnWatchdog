# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md](../2019/CVE-2019-3980-CyberQuestor-infosec_CVE-2019-3980-Open_Network_Admin_v18.1.1_RCE.md)

# CVE-2019-3980

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-3980-Barbarisch_CVE-2019-3980.md](../2019/CVE-2019-3980-Barbarisch_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥Local Systemæƒé™è¿è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agentï¼Œä¸”æ”»å‡»è€…å¯ä»¥å»ºç«‹ç½‘ç»œè¿æ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service 12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡æ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶å¹¶åœ¨ DWRCS.exe ä¸»æœºä¸Šæ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€æŠ«éœ²çš„ã€å­˜åœ¨æœ‰æ•ˆPOCçš„æœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š
1.  README.mdï¼šåŒ…å«æ¼æ´æè¿°ã€ç¼–è¯‘å’Œä½¿ç”¨è¯´æ˜ï¼Œä»¥åŠå…³äºä¿®æ”¹ OpenSSL ä»¥å…è®¸ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„è­¦å‘Šã€‚è¿™éƒ¨åˆ†å­˜åœ¨ä¸€å®šé£é™©ï¼Œå› ä¸ºä¿®æ”¹åŠ å¯†åº“å¯èƒ½å¼•å…¥å®‰å…¨é—®é¢˜ã€‚
2.  OpenSSL å¤´æ–‡ä»¶ï¼šç”¨äºåŠ å¯†é€šä¿¡ã€‚
3.  POCä»£ç ï¼šC++ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´ä¸Šä¼ å¹¶æ‰§è¡Œå¯æ‰§è¡Œæ–‡ä»¶ã€‚

ç”±äº README æ˜ç¡®æŒ‡å‡ºä¿®æ”¹äº† OpenSSL åº“ä»¥å…è®¸ä½¿ç”¨ä¸å®‰å…¨çš„å¯†é’¥é•¿åº¦ (512 bits -> 128 bits)ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ç§æ½œåœ¨çš„é£é™©ã€‚è™½ç„¶è¯´æ˜ç›®çš„æ˜¯ä¸ºäº†PoCçš„æˆåŠŸï¼Œä½†å¦‚æœåœ¨å®é™…ç¯å¢ƒä¸­ä½¿ç”¨äº†ä¿®æ”¹åçš„ OpenSSL åº“ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–å®‰å…¨é—®é¢˜ã€‚ 

æ­¤å¤–ï¼ŒC++ä»£ç éœ€è¦ç¼–è¯‘ï¼Œè¿™æ„å‘³ç€æ”»å‡»è€…éœ€è¦åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šç¼–è¯‘æˆ–ä¸Šä¼ é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ä¸Šä¼ äºŒè¿›åˆ¶æ–‡ä»¶çš„è¡Œä¸ºæœ¬èº«å°±å­˜åœ¨é£é™©ï¼Œå¦‚æœæ”»å‡»è€…æ›¿æ¢äº†åŸå§‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé—¨ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä¿®æ”¹OpenSSLåº“çš„å¿…è¦æ€§ï¼Œä»¥åŠå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¾èµ–ä¸Šã€‚ æŠ•æ¯’çš„å¯èƒ½æ€§è¯„åˆ†ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ä¸ç›®æ ‡ Dameware Mini Remote Client Agent Service å»ºç«‹ç½‘ç»œè¿æ¥ã€‚
2.  æ”»å‡»è€…æ¨¡æ‹Ÿæ™ºèƒ½å¡è®¤è¯è¿‡ç¨‹ï¼Œåˆ©ç”¨æ¼æ´ä¸Šä¼ æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
3.  Agent Service æ‰§è¡Œä¸Šä¼ çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚
4.  æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æƒé™æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

**é¡¹ç›®åœ°å€:** [Barbarisch/CVE-2019-3980](https://github.com/Barbarisch/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

## POC #2

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---



---

## POC #3

**æ¥æº**: [CVE-2019-3980-warferik_CVE-2019-3980.md](../2019/CVE-2019-3980-warferik_CVE-2019-3980.md)

## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**æ¼æ´ç¼–å·:** CVE-2019-3980

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒçš„è¿œç¨‹æ”»å‡»è€…ä»¥Local Systemæƒé™æ‰§è¡Œä»»æ„ä»£ç ã€‚

**å½±å“ç‰ˆæœ¬:** Versions up to and including 12.1.0.89

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å—å½±å“ç‰ˆæœ¬çš„Dameware Mini Remote Client Agent Serviceï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿä¸ç›®æ ‡ç³»ç»Ÿå»ºç«‹ç½‘ç»œè¿æ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-3980 æ¼æ´å­˜åœ¨äº SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…é€šè¿‡åˆ©ç”¨æ™ºèƒ½å¡è®¤è¯æœºåˆ¶ï¼Œä¸Šä¼ æ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶åˆ° DWRCS.exe è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œæƒé™ä¸ºLocal Systemã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆå‘ç›®æ ‡ç³»ç»Ÿå‘èµ·æ™ºèƒ½å¡ç™»å½•è¯·æ±‚ã€‚
2.  åˆ©ç”¨æ¼æ´ï¼Œä¸Šä¼ ä¸€ä¸ªç‰¹åˆ¶çš„æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆC# exeï¼‰ã€‚
3.  æ¶æ„å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œè¯¥ç¨‹åºä¼šå›è¿åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œè·å–è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä»æ”»å‡»è€…æœåŠ¡å™¨çš„/cmdè·¯å¾„ï¼‰ã€‚
4.  åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œä»æœåŠ¡å™¨è·å–çš„å‘½ä»¤ã€‚
5.  æ‰§è¡Œç»“æœé€šè¿‡ base64 ç¼–ç åé€šè¿‡ GET è¯·æ±‚å‘é€åˆ°æ”»å‡»è€…çš„ Web æœåŠ¡å™¨ã€‚
6.  æ”»å‡»è€…ä» Web æœåŠ¡å™¨æ¥æ”¶æ‰§è¡Œç»“æœï¼Œå¹¶è¿›è¡Œè§£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æœ‰æ•ˆã€‚è¯¥POCåŒ…å«ä¸€ä¸ª Python è„šæœ¬å’Œä¸€ä¸ª C# å¯æ‰§è¡Œæ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

*   **C# å¯æ‰§è¡Œæ–‡ä»¶ï¼š**æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹C#å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ·»åŠ é¢å¤–çš„æ¶æ„åŠŸèƒ½ï¼Œä¾‹å¦‚æŒä¹…åŒ–åé—¨æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚è™½ç„¶ç›®å‰çš„åŠŸèƒ½çœ‹èµ·æ¥æ¯”è¾ƒç›´æ¥ï¼Œä½†å­˜åœ¨éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚
*   **WebæœåŠ¡å™¨ï¼š**Pythonè„šæœ¬ä¸­å¯åŠ¨çš„ç®€æ˜“WebæœåŠ¡å™¨å¯èƒ½ä¼šè¢«ç”¨äºåˆ†å‘å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…è®°å½•å—å®³è€…çš„IPåœ°å€ç­‰ä¿¡æ¯ã€‚è„šæœ¬çš„åŠŸèƒ½æ˜¯æ¥æ”¶æ‰§è¡Œç»“æœ,è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ç®€å•åœ°æ¥æ”¶base64ç¼–ç åçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ’é™¤è®°å½•IPæˆ–å…¶ä»–ä¿¡æ¯çš„å¯èƒ½ã€‚
*   **ä¾èµ–é¡¹é£é™©ï¼š**  è„šæœ¬ä¾èµ– `Crypto` åº“ï¼Œè¿™äº›åº“çš„ç‰ˆæœ¬å¦‚æœè¿‡ä½æˆ–è€…æ¥è‡ªä¸å—ä¿¡ä»»çš„æºï¼Œå¯èƒ½å¼•å…¥é¢å¤–çš„å®‰å…¨é£é™©ï¼Œä½†æ­¤é¡¹é£é™©è¾ƒä½,å±äºåŸºæœ¬é£é™©ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶POCä»£ç ä¸»è¦ç”¨äºæ‰§è¡Œå‘½ä»¤ï¼Œä½†æ½œåœ¨çš„é£é™©ç‚¹åœ¨äºC#ç¨‹åºå’ŒWebæœåŠ¡å™¨çš„åˆ©ç”¨ï¼Œä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ä½¿ç”¨å‰åŠ¡å¿…è¿›è¡Œä»£ç å®¡è®¡ï¼Œé¿å…å—åˆ°æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)

---

