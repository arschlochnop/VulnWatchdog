# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

# CVE-2019-18634

> 📦 该CVE有 **13** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-18634-DDayLuong_CVE-2019-18634.md](../2019/CVE-2019-18634-DDayLuong_CVE-2019-18634.md)

## CVE-2019-18634 - Sudo pwfeedback 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的缓冲区溢出漏洞。如果 /etc/sudoers 文件中启用了 pwfeedback 选项，则用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有可用的PoC利用代码。github上plazmaz的POC也验证了漏洞的存在。提供的PoC代码包含一个 Perl 脚本 (xpl.pl) 用于生成溢出字符串，一个 C 程序 (exec.c) 用于在利用成功后执行提权操作，以及一个 Shell 脚本 (self-contained.sh 或 src/run.sh) 来自动化利用过程。

**利用方式：**

1.  **条件检查：** 漏洞利用依赖于 /etc/sudoers 中 pwfeedback 选项的启用。如果未启用，则漏洞不可利用。
2.  **利用步骤：**
    *   `socat` 创建一个伪终端（pty），将输入/输出连接到执行 Perl 脚本的进程。
    *   Perl 脚本 (xpl.pl) 生成一个精心构造的字符串，该字符串会溢出 `tgetpass.c` 中的 `getln()` 函数的缓冲区。这个payload覆盖了栈上的返回地址和其他关键数据，以便控制程序执行流程。
    *   `export SUDO_ASKPASS=/tmp/pipe` 设置 `SUDO_ASKPASS` 环境变量，告诉 `sudo` 命令使用 `/tmp/pipe` 作为密码输入程序。
    *   `sudo -k -S id < /tmp/pty` 执行 `sudo` 命令，`-k` 选项清除缓存的密码，`-S` 选项强制从标准输入读取密码。输入重定向自伪终端 `/tmp/pty`，这意味着 Perl 脚本生成的溢出字符串会被作为密码传递给 `sudo`。
    *   溢出发生后，程序执行流程被重定向到预先编译的可执行文件 `/tmp/pipe`。
    *   C 程序 (exec.c) 首先检查自身是否以 root 权限运行。如果不是，它会尝试使用 `fchown` 和 `fchmod` 来更改其所有者和权限，设置 SUID 位。如果已经是 root 权限，则会直接使用 `setuid(0)` 设置用户 ID 为 0（root），然后执行 `/bin/bash`，从而获得 root shell。

**投毒风险：**

虽然PoC似乎是功能性的，但其中存在潜在的投毒风险。风险分析如下：

*   **exec.c 中的权限修改：** C代码首先通过open，fstat获取当前可执行文件的uid，gid和权限，如果当前用户不是root权限，则通过fchown将当前文件的uid修改为0(root)，然后通过fchmod添加suid权限。如果编译后的可执行文件`/tmp/pipe`已经被root权限运行，添加suid权限，会导致一些安全问题。所以poc存在一定的风险。
*   **依赖外部程序：** 脚本依赖 `socat`，如果 `socat` 源被篡改，可能会引入恶意代码。但是脚本会首先检测本地是否存在socat，不存在的情况下，从github的raw链接下载，github具有一定的代码审计能力，降低了被投毒的风险。
*   **Perl 脚本：** Perl 脚本生成溢出字符串，虽然脚本本身相对简单，但如果脚本逻辑被篡改，可能会导致拒绝服务或意外行为。

综合考虑，投毒风险主要集中在 `exec.c` 赋予可执行文件不必要的权限上，以及对 `socat` 的依赖上。假设作者故意植入后门，最可能的手段是篡改 `exec.c`，但可能性较低，因为提权方式比较明显。因此，投毒风险估计为 10%。

**项目地址:** [DDayLuong/CVE-2019-18634](https://github.com/DDayLuong/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #2

**来源**: [CVE-2019-18634-N1et_CVE-2019-18634.md](../2019/CVE-2019-18634-N1et_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 tgetpass.c 中的 getln() 函数的标准输入 (stdin) 传递一个长字符串来触发该漏洞，导致特权 sudo 进程中的栈缓冲区溢出。利用代码包含一个`exec.c` 文件, 用于修改 `/proc/self/exe` 文件权限为SUID,并尝试调用 `/bin/bash` 获取shell，或者直接调用`/bin/bash`。 `exploit.py` 脚本生成溢出payload，包含大量的null字节填充,以及一些标志位和user_details数据。 `run.py` 脚本负责编译`exec.c`，设置环境变量`SUDO_ASKPASS`指向编译后的`exec.c`,然后通过`sudo -k -S id` 命令触发漏洞。

**有效性：** 根据搜索结果和漏洞描述，提供的POC代码应该有效，前提是目标系统满足漏洞利用的条件（sudo 版本低于 1.8.26 且启用了 pwfeedback）。

**投毒风险：** 该代码的主要功能是权限提升，但存在轻微的投毒风险。`exec.c`首先修改了`/proc/self/exe`的权限为SUID。虽然这在漏洞利用后允许非特权用户执行`exec.c`来获得root权限，但是恶意攻击者可能会利用这一点来植入后门。此外，exploit的有效性依赖于pwfeedback的开启，这本身不是一个默认配置，可能导致exploit无法工作，或被攻击者诱导开启该配置。整体投毒风险较低，约为 10%。

**利用方式：**

1.  **前提条件：** 目标系统运行着存在漏洞的 Sudo 版本 (低于 1.8.26)，且 /etc/sudoers 文件中启用了 pwfeedback 选项。
2.  **Payload生成：** 使用 `exploit.py` 脚本生成用于触发缓冲区溢出的恶意payload。
3.  **编译和执行：** 编译 `exec.c`，并设置 `SUDO_ASKPASS` 环境变量指向编译后的可执行文件。
4.  **漏洞触发：** 通过执行 `sudo -k -S id < /tmp/pty` 命令，触发 sudo 请求密码，从而调用 `getln()` 函数，并将恶意 payload 传递给它，导致栈缓冲区溢出。
5.  **权限提升：** 成功溢出后，程序执行流程被劫持，最终通过修改自身权限或直接调用`/bin/bash`获取 root 权限。


**项目地址:** [N1et/CVE-2019-18634](https://github.com/N1et/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #3

**来源**: [CVE-2019-18634-Plazmaz_CVE-2019-18634.md](../2019/CVE-2019-18634-Plazmaz_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-堆栈缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26 (实际 PoC 针对 <= 1.8.30)

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中存在的一个堆栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 时，用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送过长的字符串来触发该漏洞，导致特权 `sudo` 进程中的缓冲区溢出，从而实现权限提升。漏洞利用代码分析如下：

1.  **有效性分析：**根据提供的漏洞信息和漏洞利用代码，该PoC代码针对 Sudo <= 1.8.30 版本，且需要在 `/etc/sudoers` 中启用 `pwfeedback`。`README.md` 指出该代码在 1.8.25 上测试通过，但在更高版本上存在字符处理差异问题，但不影响漏洞的可利用性。搜索引擎结果也提供了多个漏洞分析和利用的参考链接，确认了漏洞的存在和可利用性。

2.  **投毒风险分析：**PoC 代码主要由以下几个部分组成：
    *   `xpl.pl`: Perl 脚本，用于生成溢出 payload。该脚本构造一个包含大量 `\x00\x15` 的字符串，以及一些标志位和用户详情，以触发缓冲区溢出。
    *   `exec.c`: C 语言程序，用于修改 `/proc/self/exe` 的权限，使其具有 SUID 位。如果当前用户不是 root，则该程序会将 `sudo` 二进制文件更改为 root 用户所有，并设置 SUID 位。如果是 root 用户，则直接调用 `execve("/bin/bash",NULL,NULL)` 获取 root shell。这一部分的功能具有一定的风险，可能被恶意利用，但是根据代码功能来看，它仅仅是为了提升权限所做的操作。因此，将此部分判定为投毒风险的概率较低。
    *   `self-contained.sh`: Shell 脚本，用于下载 socat (如果不存在)，创建命名管道，设置 `SUDO_ASKPASS` 环境变量，并执行 `sudo` 命令。`socat` 用于创建伪终端，`SUDO_ASKPASS` 用于指定密码输入程序。这个脚本是整个漏洞利用的核心。

    综合来看，该漏洞利用代码的目的是实现权限提升。其中,`exec.c`的功能如果被滥用可能会导致程序SUID权限的滥用，但这是漏洞利用过程中的一部分，无法直接断定为恶意投毒。socat作为辅助工具，本身不包含投毒行为。因此，整体投毒风险较低，判定为 **5%**。

3.  **利用方式总结：**
    1.  **前提条件：**
        *   目标系统上存在漏洞版本的 `sudo`（< 1.8.26，PoC 适用于 <= 1.8.30）。
        *   `/etc/sudoers` 中启用了 `pwfeedback`。
    2.  **利用步骤：**
        *   下载或创建 `socat` 工具。
        *   创建命名管道 `/tmp/pipe`。
        *   设置 `SUDO_ASKPASS` 环境变量，指向 `/tmp/pipe`。
        *   运行 `sudo -k -S id < /tmp/pty`，触发密码提示。
        *   `xpl.pl` 脚本生成恶意 payload，通过管道发送给 `sudo` 进程。
        *   `sudo` 进程中的 `getln()` 函数发生缓冲区溢出，覆盖堆栈上的数据。
        *   `exec.c` 程序被执行，修改 `sudo` 权限或直接获取 root shell。

    通过精心构造的 payload，攻击者可以在 `sudo` 进程中覆盖返回地址，从而劫持程序执行流程，最终实现权限提升。

**项目地址:** [Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #4

**来源**: [CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md](../2019/CVE-2019-18634-TheJoyOfHacking_saleemrashid-sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 必须在 /etc/sudoers 中启用。攻击者需要能够向 getln() 函数的 stdin 发送长字符串。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。如果 /etc/sudoers 中启用了 pwfeedback，未经授权的用户可以利用此漏洞在特权 sudo 进程中触发栈缓冲区溢出，从而可能提升权限。

**有效性：**
提供的 PoC 代码旨在利用 CVE-2019-18634 漏洞。根据代码和搜索结果，该 PoC 在特定条件下有效。

**投毒风险：**
检查提供的 PoC 代码 `/tmp/6d1d5772a9491e9f9f0cc192fb98b3f1/exploit.c`，没有发现明显的恶意代码或后门。
*   代码结构清晰，主要功能是利用缓冲区溢出漏洞。
*   利用方式相对直接，通过发送超长字符串到 `stdin` 触发溢出。
*   包含license，Makefile，以及readme，相对规范。
但是，任何代码都存在潜在风险，特别是当它以提升权限为目标时。虽然目前没有直接证据表明存在投毒代码，但是，代码的复杂性和潜在的利用方式，我们仍然无法完全排除作者隐藏的、不明显的恶意行为的可能性。
因此，投毒风险评估为 1%。

**利用方式：**
1.  **前提条件：** pwfeedback 必须在 `/etc/sudoers` 文件中启用。该设置默认情况下通常是禁用的，但在 Linux Mint 和 elementary OS 中是默认启用的，或由管理员手动启用。
2.  **获取利用代码：** 下载并编译提供的 exploit.c 代码。
3.  **伪终端分配：** PoC 首先分配一个伪终端 (pty) 作为标准输入，这是为了确保 `sudo_term_kill` 不为 0，从而允许利用缓冲区溢出。
4.  **禁用终端预处理：**  禁用终端的预处理功能 (`cfmakeraw`)，避免 payload 被终端驱动修改。
5.  **修改 VEOF 字符：** 将 VEOF 字符修改为 0xAA，避免与 TGP_ASKPASS 冲突。
6.  **构造 Payload：**  程序构造一个超长字符串，通过标准输入传递给 `sudo` 命令。这个字符串会覆盖栈上的缓冲区，以及其他关键数据。
7.  **触发溢出：**  当 `sudo` 请求密码时，PoC 将构造的 payload 发送到 `stdin`。
8.  **权限提升：** 如果溢出成功，攻击者可以执行任意代码，从而获得提升的权限（通常是 root 权限）。
9.  **执行 Shell：** 成功利用漏洞后，代码会尝试执行一个 shell (`/bin/sh`)，允许攻击者以 root 身份运行命令。

**总结：**
该漏洞的利用依赖于特定配置（pwfeedback 启用），并且需要攻击者能够执行该利用程序。 成功的利用可能导致完全的系统控制。在目标系统上部署该 PoC 之前，应该谨慎评估风险，并在安全环境中进行测试。强烈建议更新到 Sudo 的修复版本。

**项目地址:** [TheJoyOfHacking/saleemrashid-sudo-cve-2019-18634](https://github.com/TheJoyOfHacking/saleemrashid-sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---



---

## POC #5

**来源**: [CVE-2019-18634-aesophor_CVE-2019-18634.md](../2019/CVE-2019-18634-aesophor_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 pwfeedback，普通用户可以触发特权 sudo 进程中的基于栈的缓冲区溢出。根据漏洞信息和搜索结果，POC代码利用了 tgetpass.c 中的 getln() 函数的栈缓冲区溢出漏洞。该利用代码首先配置了反向shell，然后利用缓冲区溢出覆盖了 tgetpass_flags 和 user_details 结构体，以绕过密码验证并获得 root 权限。

**有效性：** 根据提供的漏洞信息、搜索结果（特别是GitHub上的POC仓库）和漏洞利用代码，该漏洞的POC代码是有效的。该代码旨在Ubuntu 20.04上，sudo版本为1.8.25，并且需要安装pwntools。

**投毒风险：** 分析提供的 exploit.py 文件，未发现明显的恶意代码或后门。该脚本的功能集中于利用漏洞本身，创建反向 shell 连接到攻击者控制的端口。 该脚本首先创建一个反向 shell 脚本 `/tmp/reverse.sh`。然后，它尝试启动一个连接到 `127.0.0.1` 上的指定端口 (30678) 的反向 shell。这段代码本身没有隐藏的恶意功能，是漏洞利用的常规组成部分。然后利用缓冲区溢出覆盖 `tgetpass_flags` 和 `user_details` 结构，劫持控制流。

**利用方式：**
1.  **条件检查：** 确认目标系统上的 `/etc/sudoers` 文件中启用了 `pwfeedback` 选项。
2.  **编译环境:** 准备存在漏洞的sudo版本，比如1.8.25，并配置好运行环境如pwntools等。
3.  **缓冲区溢出：** 构造一个长字符串，作为密码输入到 `sudo` 命令中。此字符串会溢出 `getln()` 函数中的栈缓冲区。
4.  **覆盖关键数据：** 在溢出字符串中，覆盖栈上的 `tgetpass_flags` 变量，将其设置为 `TGP_ASKPASS` (0x4)。这会跳过密码验证。
5.  **覆盖用户详情：**覆盖栈上的 user_details 结构，修改用户 ID 为 0，从而获得 root 权限。
6.  **反向 Shell：**利用代码设置环境变量 `SUDO_ASKPASS` 指向一个反向 shell 脚本，并在成功利用漏洞后，通过反向 shell 获得目标系统的 root 权限。

**项目地址:** [aesophor/CVE-2019-18634](https://github.com/aesophor/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #6

**来源**: [CVE-2019-18634-chanbakjsd_CVE-2019-18634.md](../2019/CVE-2019-18634-chanbakjsd_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #7

**来源**: [CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-edsonjt81_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 中启用了 pwfeedback 选项时，未经授权的用户可以通过向 `tgetpass.c` 中的 `getln()` 函数的 stdin 发送一个长字符串来触发 `sudo` 进程中的缓冲区溢出，从而可能导致权限提升。

**有效性：** 根据漏洞描述和搜索结果，提供的 POC 代码很可能有效。GitHub 上的链接（[https://github.com/Plazmaz/CVE-2019-18634](https://github.com/Plazmaz/CVE-2019-18634)） 表明存在功能性漏洞利用代码，可以导致权限提升。

**投毒风险：** 代码审查表明，该漏洞利用旨在通过溢出缓冲区来控制程序流程。虽然代码中包含了一些架构特定的偏移量（例如，`TGP_OFFSET_UBUNTU`，`TGP_OFFSET_ARCHLINUX`），以适应不同的 Sudo 版本和操作系统，但是并没有发现明显的后门或恶意代码。`execlp("sh", "sh", NULL)` 这行代码的目的在于利用成功溢出后启动一个 shell，这属于漏洞利用的一部分，并非恶意投毒。 但不排除未来作者更新加入恶意代码,因此,投毒风险为5%.

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中启用。该选项允许 sudo 在输入密码时提供反馈（例如，显示星号）。
2.  **伪终端分配：** 漏洞利用代码首先分配一个伪终端 (pty)，以确保 `sudo_term_kill` 不为 0，这是成功利用该漏洞的必要条件。如果 stdin 不是终端，Sudo 将设置 `sudo_term_kill = 0`，从而阻止溢出。
3.  **终端设置：** 配置伪终端的属性，例如，禁用原始模式下的输入预处理，并将 VEOF 字符更改为不与 TGP_ASKPASS 冲突的值。
4.  **缓冲区溢出：** 向 Sudo 发送一个精心构造的超长字符串，该字符串会溢出 `getln()` 函数中的缓冲区。溢出旨在覆盖栈上的返回地址，以及可能的其他敏感数据。
5.  **权限提升：** 成功溢出后，控制流被重定向到一个 shell，从而允许攻击者以 root 权限执行命令。利用程序首先取消设置环境变量 `SUDO_ASKPASS`，然后恢复标准输入和标准输出，再执行 `sh`。

**项目地址:** [edsonjt81/sudo-cve-2019-18634](https://github.com/edsonjt81/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #8

**来源**: [CVE-2019-18634-l0w3_CVE-2019-18634.md](../2019/CVE-2019-18634-l0w3_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 Sudo 1.8.26 之前版本中的一个漏洞，当 /etc/sudoers 文件中启用了 pwfeedback 时，攻击者可以触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。漏洞利用代码中给出了触发漏洞的 Python 脚本示例，该脚本通过向 sudo 进程的 stdin 发送超长字符串来溢出缓冲区。

**投毒风险：**

提供的漏洞利用代码主要包括一个用于触发漏洞的 Python 脚本和一个 markdown 格式的说明文档。脚本的功能相对清晰，主要是发送 Payload 导致程序崩溃,没有发现明显的恶意代码或后门。Payload 本身用于溢出，但没有执行恶意操作。说明文档解释了漏洞原理和调试过程。因此，该代码的投毒风险较低，但仍需保持警惕，并进行进一步的代码审计。给1%的投毒风险主要是考虑到代码的复杂性，以及作者可能通过细微的手段植入不易察觉的恶意代码。

**利用方式：**

1.  **前提条件：**  `pwfeedback` 选项需要在 `/etc/sudoers` 文件中被启用。这通常不是默认配置，需要管理员手动配置。
2.  **漏洞触发：**  当满足上述前提条件时，攻击者可以向 `sudo` 命令的输入（stdin）发送一个特制的超长字符串。这个字符串会传递给 `getln()` 函数。
3.  **缓冲区溢出：**  `getln()` 函数在读取输入时，没有正确处理 `sudo_term_kill` 字符，如果 `write` 操作失败，会导致 `cp` 指针不回退，但 `left` 计数器重置，从而允许写入超出缓冲区大小的数据，导致栈溢出。
4.  **权限提升：**  通过精心构造的溢出数据，攻击者可以覆盖栈上的关键数据，例如返回地址，从而控制程序的执行流程。这可以被用来执行任意代码，最终获得 root 权限。

**项目地址:** [l0w3/CVE-2019-18634](https://github.com/l0w3/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #9

**来源**: [CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md](../2019/CVE-2019-18634-letsr00t_-CVE-2019-18634-sudo-pwfeedback.md)

## CVE-2019-18634-sudo-pwfeedback缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可能导致提权和远程代码执行

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 pwfeedback 选项时，攻击者可以通过向 getln() 函数的 stdin 传递一个过长的字符串来触发 sudo 进程中的栈缓冲区溢出。

**有效性:**
提供的漏洞利用代码 `/tmp/fb67cd2fbe094dd39b891f68965adf13/README.md` 仅仅是一个 README 文件，并没有包含任何实际的漏洞利用代码。因此，提供的 POC 代码本身**无效**。但是，从漏洞库信息和相关搜索结果中可以得知，该漏洞是真实存在的，并且已经有公开的利用方法。 真正的利用方式需要构造一个超出缓冲区大小的字符串，通过标准输入发送给 `sudo` 命令，触发栈溢出，从而覆盖返回地址或执行其他恶意代码。

**投毒风险:**
该仓库仅包含一个README.md文件，风险很低。投毒风险评估为5%。即使有其他文件，也需要检查其代码是否包含恶意代码，例如后门、键盘记录器或数据窃取程序等。

**利用方式:**
1.  **前提条件:** pwfeedback 必须在 /etc/sudoers 文件中启用。这可以通过检查 `/etc/sudoers` 文件中是否存在 `Defaults pwfeedback` 这一行来确认。如果不存在，则需要管理员手动添加。
2.  **构造 Payload:** 攻击者需要构造一个超出缓冲区大小的字符串。缓冲区大小与 `getln()` 函数的实现有关，需要进行逆向工程或调试来确定准确的大小。Payload 可能包含 shellcode，用于执行恶意命令。
3.  **触发漏洞:** 通过 `sudo` 命令执行一个需要密码的命令，例如 `sudo -l`。在提示输入密码时，将构造的 Payload 通过标准输入发送给 `sudo` 命令。
4.  **利用溢出:** 如果 Payload 构造正确，将覆盖栈上的返回地址，并将程序控制权转移到 shellcode 或其他恶意代码上。Shellcode 可以执行提权操作，例如修改用户 ID 或启动 root shell。

**总结:**
CVE-2019-18634 是一个严重的安全漏洞，可以导致提权甚至远程代码执行。尽管提供的 POC 代码无效，但漏洞本身是可利用的。系统管理员应该尽快升级 Sudo 版本到 1.8.26 或更高版本，并禁用 pwfeedback 选项（如果不需要）。

**项目地址:** [letsr00t/-CVE-2019-18634-sudo-pwfeedback](https://github.com/letsr00t/-CVE-2019-18634-sudo-pwfeedback)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #10

**来源**: [CVE-2019-18634-ngyinkit_cve-2019-18634.md](../2019/CVE-2019-18634-ngyinkit_cve-2019-18634.md)

## CVE-2019-18634-sudo-缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** sudo

**危害等级:** 高危，可导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634 是 sudo 1.8.26 之前版本中的一个缓冲区溢出漏洞。当 /etc/sudoers 中启用 pwfeedback 时，用户可以通过向 tgetpass.c 中的 getln() 函数的 stdin 传递一个长字符串来触发特权 sudo 进程中的基于栈的缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 sudo 1.8.26 之前的版本，并且需要在 /etc/sudoers 文件中启用 pwfeedback 选项。提供的 POC 代码 `exploit.py` 旨在利用此漏洞。它通过创建一个伪终端(pty)，并利用 `sudo -S` 命令将构造的恶意 payload 发送到 sudo 进程的 stdin，从而实现提权。

**投毒风险：**
`exploit.py` 首先创建了一个反向 shell 脚本 `/tmp/shell.sh`，用于在漏洞利用成功后建立与攻击者的连接。虽然这是一个后门，但它是漏洞利用的必要组成部分，而非投毒代码，因为该脚本是攻击者控制目标机器的一种手段。代码中存在通过网络连接的恶意风险,但是脚本代码较少,只有bash反弹shell,可以判断没有隐藏其他恶意指令.所以投毒风险较低,但是考虑到执行了chmod指令,可以判定存在1%投毒风险.

**利用方式：**
1.  **检查 pwfeedback 是否启用：** 首先，攻击者需要确定目标系统上的 /etc/sudoers 文件中是否启用了 pwfeedback 选项。
2.  **创建反向 shell 脚本：** POC 代码创建了一个反向 shell 脚本，当溢出成功时，该脚本会尝试连接到攻击者的机器。
3.  **创建伪终端：** 创建一个伪终端，以便与 sudo 进程进行交互。
4.  **构造 Payload：** 构造一个精心设计的 payload，该 payload 会溢出 getln() 函数的缓冲区，覆盖栈上的返回地址或其他关键数据。
5.  **执行 sudo -S：** 使用 `sudo -S` 命令，并将构造的 payload 通过伪终端的 stdin 发送到 sudo 进程。`SUDO_ASKPASS` 环境变量被设置为反向shell脚本,用于绕过密码输入,因为根本没有密码输入.
6.  **获得 Shell：** 如果漏洞利用成功，攻击者将获得一个具有 root 权限的反向 shell。

**优先级：**
搜索引擎结果和漏洞利用代码提供了有关漏洞利用的更多信息，因此比漏洞库信息具有更高的优先级。漏洞利用代码允许评估漏洞利用的有效性，搜索引擎结果有助于验证漏洞的存在和影响。

**项目地址:** [ngyinkit/cve-2019-18634](https://github.com/ngyinkit/cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #11

**来源**: [CVE-2019-18634-paras1te-x_CVE-2019-18634.md](../2019/CVE-2019-18634-paras1te-x_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18634 漏洞存在于 Sudo 1.8.26 之前的版本中。如果 /etc/sudoers 文件中启用了 `pwfeedback` 选项，攻击者可以通过向 `getln()` 函数的 stdin 发送一个长字符串，从而触发 `sudo` 进程中的栈缓冲区溢出。根据漏洞库信息和搜索引擎结果，漏洞利用需要 `pwfeedback` 选项被启用，这并非默认配置，而需要管理员手动配置。提供的 PoC 代码 `exploit.py` 尝试利用此漏洞，通过向 `sudo` 命令的标准输入注入恶意 payload。代码首先使用 `process()` 函数启动一个 `sudo` 进程，并设置环境变量 `SUDO_ASKPASS`指向shell脚本。然后，构造一个包含大量 `junk` 字节和覆盖返回地址的 payload，通过 `os.write()` 函数将其写入 `sudo` 进程的标准输入。该 payload 的目的是覆盖返回地址，从而劫持程序的控制流。`README.md` 文件说明此 PoC 在 Ubuntu 20.04 和 sudo 1.8.25 上有效，并指向了一个分析文章。

**有效性评估：**提供的POC代码似乎是有效的，`README.md` 提到在特定环境下可以成功利用此漏洞。多个搜索引擎结果也表明此漏洞存在可利用的PoC。

**投毒风险评估：** 风险较低。POC 代码本身功能相对清晰，主要目的是利用缓冲区溢出漏洞。虽然`shell.sh`如果被替换为恶意脚本会引入风险，但就给出的`exploit.py`本身来说，风险较小。`shell.sh`文件本身缺失，需要用户提供，这加大了用户引入风险的可能性。默认情况下，该PoC需要用户手动替换shell脚本为反向shell，如果用户替换的脚本包含恶意代码，则可能存在投毒风险。

**利用方式：**

1.  **前提条件：** `pwfeedback` 必须在 `/etc/sudoers` 文件中被启用。
2.  **漏洞触发：** 攻击者通过向需要密码验证的sudo命令输入超长字符串触发栈缓冲区溢出。
3.  **Payload注入：** 攻击者构造包含恶意代码的 payload，覆盖栈上的返回地址。
4.  **代码执行：** 当函数返回时，程序控制流被劫持，执行攻击者注入的恶意代码，从而实现提权。


**项目地址:** [paras1te-x/CVE-2019-18634](https://github.com/paras1te-x/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #12

**来源**: [CVE-2019-18634-ptef_CVE-2019-18634.md](../2019/CVE-2019-18634-ptef_CVE-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致提权

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中被启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前的版本中的栈缓冲区溢出漏洞。当/etc/sudoers中启用了pwfeedback选项时，攻击者可以通过向getln()函数（位于tgetpass.c文件中）的stdin传递一个长字符串来触发此漏洞。根据漏洞利用代码中的README.md文件，提供的exploit.c是为Linux Mint 19.1编写的，可能不适用于其他发行版。代码利用了sudo在处理密码反馈时的逻辑缺陷。它首先创建一个伪终端(PTY)，然后设置SUDO_ASKPASS环境变量指向自身的可执行文件。当sudo需要密码时，它会调用这个程序，攻击者通过精心构造的payload溢出缓冲区，从而获得root权限。

**有效性评估：**
提供的POC代码的有效性取决于目标系统是否满足以下条件：
1.  Sudo版本低于1.8.26。
2.  /etc/sudoers文件中启用了pwfeedback选项。
3.  目标系统是Linux Mint 19.1或与其环境相似。
如果满足这些条件，则POC代码可能有效。由于该exploit.c是专门为Linux Mint 19.1编写的，因此在其他系统上的有效性可能会降低，可能需要修改偏移量和其他参数。

**投毒风险评估：**
检查提供的POC代码，`/tmp/90dfda9b786d9360fffaee181aa67425/exploit.c`中存在可疑的代码，风险点主要存在于以下几点：
1.  **硬编码的利用目标：** README.md表明该漏洞利用程序是为特定的Linux Mint版本编写的，这意味着它可能包含特定于该环境的偏移量或配置。如果未经修改直接在其他系统上使用，可能会导致崩溃或不可预测的行为。
2.  **关于payload的注释不清晰：**
    /*
     * below we build the payload that will trigger the vulnerability.
     * we need to fill the following BSS variables: buf + askpass + signo
     * + se_state + user_details. 
     * FIXME: corrigir o texto e explicar melhor
     */ 这一段注释表明作者本人对payload的构造细节也不是特别理解，存在一定的风险。
3.  **对`PLEASE_EXEC_MY_SHELL`环境变量的使用:** 这段代码中使用了环境变量 `PLEASE_EXEC_MY_SHELL` 来执行 `/bin/sh`。虽然代码本身没有明显的恶意行为，但如果攻击者能够控制这个环境变量的值，他们可能会执行任意命令。尽管这部分代码的目的是为了获得shell，但如果被滥用，也可能导致系统被攻陷。
4.  **错误处理不足：** 该漏洞利用代码中存在一些错误处理，但可能不够完善。例如，如果`readlink`失败，它会简单地调用`err`退出，这可能会阻止漏洞利用程序继续执行。更健壮的错误处理机制可以提高漏洞利用程序的可靠性。
总的来说，该漏洞利用代码的投毒风险预估为10%。它主要是为了利用漏洞而不是进行恶意活动而设计的，但潜在的滥用风险仍然存在，特别是如果攻击者可以控制某些环境变量或修改代码本身。

**利用方式分析：**
该漏洞的利用方式如下：
1.  **环境准备：** 确保目标系统上启用了pwfeedback选项，并且Sudo版本易受攻击。
2.  **编译漏洞利用代码：** 使用gcc等编译器编译提供的exploit.c文件。
3.  **运行漏洞利用代码：** 运行编译后的可执行文件。该程序将创建一个伪终端，设置SUDO_ASKPASS环境变量，并执行sudo -S 命令。
4.  **触发缓冲区溢出：** 当sudo提示输入密码时，漏洞利用代码将发送一个特制的payload，覆盖栈上的缓冲区。
5.  **提权：** 如果payload构造正确，成功溢出缓冲区后，攻击者将获得root权限。

**项目地址:** [ptef/CVE-2019-18634](https://github.com/ptef/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

## POC #13

**来源**: [CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md](../2019/CVE-2019-18634-saleemrashid_sudo-cve-2019-18634.md)

## CVE-2019-18634-Sudo-Stack Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback 在 /etc/sudoers 中启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18634 漏洞是 Sudo 1.8.26 之前版本中存在的一个栈缓冲区溢出漏洞。当 /etc/sudoers 文件中启用了 `pwfeedback` 选项时，攻击者可以通过向 `getln()` 函数的 stdin 传递一个过长的字符串来触发此漏洞，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞是有效的。

*   漏洞库信息明确指出，在启用 `pwfeedback` 的情况下，用户可以触发栈缓冲区溢出。
*   搜索结果中包含 NVD、Red Hat 等多个来源的确认信息。
*   Plazmaz 在 Github 上发布了功能性漏洞利用代码。
*   提供的 PoC 代码看起来也实现了漏洞的利用。这个PoC 代码尝试通过创建一个伪终端，并向 sudo 发送大量数据，从而触发缓冲区溢出。

**投毒风险：**
分析提供的PoC代码，不存在作者隐藏的恶意投毒代码。代码逻辑清晰，主要目标是利用缓冲区溢出漏洞进行提权。该代码包含以下几个部分：

1.  **main 函数：** 这是程序的入口点。
2.  **参数判断：**  判断是否被sudo作为askpass程序重新执行。如果是，则清除SUDO_ASKPASS环境变量，并将标准输入输出重定向到标准错误输出，然后执行shell。
3.  **伪终端分配：** 分配一个伪终端（pty），以确保Sudo以终端模式运行。这是利用漏洞的先决条件，因为漏洞利用依赖于`sudo_term_kill`变量，该变量只有在存在终端时才不为0。
4.  **终端设置：** 设置伪终端的属性，例如禁用原始模式下的预处理。更改 VEOF 字符，以避免与 TGP_ASKPASS 冲突。
5.  **构造payload：**精心构造的payload，包含大量的'A'字符，以及覆盖返回地址所需的地址。
6.  **触发漏洞：**通过`execlp`启动sudo，并使用管道将payload传递给sudo的密码输入。

因此，可以判断此仓库中不存在作者隐藏的投毒代码，投毒风险为 0%。

**利用方式：**
该漏洞的利用方式如下：

1.  **前提条件：** `pwfeedback` 选项必须在 `/etc/sudoers` 文件中启用。
2.  **创建伪终端：** 分配一个伪终端，用于绕过对终端的检查。
3.  **构造 Payload：** 构造一个过长的字符串，使其超出 `getln()` 函数的缓冲区大小，覆盖栈上的返回地址等关键数据。
4.  **触发漏洞：** 运行 `sudo` 命令，并使程序进入密码输入阶段。将构造好的 Payload 通过 stdin 发送给 `sudo` 进程，触发缓冲区溢出。
5.  **权限提升：** 通过覆盖返回地址，将程序控制流劫持到预先设定的 shellcode 或其他代码区域，从而实现权限提升。

**项目地址:** [saleemrashid/sudo-cve-2019-18634](https://github.com/saleemrashid/sudo-cve-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)

---

