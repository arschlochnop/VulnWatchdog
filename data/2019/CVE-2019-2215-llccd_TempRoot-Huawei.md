# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-llccd_TempRoot-Huawei.md](../2019/CVE-2019-2215-llccd_TempRoot-Huawei.md)

# CVE-2019-2215

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md](../2019/CVE-2019-2215-0xbinder_android-kernel-exploitation-lab.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #2

**来源**: [CVE-2019-2215-ATorNinja_CVE-2019-2215.md](../2019/CVE-2019-2215-ATorNinja_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #3

**来源**: [CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md](../2019/CVE-2019-2215-Byte-Master-101_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以通过利用此漏洞实现从应用程序到Linux内核的权限提升。

**有效性：**
提供的POC代码看起来是有效的。`README.md` 文件描述了漏洞利用的构建和执行过程，并且给出了成功提权的示例输出。示例输出显示了分配内存页、泄漏task_struct指针、获取任意读写权限，并最终将SELinux设置为permissive模式的过程。`Makefile` 提供了构建漏洞利用的必要步骤。

**投毒风险：**
该代码库的投毒风险较低，约为5%。主要基于以下几点考虑：
1.  `README.md` 提到了该代码基于Google Project Zero的概念验证，并且感谢了其他研究人员的工作，这表明代码的来源是可信的。
2.  代码结构清晰，`Makefile` 和 `exploit.c` 文件组织良好，易于理解和审查。
3.  漏洞利用代码本身较为复杂，即使存在恶意代码，也可能隐藏在复杂的逻辑之中，但整体来看，代码更偏向于PoC验证而非恶意后门，没有发现明显的恶意行为。
4.  免责声明明确指出该代码仅用于教育和展示目的，开发者不承担任何非法或不道德使用的责任，可以推断作者不希望代码被用于恶意目的。

但仍存在微小风险，例如作者可能在代码中加入细微的后门，但这种可能性较低。

**利用方式：**
此漏洞的利用方式涉及以下几个步骤：

1.  **内存布局：** 首先，在内存中分配一个大的对齐页面。
2.  **泄漏task_struct指针：**
    *   分配binder和epoll文件描述符。
    *   创建一个管道（pipe）。
    *   构建IOVEC堆栈。
    *   fork一个子进程。
    *   分配和链接binder_thread结构。
    *   释放binder_thread结构。
    *   将binder_thread结构重新分配为IOVECs。
    *   子进程触发unlink操作，并从管道中读取数据。
    *   父进程读取泄漏的task_struct指针。
3.  **获取任意读写权限：** 类似于泄漏task_struct指针的过程，但使用socket和消息头对象。
4.  **提权：**
    *   通过任意读写权限，找到SELinux enforcing标志的地址。
    *   将SELinux enforcing标志设置为0，从而将SELinux设置为permissive模式。

成功利用此漏洞后，攻击者可以获得root权限，从而完全控制设备。

**项目地址:** [Byte-Master-101/CVE-2019-2215](https://github.com/Byte-Master-101/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #4

**来源**: [CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md](../2019/CVE-2019-2215-CrackerCat_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或者网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-2215 是Android Binder驱动中的一个use-after-free漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞将权限从应用程序提升到Linux Kernel。漏洞利用代码的README.md显示，它是一个利用CVE-2019-2215的提权漏洞，最终目的是为了实现Root权限，配合勒索软件，并窃取设备信息。 

**有效性：**
根据搜索结果，CVE-2019-2215是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码的README.md也表明这是一个可工作的PoC，用于在Pixel 2/2 XL上实现提权。

**投毒风险：**
PoC代码中包含勒索软件功能（AES加密文件）和数据泄露功能（窃取Gmail，联系人等信息）。虽然项目声明是用于教育目的，但恶意使用者可以直接拿来利用。从代码结构看, `cve-2019-2215.c`是漏洞利用的核心，而其他部分（如勒索软件、反向shell）可以被替换或修改。安装脚本`install.sh`中运行`rs.elf`反向连接到攻击者，这部分也可能被植入恶意代码。因此，存在一定的投毒风险，但主要风险来自于PoC本身具有的恶意功能，而不是作者有意隐藏的后门，后门代码的概率在20%左右。 

**利用方式：**

1.  **安装恶意应用:** 首先，需要安装一个包含漏洞利用代码的恶意Android应用程序。
2.  **触发漏洞:**  该应用程序会利用Binder机制中的use-after-free漏洞。
3.  **权限提升:** 成功利用漏洞后，攻击者可以获得root权限。
4.  **执行恶意操作:**  获得root权限后，恶意应用可以执行各种恶意操作，例如：
    *   勒索软件加密设备文件。
    *   窃取敏感数据（联系人、Gmail账户等）。
    *   安装后门程序，实现远程控制。
    *   执行其他恶意代码。

**项目地址:** [CrackerCat/Rootsmart-v2.0](https://github.com/CrackerCat/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #5

**来源**: [CVE-2019-2215-DimitriFourny_cve-2019-2215.md](../2019/CVE-2019-2215-DimitriFourny_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许本地权限提升至内核权限

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或通过网络应用中的漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。该漏洞允许攻击者从应用提权到 Linux 内核级别。利用该漏洞不需要用户交互，但需要预先安装恶意应用程序或配合其他网络应用漏洞。根据提供的 POC 代码分析，漏洞利用过程大致如下：

1.  **漏洞触发**:首先通过打开`/dev/binder`设备并使用`epoll_ctl`添加文件描述符到epoll实例来准备binder驱动环境。子进程睡眠1秒后，在父进程中首先使用`ioctl(fd_binder, BINDER_THREAD_EXIT, NULL)`释放binder线程对象。然后，在父进程中调用 `writev`，结合精心构造的`iovec`数组，在释放的内存位置写入数据。
2.  **UAF利用**: 之后在子进程中调用 `epoll_ctl(epfd, EPOLL_CTL_DEL, fd_binder, &event)` 再次使用已经释放的binder线程对象，触发use-after-free。 
3.  **信息泄露**:  通过 pipe 将数据读回，从而泄露内核内存信息。特别是利用精心构造的`iovec`结构覆盖`binder_thread`的`task_list.next`指针，使其指向`task_struct`，从而泄漏`task_struct`地址。
4.  **权限提升**: 代码中使用`smash_address`函数，该函数尝试覆盖内核内存中的地址值，结合泄露的`task_struct`地址，可以修改当前进程的`cred`结构，从而提升权限。

**有效性评估：**
根据漏洞信息和提供的 POC 代码，该漏洞利用具有较高的有效性。漏洞的利用流程清晰，利用了 Android Binder 机制的 use-after-free 漏洞。

**投毒风险分析：**
该 POC 代码本身旨在利用漏洞提升权限，实现 root 访问。可能的投毒点在于：
*   **恶意代码注入：** 代码可能包含在提权后执行恶意操作的代码，例如植入后门、窃取数据等。
*   **条件触发：** 漏洞利用可能依赖特定的系统配置或内核版本，导致在某些设备上崩溃或行为异常。
*   **稳定性问题：** 漏洞利用本身可能不稳定，可能导致设备崩溃或重启。
目前来看，提供的代码较为基础，主要用于演示漏洞利用，但仍然存在作者植入恶意代码的可能性。投毒风险评估为10%，主要集中在提权后执行的恶意行为和稳定性问题上。

**项目地址:** [DimitriFourny/cve-2019-2215](https://github.com/DimitriFourny/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #6

**来源**: [CVE-2019-2215-LIznzn_CVE-2019-2215.md](../2019/CVE-2019-2215-LIznzn_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #7

**来源**: [CVE-2019-2215-R0rt1z2_huawei-unlock.md](../2019/CVE-2019-2215-R0rt1z2_huawei-unlock.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露的应用程序中的另一个漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，允许应用程序提升到 Linux 内核权限。漏洞位于 binder.c 中。根据提供的POC代码，该利用程序旨在通过利用此漏洞获得任意内核 R/W 权限，从而绕过 SELinux 并获取 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞被广泛讨论并存在公开可用的利用程序。搜索结果表明该漏洞已在野外被利用。提供的代码似乎是一个功能齐全的利用程序，包含绕过 SELinux 和注入 Sepolicy 的功能。因此，可以认为提供的 POC 代码**有效**。

**投毒风险分析：**
代码片段包含多个修改历史的作者和描述，从 Jann Horn & Maddie Stone of Google Project Zero 开始，到 Alexander R. Pruss, Sithi, chompie1337 和 Roger Ortiz。 这些修改包括对不同 Android 版本、华为设备和 SELinux 绕过的支持。 虽然代码历史看起来合理，但每次修改都增加了潜在的攻击面或引入恶意代码的可能性。

投毒风险评估：从代码来看，它是一个root提权EXP，本身就具有一定的“破坏性”。考虑到代码比较复杂，修改者比较多，虽然大部分修改都是为了兼容性和功能性，但仍然存在作者植入后门的可能, 经过代码分析，发现作者存在通过宏定义常量，去修改内核地址，以及新增绕过SELinux的动作，虽然这些行为都是为了EXP成功。但是仍然存在一定投毒风险， 故判定的投毒风险为 **5%**。

**利用方式分析：**
1.  **漏洞触发：** 该漏洞是 Binder 驱动程序中的一个 use-after-free 漏洞。具体触发方式可能涉及精心设计的 Binder 事务序列，导致 `binder_thread` 结构释放后被再次访问。
2.  **权限提升：** 成功利用该漏洞后，攻击者可以获得内核的读/写访问权限。利用此能力，攻击者可以修改进程的凭据结构（`cred`），将 UID、GID、capabilities 等设置为 0，从而获得 root 权限。
3. **SELinux绕过** 漏洞利用还包括绕过 SELinux 策略的机制，例如通过修改 AVC 缓存或注入新的安全策略来获取root权限。
4. **NVE解锁(华为设备)** 漏洞利用还包括解锁NVE功能，可以用来修改设备指纹，绕过安全验证。

总而言之，此漏洞利用方式是首先触发内核中的 use-after-free 漏洞，然后利用内核读/写访问权限来修改进程凭据并绕过 SELinux，从而获得 root 权限。 这个过程需要精心设计的代码和对内核内部机制的深入了解。

**项目地址:** [R0rt1z2/huawei-unlock](https://github.com/R0rt1z2/huawei-unlock)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #8

**来源**: [CVE-2019-2215-XiaozaYa_CVE-2019-2215.md](../2019/CVE-2019-2215-XiaozaYa_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #9

**来源**: [CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md](../2019/CVE-2019-2215-c3r34lk1ll3r_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的另一个漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215是一个Android Binder驱动中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核。根据漏洞描述，利用此漏洞需要安装恶意的本地应用程序或需要利用另一个网络漏洞。从搜索结果来看，该漏洞已被野外利用，并与APT组织SideWinder有关联。

提供的代码片段是GNU General Public License，不是漏洞利用代码本身，因此无法直接评估其有效性或是否存在投毒风险。但是，由于该漏洞已被广泛研究并存在公开可用的PoC，因此可以判断该漏洞是可利用的。

利用方式通常涉及以下步骤：
1. 触发Binder驱动中的use-after-free漏洞。
2. 在释放的对象被重新分配之前，通过某些手段利用该对象。常见的方法是堆喷射，用可控的数据填充释放的内存。
3. 最终目标通常是覆盖内核内存，以便获得root权限。

**项目地址:** [c3r34lk1ll3r/CVE-2019-2215](https://github.com/c3r34lk1ll3r/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #10

**来源**: [CVE-2019-2215-elbiazo_CVE-2019-2215.md](../2019/CVE-2019-2215-elbiazo_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要本地安装恶意应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中的一个 use-after-free 漏洞，存在于 `binder.c` 文件中。攻击者可以利用此漏洞将权限从应用提升到 Linux 内核级别。根据漏洞信息和搜索结果，该漏洞已经被野外利用，并且存在公开可用的漏洞利用代码。

**有效性：**
提供的 POC 代码似乎有效，因为它包含利用该漏洞所需的必要组件，例如 Makefile、README 和 exp.cc 文件。`exp.cc` 文件包含利用 use-after-free 漏洞所需的特定结构和偏移量。Makefile 用于交叉编译漏洞利用程序，README 文件提供有关漏洞和利用的信息。

**投毒风险：**
虽然提供的代码看起来像一个有效的漏洞利用程序，但是投毒风险仍然存在。具体分析如下：

*   `Makefile`:  看似标准，用于构建 exploit，没有明显的恶意代码。
*   `README.md`: 只是提供漏洞信息和免责声明，没有恶意代码。
*   `exp.cc`:  这是最有可能存在投毒代码的地方。快速浏览发现，大量的偏移量和结构体定义是利用漏洞的关键，但同时也可能被篡改以达到恶意目的。漏洞利用代码包含很多硬编码的地址偏移量。如果这些偏移量不正确，可能会导致程序崩溃，或者更糟糕的情况，可能会被利用来执行恶意代码。例如，某个变量被替换成其他函数指针等。
    此外，作者可以在条件编译中隐藏恶意代码，例如通过检测特定设备或环境来激活后门。代码中存在 `debug` 函数，该函数会暂停执行并等待用户输入，这在生产环境中是不寻常的，可能被滥用。总体来说，虽然表面上代码是合法的漏洞利用，但存在一定风险。根据分析，投毒风险约为 10%。

**利用方式：**
利用方式主要涉及以下步骤：

1.  **漏洞触发：** 利用Binder机制中的UAF漏洞。这可能涉及到创建特定的Binder事务，并以一种导致内核释放Binder对象，然后在后续操作中再次访问它的方式进行操作。
2.  **内存布局控制：** 攻击者可能需要操纵内存布局，以便在释放的Binder对象之后分配特定的数据结构。这样，当内核尝试访问释放的Binder对象时，它实际上会访问攻击者控制的数据结构。
3.  **权限提升：** 通过控制内存中的数据，攻击者可以覆盖当前进程的凭据（credentials），将其UID和GID设置为0，从而获得root权限。

**总结：**
该漏洞的成功利用可能导致设备完全受损。尽管漏洞利用代码已公开，但在实际使用前仍需要仔细审查，以确保其安全性和可靠性。鉴于该漏洞已经被恶意行为者利用，及时修补程序至关重要。

**项目地址:** [elbiazo/CVE-2019-2215](https://github.com/elbiazo/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #11

**来源**: [CVE-2019-2215-enceka_cve-2019-2215-3.18.md](../2019/CVE-2019-2215-enceka_cve-2019-2215-3.18.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可能导致权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或存在网络应用漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 漏洞是 Android Binder 驱动中的一个 use-after-free 漏洞，存在于`binder.c`中。攻击者可以利用此漏洞将权限从应用程序提升到 Linux 内核级别。根据漏洞库信息，无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的另一个漏洞。根据搜索结果，该漏洞已经被野外利用，并与 SideWinder APT 组织有关联。提供的漏洞利用代码只是 GNU GPL 许可证，无法直接判断其有效性，但参考搜索结果中Github信息(sharif-dev/AndroidKernelVulnerability)，可以推断存在有效的PoC。根据漏洞描述和搜索结果，漏洞利用方式涉及精心构造 Binder 消息，触发已经释放的内存区域被再次使用，进而控制内核执行流程，实现权限提升。
由于只提供了许可协议，无法分析投毒风险。假设实际的exploit代码存在，考虑到该漏洞可能被用于提升权限，潜在的投毒风险包括：在提权过程中植入后门，篡改系统关键文件，或者窃取敏感信息。但是就目前提供的LICENSE文件，投毒风险可以判定为0%.

**项目地址:** [enceka/cve-2019-2215-3.18](https://github.com/enceka/cve-2019-2215-3.18)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #12

**来源**: [CVE-2019-2215-kangtastic_cve-2019-2215.md](../2019/CVE-2019-2215-kangtastic_cve-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel (受影响版本)

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 驱动程序中的一个 use-after-free 漏洞，允许本地攻击者提升权限到 Linux 内核。根据漏洞库信息和搜索引擎结果，此漏洞的利用不需要用户交互，但需要首先安装一个恶意的本地应用程序，或者利用一个网络应用中的其他漏洞作为跳板。

**有效性：**

根据搜索结果（例如 googleprojectzero.github.io 和 googleprojectzero.blogspot.com），此漏洞已在野外被利用。提供的 POC 代码（Makefile 和 README.md）针对 Pixel 2 和 Pixel 2 XL 设备，并提供了编译和使用说明。这些信息表明 POC 代码是有效的，并且可用于在特定设备上演示此漏洞。

**投毒风险：**

分析 POC 代码本身，未发现明显的恶意后门。Makefile 只是编译代码，README.md 提供使用说明。但是，始终存在细微的风险，即作者可能包含难以检测的后门。考虑到该 POC 代码由 Google Project Zero 的研究人员提供，并且被广泛分析，投毒的可能性较低，此处假设为5%。

**利用方式：**

1.  **编译 POC 代码：** 使用 Android NDK 编译提供的 cve-2019-2215.c 文件。
2.  **部署到目标设备：** 将编译后的可执行文件传输到 Android 设备上的可写目录（例如 /data/local/tmp）。
3.  **设置执行权限：** 使用 `chmod +x cve-2019-2215` 命令为可执行文件赋予执行权限。
4.  **运行 POC 代码：** 运行编译后的可执行文件。如果利用成功，将会获得一个 root shell，或者 SELinux 将被设置为 permissive 模式。
5.  **(可选) 调试模式：** 可以传递 `debug` 参数以启动一个 mini debug console，允许读取和写入内核内存。

**漏洞利用分析：**

该漏洞是 binder.c 中的一个 use-after-free 漏洞。攻击者可以利用此漏洞在内核中执行任意代码，从而绕过安全机制并获得 root 权限。利用通常涉及精心设计的 Binder IPC 调用来触发 use-after-free 条件。POC 代码通过内存读写原语来实现权限提升。

**项目地址:** [kangtastic/cve-2019-2215](https://github.com/kangtastic/cve-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #13

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #14

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---



---

## POC #14

**来源**: [CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md](../2019/CVE-2019-2215-mouseos_cve-2019-2215_SH-M08.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Android Kernel (受影响版本早于2019年10月的安全补丁)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 use-after-free 漏洞，位于 binder.c 文件中。攻击者可以通过利用此漏洞，从普通应用程序提升权限至 Linux Kernel，获得 root 权限。根据提供的漏洞库信息和搜索引擎结果，此漏洞影响广泛，且存在公开的漏洞利用代码。提供的POC代码是一个针对AQUOS sense 2(SH-M08)移植版的概念验证，用于在具有2019年10月之前安全补丁的Android设备上获取root权限。

**有效性：** 根据搜索引擎结果和漏洞描述，此漏洞利用代码如果针对的是未修复的设备，则很大程度上是有效的。提供的代码中包含了成功利用漏洞并获取 root 权限的输出示例。

**投毒风险：** 提供的代码主要由`README.md`文件和编译指令构成，以及利用漏洞的过程演示。主要分析方向是POC代码`poc.c`, 但是没有提供源码,无法进行有效分析。`README.md`文件主要包含构建说明和执行步骤，本身不包含可疑代码。 但由于缺乏`poc.c`文件，无法确定是否存在被作者隐藏的恶意代码。谨慎起见，假设存在极低概率的投毒风险，例如，代码可能包含特定于目标设备的后门，或在提权过程中执行恶意操作。如果提供了`poc.c`文件, 可以进一步进行代码审计, 确定是否存在投毒风险，目前只能基于不完整信息给出一个较低的百分比，暂定投毒风险为5%。

**利用方式：** 漏洞利用方式主要分为以下几个步骤：

1.  **准备：** 首先，需要将编译好的POC程序推送到目标Android设备的/data/local/tmp目录下。
2.  **执行：** 通过adb shell进入设备，然后运行/data/local/tmp/poc程序。
3.  **漏洞触发：** POC 程序会利用Binder机制中的use-after-free漏洞，通过特定的操作触发该漏洞。
4.  **权限提升：** 成功触发漏洞后，POC程序会修改当前进程的凭据（credentials），将其UID、GID等修改为root用户的UID和GID，从而获得root权限。
5.  **清理和恢复：** POC程序还会尝试重新加入init mount namespace和init net namespace，并禁用SELinux和SECCOMP等安全机制（如果尚未禁用）。

**项目地址:** [mouseos/cve-2019-2215_SH-M08](https://github.com/mouseos/cve-2019-2215_SH-M08)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #15

**来源**: [CVE-2019-2215-mufidmb38_CVE-2019-2215.md](../2019/CVE-2019-2215-mufidmb38_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder驱动中的Use-After-Free漏洞。根据漏洞库信息和搜索引擎结果，该漏洞位于binder.c文件中，允许本地应用程序提升权限到Linux内核级别。漏洞利用不需要用户交互，但需要预先安装恶意应用或配合其他网络应用漏洞。

**有效性：**
根据CISA ADP Vulnrichment数据, 此漏洞的Exploitation已经被标记为active.
 根据搜索结果，多个安全研究团队（如Google Project Zero和Trend Micro）已经分析并发现了野外利用（in-the-wild exploit）此漏洞的案例。这表明该漏洞利用方法已经成熟且有效。

**投毒风险：**
提供的代码片段仅包含GNU GPL许可证。很难仅凭此片段判断是否存在投毒代码。通常，投毒可能存在于漏洞利用代码的更深层逻辑中，例如植入后门或收集用户数据。由于只提供了许可证信息，无法进行完整的静态分析，因此，低概率（10%）的投毒风险是基于假设完整exp可能包含恶意行为的考量。

**利用方式：**
1.  **触发漏洞：** 通过精心构造的Binder事务，在binder.c中的`binder_thread`结构体的`wait`成员上触发Use-After-Free。
2.  **控制释放后的内存：** 利用堆喷射等技术，将释放后的内存重新分配给攻击者控制的数据结构。
3.  **权限提升：** 覆盖内核数据结构（例如`cred`结构体），修改用户ID为0，从而获得root权限。

根据漏洞信息，搜索引擎结果和给定的漏洞利用代码片段可以得知，此漏洞是一个真实存在并且已经被利用的漏洞。该漏洞允许攻击者从应用程序提升权限到内核级别，造成严重的安全风险。

**项目地址:** [mufidmb38/CVE-2019-2215](https://github.com/mufidmb38/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #16

**来源**: [CVE-2019-2215-mutur4_CVE-2019-2215.md](../2019/CVE-2019-2215-mutur4_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-2215 是 Android 内核 binder.c 中的一个use-after-free漏洞，允许应用程序将权限提升到 Linux 内核。根据漏洞信息和搜索结果，该漏洞无需用户交互即可利用，但需要安装恶意本地应用程序或利用面向网络应用程序中的单独漏洞。该漏洞的PoC代码利用UAF漏洞触发AAR（Arbitrary Address Read）原语来泄漏内核地址，然后使用AAW（Arbitrary Address Write）原语来覆盖`addr_limit`，从而实现内核读写原语，进而修改`cred_struct`以进行本地权限提升(LPE)。

**利用方式：**

1.  **创建漏洞利用环境：** 需要一个可以执行代码的Android环境，通常是通过安装恶意应用或者利用现有的应用漏洞。
2.  **打开/dev/binder：** 通过`open("/dev/binder", O_RDONLY)`打开binder设备。
3.  **创建epoll实例：** 使用`epoll_create`创建epoll实例。
4.  **mmap地址：** 使用`mmap`映射内存地址。
5.  **创建pipe：** 使用`pipe()`创建管道，用于进程间通信。
6.  **设置pipe大小：** 使用`fcntl`设置管道大小。
7.  **设置iovec：** 设置`iovec`结构体数组，其中包含要读写的内存地址和长度。
8.  **将binder_thread链接到epoll事件等待队列：** 使用`epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &event)`将binder_thread链接到epoll事件的等待队列。
9.  **fork进程：** 创建子进程。
10. **父进程ioctl释放binder_thread：** 通过`ioctl(fd, BINDER_THREAD_EXIT, NULL)`释放binder_thread，在kmalloc-512中创建一个洞。
11. **父进程writev重新分配binder_thread：** 使用`writev`利用iovec结构体数组填充kmalloc-512中的洞，并阻塞等待子进程。
12. **子进程epoll_ctl删除fd：** 子进程使用`epoll_ctl(epfd, EPOLL_CTL_DEL, fd, &event)`触发unlink操作。
13. **子进程read解阻塞父进程writev：** 子进程从管道读取数据解阻塞父进程。
14. **AAR和AAW：** 通过精心构造的iovec利用UAF漏洞实现任意地址读写。
15. **提权：** 通过修改`cred_struct`实现本地提权。

**有效性：**

该PoC代码看起来有效，因为它实现了利用该漏洞所需的步骤。该代码基于已知的利用技术，并参考了Project Zero的分析报告。

**投毒风险：**

检查提供的 PoC 代码 `exploit.c` 和 `README.md`，没有发现明显的恶意代码或隐藏功能。代码结构清晰，注释合理，主要目的是利用 CVE-2019-2215 漏洞进行提权。代码中使用的系统调用和技术都是为了实现漏洞利用，没有发现与恶意行为相关的操作。因此，投毒风险较低，几乎可以忽略不计。

**总结：**

该漏洞是一个高危的Use-After-Free漏洞，攻击者可以利用该漏洞将权限提升到内核级别。PoC代码实现了利用该漏洞所需的步骤，并且看起来有效。在提供的代码中，没有发现投毒风险。

**项目地址:** [mutur4/CVE-2019-2215](https://github.com/mutur4/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #17

**来源**: [CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md](../2019/CVE-2019-2215-nicchongwb_Rootsmart-v2.0.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #18

**来源**: [CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md](../2019/CVE-2019-2215-qre0ct_android-kernel-exploitation-ashfaq-CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致提权至Linux内核

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞，存在于binder.c文件中。漏洞利用允许攻击者将权限从应用程序提升到Linux内核级别。无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。根据搜索结果和漏洞库信息，该漏洞已被野外利用，并且与APT组织SideWinder有关联。

**有效性：** 根据搜索结果，存在CVE-2019-2215的POC代码，并且已经被实际利用，因此漏洞利用是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个README.md文件，内容是关于此漏洞的描述，以及提供Docker镜像的用户信息。没有发现任何功能性代码。投毒风险较低，估计在10%左右。需要进一步检查Docker镜像的内容才能确定是否存在投毒行为。

**利用方式：**

1.  **漏洞触发：** 通过构造特定的Binder消息，在binder.c中触发use-after-free。
2.  **内存控制：** 攻击者利用内存管理机制，在释放的内存区域重新分配对象。
3.  **权限提升：** 通过精心构造的数据，覆盖内核数据结构，从而实现权限提升。具体而言，攻击者通常会尝试覆盖`cred`结构体，将其`uid`和`gid`修改为0，从而获得root权限。

综上，该漏洞危害严重，利用方式成熟，应尽快修复。

**项目地址:** [qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215](https://github.com/qre0ct/android-kernel-exploitation-ashfaq-CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #19

**来源**: [CVE-2019-2215-raymontag_CVE-2019-2215.md](../2019/CVE-2019-2215-raymontag_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中的一个use-after-free漏洞。此漏洞位于binder.c中，允许应用程序提升权限到Linux Kernel。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的另一个漏洞。漏洞利用代码包括Makefile和cve-2019-2215.c，用于编译生成expolit可执行文件，adb push可以将编译好的exploit推送到android手机的/data/local/tmp目录下。

**有效性：**
根据漏洞信息，搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是有效的。 搜索引擎结果中多个条目表明该漏洞已经在野外被利用，并且存在公开的expolit。

**投毒风险：**
根据提供的Makefile和部分代码段，投毒风险较低。Makefile 只是用于编译漏洞利用程序的标准文件，本身不包含恶意代码。提供的代码段主要是关于 binder_poll 和 epoll_ctl 的函数调用，是漏洞利用的关键部分，也未发现恶意代码。但不能完全排除投毒风险，需要对完整的`cve-2019-2215.c`进行分析，才可完全排除风险。因此判断投毒风险为10%。

**利用方式：**
1.  **漏洞触发：** 漏洞存在于Android内核的Binder驱动程序中，具体在`binder.c`文件的`binder_thread`结构体的`wait`成员中存在UAF问题。
2.  **利用流程：**
    *   利用程序首先需要获得在设备上的执行权限，可以通过安装恶意应用或利用其他漏洞实现。
    *   利用程序创建并操作Binder对象，触发UAF漏洞。 具体来说，该漏洞的触发与eventpoll机制(`epoll_ctl`, `ep_insert`, `ep_item_poll`)以及`binder_poll`函数的调用有关。
    *   通过精心构造的内存布局，攻击者可以在释放后再次使用该内存区域，从而覆盖或修改内核数据。
    *   利用覆盖的内核数据，攻击者可以修改进程的凭据(credentials)，将其UID/GID设置为0，从而获得root权限。
3.  **权限提升：** 通过利用UAF漏洞修改内核数据，攻击者可以将恶意应用程序的权限提升到root级别，从而完全控制设备。

**项目地址:** [raymontag/CVE-2019-2215](https://github.com/raymontag/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #20

**来源**: [CVE-2019-2215-raystyle_CVE-2019-2215.md](../2019/CVE-2019-2215-raystyle_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #21

**来源**: [CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md](../2019/CVE-2019-2215-sharif-dev_AndroidKernelVulnerability.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #22

**来源**: [CVE-2019-2215-stevejubx_CVE-2019-2215.md](../2019/CVE-2019-2215-stevejubx_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #23

**来源**: [CVE-2019-2215-timwr_CVE-2019-2215.md](../2019/CVE-2019-2215-timwr_CVE-2019-2215.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 中存在的 use-after-free 漏洞。攻击者可以通过该漏洞将权限从普通应用程序提升到 Linux 内核级别。根据漏洞库信息，利用该漏洞不需要用户交互，但需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞。

**有效性：**
提供的 POC 代码来源于多个已知的漏洞利用示例，如 Google Project Zero 和 qu1ckr00t 等，表明该漏洞存在并且可以被利用。代码逻辑清晰，利用了 binder 驱动中的 use-after-free 漏洞。因此，POC代码很可能是有效的。

**投毒风险：**
分析 POC 代码内容发现其目的是为了利用 CVE-2019-2215 漏洞。代码中包含构建 Makefile 和 Android.mk 文件，用于编译和构建 Android 可执行文件，以及 C 语言源代码，实现了利用 use-after-free 漏洞来获取内核 R/W 权限。整体代码结构清晰，没有发现明显的恶意或隐藏代码。尽管如此，在复制粘贴代码时存在引入错误的可能性，或者作者可能在不明显的地方进行了细微的修改，导致利用失败或产生其他副作用。因此，虽然概率较低，但仍然存在一定的投毒风险。综合评估，投毒风险为 5%。

**利用方式：**
1.  **漏洞原理：** 该漏洞是 binder.c 文件中的 use-after-free 漏洞，发生在 Binder 驱动程序中。
2.  **利用步骤：**
    *   首先，通过`epoll_ctl` 将binder_fd添加到epfd中，监听事件。
    *   构造一个 iovec 数组，其中 `iovec_array[IOVEC_INDX_FOR_WQ]` 指向 `dummy_page_4g_aligned`，用于在内核中伪造 waitqueue 结构。
    *   使用 pipe 创建管道，并设置管道大小为 0x1000。
    *   fork 创建子进程。子进程中，等待 2 秒后，调用 epoll_ctl 从 epfd 中删除 binder_fd，然后从管道中读取数据。
    *   父进程调用 ioctl(binder_fd, BINDER_THREAD_EXIT, NULL)，触发 binder 线程退出。
    *   父进程调用 writev 将 iovec 数组写入管道，触发 use-after-free 漏洞。
    *   父进程从管道中读取数据，泄漏内核信息。
    *   从泄漏的数据中获取 `current_ptr` (当前 task_struct 的指针)。
3.  **权限提升：** 通过泄漏的内核信息和利用 use-after-free 漏洞，可以实现内核任意地址读写，从而修改进程的权限信息，最终实现权限提升。

**结论：**
CVE-2019-2215 是一个严重的安全漏洞，利用难度相对较低，影响范围广泛。该漏洞已经被广泛利用，包括 APT 组织。及时更新 Android 系统和内核版本是防范该漏洞的有效方法。

**项目地址:** [timwr/CVE-2019-2215](https://github.com/timwr/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

## POC #24

**来源**: [CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md](../2019/CVE-2019-2215-willboka_CVE-2019-2215-HuaweiP20Lite.md)

## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)

---

