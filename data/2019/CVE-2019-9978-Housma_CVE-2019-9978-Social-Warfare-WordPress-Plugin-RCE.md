# CVE-2019-9978

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9978-0xMoonrise_cve-2019-9978.md](../2019/CVE-2019-9978-0xMoonrise_cve-2019-9978.md)

## CVE-2019-9978-Social-Warfare-Stored-XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 中危，可能导致会话劫持、恶意重定向、网页内容篡改

**影响版本:** < 3.5.3

**利用条件:** 需要安装存在漏洞版本的Social Warfare插件，并且目标WordPress站点的`swp_debug`参数未被禁用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是一个存在于WordPress Social Warfare插件3.5.3版本之前的存储型XSS漏洞。该漏洞允许攻击者通过`wp-admin/admin-post.php?swp_debug=load_options&swp_url=`参数注入恶意JavaScript代码，这些代码将存储在服务器上，并在用户访问包含此恶意代码的页面时执行。PoC代码通过启动一个简单的HTTP服务器，然后将包含恶意代码的URL发送到目标站点。目标站点获取恶意代码并存储，最终在其他用户访问站点的时候触发XSS。

根据提供的漏洞利用代码，脚本通过构造包含恶意代码的HTTP请求发送到目标WordPress站点。恶意代码通过GET参数`swp_url`传递，并且通过设置`swp_debug=load_options`来触发漏洞。

在评估投毒风险时，审查提供的Python脚本 `cve-2019-9978.py` 和 `README.md` 文件后，没有发现任何明显的恶意代码或后门。 该脚本的功能集中于利用已知的XSS漏洞，而不是试图引入任何有害功能。 脚本的功能是创建一个HTTP服务器以提供Payload，然后使用payload发起请求，脚本没有发现任何隐藏或不必要的功能，也没有执行任何可疑的操作。 漏洞利用代码的意图明确，仅用于概念验证和测试， 因此，代码中包含恶意投毒的可能性很低。

漏洞利用方式：
1.  攻击者需要找到安装了Social Warfare插件且版本低于3.5.3的WordPress站点。
2.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://target.com/wp-admin/admin-post.php?swp_debug=load_options&swp_url=<script>alert('XSS')</script>`
3.  攻击者将构造的URL发送给目标站点。
4.  目标站点处理请求，并将恶意代码存储在数据库中。
5.  当管理员或其他用户访问包含恶意代码的页面时，恶意代码将在用户的浏览器中执行。

**项目地址:** [0xMoonrise/cve-2019-9978](https://github.com/0xMoonrise/cve-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #2

**来源**: [CVE-2019-9978-KTN1990_CVE-2019-9978.md](../2019/CVE-2019-9978-KTN1990_CVE-2019-9978.md)

## CVE-2019-9978-Social-Warfare-WordPress-Stored-XSS-RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS / Remote Code Execution

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.5.2

**利用条件:** 目标网站安装了Social Warfare插件，并且版本低于或等于3.5.2, 存在wp-admin目录可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Social Warfare插件中，攻击者可以通过`swp_url`参数，在`wp-admin/admin-post.php?swp_debug=load_options` 页面注入恶意的JavaScript代码，导致存储型XSS。更严重的，结合RCE漏洞，攻击者可以通过上传恶意PHP脚本实现远程代码执行。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞在野外已被利用，并且存在公开的POC代码。该漏洞允许攻击者利用`wp-admin/admin-post.php?swp_debug=load_options&swp_url`参数注入恶意代码。

**投毒风险分析：**

POC代码的主要功能是检查目标是否存在漏洞，如果存在则上传webshell。其中从`https://hastebin.com/raw/iropememif`下载webshell上传。这个连接存在潜在的风险，仓库维护者或者黑客可以修改`https://hastebin.com/raw/iropememif`的内容，如果修改为恶意代码则存在投毒风险。但是从代码逻辑来看，主要还是执行RCE, 所以我评估投毒风险为5%。

**利用方式：**

1.  **检查插件版本：** 确认目标网站安装了Social Warfare插件，并且版本低于或等于3.5.2。
2.  **构造恶意请求：** 使用如下URL构造恶意请求：
    `目标网站/wp-admin/admin-post.php?swp_debug=load_options&swp_url=[恶意代码]`
    其中`[恶意代码]`是经过URL编码的恶意JavaScript代码，用于XSS攻击，或者是一个指向恶意PHP文件的URL，用于RCE攻击。
3.  **触发XSS：** 诱导管理员访问包含恶意代码的页面，触发XSS攻击。
4.  **RCE攻击：** 如果利用RCE漏洞，攻击者将webshell上传到服务器，然后通过访问webshell执行任意代码。
5.  **利用EXP:** 通过执行脚本 `python script.py list-of-sites.txt`, 即可批量上传webshell.

**项目地址:** [KTN1990/CVE-2019-9978](https://github.com/KTN1990/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #3

**来源**: [CVE-2019-9978-MAHajian_CVE-2019-9978.md](../2019/CVE-2019-9978-MAHajian_CVE-2019-9978.md)

## CVE-2019-9978-Social-Warfare-Stored-XSS-RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型跨站脚本 (Stored XSS) / 远程代码执行 (RCE)

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 高危，可能导致网站被控制，用户信息泄露

**影响版本:** < 3.5.3

**利用条件:** 需要WordPress网站安装有Social Warfare插件且版本低于3.5.3

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前版本中存在的存储型XSS漏洞，该漏洞源于对`wp-admin/admin-post.php?swp_debug=load_options`的`swp_url`参数处理不当。攻击者可以通过构造恶意的`swp_url`参数，将恶意JavaScript代码存储在插件设置中。当管理员或其他用户访问包含插件设置的页面时，恶意代码将被执行，从而实现XSS攻击。更严重的是，通过精心构造的`swp_url`参数，可以触发远程代码执行(RCE)。

**利用方式：**

1.  攻击者发送包含恶意`swp_url`参数的请求到`wp-admin/admin-post.php?swp_debug=load_options`，例如`?swp_url=<攻击者服务器>/evil.php`，将payload注入到 Social Warfare 的设置中。
2.  提供的漏洞利用代码使用 docker-compose 搭建了模拟环境，包含受害者服务器和攻击者服务器。
3.  攻击者服务器上的`evil.php`文件包含PHP代码，该代码会执行通过GET参数`cmd`传递的系统命令。
4.  `exploit.py`脚本通过发送GET请求到受害者服务器，`swp_url`参数指向攻击者服务器上的`evil.php`文件，并将要执行的系统命令作为`cmd`参数传递给`evil.php`。
5.  受害者服务器的`index.php`接收到`swp_url`参数后，会通过`file_get_contents`函数读取攻击者服务器上的`evil.php`文件，并将其内容返回。然后，受害者服务器尝试将返回的内容解析为PHP数组，由于`evil.php`文件中包含`<pre>system($code)</pre>`，导致解析出错，但在解析前会执行system函数，从而导致远程代码执行。

**投毒风险分析：**

提供的POC代码的目的是为了验证漏洞的存在，方便用户进行测试。
查看相关文件后：
*   `exploit.py`脚本只是发送恶意请求并解析结果，没有发现恶意代码。
*   `evil.php`文件直接执行GET参数传递的命令，也没有隐藏的恶意逻辑。
*   `index.php` 模拟了存在漏洞的Social Warfare插件。
因此，该仓库中没有发现作者隐藏的投毒代码，投毒风险为0%。

**有效性：**
根据漏洞描述和提供的利用代码，可以确定该漏洞利用代码能够有效利用 CVE-2019-9978 漏洞实现远程代码执行，因此具有有效性。

**项目地址:** [MAHajian/CVE-2019-9978](https://github.com/MAHajian/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #4

**来源**: [CVE-2019-9978-cved-sources_cve-2019-9978.md](../2019/CVE-2019-9978-cved-sources_cve-2019-9978.md)

## CVE-2019-9978-Social Warfare-存储型XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 中危，可能导致管理员账户被盗用、网站内容篡改

**影响版本:** < 3.5.3

**利用条件:** 需要目标网站安装了存在漏洞版本的Social Warfare插件，并允许用户（包括未授权用户）访问`wp-admin/admin-post.php?swp_debug=load_options&swp_url=`

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9978 是 WordPress Social Warfare 插件中存在的一个存储型跨站脚本漏洞。攻击者可以通过构造恶意的 `swp_url` 参数，将其发送到 `wp-admin/admin-post.php?swp_debug=load_options` 接口，将恶意的 JavaScript 代码存储在插件的配置中。当管理员或其他用户访问包含该配置的页面时，恶意代码就会被执行。根据搜索引擎结果和漏洞库信息，该漏洞在野外已被利用。提供的 Dockerfile 构建了一个包含漏洞版本（3.5.0）的 WordPress 和 Social Warfare 插件的环境，`main.sh` 脚本启动数据库和 Web 服务器，并激活该插件。漏洞利用方式主要是通过发送包含恶意 JavaScript 代码的请求到存在漏洞的 URL。投毒风险评估： 虽然Dockerfile和build脚本看起来没有明显的恶意代码，但Docker镜像本身的来源需要验证，是否存在投毒的风险为10%，主要体现在以下几点：
1.  **基础镜像风险**: Dockerfile使用了`cved/base-wordpress` 作为基础镜像。如果这个基础镜像本身被篡改过，包含了后门或者恶意软件，那么构建出来的所有容器都会受到影响。
2.  **第三方脚本来源**: `db.sql`脚本的内容没有提供，如果`db.sql`脚本中包含恶意的SQL代码，可能在数据库初始化的时候注入恶意数据或后门。但鉴于该镜像的目的是复现漏洞，因此恶意SQL的可能性较低，但是仍然不能排除。
3. **社会工程学投毒：**例如修改镜像名称，诱导用户使用恶意镜像。

综上，虽然直接投毒的可能性不高，但依然存在潜在的风险。

**项目地址:** [cved-sources/cve-2019-9978](https://github.com/cved-sources/cve-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #5

**来源**: [CVE-2019-9978-d3fudd_CVE-2019-9978_Exploit.md](../2019/CVE-2019-9978-d3fudd_CVE-2019-9978_Exploit.md)

## CVE-2019-9978 - WordPress Social Warfare Plugin 存储型XSS和远程代码执行

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型XSS / 远程代码执行 (RCE)

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 高危，可能导致网站权限被获取，远程代码执行。

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了存在漏洞的Social Warfare插件，攻击者可以无需认证利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前的版本中存在的存储型XSS漏洞，并且由于 settings import 功能存在缺陷，可以被利用于远程代码执行。根据漏洞信息和搜索结果，该漏洞已被在野利用。

**有效性：**

提供的POC代码`exploit.sh` 看起来是有效的。它利用`swp_debug=load_options` 和 `swp_url` 参数，通过POST请求将恶意代码注入到插件设置中。具体来说，它：

1.  接受目标WordPress URL，攻击者IP，和要执行的命令作为参数。
2.  创建一个名为`backdoor.php`的文件，该文件包含PHP代码，用于执行经过base64编码的命令（通过GET参数 `cmd`）。
3.  使用`curl`向目标WordPress网站的`wp-admin/admin-post.php`发送请求，设置 `swp_debug=load_options`，并通过`swp_url`参数指向攻击者服务器上的`backdoor.php`文件。`cmd`参数包含经过base64编码的命令。
4.  从响应中提取有用的信息并展示。
5.  删除临时文件。

**投毒风险：**

分析POC代码，`exploit.sh`脚本的主要功能是生成包含恶意PHP代码的`backdoor.php`文件，然后利用漏洞将该文件包含到目标网站上。在提供的`exploit.sh`脚本和 `README.md` 文件中，没有发现明显的恶意代码或后门。 风险极低。

**利用方式：**

1.  **存储型XSS：**攻击者利用`swp_debug=load_options` 和 `swp_url` 参数将恶意JavaScript代码存储到插件设置中。当管理员或其他用户访问插件设置页面时，恶意代码会被执行。
2.  **远程代码执行 (RCE)：**通过包含恶意PHP文件(`backdoor.php`)，攻击者可以在目标服务器上执行任意代码。该PHP文件会接收一个base64编码的命令，解码后使用`system()`函数执行。

攻击者首先要搭建一个可以访问的web服务器，将包含恶意代码的`backdoor.php`放置其中，然后构造恶意的URL，发送到存在漏洞的wordpress网站，如果目标网站没有更新到最新版本，则可能存在远程代码执行漏洞。


**项目地址:** [d3fudd/CVE-2019-9978_Exploit](https://github.com/d3fudd/CVE-2019-9978_Exploit)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #6

**来源**: [CVE-2019-9978-echoosso_CVE-2019-9978.md](../2019/CVE-2019-9978-echoosso_CVE-2019-9978.md)

## CVE-2019-9978-Social Warfare-Stored XSS / RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS / RCE

**影响应用:** Social Warfare (WordPress plugin)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了受影响版本的Social Warfare插件，且攻击者能访问admin-post.php接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前版本中的一个存储型XSS漏洞。此外，该漏洞还允许远程代码执行 (RCE)。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息明确指出该漏洞在野外已被利用。搜索结果中也包含多个关于该漏洞的利用细节和分析报告，包括Unit 42的报告，以及Wordfence关于RCE的描述。Exploit-DB中也存在相应的利用代码。

**投毒风险：**
提供的Python漏洞利用代码看起来比较直接，主要功能是发送包含payload URI的请求到目标服务器。代码本身的功能是利用RFI进行RCE，没有明显的投毒代码。其中通过`requests.get(uri)`方法发送恶意构造的URL，如果服务器返回500状态码，则尝试提取服务器返回的响应内容，判断是否包含payload。尽管没有明显的投毒代码，但仍存在极小的风险，例如攻击者可能通过恶意构造`payload.txt`文件进行投毒。因为payload本身是由攻击者控制，所以不能算作仓库的投毒风险。

**利用方式：**
1.  **确定目标：** 找到安装了Social Warfare插件，且版本低于或等于3.5.2的WordPress网站。
2.  **构造Payload：** 创建一个包含恶意代码的payload文件（例如，PHP代码），并将其托管在攻击者可访问的服务器上。
3.  **执行Exploit：** 运行提供的Python脚本，指定目标URL和payload文件的URI。该脚本会向`wp-admin/admin-post.php`发送一个GET请求，其中`swp_debug=load_options`和`swp_url`参数用于触发漏洞。
4.  **利用RCE：** 受害者服务器会尝试加载并执行payload文件中的恶意代码，从而导致RCE。

综上所述，此漏洞利用非常有效，但存在极小的投毒风险(例如利用RFI引入恶意的payload)，漏洞的根本原因是由于输入验证不足，导致可以执行远程文件。

**项目地址:** [echoosso/CVE-2019-9978](https://github.com/echoosso/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #7

**来源**: [CVE-2019-9978-grimlockx_CVE-2019-9978.md](../2019/CVE-2019-9978-grimlockx_CVE-2019-9978.md)

## CVE-2019-9978-Social Warfare-存储型XSS和RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型XSS / RCE

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 高危，可能导致远程代码执行和权限提升

**影响版本:** < 3.5.3

**利用条件:** 需要目标网站安装了存在漏洞的 Social Warfare 插件，并且攻击者可以访问 WordPress 后台（至少具备能够触发 admin-post.php 的权限，未授权RCE除外）。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-9978 漏洞存在于 WordPress Social Warfare 插件的 3.5.3 之前版本中。漏洞利用方式是利用 wp-admin/admin-post.php 接口中的 swp_debug=load_options&swp_url 参数，该参数存在存储型XSS漏洞，允许攻击者注入恶意 JavaScript 代码。根据搜索结果，该漏洞还存在远程代码执行（RCE）的可能性，攻击者可以通过构造特定的payload来实现 RCE。 

**有效性：**
提供的 POC 代码利用了 swp_url 参数中的存储型 XSS 漏洞，通过创建一个包含 PHP 代码的 payload.txt 文件，然后通过 HTTP 服务器提供该文件，并使用 `requests.get()` 方法触发漏洞。POC 代码能够创建 payload，启动 HTTP 服务器，并发送包含恶意 URL 的请求，表明该 POC 代码基本有效。

**投毒风险：**
代码中没有明显的恶意投毒行为。代码功能清晰，主要用于启动一个 HTTP 服务器，创建包含命令的 payload 文件，并利用漏洞发送请求。`os._exit(0)` 并非投毒行为，而是脚本正常结束的方式。但并不代表此仓库绝对安全，只能说明POC本身逻辑不存在投毒风险，但依旧存在风险,占比1%。

**利用方式：**
1.  攻击者需要找到一个安装了 Social Warfare 插件的 WordPress 网站，且插件版本低于 3.5.3。
2.  攻击者运行提供的 Python 脚本，指定目标 URL、本地 HTTP 服务器 IP 地址和端口，以及要执行的命令。
3.  脚本创建一个包含 PHP 代码的 payload.txt 文件，该文件包含要执行的命令 (例如，`<pre>system('COMMAND')</pre>`)。
4.  脚本启动一个本地 HTTP 服务器，用于提供 payload.txt 文件。
5.  脚本向目标网站的 wp-admin/admin-post.php 接口发送一个 GET 请求，其中 swp_debug 参数设置为 load_options，swp_url 参数设置为本地 HTTP 服务器上 payload.txt 文件的 URL。
6.  目标网站加载 payload.txt 文件中的 PHP 代码，并执行其中的命令。
7.  命令执行的结果会显示在响应中。

**项目地址:** [grimlockx/CVE-2019-9978](https://github.com/grimlockx/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #8

**来源**: [CVE-2019-9978-h8handles_CVE-2019-9978-Python3.md](../2019/CVE-2019-9978-h8handles_CVE-2019-9978-Python3.md)

## CVE-2019-9978-Social Warfare-Stored XSS/RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS/RCE

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和权限提升

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了受影响版本的Social Warfare插件，并且攻击者能够通过网络访问 `wp-admin/admin-post.php` 页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前版本中存在的存储型XSS漏洞，该漏洞可以通过 `wp-admin/admin-post.php?swp_debug=load_options&swp_url=` 参数利用。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用。提供的PoC代码尝试通过修改 `swp_url` 参数，加载远程payload.txt文件，实现RCE。
从代码来看，如果服务器返回500错误，则认为payload执行成功，这是一种简化的判断方式，实际情况可能需要更精确的验证。
因此，提供的POC代码是有效的，但可能需要根据目标环境进行调整，特别是payload.txt文件的内容。

**投毒风险：**
分析提供的PoC代码仓库，`/tmp/ce3f3c0f62eab3e0c5d7a8e346044fef/exploit.py`  代码的功能是利用漏洞，没有发现任何隐藏的恶意代码。代码逻辑清晰，主要用于发送包含恶意URL的HTTP请求。
`/tmp/ce3f3c0f62eab3e0c5d7a8e346044fef/README.md` 只是说明文档，没有可执行代码，因此投毒风险可以认为是 **0%**。

**利用方式：**
1.  攻击者构造包含恶意代码的 `payload.txt` 文件，该文件包含PHP代码，可以执行任意系统命令。
2.  攻击者向目标WordPress网站的 `wp-admin/admin-post.php` 发送请求，并设置 `swp_debug=load_options` 和 `swp_url` 参数为 `payload.txt` 文件的URL。
3.  Social Warfare插件在处理请求时，会加载并执行 `swp_url` 参数指定的远程文件，从而执行攻击者预设的恶意代码，实现RCE。执行恶意脚本导致存储型XSS, 在后台任何管理员用户访问插件设置时触发。

需要注意的是，该漏洞利用需要目标网站安装了受影响版本的Social Warfare插件，并且攻击者需要能够访问 `wp-admin/admin-post.php` 页面。

**项目地址:** [h8handles/CVE-2019-9978-Python3](https://github.com/h8handles/CVE-2019-9978-Python3)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #9

**来源**: [CVE-2019-9978-hash3liZer_CVE-2019-9978.md](../2019/CVE-2019-9978-hash3liZer_CVE-2019-9978.md)

## CVE-2019-9978 Social Warfare Plugin Stored XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 中危，可能导致用户凭据泄露，恶意脚本执行

**影响版本:** < 3.5.3

**利用条件:** 需要WordPress管理员权限或能够影响插件设置的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是一个存储型XSS漏洞，存在于WordPress Social Warfare插件3.5.3之前的版本中。攻击者可以通过`wp-admin/admin-post.php?swp_debug=load_options`的`swp_url`参数注入恶意JavaScript代码。由于漏洞位于插件设置中，因此需要具备管理员权限或能够修改插件设置的权限。利用方式如下：

1.  攻击者构造包含恶意JavaScript代码的`swp_url`参数。
2.  攻击者通过`wp-admin/admin-post.php?swp_debug=load_options`提交包含恶意代码的请求。
3.  恶意代码被存储在插件的设置中。
4.  当管理员或其他用户访问包含受影响插件设置的页面时，恶意JavaScript代码被执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及利用代码`https://www.exploit-db.com/exploits/46794/`，该漏洞的利用是有效的，并且已经在野外被利用。

**投毒风险：**
提供的代码片段是Apache 2.0 License的声明，不包含任何可执行代码或恶意代码。因此，该代码片段本身不构成投毒风险。但是，不能排除在完整的漏洞利用代码（例如Exploit-DB上的代码）中存在其他恶意代码的可能性，但根据目前的信息，没有发现明显的投毒迹象。

**利用方式：**
利用方式主要通过构造恶意的`swp_url`参数，该参数未经过充分的过滤，导致恶意JavaScript代码被存储到数据库中。当管理员或用户访问相关页面时，恶意代码被执行，从而实现XSS攻击。这种攻击的危害包括但不限于：窃取用户Cookie、重定向用户到恶意网站、篡改网页内容等。


**项目地址:** [hash3liZer/CVE-2019-9978](https://github.com/hash3liZer/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #10

**来源**: [CVE-2019-9978-mpgn_CVE-2019-9978.md](../2019/CVE-2019-9978-mpgn_CVE-2019-9978.md)

## CVE-2019-9978 - Social Warfare WordPress Plugin RCE/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/Stored XSS

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和恶意脚本注入

**影响版本:** < 3.5.3

**利用条件:** 需要安装存在漏洞的Social Warfare插件，并且目标WordPress站点开启了`swp_debug`参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9978是Social Warfare WordPress插件3.5.3之前的版本中存在的一个漏洞，它允许未经身份验证的攻击者通过`wp-admin/admin-post.php?swp_debug=load_options&swp_url=`参数注入恶意代码。通过设置`swp_debug=load_options`并指定一个包含恶意PHP代码的远程URL作为`swp_url`的值，攻击者可以利用`file_get_contents`函数读取该远程文件，并使用`eval`函数执行其中的代码，从而实现远程代码执行。此外，该漏洞也包含存储型XSS，恶意代码存储在数据库中，当管理员访问包含该代码的页面时，XSS payload会被触发。补丁移除了`SWP_Database_Migration.php`文件中与`load_options`相关的代码。

**有效性：**
提供的PoC代码是有效的。通过发送带有`swp_debug=load_options`和`swp_url`参数的请求，可以触发远程代码执行。

**投毒风险：**
此仓库存在一定的投毒风险，可能性约为10%。
*   虽然PoC本身是为了演示漏洞利用，但如果用户不小心使用了修改过的exploit.php，则存在潜在的风险。
*   README.md中提供的PoC利用链接到外部`exploit.php`文件，如果该文件被恶意修改，则会存在投毒行为。

**利用方式：**
1.  攻击者构造包含恶意PHP代码的远程文件，例如`exploit.php`。
2.  攻击者向目标WordPress站点的`wp-admin/admin-post.php`发送包含`swp_debug=load_options`和`swp_url`参数的请求，其中`swp_url`参数指向包含恶意PHP代码的远程文件。
3.  目标站点上的Social Warfare插件会使用`file_get_contents`函数读取远程文件，并使用`eval`函数执行其中的代码。
4.  攻击者从而实现远程代码执行，控制目标WordPress站点。

**项目地址:** [mpgn/CVE-2019-9978](https://github.com/mpgn/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

## POC #11

**来源**: [CVE-2019-9978-xxoprt_payloadCVE-2019-9978.md](../2019/CVE-2019-9978-xxoprt_payloadCVE-2019-9978.md)

## CVE-2019-9978-Social-Warfare-Stored-XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 中危，可能导致用户凭据泄露，网站内容篡改或恶意代码执行

**影响版本:** < 3.5.3

**利用条件:** 需要目标网站安装了Social Warfare插件，且版本低于3.5.3，攻击者需要具有向插件配置项写入数据的权限（通常通过利用另一个漏洞实现，例如未授权的设置更新）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9978 是 WordPress Social Warfare 插件3.5.3之前版本中的一个存储型XSS漏洞。该漏洞源于对 `swp_url` 参数的输入没有进行充分的过滤。攻击者可以通过 `wp-admin/admin-post.php?swp_debug=load_options` 端点注入恶意 JavaScript 代码。

**有效性分析：**
根据漏洞描述，攻击者通过构造包含恶意 JavaScript 代码的 `swp_url` 参数，利用 `swp_debug=load_options` 触发插件的设置加载功能，将恶意代码存储到插件的配置项中。当管理员或其他用户访问包含该配置的页面时，恶意代码会被执行。

提供的PoC代码包含一个 `payload.txt` 文件，其中包含 `<pre>system('cat /etc/passwd')</pre>`。该代码尝试使用 `system()` 函数执行系统命令 `cat /etc/passwd`，以读取服务器的密码文件。如果此payload成功注入并执行，将造成严重安全问题。

根据搜索结果，该漏洞已在野外被利用，证明了其有效性。

**投毒风险分析：**
该仓库包含一个 `README.md` 和一个 `payload.txt` 文件。
*   `README.md` 文件内容为 "ssssss"，没有可疑代码。
*   `payload.txt` 文件包含执行系统命令的代码，目的是验证漏洞，并非投毒。

但是依然存在一些投毒风险，需要关注。
*   攻击者可能会修改 `payload.txt` 中的代码，例如替换为恶意链接或更隐蔽的恶意代码。
*   攻击者可能在其他文件中添加恶意代码，例如通过 `eval()` 函数执行远程代码。

综合来看，投毒风险较低，但仍然需要仔细审查代码。

**利用方式分析：**
1.  **找到存在漏洞的 WordPress 站点：** 确定目标站点安装了 Social Warfare 插件，并且版本低于 3.5.3。
2.  **利用漏洞注入恶意代码：**  构造包含恶意 JavaScript 代码的 `swp_url` 参数，发送到 `wp-admin/admin-post.php?swp_debug=load_options` 端点。
3.  **等待恶意代码执行：** 等待管理员或其它用户访问包含受污染配置的页面，触发恶意代码的执行。恶意代码可以窃取用户 Cookie、重定向到恶意网站、篡改页面内容等。

利用此漏洞需要能够修改插件设置，通常攻击者需要利用其他的漏洞比如未授权配置更新来配合利用。根据搜索结果，该漏洞有时会与RCE漏洞一起被提及，因此确认目标是否存在相关漏洞至关重要。

**项目地址:** [xxoprt/payloadCVE-2019-9978](https://github.com/xxoprt/payloadCVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)

---

