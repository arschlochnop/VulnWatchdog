# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

# CVE-2019-14287

> 📦 该CVE有 **16** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md](../2019/CVE-2019-14287-CMNatic_Dockerized-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户权限，但被禁止以root用户执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许具有 `Runas ALL` 权限但被显式禁止以 `root` 身份运行命令的用户绕过此限制，通过指定用户ID `-u \#$((0xffffffff))` 或 `-u -1`来执行命令。该漏洞存在于Sudo 1.8.28之前的版本中。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且POC代码（Dockerfile）通过构建包含易受攻击的Sudo版本的Docker镜像来验证漏洞。Dockerfile中配置了`uogctf`用户，并赋予其`ALL=(ALL,!root)`权限，这正是触发漏洞的前提条件。通过SSH登录到容器，然后使用特定的`sudo`命令可以绕过`!root`限制，以`root`权限执行命令，从而读取`/root/root.txt`文件，证明漏洞利用成功。

**投毒风险：**

Dockerfile中存在潜在的投毒风险的可能性较低，约5%。
* 代码主要目的是为了复现CVE-2019-14287漏洞，提供一个可利用的环境。
*  Dockerfile中设置了一个flag文件`/root/root.txt`，仅用于演示漏洞，并非恶意代码。
* 修改了ssh配置,允许使用密码登录,但只是为了方便漏洞复现,不是后门.
* 虽然设置了默认密码，但这属于漏洞演示环境的一部分，方便用户快速验证，本身不是为了植入恶意代码

总体来说，该Dockerfile更侧重于漏洞的复现和演示，而不是植入恶意后门。

**利用方式：**

1.  攻击者首先需要获得一个具有`Runas ALL`权限，但被禁止以`root`身份运行命令的账号。例如，在`/etc/sudoers`文件中存在类似`username ALL=(ALL,!root) /bin/command`的配置。
2.  攻击者使用`sudo -u \#$((0xffffffff)) <command>`或`sudo -u -1 <command>`命令来执行目标命令。Sudo在处理`-u`选项时存在缺陷，会将此ID视为未指定用户，从而绕过`!root`限制。
3.  通过上述方式，攻击者可以以`root`权限执行任意命令，从而提升权限。

**项目地址:** [CMNatic/Dockerized-CVE-2019-14287](https://github.com/CMNatic/Dockerized-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #2

**来源**: [CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md](../2019/CVE-2019-14287-CashWilliams_CVE-2019-14287-demo.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行任意命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被配置为拥有Runas ALL权限，但同时被禁止以root身份运行命令

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户绕过策略黑名单和会话 PAM 模块，并可能导致错误的日志记录。通过使用精心构造的用户 ID 调用 sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1 bash`，可以绕过 `!root` 配置，从而以 root 身份执行命令。 

**有效性:** 提供的 Dockerfile 和相关脚本构成了一个有效的 POC。它首先创建一个存在漏洞的 sudo 环境 (1.8.21p2)，并配置了一个用户 alice，该用户被允许以任何其他用户的身份运行命令，但 root 除外。 run.sh脚本结合readme.md文件展示了如何利用 `sudo -u#-1 bash` 命令绕过此限制，从而以 root 身份执行 bash。

**投毒风险:** 提供的代码仓库主要用于漏洞演示，从代码分析来看，没有发现任何明显的投毒代码。所有的脚本和配置文件都服务于漏洞的复现和演示目的。readme.md 文件清晰地解释了漏洞的原理和利用方法。build.sh 和 release.sh 脚本用于构建和发布 Docker 镜像，没有恶意行为。因此，评估投毒风险为 0%。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有在 sudoers 文件中配置了 `Runas ALL` 权限的账户（例如，`alice ALL=(ALL,!root) NOPASSWD: ALL`）。这意味着该用户可以以任何其他用户的身份运行命令，但通常被禁止以 root 身份运行命令。
2.  **绕过限制:** 攻击者使用 `sudo -u#-1` 或 `sudo -u \#$((0xffffffff))` 命令指定一个非法的用户 ID。由于 Sudo 在 1.8.28 之前的版本中对此类用户 ID 的处理存在缺陷，导致其未能正确地应用 `!root` 限制。
3.  **提权:** 通过上述绕过，攻击者成功地以 root 身份执行任意命令，从而获得系统完全控制权。

总而言之，该漏洞的利用依赖于特定 sudo 配置和用户输入，并且需要特定的sudo版本才会触发。

**项目地址:** [CashWilliams/CVE-2019-14287-demo](https://github.com/CashWilliams/CVE-2019-14287-demo)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #3

**来源**: [CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md](../2019/CVE-2019-14287-DularaAnushka_Linux-Privilege-Escalation-using-Sudo-Rights.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #4

**来源**: [CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md](../2019/CVE-2019-14287-FauxFaux_sudo-cve-2019-14287.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可提升至root权限

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL权限的sudoer账号

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有Runas ALL权限的sudoer账号的攻击者通过指定一个特殊的user ID来绕过某些策略黑名单和会话PAM模块。例如，通过执行 `sudo -u \#$((0xffffffff))` 命令可以绕过 `!root` 配置，并导致错误的日志记录。漏洞利用方式是利用sudo在处理用户ID时的缺陷，将`-1`或`0xffffffff`转换为无符号整数，从而绕过对目标用户（例如root）的限制。

**有效性：** 基于漏洞信息和搜索引擎结果（特别是exploit-db.com的结果），可以确认该漏洞的POC代码是有效的，因为存在公开可用的利用程序。

**投毒风险：** 提供的代码片段 `ABOUT-NLS` 与漏洞利用本身没有直接关系，它是GNU gettext的一个文件，用于软件国际化和本地化。这个文件主要涉及翻译相关的配置，不包含任何可疑的恶意代码。因此，评估投毒风险为0%。

**利用方式：**
1.  攻击者需要拥有sudoers中具有 `Runas ALL` 权限的账号。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令尝试以root权限执行命令。
3.  Sudo在处理`-u`参数时，由于整数转换问题，错误地绕过了对root用户的限制。
4.  攻击者成功以root权限执行任意命令。

**项目地址:** [FauxFaux/sudo-cve-2019-14287](https://github.com/FauxFaux/sudo-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---



---

## POC #5

**来源**: [CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md](../2019/CVE-2019-14287-Hasintha-98_Sudo-Vulnerability-Exploit-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL sudoer 账户的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 允许具有 Runas ALL 权限的用户通过指定一个特殊的UID（例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1`）来绕过某些安全策略的限制。这使得攻击者即使在 sudo 配置文件中显式禁止了 root 访问的情况下，也能够以 root 身份执行命令。漏洞的利用方式是，sudo 在处理这种特殊的 UID 时，没有正确地应用配置中的策略限制，导致了权限提升。

**有效性：** 根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。

**投毒风险：** 提供的漏洞利用代码 `README.md` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，作者可能会在其他相关文件中（如果存在）包含恶意代码。此处假设该仓库只包含此文件，因此投毒风险较低。`README.md` 文件本身仅仅是对漏洞的描述和利用方式的说明。

**利用方式：**

1.  攻击者需要拥有 Runas ALL sudoer 账户的访问权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令来指定要运行命令的用户ID。
3.  攻击者在上述命令后附加要执行的命令。
4.  sudo 没有正确应用安全策略，以 root 权限执行攻击者提供的命令，从而绕过配置限制。

**项目地址:** [Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287](https://github.com/Hasintha-98/Sudo-Vulnerability-Exploit-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #6

**来源**: [CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md](../2019/CVE-2019-14287-HussyCool_CVE-2019-14287-IT18030372-.md)

## CVE-2019-14287-Sudo Security Policy Bypass

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许非授权用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有sudo权限，但是受到特定策略限制（例如不允许以root身份运行）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞存在于 Sudo 1.8.28 之前的版本中。具有 `Runas ALL` 权限的攻击者可以通过指定一个特殊的 user ID（例如 `sudo -u \#$((0xffffffff))`）来绕过某些安全策略黑名单和会话 PAM 模块，并可能导致不正确的日志记录。  

**有效性：**
根据漏洞库信息和搜索结果，此漏洞允许绕过 `!root` 配置，并可能以 root 身份执行命令，因此提供的 POC 代码可以验证该漏洞，但是提供的POC仅仅是 Readme，需要根据readme文件描述的方法来验证漏洞。

**投毒风险：**
提供的漏洞利用代码只有一个 README.md 文件。该文件通常只包含漏洞描述和使用说明，直接包含恶意代码的可能性较低。但无法完全排除投毒的可能性，存在作者在文档中暗示恶意操作的可能性，概率较低。因此推测投毒风险为10%。

**利用方式：**
1.  攻击者需要拥有可以通过sudo执行命令的权限。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或者相似的命令来尝试以非预期用户（例如UID为-1的用户）的身份执行命令。
3.  由于sudo的身份验证缺陷，sudo没有正确验证UID，导致绕过了原有的安全策略。
4.  攻击者现在可以执行原本被禁止的操作，例如以root权限执行命令。
5.  通过执行 `sudo -u \#4294967295` 命令或者`sudo -u \#-1` 执行命令，可以绕过一些安全策略限制。

**项目地址:** [HussyCool/CVE-2019-14287-IT18030372-](https://github.com/HussyCool/CVE-2019-14287-IT18030372-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #7

**来源**: [CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md](../2019/CVE-2019-14287-M108Falcon_Sudo-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户具有sudo权限，但sudoers配置禁止以root身份执行命令（例如 !root 配置）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudoer账户绕过某些策略黑名单和会话PAM模块，并可能导致不正确的日志记录。该漏洞通过使用一个构造的用户ID来调用sudo，例如 `sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`。这会绕过诸如 `!root` 配置，并允许用户以root身份执行命令，即使sudoers文件明确禁止这样做。

**有效性评估：**

根据漏洞描述、搜索结果（如Exploit-DB上的exploit）和提供的POC代码，此漏洞的利用是有效的，特别是在Sudo版本低于1.8.28的系统上。

提供的Python脚本`sudo-exploit.py`尝试确定当前用户的权限，提取允许执行的二进制文件，然后尝试使用`-u#-1`选项以root权限执行它们。Bash脚本`sudo-exploit.sh`检查用户是否具有sudo权限，并验证Sudo版本是否易受攻击。如果易受攻击，它将尝试使用`-u#-1`选项执行用户可以sudo执行的命令。

**投毒风险分析：**

对提供的Python和Bash脚本进行分析后，未发现明显的恶意或投毒代码。脚本的主要目的是验证和利用CVE-2019-14287漏洞。这些脚本旨在检查用户的sudo权限、sudo版本，并尝试利用该漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**

1.  **前提条件：** 攻击者必须具有sudo权限，并且sudoers文件必须允许攻击者运行命令，但明确禁止以root身份运行（例如，使用`!root`）。
2.  **绕过限制：** 攻击者使用`sudo -u \#$((0xffffffff))` 或 `sudo -u#-1`命令，其中`\#$((0xffffffff))` 或 `-1` 被Sudo错误地解释为一个用户ID，从而绕过了`!root`的限制和其他安全策略。
3.  **执行命令：** 通过绕过限制，攻击者可以以root权限执行任意命令。
4.  **漏洞修复：** 升级Sudo到1.8.28或更高版本可以修复此漏洞。

**项目地址:** [M108Falcon/Sudo-CVE-2019-14287](https://github.com/M108Falcon/Sudo-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #8

**来源**: [CVE-2019-14287-MariliaMeira_CVE-2019-14287.md](../2019/CVE-2019-14287-MariliaMeira_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #9

**来源**: [CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md](../2019/CVE-2019-14287-axax002_sudo-vulnerability-CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #10

**来源**: [CVE-2019-14287-edsonjt81_CVE-2019-14287-.md](../2019/CVE-2019-14287-edsonjt81_CVE-2019-14287-.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可能导致权限提升至root

**影响版本:** < 1.8.28

**利用条件:** 拥有Runas ALL权限的sudoer账户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的 sudoer 账户的用户，通过指定特殊的 User ID (例如 `-u \#$((0xffffffff))`) 来绕过某些安全策略和 PAM 模块的限制，从而可能以 root 权限执行命令。漏洞利用代码分析：提供的代码仅仅是GPL协议，没有任何漏洞验证代码。

**有效性:**

根据漏洞库信息和搜索引擎结果（特别是 Exploit-DB 的链接），此漏洞存在可利用性。攻击者通过构造特定的 sudo 命令，可以绕过某些安全限制。

**投毒风险:**

提供的漏洞利用代码只是 GNU GPL 许可证，不包含任何可执行代码，因此投毒风险为 0%。

**利用方式:**

1.  攻击者需要拥有一个被配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令来指定一个特殊的 User ID。
3.  Sudo 在处理这个 User ID 时出现错误，导致某些安全策略被绕过。
4.  攻击者成功以 root 权限执行任意命令。

**项目地址:** [edsonjt81/CVE-2019-14287-](https://github.com/edsonjt81/CVE-2019-14287-)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #11

**来源**: [CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md](../2019/CVE-2019-14287-gurneesh_CVE-2019-14287-write-up.md)

## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户拥有sudo ALL权限，但受到某些策略限制（例如禁止以root身份运行某些命令）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有sudo ALL权限的用户通过指定无效的用户ID（如`sudo -u#-1`或`sudo -u#4294967295`）来绕过某些sudo策略限制，例如`!root`配置。这会导致sudo错误地处理用户ID，从而绕过对root用户执行命令的限制。利用方式是：

1.  配置sudoers，允许特定用户以ALL权限运行命令，但排除root用户执行特定命令(例如 `test ALL=(ALL, !root) /usr/bin/id`)。
2.  攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  由于sudo处理用户ID的缺陷，命令将以root权限执行，从而绕过`!root`限制。

**有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的。POC展示了如何绕过`!root`配置，以root权限执行命令`id`。

**投毒风险：**POC代码的主要功能是演示漏洞利用，而不是植入恶意代码。 但是在大型代码仓库中，仍然可能存在作者隐藏的投毒代码的风险。风险评估较低，约为5%。风险主要体现在：
*   `README.md` 文件虽然描述了漏洞利用方法，但可能包含细微的修改或添加，如果用户直接复制粘贴执行，可能引入未知的风险。
*  下载执行poc脚本，有潜在的风险。

**利用方式：**

1.  **先决条件：** 攻击者需要拥有sudo ALL权限，但受到`!root`或其他策略限制，阻止其以root身份运行某些命令。
2.  **漏洞触发：** 攻击者使用`sudo -u#-1 command`或`sudo -u#4294967295 command`来执行受限命令。
3.  **权限提升：** 由于sudo的缺陷，该命令将以root权限执行，从而绕过策略限制，实现权限提升。

**项目地址:** [gurneesh/CVE-2019-14287-write-up](https://github.com/gurneesh/CVE-2019-14287-write-up)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #12

**来源**: [CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md](../2019/CVE-2019-14287-h3x0v3rl0rd_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** Sudo

**危害等级:** 高危，可能导致权限提升

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL的sudoers账户，但受到策略黑名单或PAM模块的限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许具有 Runas ALL 权限的 sudoer 账户绕过某些策略黑名单和会话 PAM 模块，以及导致不正确的日志记录。这是通过使用特制的 user ID 调用 sudo 来实现的。例如，这允许绕过 !root 配置，以及 USER= 日志记录，对于 `sudo -u \#$((0xffffffff))` 命令。

**有效性分析：**

根据漏洞信息和搜索结果，POC代码是有效的。漏洞利用的关键在于使用 `-u#-1` 或 `-u #4294967295`（0xffffffff 的十进制表示）来指定用户，这会导致 sudo 在权限检查时出现错误，从而绕过某些限制。

**投毒风险分析：**

提供的 shell 脚本 `sudo.sh` 的主要功能是检测目标系统上 sudo 是否易受攻击，并尝试利用它。脚本首先检查当前用户是否拥有 sudo ALL 权限。如果没有，它会检查用户是否具有任何 sudo 权限。如果用户具有 sudo 权限，脚本将确定 sudo 版本，并将其与易受攻击的版本进行比较。如果 sudo 版本易受攻击，则脚本会尝试使用 `sudo -u#-1` 运行用户通常使用的程序。这个脚本看起来主要是为了利用漏洞，但是依然有潜在投毒风险,例如如果用户具有某些特定的命令执行权限, 利用后可能会影响正常使用或者收集敏感信息等。另外，脚本的开发作者也无法完全信任。

结合代码分析，将投毒风险评估为 10%。

**利用方式：**

1.  **条件：** 攻击者必须具有 sudo ALL 权限，但由于某些策略（例如 `!root`）或 PAM 模块的限制，无法直接以 root 身份运行命令。
2.  **利用：** 攻击者使用 `sudo -u#-1 <command>` 或 `sudo -u #4294967295 <command>` 的形式运行命令。这里的 `-1` 或 `4294967295` 会被 sudo 内部处理为未识别的用户 ID。
3.  **结果：** 由于 sudo 的错误处理，它不会正确地进行权限检查，从而允许攻击者以 root 身份（或其他被允许的用户身份）运行命令，绕过原本的限制。
4.  **修复：** 升级到 Sudo 1.8.28 或更高版本。

**项目地址:** [h3x0v3rl0rd/CVE-2019-14287](https://github.com/h3x0v3rl0rd/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #13

**来源**: [CVE-2019-14287-huang919_cve-2019-14287-PPT.md](../2019/CVE-2019-14287-huang919_cve-2019-14287-PPT.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #14

**来源**: [CVE-2019-14287-lemonadern_poc-cve-2019-14287.md](../2019/CVE-2019-14287-lemonadern_poc-cve-2019-14287.md)

## CVE-2019-14287

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令，导致系统完全控制

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`权限的用户账户，但显式禁止root权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有`Runas ALL`权限的用户通过指定特殊的UserID（如`-1`或`4294967295`）来绕过sudo的安全策略，以root身份执行命令。即使sudoers文件明确禁止该用户以root身份运行命令，该漏洞仍然有效。

**有效性分析：**
提供的Dockerfile配置了一个存在漏洞的Sudo版本（1.8.21p2），并创建了一个名为user1的用户，该用户在sudoers文件中被赋予`ALL=(ALL, !root) NOPASSWD: ALL`权限。这意味着user1可以以任何用户的身份运行任何命令，但root除外。利用代码展示了如何通过`sudo -u#-1 whoami`命令绕过此限制，并以root身份执行`whoami`命令。因此，提供的POC代码是有效的。

**投毒风险分析：**
Dockerfile的内容主要用于搭建漏洞环境，其中包含下载特定版本sudo，创建用户并赋予sudo权限等常规操作，没有发现明显的恶意代码。
LICENSE文件采用MIT License，比较宽松，存在被恶意利用的可能性，但其本身不构成投毒。
README.md文件仅为漏洞演示说明，没有发现恶意代码。
docker-compose.yml文件定义了Docker容器的配置，也没有发现恶意代码。
综合判断，该仓库的投毒风险较低，约为5%。该风险主要来源于MIT协议的宽松性，攻击者可能利用该协议发布修改后的恶意版本。

**利用方式：**
1.  攻击者需要获得一个在sudoers文件中被授予`Runas ALL`权限的帐户，例如`user1 ALL=(ALL, !root) NOPASSWD: ALL`，但被显式禁止以root身份运行命令。
2.  攻击者使用`sudo -u#-1 <command>`或`sudo -u#4294967295 <command>`命令执行任意命令，这些命令将以root权限运行。
3.  Sudo在处理UserID时，将`-1`或`4294967295`错误地解释为UID 0（root），从而绕过了sudoers文件中对root用户的限制。

**项目地址:** [lemonadern/poc-cve-2019-14287](https://github.com/lemonadern/poc-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #15

**来源**: [CVE-2019-14287-n0w4n_CVE-2019-14287.md](../2019/CVE-2019-14287-n0w4n_CVE-2019-14287.md)

## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有 Runas ALL 的 sudoer 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定一个特殊的用户ID（例如 -u \#$((0xffffffff)) 或 -u -1）来绕过某些安全策略，包括 !root 配置。这使得攻击者可以以 root 身份执行命令，即使 sudo 配置明确禁止以 root 身份运行。漏洞利用方式是利用sudo在处理用户ID时的缺陷，Sudo在1.8.28之前版本，如果使用非用户名或者有效的uid启动sudo，会存在安全策略绕过，从而以root身份执行命令。

提供的代码片段只是 GNU GPL 许可证，并非漏洞利用代码本身。根据搜索引擎结果，存在公开的漏洞利用代码（例如 exploit-db.com/exploits/47502）。因此，POC的有效性较高。

提供的代码片段为GNU GPL许可证，并非实际的利用代码，因此不存在投毒风险。但是，如果下载了exploit-db上的poc进行使用，则需要对下载的poc代码进行安全审计，防止被植入恶意代码。

**项目地址:** [n0w4n/CVE-2019-14287](https://github.com/n0w4n/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

## POC #16

**来源**: [CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md](../2019/CVE-2019-14287-shallvhack_Sudo-Security-Bypass-CVE-2019-14287.md)

## CVE-2019-14287-Sudo安全绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root身份执行命令

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL sudoer账户的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287 允许拥有 Runas ALL 权限的用户通过指定特殊的用户ID来绕过某些安全策略和PAM模块。具体来说，通过使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令，Sudo 可能不会正确地进行用户身份验证和权限检查，导致用户可以以 root 身份执行命令，即使 sudo 配置文件中明确禁止了 root 访问。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞确实存在于 Sudo 1.8.28 之前的版本，并已被广泛报道和修复。提供的 POC 代码 `SudoSecurityBypass.sh` 旨在检测目标系统是否存在此漏洞，通过尝试利用该漏洞执行命令来验证。

**投毒风险：** 查看提供的脚本 `SudoSecurityBypass.sh` 代码，主要作用是检测是否存在漏洞，利用的命令是 `sudo -u \#$((0xffffffff))`。脚本首先检查当前用户是否具有 ALL sudo 权限，如果具有，则建议使用权限较低的用户进行测试。脚本本身相对简单，主要用于漏洞检测，但仍存在极小的投毒风险 (5%) ，风险点在于：

*   **依赖外部资源：** 如果脚本修改为从外部源下载或执行代码，则可能引入恶意代码。
*   **恶意命令执行：** 脚本可能会包含在漏洞利用成功后执行恶意命令的代码，例如添加后门用户等。虽然当前提供的脚本不包含此类代码，但修改是相对容易的。
*   **条件竞争或资源耗尽：** 理论上，可以通过精心构造的命令来利用条件竞争或资源耗尽漏洞，但这需要更复杂的脚本。

**利用方式：**

1.  **前提条件：** 攻击者必须具有可以通过 sudo 执行命令的权限，并且在 sudoers 文件中具有 `Runas ALL` 权限。
2.  **绕过限制：** 使用 `sudo -u \#$((0xffffffff))` 或者 `sudo -u -1` 命令来指定一个无效的用户ID。
3.  **执行命令：** 在上述命令后，添加需要执行的命令。由于漏洞，Sudo 可能会错误地执行该命令，并赋予 root 权限。
4.  **结果：** 命令以 root 权限执行，允许攻击者执行任意操作，例如修改系统文件、安装恶意软件等。

**项目地址:** [shallvhack/Sudo-Security-Bypass-CVE-2019-14287](https://github.com/shallvhack/Sudo-Security-Bypass-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)

---

