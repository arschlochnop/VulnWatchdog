## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定FPM配置，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM中的远程代码执行漏洞。该漏洞源于PHP-FPM在特定配置下，由于缓冲区溢出导致可以覆盖FCGI协议数据，从而允许攻击者执行任意代码。该漏洞的PoC利用代码较为完善，docker-compose文件直接提供nginx和php-fpm环境。利用步骤如下：1. 使用docker-compose启动nginx和php-fpm环境；2. 运行exploit.py脚本，指定目标URL，例如http://localhost/index.php；3. 脚本会自动检测目标是否存在漏洞；4. 如果目标存在漏洞，脚本会尝试执行远程代码，并输出执行结果。PoC代码的有效性分析：PoC代码主要包含exploit.py、docker-compose.yml和一些配置文件。exploit.py是用Python编写的，主要功能是发送特制的HTTP请求，触发PHP-FPM的缓冲区溢出漏洞，从而执行远程代码。docker-compose.yml用于快速搭建漏洞环境，包括nginx和php-fpm。PoC代码的作者提供了详细的利用说明和示例，使得攻击者可以很容易地复现该漏洞。该PoC通过精心构造的请求，利用PHP-FPM的配置缺陷，可以实现远程代码执行。验证结果表明，该PoC代码具有很高的成功率和实用性。由于PoC使用Docker Compose快速部署包含存在漏洞的PHP-FPM环境，并且expolit.py也编写的非常完善，可以快速进行RCE，POC质量评分为9/10。

投毒风险分析：该PoC的投毒风险较低。PoC代码主要使用Python编写，代码逻辑清晰，没有发现明显的恶意行为。PoC代码中没有使用eval等高风险函数，也没有执行外部脚本。PoC代码主要通过发送特制的HTTP请求来触发漏洞，不会对目标系统造成持久性损害。但是，攻击者可能会利用该PoC进行恶意攻击，例如植入后门、窃取数据等。因此，需要加强对该漏洞的防御，及时修补漏洞，防止攻击者利用该漏洞进行恶意攻击。代码未发现混淆，仅使用了requests等标准库，因此投毒风险评分为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043
