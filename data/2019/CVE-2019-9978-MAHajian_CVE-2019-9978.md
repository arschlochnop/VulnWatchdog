## CVE-2019-9978 - Social Warfare 插件 (WordPress) RCE/Stored XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/Stored XSS

**影响应用:** Social Warfare 插件 (WordPress)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 3.5.3

**利用条件:** 无需认证，远程网络访问，插件处于启用状态

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC提供了一个完整的本地模拟环境（Docker-compose）以及自动化利用脚本。漏洞根源在于WordPress的Social Warfare插件在处理‘swp_debug=load_options’参数时，未对‘swp_url’传入的外部URL进行充分校验。攻击者可以诱导服务器加载其控制下的恶意配置文件或脚本，从而实现存储型XSS或远程代码执行（RCE）。在本POC中，脚本通过访问受害者服务器并传递‘swp_url’参数，指向攻击者服务器上的‘evil.php’。‘evil.php’包含典型的命令执行后门代码（system($_GET['cmd'])）。分析表明，利用逻辑非常简洁且直接：首先，利用脚本通过requests库向受影响的路径发送GET请求；其次，通过参数注入将恶意payload注入到插件的加载流程中。由于该漏洞不需要任何身份验证且可以通过单个HTTP请求触发，其有效性极高。在模拟环境中，该POC成功实现了交互式Shell的效果，能够实时执行系统命令并解析返回结果。利用步骤如下：1. 使用Docker部署漏洞环境和攻击者服务器。2. 修改.env文件配置相关IP和端口。3. 运行exploit.py脚本。4. 脚本会自动建立与受害者的连接并提供命令行界面。5. 输入系统命令（如ls, id），脚本将通过注入恶意的swp_url获取执行结果。投毒风险分析：经过对提供的POC源码进行静态审计，未发现明显的恶意行为或后门植入。该POC主要依赖标准的Python库（requests, beautifulsoup4, colorama, python-dotenv），这些库均通过pip从官方源安装。代码逻辑清晰透明，exploit.py的主要功能是发送特定的HTTP payload并解析HTML响应。虽然代码中使用了‘system($code)’等敏感函数，但这是作为漏洞验证的目的而存在于模拟的受害者代码和攻击者payload脚本中，并非针对安全研究员本机的恶意投毒。Docker-compose文件仅配置了基础的PHP环境映射，没有越权挂载系统目录或执行宿主机命令的行为。风险较低，主要在于其使用的.env配置文件可能泄露环境变量，以及其攻击脚本可能被未经修改直接用于生产环境。整体来看，该POC属于纯粹的安全研究工具，没有混淆代码、恶意外部请求或隐蔽的二进制执行程序，符合安全审计的要求。建议用户在隔离的沙箱环境中使用，并确保在合规授权的前提下进行测试。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978) (基于路径推断)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
