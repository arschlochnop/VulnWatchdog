## CVE-2019-1663 - Cisco RV110W/RV130W/RV215W 远程命令执行漏洞

**漏洞编号:** CVE-2019-1663

**漏洞类型:** 远程命令执行

**影响应用:** Cisco RV110W, RV130W, RV215W 路由器

**危害等级:** 高危，未经身份验证的远程攻击者可以以高权限用户身份在受影响设备的底层操作系统上执行任意代码。

**影响版本:** RV110W Wireless-N VPN Firewall 版本低于 1.2.2.1
RV130W Wireless-N Multifunction VPN Router 版本低于 1.0.3.45
RV215W Wireless-N VPN Router 版本低于 1.3.1.1

**利用条件:** 目标设备开启web管理界面，且版本在受影响范围内。攻击者需要能够通过网络访问目标设备的web管理界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2019-1663存在于Cisco RV110W, RV130W, 和RV215W 路由器的web管理界面。由于web管理界面对用户提供的数据验证不足，未经身份验证的远程攻击者可以通过向目标设备发送恶意的HTTP请求来利用此漏洞，最终以高权限用户身份在底层操作系统上执行任意代码。

**有效性分析：**
根据漏洞库信息，该漏洞允许远程命令执行，风险评级为严重。漏洞利用代码片段`FUN_0002bf64` 展示了httpd进程中的用户验证逻辑，该函数接收用户名、密码等参数，用于验证用户身份。虽然提供的代码片段本身不包含直接的漏洞利用代码，但结合漏洞描述，可以推断漏洞可能存在于该函数对用户输入数据的处理过程中，例如对用户名或密码的长度没有进行充分的校验，或者使用了存在漏洞的函数进行处理。
查看搜索引擎结果指向了Rapid7 Metasploit 模块以及Packet Storm上的利用代码，表明已经存在公开可用的漏洞利用。
因此，漏洞利用是有效的。

**投毒风险分析：**
提供的代码片段是经过反编译的代码，难以直接判断是否存在恶意代码。 但是仔细阅读这段代码，并没有发现明显的后门或者恶意行为。`FUN_0002bf64` 函数主要负责用户身份验证，虽然可能存在漏洞，但函数本身的目标是验证用户而非执行恶意操作。由于缺乏更多上下文，也无法确认提供的代码片段是否完整，以及是否来自可信的来源。综合来看，**投毒风险较低，评估为0%**

**利用方式：**
1.  **确定目标：** 确定目标Cisco RV110W/RV130W/RV215W路由器的型号和固件版本，确认其是否在受影响的范围内。
2.  **发送恶意HTTP请求：** 根据已公开的漏洞利用信息，构造包含恶意payload的HTTP请求，该payload可能包含要执行的命令。
3.  **远程代码执行：** 将构造好的HTTP请求发送到目标路由器的web管理界面。如果漏洞存在，且利用成功，恶意payload将被执行，导致远程代码执行。
4.  **获取控制权：** 攻击者通过执行任意代码，获取对路由器的控制权，例如修改配置、监听流量等。

总之，CVE-2019-1663是一个严重的安全漏洞，攻击者可以利用它来完全控制受影响的Cisco路由器。建议用户尽快升级到安全版本。

**项目地址:** [StealYourCode/CVE-2019-1663](https://github.com/StealYourCode/CVE-2019-1663)

**漏洞详情:** [CVE-2019-1663](https://nvd.nist.gov/vuln/detail/CVE-2019-1663)