# CVE-2019-5418

> ğŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-5418-Bad3r_RailroadBandit.md](../2019/CVE-2019-5418-Bad3r_RailroadBandit.md)

## CVE-2019-5418 - Rails File Content Disclosure

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1, v3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„Railsç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†`render file:`è°ƒç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-5418 å­˜åœ¨äº Rails Action View ä¸­ï¼Œç”±äºå¯¹ Accept header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„ Accept headerï¼Œä¾‹å¦‚åŒ…å«æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥ç»•è¿‡ Rails çš„å®‰å…¨æ£€æŸ¥ï¼Œä»è€Œè¯»å–æ–‡ä»¶å†…å®¹ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„åˆ©ç”¨ä»£ç ã€‚æä¾›çš„`Bandit.py`è„šæœ¬åˆ©ç”¨äº†è¯¥æ¼æ´ï¼Œé€šè¿‡ä¿®æ”¹ HTTP Accept header æ¥è¯»å–ç›®æ ‡æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„`Bandit.py`è„šæœ¬å†…å®¹ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š Accept header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ‰“å°æœåŠ¡å™¨çš„å“åº”ã€‚`common.txt`å¦‚æœè¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´å°è¯•è¯»å–ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä½†ä¸ä¼šç›´æ¥é€ æˆæŠ•æ¯’ã€‚
`demo/Gemfile` æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Rails åº”ç”¨ Gemfileï¼Œç”¨äºå£°æ˜é¡¹ç›®ä¾èµ–ï¼Œæœªå‘ç°æŠ•æ¯’ã€‚
ç»¼åˆæ¥çœ‹ï¼Œè¯¥ä»“åº“æŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…éœ€è¦ç¡®å®šç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ Rails ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨è„šæœ¬ï¼ˆå¦‚`Bandit.py`ï¼‰æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨ Accept header ä¸­æŒ‡å®šè¦è¯»å–çš„æ–‡ä»¶è·¯å¾„ã€‚
3.  ç›®æ ‡æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œä¼šå°†æŒ‡å®šæ–‡ä»¶çš„å†…å®¹è¿”å›ç»™æ”»å‡»è€…ã€‚

ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶ï¼Œæˆ–è€… Rails åº”ç”¨çš„ `config/database.yml` æ–‡ä»¶ï¼Œä»¥è·å–æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [Bad3r/RailroadBandit](https://github.com/Bad3r/RailroadBandit)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #2

**æ¥æº**: [CVE-2019-5418-brompwnie_CVE-2019-5418-Scanner.md](../2019/CVE-2019-5418-brompwnie_CVE-2019-5418-Scanner.md)

## CVE-2019-5418 - Rails Action View æ–‡ä»¶å†…å®¹æ³„éœ²

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½æ³„éœ²æ•æ„Ÿä¿¡æ¯

**å½±å“ç‰ˆæœ¬:** <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1, v3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´çš„Railsåº”ç”¨ï¼Œå¹¶èƒ½å‘é€ç‰¹åˆ¶çš„HTTPè¯·æ±‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-5418 æ˜¯ä¸€ä¸ª Rails Action View ä¸­çš„æ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ `Accept` HTTP å¤´ï¼Œç»“åˆè°ƒç”¨ `render file:` æ–¹æ³•ï¼Œè¯»å–ç›®æ ‡ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ 

**æœ‰æ•ˆæ€§:**  æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œå·²å…¬å¼€çš„åˆ©ç”¨ä»£ç éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ ¼å¼ `Accept` å¤´çš„HTTPè¯·æ±‚æ¥è§¦å‘æ¼æ´ï¼Œä»è€Œè¯»å–æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©:**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»…åŒ…å« GNU GPL åè®®çš„ LICENSE æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼:**  åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ æ¶æ„çš„ HTTP `Accept` å¤´ã€‚é€šå¸¸ï¼Œæ”»å‡»è€…ä¼šå‘é€åŒ…å«è¯¸å¦‚ `../../../../etc/passwd` ä¹‹ç±»çš„è·¯å¾„çš„ `Accept` å¤´ï¼Œä»¥å°è¯•è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚ æœåŠ¡å™¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°å°†æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ä½œä¸ºå“åº”è¿”å›ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ã€‚

æ ¹æ®æœç´¢ç»“æœä¸­çš„é“¾æ¥ï¼Œä¾‹å¦‚ [webpage 7 begin] [title] Exploiting CVE-2019â€“5418- File Content Disclosure on Rails [description] A File Content Disclosure vulnerability exists where properly designed accept headers can reveal the contents of arbitrary files on the target system's ... [link] https://spoofing.medium.com/exploiting-cve-2019-5418-file-content-disclosure-on-rails-58cfa488fb51 å¯ä»¥è¿›ä¸€æ­¥ç ”ç©¶åˆ©ç”¨çš„ç»†èŠ‚ã€‚

**é¡¹ç›®åœ°å€:** [brompwnie/CVE-2019-5418-Scanner](https://github.com/brompwnie/CVE-2019-5418-Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #3

**æ¥æº**: [CVE-2019-5418-daehyeok0618_CVE-2019-5418.md](../2019/CVE-2019-5418-daehyeok0618_CVE-2019-5418.md)

## CVE-2019-5418 - Rails File Content Disclosure

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 and v3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Railsç‰ˆæœ¬ï¼Œä¸”å…è®¸é€šè¿‡Acceptå¤´æ§åˆ¶æ¸²æŸ“è¿‡ç¨‹

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-5418æ˜¯Rails Action Viewä¸­å­˜åœ¨çš„ä¸€ä¸ªæ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„Acceptå¤´ï¼Œç»“åˆ`render file:`è°ƒç”¨ï¼Œè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ“çºµHTTPè¯·æ±‚çš„Acceptå¤´ï¼Œè¯±å¯¼Railsæ¸²æŸ“ä»»æ„æ–‡ä»¶å†…å®¹ã€‚æä¾›çš„POCä»£ç `README.md`æ–‡ä»¶ä»…åŒ…å«ç®€å•çš„é¡¹ç›®æè¿°ï¼Œæœ¬èº«ä¸å…·å¤‡æ¼æ´åˆ©ç”¨èƒ½åŠ›ï¼Œå¯èƒ½æ˜¯ç”¨äºé…åˆå…¶ä»–åˆ©ç”¨ä»£ç çš„è¯´æ˜æ–‡æ¡£æˆ–è€…é¡¹ç›®åˆå§‹åŒ–ä¿¡æ¯ã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨10%çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºè¯¥ä»£ç ä»“åº“ä¸­å¯èƒ½åŒ…å«å…¶ä»–æœªå…¬å¼€çš„æ¶æ„ä»£ç æˆ–ä¾èµ–é¡¹ï¼Œæˆ–è€…ä½œè€…æœ‰æ„å¼•å¯¼ä½¿ç”¨è€…ä¸‹è½½æ¶æ„ä¾èµ–ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ„é€ åŒ…å«æ¶æ„payloadçš„Acceptå¤´ã€‚Payloadé€šå¸¸åŒ…å«æŒ‡å‘ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿçš„è·¯å¾„ï¼Œä¾‹å¦‚`../../../../etc/passwd`ã€‚
2.  å‘ç›®æ ‡Railsåº”ç”¨å‘é€HTTPè¯·æ±‚ï¼ŒåŒ…å«æ„é€ çš„Acceptå¤´ã€‚
3.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œå°†ä¼šæŠŠç›®æ ‡æ–‡ä»¶çš„å†…å®¹æ¸²æŸ“åˆ°å“åº”ä¸­ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [daehyeok0618/CVE-2019-5418](https://github.com/daehyeok0618/CVE-2019-5418)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #4

**æ¥æº**: [CVE-2019-5418-kailing0220_CVE-2019-5418.md](../2019/CVE-2019-5418-kailing0220_CVE-2019-5418.md)

## CVE-2019-5418 Rails Action View æ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 å’Œ v3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿè¿è¡Œå—å½±å“çš„Railsç‰ˆæœ¬ï¼Œå¹¶å­˜åœ¨å¯è®¿é—®çš„æ§åˆ¶å™¨ä½¿ç”¨render fileã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-5418 æ¼æ´æ˜¯ Rails Action View ç»„ä»¶ä¸­çš„ä¸€ä¸ªæ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ Accept Headerï¼Œç»“åˆ 'render file:' è°ƒç”¨ï¼Œè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Rails åœ¨å¤„ç† Accept Header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æ–‡ä»¶è®¿é—®é™åˆ¶ã€‚æä¾›çš„POCä»£ç å°è¯•é€šè¿‡ä¿®æ”¹ Accept Header å¹¶å‘é€è¯·æ±‚ï¼Œæ¥è¯»å–/robotsæ–‡ä»¶ï¼Œä»¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚é€šè¿‡åˆ†æ POC ä»£ç ï¼Œæœªå‘ç°ä»»ä½•æ¶æ„ä»£ç ï¼Œè¯¥POCåªæ˜¯ç”¨æ¥éªŒè¯æ–‡ä»¶æ˜¯å¦å¯ä»¥è¯»å–ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚çš„Accept Headerï¼ŒåŒ…å«æ¶æ„è·¯å¾„ï¼Œä¾‹å¦‚ä½¿ç”¨'../../../../'è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œç„¶ååˆ©ç”¨Railsçš„render fileåŠŸèƒ½å°†ç›®æ ‡æ–‡ä»¶ä½œä¸ºæ¨¡æ¿æ¸²æŸ“ï¼Œä»è€Œè¯»å–æ–‡ä»¶å†…å®¹ã€‚

**é¡¹ç›®åœ°å€:** [kailing0220/CVE-2019-5418](https://github.com/kailing0220/CVE-2019-5418)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #5

**æ¥æº**: [CVE-2019-5418-mpgn_CVE-2019-5418.md](../2019/CVE-2019-5418-mpgn_CVE-2019-5418.md)

## CVE-2019-5418 - Rails æ–‡ä»¶å†…å®¹æ³„éœ²

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 and v3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºè°ƒç”¨ `render file:` ä¸”æ²¡æœ‰æŒ‡å®š accept formatã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-5418 æ˜¯ä¸€ä¸ª Rails Action View ç»„ä»¶ä¸­çš„æ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„ `Accept` å¤´ï¼Œç»“åˆåº”ç”¨ç¨‹åºä¸­å­˜åœ¨çš„ `render file:` è°ƒç”¨ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶å†…å®¹ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºæ­¤æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚POC ä»£ç å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹ `Accept` å¤´æ¥åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯»å– `/etc/passwd` æ–‡ä»¶ã€‚

**æŠ•æ¯’é£é™©:**
æ£€æŸ¥æä¾›çš„ POC ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æä¾›çš„ä»£ç åŒ…æ‹¬ï¼š
*   README.mdï¼šæè¿°äº†æ¼æ´ä¿¡æ¯ã€æŠ€æœ¯åˆ†æå’Œå®‰å…¨å»ºè®®ã€‚
*   Action View çš„ä¿®å¤è¡¥ä¸ï¼šæ˜¾ç¤ºäº†å¦‚ä½•ä¿®å¤è¯¥æ¼æ´ã€‚
*   demo æ–‡ä»¶å¤¹ï¼šåŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Rails åº”ç”¨ç¨‹åºï¼Œä»¥åŠåˆ©ç”¨æ­¥éª¤
è¿™äº›ä»£ç ç‰‡æ®µçš„ç›®çš„æ˜¯æ¼”ç¤ºå’Œé‡ç°è¯¥æ¼æ´ï¼Œè€Œä¸æ˜¯å¼•å…¥æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  è¿è¡Œä¸€ä¸ªå—å½±å“ç‰ˆæœ¬çš„ Rails åº”ç”¨ç¨‹åºï¼Œä¸”åº”ç”¨ç¨‹åºä»£ç ä¸­å­˜åœ¨ä½¿ç”¨ `render file:` ä½†æœªæ˜ç¡®æŒ‡å®š accept format çš„è°ƒç”¨ã€‚
2.  æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œä¿®æ”¹ `Accept` å¤´ä¸ºåŒ…å«è·¯å¾„éå†å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `Accept: ../../../../../../../../../../etc/passwd{{`ã€‚
3.  å‘é€è¯¥è¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„è·¯ç”±ã€‚
4.  æœåŠ¡å™¨å°†è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

ç®€å•æ¥è¯´ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯åˆ©ç”¨Railså¤„ç†`Accept` Headerçš„ç¼ºé™·ï¼Œé€šè¿‡è·¯å¾„éå†è¯»å–ä»»æ„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [mpgn/CVE-2019-5418](https://github.com/mpgn/CVE-2019-5418)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #6

**æ¥æº**: [CVE-2019-5418-mpgn_Rails-doubletap-RCE.md](../2019/CVE-2019-5418-mpgn_Rails-doubletap-RCE.md)

## CVE-2019-5418 - Rails æ–‡ä»¶å†…å®¹æ³„éœ²

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œç»“åˆå…¶ä»–æ¼æ´å¯å¯¼è‡´RCE

**å½±å“ç‰ˆæœ¬:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 and v3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Railsç‰ˆæœ¬ï¼Œä¸”å…è®¸å¤–éƒ¨è®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-5418 æ¼æ´æ˜¯ Rails Action View ä¸­çš„ä¸€ä¸ªæ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ Accept headerï¼Œç»“åˆ `render file:` è°ƒç”¨ï¼Œè¯»å–ç›®æ ‡æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶å†…å®¹ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼:**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„ Accept header çš„ HTTP è¯·æ±‚ã€‚
2.  Rails åº”ç”¨çš„ Action View ç»„ä»¶å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæœªæ­£ç¡®è¿‡æ»¤æˆ–è½¬ä¹‰ Accept header ä¸­çš„å†…å®¹ï¼Œå¯¼è‡´å¯ä»¥è¿›è¡Œè·¯å¾„éå†ã€‚
3.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è·¯å¾„éå†è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ï¼Œä¾‹å¦‚ `credentials.yml.enc` å’Œ `master.key` ç­‰æ•æ„Ÿæ–‡ä»¶ã€‚
4.  å¦‚æœåŒæ—¶å­˜åœ¨ CVE-2019-5420 (ååºåˆ—åŒ–æ¼æ´)ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ³„éœ²çš„ `secret_key_base` å€¼æ„é€ æ¶æ„ payloadï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹æ³•ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ `Rails-doubletap-exploit` åŒ…å«åˆ©ç”¨ CVE-2019-5418 å’Œ CVE-2019-5420 çš„ä»£ç ã€‚ä»£ç åˆ†ææ˜¾ç¤ºï¼Œå®ƒé¦–å…ˆæ£€æŸ¥ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2019-5418 æ¼æ´ï¼Œç„¶åå°è¯•è·å– `credentials.yml.enc` å’Œ `master.key` æ–‡ä»¶ã€‚æ‹¿åˆ°è¿™äº›æ–‡ä»¶ä¹‹åï¼Œå°±åˆ©ç”¨ CVE-2019-5420 æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼šè™½ç„¶è¯¥ä»“åº“æ—¨åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œä½†å¯èƒ½å­˜åœ¨ä½œè€…éšè—çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ”¶é›†å—å®³è€…ä¿¡æ¯ã€æ¤å…¥åé—¨ç­‰ã€‚ç”±äºè¯¥æ¼æ´éœ€è¦èƒ½è¿è¡Œrailsä»£ç çš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥æŠ•æ¯’çš„æ¦‚ç‡ç›¸æ¯”äºå®¢æˆ·ç«¯æ¼æ´æ›´ä½ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œåœ¨10%å·¦å³ã€‚

**æ€»ç»“:**

CVE-2019-5418 æ˜¯ä¸€ä¸ªä¸¥é‡çš„æ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ï¼Œå¦‚æœä¸ CVE-2019-5420 ç»“åˆï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [mpgn/Rails-doubletap-RCE](https://github.com/mpgn/Rails-doubletap-RCE)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #7

**æ¥æº**: [CVE-2019-5418-omarkurt_CVE-2019-5418.md](../2019/CVE-2019-5418-omarkurt_CVE-2019-5418.md)

## CVE-2019-5418 - Rails Action View æ–‡ä»¶å†…å®¹æ³„éœ²

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1, v3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Rails ç‰ˆæœ¬ï¼Œå¹¶è°ƒç”¨äº† `render file:` æ–¹æ³•ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘é€å¸¦æœ‰ç‰¹åˆ¶ Accept header çš„ HTTP è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-5418 æ˜¯ä¸€ä¸ª Rails Action View ç»„ä»¶ä¸­çš„æ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ `Accept` HTTP å¤´ï¼Œç»“åˆä½¿ç”¨ `render file:` æ–¹æ³•ï¼Œæ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´çš„å­˜åœ¨æ˜¯è¢«å¹¿æ³›ç¡®è®¤çš„ï¼Œå¹¶ä¸”å­˜åœ¨å…¬å¼€çš„PoCã€‚æä¾›çš„ `Gemfile` å’Œ `Gemfile.lock` æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªä½¿ç”¨æ˜“å—æ”»å‡»çš„ Rails ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œè¡¨æ˜PoCæ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºæ¼æ´å­˜åœ¨äºè¯¥ç‰ˆæœ¬ä¸­ã€‚ç¼ºå°‘å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œ`Gemfile` åªæ˜¯æ­å»ºç¯å¢ƒï¼Œä½†å¯ä»¥æ¨æ–­ä½¿ç”¨ç‰¹åˆ¶çš„ `Accept` å¤´æ¥è§¦å‘æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç åªæ˜¯ `Gemfile` å’Œ `Gemfile.lock`ï¼Œç”¨äºè®¾ç½®ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Rails ç¯å¢ƒã€‚æ²¡æœ‰ç›´æ¥çš„æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œåœ¨å®é™…åˆ©ç”¨è¿‡ç¨‹ä¸­ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹ Rails åº”ç”¨çš„ä»£ç æˆ–ä¾èµ–é¡¹ï¼Œä»è€Œå¼•å…¥åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚ç”±äºè¿™äº›æ–‡ä»¶å®šä¹‰äº†é¡¹ç›®çš„ä¾èµ–ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›æ–‡ä»¶ï¼Œå°±å¯ä»¥å¼•å…¥æ¶æ„çš„ gem åŒ…ï¼Œä»è€Œå®ç°æŠ•æ¯’ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ¶æ„çš„gemæ›¿æ¢æ­£å¸¸çš„gemï¼Œæˆ–è€…é€šè¿‡`git_source`æŒ‡å®šæ¶æ„çš„githubä»“åº“ã€‚ç„¶è€Œï¼Œæ ¹æ®æä¾›çš„æ–‡ä»¶ï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› ä¸ºåªæ˜¯ç®€å•çš„é¡¹ç›®ä¾èµ–é…ç½®æ–‡ä»¶ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦å‘ç›®æ ‡ Rails åº”ç”¨å‘é€å¸¦æœ‰ç‰¹åˆ¶ `Accept` å¤´çš„ HTTP è¯·æ±‚ã€‚è¿™ä¸ª `Accept` å¤´åŒ…å«æŒ‡å‘ç›®æ ‡æ–‡ä»¶ç³»ç»Ÿçš„è·¯å¾„ï¼Œä¾‹å¦‚ `/etc/passwd`ã€‚å…³é”®åœ¨äºæ„é€ ç‰¹æ®Šçš„ `Accept` å¤´æ¥ç»•è¿‡ Rails çš„å®‰å…¨æ£€æŸ¥ã€‚
2.  **è§¦å‘ `render file:`ï¼š** å—å½±å“çš„ Rails åº”ç”¨å¿…é¡»è°ƒç”¨ `render file:` æ–¹æ³•ï¼Œå¹¶ä¸”ä¼ å…¥çš„æ–‡ä»¶è·¯å¾„ä¼šå—åˆ° `Accept` å¤´çš„æ§åˆ¶ã€‚
3.  **æ–‡ä»¶å†…å®¹æ³„éœ²ï¼š** å¦‚æœ `Accept` å¤´æ„é€ æ­£ç¡®å¹¶ä¸” `render file:` è¢«è§¦å‘ï¼ŒRails ä¼šå°†ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ä½œä¸ºå“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚
4.  **è·¯å¾„éå†ï¼š** æ”»å‡»è€…å¯ä»¥ä½¿ç”¨è·¯å¾„éå†æŠ€å·§ï¼ˆä¾‹å¦‚ `../`ï¼‰æ¥è®¿é—®åº”ç”¨æ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ã€‚

**é¡¹ç›®åœ°å€:** [omarkurt/CVE-2019-5418](https://github.com/omarkurt/CVE-2019-5418)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #8

**æ¥æº**: [CVE-2019-5418-random-robbie_CVE-2019-5418.md](../2019/CVE-2019-5418-random-robbie_CVE-2019-5418.md)

## CVE-2019-5418 - Rails æ–‡ä»¶å†…å®¹æ³„éœ²

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œå¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥æ”»å‡»

**å½±å“ç‰ˆæœ¬:** <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 and v3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Railsç‰ˆæœ¬ï¼Œå¹¶ä¸”æ¥å—è¯·æ±‚ä¸­å¯ä»¥æ§åˆ¶Accept Header

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-5418 æ¼æ´å­˜åœ¨äº Rails Action View ç»„ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„ `Accept` Header æ¥è¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶å†…å®¹ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ª Go è¯­è¨€ç¼–å†™çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«æ¶æ„ `Accept` Header çš„ HTTP è¯·æ±‚æ¥æ¢æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2019-5418 æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒè®¾ç½® `Accept` å¤´éƒ¨ä¸º `../../../../../../../../etc/passwd{{`ï¼Œå°è¯•è¯»å– `/etc/passwd` æ–‡ä»¶ã€‚

å¦‚æœå“åº”çŠ¶æ€ç ä¸º 200 OKï¼Œå¹¶ä¸”å“åº”å†…å®¹åŒ…å« `/usr/sbin/nologin` å­—ç¬¦ä¸²ï¼ˆé€šå¸¸å‡ºç°åœ¨ `/etc/passwd` æ–‡ä»¶ä¸­ï¼‰ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†URLå†™å…¥`rails.log`æ–‡ä»¶ä¸­ã€‚

æ ¹æ®æ¼æ´æè¿°å’Œä»£ç é€»è¾‘ï¼Œè¯¥POCä»£ç **æœ‰æ•ˆ**ï¼Œå¯ä»¥ç”¨æ¥æ£€æµ‹ç›®æ ‡ Rails åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2019-5418 æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

ä»”ç»†æ£€æŸ¥äº†æä¾›çš„ Go è¯­è¨€ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚ä»£ç çš„åŠŸèƒ½ä¸»è¦é›†ä¸­åœ¨å‘é€ HTTP è¯·æ±‚ã€æ£€æŸ¥å“åº”å†…å®¹ä»¥åŠå°†ç»“æœå†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚ä»£ç ä¸­åŒ…å«çš„`InsecureSkipVerify: true` é…ç½®ä¼šè·³è¿‡TLSè¯ä¹¦éªŒè¯ï¼Œå¯èƒ½å­˜åœ¨ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œä½†å¹¶éä½œè€…æ•…æ„æ¤å…¥çš„æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ã€‚

å› æ­¤ï¼Œ**æŠ•æ¯’é£é™©ä¸º 0%**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `Accept` Header çš„ HTTP è¯·æ±‚ã€‚
2.  `Accept` Header ä¸­åŒ…å«è·¯å¾„ç©¿è¶Šå­—ç¬¦ï¼ˆå¦‚ `../`ï¼‰å’Œç›®æ ‡æ–‡ä»¶çš„è·¯å¾„ï¼ˆå¦‚ `/etc/passwd`ï¼‰ã€‚
3.  Rails åº”ç”¨çš„ Action View ç»„ä»¶åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œä¼šè¯»å–å¹¶è¿”å›æŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚
4.  æ”»å‡»è€…é€šè¿‡åˆ†æå“åº”å†…å®¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ï¼‰ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§ Rails ç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 5.2.2.1, >= 5.1.6.2, >= 5.0.7.2, >= 4.2.11.1ï¼‰ã€‚
*   é™åˆ¶å¯¹ `render file:` æ–¹æ³•çš„ä½¿ç”¨ï¼Œå¹¶å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ã€‚
*   é…ç½® Web æœåŠ¡å™¨ï¼Œé˜»æ­¢åŒ…å«æ¶æ„å­—ç¬¦çš„ `Accept` Header é€šè¿‡ã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-5418](https://github.com/random-robbie/CVE-2019-5418)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

## POC #9

**æ¥æº**: [CVE-2019-5418-takeokunn_CVE-2019-5418.md](../2019/CVE-2019-5418-takeokunn_CVE-2019-5418.md)

## CVE-2019-5418 - Rails File Content Disclosure

**æ¼æ´ç¼–å·:** CVE-2019-5418

**æ¼æ´ç±»å‹:** æ–‡ä»¶å†…å®¹æ³„éœ²

**å½±å“åº”ç”¨:** Rails Action View

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 å’Œ v3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Railsç‰ˆæœ¬ï¼Œä¸”å…è®¸å¤„ç†åŒ…å«ç‰¹åˆ¶Acceptå¤´çš„HTTPè¯·æ±‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-5418 æ˜¯ä¸€ä¸ª Rails Action View ç»„ä»¶ä¸­çš„æ–‡ä»¶å†…å®¹æ³„éœ²æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ç‰¹åˆ¶çš„ Accept å¤´ï¼Œé…åˆ `render file:` è°ƒç”¨ï¼Œè¯»å–æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶å†…å®¹ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ªRailsç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œç¡®è®¤è¯¥æ¼æ´å­˜åœ¨å¹¶ä¸”æœ‰å…¬å¼€çš„åˆ©ç”¨æ–¹æ³•ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä»…åŒ…å« Gemfile å’Œ Gemfile.lock æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æè¿°äº† Rails åº”ç”¨çš„ä¾èµ–ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„ã€å¯èƒ½æ„æˆæŠ•æ¯’çš„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å«æ¶æ„ Accept å¤´çš„ HTTP è¯·æ±‚ï¼Œè¯±ä½¿ Rails åº”ç”¨è¯»å–å¹¶è¿”å›ç›®æ ‡æ–‡ä»¶å†…å®¹ã€‚æ”»å‡»è€…é€šå¸¸ä¼šåœ¨ Accept å¤´ä¸­åŒ…å«è·¯å¾„éå†å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `../../../../etc/passwd`ï¼Œä»¥è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶ã€‚

æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å«æ¶æ„ Accept å¤´çš„HTTPè¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Rails åº”ç”¨ã€‚ Rails åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºå­˜åœ¨æ¼æ´çš„ Action View ç»„ä»¶ï¼Œä¼šå°è¯•æ ¹æ® Accept å¤´æ¸²æŸ“ç›¸åº”çš„æ–‡ä»¶ã€‚ æ¶æ„ Accept å¤´ä¸­çš„è·¯å¾„éå†å­—ç¬¦ä¸²ä½¿å¾— Rails åº”ç”¨è¯»å–åˆ°äº†é¢„æœŸä¹‹å¤–çš„æ–‡ä»¶ã€‚ Rails åº”ç”¨å°†è¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ä½œä¸ºå“åº”è¿”å›ç»™æ”»å‡»è€…ã€‚

**é¡¹ç›®åœ°å€:** [takeokunn/CVE-2019-5418](https://github.com/takeokunn/CVE-2019-5418)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)

---

