## CVE-2019-9978 - Social Warfare (WordPress Plugin) RCE/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/XSS

**影响应用:** Social Warfare (WordPress Plugin)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 3.5.3

**利用条件:** 无需认证，远程网络访问，插件处于启用状态

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本研究分析的POC代码是一个完整的Docker化漏洞复现环境。通过Dockerfile可以看到，该环境基于cved/base-wordpress基础镜像，手动安装了受影响的Social Warfare 3.5.0版本插件。main.sh脚本自动化了数据库初始化、WordPress配置以及插件激活过程。该POC极其有效，因为它提供了一个隔离且可重复的实验环境，允许研究人员直接针对暴露在80端口的Web服务进行漏洞触发测试。CVE-2019-9978漏洞的核心在于插件对wp-admin/admin-post.php中的swp_process_request处理不当，导致攻击者可以绕过认证，通过传入特定的payload触发远程代码执行或存储型XSS。利用步骤如下：1. 启动Docker容器部署受影响环境；2. 构造一个包含恶意脚本或PHP命令的外部URL；3. 发送一个针对/wp-admin/admin-post.php?swp_debug=load_options&swp_url= [恶意地址] 的GET请求；4. 插件会通过wp_remote_get获取该地址内容并传入eval()函数或存储在数据库中，从而实现代码执行或XSS攻击。投毒风险分析：该POC仓库表现出极低的投毒风险。首先，该代码托管在知名的cved系列开源项目中，其目的是为了提供合法的漏洞研究资源，具有较高的社区信誉。其次，代码结构透明，Dockerfile和Shell脚本均为明文编写，没有任何混淆处理（Obfuscation）。分析其构建逻辑，所有组件均来自标准源或本地构建目录，未发现下载执行外部未知二进制文件的行为。唯一需要关注的是基础镜像cved/base-wordpress的完整性，但在当前上下文中，其脚本逻辑仅限于环境搭建，不包含敏感权限窃取、反弹Shell或其他非预期的恶意Payload。该POC是防御性安全研究的理想样本，其利用路径清晰，没有集成任何针对扫描者或测试者的侧向攻击代码。整体而言，该资源安全可信，适合用于验证WAF规则或自动化检测工具的有效性。

**项目地址:** [https://github.com/cved-sources/cve-2019-9978](https://github.com/cved-sources/cve-2019-9978)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
