# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

# CVE-2019-18935

> ğŸ“¦ è¯¥CVEæœ‰ **14** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md](../2019/CVE-2019-18935-0xAgun_CVE-2019-18935-checker.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** 1. ç›®æ ‡ç³»ç»Ÿä½¿ç”¨å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ã€‚
2. éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äºProgress Telerik UI for ASP.NET AJAXä¸­çš„.NETååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯ä»¥å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚åˆ©ç”¨æ¡ä»¶æ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ç›¸å…³çš„CVE-2017-11317æˆ–CVE-2017-11357æ¼æ´æ¥è¾¾æˆï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢å¼•æ“ç»“æœï¼ˆå°¤å…¶æ˜¯CISA KEVæ¡ç›®ï¼‰å’Œæä¾›çš„PoCä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å·²ç»åœ¨é‡å¤–è¢«åˆ©ç”¨ã€‚

æä¾›çš„ `exploit.py` è„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨CVE-2019-18935æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡å‘é€ä¸€ä¸ªHTTP GETè¯·æ±‚åˆ°ç›®æ ‡URLçš„ `/Telerik.Web.UI.WebResource.axd?type=rau` è·¯å¾„ï¼Œæ£€æŸ¥å“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸² "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ¤æ–­ç›®æ ‡URLå­˜åœ¨æ¼æ´ï¼Œå¹¶å°†è¯¥URLä¿å­˜åˆ° `exploitable.txt` æ–‡ä»¶ä¸­ã€‚æ­¤è„šæœ¬åªåšæ£€æµ‹ï¼Œä¸èƒ½ç›´æ¥åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥æä¾›çš„PoCä»£ç  `exploit.py` å’Œ `README.md`ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ½œåœ¨çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç çš„åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œè€Œéæ‰§è¡Œæ¶æ„æ“ä½œã€‚æ–‡ä»¶æ“ä½œä»…é™äºåˆ›å»ºå’Œå†™å…¥ `exploitable.txt`ï¼Œé£é™©è¾ƒä½ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–:** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾—ç”¨äºåŠ å¯†Telerik UIç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´æ¥è·å–ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–é€”å¾„ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:** æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥æ¥æ„é€ ä¸€ä¸ªæ¶æ„çš„.NETåºåˆ—åŒ–å¯¹è±¡Payloadã€‚è¿™ä¸ªPayloadå¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚
3.  **å‘é€Payload:** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„Payloadé€šè¿‡RadAsyncUploadç»„ä»¶å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **æ‰§è¡Œä»£ç :** ç›®æ ‡æœåŠ¡å™¨ååºåˆ—åŒ–Payloadï¼Œä»è€Œæ‰§è¡ŒPayloadä¸­åŒ…å«çš„æ¶æ„ä»£ç ï¼Œæœ€ç»ˆå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [0xAgun/CVE-2019-18935-checker](https://github.com/0xAgun/CVE-2019-18935-checker)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #2

**æ¥æº**: [CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md](../2019/CVE-2019-18935-0xsharz_telerik-scanner-CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®/Telerik.Web.UI.WebResource.axd?type=rauæˆ–è€…/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, åŒæ—¶éœ€è¦ç»“åˆCVE-2017-11317æˆ–CVE-2017-11357æ¥è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–åŠ å¯†å¯†é’¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¦æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…é€šå¸¸éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ï¼Œè¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰å…¶ä»–æ¼æ´æ¥è·å¾—ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è„šæœ¬ä¼šæ£€æŸ¥ç›®æ ‡æ˜¯å¦æš´éœ²äº†RadAsyncUploadçš„handlerï¼Œå¹¶ä¸”æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦åˆ†ä¸ºå‡ ä¸ªæ­¥éª¤ï¼š1. **æ£€æµ‹RAUæ¨¡å—**: æ‰«æ`/Telerik.Web.UI.WebResource.axd?type=rau` å’Œ `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`æ˜¯å¦å­˜åœ¨ã€‚2. **ç‰ˆæœ¬åˆ†æ**: é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ `20[0-9]{2}(?:\.[0-9]*)+`ä»HTMLæºä»£ç ä¸­æå–ç‰ˆæœ¬ä¿¡æ¯ã€‚3. **æ¼æ´è¯„ä¼°**: æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯åˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œç‰ˆæœ¬å°äº2020è®¤ä¸ºæ˜¯å­˜åœ¨æ¼æ´çš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¿™ä¸ªscanneræœ¬èº«çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å¦‚æœæ”»å‡»è€…ä¿®æ”¹scannerè„šæœ¬ï¼ŒåŠ å…¥æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åœ¨æ£€æµ‹åˆ°æ¼æ´åï¼Œè‡ªåŠ¨ä¸Šä¼ webshellï¼Œé‚£ä¹ˆå°±å­˜åœ¨æŠ•æ¯’çš„é£é™©ã€‚ä½†æ˜¯æ ¹æ®ä»£ç æœ¬èº«çš„å†…å®¹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œåªæœ‰ç‰ˆæœ¬æ£€æµ‹å’Œæ¼æ´æ‰«æç›¸å…³çš„åŠŸèƒ½ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’é£é™©è¾ƒä½ï¼Œç»™å‡ºçš„ç™¾åˆ†æ¯”æ˜¯10%ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåˆ©ç”¨è¯¥æ¼æ´éœ€è¦é…åˆå…¶ä»–æ¼æ´åˆ©ç”¨æˆ–å¯†é’¥æ³„éœ²ï¼Œæ¼æ´åˆ©ç”¨é“¾ç›¸å¯¹å¤æ‚ã€‚

**é¡¹ç›®åœ°å€:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #3

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md](../2019/CVE-2019-18935-ThanHuuTuan_CVE_2019_18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½æˆ–æ›´æ–°åˆ°2020.1.114åŠä»¥ä¸Šç‰ˆæœ¬ï¼›éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935æ˜¯Telerik UI for ASP.NET AJAXä¸­çš„ä¸€ä¸ª.NETååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äºRadAsyncUploadåŠŸèƒ½ä¸­ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥æ—¶ï¼ˆç”±äºCVE-2017-11317æˆ–CVE-2017-11357çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼‰ï¼Œè¯¥æ¼æ´å¯è¢«åˆ©ç”¨ã€‚åˆ©ç”¨æˆåŠŸå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

ä»æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ¡ä»¶ï¼Œæœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†çš„åˆ†ææŠ¥å‘Šå’Œåˆ©ç”¨ç¤ºä¾‹ï¼ŒCISAä¹Ÿå°†å…¶åˆ—å…¥å·²çŸ¥è¢«åˆ©ç”¨æ¼æ´ç›®å½•(KEV)ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†å®Œæ•´çš„åˆ©ç”¨æµç¨‹ï¼ŒåŒ…æ‹¬åŠ å¯†ã€æ„é€ è¯·æ±‚å’Œè§¦å‘ååºåˆ—åŒ–ç­‰æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

å¯¹æä¾›çš„Python POCä»£ç è¿›è¡Œäº†åˆ†æï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹ï¼Œä½†ä¸è¶³ä»¥åˆ¤å®šä¸ºæ¶æ„æŠ•æ¯’è¡Œä¸ºï¼š

1.  **RAU_crypto ä¾èµ–**: POCä»£ç ä¾èµ–äºä¸€ä¸ªåä¸º`RAU_crypto`çš„æœ¬åœ°åº“ã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«äº†å¯¹è¯¥åº“çš„å¼•ç”¨å’Œä½¿ç”¨ï¼Œä½†æ²¡æœ‰æä¾›è¯¥åº“çš„æºä»£ç ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡ä¿®æ”¹`RAU_crypto`åº“çš„å†…å®¹ï¼Œä¾‹å¦‚æ›¿æ¢å…¶ä¸­çš„åŠ å¯†ç®—æ³•æˆ–æ·»åŠ æ¶æ„ä»£ç ï¼Œä»è€Œå½±å“æ¼æ´åˆ©ç”¨çš„å¯é æ€§æˆ–å¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œå¿…é¡»å°å¿ƒå®¡æŸ¥ä¾èµ–çš„ `RAU_crypto` åº“ï¼Œç¡®ä¿å®ƒçš„å®‰å…¨æ€§å’Œå¯ä¿¡åº¦ã€‚
2.  **SMB Server**: POCä»£ç çš„`-s`å‚æ•°å…è®¸æŒ‡å®šä¸€ä¸ªè¿œç¨‹SMBæœåŠ¡å™¨ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™ä¸ªå‚æ•°ï¼Œå°†æ¶æ„ä»£ç æ”¾ç½®åœ¨SMBæœåŠ¡å™¨ä¸Šï¼Œå¹¶é€šè¿‡ååºåˆ—åŒ–æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚
3.  **æ–‡ä»¶ä¸Šä¼ è·¯å¾„**: å¦‚æœæ”»å‡»è€…èƒ½æ§åˆ¶ `temp_target_folder` å˜é‡ï¼Œä¾¿å¯ä»¥å°†ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ï¼Œä¸ºåç»­æ”»å‡»ï¼Œå¦‚webshellæ¤å…¥åˆ›é€ æ¡ä»¶ã€‚

ç»¼ä¸Šï¼Œè¯¥POCä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†è¿™äº›é£é™©æ›´åå‘äºåˆ©ç”¨è¯¥POCè¿›è¡ŒäºŒæ¬¡æ”»å‡»çš„å¯èƒ½æ€§ã€‚è¯¥POCä»£ç çš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–Telerik UIçš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨CVE-2017-11317æˆ–CVE-2017-11357ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **ä¸Šä¼ Payloadï¼š** æ”»å‡»è€…ä½¿ç”¨RadAsyncUploadåŠŸèƒ½ä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„Payloadã€‚Payloadå¯ä»¥æ˜¯åŒ…å«æ¶æ„ä»£ç çš„æ··åˆæ¨¡å¼ç¨‹åºé›†DLLã€‚
3.  **ååºåˆ—åŒ–è§¦å‘ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªæ¶æ„çš„rauPostDataï¼Œå…¶ä¸­åŒ…å«System.Configuration.Install.AssemblyInstallerå¯¹è±¡ï¼Œå¹¶å°†å…¶Pathå±æ€§è®¾ç½®ä¸ºPayloadçš„è·¯å¾„ã€‚ç„¶åï¼Œæ”»å‡»è€…å°†è¯¥rauPostDataå‘é€åˆ°æœåŠ¡å™¨ï¼Œè§¦å‘ååºåˆ—åŒ–æ¼æ´ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–AssemblyInstallerå¯¹è±¡æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡ŒPayloadä¸­çš„æ¶æ„ä»£ç ï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #4

**æ¥æº**: [CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-ThanHuuTuan_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ– RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ŒæœåŠ¡å™¨å®Œå…¨æ§åˆ¶

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ï¼Œæ”»å‡»è€…èƒ½å¤Ÿè®¿é—®Telerik UIçš„RadAsyncUploadåŠŸèƒ½ï¼Œä¸”å·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ (æˆ–è€…é…ç½®ä¸ºä¸ä½¿ç”¨åŠ å¯†)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ååºåˆ—åŒ–æ¼æ´ã€‚ç”±äº RadAsyncUpload åŠŸèƒ½å­˜åœ¨ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºå·²çŸ¥æˆ–èƒ½å¤Ÿç ´è§£åŠ å¯†å¯†é’¥ï¼Œè¿™é€šå¸¸ä¾èµ–äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å¼±å¯†é’¥æˆ–æ ¹æœ¬æ²¡æœ‰å¯ç”¨åŠ å¯†ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼ŒCVE-2019-18935 å·²è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€å¯ç”¨çš„ PoC ä»£ç ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿç¡®è®¤äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

è¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 10%ã€‚é£é™©ä¸»è¦æ¥æºäºä»¥ä¸‹å‡ ç‚¹ï¼š
1.  è¯¥ä»“åº“æä¾›çš„æ‰«æå™¨ï¼Œç†è®ºä¸Šä¸å…·å¤‡ç›´æ¥æŠ•æ¯’çš„èƒ½åŠ›ã€‚
2.  è¯¥ä»“åº“ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨è¯¥æ¼æ´ï¼Œå¹¶éç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œé™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
3.  `http-telerik-vuln.nse` è„šæœ¬åªæ˜¯ä¸€ä¸ª nmap è„šæœ¬ï¼Œç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«ä¸æ‰§è¡Œæ¶æ„æ“ä½œã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å‘ç°ï¼š** ä½¿ç”¨æä¾›çš„ Python æ‰«æå™¨æˆ– Nmap è„šæœ¬ï¼ˆ`http-telerik-vuln.nse`ï¼‰æ¥è¯†åˆ«å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX å®ä¾‹ã€‚
2.  **å¯†é’¥è·å–/ç»•è¿‡ï¼š** å°è¯•åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 è·å–åŠ å¯†å¯†é’¥ï¼Œæˆ–è€…å¦‚æœé…ç½®å…è®¸ï¼Œç›´æ¥ç»•è¿‡åŠ å¯†ã€‚
3.  **Payload æ„é€ ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥æˆ–ä¸ä½¿ç”¨å¯†é’¥ï¼ˆå¦‚æœå¯èƒ½ï¼‰æ„é€ æ¶æ„çš„ .NET ååºåˆ—åŒ– payloadã€‚ è¿™ä¸ªpayloadåŒ…å«äº†æ”»å‡»è€…æƒ³è¦æ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚
4.  **æ¼æ´è§¦å‘ï¼š** å°†æ„é€ çš„ payload å‘é€åˆ° RadAsyncUpload åŠŸèƒ½çš„ç«¯ç‚¹ï¼Œé€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹ rauPostData å‚æ•°ã€‚è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨ååºåˆ—åŒ–æ¶æ„æ•°æ®ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…çš„ä»£ç ã€‚
5.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚å®‰è£…åé—¨ã€çªƒå–æ•°æ®æˆ–æ§åˆ¶æ•´ä¸ªç³»ç»Ÿã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ”»å‡»è€…éœ€è¦é¦–å…ˆæ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šçš„ Telerik UIï¼Œç„¶åç¡®å®šåŠ å¯†å¯†é’¥ã€‚ä¹‹åï¼Œæ”»å‡»è€…ä¼šæ„å»ºä¸€ä¸ªæ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¼šåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æœ€åï¼Œæ”»å‡»è€…ä¼šå°†è¿™ä¸ªå¯¹è±¡å‘é€åˆ° RadAsyncUpload ç«¯ç‚¹ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [ThanHuuTuan/Telerik_CVE-2019-18935](https://github.com/ThanHuuTuan/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #5

**æ¥æº**: [CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-appliedi_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…éœ€è¦è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ï¼ˆå¯èƒ½é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357ï¼‰ã€‚å¦‚æœä½¿ç”¨äº†2020.1.114åŠä»¥åç‰ˆæœ¬ï¼Œå¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤å®‰å…¨è®¾ç½®ï¼Œåˆ™æ¼æ´è¢«ç¼“è§£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å®ƒä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥è·å–æˆ–ç ´è§£åŠ å¯†å¯†é’¥ (ä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯å¯ä»¥å¾—çŸ¥ï¼Œè¯¥æ¼æ´è¢«å¹¿æ³›åˆ©ç”¨ï¼Œå¹¶ä¸”CISA KEVæ”¶å½•äº†è¯¥æ¼æ´ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–/ç ´è§£ï¼š**  æ”»å‡»è€…éœ€è¦é¦–å…ˆè·å¾—ç”¨äºåŠ å¯† RadAsyncUpload é…ç½®çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œå®ƒä»¬å…è®¸æ”»å‡»è€…è¯»å–é…ç½®æ–‡ä»¶ä»è€Œè·å–å¯†é’¥ï¼‰æˆ–è€…é€šè¿‡æš´åŠ›ç ´è§£æ¥å®Œæˆï¼ˆå¦‚æœå¯†é’¥å¼ºåº¦ä¸è¶³ï¼‰ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š**  ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„çš„ RadAsyncUpload è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒè®¾è®¡çš„ .NET å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡é€šå¸¸æ˜¯ä¸€ä¸ªåˆ©ç”¨ .NET Framework ä¸­å­˜åœ¨çš„Gadget Chainæ¥æ‰§è¡Œå‘½ä»¤çš„ Payload. 
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  æ”»å‡»è€…å°†æ„é€ å¥½çš„æ¶æ„è¯·æ±‚å‘é€åˆ°æ˜“å—æ”»å‡»çš„ Telerik UI for ASP.NET AJAX åº”ç”¨ç¨‹åºã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š**  æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ”»å‡»è€…æä¾›çš„æ¶æ„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»»æ„ä»£ç ã€‚

**å…³äºPOCä»£ç çš„æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (telerik_rce_scan.py) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (http-telerik-vuln.nse)ã€‚è¿™äº›å·¥å…·çš„ç›®çš„æ˜¯æ£€æµ‹ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨ CVE-2019-18935 æ¼æ´ã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œä½†å®ƒéªŒè¯äº†æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ä¸”ä¾èµ–å…¶ä»–å·¥å…·ï¼ˆå¦‚ bao7uo çš„ RAU_cryptoï¼‰è¿›è¡Œå®é™…çš„æ¼æ´åˆ©ç”¨ã€‚æ ¹æ®ä»£ç çš„è¯´æ˜å’Œå‚è€ƒèµ„æ–™ï¼Œè¿™äº›å·¥å…·ä¾èµ–äºå¯ä»¥åˆ©ç”¨æ­¤æ¼æ´çš„å…ˆå‰ç ”ç©¶å’Œä»£ç ï¼Œæ‰€ä»¥åˆæ­¥åˆ¤æ–­POCæ˜¯æœ‰æ•ˆçš„ã€‚

**å…³äºæŠ•æ¯’é£é™©çš„åˆ†æï¼š**

*   **Python æ‰«æå™¨ (telerik_rce_scan.py):** è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€šè¿‡æ£€æµ‹ç‰¹å®šçš„URLè·¯å¾„æ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦å­˜åœ¨ç›¸åº”çš„ç»„ä»¶æ¥åˆ¤æ–­ã€‚æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œå› ä¸ºå…¶ç›®çš„æ˜¯æ£€æµ‹ï¼Œè€Œä¸æ˜¯ç›´æ¥åˆ©ç”¨ã€‚ *   **Nmap NSE è„šæœ¬ (http-telerik-vuln.nse):** åŒæ ·ï¼Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¸»è¦æ˜¯ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”æ¥åˆ¤æ–­ã€‚ä»£ç ä¸­å­˜åœ¨è°ƒç”¨`http.get`çš„httpè¯·æ±‚, å­˜åœ¨æ½œåœ¨çš„é£é™©,å¦‚æœä½œè€…æ¤å…¥æ¶æ„é“¾æ¥æˆ–è€…é‡å®šå‘, å¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…å…¶ä»–å®‰å…¨é—®é¢˜, åˆæ­¥ä¼°è®¡æŠ•æ¯’é£é™©ä¸º10%ã€‚

æ€»ä½“æ¥è¯´ï¼Œç”±äºPOCä»£ç çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ã€‚ä½†æ˜¯ï¼Œä»ç„¶éœ€è¦ä»”ç»†å®¡æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œè¯·æ±‚éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚é‡å®šå‘åˆ°æ¶æ„ç½‘ç«™æˆ–è€…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚

**é¡¹ç›®åœ°å€:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #6

**æ¥æº**: [CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md](../2019/CVE-2019-18935-becrevex_Telerik_CVE-2019-18935.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç 

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Telerik UI for ASP.NET AJAXï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿè®¿é—® /Telerik.Web.UI.WebResource.axd æˆ– /aspnet-ajax/Telerik.Web.UI.WebResource.axd ç«¯ç‚¹ï¼ŒåŒæ—¶éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆä¾èµ–äºCVE-2017-11317æˆ–CVE-2017-11357ï¼Œæˆ–å…¶ä»–æ–¹å¼ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å…·ä½“æ¥è¯´ï¼Œ`RadAsyncUpload` åŠŸèƒ½å­˜åœ¨å®‰å…¨ç¼ºé™·ï¼Œå…è®¸é€šè¿‡æ„é€ ç‰¹åˆ¶çš„ JSON å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨é€šå¸¸éœ€è¦å·²çŸ¥æˆ–å¯ç ´è§£çš„åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317ã€CVE-2017-11357ï¼‰ï¼Œç”¨äºè§£å¯†ä¸Šä¼ çš„æ–‡ä»¶é…ç½®æ•°æ®ã€‚

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«ä¸€ä¸ª Python æ‰«æå™¨ (`telerik_rce_scan.py`) å’Œä¸€ä¸ª Nmap NSE è„šæœ¬ (`http-telerik-vuln.nse`)ã€‚

*   **æœ‰æ•ˆæ€§ï¼š** ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªå·²ç»å…¬å¼€ä¸”è¢«å¹¿æ³›åˆ©ç”¨çš„æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸­ï¼ŒNmap NSEè„šæœ¬ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒPythonæ‰«æå™¨åˆ™ç”¨äºæ¼æ´éªŒè¯ã€‚
*   **æŠ•æ¯’é£é™©ï¼š** æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`http-telerik-vuln.nse` ä¸»è¦åŠŸèƒ½æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´é¡µé¢,ä»£ç é€»è¾‘æ¸…æ™°ï¼Œé£é™©è¾ƒä½ã€‚`telerik_rce_scan.py` æ ¹æ®æä¾›çš„å‚æ•°è¿›è¡Œæ‰«æï¼Œä¹Ÿæœªå‘ç°å­˜åœ¨åé—¨ä»£ç ã€‚ ä½†æ˜¯ç”±äºæ²¡æœ‰æä¾› `telerik_rce_scan.py` å®Œæ•´ä»£ç ï¼Œå‡è®¾å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œç»™å‡ºçš„æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚
*   **åˆ©ç”¨æ–¹å¼ï¼š** 
    1.  **å¯†é’¥è·å–ï¼š** å¦‚æœç›®æ ‡ä½¿ç”¨äº†åŠ å¯†åŠŸèƒ½ï¼Œæ”»å‡»è€…éœ€è¦å…ˆè·å–åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
    2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„ JSON æ•°æ®ï¼Œå¹¶ä½¿ç”¨å·²çŸ¥çš„åŠ å¯†å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚
    3.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æˆ– `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚
    4.  **ä»£ç æ‰§è¡Œï¼š** Telerik UI ç»„ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œä¼šååºåˆ—åŒ– JSON æ•°æ®ï¼Œä»è€Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚

æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¯¥æ¼æ´å·²è¢«å¤šä¸ªå¨èƒç»„ç»‡åˆ©ç”¨ï¼Œæ”»å‡»ç›®æ ‡åŒ…æ‹¬æ”¿åºœæœºæ„ç­‰ã€‚CISA ä¹Ÿå‘å¸ƒäº†ç›¸å…³è­¦å‘Šã€‚

**é¡¹ç›®åœ°å€:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #7

**æ¥æº**: [CVE-2019-18935-clarkvoss_telerik.md](../2019/CVE-2019-18935-clarkvoss_telerik.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Telerik UIç‰ˆæœ¬ï¼Œå¹¶ä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆæˆ–è€…ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼‰ï¼Œæˆ–è€…ä¸Šä¼ ç›®å½•å¯å†™ï¼Œä»¥åŠå…è®¸æ‰§è¡Œä¸Šä¼ çš„aspxæ–‡ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 å­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­ï¼Œæ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload å‡½æ•°ä¸­ã€‚å½“ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼å¾—çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œæ­¤æ¼æ´å¯è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºæ¼æ´å­˜åœ¨äº2019.3.1023åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœç´¢ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ï¼Œå¹¶å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `RCE.py` å®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»£ç ä¸­å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º5%ã€‚å› ä¸º`ysoserial.exe`çš„æ¥æºæ— æ³•å®Œå…¨ä¿è¯ï¼Œå¦‚æœå®ƒè¢«æ›¿æ¢ä¸ºæ¶æ„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…åœ¨å—å®³è€…æœºå™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ­¤å¤–ï¼Œåˆ©ç”¨ä»£ç çš„æ‰§è¡Œä¾èµ–äº`mono`ç¯å¢ƒï¼Œå¦‚æœå—å®³è€…ç¯å¢ƒä¸­å­˜åœ¨æ¶æ„çš„monoè¿è¡Œæ—¶ï¼Œä¹Ÿä¼šå¼•å…¥å®‰å…¨é£é™©ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä»£ç æœ¬èº«çš„ç›®çš„å°±æ˜¯åˆ©ç”¨å·²çŸ¥æ¼æ´è¿›è¡ŒRCEï¼Œå¹¶éä¼ªè£…æˆæ­£å¸¸åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Telerik UI for ASP.NET AJAX ç‰ˆæœ¬ã€‚**
2.  **è·å–åŠ å¯†å¯†é’¥ã€‚** å¦‚æœç›®æ ‡ä½¿ç”¨äº†é»˜è®¤å¯†é’¥ï¼Œæˆ–è€…å­˜åœ¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´å¯ç”¨äºè·å–å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨å·²çŸ¥å¯†é’¥è¿›è¡Œæ”»å‡»ã€‚å¦åˆ™ï¼Œå¯èƒ½éœ€è¦çˆ†ç ´æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–å¯†é’¥ã€‚
3.  **ä½¿ç”¨ ysoserial.exe ç”Ÿæˆæ¶æ„ payloadã€‚**  `RCE.py` è„šæœ¬ä½¿ç”¨ `ysoserial.exe` ç”Ÿæˆ .NET ååºåˆ—åŒ– payloadï¼Œè¯¥ payload åŒ…å«è¦æ‰§è¡Œçš„æ¶æ„å‘½ä»¤ã€‚
4.  **ç¼–ç  payloadã€‚**  ç”Ÿæˆçš„ payload è¢« Base64 ç¼–ç ï¼Œç„¶åè¿›è¡Œ URL ç¼–ç ã€‚
5.  **é€šè¿‡ RadAsyncUpload å‡½æ•°å‘é€ payloadã€‚**  ç¼–ç åçš„ payload è¢«ä½œä¸º `application/octet-stream` å‘é€åˆ° `Telerik.Web.UI.WebResource.axd?type=rau` ç«¯ç‚¹ã€‚æ”»å‡»è€…éœ€è¦æ‰¾åˆ°ç›®æ ‡ç³»ç»Ÿä¸Šè¯¥è·¯å¾„ã€‚`RCE.py` ä¼šæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡URLã€‚
6.  **æ‰§è¡Œä»»æ„ä»£ç ã€‚**  å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼ŒæœåŠ¡å™¨å°†ååºåˆ—åŒ– payloadï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ¶æ„å‘½ä»¤ã€‚
7.  **æ‰«æ webshellã€‚** `RCE.py`å°è¯•åœ¨å¸¸è§ä¸Šä¼ ç›®å½•æŸ¥æ‰¾æ˜¯å¦webshellä¸Šä¼ æˆåŠŸ,å¹¶å°è¯•é€šè¿‡webshellæ‰§è¡Œå‘½ä»¤ã€‚ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–çš„ä¸Šä¼ ç›®å½•ï¼Œä»¥å¢åŠ webshellè¢«å‘ç°çš„æ¦‚ç‡ã€‚è„šæœ¬é€šè¿‡å‘webshellå‘é€`cmd=whoami`æ¥éªŒè¯webshellæ˜¯å¦æœ‰æ•ˆã€‚

**é¡¹ç›®åœ°å€:** [clarkvoss/telerik](https://github.com/clarkvoss/telerik)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #8

**æ¥æº**: [CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md](../2019/CVE-2019-18935-dust-life_CVE-2019-18935-memShell.md)

## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦èƒ½å¤Ÿè®¿é—®å­˜åœ¨æ¼æ´çš„Telerik UI ç»„ä»¶çš„ASP.NETåº”ç”¨ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ (ç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 æˆ–å…¶ä»–æ–¹å¼)ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬ç›´è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚åˆ©ç”¨è¯¥æ¼æ´çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œè€Œè·å–å¯†é’¥å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–:** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload ä¸Šä¼ ç»„ä»¶çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰å·²çŸ¥æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å–ï¼Œä¾‹å¦‚å¯†é’¥æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payload:**  æ”»å‡»è€…ä½¿ç”¨è·å–çš„å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ .NET å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚è¿™ä¸ªæ¶æ„å¯¹è±¡æ—¨åœ¨æ‰§è¡Œä»»æ„ä»£ç ã€‚
3.  **ä¸Šä¼ Payload:**  æ”»å‡»è€…å°†æ„é€ çš„æ¶æ„ Payload ä½œä¸ºæ–‡ä»¶é€šè¿‡ RadAsyncUpload ç»„ä»¶ä¸Šä¼ ã€‚
4.  **ååºåˆ—åŒ–è§¦å‘:**  å½“ Telerik UI ç»„ä»¶å°è¯•ååºåˆ—åŒ–ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œæ¶æ„å¯¹è±¡è¢«å®ä¾‹åŒ–ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„è®¾çš„ä»»æ„ä»£ç ã€‚

**POCä»£ç åˆ†æï¼š**

æä¾›çš„ POC ä»£ç é€šè¿‡ C++ ç¼–å†™ä¸€ä¸ª DLLï¼Œè¯¥ DLL åœ¨åŠ è½½æ—¶ä¼šå°è¯•åœ¨å½“å‰è¿›ç¨‹çš„æ‰€æœ‰ .NET AppDomain ä¸­å¯»æ‰¾ `Telerik.Web.UI` ç¨‹åºé›†ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œå°±å°†ä¸€æ®µç¡¬ç¼–ç çš„ `rawData` ï¼ˆä»£è¡¨ç¼–è¯‘åçš„ .NET ç¨‹åºé›†ï¼‰åŠ è½½åˆ°è¯¥ AppDomain ä¸­ï¼Œå¹¶å®ä¾‹åŒ– `G` ç±»ã€‚

è¯¥POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªå†…å­˜é©¬ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºä¸­ã€‚å…·ä½“æ­¥éª¤ä¸ºï¼š

*   å°†åŒ…å«æ¶æ„ä»£ç çš„C#ä»£ç ç¼–è¯‘æˆDLLã€‚
*   å°†DLLè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„(`rawData`)å¹¶åµŒå…¥åˆ°C++ä»£ç ä¸­ã€‚
*   ç¼–è¯‘C++ä»£ç ä¸ºDLLã€‚
*   å°†ç¼–è¯‘åçš„DLLä½œä¸ºpayloadï¼Œé€šè¿‡æ¼æ´ä¸Šä¼ å¹¶è§¦å‘æ‰§è¡Œï¼Œä»è€Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

POCä»£ç ä¸­ï¼Œ`rawData` éƒ¨åˆ†æ˜¯éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ã€‚å¦‚æœ `rawData` åŒ…å«æ¶æ„ä»£ç ï¼Œåˆ™è¯¥ POC å¯èƒ½è¢«ç”¨äºä¼ æ’­æ¶æ„è½¯ä»¶ã€‚å½“å‰ä»£ç ä¸­ `rawData` éƒ¨åˆ†è¢«çœç•¥ï¼Œæ²¡æœ‰å…·ä½“å†…å®¹ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©ä¸»è¦ä¾èµ–äº `rawData` çš„æ¥æºã€‚è¯¥ä»£ç çš„ä½œè€…ç»™å‡ºäº† `SharpMemshell` ä½œä¸ºç”Ÿæˆ `rawData` çš„æ¥æºï¼Œä½†å¦‚æœæ”»å‡»è€…æ›¿æ¢ `SharpMemshell` ä¸ºå…¶ä»–æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚æ­¤å¤–ï¼ŒC++ä»£ç é€»è¾‘ä¹Ÿå¯èƒ½å­˜åœ¨éšè—çš„æ¶æ„è¡Œä¸ºï¼Œä½†ç›®å‰çœ‹æ¯”è¾ƒç®€å•ï¼Œé£é™©è¾ƒä½ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [dust-life/CVE-2019-18935-memShell](https://github.com/dust-life/CVE-2019-18935-memShell)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #9

**æ¥æº**: [CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md](../2019/CVE-2019-18935-ekkoo-z_CVE-2019-18935-bypasswaf.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€å·²çŸ¥åŠ å¯†å¯†é’¥ (CVE-2017-11317 æˆ– CVE-2017-11357), æˆ–å…¶ä»–æ–¹å¼æ³„éœ²çš„å¯†é’¥ã€‚ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“çš„ Telerik UI ç‰ˆæœ¬ï¼Œä¸”æœªå¯ç”¨ç¼“è§£æªæ–½ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Telerik UI for ASP.NET AJAX ä¸­ RadAsyncUpload å‡½æ•°å­˜åœ¨çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“æ”»å‡»è€…èƒ½å¤Ÿè·å–åŠ å¯†å¯†é’¥åï¼ˆä¾‹å¦‚ï¼Œåˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰ï¼Œä»–ä»¬å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œé€šè¿‡ RadAsyncUpload å‡½æ•°è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„CVSSè¯„åˆ†ä¸º9.8ï¼Œå±äºä¸¥é‡çº§åˆ«ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¿®æ”¹è‡ª`noperator/CVE-2019-18935`ï¼Œå¹¶ä¸”åŠ å…¥cookieä¼ å…¥æ¶æ„payload, metadataæ•°æ®åŠ å¯†ä¼ å…¥å¹¶ååºåˆ—åŒ–çš„ç»•è¿‡WAFæ–¹æ³•, å¢å¼ºäº†åˆ©ç”¨çš„æˆåŠŸç‡. è¯¥POCèƒ½å¤ŸæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹ä»£ç ï¼Œé»˜è®¤ä»£ç†è®¾ç½®ä¸º`127.0.0.1:8080`ï¼Œæ”»å‡»è´Ÿè½½ä¸ºå“¥æ–¯æ‹‰å†…å­˜é©¬ã€‚è¿™è¡¨æ˜å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚å¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ä»£ç†å’Œé»˜è®¤å†…å­˜é©¬ï¼Œå¯èƒ½ä¼šè¢«æ”»å‡»è€…é€šè¿‡ä»£ç†æˆªè·æµé‡ï¼Œæˆ–è¢«æ¤å…¥éé¢„æœŸçš„åé—¨ã€‚æ­¤å¤–ï¼Œä»£ç è¿˜ä¾èµ– RAU_crypto æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¹Ÿéœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚ è™½ç„¶ä½œè€…é»˜è®¤æ·»åŠ äº†å“¥æ–¯æ‹‰å†…å­˜é©¬ï¼Œæ–¹ä¾¿ä½¿ç”¨è€…å¿«é€ŸéªŒè¯æ¼æ´ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æœªå¯¹å†…å­˜é©¬åšå®‰å…¨å®¡æŸ¥ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œç»¼ä¸Šï¼Œ æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å¾— Telerik UI çš„åŠ å¯†å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 ç­‰æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ä¿¡æ¯æ³„éœ²ï¼‰è·å–ã€‚
2.  **Payload æ„é€ ï¼š**  æ”»å‡»è€…ä½¿ç”¨è·å¾—çš„å¯†é’¥ï¼Œæ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªåºåˆ—åŒ–å¯¹è±¡é€šå¸¸åˆ©ç”¨ `System.Web.Script.Serialization.JavaScriptSerializer` è¿›è¡Œæ„é€ ã€‚
3.  **ä¸Šä¼  Payloadï¼š**  æ”»å‡»è€…é€šè¿‡ RadAsyncUpload åŠŸèƒ½ä¸Šä¼ åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„ Payloadã€‚
4.  **è§¦å‘ååºåˆ—åŒ–ï¼š**  å½“ Telerik UI å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå°è¯•ååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œè§¦å‘ Payload ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ è¯¥POCå°†Payload é€šè¿‡Cookie, metadataè¿›è¡Œä¼ é€’,å¯ä»¥ç»•è¿‡WAFã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´åˆ©ç”¨è¿‡ç¨‹æ¶‰åŠè·å–å¯†é’¥ã€æ„é€ æ¶æ„ Payload å’Œè§¦å‘ååºåˆ—åŒ–ä¸‰ä¸ªå…³é”®æ­¥éª¤ã€‚

**é¡¹ç›®åœ°å€:** [ekkoo-z/CVE-2019-18935-bypasswaf](https://github.com/ekkoo-z/CVE-2019-18935-bypasswaf)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #10

**æ¥æº**: [CVE-2019-18935-menashe12346_CVE-2019-18935.md](../2019/CVE-2019-18935-menashe12346_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œä¸”encryption keyså·²çŸ¥ (é€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼)ï¼Œæˆ–è€…ç›®æ ‡ç‰ˆæœ¬åœ¨æœªè¿›è¡Œç‰¹å®šé…ç½®çš„æƒ…å†µä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚å½“åŠ å¯†å¯†é’¥å·²çŸ¥ï¼ˆç”±äº CVE-2017-11317 æˆ– CVE-2017-11357 çš„å­˜åœ¨æˆ–å…¶ä»–æ–¹å¼ï¼‰æ—¶ï¼ŒRadAsyncUpload å‡½æ•°å®¹æ˜“å—åˆ°æ”»å‡»ã€‚æ¼æ´åˆ©ç”¨ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„PoCè„šæœ¬ `CVE-2019-18935.py` åˆ©ç”¨è¯¥æ¼æ´é€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ”»å‡»:

1.  **å¯†é’¥åˆ©ç”¨ï¼ˆå‰ææ¡ä»¶ï¼‰**: è¯¥è„šæœ¬ä¾èµ–äºå·²çŸ¥æˆ–å¯ä»¥è¢«æ¨æ–­å‡ºçš„åŠ å¯†å¯†é’¥ã€‚ä¹‹å‰çš„æ¼æ´ (CVE-2017-11317, CVE-2017-11357) å…è®¸æ”»å‡»è€…è·å–è¿™äº›å¯†é’¥ï¼Œæˆ–è€…åœ¨æœªé…ç½®é»˜è®¤é˜²å¾¡æªæ–½çš„æƒ…å†µä¸‹ï¼Œå¯†é’¥å¯èƒ½æ˜¯é»˜è®¤çš„ã€‚
2.  **DLLä¸Šä¼ **: PoCé¦–å…ˆä¸Šä¼ ä¸€ä¸ªæ¶æ„çš„DLLæ–‡ä»¶ï¼ˆ`reverse_shell.dll`ï¼‰ã€‚è¯¥DLLæ–‡ä»¶é€šå¸¸åŒ…å«åå‘shellä»£ç ã€‚
3.  **æ„é€ RAU Post Data**: è„šæœ¬æ„é€ åŒ…å«ç›®æ ‡æ–‡ä»¶å¤¹ã€ä¸´æ—¶ç›®æ ‡æ–‡ä»¶å¤¹ã€æ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯çš„RAU (RadAsyncUpload) post dataã€‚ è¿™ä¸ªæ•°æ®è¢«åŠ å¯†å’ŒHMACç­¾åï¼Œå¯†é’¥æ˜¯å‰é¢æåˆ°çš„åŠ å¯†å¯†é’¥ã€‚
4.  **ååºåˆ—åŒ–åˆ©ç”¨**: è„šæœ¬æ„é€ ä¸€ä¸ªæ¶æ„çš„ `AssemblyInstaller` å¯¹è±¡ï¼ŒæŒ‡å®šä¸Šä¼ çš„DLLæ–‡ä»¶çš„è·¯å¾„ã€‚å½“ Telerik UI ååºåˆ—åŒ–è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒä¼šå°è¯•åŠ è½½å¹¶æ‰§è¡Œ DLL æ–‡ä»¶ï¼Œä»è€Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **åå‘Shell**:  è„šæœ¬åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªåå‘Shellç›‘å¬å™¨ï¼Œæ¶æ„DLLæ‰§è¡Œåä¼šè¿æ¥åˆ°è¯¥ç›‘å¬å™¨ï¼Œä»è€Œå…è®¸æ”»å‡»è€…è¿œç¨‹æ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚
6. **å‘½ä»¤æ‰§è¡Œ**: æˆåŠŸå»ºç«‹åå‘shellè¿æ¥åï¼ŒPoCè„šæœ¬å°†æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„å‘½ä»¤ã€‚

**æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§åˆ†æ:**

PoC çš„æœ‰æ•ˆæ€§å–å†³äºä»¥ä¸‹å› ç´ :

*   **ç›®æ ‡ç³»ç»Ÿä¸Š Telerik UI for ASP.NET AJAX çš„ç‰ˆæœ¬**: æ¼æ´å­˜åœ¨äº 2019.3.1023 åŠæ›´æ—©ç‰ˆæœ¬ã€‚
*   **åŠ å¯†å¯†é’¥çš„å¯ç”¨æ€§**: æˆåŠŸåˆ©ç”¨æ¼æ´çš„å…³é”®æ˜¯æ‹¥æœ‰æ­£ç¡®çš„åŠ å¯†å¯†é’¥ã€‚
*   **ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å·²åº”ç”¨ç¼“è§£æªæ–½**: ä» 2020.1.114 ç‰ˆæœ¬å¼€å§‹ï¼ŒTelerik å¼•å…¥äº†é»˜è®¤é…ç½®ï¼Œå¯ä»¥é˜»æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚
*   **é˜²ç«å¢™å’Œç½‘ç»œé…ç½®**:  åå‘Shellçš„è¿æ¥å¯èƒ½å—åˆ°é˜²ç«å¢™æˆ–ç½‘ç»œé…ç½®çš„é™åˆ¶ã€‚

**æŠ•æ¯’é£é™©åˆ†æ:**

ä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå°½ç®¡å¯èƒ½æ€§ç›¸å¯¹è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚
*   **`reverse_shell.dll`**: è¿™æ˜¯æ½œåœ¨çš„æŠ•æ¯’ç‚¹ã€‚ç”¨æˆ·éœ€è¦è‡ªè¡Œç¼–è¯‘æˆ–è·å–æ­¤ DLLã€‚å¦‚æœ DLL æ˜¯ä»ä¸å—ä¿¡ä»»çš„æ¥æºè·å–çš„ï¼Œå®ƒå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚
*   **å‘½ä»¤æ³¨å…¥**: è„šæœ¬ç›´æ¥å°†ç”¨æˆ·æä¾›çš„å‘½ä»¤ä¼ é€’ç»™åå‘shellã€‚å¦‚æœç”¨æˆ·è¾“å…¥çš„å‘½ä»¤æœ¬èº«åŒ…å«æ¶æ„ä»£ç ï¼Œå¯èƒ½ä¼šå¯¼è‡´é¢å¤–çš„å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯è¿™ä¸å±äºæŠ•æ¯’ï¼Œå±äºç”¨æˆ·ä½¿ç”¨ä¸å½“ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“:**

1.  è·å–æˆ–çŒœæµ‹ Telerik UI for ASP.NET AJAX ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  ä½¿ç”¨ PoC è„šæœ¬ä¸Šä¼ åŒ…å«åå‘shellä»£ç çš„ DLL æ–‡ä»¶ã€‚
3.  åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´åŠ è½½å¹¶æ‰§è¡Œä¸Šä¼ çš„ DLL æ–‡ä»¶ã€‚
4.  é€šè¿‡åå‘shellè¿æ¥æ§åˆ¶ç›®æ ‡ç³»ç»Ÿå¹¶æ‰§è¡Œå‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [menashe12346/CVE-2019-18935](https://github.com/menashe12346/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---



---

## POC #11

**æ¥æº**: [CVE-2019-18935-murataydemir_CVE-2019-18935.md](../2019/CVE-2019-18935-murataydemir_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** .NETååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Telerik UI for ASP.NET AJAXç»„ä»¶ï¼Œå¹¶ä¸”éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†çš„æ‰‹æ®µï¼ˆå¦‚CVE-2017-11317æˆ–CVE-2017-11357ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåˆ©ç”¨ .NET Framework çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºCVE-2019-18935 å…è®¸é€šè¿‡ RadAsyncUpload ç»„ä»¶è¿›è¡Œ .NET ååºåˆ—åŒ–æ”»å‡»ï¼Œæœç´¢ç»“æœä¸­ä¹Ÿæœ‰å¤šä¸ªé“¾æ¥æŒ‡å‘è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹æ³•å’Œå—å½±å“çš„ç‰ˆæœ¬ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰è¯¦ç»†è¯´æ˜äº†å¦‚ä½•æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æä¾›äº†ä¸¤ç§éªŒè¯æ–¹å¼ï¼š
1.  **å®‰å…¨æ¨¡å¼ (Sleep())**: é€šè¿‡è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´æ¥éªŒè¯æ¼æ´æ˜¯å¦æˆåŠŸåˆ©ç”¨ã€‚è¯¥æ–¹æ³•æ¯”è¾ƒå®‰å…¨ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨é€ æˆå®è´¨æ€§çš„å±å®³ã€‚
2.  **æ”»å‡»æ¨¡å¼ (Reverse Shell)**:  é€šè¿‡åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œåå‘ Shell ä»£ç ï¼Œæ¥è·å–æœåŠ¡å™¨çš„æ§åˆ¶æƒã€‚è¯¥æ–¹æ³•å…·æœ‰æ”»å‡»æ€§ï¼Œå¯èƒ½å¯¹æœåŠ¡å™¨é€ æˆå±å®³ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸¤ä¸ª C ä»£ç æ–‡ä»¶ï¼ˆsleep.c å’Œ reverse-shell.cï¼‰ã€‚
*   README.md æ–‡ä»¶ä¸»è¦ä»‹ç»äº†æ¼æ´çš„åˆ©ç”¨æ­¥éª¤å’Œå—å½±å“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œä¸åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   sleep.c æ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„ DLLï¼Œå…¶åŠŸèƒ½æ˜¯è®©æœåŠ¡å™¨ç¡çœ ä¸€æ®µæ—¶é—´ï¼Œç”¨äºéªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   reverse-shell.c æ–‡ä»¶åŒ…å«åå‘ Shell ä»£ç ï¼Œå…¶åŠŸèƒ½æ˜¯è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…å‘é€çš„å‘½ä»¤ã€‚è¯¥ä»£ç æœ¬èº«æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚è¯¥æ–‡ä»¶éœ€è¦ä½¿ç”¨è€…è‡ªå·±å®šä¹‰HOSTå’ŒPORTï¼Œå› æ­¤ä¸å±äºä½œè€…æ¤å…¥çš„åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“ä¸­ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **æ£€æµ‹æ¼æ´ï¼š** å‘é€ GET è¯·æ±‚åˆ° `/Telerik.Web.UI.WebResource.axd?type=rau` æ£€æŸ¥ RadAsyncUpload æ˜¯å¦å¯ç”¨ã€‚å¦‚æœè¿”å›åŒ…å« "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." çš„ JSON å“åº”ï¼Œåˆ™è¡¨ç¤ºå¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **å‡†å¤‡æ¶æ„ DLLï¼š**
    *   **å®‰å…¨æ¨¡å¼ï¼š** ç¼–è¯‘ sleep.c æ–‡ä»¶ç”Ÿæˆ sleep.dllï¼Œç”¨äºéªŒè¯æ¼æ´ã€‚
    *   **æ”»å‡»æ¨¡å¼ï¼š** ä¿®æ”¹ reverse-shell.c æ–‡ä»¶ä¸­çš„ HOST å’Œ PORT å˜é‡ï¼Œç¼–è¯‘ç”Ÿæˆ reverse-shell.dllï¼Œç”¨äºè·å–åå‘ Shellã€‚
3.  **åˆ©ç”¨æ¼æ´ï¼š**
ç”±äº CVE ä¿¡æ¯ä¸­è¯´æ˜ï¼Œæ¼æ´éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†æ‰‹æ®µã€‚ å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡ç³»ç»Ÿçš„å…·ä½“æƒ…å†µï¼Œæ„é€ åŒ…å«æ¶æ„ DLL è·¯å¾„çš„ JSON åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥æ•°æ®æ—¶ï¼Œä¼šåŠ è½½å¹¶æ‰§è¡Œæ¶æ„ DLLï¼Œä»è€Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æ€»ç»“ï¼š**
CVE-2019-18935 æ˜¯ä¸€ä¸ªé«˜å±çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è™½ç„¶åˆ©ç”¨è¯¥æ¼æ´éœ€è¦ä¸€å®šçš„æ¡ä»¶ï¼ˆå·²çŸ¥åŠ å¯†å¯†é’¥æˆ–è€…ç»•è¿‡åŠ å¯†ï¼‰ï¼Œä½†ä¸€æ—¦æˆåŠŸåˆ©ç”¨ï¼Œå±å®³æå¤§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç å¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œå¹¶è¿›è¡Œæ¸—é€æµ‹è¯•ã€‚


**é¡¹ç›®åœ°å€:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #12

**æ¥æº**: [CVE-2019-18935-noperator_CVE-2019-18935.md](../2019/CVE-2019-18935-noperator_CVE-2019-18935.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æœ‰æ¼æ´çš„Telerik UI ç»„ä»¶ï¼Œä¸”å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆå¯é€šè¿‡CVE-2017-11317æˆ–CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ã€‚è¯¥æ¼æ´ä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å½“æ”»å‡»è€…å·²çŸ¥åŠ å¯†å¯†é’¥æ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåˆ©ç”¨ JavaScriptSerializer è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚CVEåº“ä¿¡æ¯ä¸­æåˆ°ï¼Œå·²çŸ¥æ¼æ´åˆ©ç”¨åœ¨é‡ã€‚æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºè¯¥æ¼æ´ç»å¸¸è¢«æ”»å‡»è€…åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨ç›®æ ‡åŠ å¯†ç§˜é’¥æ³„éœ²çš„æƒ…å†µä¸‹ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç çœ‹èµ·æ¥æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº† RadAsyncUpload çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶å¹¶æ‰§è¡Œä»£ç ã€‚POCä»£ç åŒ…æ‹¬äº†åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹ï¼Œä»¥åŠæ„å»ºå’Œå‘é€æ¶æ„è¯·æ±‚çš„åŠŸèƒ½ã€‚

**æŠ•æ¯’é£é™©ï¼š**  POCä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©çš„å¯èƒ½æ€§è¾ƒä½ (5%)ã€‚ä¸»è¦è€ƒé‡æ˜¯RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„åŠ å¯†ç®—æ³•å¯èƒ½å­˜åœ¨åé—¨ï¼Œä½†è¿™å±äºPOCéªŒè¯éœ€è¦çš„åé—¨ä»£ç ï¼Œè€Œä¸”ç”±äºä»£ç ç›¸å¯¹æ¸…æ™°ï¼Œæ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚éœ€è¦å¯¹RAU_cryptoæ–‡ä»¶å¤¹ä¸‹çš„ä»£ç åšè¿›ä¸€æ­¥å®¡è®¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å¯†é’¥è·å–ï¼š** é¦–å…ˆï¼Œæ”»å‡»è€…éœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚ è¿™å¯ä»¥é€šè¿‡åˆ©ç”¨å…¶ä»–æ¼æ´ï¼ˆå¦‚ CVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æ¥å®Œæˆï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼æ³„éœ²ã€‚
2.  **æ„é€ æ¶æ„Payloadï¼š**  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ JavaScriptSerializer å°†å…¶åºåˆ—åŒ–ã€‚
3.  **åŠ å¯†Payloadï¼š** ä½¿ç”¨è·å–çš„å¯†é’¥åŠ å¯†åºåˆ—åŒ–çš„ Payloadã€‚
4.  **ä¸Šä¼ Payloadï¼š** å°†åŠ å¯†çš„ Payload ä½œä¸ºæ–‡ä»¶ä¸Šä¼ åˆ° RadAsyncUpload ç»„ä»¶ã€‚
5.  **ååºåˆ—åŒ–è§¦å‘ï¼š** RadAsyncUpload ç»„ä»¶åœ¨å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶æ—¶ï¼Œä¼šå¯¹å…¶è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œè§¦å‘æ¶æ„ä»£ç çš„æ‰§è¡Œï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #13

**æ¥æº**: [CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md](../2019/CVE-2019-18935-quyt0_CVE-2019-18935-exploit-study.md)

## CVE-2019-18935-Telerik UI for ASP.NET AJAX-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆé€šè¿‡CVE-2017-11317, CVE-2017-11357æˆ–å…¶ä»–æ–¹å¼è·å–ï¼‰æˆ–ç›®æ ‡æœªä½¿ç”¨é»˜è®¤è®¾ç½®é˜»æ­¢ååºåˆ—åŒ–

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Progress Telerik UI for ASP.NET AJAX (ç‰ˆæœ¬è‡³ 2019.3.1023) ä¸­çš„ .NET ååºåˆ—åŒ–æ¼æ´ï¼Œä½äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿç ´è§£æˆ–å·²çŸ¥åŠ å¯†å¯†é’¥ï¼Œåˆ™å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»2020.1.114ç‰ˆæœ¬å¼€å§‹ï¼Œé»˜è®¤è®¾ç½®å¯ä»¥é˜²æ­¢æ­¤æ¼æ´åˆ©ç”¨ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡ RadAsyncUpload ç»„ä»¶å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡åœ¨æœåŠ¡å™¨ç«¯è¢«ååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œä»»æ„ä»£ç ã€‚

ä»æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼ŒåŒ…å«ä¸€ä¸ª Visual Studio è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªåä¸º 'TelerikDemo' çš„ ASP.NET Web Forms é¡¹ç›®ã€‚ è¿™äº›ä»£ç æ›´åƒæ˜¯ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œç”¨äºæµ‹è¯•æˆ–å±•ç¤º Telerik UI ç»„ä»¶çš„åŠŸèƒ½ï¼Œå¹¶æ²¡æœ‰ç›´æ¥åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚è¿™ä¸ªä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†ç ”ç©¶CVE-2019-18935ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å¯†é’¥è·å–ï¼š** æ”»å‡»è€…é¦–å…ˆéœ€è¦è·å–ç”¨äºåŠ å¯† RadAsyncUpload é€šä¿¡çš„å¯†é’¥ã€‚è¿™å¯ä»¥é€šè¿‡å·²çŸ¥çš„ CVE-2017-11317ã€CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…å…¶ä»–æ–¹å¼è·å–ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åˆ©ç”¨äº†å·²çŸ¥çš„ .NET Gadget Chainï¼Œä¾‹å¦‚`ysoserial.net`ä¸­æä¾›çš„ Payloadã€‚
3.  **å‘é€Payloadï¼š** æ”»å‡»è€…å°†åŒ…å«æ¶æ„åºåˆ—åŒ–å¯¹è±¡çš„è¯·æ±‚å‘é€åˆ° RadAsyncUpload å¤„ç†ç¨‹åºã€‚è¯¥è¯·æ±‚ä¼šè¢«æœåŠ¡å™¨å¤„ç†ï¼Œååºåˆ—åŒ–æ¶æ„å¯¹è±¡ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„ä»£ç ï¼Œå‘ç°ä»“åº“ä¸­æä¾›çš„ä»£ç æ›´åƒæ˜¯ç”¨äºæ¼æ´å­¦ä¹ å’Œæ¼”ç¤ºçš„ Demo ç¨‹åºï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„æŠ•æ¯’ä»£ç ã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**é¡¹ç›®åœ°å€:** [quyt0/CVE-2019-18935-exploit-study](https://github.com/quyt0/CVE-2019-18935-exploit-study)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

## POC #14

**æ¥æº**: [CVE-2019-18935-random-robbie_CVE-2019-18935.md](../2019/CVE-2019-18935-random-robbie_CVE-2019-18935.md)

## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX ååºåˆ—åŒ–æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2019-18935

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–æ¼æ´

**å½±å“åº”ç”¨:** Progress Telerik UI for ASP.NET AJAX

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** <= 2019.3.1023

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦å·²çŸ¥åŠ å¯†å¯†é’¥ï¼ˆCVE-2017-11317 æˆ– CVE-2017-11357ï¼‰æˆ–é€šè¿‡å…¶ä»–æ–¹å¼è·å–ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-18935 æ˜¯ Progress Telerik UI for ASP.NET AJAX ç»„ä»¶ä¸­çš„ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œå­˜åœ¨äº RadAsyncUpload åŠŸèƒ½ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ„é€ æ¶æ„çš„åºåˆ—åŒ–æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨çš„å‰ææ˜¯æ”»å‡»è€…éœ€è¦çŸ¥é“åŠ å¯†å¯†é’¥ã€‚ æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœ, è¯¥æ¼æ´å½±å“çš„ç‰ˆæœ¬æ˜¯2019.3.1023åŠæ›´æ—©ç‰ˆæœ¬ã€‚åœ¨ 2020.1.114 ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤è®¾ç½®é˜»æ­¢äº†è¯¥æ¼æ´åˆ©ç”¨ã€‚æ¼æ´åˆ©ç”¨ä»£ç `README.md`ä»…åŒ…å«CVEç¼–å·ï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œä½†æ„å‘³ç€PoCæ˜¯å­˜åœ¨çš„ï¼Œå­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤æœ‰ä¸€å®šæ¦‚ç‡æŒ‡å‘æ¶æ„åœ°å€ï¼Œæ‰€ä»¥è¯„ä¼°ä¸º5%çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **è·å–åŠ å¯†å¯†é’¥ï¼š** åˆ©ç”¨ CVE-2017-11317 æˆ– CVE-2017-11357 æ¼æ´ï¼Œæˆ–è€…é€šè¿‡å…¶ä»–æ–¹å¼è·å– Telerik UI ç»„ä»¶ä½¿ç”¨çš„åŠ å¯†å¯†é’¥ã€‚
2.  **æ„é€ æ¶æ„åºåˆ—åŒ–æ•°æ®ï¼š** ä½¿ç”¨å·²çŸ¥å¯†é’¥ï¼Œæ„é€ åŒ…å«æ¶æ„ä»£ç çš„ .NET åºåˆ—åŒ–å¯¹è±¡ã€‚è¯¥æ¶æ„ä»£ç ä¼šåœ¨ååºåˆ—åŒ–æ—¶æ‰§è¡Œã€‚
3.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** å°†æ„é€ çš„æ¶æ„åºåˆ—åŒ–æ•°æ®ä½œä¸º RadAsyncUpload çš„è¯·æ±‚å‚æ•°å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚
4.  **è¿œç¨‹ä»£ç æ‰§è¡Œï¼š** æœåŠ¡å™¨åœ¨å¤„ç† RadAsyncUpload è¯·æ±‚æ—¶ï¼Œä¼šå¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**é¡¹ç›®åœ°å€:** [random-robbie/CVE-2019-18935](https://github.com/random-robbie/CVE-2019-18935)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)

---

