# CVE-2019-19781

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-19781-0xams_citrixvulncheck.md](../2019/CVE-2019-19781-0xams_citrixvulncheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #2

**来源**: [CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md](../2019/CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #3

**来源**: [CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md](../2019/CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #4

**来源**: [CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md](../2019/CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至结合其他漏洞实现远程代码执行。根据搜索结果，此漏洞在野外被广泛利用，并与NOTROBIN恶意软件有关联。提供的POC代码（Citrix NetScaler Analysis.ipynb）是一个Jupyter Notebook，旨在帮助分析受影响的Citrix设备的日志和模板文件，以检测漏洞利用的痕迹。它本身并非直接的漏洞利用代码，而是一个分析工具，通过搜索特定关键词（如'nobody'用户执行的命令）来识别潜在的入侵行为。因此，不能简单地说该POC“有效”，而是说该工具可以有效辅助漏洞利用后的分析和检测。

**利用方式：**

1.  **目录遍历：** 攻击者发送特制的HTTP请求，包含目录遍历序列（例如`../`），以访问受限目录之外的文件。
2.  **文件读取：** 成功利用目录遍历漏洞后，攻击者可以读取系统配置文件、日志文件或其他敏感信息。
3.  **远程代码执行：**  结合其他漏洞（例如模板注入），攻击者可以将恶意代码写入到服务器上的文件中，然后通过目录遍历漏洞访问并执行这些文件，从而实现远程代码执行。
4.  **日志分析和检测：**  提供的POC代码是一个分析工具，可以帮助安全分析师检查Citrix设备的日志文件，搜索与CVE-2019-19781漏洞利用相关的可疑活动。

**投毒风险分析：**

该POC代码的主要功能是日志和配置文件分析，用于检测漏洞利用的痕迹，而不是直接利用漏洞。代码中包含大量搜索关键词，例如搜索'nobody'用户执行的命令。虽然工具本身是为了安全分析而设计的，但如果攻击者修改了这些关键词列表，可能会导致分析结果出现偏差，例如忽略某些关键的攻击特征。此外，Jupyter Notebook代码在执行前可以被修改，因此存在被植入恶意代码的风险。如果用户在不检查代码的情况下直接运行，可能会执行恶意操作。这种风险相对较低，因为用户通常会查看配置部分，意识到这是一个分析工具，恶意代码会被发现。

考虑到Jupyter Notebook代码的可修改性和用户可能存在的疏忽，以及搜索关键词被篡改的可能，判定存在10%的投毒风险。

**项目地址:** [L4r1k/CitrixNetscalerAnalysis](https://github.com/L4r1k/CitrixNetscalerAnalysis)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #5

**来源**: [CVE-2019-19781-SharpHack_CVE-2019-19781.md](../2019/CVE-2019-19781-SharpHack_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #6

**来源**: [CVE-2019-19781-VladRico_CVE-2019-19781.md](../2019/CVE-2019-19781-VladRico_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问目标设备的Web服务端口（通常是80或443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞，允许未经身份验证的远程攻击者读取敏感文件，甚至执行任意代码。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **目录遍历：** 攻击者利用 `../` 序列来绕过目录访问限制，访问受限目录下的文件。
2.  **模板注入/代码执行：**  通过构造特殊的URL和HTTP头部，尤其是 `NSC_USER` 头部，将恶意命令注入到模板引擎中。Citrix设备会将此命令作为系统命令执行，从而实现远程代码执行。

**POC有效性：**

提供的 Python POC 脚本通过以下步骤来验证和利用该漏洞：

1.  **构建Payload：** `parseCmd` 函数格式化要执行的命令，替换空格和斜杠，以绕过某些过滤。
2.  **发送请求：** 脚本发送两个 HTTP GET 请求，第一个请求利用目录遍历和模板注入设置环境变量，第二个请求触发代码执行，并返回执行结果。
3.  **处理响应：** 脚本检查 HTTP 状态码，以确定漏洞是否成功利用，并打印执行结果。

**投毒风险：**

该代码存在一定的投毒风险，可能性约为10%。
*   **默认代理配置：** 该POC默认使用Tor代理 (`127.0.0.1:9050`)，虽然这可能是为了匿名化攻击者的身份，但也可能被用于隐蔽恶意活动，增加溯源难度。需要用户自行安装和配置Tor，存在钓鱼风险，攻击者可能提供配置错误的Tor安装包。
*   **依赖项：**  POC 依赖于 `requests`、`urllib3` 和 `PySocks` 库。虽然这些库本身是常见的，但攻击者可能会在恶意克隆的仓库中替换这些依赖项，引入恶意代码。
*  **命令执行的风险：** 攻击者使用此POC，可以执行任意命令。虽然这不是POC本身的投毒，但是如果其他人下载了POC，并执行了恶意代码，可能会导致被攻击。
**总结：**

CVE-2019-19781 是一个严重的安全漏洞，需要立即修复。提供的 POC 代码可以有效地验证该漏洞的存在，但也需要注意潜在的投毒风险，使用者需要检查代理设置、依赖项的安全性，并在隔离环境中运行该 POC。

**项目地址:** [VladRico/CVE-2019-19781](https://github.com/VladRico/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #7

**来源**: [CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md](../2019/CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要目标系统运行受影响版本的Citrix ADC或Gateway，并允许通过HTTP(S)访问/vpn路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，攻击者可以通过构造特殊的URL来读取或写入服务器上的任意文件。结合漏洞利用代码分析，攻击者可以通过`POST /vpn/../vpns/portal/scripts/newbm.pl` 接口，利用目录遍历漏洞将恶意代码注入到`/netscaler/portal/templates/RAPIDSAFEGUARD`模板文件中。

`NSC_USER: ../../../netscaler/portal/templates/RAPIDSAFEGUARD`指定了要修改的模板文件。

`desc=[% template.new('BLOCK' = 'print `** Give Command **`') %]` 将webshell写入到`/netscaler/portal/templates/RAPIDSAFEGUARD`。

**Give Command**的位置可以替换成需要执行的系统命令。由于该漏洞可以执行任意代码，因此攻击者可能利用此漏洞植入后门，获取系统权限，或进行其他恶意活动。

**有效性：** 根据漏洞信息和搜索结果，该漏洞在野外已被积极利用，POC代码能够成功执行命令，因此判定该漏洞是有效的。

**投毒风险：** POC本身展示了如何利用漏洞执行任意命令，本身不算是投毒代码。但任何共享的POC都存在被修改并加入恶意代码的风险。该仓库只包含一个README文件和一个POC利用文件，代码量少，投毒风险较低，预估为10%，主要风险在于使用者未经验证直接使用。

**利用方式：**

1.  发送特制的HTTP POST请求到`/vpn/../vpns/portal/scripts/newbm.pl`。
2.  在POST请求中，`NSC_USER`参数用于指定要写入或修改的模板文件，使用目录遍历绕过路径限制。
3.  `desc`参数包含要注入的恶意代码，利用Citrix模板引擎执行任意系统命令。
4.  成功利用后，攻击者可以执行任意系统命令，实现远程代码执行。

**项目地址:** [Vulnmachines/Ctirix_RCE-CVE-2019-19781](https://github.com/Vulnmachines/Ctirix_RCE-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #8

**来源**: [CVE-2019-19781-andripwn_CVE-2019-19781.md](../2019/CVE-2019-19781-andripwn_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #9

**来源**: [CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md](../2019/CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，包括敏感配置文件，进而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送特制的HTTP请求，其中包含目录遍历的payload，例如`../../../../etc/passwd`。
2.  如果Citrix ADC/Gateway设备存在漏洞，它将允许攻击者读取指定的文件。
3.  通过读取敏感配置文件，攻击者可以获取管理员凭据或其他敏感信息。
4.  攻击者可以使用获取的凭据或其他敏感信息来进一步攻击系统，例如执行任意命令。

**关于投毒风险：**

提供的漏洞利用代码实际上是一个用于检查漏洞是否存在而`check-cve-2019-19781`的github仓库，仓库内容是贡献指南和license文件。因此，直接将该代码视为投毒代码是不准确的。但是，任何开源代码都存在潜在的投毒风险，即恶意贡献者可能在代码中插入恶意代码。虽然该仓库由cisagov维护，降低了风险，但是并不能完全排除投毒的可能性。保守估计，存在极低的投毒风险，约为1%。

**项目地址:** [autocode07/cisagov__check-cve-2019-19781.4142e02b](https://github.com/autocode07/cisagov__check-cve-2019-19781.4142e02b)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #10

**来源**: [CVE-2019-19781-chihyeonwon_CVE-2019-19781.md](../2019/CVE-2019-19781-chihyeonwon_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / Remote Code Execution

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历 / 远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 目标系统存在漏洞，攻击者需要网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，未经身份验证的攻击者可以通过发送特制的HTTP请求来读取敏感文件，甚至执行任意代码。根据搜索引擎结果，该漏洞在野外被积极利用。漏洞利用代码显示，它通过操纵`/vpns/`路径，利用`newbm.pl`脚本中的目录遍历缺陷，将恶意XML文件写入到目标系统的`/netscaler/portal/templates/`目录。这个XML文件包含Perl代码，允许攻击者执行任意命令。攻击者首先添加包含恶意代码的书签，然后通过访问该书签对应的XML文件来触发命令执行。该代码有一定的投毒风险，主要体现在以下几个方面：

1.  **依赖性问题**：该POC依赖于目标系统特定的文件路径和脚本。如果目标系统的配置略有不同，POC可能无法正常工作。
2.  **命令执行上下文**：攻击者执行命令的权限取决于Citrix ADC/Gateway进程的运行权限。如果该进程的权限过高，可能导致系统范围的破坏。
3.  **日志和监控**：成功的利用会留下日志记录，使攻击者容易被检测到。为了避免检测，攻击者可能会试图清除日志或采取其他规避措施。
4.  **Perl 代码风险**：perl脚本本身可能存在其他安全问题，或者被用于执行其他恶意活动。

**利用方式：**

1.  发送包含目录遍历序列（例如`../`）的恶意HTTP请求到`/vpns/`路径下的某个易受攻击的脚本（例如`newbm.pl`）。
2.  通过构造特殊的`NSC_USER`头和`url`参数，将包含Perl代码的XML文件写入到目标系统的模板目录。
3.  访问写入的XML文件，触发Perl代码执行，从而执行任意命令。

根据CVE信息以及搜索引擎结果，该漏洞影响范围较广，危害性高。根据CISA的known exploited vulnerabilities catalog，该漏洞已被列入CISA, 积极被利用。

**项目地址:** [chihyeonwon/CVE-2019-19781](https://github.com/chihyeonwon/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #11

**来源**: [CVE-2019-19781-cisagov_check-cve-2019-19781.md](../2019/CVE-2019-19781-cisagov_check-cve-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能通过上传恶意文件执行远程代码。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在野外利用。多个安全厂商的报告证实了该漏洞的活跃利用情况。

**投毒风险:**
提供的漏洞利用代码是关于如何为此漏洞创建一个检测脚本的开发环境, 属于开发环境配置说明文档，**不包含任何直接利用漏洞或恶意代码。所以投毒风险较低。**

**利用方式:**
攻击者可以通过构造包含目录遍历序列（例如，`../`）的恶意URL请求，绕过访问控制，读取或写入受限目录中的文件。结合其他漏洞或配置缺陷，攻击者可能利用此漏洞执行任意代码。

**风险缓解措施:**
*   尽快升级到Citrix官方发布的修复版本。
*   实施Web应用防火墙（WAF）规则，阻止包含目录遍历序列的请求。
*   监控系统日志，检测异常的目录访问行为。

**参考链接:**
*   [CVE-2019-19781 Detail - NVD](https://nvd.nist.gov/vuln/detail/cve-2019-19781)
*   [Active Exploitation of Citrix NetScaler (CVE-2019-19781)](http://www.rapid7.com/blog/post/2020/01/17/active-exploitation-of-citrix-netscaler-cve-2019-19781-what-you-need-to-know/)
*   [Exploits in the Wild for Citrix ADC and Citrix Gateway Directory ...](https://unit42.paloaltonetworks.com/exploits-in-the-wild-for-citrix-adc-and-citrix-gateway-directory-traversal-vulnerability-cve-2019-19781/)

**项目地址:** [cisagov/check-cve-2019-19781](https://github.com/cisagov/check-cve-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #12

**来源**: [CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感信息。漏洞的利用方式通常是构造包含目录遍历字符（如`../`）的恶意URL，从而绕过服务器的安全检查，访问受限目录。根据搜索结果，此漏洞已被广泛利用，并出现了很多相关的POC和利用工具。提供的“漏洞利用代码”实际上是一个FireEye发布的IOC扫描器，用于检测是否已被入侵，并非直接的漏洞利用代码。但是它侧面证明了漏洞的可利用性。投毒风险存在于IOC扫描器本身，虽然是FireEye发布，但仍然存在被篡改或植入恶意代码的可能性，但考虑到FireEye的信誉和代码审查，风险较低，估计为10%。实际的利用方式通常结合目录遍历读取敏感文件，然后配合其他漏洞实现远程代码执行，例如通过上传恶意模板文件。

**项目地址:** [citrix/ioc-scanner-CVE-2019-19781](https://github.com/citrix/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #13

**来源**: [CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #14

**来源**: [CVE-2019-19781-haxrob_CVE-2019-19781.md](../2019/CVE-2019-19781-haxrob_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络可达，目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix Application Delivery Controller (ADC) 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的任意文件，甚至执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（DFIR Notes），该漏洞的POC是有效的，并且已经被广泛利用。搜索结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析报告和检测工具。

**投毒风险评估：**

提供的代码主要是DFIR (Digital Forensics and Incident Response) Notes，旨在帮助安全人员检测和分析受影响的系统，而不是直接的攻击代码。其中包含了一些检测compromise indicators的命令和步骤，例如检查HTTP日志、修改的文件、cronjobs、运行的进程以及bash历史等。也提到Fireeye发布了检测工具。虽然大部分内容是用于安全分析，但也不排除作者在其中加入一些看似无害但实际有害的代码，所以存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **目录遍历：** 攻击者利用目录遍历漏洞，可以访问受限制的目录和文件。
2.  **读取敏感文件：** 攻击者可以读取配置文件（如smb.conf）或其他包含敏感信息的关键文件。
3.  **远程代码执行：**  攻击者可能结合其他漏洞，例如通过上传恶意文件到可执行目录下，最终实现远程代码执行。
4.  **后门植入：** 攻击者可能会在受影响的系统上植入后门，以便长期控制系统。搜索结果提到`NOTROBIN`恶意软件利用了这个漏洞，并且存在恶意行为者阻止其他成功利用该漏洞。Fireeye也检测到了利用单个`POST`请求进行漏洞利用和植入后门的攻击。

漏洞利用代码 (DFIR Notes) 提供的检测手段：

*   检查HTTP日志文件，寻找异常请求。
*   检查指定日期后修改的文件，特别是`/netscaler/portal/templates/`、`/var/tmp/netscaler/portal/templates/`和`/var/vpn/bookmark/`目录下新建的`.xml`文件。
*   检查所有用户的cronjobs，寻找可疑的定时任务。
*   检查所有运行的进程和TCP/UDP连接，寻找可疑的进程和服务。
*   检查bash历史记录，寻找可疑的命令。
*   使用Shodan搜索暴露的Citrix NetScaler实例。
*   使用`curl`命令快速判断主机是否可被利用，即 `curl 'https://host/vpn/../vpns/cfg/smb.conf' --path-as-is`。


**项目地址:** [haxrob/CVE-2019-19781](https://github.com/haxrob/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #15

**来源**: [CVE-2019-19781-hyunjin0334_CVE-2019-19781.md](../2019/CVE-2019-19781-hyunjin0334_CVE-2019-19781.md)

# CVE-2019-19781

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-19781-0xams_citrixvulncheck.md](../2019/CVE-2019-19781-0xams_citrixvulncheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #2

**来源**: [CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md](../2019/CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #3

**来源**: [CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md](../2019/CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #4

**来源**: [CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md](../2019/CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至结合其他漏洞实现远程代码执行。根据搜索结果，此漏洞在野外被广泛利用，并与NOTROBIN恶意软件有关联。提供的POC代码（Citrix NetScaler Analysis.ipynb）是一个Jupyter Notebook，旨在帮助分析受影响的Citrix设备的日志和模板文件，以检测漏洞利用的痕迹。它本身并非直接的漏洞利用代码，而是一个分析工具，通过搜索特定关键词（如'nobody'用户执行的命令）来识别潜在的入侵行为。因此，不能简单地说该POC“有效”，而是说该工具可以有效辅助漏洞利用后的分析和检测。

**利用方式：**

1.  **目录遍历：** 攻击者发送特制的HTTP请求，包含目录遍历序列（例如`../`），以访问受限目录之外的文件。
2.  **文件读取：** 成功利用目录遍历漏洞后，攻击者可以读取系统配置文件、日志文件或其他敏感信息。
3.  **远程代码执行：**  结合其他漏洞（例如模板注入），攻击者可以将恶意代码写入到服务器上的文件中，然后通过目录遍历漏洞访问并执行这些文件，从而实现远程代码执行。
4.  **日志分析和检测：**  提供的POC代码是一个分析工具，可以帮助安全分析师检查Citrix设备的日志文件，搜索与CVE-2019-19781漏洞利用相关的可疑活动。

**投毒风险分析：**

该POC代码的主要功能是日志和配置文件分析，用于检测漏洞利用的痕迹，而不是直接利用漏洞。代码中包含大量搜索关键词，例如搜索'nobody'用户执行的命令。虽然工具本身是为了安全分析而设计的，但如果攻击者修改了这些关键词列表，可能会导致分析结果出现偏差，例如忽略某些关键的攻击特征。此外，Jupyter Notebook代码在执行前可以被修改，因此存在被植入恶意代码的风险。如果用户在不检查代码的情况下直接运行，可能会执行恶意操作。这种风险相对较低，因为用户通常会查看配置部分，意识到这是一个分析工具，恶意代码会被发现。

考虑到Jupyter Notebook代码的可修改性和用户可能存在的疏忽，以及搜索关键词被篡改的可能，判定存在10%的投毒风险。

**项目地址:** [L4r1k/CitrixNetscalerAnalysis](https://github.com/L4r1k/CitrixNetscalerAnalysis)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #5

**来源**: [CVE-2019-19781-SharpHack_CVE-2019-19781.md](../2019/CVE-2019-19781-SharpHack_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #6

**来源**: [CVE-2019-19781-VladRico_CVE-2019-19781.md](../2019/CVE-2019-19781-VladRico_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问目标设备的Web服务端口（通常是80或443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞，允许未经身份验证的远程攻击者读取敏感文件，甚至执行任意代码。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **目录遍历：** 攻击者利用 `../` 序列来绕过目录访问限制，访问受限目录下的文件。
2.  **模板注入/代码执行：**  通过构造特殊的URL和HTTP头部，尤其是 `NSC_USER` 头部，将恶意命令注入到模板引擎中。Citrix设备会将此命令作为系统命令执行，从而实现远程代码执行。

**POC有效性：**

提供的 Python POC 脚本通过以下步骤来验证和利用该漏洞：

1.  **构建Payload：** `parseCmd` 函数格式化要执行的命令，替换空格和斜杠，以绕过某些过滤。
2.  **发送请求：** 脚本发送两个 HTTP GET 请求，第一个请求利用目录遍历和模板注入设置环境变量，第二个请求触发代码执行，并返回执行结果。
3.  **处理响应：** 脚本检查 HTTP 状态码，以确定漏洞是否成功利用，并打印执行结果。

**投毒风险：**

该代码存在一定的投毒风险，可能性约为10%。
*   **默认代理配置：** 该POC默认使用Tor代理 (`127.0.0.1:9050`)，虽然这可能是为了匿名化攻击者的身份，但也可能被用于隐蔽恶意活动，增加溯源难度。需要用户自行安装和配置Tor，存在钓鱼风险，攻击者可能提供配置错误的Tor安装包。
*   **依赖项：**  POC 依赖于 `requests`、`urllib3` 和 `PySocks` 库。虽然这些库本身是常见的，但攻击者可能会在恶意克隆的仓库中替换这些依赖项，引入恶意代码。
*  **命令执行的风险：** 攻击者使用此POC，可以执行任意命令。虽然这不是POC本身的投毒，但是如果其他人下载了POC，并执行了恶意代码，可能会导致被攻击。
**总结：**

CVE-2019-19781 是一个严重的安全漏洞，需要立即修复。提供的 POC 代码可以有效地验证该漏洞的存在，但也需要注意潜在的投毒风险，使用者需要检查代理设置、依赖项的安全性，并在隔离环境中运行该 POC。

**项目地址:** [VladRico/CVE-2019-19781](https://github.com/VladRico/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #7

**来源**: [CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md](../2019/CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要目标系统运行受影响版本的Citrix ADC或Gateway，并允许通过HTTP(S)访问/vpn路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，攻击者可以通过构造特殊的URL来读取或写入服务器上的任意文件。结合漏洞利用代码分析，攻击者可以通过`POST /vpn/../vpns/portal/scripts/newbm.pl` 接口，利用目录遍历漏洞将恶意代码注入到`/netscaler/portal/templates/RAPIDSAFEGUARD`模板文件中。

`NSC_USER: ../../../netscaler/portal/templates/RAPIDSAFEGUARD`指定了要修改的模板文件。

`desc=[% template.new('BLOCK' = 'print `** Give Command **`') %]` 将webshell写入到`/netscaler/portal/templates/RAPIDSAFEGUARD`。

**Give Command**的位置可以替换成需要执行的系统命令。由于该漏洞可以执行任意代码，因此攻击者可能利用此漏洞植入后门，获取系统权限，或进行其他恶意活动。

**有效性：** 根据漏洞信息和搜索结果，该漏洞在野外已被积极利用，POC代码能够成功执行命令，因此判定该漏洞是有效的。

**投毒风险：** POC本身展示了如何利用漏洞执行任意命令，本身不算是投毒代码。但任何共享的POC都存在被修改并加入恶意代码的风险。该仓库只包含一个README文件和一个POC利用文件，代码量少，投毒风险较低，预估为10%，主要风险在于使用者未经验证直接使用。

**利用方式：**

1.  发送特制的HTTP POST请求到`/vpn/../vpns/portal/scripts/newbm.pl`。
2.  在POST请求中，`NSC_USER`参数用于指定要写入或修改的模板文件，使用目录遍历绕过路径限制。
3.  `desc`参数包含要注入的恶意代码，利用Citrix模板引擎执行任意系统命令。
4.  成功利用后，攻击者可以执行任意系统命令，实现远程代码执行。

**项目地址:** [Vulnmachines/Ctirix_RCE-CVE-2019-19781](https://github.com/Vulnmachines/Ctirix_RCE-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #8

**来源**: [CVE-2019-19781-andripwn_CVE-2019-19781.md](../2019/CVE-2019-19781-andripwn_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #9

**来源**: [CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md](../2019/CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，包括敏感配置文件，进而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送特制的HTTP请求，其中包含目录遍历的payload，例如`../../../../etc/passwd`。
2.  如果Citrix ADC/Gateway设备存在漏洞，它将允许攻击者读取指定的文件。
3.  通过读取敏感配置文件，攻击者可以获取管理员凭据或其他敏感信息。
4.  攻击者可以使用获取的凭据或其他敏感信息来进一步攻击系统，例如执行任意命令。

**关于投毒风险：**

提供的漏洞利用代码实际上是一个用于检查漏洞是否存在而`check-cve-2019-19781`的github仓库，仓库内容是贡献指南和license文件。因此，直接将该代码视为投毒代码是不准确的。但是，任何开源代码都存在潜在的投毒风险，即恶意贡献者可能在代码中插入恶意代码。虽然该仓库由cisagov维护，降低了风险，但是并不能完全排除投毒的可能性。保守估计，存在极低的投毒风险，约为1%。

**项目地址:** [autocode07/cisagov__check-cve-2019-19781.4142e02b](https://github.com/autocode07/cisagov__check-cve-2019-19781.4142e02b)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #10

**来源**: [CVE-2019-19781-chihyeonwon_CVE-2019-19781.md](../2019/CVE-2019-19781-chihyeonwon_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / Remote Code Execution

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历 / 远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 目标系统存在漏洞，攻击者需要网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，未经身份验证的攻击者可以通过发送特制的HTTP请求来读取敏感文件，甚至执行任意代码。根据搜索引擎结果，该漏洞在野外被积极利用。漏洞利用代码显示，它通过操纵`/vpns/`路径，利用`newbm.pl`脚本中的目录遍历缺陷，将恶意XML文件写入到目标系统的`/netscaler/portal/templates/`目录。这个XML文件包含Perl代码，允许攻击者执行任意命令。攻击者首先添加包含恶意代码的书签，然后通过访问该书签对应的XML文件来触发命令执行。该代码有一定的投毒风险，主要体现在以下几个方面：

1.  **依赖性问题**：该POC依赖于目标系统特定的文件路径和脚本。如果目标系统的配置略有不同，POC可能无法正常工作。
2.  **命令执行上下文**：攻击者执行命令的权限取决于Citrix ADC/Gateway进程的运行权限。如果该进程的权限过高，可能导致系统范围的破坏。
3.  **日志和监控**：成功的利用会留下日志记录，使攻击者容易被检测到。为了避免检测，攻击者可能会试图清除日志或采取其他规避措施。
4.  **Perl 代码风险**：perl脚本本身可能存在其他安全问题，或者被用于执行其他恶意活动。

**利用方式：**

1.  发送包含目录遍历序列（例如`../`）的恶意HTTP请求到`/vpns/`路径下的某个易受攻击的脚本（例如`newbm.pl`）。
2.  通过构造特殊的`NSC_USER`头和`url`参数，将包含Perl代码的XML文件写入到目标系统的模板目录。
3.  访问写入的XML文件，触发Perl代码执行，从而执行任意命令。

根据CVE信息以及搜索引擎结果，该漏洞影响范围较广，危害性高。根据CISA的known exploited vulnerabilities catalog，该漏洞已被列入CISA, 积极被利用。

**项目地址:** [chihyeonwon/CVE-2019-19781](https://github.com/chihyeonwon/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #11

**来源**: [CVE-2019-19781-cisagov_check-cve-2019-19781.md](../2019/CVE-2019-19781-cisagov_check-cve-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能通过上传恶意文件执行远程代码。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在野外利用。多个安全厂商的报告证实了该漏洞的活跃利用情况。

**投毒风险:**
提供的漏洞利用代码是关于如何为此漏洞创建一个检测脚本的开发环境, 属于开发环境配置说明文档，**不包含任何直接利用漏洞或恶意代码。所以投毒风险较低。**

**利用方式:**
攻击者可以通过构造包含目录遍历序列（例如，`../`）的恶意URL请求，绕过访问控制，读取或写入受限目录中的文件。结合其他漏洞或配置缺陷，攻击者可能利用此漏洞执行任意代码。

**风险缓解措施:**
*   尽快升级到Citrix官方发布的修复版本。
*   实施Web应用防火墙（WAF）规则，阻止包含目录遍历序列的请求。
*   监控系统日志，检测异常的目录访问行为。

**参考链接:**
*   [CVE-2019-19781 Detail - NVD](https://nvd.nist.gov/vuln/detail/cve-2019-19781)
*   [Active Exploitation of Citrix NetScaler (CVE-2019-19781)](http://www.rapid7.com/blog/post/2020/01/17/active-exploitation-of-citrix-netscaler-cve-2019-19781-what-you-need-to-know/)
*   [Exploits in the Wild for Citrix ADC and Citrix Gateway Directory ...](https://unit42.paloaltonetworks.com/exploits-in-the-wild-for-citrix-adc-and-citrix-gateway-directory-traversal-vulnerability-cve-2019-19781/)

**项目地址:** [cisagov/check-cve-2019-19781](https://github.com/cisagov/check-cve-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #12

**来源**: [CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感信息。漏洞的利用方式通常是构造包含目录遍历字符（如`../`）的恶意URL，从而绕过服务器的安全检查，访问受限目录。根据搜索结果，此漏洞已被广泛利用，并出现了很多相关的POC和利用工具。提供的“漏洞利用代码”实际上是一个FireEye发布的IOC扫描器，用于检测是否已被入侵，并非直接的漏洞利用代码。但是它侧面证明了漏洞的可利用性。投毒风险存在于IOC扫描器本身，虽然是FireEye发布，但仍然存在被篡改或植入恶意代码的可能性，但考虑到FireEye的信誉和代码审查，风险较低，估计为10%。实际的利用方式通常结合目录遍历读取敏感文件，然后配合其他漏洞实现远程代码执行，例如通过上传恶意模板文件。

**项目地址:** [citrix/ioc-scanner-CVE-2019-19781](https://github.com/citrix/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #13

**来源**: [CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #14

**来源**: [CVE-2019-19781-haxrob_CVE-2019-19781.md](../2019/CVE-2019-19781-haxrob_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络可达，目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix Application Delivery Controller (ADC) 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的任意文件，甚至执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（DFIR Notes），该漏洞的POC是有效的，并且已经被广泛利用。搜索结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析报告和检测工具。

**投毒风险评估：**

提供的代码主要是DFIR (Digital Forensics and Incident Response) Notes，旨在帮助安全人员检测和分析受影响的系统，而不是直接的攻击代码。其中包含了一些检测compromise indicators的命令和步骤，例如检查HTTP日志、修改的文件、cronjobs、运行的进程以及bash历史等。也提到Fireeye发布了检测工具。虽然大部分内容是用于安全分析，但也不排除作者在其中加入一些看似无害但实际有害的代码，所以存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **目录遍历：** 攻击者利用目录遍历漏洞，可以访问受限制的目录和文件。
2.  **读取敏感文件：** 攻击者可以读取配置文件（如smb.conf）或其他包含敏感信息的关键文件。
3.  **远程代码执行：**  攻击者可能结合其他漏洞，例如通过上传恶意文件到可执行目录下，最终实现远程代码执行。
4.  **后门植入：** 攻击者可能会在受影响的系统上植入后门，以便长期控制系统。搜索结果提到`NOTROBIN`恶意软件利用了这个漏洞，并且存在恶意行为者阻止其他成功利用该漏洞。Fireeye也检测到了利用单个`POST`请求进行漏洞利用和植入后门的攻击。

漏洞利用代码 (DFIR Notes) 提供的检测手段：

*   检查HTTP日志文件，寻找异常请求。
*   检查指定日期后修改的文件，特别是`/netscaler/portal/templates/`、`/var/tmp/netscaler/portal/templates/`和`/var/vpn/bookmark/`目录下新建的`.xml`文件。
*   检查所有用户的cronjobs，寻找可疑的定时任务。
*   检查所有运行的进程和TCP/UDP连接，寻找可疑的进程和服务。
*   检查bash历史记录，寻找可疑的命令。
*   使用Shodan搜索暴露的Citrix NetScaler实例。
*   使用`curl`命令快速判断主机是否可被利用，即 `curl 'https://host/vpn/../vpns/cfg/smb.conf' --path-as-is`。


**项目地址:** [haxrob/CVE-2019-19781](https://github.com/haxrob/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #15

**来源**: [CVE-2019-19781-hyunjin0334_CVE-2019-19781.md](../2019/CVE-2019-19781-hyunjin0334_CVE-2019-19781.md)

# CVE-2019-19781

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-19781-0xams_citrixvulncheck.md](../2019/CVE-2019-19781-0xams_citrixvulncheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #2

**来源**: [CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md](../2019/CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #3

**来源**: [CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md](../2019/CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #4

**来源**: [CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md](../2019/CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至结合其他漏洞实现远程代码执行。根据搜索结果，此漏洞在野外被广泛利用，并与NOTROBIN恶意软件有关联。提供的POC代码（Citrix NetScaler Analysis.ipynb）是一个Jupyter Notebook，旨在帮助分析受影响的Citrix设备的日志和模板文件，以检测漏洞利用的痕迹。它本身并非直接的漏洞利用代码，而是一个分析工具，通过搜索特定关键词（如'nobody'用户执行的命令）来识别潜在的入侵行为。因此，不能简单地说该POC“有效”，而是说该工具可以有效辅助漏洞利用后的分析和检测。

**利用方式：**

1.  **目录遍历：** 攻击者发送特制的HTTP请求，包含目录遍历序列（例如`../`），以访问受限目录之外的文件。
2.  **文件读取：** 成功利用目录遍历漏洞后，攻击者可以读取系统配置文件、日志文件或其他敏感信息。
3.  **远程代码执行：**  结合其他漏洞（例如模板注入），攻击者可以将恶意代码写入到服务器上的文件中，然后通过目录遍历漏洞访问并执行这些文件，从而实现远程代码执行。
4.  **日志分析和检测：**  提供的POC代码是一个分析工具，可以帮助安全分析师检查Citrix设备的日志文件，搜索与CVE-2019-19781漏洞利用相关的可疑活动。

**投毒风险分析：**

该POC代码的主要功能是日志和配置文件分析，用于检测漏洞利用的痕迹，而不是直接利用漏洞。代码中包含大量搜索关键词，例如搜索'nobody'用户执行的命令。虽然工具本身是为了安全分析而设计的，但如果攻击者修改了这些关键词列表，可能会导致分析结果出现偏差，例如忽略某些关键的攻击特征。此外，Jupyter Notebook代码在执行前可以被修改，因此存在被植入恶意代码的风险。如果用户在不检查代码的情况下直接运行，可能会执行恶意操作。这种风险相对较低，因为用户通常会查看配置部分，意识到这是一个分析工具，恶意代码会被发现。

考虑到Jupyter Notebook代码的可修改性和用户可能存在的疏忽，以及搜索关键词被篡改的可能，判定存在10%的投毒风险。

**项目地址:** [L4r1k/CitrixNetscalerAnalysis](https://github.com/L4r1k/CitrixNetscalerAnalysis)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #5

**来源**: [CVE-2019-19781-SharpHack_CVE-2019-19781.md](../2019/CVE-2019-19781-SharpHack_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #6

**来源**: [CVE-2019-19781-VladRico_CVE-2019-19781.md](../2019/CVE-2019-19781-VladRico_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问目标设备的Web服务端口（通常是80或443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞，允许未经身份验证的远程攻击者读取敏感文件，甚至执行任意代码。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **目录遍历：** 攻击者利用 `../` 序列来绕过目录访问限制，访问受限目录下的文件。
2.  **模板注入/代码执行：**  通过构造特殊的URL和HTTP头部，尤其是 `NSC_USER` 头部，将恶意命令注入到模板引擎中。Citrix设备会将此命令作为系统命令执行，从而实现远程代码执行。

**POC有效性：**

提供的 Python POC 脚本通过以下步骤来验证和利用该漏洞：

1.  **构建Payload：** `parseCmd` 函数格式化要执行的命令，替换空格和斜杠，以绕过某些过滤。
2.  **发送请求：** 脚本发送两个 HTTP GET 请求，第一个请求利用目录遍历和模板注入设置环境变量，第二个请求触发代码执行，并返回执行结果。
3.  **处理响应：** 脚本检查 HTTP 状态码，以确定漏洞是否成功利用，并打印执行结果。

**投毒风险：**

该代码存在一定的投毒风险，可能性约为10%。
*   **默认代理配置：** 该POC默认使用Tor代理 (`127.0.0.1:9050`)，虽然这可能是为了匿名化攻击者的身份，但也可能被用于隐蔽恶意活动，增加溯源难度。需要用户自行安装和配置Tor，存在钓鱼风险，攻击者可能提供配置错误的Tor安装包。
*   **依赖项：**  POC 依赖于 `requests`、`urllib3` 和 `PySocks` 库。虽然这些库本身是常见的，但攻击者可能会在恶意克隆的仓库中替换这些依赖项，引入恶意代码。
*  **命令执行的风险：** 攻击者使用此POC，可以执行任意命令。虽然这不是POC本身的投毒，但是如果其他人下载了POC，并执行了恶意代码，可能会导致被攻击。
**总结：**

CVE-2019-19781 是一个严重的安全漏洞，需要立即修复。提供的 POC 代码可以有效地验证该漏洞的存在，但也需要注意潜在的投毒风险，使用者需要检查代理设置、依赖项的安全性，并在隔离环境中运行该 POC。

**项目地址:** [VladRico/CVE-2019-19781](https://github.com/VladRico/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #7

**来源**: [CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md](../2019/CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要目标系统运行受影响版本的Citrix ADC或Gateway，并允许通过HTTP(S)访问/vpn路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，攻击者可以通过构造特殊的URL来读取或写入服务器上的任意文件。结合漏洞利用代码分析，攻击者可以通过`POST /vpn/../vpns/portal/scripts/newbm.pl` 接口，利用目录遍历漏洞将恶意代码注入到`/netscaler/portal/templates/RAPIDSAFEGUARD`模板文件中。

`NSC_USER: ../../../netscaler/portal/templates/RAPIDSAFEGUARD`指定了要修改的模板文件。

`desc=[% template.new('BLOCK' = 'print `** Give Command **`') %]` 将webshell写入到`/netscaler/portal/templates/RAPIDSAFEGUARD`。

**Give Command**的位置可以替换成需要执行的系统命令。由于该漏洞可以执行任意代码，因此攻击者可能利用此漏洞植入后门，获取系统权限，或进行其他恶意活动。

**有效性：** 根据漏洞信息和搜索结果，该漏洞在野外已被积极利用，POC代码能够成功执行命令，因此判定该漏洞是有效的。

**投毒风险：** POC本身展示了如何利用漏洞执行任意命令，本身不算是投毒代码。但任何共享的POC都存在被修改并加入恶意代码的风险。该仓库只包含一个README文件和一个POC利用文件，代码量少，投毒风险较低，预估为10%，主要风险在于使用者未经验证直接使用。

**利用方式：**

1.  发送特制的HTTP POST请求到`/vpn/../vpns/portal/scripts/newbm.pl`。
2.  在POST请求中，`NSC_USER`参数用于指定要写入或修改的模板文件，使用目录遍历绕过路径限制。
3.  `desc`参数包含要注入的恶意代码，利用Citrix模板引擎执行任意系统命令。
4.  成功利用后，攻击者可以执行任意系统命令，实现远程代码执行。

**项目地址:** [Vulnmachines/Ctirix_RCE-CVE-2019-19781](https://github.com/Vulnmachines/Ctirix_RCE-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #8

**来源**: [CVE-2019-19781-andripwn_CVE-2019-19781.md](../2019/CVE-2019-19781-andripwn_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #9

**来源**: [CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md](../2019/CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，包括敏感配置文件，进而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送特制的HTTP请求，其中包含目录遍历的payload，例如`../../../../etc/passwd`。
2.  如果Citrix ADC/Gateway设备存在漏洞，它将允许攻击者读取指定的文件。
3.  通过读取敏感配置文件，攻击者可以获取管理员凭据或其他敏感信息。
4.  攻击者可以使用获取的凭据或其他敏感信息来进一步攻击系统，例如执行任意命令。

**关于投毒风险：**

提供的漏洞利用代码实际上是一个用于检查漏洞是否存在而`check-cve-2019-19781`的github仓库，仓库内容是贡献指南和license文件。因此，直接将该代码视为投毒代码是不准确的。但是，任何开源代码都存在潜在的投毒风险，即恶意贡献者可能在代码中插入恶意代码。虽然该仓库由cisagov维护，降低了风险，但是并不能完全排除投毒的可能性。保守估计，存在极低的投毒风险，约为1%。

**项目地址:** [autocode07/cisagov__check-cve-2019-19781.4142e02b](https://github.com/autocode07/cisagov__check-cve-2019-19781.4142e02b)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #10

**来源**: [CVE-2019-19781-chihyeonwon_CVE-2019-19781.md](../2019/CVE-2019-19781-chihyeonwon_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / Remote Code Execution

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历 / 远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 目标系统存在漏洞，攻击者需要网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，未经身份验证的攻击者可以通过发送特制的HTTP请求来读取敏感文件，甚至执行任意代码。根据搜索引擎结果，该漏洞在野外被积极利用。漏洞利用代码显示，它通过操纵`/vpns/`路径，利用`newbm.pl`脚本中的目录遍历缺陷，将恶意XML文件写入到目标系统的`/netscaler/portal/templates/`目录。这个XML文件包含Perl代码，允许攻击者执行任意命令。攻击者首先添加包含恶意代码的书签，然后通过访问该书签对应的XML文件来触发命令执行。该代码有一定的投毒风险，主要体现在以下几个方面：

1.  **依赖性问题**：该POC依赖于目标系统特定的文件路径和脚本。如果目标系统的配置略有不同，POC可能无法正常工作。
2.  **命令执行上下文**：攻击者执行命令的权限取决于Citrix ADC/Gateway进程的运行权限。如果该进程的权限过高，可能导致系统范围的破坏。
3.  **日志和监控**：成功的利用会留下日志记录，使攻击者容易被检测到。为了避免检测，攻击者可能会试图清除日志或采取其他规避措施。
4.  **Perl 代码风险**：perl脚本本身可能存在其他安全问题，或者被用于执行其他恶意活动。

**利用方式：**

1.  发送包含目录遍历序列（例如`../`）的恶意HTTP请求到`/vpns/`路径下的某个易受攻击的脚本（例如`newbm.pl`）。
2.  通过构造特殊的`NSC_USER`头和`url`参数，将包含Perl代码的XML文件写入到目标系统的模板目录。
3.  访问写入的XML文件，触发Perl代码执行，从而执行任意命令。

根据CVE信息以及搜索引擎结果，该漏洞影响范围较广，危害性高。根据CISA的known exploited vulnerabilities catalog，该漏洞已被列入CISA, 积极被利用。

**项目地址:** [chihyeonwon/CVE-2019-19781](https://github.com/chihyeonwon/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #11

**来源**: [CVE-2019-19781-cisagov_check-cve-2019-19781.md](../2019/CVE-2019-19781-cisagov_check-cve-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能通过上传恶意文件执行远程代码。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在野外利用。多个安全厂商的报告证实了该漏洞的活跃利用情况。

**投毒风险:**
提供的漏洞利用代码是关于如何为此漏洞创建一个检测脚本的开发环境, 属于开发环境配置说明文档，**不包含任何直接利用漏洞或恶意代码。所以投毒风险较低。**

**利用方式:**
攻击者可以通过构造包含目录遍历序列（例如，`../`）的恶意URL请求，绕过访问控制，读取或写入受限目录中的文件。结合其他漏洞或配置缺陷，攻击者可能利用此漏洞执行任意代码。

**风险缓解措施:**
*   尽快升级到Citrix官方发布的修复版本。
*   实施Web应用防火墙（WAF）规则，阻止包含目录遍历序列的请求。
*   监控系统日志，检测异常的目录访问行为。

**参考链接:**
*   [CVE-2019-19781 Detail - NVD](https://nvd.nist.gov/vuln/detail/cve-2019-19781)
*   [Active Exploitation of Citrix NetScaler (CVE-2019-19781)](http://www.rapid7.com/blog/post/2020/01/17/active-exploitation-of-citrix-netscaler-cve-2019-19781-what-you-need-to-know/)
*   [Exploits in the Wild for Citrix ADC and Citrix Gateway Directory ...](https://unit42.paloaltonetworks.com/exploits-in-the-wild-for-citrix-adc-and-citrix-gateway-directory-traversal-vulnerability-cve-2019-19781/)

**项目地址:** [cisagov/check-cve-2019-19781](https://github.com/cisagov/check-cve-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #12

**来源**: [CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感信息。漏洞的利用方式通常是构造包含目录遍历字符（如`../`）的恶意URL，从而绕过服务器的安全检查，访问受限目录。根据搜索结果，此漏洞已被广泛利用，并出现了很多相关的POC和利用工具。提供的“漏洞利用代码”实际上是一个FireEye发布的IOC扫描器，用于检测是否已被入侵，并非直接的漏洞利用代码。但是它侧面证明了漏洞的可利用性。投毒风险存在于IOC扫描器本身，虽然是FireEye发布，但仍然存在被篡改或植入恶意代码的可能性，但考虑到FireEye的信誉和代码审查，风险较低，估计为10%。实际的利用方式通常结合目录遍历读取敏感文件，然后配合其他漏洞实现远程代码执行，例如通过上传恶意模板文件。

**项目地址:** [citrix/ioc-scanner-CVE-2019-19781](https://github.com/citrix/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #13

**来源**: [CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #14

**来源**: [CVE-2019-19781-haxrob_CVE-2019-19781.md](../2019/CVE-2019-19781-haxrob_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络可达，目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix Application Delivery Controller (ADC) 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的任意文件，甚至执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（DFIR Notes），该漏洞的POC是有效的，并且已经被广泛利用。搜索结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析报告和检测工具。

**投毒风险评估：**

提供的代码主要是DFIR (Digital Forensics and Incident Response) Notes，旨在帮助安全人员检测和分析受影响的系统，而不是直接的攻击代码。其中包含了一些检测compromise indicators的命令和步骤，例如检查HTTP日志、修改的文件、cronjobs、运行的进程以及bash历史等。也提到Fireeye发布了检测工具。虽然大部分内容是用于安全分析，但也不排除作者在其中加入一些看似无害但实际有害的代码，所以存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **目录遍历：** 攻击者利用目录遍历漏洞，可以访问受限制的目录和文件。
2.  **读取敏感文件：** 攻击者可以读取配置文件（如smb.conf）或其他包含敏感信息的关键文件。
3.  **远程代码执行：**  攻击者可能结合其他漏洞，例如通过上传恶意文件到可执行目录下，最终实现远程代码执行。
4.  **后门植入：** 攻击者可能会在受影响的系统上植入后门，以便长期控制系统。搜索结果提到`NOTROBIN`恶意软件利用了这个漏洞，并且存在恶意行为者阻止其他成功利用该漏洞。Fireeye也检测到了利用单个`POST`请求进行漏洞利用和植入后门的攻击。

漏洞利用代码 (DFIR Notes) 提供的检测手段：

*   检查HTTP日志文件，寻找异常请求。
*   检查指定日期后修改的文件，特别是`/netscaler/portal/templates/`、`/var/tmp/netscaler/portal/templates/`和`/var/vpn/bookmark/`目录下新建的`.xml`文件。
*   检查所有用户的cronjobs，寻找可疑的定时任务。
*   检查所有运行的进程和TCP/UDP连接，寻找可疑的进程和服务。
*   检查bash历史记录，寻找可疑的命令。
*   使用Shodan搜索暴露的Citrix NetScaler实例。
*   使用`curl`命令快速判断主机是否可被利用，即 `curl 'https://host/vpn/../vpns/cfg/smb.conf' --path-as-is`。


**项目地址:** [haxrob/CVE-2019-19781](https://github.com/haxrob/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #15

**来源**: [CVE-2019-19781-hyunjin0334_CVE-2019-19781.md](../2019/CVE-2019-19781-hyunjin0334_CVE-2019-19781.md)

# CVE-2019-19781

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-19781-0xams_citrixvulncheck.md](../2019/CVE-2019-19781-0xams_citrixvulncheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #2

**来源**: [CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md](../2019/CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #3

**来源**: [CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md](../2019/CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #4

**来源**: [CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md](../2019/CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至结合其他漏洞实现远程代码执行。根据搜索结果，此漏洞在野外被广泛利用，并与NOTROBIN恶意软件有关联。提供的POC代码（Citrix NetScaler Analysis.ipynb）是一个Jupyter Notebook，旨在帮助分析受影响的Citrix设备的日志和模板文件，以检测漏洞利用的痕迹。它本身并非直接的漏洞利用代码，而是一个分析工具，通过搜索特定关键词（如'nobody'用户执行的命令）来识别潜在的入侵行为。因此，不能简单地说该POC“有效”，而是说该工具可以有效辅助漏洞利用后的分析和检测。

**利用方式：**

1.  **目录遍历：** 攻击者发送特制的HTTP请求，包含目录遍历序列（例如`../`），以访问受限目录之外的文件。
2.  **文件读取：** 成功利用目录遍历漏洞后，攻击者可以读取系统配置文件、日志文件或其他敏感信息。
3.  **远程代码执行：**  结合其他漏洞（例如模板注入），攻击者可以将恶意代码写入到服务器上的文件中，然后通过目录遍历漏洞访问并执行这些文件，从而实现远程代码执行。
4.  **日志分析和检测：**  提供的POC代码是一个分析工具，可以帮助安全分析师检查Citrix设备的日志文件，搜索与CVE-2019-19781漏洞利用相关的可疑活动。

**投毒风险分析：**

该POC代码的主要功能是日志和配置文件分析，用于检测漏洞利用的痕迹，而不是直接利用漏洞。代码中包含大量搜索关键词，例如搜索'nobody'用户执行的命令。虽然工具本身是为了安全分析而设计的，但如果攻击者修改了这些关键词列表，可能会导致分析结果出现偏差，例如忽略某些关键的攻击特征。此外，Jupyter Notebook代码在执行前可以被修改，因此存在被植入恶意代码的风险。如果用户在不检查代码的情况下直接运行，可能会执行恶意操作。这种风险相对较低，因为用户通常会查看配置部分，意识到这是一个分析工具，恶意代码会被发现。

考虑到Jupyter Notebook代码的可修改性和用户可能存在的疏忽，以及搜索关键词被篡改的可能，判定存在10%的投毒风险。

**项目地址:** [L4r1k/CitrixNetscalerAnalysis](https://github.com/L4r1k/CitrixNetscalerAnalysis)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #5

**来源**: [CVE-2019-19781-SharpHack_CVE-2019-19781.md](../2019/CVE-2019-19781-SharpHack_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #6

**来源**: [CVE-2019-19781-VladRico_CVE-2019-19781.md](../2019/CVE-2019-19781-VladRico_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问目标设备的Web服务端口（通常是80或443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞，允许未经身份验证的远程攻击者读取敏感文件，甚至执行任意代码。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **目录遍历：** 攻击者利用 `../` 序列来绕过目录访问限制，访问受限目录下的文件。
2.  **模板注入/代码执行：**  通过构造特殊的URL和HTTP头部，尤其是 `NSC_USER` 头部，将恶意命令注入到模板引擎中。Citrix设备会将此命令作为系统命令执行，从而实现远程代码执行。

**POC有效性：**

提供的 Python POC 脚本通过以下步骤来验证和利用该漏洞：

1.  **构建Payload：** `parseCmd` 函数格式化要执行的命令，替换空格和斜杠，以绕过某些过滤。
2.  **发送请求：** 脚本发送两个 HTTP GET 请求，第一个请求利用目录遍历和模板注入设置环境变量，第二个请求触发代码执行，并返回执行结果。
3.  **处理响应：** 脚本检查 HTTP 状态码，以确定漏洞是否成功利用，并打印执行结果。

**投毒风险：**

该代码存在一定的投毒风险，可能性约为10%。
*   **默认代理配置：** 该POC默认使用Tor代理 (`127.0.0.1:9050`)，虽然这可能是为了匿名化攻击者的身份，但也可能被用于隐蔽恶意活动，增加溯源难度。需要用户自行安装和配置Tor，存在钓鱼风险，攻击者可能提供配置错误的Tor安装包。
*   **依赖项：**  POC 依赖于 `requests`、`urllib3` 和 `PySocks` 库。虽然这些库本身是常见的，但攻击者可能会在恶意克隆的仓库中替换这些依赖项，引入恶意代码。
*  **命令执行的风险：** 攻击者使用此POC，可以执行任意命令。虽然这不是POC本身的投毒，但是如果其他人下载了POC，并执行了恶意代码，可能会导致被攻击。
**总结：**

CVE-2019-19781 是一个严重的安全漏洞，需要立即修复。提供的 POC 代码可以有效地验证该漏洞的存在，但也需要注意潜在的投毒风险，使用者需要检查代理设置、依赖项的安全性，并在隔离环境中运行该 POC。

**项目地址:** [VladRico/CVE-2019-19781](https://github.com/VladRico/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #7

**来源**: [CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md](../2019/CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要目标系统运行受影响版本的Citrix ADC或Gateway，并允许通过HTTP(S)访问/vpn路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，攻击者可以通过构造特殊的URL来读取或写入服务器上的任意文件。结合漏洞利用代码分析，攻击者可以通过`POST /vpn/../vpns/portal/scripts/newbm.pl` 接口，利用目录遍历漏洞将恶意代码注入到`/netscaler/portal/templates/RAPIDSAFEGUARD`模板文件中。

`NSC_USER: ../../../netscaler/portal/templates/RAPIDSAFEGUARD`指定了要修改的模板文件。

`desc=[% template.new('BLOCK' = 'print `** Give Command **`') %]` 将webshell写入到`/netscaler/portal/templates/RAPIDSAFEGUARD`。

**Give Command**的位置可以替换成需要执行的系统命令。由于该漏洞可以执行任意代码，因此攻击者可能利用此漏洞植入后门，获取系统权限，或进行其他恶意活动。

**有效性：** 根据漏洞信息和搜索结果，该漏洞在野外已被积极利用，POC代码能够成功执行命令，因此判定该漏洞是有效的。

**投毒风险：** POC本身展示了如何利用漏洞执行任意命令，本身不算是投毒代码。但任何共享的POC都存在被修改并加入恶意代码的风险。该仓库只包含一个README文件和一个POC利用文件，代码量少，投毒风险较低，预估为10%，主要风险在于使用者未经验证直接使用。

**利用方式：**

1.  发送特制的HTTP POST请求到`/vpn/../vpns/portal/scripts/newbm.pl`。
2.  在POST请求中，`NSC_USER`参数用于指定要写入或修改的模板文件，使用目录遍历绕过路径限制。
3.  `desc`参数包含要注入的恶意代码，利用Citrix模板引擎执行任意系统命令。
4.  成功利用后，攻击者可以执行任意系统命令，实现远程代码执行。

**项目地址:** [Vulnmachines/Ctirix_RCE-CVE-2019-19781](https://github.com/Vulnmachines/Ctirix_RCE-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #8

**来源**: [CVE-2019-19781-andripwn_CVE-2019-19781.md](../2019/CVE-2019-19781-andripwn_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #9

**来源**: [CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md](../2019/CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，包括敏感配置文件，进而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送特制的HTTP请求，其中包含目录遍历的payload，例如`../../../../etc/passwd`。
2.  如果Citrix ADC/Gateway设备存在漏洞，它将允许攻击者读取指定的文件。
3.  通过读取敏感配置文件，攻击者可以获取管理员凭据或其他敏感信息。
4.  攻击者可以使用获取的凭据或其他敏感信息来进一步攻击系统，例如执行任意命令。

**关于投毒风险：**

提供的漏洞利用代码实际上是一个用于检查漏洞是否存在而`check-cve-2019-19781`的github仓库，仓库内容是贡献指南和license文件。因此，直接将该代码视为投毒代码是不准确的。但是，任何开源代码都存在潜在的投毒风险，即恶意贡献者可能在代码中插入恶意代码。虽然该仓库由cisagov维护，降低了风险，但是并不能完全排除投毒的可能性。保守估计，存在极低的投毒风险，约为1%。

**项目地址:** [autocode07/cisagov__check-cve-2019-19781.4142e02b](https://github.com/autocode07/cisagov__check-cve-2019-19781.4142e02b)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #10

**来源**: [CVE-2019-19781-chihyeonwon_CVE-2019-19781.md](../2019/CVE-2019-19781-chihyeonwon_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / Remote Code Execution

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历 / 远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 目标系统存在漏洞，攻击者需要网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，未经身份验证的攻击者可以通过发送特制的HTTP请求来读取敏感文件，甚至执行任意代码。根据搜索引擎结果，该漏洞在野外被积极利用。漏洞利用代码显示，它通过操纵`/vpns/`路径，利用`newbm.pl`脚本中的目录遍历缺陷，将恶意XML文件写入到目标系统的`/netscaler/portal/templates/`目录。这个XML文件包含Perl代码，允许攻击者执行任意命令。攻击者首先添加包含恶意代码的书签，然后通过访问该书签对应的XML文件来触发命令执行。该代码有一定的投毒风险，主要体现在以下几个方面：

1.  **依赖性问题**：该POC依赖于目标系统特定的文件路径和脚本。如果目标系统的配置略有不同，POC可能无法正常工作。
2.  **命令执行上下文**：攻击者执行命令的权限取决于Citrix ADC/Gateway进程的运行权限。如果该进程的权限过高，可能导致系统范围的破坏。
3.  **日志和监控**：成功的利用会留下日志记录，使攻击者容易被检测到。为了避免检测，攻击者可能会试图清除日志或采取其他规避措施。
4.  **Perl 代码风险**：perl脚本本身可能存在其他安全问题，或者被用于执行其他恶意活动。

**利用方式：**

1.  发送包含目录遍历序列（例如`../`）的恶意HTTP请求到`/vpns/`路径下的某个易受攻击的脚本（例如`newbm.pl`）。
2.  通过构造特殊的`NSC_USER`头和`url`参数，将包含Perl代码的XML文件写入到目标系统的模板目录。
3.  访问写入的XML文件，触发Perl代码执行，从而执行任意命令。

根据CVE信息以及搜索引擎结果，该漏洞影响范围较广，危害性高。根据CISA的known exploited vulnerabilities catalog，该漏洞已被列入CISA, 积极被利用。

**项目地址:** [chihyeonwon/CVE-2019-19781](https://github.com/chihyeonwon/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #11

**来源**: [CVE-2019-19781-cisagov_check-cve-2019-19781.md](../2019/CVE-2019-19781-cisagov_check-cve-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能通过上传恶意文件执行远程代码。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在野外利用。多个安全厂商的报告证实了该漏洞的活跃利用情况。

**投毒风险:**
提供的漏洞利用代码是关于如何为此漏洞创建一个检测脚本的开发环境, 属于开发环境配置说明文档，**不包含任何直接利用漏洞或恶意代码。所以投毒风险较低。**

**利用方式:**
攻击者可以通过构造包含目录遍历序列（例如，`../`）的恶意URL请求，绕过访问控制，读取或写入受限目录中的文件。结合其他漏洞或配置缺陷，攻击者可能利用此漏洞执行任意代码。

**风险缓解措施:**
*   尽快升级到Citrix官方发布的修复版本。
*   实施Web应用防火墙（WAF）规则，阻止包含目录遍历序列的请求。
*   监控系统日志，检测异常的目录访问行为。

**参考链接:**
*   [CVE-2019-19781 Detail - NVD](https://nvd.nist.gov/vuln/detail/cve-2019-19781)
*   [Active Exploitation of Citrix NetScaler (CVE-2019-19781)](http://www.rapid7.com/blog/post/2020/01/17/active-exploitation-of-citrix-netscaler-cve-2019-19781-what-you-need-to-know/)
*   [Exploits in the Wild for Citrix ADC and Citrix Gateway Directory ...](https://unit42.paloaltonetworks.com/exploits-in-the-wild-for-citrix-adc-and-citrix-gateway-directory-traversal-vulnerability-cve-2019-19781/)

**项目地址:** [cisagov/check-cve-2019-19781](https://github.com/cisagov/check-cve-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #12

**来源**: [CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感信息。漏洞的利用方式通常是构造包含目录遍历字符（如`../`）的恶意URL，从而绕过服务器的安全检查，访问受限目录。根据搜索结果，此漏洞已被广泛利用，并出现了很多相关的POC和利用工具。提供的“漏洞利用代码”实际上是一个FireEye发布的IOC扫描器，用于检测是否已被入侵，并非直接的漏洞利用代码。但是它侧面证明了漏洞的可利用性。投毒风险存在于IOC扫描器本身，虽然是FireEye发布，但仍然存在被篡改或植入恶意代码的可能性，但考虑到FireEye的信誉和代码审查，风险较低，估计为10%。实际的利用方式通常结合目录遍历读取敏感文件，然后配合其他漏洞实现远程代码执行，例如通过上传恶意模板文件。

**项目地址:** [citrix/ioc-scanner-CVE-2019-19781](https://github.com/citrix/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #13

**来源**: [CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #14

**来源**: [CVE-2019-19781-haxrob_CVE-2019-19781.md](../2019/CVE-2019-19781-haxrob_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络可达，目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix Application Delivery Controller (ADC) 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的任意文件，甚至执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（DFIR Notes），该漏洞的POC是有效的，并且已经被广泛利用。搜索结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析报告和检测工具。

**投毒风险评估：**

提供的代码主要是DFIR (Digital Forensics and Incident Response) Notes，旨在帮助安全人员检测和分析受影响的系统，而不是直接的攻击代码。其中包含了一些检测compromise indicators的命令和步骤，例如检查HTTP日志、修改的文件、cronjobs、运行的进程以及bash历史等。也提到Fireeye发布了检测工具。虽然大部分内容是用于安全分析，但也不排除作者在其中加入一些看似无害但实际有害的代码，所以存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **目录遍历：** 攻击者利用目录遍历漏洞，可以访问受限制的目录和文件。
2.  **读取敏感文件：** 攻击者可以读取配置文件（如smb.conf）或其他包含敏感信息的关键文件。
3.  **远程代码执行：**  攻击者可能结合其他漏洞，例如通过上传恶意文件到可执行目录下，最终实现远程代码执行。
4.  **后门植入：** 攻击者可能会在受影响的系统上植入后门，以便长期控制系统。搜索结果提到`NOTROBIN`恶意软件利用了这个漏洞，并且存在恶意行为者阻止其他成功利用该漏洞。Fireeye也检测到了利用单个`POST`请求进行漏洞利用和植入后门的攻击。

漏洞利用代码 (DFIR Notes) 提供的检测手段：

*   检查HTTP日志文件，寻找异常请求。
*   检查指定日期后修改的文件，特别是`/netscaler/portal/templates/`、`/var/tmp/netscaler/portal/templates/`和`/var/vpn/bookmark/`目录下新建的`.xml`文件。
*   检查所有用户的cronjobs，寻找可疑的定时任务。
*   检查所有运行的进程和TCP/UDP连接，寻找可疑的进程和服务。
*   检查bash历史记录，寻找可疑的命令。
*   使用Shodan搜索暴露的Citrix NetScaler实例。
*   使用`curl`命令快速判断主机是否可被利用，即 `curl 'https://host/vpn/../vpns/cfg/smb.conf' --path-as-is`。


**项目地址:** [haxrob/CVE-2019-19781](https://github.com/haxrob/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #15

**来源**: [CVE-2019-19781-hyunjin0334_CVE-2019-19781.md](../2019/CVE-2019-19781-hyunjin0334_CVE-2019-19781.md)

# CVE-2019-19781

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-19781-0xams_citrixvulncheck.md](../2019/CVE-2019-19781-0xams_citrixvulncheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #2

**来源**: [CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md](../2019/CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #3

**来源**: [CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md](../2019/CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #4

**来源**: [CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md](../2019/CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至结合其他漏洞实现远程代码执行。根据搜索结果，此漏洞在野外被广泛利用，并与NOTROBIN恶意软件有关联。提供的POC代码（Citrix NetScaler Analysis.ipynb）是一个Jupyter Notebook，旨在帮助分析受影响的Citrix设备的日志和模板文件，以检测漏洞利用的痕迹。它本身并非直接的漏洞利用代码，而是一个分析工具，通过搜索特定关键词（如'nobody'用户执行的命令）来识别潜在的入侵行为。因此，不能简单地说该POC“有效”，而是说该工具可以有效辅助漏洞利用后的分析和检测。

**利用方式：**

1.  **目录遍历：** 攻击者发送特制的HTTP请求，包含目录遍历序列（例如`../`），以访问受限目录之外的文件。
2.  **文件读取：** 成功利用目录遍历漏洞后，攻击者可以读取系统配置文件、日志文件或其他敏感信息。
3.  **远程代码执行：**  结合其他漏洞（例如模板注入），攻击者可以将恶意代码写入到服务器上的文件中，然后通过目录遍历漏洞访问并执行这些文件，从而实现远程代码执行。
4.  **日志分析和检测：**  提供的POC代码是一个分析工具，可以帮助安全分析师检查Citrix设备的日志文件，搜索与CVE-2019-19781漏洞利用相关的可疑活动。

**投毒风险分析：**

该POC代码的主要功能是日志和配置文件分析，用于检测漏洞利用的痕迹，而不是直接利用漏洞。代码中包含大量搜索关键词，例如搜索'nobody'用户执行的命令。虽然工具本身是为了安全分析而设计的，但如果攻击者修改了这些关键词列表，可能会导致分析结果出现偏差，例如忽略某些关键的攻击特征。此外，Jupyter Notebook代码在执行前可以被修改，因此存在被植入恶意代码的风险。如果用户在不检查代码的情况下直接运行，可能会执行恶意操作。这种风险相对较低，因为用户通常会查看配置部分，意识到这是一个分析工具，恶意代码会被发现。

考虑到Jupyter Notebook代码的可修改性和用户可能存在的疏忽，以及搜索关键词被篡改的可能，判定存在10%的投毒风险。

**项目地址:** [L4r1k/CitrixNetscalerAnalysis](https://github.com/L4r1k/CitrixNetscalerAnalysis)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #5

**来源**: [CVE-2019-19781-SharpHack_CVE-2019-19781.md](../2019/CVE-2019-19781-SharpHack_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #6

**来源**: [CVE-2019-19781-VladRico_CVE-2019-19781.md](../2019/CVE-2019-19781-VladRico_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问目标设备的Web服务端口（通常是80或443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞，允许未经身份验证的远程攻击者读取敏感文件，甚至执行任意代码。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **目录遍历：** 攻击者利用 `../` 序列来绕过目录访问限制，访问受限目录下的文件。
2.  **模板注入/代码执行：**  通过构造特殊的URL和HTTP头部，尤其是 `NSC_USER` 头部，将恶意命令注入到模板引擎中。Citrix设备会将此命令作为系统命令执行，从而实现远程代码执行。

**POC有效性：**

提供的 Python POC 脚本通过以下步骤来验证和利用该漏洞：

1.  **构建Payload：** `parseCmd` 函数格式化要执行的命令，替换空格和斜杠，以绕过某些过滤。
2.  **发送请求：** 脚本发送两个 HTTP GET 请求，第一个请求利用目录遍历和模板注入设置环境变量，第二个请求触发代码执行，并返回执行结果。
3.  **处理响应：** 脚本检查 HTTP 状态码，以确定漏洞是否成功利用，并打印执行结果。

**投毒风险：**

该代码存在一定的投毒风险，可能性约为10%。
*   **默认代理配置：** 该POC默认使用Tor代理 (`127.0.0.1:9050`)，虽然这可能是为了匿名化攻击者的身份，但也可能被用于隐蔽恶意活动，增加溯源难度。需要用户自行安装和配置Tor，存在钓鱼风险，攻击者可能提供配置错误的Tor安装包。
*   **依赖项：**  POC 依赖于 `requests`、`urllib3` 和 `PySocks` 库。虽然这些库本身是常见的，但攻击者可能会在恶意克隆的仓库中替换这些依赖项，引入恶意代码。
*  **命令执行的风险：** 攻击者使用此POC，可以执行任意命令。虽然这不是POC本身的投毒，但是如果其他人下载了POC，并执行了恶意代码，可能会导致被攻击。
**总结：**

CVE-2019-19781 是一个严重的安全漏洞，需要立即修复。提供的 POC 代码可以有效地验证该漏洞的存在，但也需要注意潜在的投毒风险，使用者需要检查代理设置、依赖项的安全性，并在隔离环境中运行该 POC。

**项目地址:** [VladRico/CVE-2019-19781](https://github.com/VladRico/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #7

**来源**: [CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md](../2019/CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要目标系统运行受影响版本的Citrix ADC或Gateway，并允许通过HTTP(S)访问/vpn路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，攻击者可以通过构造特殊的URL来读取或写入服务器上的任意文件。结合漏洞利用代码分析，攻击者可以通过`POST /vpn/../vpns/portal/scripts/newbm.pl` 接口，利用目录遍历漏洞将恶意代码注入到`/netscaler/portal/templates/RAPIDSAFEGUARD`模板文件中。

`NSC_USER: ../../../netscaler/portal/templates/RAPIDSAFEGUARD`指定了要修改的模板文件。

`desc=[% template.new('BLOCK' = 'print `** Give Command **`') %]` 将webshell写入到`/netscaler/portal/templates/RAPIDSAFEGUARD`。

**Give Command**的位置可以替换成需要执行的系统命令。由于该漏洞可以执行任意代码，因此攻击者可能利用此漏洞植入后门，获取系统权限，或进行其他恶意活动。

**有效性：** 根据漏洞信息和搜索结果，该漏洞在野外已被积极利用，POC代码能够成功执行命令，因此判定该漏洞是有效的。

**投毒风险：** POC本身展示了如何利用漏洞执行任意命令，本身不算是投毒代码。但任何共享的POC都存在被修改并加入恶意代码的风险。该仓库只包含一个README文件和一个POC利用文件，代码量少，投毒风险较低，预估为10%，主要风险在于使用者未经验证直接使用。

**利用方式：**

1.  发送特制的HTTP POST请求到`/vpn/../vpns/portal/scripts/newbm.pl`。
2.  在POST请求中，`NSC_USER`参数用于指定要写入或修改的模板文件，使用目录遍历绕过路径限制。
3.  `desc`参数包含要注入的恶意代码，利用Citrix模板引擎执行任意系统命令。
4.  成功利用后，攻击者可以执行任意系统命令，实现远程代码执行。

**项目地址:** [Vulnmachines/Ctirix_RCE-CVE-2019-19781](https://github.com/Vulnmachines/Ctirix_RCE-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #8

**来源**: [CVE-2019-19781-andripwn_CVE-2019-19781.md](../2019/CVE-2019-19781-andripwn_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #9

**来源**: [CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md](../2019/CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，包括敏感配置文件，进而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送特制的HTTP请求，其中包含目录遍历的payload，例如`../../../../etc/passwd`。
2.  如果Citrix ADC/Gateway设备存在漏洞，它将允许攻击者读取指定的文件。
3.  通过读取敏感配置文件，攻击者可以获取管理员凭据或其他敏感信息。
4.  攻击者可以使用获取的凭据或其他敏感信息来进一步攻击系统，例如执行任意命令。

**关于投毒风险：**

提供的漏洞利用代码实际上是一个用于检查漏洞是否存在而`check-cve-2019-19781`的github仓库，仓库内容是贡献指南和license文件。因此，直接将该代码视为投毒代码是不准确的。但是，任何开源代码都存在潜在的投毒风险，即恶意贡献者可能在代码中插入恶意代码。虽然该仓库由cisagov维护，降低了风险，但是并不能完全排除投毒的可能性。保守估计，存在极低的投毒风险，约为1%。

**项目地址:** [autocode07/cisagov__check-cve-2019-19781.4142e02b](https://github.com/autocode07/cisagov__check-cve-2019-19781.4142e02b)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #10

**来源**: [CVE-2019-19781-chihyeonwon_CVE-2019-19781.md](../2019/CVE-2019-19781-chihyeonwon_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / Remote Code Execution

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历 / 远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 目标系统存在漏洞，攻击者需要网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，未经身份验证的攻击者可以通过发送特制的HTTP请求来读取敏感文件，甚至执行任意代码。根据搜索引擎结果，该漏洞在野外被积极利用。漏洞利用代码显示，它通过操纵`/vpns/`路径，利用`newbm.pl`脚本中的目录遍历缺陷，将恶意XML文件写入到目标系统的`/netscaler/portal/templates/`目录。这个XML文件包含Perl代码，允许攻击者执行任意命令。攻击者首先添加包含恶意代码的书签，然后通过访问该书签对应的XML文件来触发命令执行。该代码有一定的投毒风险，主要体现在以下几个方面：

1.  **依赖性问题**：该POC依赖于目标系统特定的文件路径和脚本。如果目标系统的配置略有不同，POC可能无法正常工作。
2.  **命令执行上下文**：攻击者执行命令的权限取决于Citrix ADC/Gateway进程的运行权限。如果该进程的权限过高，可能导致系统范围的破坏。
3.  **日志和监控**：成功的利用会留下日志记录，使攻击者容易被检测到。为了避免检测，攻击者可能会试图清除日志或采取其他规避措施。
4.  **Perl 代码风险**：perl脚本本身可能存在其他安全问题，或者被用于执行其他恶意活动。

**利用方式：**

1.  发送包含目录遍历序列（例如`../`）的恶意HTTP请求到`/vpns/`路径下的某个易受攻击的脚本（例如`newbm.pl`）。
2.  通过构造特殊的`NSC_USER`头和`url`参数，将包含Perl代码的XML文件写入到目标系统的模板目录。
3.  访问写入的XML文件，触发Perl代码执行，从而执行任意命令。

根据CVE信息以及搜索引擎结果，该漏洞影响范围较广，危害性高。根据CISA的known exploited vulnerabilities catalog，该漏洞已被列入CISA, 积极被利用。

**项目地址:** [chihyeonwon/CVE-2019-19781](https://github.com/chihyeonwon/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #11

**来源**: [CVE-2019-19781-cisagov_check-cve-2019-19781.md](../2019/CVE-2019-19781-cisagov_check-cve-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能通过上传恶意文件执行远程代码。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在野外利用。多个安全厂商的报告证实了该漏洞的活跃利用情况。

**投毒风险:**
提供的漏洞利用代码是关于如何为此漏洞创建一个检测脚本的开发环境, 属于开发环境配置说明文档，**不包含任何直接利用漏洞或恶意代码。所以投毒风险较低。**

**利用方式:**
攻击者可以通过构造包含目录遍历序列（例如，`../`）的恶意URL请求，绕过访问控制，读取或写入受限目录中的文件。结合其他漏洞或配置缺陷，攻击者可能利用此漏洞执行任意代码。

**风险缓解措施:**
*   尽快升级到Citrix官方发布的修复版本。
*   实施Web应用防火墙（WAF）规则，阻止包含目录遍历序列的请求。
*   监控系统日志，检测异常的目录访问行为。

**参考链接:**
*   [CVE-2019-19781 Detail - NVD](https://nvd.nist.gov/vuln/detail/cve-2019-19781)
*   [Active Exploitation of Citrix NetScaler (CVE-2019-19781)](http://www.rapid7.com/blog/post/2020/01/17/active-exploitation-of-citrix-netscaler-cve-2019-19781-what-you-need-to-know/)
*   [Exploits in the Wild for Citrix ADC and Citrix Gateway Directory ...](https://unit42.paloaltonetworks.com/exploits-in-the-wild-for-citrix-adc-and-citrix-gateway-directory-traversal-vulnerability-cve-2019-19781/)

**项目地址:** [cisagov/check-cve-2019-19781](https://github.com/cisagov/check-cve-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #12

**来源**: [CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感信息。漏洞的利用方式通常是构造包含目录遍历字符（如`../`）的恶意URL，从而绕过服务器的安全检查，访问受限目录。根据搜索结果，此漏洞已被广泛利用，并出现了很多相关的POC和利用工具。提供的“漏洞利用代码”实际上是一个FireEye发布的IOC扫描器，用于检测是否已被入侵，并非直接的漏洞利用代码。但是它侧面证明了漏洞的可利用性。投毒风险存在于IOC扫描器本身，虽然是FireEye发布，但仍然存在被篡改或植入恶意代码的可能性，但考虑到FireEye的信誉和代码审查，风险较低，估计为10%。实际的利用方式通常结合目录遍历读取敏感文件，然后配合其他漏洞实现远程代码执行，例如通过上传恶意模板文件。

**项目地址:** [citrix/ioc-scanner-CVE-2019-19781](https://github.com/citrix/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #13

**来源**: [CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #14

**来源**: [CVE-2019-19781-haxrob_CVE-2019-19781.md](../2019/CVE-2019-19781-haxrob_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络可达，目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix Application Delivery Controller (ADC) 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的任意文件，甚至执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（DFIR Notes），该漏洞的POC是有效的，并且已经被广泛利用。搜索结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析报告和检测工具。

**投毒风险评估：**

提供的代码主要是DFIR (Digital Forensics and Incident Response) Notes，旨在帮助安全人员检测和分析受影响的系统，而不是直接的攻击代码。其中包含了一些检测compromise indicators的命令和步骤，例如检查HTTP日志、修改的文件、cronjobs、运行的进程以及bash历史等。也提到Fireeye发布了检测工具。虽然大部分内容是用于安全分析，但也不排除作者在其中加入一些看似无害但实际有害的代码，所以存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **目录遍历：** 攻击者利用目录遍历漏洞，可以访问受限制的目录和文件。
2.  **读取敏感文件：** 攻击者可以读取配置文件（如smb.conf）或其他包含敏感信息的关键文件。
3.  **远程代码执行：**  攻击者可能结合其他漏洞，例如通过上传恶意文件到可执行目录下，最终实现远程代码执行。
4.  **后门植入：** 攻击者可能会在受影响的系统上植入后门，以便长期控制系统。搜索结果提到`NOTROBIN`恶意软件利用了这个漏洞，并且存在恶意行为者阻止其他成功利用该漏洞。Fireeye也检测到了利用单个`POST`请求进行漏洞利用和植入后门的攻击。

漏洞利用代码 (DFIR Notes) 提供的检测手段：

*   检查HTTP日志文件，寻找异常请求。
*   检查指定日期后修改的文件，特别是`/netscaler/portal/templates/`、`/var/tmp/netscaler/portal/templates/`和`/var/vpn/bookmark/`目录下新建的`.xml`文件。
*   检查所有用户的cronjobs，寻找可疑的定时任务。
*   检查所有运行的进程和TCP/UDP连接，寻找可疑的进程和服务。
*   检查bash历史记录，寻找可疑的命令。
*   使用Shodan搜索暴露的Citrix NetScaler实例。
*   使用`curl`命令快速判断主机是否可被利用，即 `curl 'https://host/vpn/../vpns/cfg/smb.conf' --path-as-is`。


**项目地址:** [haxrob/CVE-2019-19781](https://github.com/haxrob/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #15

**来源**: [CVE-2019-19781-hyunjin0334_CVE-2019-19781.md](../2019/CVE-2019-19781-hyunjin0334_CVE-2019-19781.md)

# CVE-2019-19781

> 📦 该CVE有 **27** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-19781-0xams_citrixvulncheck.md](../2019/CVE-2019-19781-0xams_citrixvulncheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，甚至可能执行任意代码。多个安全研究报告表明该漏洞已在野外被积极利用。

提供的PoC代码 `citrix-recon.py` 脚本本身是一个漏洞扫描器，用于检测目标是否存在CVE-2019-19781漏洞，而非漏洞利用程序。它使用 `assetfinder` 和 `amass` 等工具来枚举目标域的子域名，并检查这些子域名对应的服务器是否容易受到攻击。脚本首先会尝试获取目标的ASN号码和CIDR范围，然后使用这些信息枚举子域名。然后，它会检查这些子域名是否易受攻击。

**有效性:**  从搜索结果来看，存在CVE-2019-19781的exp。提供的`citrix-recon.py`脚本的主要作用是扫描，需要配合其他exp。

**投毒风险:**  分析提供的`citrix-recon.py`代码，该脚本主要功能是枚举子域名并检测漏洞，未发现直接的恶意代码或后门。但是，由于脚本使用了外部工具（`assetfinder`和`amass`），如果这些工具本身被篡改或包含恶意代码，则可能存在间接的投毒风险。此外，脚本将结果写入文件，如果后续利用这些文件进行攻击，那么对结果文件的篡改也可能构成投毒。因此，我评估的投毒风险为10%，主要来自于对外部工具和结果文件可能被篡改的考虑。

**利用方式:**

1.  **目录遍历：** 攻击者利用目录遍历漏洞读取服务器上的敏感文件，例如配置文件、密码文件等。
2.  **远程代码执行：** 通过目录遍历漏洞上传恶意文件，例如webshell，然后在服务器上执行任意代码。搜索结果中提到了利用Perl脚本附加XML文件到受害者机器上，最终实现RCE。

总而言之，CVE-2019-19781是一个严重的安全漏洞，应尽快修复。该脚本本身是一个PoC工具，用于扫描目标，并不能直接利用。


**项目地址:** [0xams/citrixvulncheck](https://github.com/0xams/citrixvulncheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #2

**来源**: [CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md](../2019/CVE-2019-19781-Azeemering_CVE-2019-19781-DFIR-Notes.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以利用此漏洞执行任意代码。

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，通过构造恶意的URL，攻击者可以读取或写入任意文件，从而实现远程代码执行。根据搜索结果和漏洞利用代码，此漏洞已被广泛利用，多个恶意软件家族（如NOTROBIN）也利用此漏洞进行攻击。

漏洞利用代码（README.md）本身主要是DFIR的checklist，用于检测是否遭受攻击，并没有直接提供EXP代码，但里面包含大量的IOC信息以及检查项目，这些信息可被用于攻击后的分析和排查。README中虽然没有直接的攻击载荷，但它为攻击者提供了便利，从而大大降低了攻击利用的门槛。

**有效性：**
漏洞库信息和搜索结果表明此漏洞的利用是有效的。已经有多个公开可用的漏洞利用代码和攻击事件发生。

**投毒风险：**
提供的README.md文件主要包含用于检测和缓解此漏洞的IOC和checklist。但是，由于代码仓库的性质，始终存在作者（或恶意贡献者）在其他文件中引入恶意代码的风险。但就这个README.md文件本身而言，并没有明显的投毒迹象。风险评估为10%。这个风险主要来自以下几个方面：

*   **供应链攻击：** 依赖于该代码仓库的其他项目可能受到影响。
*   **信息误导：** 提供不准确的IOC可能导致安全分析师做出错误的判断。
*   **未来更新：** 未来的更新可能包含恶意代码。

**利用方式：**
1.  **目录遍历：** 攻击者利用`../`等字符在URL中进行目录跳转，访问受保护的系统文件。
2.  **文件写入：** 通过目录遍历，攻击者可以将恶意文件（如webshell）写入到Web服务器可访问的目录中。
3.  **远程代码执行：** 攻击者通过访问写入的webshell，执行任意系统命令。

**项目地址:** [Azeemering/CVE-2019-19781-DFIR-Notes](https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #3

**来源**: [CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md](../2019/CVE-2019-19781-DanielWep_CVE-NetScalerFileSystemCheck.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历/RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问目标Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。未经身份验证的远程攻击者可以通过构造特制的URL，利用此漏洞读取服务器上的任意文件或者执行任意命令。 

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是一个高危漏洞，并且存在公开的漏洞利用代码，因此判断该漏洞利用是有效的。

**投毒风险分析：**
提供的两个脚本 (`CVE-NetScalerFileSystemCheck.ps1` 和 `CVE-NetScalerFileSystemCheck.sh`) 旨在检查系统是否已经被CVE-2019-19781攻击利用，并收集文件系统信息，以帮助安全分析人员进行安全事件响应。脚本本身的行为是收集信息，但是存在一定的投毒风险。主要风险点如下：

1.  **凭据泄露风险：** PowerShell脚本 `CVE-NetScalerFileSystemCheck.ps1` 会提示用户输入用户名和密码，并将密码以明文形式写入临时文件 `$env:TEMP\login.txt`。虽然脚本在后续尝试删除该文件，但是仍然存在密码在短时间内暴露的风险。如果攻击者控制了运行该脚本的系统，就可能获取到管理员的密码。这部分风险大约占2%。
2.  **Plink依赖风险：** 脚本依赖于 `plink.exe` 来远程执行命令。如果提供的 `plink.exe` 被替换为恶意版本，则可能导致远程代码执行，但这个不属于本脚本的投毒行为，属于使用者环境安全问题.
3.  **结果文件风险：** 脚本会将收集到的信息写入到 `output.log` 文件中。如果收集到的信息包含敏感数据，而此文件被意外泄露或被未经授权的访问，则可能导致信息泄露。这部分风险大约占3%。

总的来说，脚本的主要目的是安全检测，但存在一些潜在的风险点，需要谨慎使用。

**利用方式分析：**
1.  **目录遍历：** 通过构造包含`../`的URL，攻击者可以访问受限制目录之外的文件。
2.  **远程代码执行：** 利用目录遍历漏洞，上传恶意文件（如webshell）到服务器，然后通过访问上传的文件来执行恶意代码。
3.  **信息泄露：** 攻击者可以利用目录遍历读取服务器上的配置文件、日志文件等敏感信息。

**项目地址:** [DanielWep/CVE-NetScalerFileSystemCheck](https://github.com/DanielWep/CVE-NetScalerFileSystemCheck)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #4

**来源**: [CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md](../2019/CVE-2019-19781-L4r1k_CitrixNetscalerAnalysis.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至结合其他漏洞实现远程代码执行。根据搜索结果，此漏洞在野外被广泛利用，并与NOTROBIN恶意软件有关联。提供的POC代码（Citrix NetScaler Analysis.ipynb）是一个Jupyter Notebook，旨在帮助分析受影响的Citrix设备的日志和模板文件，以检测漏洞利用的痕迹。它本身并非直接的漏洞利用代码，而是一个分析工具，通过搜索特定关键词（如'nobody'用户执行的命令）来识别潜在的入侵行为。因此，不能简单地说该POC“有效”，而是说该工具可以有效辅助漏洞利用后的分析和检测。

**利用方式：**

1.  **目录遍历：** 攻击者发送特制的HTTP请求，包含目录遍历序列（例如`../`），以访问受限目录之外的文件。
2.  **文件读取：** 成功利用目录遍历漏洞后，攻击者可以读取系统配置文件、日志文件或其他敏感信息。
3.  **远程代码执行：**  结合其他漏洞（例如模板注入），攻击者可以将恶意代码写入到服务器上的文件中，然后通过目录遍历漏洞访问并执行这些文件，从而实现远程代码执行。
4.  **日志分析和检测：**  提供的POC代码是一个分析工具，可以帮助安全分析师检查Citrix设备的日志文件，搜索与CVE-2019-19781漏洞利用相关的可疑活动。

**投毒风险分析：**

该POC代码的主要功能是日志和配置文件分析，用于检测漏洞利用的痕迹，而不是直接利用漏洞。代码中包含大量搜索关键词，例如搜索'nobody'用户执行的命令。虽然工具本身是为了安全分析而设计的，但如果攻击者修改了这些关键词列表，可能会导致分析结果出现偏差，例如忽略某些关键的攻击特征。此外，Jupyter Notebook代码在执行前可以被修改，因此存在被植入恶意代码的风险。如果用户在不检查代码的情况下直接运行，可能会执行恶意操作。这种风险相对较低，因为用户通常会查看配置部分，意识到这是一个分析工具，恶意代码会被发现。

考虑到Jupyter Notebook代码的可修改性和用户可能存在的疏忽，以及搜索关键词被篡改的可能，判定存在10%的投毒风险。

**项目地址:** [L4r1k/CitrixNetscalerAnalysis](https://github.com/L4r1k/CitrixNetscalerAnalysis)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #5

**来源**: [CVE-2019-19781-SharpHack_CVE-2019-19781.md](../2019/CVE-2019-19781-SharpHack_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #6

**来源**: [CVE-2019-19781-VladRico_CVE-2019-19781.md](../2019/CVE-2019-19781-VladRico_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问目标设备的Web服务端口（通常是80或443）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞，允许未经身份验证的远程攻击者读取敏感文件，甚至执行任意代码。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。

**漏洞利用方式：**

1.  **目录遍历：** 攻击者利用 `../` 序列来绕过目录访问限制，访问受限目录下的文件。
2.  **模板注入/代码执行：**  通过构造特殊的URL和HTTP头部，尤其是 `NSC_USER` 头部，将恶意命令注入到模板引擎中。Citrix设备会将此命令作为系统命令执行，从而实现远程代码执行。

**POC有效性：**

提供的 Python POC 脚本通过以下步骤来验证和利用该漏洞：

1.  **构建Payload：** `parseCmd` 函数格式化要执行的命令，替换空格和斜杠，以绕过某些过滤。
2.  **发送请求：** 脚本发送两个 HTTP GET 请求，第一个请求利用目录遍历和模板注入设置环境变量，第二个请求触发代码执行，并返回执行结果。
3.  **处理响应：** 脚本检查 HTTP 状态码，以确定漏洞是否成功利用，并打印执行结果。

**投毒风险：**

该代码存在一定的投毒风险，可能性约为10%。
*   **默认代理配置：** 该POC默认使用Tor代理 (`127.0.0.1:9050`)，虽然这可能是为了匿名化攻击者的身份，但也可能被用于隐蔽恶意活动，增加溯源难度。需要用户自行安装和配置Tor，存在钓鱼风险，攻击者可能提供配置错误的Tor安装包。
*   **依赖项：**  POC 依赖于 `requests`、`urllib3` 和 `PySocks` 库。虽然这些库本身是常见的，但攻击者可能会在恶意克隆的仓库中替换这些依赖项，引入恶意代码。
*  **命令执行的风险：** 攻击者使用此POC，可以执行任意命令。虽然这不是POC本身的投毒，但是如果其他人下载了POC，并执行了恶意代码，可能会导致被攻击。
**总结：**

CVE-2019-19781 是一个严重的安全漏洞，需要立即修复。提供的 POC 代码可以有效地验证该漏洞的存在，但也需要注意潜在的投毒风险，使用者需要检查代理设置、依赖项的安全性，并在隔离环境中运行该 POC。

**项目地址:** [VladRico/CVE-2019-19781](https://github.com/VladRico/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #7

**来源**: [CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md](../2019/CVE-2019-19781-Vulnmachines_Ctirix_RCE-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要目标系统运行受影响版本的Citrix ADC或Gateway，并允许通过HTTP(S)访问/vpn路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，攻击者可以通过构造特殊的URL来读取或写入服务器上的任意文件。结合漏洞利用代码分析，攻击者可以通过`POST /vpn/../vpns/portal/scripts/newbm.pl` 接口，利用目录遍历漏洞将恶意代码注入到`/netscaler/portal/templates/RAPIDSAFEGUARD`模板文件中。

`NSC_USER: ../../../netscaler/portal/templates/RAPIDSAFEGUARD`指定了要修改的模板文件。

`desc=[% template.new('BLOCK' = 'print `** Give Command **`') %]` 将webshell写入到`/netscaler/portal/templates/RAPIDSAFEGUARD`。

**Give Command**的位置可以替换成需要执行的系统命令。由于该漏洞可以执行任意代码，因此攻击者可能利用此漏洞植入后门，获取系统权限，或进行其他恶意活动。

**有效性：** 根据漏洞信息和搜索结果，该漏洞在野外已被积极利用，POC代码能够成功执行命令，因此判定该漏洞是有效的。

**投毒风险：** POC本身展示了如何利用漏洞执行任意命令，本身不算是投毒代码。但任何共享的POC都存在被修改并加入恶意代码的风险。该仓库只包含一个README文件和一个POC利用文件，代码量少，投毒风险较低，预估为10%，主要风险在于使用者未经验证直接使用。

**利用方式：**

1.  发送特制的HTTP POST请求到`/vpn/../vpns/portal/scripts/newbm.pl`。
2.  在POST请求中，`NSC_USER`参数用于指定要写入或修改的模板文件，使用目录遍历绕过路径限制。
3.  `desc`参数包含要注入的恶意代码，利用Citrix模板引擎执行任意系统命令。
4.  成功利用后，攻击者可以执行任意系统命令，实现远程代码执行。

**项目地址:** [Vulnmachines/Ctirix_RCE-CVE-2019-19781](https://github.com/Vulnmachines/Ctirix_RCE-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #8

**来源**: [CVE-2019-19781-andripwn_CVE-2019-19781.md](../2019/CVE-2019-19781-andripwn_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #9

**来源**: [CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md](../2019/CVE-2019-19781-autocode07_cisagov__check-cve-2019-19781.4142e02b.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到Citrix ADC/Gateway设备

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，包括敏感配置文件，进而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送特制的HTTP请求，其中包含目录遍历的payload，例如`../../../../etc/passwd`。
2.  如果Citrix ADC/Gateway设备存在漏洞，它将允许攻击者读取指定的文件。
3.  通过读取敏感配置文件，攻击者可以获取管理员凭据或其他敏感信息。
4.  攻击者可以使用获取的凭据或其他敏感信息来进一步攻击系统，例如执行任意命令。

**关于投毒风险：**

提供的漏洞利用代码实际上是一个用于检查漏洞是否存在而`check-cve-2019-19781`的github仓库，仓库内容是贡献指南和license文件。因此，直接将该代码视为投毒代码是不准确的。但是，任何开源代码都存在潜在的投毒风险，即恶意贡献者可能在代码中插入恶意代码。虽然该仓库由cisagov维护，降低了风险，但是并不能完全排除投毒的可能性。保守估计，存在极低的投毒风险，约为1%。

**项目地址:** [autocode07/cisagov__check-cve-2019-19781.4142e02b](https://github.com/autocode07/cisagov__check-cve-2019-19781.4142e02b)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #10

**来源**: [CVE-2019-19781-chihyeonwon_CVE-2019-19781.md](../2019/CVE-2019-19781-chihyeonwon_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / Remote Code Execution

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历 / 远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 目标系统存在漏洞，攻击者需要网络访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，未经身份验证的攻击者可以通过发送特制的HTTP请求来读取敏感文件，甚至执行任意代码。根据搜索引擎结果，该漏洞在野外被积极利用。漏洞利用代码显示，它通过操纵`/vpns/`路径，利用`newbm.pl`脚本中的目录遍历缺陷，将恶意XML文件写入到目标系统的`/netscaler/portal/templates/`目录。这个XML文件包含Perl代码，允许攻击者执行任意命令。攻击者首先添加包含恶意代码的书签，然后通过访问该书签对应的XML文件来触发命令执行。该代码有一定的投毒风险，主要体现在以下几个方面：

1.  **依赖性问题**：该POC依赖于目标系统特定的文件路径和脚本。如果目标系统的配置略有不同，POC可能无法正常工作。
2.  **命令执行上下文**：攻击者执行命令的权限取决于Citrix ADC/Gateway进程的运行权限。如果该进程的权限过高，可能导致系统范围的破坏。
3.  **日志和监控**：成功的利用会留下日志记录，使攻击者容易被检测到。为了避免检测，攻击者可能会试图清除日志或采取其他规避措施。
4.  **Perl 代码风险**：perl脚本本身可能存在其他安全问题，或者被用于执行其他恶意活动。

**利用方式：**

1.  发送包含目录遍历序列（例如`../`）的恶意HTTP请求到`/vpns/`路径下的某个易受攻击的脚本（例如`newbm.pl`）。
2.  通过构造特殊的`NSC_USER`头和`url`参数，将包含Perl代码的XML文件写入到目标系统的模板目录。
3.  访问写入的XML文件，触发Perl代码执行，从而执行任意命令。

根据CVE信息以及搜索引擎结果，该漏洞影响范围较广，危害性高。根据CISA的known exploited vulnerabilities catalog，该漏洞已被列入CISA, 积极被利用。

**项目地址:** [chihyeonwon/CVE-2019-19781](https://github.com/chihyeonwon/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #11

**来源**: [CVE-2019-19781-cisagov_check-cve-2019-19781.md](../2019/CVE-2019-19781-cisagov_check-cve-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能通过上传恶意文件执行远程代码。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且存在野外利用。多个安全厂商的报告证实了该漏洞的活跃利用情况。

**投毒风险:**
提供的漏洞利用代码是关于如何为此漏洞创建一个检测脚本的开发环境, 属于开发环境配置说明文档，**不包含任何直接利用漏洞或恶意代码。所以投毒风险较低。**

**利用方式:**
攻击者可以通过构造包含目录遍历序列（例如，`../`）的恶意URL请求，绕过访问控制，读取或写入受限目录中的文件。结合其他漏洞或配置缺陷，攻击者可能利用此漏洞执行任意代码。

**风险缓解措施:**
*   尽快升级到Citrix官方发布的修复版本。
*   实施Web应用防火墙（WAF）规则，阻止包含目录遍历序列的请求。
*   监控系统日志，检测异常的目录访问行为。

**参考链接:**
*   [CVE-2019-19781 Detail - NVD](https://nvd.nist.gov/vuln/detail/cve-2019-19781)
*   [Active Exploitation of Citrix NetScaler (CVE-2019-19781)](http://www.rapid7.com/blog/post/2020/01/17/active-exploitation-of-citrix-netscaler-cve-2019-19781-what-you-need-to-know/)
*   [Exploits in the Wild for Citrix ADC and Citrix Gateway Directory ...](https://unit42.paloaltonetworks.com/exploits-in-the-wild-for-citrix-adc-and-citrix-gateway-directory-traversal-vulnerability-cve-2019-19781/)

**项目地址:** [cisagov/check-cve-2019-19781](https://github.com/cisagov/check-cve-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #12

**来源**: [CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrix_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感信息。漏洞的利用方式通常是构造包含目录遍历字符（如`../`）的恶意URL，从而绕过服务器的安全检查，访问受限目录。根据搜索结果，此漏洞已被广泛利用，并出现了很多相关的POC和利用工具。提供的“漏洞利用代码”实际上是一个FireEye发布的IOC扫描器，用于检测是否已被入侵，并非直接的漏洞利用代码。但是它侧面证明了漏洞的可利用性。投毒风险存在于IOC扫描器本身，虽然是FireEye发布，但仍然存在被篡改或植入恶意代码的可能性，但考虑到FireEye的信誉和代码审查，风险较低，估计为10%。实际的利用方式通常结合目录遍历读取敏感文件，然后配合其他漏洞实现远程代码执行，例如通过上传恶意模板文件。

**项目地址:** [citrix/ioc-scanner-CVE-2019-19781](https://github.com/citrix/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #13

**来源**: [CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-citrixgitoff_-ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #14

**来源**: [CVE-2019-19781-haxrob_CVE-2019-19781.md](../2019/CVE-2019-19781-haxrob_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络可达，目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix Application Delivery Controller (ADC) 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的任意文件，甚至执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（DFIR Notes），该漏洞的POC是有效的，并且已经被广泛利用。搜索结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析报告和检测工具。

**投毒风险评估：**

提供的代码主要是DFIR (Digital Forensics and Incident Response) Notes，旨在帮助安全人员检测和分析受影响的系统，而不是直接的攻击代码。其中包含了一些检测compromise indicators的命令和步骤，例如检查HTTP日志、修改的文件、cronjobs、运行的进程以及bash历史等。也提到Fireeye发布了检测工具。虽然大部分内容是用于安全分析，但也不排除作者在其中加入一些看似无害但实际有害的代码，所以存在一定的投毒风险，估计为10%。

**利用方式：**

1.  **目录遍历：** 攻击者利用目录遍历漏洞，可以访问受限制的目录和文件。
2.  **读取敏感文件：** 攻击者可以读取配置文件（如smb.conf）或其他包含敏感信息的关键文件。
3.  **远程代码执行：**  攻击者可能结合其他漏洞，例如通过上传恶意文件到可执行目录下，最终实现远程代码执行。
4.  **后门植入：** 攻击者可能会在受影响的系统上植入后门，以便长期控制系统。搜索结果提到`NOTROBIN`恶意软件利用了这个漏洞，并且存在恶意行为者阻止其他成功利用该漏洞。Fireeye也检测到了利用单个`POST`请求进行漏洞利用和植入后门的攻击。

漏洞利用代码 (DFIR Notes) 提供的检测手段：

*   检查HTTP日志文件，寻找异常请求。
*   检查指定日期后修改的文件，特别是`/netscaler/portal/templates/`、`/var/tmp/netscaler/portal/templates/`和`/var/vpn/bookmark/`目录下新建的`.xml`文件。
*   检查所有用户的cronjobs，寻找可疑的定时任务。
*   检查所有运行的进程和TCP/UDP连接，寻找可疑的进程和服务。
*   检查bash历史记录，寻找可疑的命令。
*   使用Shodan搜索暴露的Citrix NetScaler实例。
*   使用`curl`命令快速判断主机是否可被利用，即 `curl 'https://host/vpn/../vpns/cfg/smb.conf' --path-as-is`。


**项目地址:** [haxrob/CVE-2019-19781](https://github.com/haxrob/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #15

**来源**: [CVE-2019-19781-hyunjin0334_CVE-2019-19781.md](../2019/CVE-2019-19781-hyunjin0334_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix Application Delivery Controller (ADC) 和 Gateway中的目录遍历漏洞。 

**有效性：**
根据搜索结果，该漏洞已被广泛利用，并有公开的PoC。虽然提供的PoC代码只有一个简单的README文件，说明这只是一个作业，但也暗示存在更完整的攻击利用代码，结合其他信息来源，判断存在有效的漏洞利用。

**投毒风险：**
提供的PoC代码非常简单，仅包含一个README.md文件，该文件只是描述了PoC的基本信息，没有发现任何恶意代码。因此，直接的投毒风险很低。但是，不能完全排除风险，因为可能存在其他未公开的利用方式。综合评估，投毒风险约为10%。

**利用方式：**
根据漏洞库信息和搜索结果，利用方式是通过构造恶意的URL，利用目录遍历漏洞读取或写入受限文件，最终可能导致远程代码执行。
搜索结果提到利用Perl脚本将XML文件附加到受害者机器，这可能是远程代码执行的一种方式。
具体利用步骤可能如下：
1.  发送包含目录遍历payload的HTTP请求。
2.  利用漏洞读取敏感配置文件，获取凭据或其他敏感信息。
3.  写入恶意文件（例如，通过Perl脚本附加XML文件）。
4.  执行恶意文件，实现远程代码执行。

**项目地址:** [hyunjin0334/CVE-2019-19781](https://github.com/hyunjin0334/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #16

**来源**: [CVE-2019-19781-j81blog_ADC-19781.md](../2019/CVE-2019-19781-j81blog_ADC-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #17

**来源**: [CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md](../2019/CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到存在漏洞的Citrix ADC/Gateway服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞，未经身份验证的攻击者可利用此漏洞读取任意文件，甚至可以结合其他技术实现远程代码执行。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以进行如下分析：

1. **有效性：**
   根据搜索引擎结果（Rapid7, Palo Alto Networks, CISA 等）以及漏洞利用代码仓库的描述，该漏洞已被广泛利用，证明了POC的有效性。

2. **投毒风险：**
   提供的`shitrix.sh`脚本通过构造恶意请求头，利用目录遍历读取`/netscaler/portal/templates/`目录下的文件，并执行其中的代码。脚本包含如下操作：
    * 生成随机字符串作为文件名。
    * 对要执行的命令进行Base64编码和URL编码。
    * 使用`curl`发送POST和GET请求，其中包含了精心构造的`NSC_USER`头，利用了template injection的漏洞。
   该脚本本身的目的就是进行漏洞利用，风险主要来源于脚本本身，而非额外的投毒代码。但如果该代码仓库被恶意修改，或者攻击者使用该脚本执行恶意命令，则可能造成投毒。例如，使用该漏洞在目标系统上安装后门。由于脚本代码量不大，人工审核较为容易，故投毒风险较低，初步评估为1%。

3. **利用方式：**
   利用方式主要分为以下几个步骤：
    1.  **目录遍历：** 通过构造包含`../../`的路径，访问到`/netscaler/portal/templates/`目录下的任意文件。
    2.  **模板注入：**  通过`NSC_USER`请求头，向目标服务器注入恶意模板代码，这些代码会被服务器解析执行。
    3.  **远程代码执行：**  利用模板引擎的特性，执行任意系统命令。具体来说，`shitrix.sh`脚本首先将要执行的命令进行Base64编码，然后利用`echo`和`b64decode`命令解码并执行。
    4.  **具体实现：** 脚本通过构造恶意请求，将命令注入到模板中，并通过curl发送请求。服务器在处理请求时，会解析模板并执行其中的命令，从而实现远程代码执行。

4.  **排序优先级：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jamesjguthrie/Shitrix-CVE-2019-19781](https://github.com/jamesjguthrie/Shitrix-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #18

**来源**: [CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md](../2019/CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #19

**来源**: [CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC)和Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。未经身份验证的攻击者可以通过构造特殊的URL，利用此漏洞读取服务器上的任意文件，甚至执行任意代码。搜索引擎结果和漏洞库信息都表明该漏洞的CVSS评分很高，并且已被广泛利用。

**有效性：**
根据搜索结果，该漏洞已被积极利用。多个安全厂商（如Rapid7, Palo Alto Networks, Mandiant/FireEye）都发布了相关的分析报告和检测工具。因此，可以判断存在有效的POC代码。

**投毒风险：**
提供的漏洞利用代码（FAQ.md）实际上是FireEye发布的IOC扫描工具的说明文档，用于检测是否已经遭受CVE-2019-19781漏洞的攻击，而不是漏洞利用代码本身。这个仓库本身是一个安全工具，可以检测已经发生的安全事件。存在投毒的可能性比较小。但依旧不能排除作者在该工具的更新中加入恶意代码的可能，因此投毒风险为10%。

**利用方式：**
1.  **目录遍历：** 攻击者发送包含恶意构造的URL的HTTP请求到目标Citrix ADC或Gateway设备。
2.  **文件读取：** 利用目录遍历漏洞，攻击者可以读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
3.  **远程代码执行：** 结合其他漏洞或者通过上传恶意文件，攻击者可以在服务器上执行任意代码，完全控制系统。

综上，CVE-2019-19781是一个严重的安全漏洞，需要及时修补。尽管提供的代码片段是检测工具，但实际环境中存在大量可用的POC代码，使得漏洞利用变得容易。务必使用官方补丁或缓解措施进行修复。

**项目地址:** [mandiant/ioc-scanner-CVE-2019-19781](https://github.com/mandiant/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #20

**来源**: [CVE-2019-19781-mpgn_CVE-2019-19781.md](../2019/CVE-2019-19781-mpgn_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #21

**来源**: [CVE-2019-19781-nmanzi_webcvescanner.md](../2019/CVE-2019-19781-nmanzi_webcvescanner.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至可能导致远程代码执行。搜索结果表明，该漏洞在野外被广泛利用，并被用于传播恶意软件。提供的漏洞利用代码仅为GNU GPL许可协议文本，并非实际的漏洞利用代码，因此无法判断漏洞利用代码的有效性。但考虑到漏洞的严重性和广泛的利用情况，可以认为有效的POC是存在的。

**有效性：**根据搜索结果，该漏洞存在有效的POC，且已被广泛利用。

**投毒风险：**提供的代码为GNU GPL许可协议，因此投毒风险为0%。实际利用时需要其他exp，需注意exp的来源是否安全可靠。

**利用方式：**攻击者发送包含特殊构造的目录遍历序列的HTTP请求到Citrix ADC或Gateway服务器。如果服务器未正确验证请求中的路径，则会允许攻击者访问受限目录之外的文件。该漏洞可以结合其他漏洞，例如上传漏洞，实现远程代码执行。

**项目地址:** [nmanzi/webcvescanner](https://github.com/nmanzi/webcvescanner)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #22

**来源**: [CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md](../2019/CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #23

**来源**: [CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md](../2019/CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #24

**来源**: [CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md](../2019/CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md)

## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #25

**来源**: [CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md](../2019/CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞。攻击者可以利用此漏洞读取任意文件或执行任意命令，从而完全控制受影响的系统。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断提供的POC代码是有效的。搜索结果中多个链接提到该漏洞在野外被积极利用，并且有远程代码执行的利用方式。

**投毒风险：**
*   **代码分析：** POC代码的主要功能是利用目录遍历漏洞，通过构造特殊的HTTP请求，将命令注入到模板中执行。代码中包含绕过正斜杠过滤的逻辑，将 `/` 替换为 `\$(printf \$HOME)`。
*   **潜在风险：** 尽管POC代码的主要功能是漏洞利用，但仍存在一定的投毒风险：
    1.  **依赖性：** POC代码依赖于Python2，这本身可能不是一个直接的投毒，但使用过时的依赖可能引入安全风险。
    2.  **错误处理：** 代码中的异常处理部分相对简单，可能会隐藏一些错误或异常，导致利用过程中的意外行为。
    3.  **参数传递：** 代码中直接使用`raw_input()`获取用户输入的命令，未进行充分的输入验证和过滤，可能被利用执行恶意命令。通过修改`cmd`变量，可以执行任意命令，这本身就是漏洞利用的核心，但也为投毒提供了可能性。攻击者可能会伪装成漏洞研究人员，分享包含恶意命令的POC。
    4.  **模板注入：** 通过模板注入执行命令，如果模板引擎存在其他未知的漏洞，也可能被利用进行更深层次的攻击。

综合考虑，虽然POC的主要目的是为了利用漏洞，但由于用户输入未经过滤，以及对Python2的依赖，依旧存在一定的投毒风险。因此，投毒风险评估为10%。这10%主要来源于代码可能存在不明显的漏洞和依赖风险，以及攻击者可能利用用户输入命令进行投毒的场景。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者发送包含特殊构造的URL的HTTP GET请求，该URL包含目录遍历序列和模板注入代码。
2.  **绕过过滤：**  如果目标系统存在对特殊字符的过滤（如正斜杠），攻击者需要使用相应的绕过技术，例如使用`\$(printf \$HOME)`代替`/`。
3.  **命令注入：** 通过模板注入，将需要执行的命令注入到Citrix ADC或Gateway服务器的上下文中。
4.  **远程代码执行：**  服务器执行注入的命令，攻击者从而获得在服务器上执行任意代码的能力。

**项目地址:** [w4fz5uck5/CVE-2019-19781-CitrixRCE](https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #26

**来源**: [CVE-2019-19781-yukar1z0e_CVE-2019-19781.md](../2019/CVE-2019-19781-yukar1z0e_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的 URL 来读取服务器上的任意文件，甚至可能执行任意代码。提供的“漏洞利用代码” 实际上只是 Apache 2.0 许可证，本身不包含漏洞利用代码，因此无法直接评估其有效性和投毒风险。但是，搜索结果中指向的Packetstorm Security 上的链接表明存在公开的利用代码和利用方法。利用方式通常涉及构造包含“../”序列的URL，以绕过路径验证，访问受限目录之外的文件。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，以及大量关于其在野利用的报告，可以推断出漏洞利用的有效性较高。由于提供的代码是许可协议而非实际漏洞利用代码，因此投毒风险为0%。利用方式是通过构造恶意的HTTP请求，包含目录遍历的payload，发送到目标Citrix ADC或Gateway服务器，从而读取敏感文件或执行恶意代码。

**项目地址:** [yukar1z0e/CVE-2019-19781](https://github.com/yukar1z0e/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #27

**来源**: [CVE-2019-19781-zerobytesecure_CVE-2019-19781.md](../2019/CVE-2019-19781-zerobytesecure_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---



---

## POC #16

**来源**: [CVE-2019-19781-j81blog_ADC-19781.md](../2019/CVE-2019-19781-j81blog_ADC-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #17

**来源**: [CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md](../2019/CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到存在漏洞的Citrix ADC/Gateway服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞，未经身份验证的攻击者可利用此漏洞读取任意文件，甚至可以结合其他技术实现远程代码执行。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以进行如下分析：

1. **有效性：**
   根据搜索引擎结果（Rapid7, Palo Alto Networks, CISA 等）以及漏洞利用代码仓库的描述，该漏洞已被广泛利用，证明了POC的有效性。

2. **投毒风险：**
   提供的`shitrix.sh`脚本通过构造恶意请求头，利用目录遍历读取`/netscaler/portal/templates/`目录下的文件，并执行其中的代码。脚本包含如下操作：
    * 生成随机字符串作为文件名。
    * 对要执行的命令进行Base64编码和URL编码。
    * 使用`curl`发送POST和GET请求，其中包含了精心构造的`NSC_USER`头，利用了template injection的漏洞。
   该脚本本身的目的就是进行漏洞利用，风险主要来源于脚本本身，而非额外的投毒代码。但如果该代码仓库被恶意修改，或者攻击者使用该脚本执行恶意命令，则可能造成投毒。例如，使用该漏洞在目标系统上安装后门。由于脚本代码量不大，人工审核较为容易，故投毒风险较低，初步评估为1%。

3. **利用方式：**
   利用方式主要分为以下几个步骤：
    1.  **目录遍历：** 通过构造包含`../../`的路径，访问到`/netscaler/portal/templates/`目录下的任意文件。
    2.  **模板注入：**  通过`NSC_USER`请求头，向目标服务器注入恶意模板代码，这些代码会被服务器解析执行。
    3.  **远程代码执行：**  利用模板引擎的特性，执行任意系统命令。具体来说，`shitrix.sh`脚本首先将要执行的命令进行Base64编码，然后利用`echo`和`b64decode`命令解码并执行。
    4.  **具体实现：** 脚本通过构造恶意请求，将命令注入到模板中，并通过curl发送请求。服务器在处理请求时，会解析模板并执行其中的命令，从而实现远程代码执行。

4.  **排序优先级：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jamesjguthrie/Shitrix-CVE-2019-19781](https://github.com/jamesjguthrie/Shitrix-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #18

**来源**: [CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md](../2019/CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #19

**来源**: [CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC)和Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。未经身份验证的攻击者可以通过构造特殊的URL，利用此漏洞读取服务器上的任意文件，甚至执行任意代码。搜索引擎结果和漏洞库信息都表明该漏洞的CVSS评分很高，并且已被广泛利用。

**有效性：**
根据搜索结果，该漏洞已被积极利用。多个安全厂商（如Rapid7, Palo Alto Networks, Mandiant/FireEye）都发布了相关的分析报告和检测工具。因此，可以判断存在有效的POC代码。

**投毒风险：**
提供的漏洞利用代码（FAQ.md）实际上是FireEye发布的IOC扫描工具的说明文档，用于检测是否已经遭受CVE-2019-19781漏洞的攻击，而不是漏洞利用代码本身。这个仓库本身是一个安全工具，可以检测已经发生的安全事件。存在投毒的可能性比较小。但依旧不能排除作者在该工具的更新中加入恶意代码的可能，因此投毒风险为10%。

**利用方式：**
1.  **目录遍历：** 攻击者发送包含恶意构造的URL的HTTP请求到目标Citrix ADC或Gateway设备。
2.  **文件读取：** 利用目录遍历漏洞，攻击者可以读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
3.  **远程代码执行：** 结合其他漏洞或者通过上传恶意文件，攻击者可以在服务器上执行任意代码，完全控制系统。

综上，CVE-2019-19781是一个严重的安全漏洞，需要及时修补。尽管提供的代码片段是检测工具，但实际环境中存在大量可用的POC代码，使得漏洞利用变得容易。务必使用官方补丁或缓解措施进行修复。

**项目地址:** [mandiant/ioc-scanner-CVE-2019-19781](https://github.com/mandiant/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #20

**来源**: [CVE-2019-19781-mpgn_CVE-2019-19781.md](../2019/CVE-2019-19781-mpgn_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #21

**来源**: [CVE-2019-19781-nmanzi_webcvescanner.md](../2019/CVE-2019-19781-nmanzi_webcvescanner.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至可能导致远程代码执行。搜索结果表明，该漏洞在野外被广泛利用，并被用于传播恶意软件。提供的漏洞利用代码仅为GNU GPL许可协议文本，并非实际的漏洞利用代码，因此无法判断漏洞利用代码的有效性。但考虑到漏洞的严重性和广泛的利用情况，可以认为有效的POC是存在的。

**有效性：**根据搜索结果，该漏洞存在有效的POC，且已被广泛利用。

**投毒风险：**提供的代码为GNU GPL许可协议，因此投毒风险为0%。实际利用时需要其他exp，需注意exp的来源是否安全可靠。

**利用方式：**攻击者发送包含特殊构造的目录遍历序列的HTTP请求到Citrix ADC或Gateway服务器。如果服务器未正确验证请求中的路径，则会允许攻击者访问受限目录之外的文件。该漏洞可以结合其他漏洞，例如上传漏洞，实现远程代码执行。

**项目地址:** [nmanzi/webcvescanner](https://github.com/nmanzi/webcvescanner)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #22

**来源**: [CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md](../2019/CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #23

**来源**: [CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md](../2019/CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #24

**来源**: [CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md](../2019/CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md)

## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #25

**来源**: [CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md](../2019/CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞。攻击者可以利用此漏洞读取任意文件或执行任意命令，从而完全控制受影响的系统。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断提供的POC代码是有效的。搜索结果中多个链接提到该漏洞在野外被积极利用，并且有远程代码执行的利用方式。

**投毒风险：**
*   **代码分析：** POC代码的主要功能是利用目录遍历漏洞，通过构造特殊的HTTP请求，将命令注入到模板中执行。代码中包含绕过正斜杠过滤的逻辑，将 `/` 替换为 `\$(printf \$HOME)`。
*   **潜在风险：** 尽管POC代码的主要功能是漏洞利用，但仍存在一定的投毒风险：
    1.  **依赖性：** POC代码依赖于Python2，这本身可能不是一个直接的投毒，但使用过时的依赖可能引入安全风险。
    2.  **错误处理：** 代码中的异常处理部分相对简单，可能会隐藏一些错误或异常，导致利用过程中的意外行为。
    3.  **参数传递：** 代码中直接使用`raw_input()`获取用户输入的命令，未进行充分的输入验证和过滤，可能被利用执行恶意命令。通过修改`cmd`变量，可以执行任意命令，这本身就是漏洞利用的核心，但也为投毒提供了可能性。攻击者可能会伪装成漏洞研究人员，分享包含恶意命令的POC。
    4.  **模板注入：** 通过模板注入执行命令，如果模板引擎存在其他未知的漏洞，也可能被利用进行更深层次的攻击。

综合考虑，虽然POC的主要目的是为了利用漏洞，但由于用户输入未经过滤，以及对Python2的依赖，依旧存在一定的投毒风险。因此，投毒风险评估为10%。这10%主要来源于代码可能存在不明显的漏洞和依赖风险，以及攻击者可能利用用户输入命令进行投毒的场景。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者发送包含特殊构造的URL的HTTP GET请求，该URL包含目录遍历序列和模板注入代码。
2.  **绕过过滤：**  如果目标系统存在对特殊字符的过滤（如正斜杠），攻击者需要使用相应的绕过技术，例如使用`\$(printf \$HOME)`代替`/`。
3.  **命令注入：** 通过模板注入，将需要执行的命令注入到Citrix ADC或Gateway服务器的上下文中。
4.  **远程代码执行：**  服务器执行注入的命令，攻击者从而获得在服务器上执行任意代码的能力。

**项目地址:** [w4fz5uck5/CVE-2019-19781-CitrixRCE](https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #26

**来源**: [CVE-2019-19781-yukar1z0e_CVE-2019-19781.md](../2019/CVE-2019-19781-yukar1z0e_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的 URL 来读取服务器上的任意文件，甚至可能执行任意代码。提供的“漏洞利用代码” 实际上只是 Apache 2.0 许可证，本身不包含漏洞利用代码，因此无法直接评估其有效性和投毒风险。但是，搜索结果中指向的Packetstorm Security 上的链接表明存在公开的利用代码和利用方法。利用方式通常涉及构造包含“../”序列的URL，以绕过路径验证，访问受限目录之外的文件。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，以及大量关于其在野利用的报告，可以推断出漏洞利用的有效性较高。由于提供的代码是许可协议而非实际漏洞利用代码，因此投毒风险为0%。利用方式是通过构造恶意的HTTP请求，包含目录遍历的payload，发送到目标Citrix ADC或Gateway服务器，从而读取敏感文件或执行恶意代码。

**项目地址:** [yukar1z0e/CVE-2019-19781](https://github.com/yukar1z0e/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #27

**来源**: [CVE-2019-19781-zerobytesecure_CVE-2019-19781.md](../2019/CVE-2019-19781-zerobytesecure_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---



---

## POC #16

**来源**: [CVE-2019-19781-j81blog_ADC-19781.md](../2019/CVE-2019-19781-j81blog_ADC-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #17

**来源**: [CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md](../2019/CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到存在漏洞的Citrix ADC/Gateway服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞，未经身份验证的攻击者可利用此漏洞读取任意文件，甚至可以结合其他技术实现远程代码执行。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以进行如下分析：

1. **有效性：**
   根据搜索引擎结果（Rapid7, Palo Alto Networks, CISA 等）以及漏洞利用代码仓库的描述，该漏洞已被广泛利用，证明了POC的有效性。

2. **投毒风险：**
   提供的`shitrix.sh`脚本通过构造恶意请求头，利用目录遍历读取`/netscaler/portal/templates/`目录下的文件，并执行其中的代码。脚本包含如下操作：
    * 生成随机字符串作为文件名。
    * 对要执行的命令进行Base64编码和URL编码。
    * 使用`curl`发送POST和GET请求，其中包含了精心构造的`NSC_USER`头，利用了template injection的漏洞。
   该脚本本身的目的就是进行漏洞利用，风险主要来源于脚本本身，而非额外的投毒代码。但如果该代码仓库被恶意修改，或者攻击者使用该脚本执行恶意命令，则可能造成投毒。例如，使用该漏洞在目标系统上安装后门。由于脚本代码量不大，人工审核较为容易，故投毒风险较低，初步评估为1%。

3. **利用方式：**
   利用方式主要分为以下几个步骤：
    1.  **目录遍历：** 通过构造包含`../../`的路径，访问到`/netscaler/portal/templates/`目录下的任意文件。
    2.  **模板注入：**  通过`NSC_USER`请求头，向目标服务器注入恶意模板代码，这些代码会被服务器解析执行。
    3.  **远程代码执行：**  利用模板引擎的特性，执行任意系统命令。具体来说，`shitrix.sh`脚本首先将要执行的命令进行Base64编码，然后利用`echo`和`b64decode`命令解码并执行。
    4.  **具体实现：** 脚本通过构造恶意请求，将命令注入到模板中，并通过curl发送请求。服务器在处理请求时，会解析模板并执行其中的命令，从而实现远程代码执行。

4.  **排序优先级：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jamesjguthrie/Shitrix-CVE-2019-19781](https://github.com/jamesjguthrie/Shitrix-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #18

**来源**: [CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md](../2019/CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #19

**来源**: [CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC)和Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。未经身份验证的攻击者可以通过构造特殊的URL，利用此漏洞读取服务器上的任意文件，甚至执行任意代码。搜索引擎结果和漏洞库信息都表明该漏洞的CVSS评分很高，并且已被广泛利用。

**有效性：**
根据搜索结果，该漏洞已被积极利用。多个安全厂商（如Rapid7, Palo Alto Networks, Mandiant/FireEye）都发布了相关的分析报告和检测工具。因此，可以判断存在有效的POC代码。

**投毒风险：**
提供的漏洞利用代码（FAQ.md）实际上是FireEye发布的IOC扫描工具的说明文档，用于检测是否已经遭受CVE-2019-19781漏洞的攻击，而不是漏洞利用代码本身。这个仓库本身是一个安全工具，可以检测已经发生的安全事件。存在投毒的可能性比较小。但依旧不能排除作者在该工具的更新中加入恶意代码的可能，因此投毒风险为10%。

**利用方式：**
1.  **目录遍历：** 攻击者发送包含恶意构造的URL的HTTP请求到目标Citrix ADC或Gateway设备。
2.  **文件读取：** 利用目录遍历漏洞，攻击者可以读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
3.  **远程代码执行：** 结合其他漏洞或者通过上传恶意文件，攻击者可以在服务器上执行任意代码，完全控制系统。

综上，CVE-2019-19781是一个严重的安全漏洞，需要及时修补。尽管提供的代码片段是检测工具，但实际环境中存在大量可用的POC代码，使得漏洞利用变得容易。务必使用官方补丁或缓解措施进行修复。

**项目地址:** [mandiant/ioc-scanner-CVE-2019-19781](https://github.com/mandiant/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #20

**来源**: [CVE-2019-19781-mpgn_CVE-2019-19781.md](../2019/CVE-2019-19781-mpgn_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #21

**来源**: [CVE-2019-19781-nmanzi_webcvescanner.md](../2019/CVE-2019-19781-nmanzi_webcvescanner.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至可能导致远程代码执行。搜索结果表明，该漏洞在野外被广泛利用，并被用于传播恶意软件。提供的漏洞利用代码仅为GNU GPL许可协议文本，并非实际的漏洞利用代码，因此无法判断漏洞利用代码的有效性。但考虑到漏洞的严重性和广泛的利用情况，可以认为有效的POC是存在的。

**有效性：**根据搜索结果，该漏洞存在有效的POC，且已被广泛利用。

**投毒风险：**提供的代码为GNU GPL许可协议，因此投毒风险为0%。实际利用时需要其他exp，需注意exp的来源是否安全可靠。

**利用方式：**攻击者发送包含特殊构造的目录遍历序列的HTTP请求到Citrix ADC或Gateway服务器。如果服务器未正确验证请求中的路径，则会允许攻击者访问受限目录之外的文件。该漏洞可以结合其他漏洞，例如上传漏洞，实现远程代码执行。

**项目地址:** [nmanzi/webcvescanner](https://github.com/nmanzi/webcvescanner)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #22

**来源**: [CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md](../2019/CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #23

**来源**: [CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md](../2019/CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #24

**来源**: [CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md](../2019/CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md)

## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #25

**来源**: [CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md](../2019/CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞。攻击者可以利用此漏洞读取任意文件或执行任意命令，从而完全控制受影响的系统。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断提供的POC代码是有效的。搜索结果中多个链接提到该漏洞在野外被积极利用，并且有远程代码执行的利用方式。

**投毒风险：**
*   **代码分析：** POC代码的主要功能是利用目录遍历漏洞，通过构造特殊的HTTP请求，将命令注入到模板中执行。代码中包含绕过正斜杠过滤的逻辑，将 `/` 替换为 `\$(printf \$HOME)`。
*   **潜在风险：** 尽管POC代码的主要功能是漏洞利用，但仍存在一定的投毒风险：
    1.  **依赖性：** POC代码依赖于Python2，这本身可能不是一个直接的投毒，但使用过时的依赖可能引入安全风险。
    2.  **错误处理：** 代码中的异常处理部分相对简单，可能会隐藏一些错误或异常，导致利用过程中的意外行为。
    3.  **参数传递：** 代码中直接使用`raw_input()`获取用户输入的命令，未进行充分的输入验证和过滤，可能被利用执行恶意命令。通过修改`cmd`变量，可以执行任意命令，这本身就是漏洞利用的核心，但也为投毒提供了可能性。攻击者可能会伪装成漏洞研究人员，分享包含恶意命令的POC。
    4.  **模板注入：** 通过模板注入执行命令，如果模板引擎存在其他未知的漏洞，也可能被利用进行更深层次的攻击。

综合考虑，虽然POC的主要目的是为了利用漏洞，但由于用户输入未经过滤，以及对Python2的依赖，依旧存在一定的投毒风险。因此，投毒风险评估为10%。这10%主要来源于代码可能存在不明显的漏洞和依赖风险，以及攻击者可能利用用户输入命令进行投毒的场景。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者发送包含特殊构造的URL的HTTP GET请求，该URL包含目录遍历序列和模板注入代码。
2.  **绕过过滤：**  如果目标系统存在对特殊字符的过滤（如正斜杠），攻击者需要使用相应的绕过技术，例如使用`\$(printf \$HOME)`代替`/`。
3.  **命令注入：** 通过模板注入，将需要执行的命令注入到Citrix ADC或Gateway服务器的上下文中。
4.  **远程代码执行：**  服务器执行注入的命令，攻击者从而获得在服务器上执行任意代码的能力。

**项目地址:** [w4fz5uck5/CVE-2019-19781-CitrixRCE](https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #26

**来源**: [CVE-2019-19781-yukar1z0e_CVE-2019-19781.md](../2019/CVE-2019-19781-yukar1z0e_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的 URL 来读取服务器上的任意文件，甚至可能执行任意代码。提供的“漏洞利用代码” 实际上只是 Apache 2.0 许可证，本身不包含漏洞利用代码，因此无法直接评估其有效性和投毒风险。但是，搜索结果中指向的Packetstorm Security 上的链接表明存在公开的利用代码和利用方法。利用方式通常涉及构造包含“../”序列的URL，以绕过路径验证，访问受限目录之外的文件。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，以及大量关于其在野利用的报告，可以推断出漏洞利用的有效性较高。由于提供的代码是许可协议而非实际漏洞利用代码，因此投毒风险为0%。利用方式是通过构造恶意的HTTP请求，包含目录遍历的payload，发送到目标Citrix ADC或Gateway服务器，从而读取敏感文件或执行恶意代码。

**项目地址:** [yukar1z0e/CVE-2019-19781](https://github.com/yukar1z0e/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #27

**来源**: [CVE-2019-19781-zerobytesecure_CVE-2019-19781.md](../2019/CVE-2019-19781-zerobytesecure_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---



---

## POC #16

**来源**: [CVE-2019-19781-j81blog_ADC-19781.md](../2019/CVE-2019-19781-j81blog_ADC-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #17

**来源**: [CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md](../2019/CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到存在漏洞的Citrix ADC/Gateway服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞，未经身份验证的攻击者可利用此漏洞读取任意文件，甚至可以结合其他技术实现远程代码执行。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以进行如下分析：

1. **有效性：**
   根据搜索引擎结果（Rapid7, Palo Alto Networks, CISA 等）以及漏洞利用代码仓库的描述，该漏洞已被广泛利用，证明了POC的有效性。

2. **投毒风险：**
   提供的`shitrix.sh`脚本通过构造恶意请求头，利用目录遍历读取`/netscaler/portal/templates/`目录下的文件，并执行其中的代码。脚本包含如下操作：
    * 生成随机字符串作为文件名。
    * 对要执行的命令进行Base64编码和URL编码。
    * 使用`curl`发送POST和GET请求，其中包含了精心构造的`NSC_USER`头，利用了template injection的漏洞。
   该脚本本身的目的就是进行漏洞利用，风险主要来源于脚本本身，而非额外的投毒代码。但如果该代码仓库被恶意修改，或者攻击者使用该脚本执行恶意命令，则可能造成投毒。例如，使用该漏洞在目标系统上安装后门。由于脚本代码量不大，人工审核较为容易，故投毒风险较低，初步评估为1%。

3. **利用方式：**
   利用方式主要分为以下几个步骤：
    1.  **目录遍历：** 通过构造包含`../../`的路径，访问到`/netscaler/portal/templates/`目录下的任意文件。
    2.  **模板注入：**  通过`NSC_USER`请求头，向目标服务器注入恶意模板代码，这些代码会被服务器解析执行。
    3.  **远程代码执行：**  利用模板引擎的特性，执行任意系统命令。具体来说，`shitrix.sh`脚本首先将要执行的命令进行Base64编码，然后利用`echo`和`b64decode`命令解码并执行。
    4.  **具体实现：** 脚本通过构造恶意请求，将命令注入到模板中，并通过curl发送请求。服务器在处理请求时，会解析模板并执行其中的命令，从而实现远程代码执行。

4.  **排序优先级：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jamesjguthrie/Shitrix-CVE-2019-19781](https://github.com/jamesjguthrie/Shitrix-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #18

**来源**: [CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md](../2019/CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #19

**来源**: [CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC)和Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。未经身份验证的攻击者可以通过构造特殊的URL，利用此漏洞读取服务器上的任意文件，甚至执行任意代码。搜索引擎结果和漏洞库信息都表明该漏洞的CVSS评分很高，并且已被广泛利用。

**有效性：**
根据搜索结果，该漏洞已被积极利用。多个安全厂商（如Rapid7, Palo Alto Networks, Mandiant/FireEye）都发布了相关的分析报告和检测工具。因此，可以判断存在有效的POC代码。

**投毒风险：**
提供的漏洞利用代码（FAQ.md）实际上是FireEye发布的IOC扫描工具的说明文档，用于检测是否已经遭受CVE-2019-19781漏洞的攻击，而不是漏洞利用代码本身。这个仓库本身是一个安全工具，可以检测已经发生的安全事件。存在投毒的可能性比较小。但依旧不能排除作者在该工具的更新中加入恶意代码的可能，因此投毒风险为10%。

**利用方式：**
1.  **目录遍历：** 攻击者发送包含恶意构造的URL的HTTP请求到目标Citrix ADC或Gateway设备。
2.  **文件读取：** 利用目录遍历漏洞，攻击者可以读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
3.  **远程代码执行：** 结合其他漏洞或者通过上传恶意文件，攻击者可以在服务器上执行任意代码，完全控制系统。

综上，CVE-2019-19781是一个严重的安全漏洞，需要及时修补。尽管提供的代码片段是检测工具，但实际环境中存在大量可用的POC代码，使得漏洞利用变得容易。务必使用官方补丁或缓解措施进行修复。

**项目地址:** [mandiant/ioc-scanner-CVE-2019-19781](https://github.com/mandiant/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #20

**来源**: [CVE-2019-19781-mpgn_CVE-2019-19781.md](../2019/CVE-2019-19781-mpgn_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #21

**来源**: [CVE-2019-19781-nmanzi_webcvescanner.md](../2019/CVE-2019-19781-nmanzi_webcvescanner.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至可能导致远程代码执行。搜索结果表明，该漏洞在野外被广泛利用，并被用于传播恶意软件。提供的漏洞利用代码仅为GNU GPL许可协议文本，并非实际的漏洞利用代码，因此无法判断漏洞利用代码的有效性。但考虑到漏洞的严重性和广泛的利用情况，可以认为有效的POC是存在的。

**有效性：**根据搜索结果，该漏洞存在有效的POC，且已被广泛利用。

**投毒风险：**提供的代码为GNU GPL许可协议，因此投毒风险为0%。实际利用时需要其他exp，需注意exp的来源是否安全可靠。

**利用方式：**攻击者发送包含特殊构造的目录遍历序列的HTTP请求到Citrix ADC或Gateway服务器。如果服务器未正确验证请求中的路径，则会允许攻击者访问受限目录之外的文件。该漏洞可以结合其他漏洞，例如上传漏洞，实现远程代码执行。

**项目地址:** [nmanzi/webcvescanner](https://github.com/nmanzi/webcvescanner)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #22

**来源**: [CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md](../2019/CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #23

**来源**: [CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md](../2019/CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #24

**来源**: [CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md](../2019/CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md)

## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #25

**来源**: [CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md](../2019/CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞。攻击者可以利用此漏洞读取任意文件或执行任意命令，从而完全控制受影响的系统。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断提供的POC代码是有效的。搜索结果中多个链接提到该漏洞在野外被积极利用，并且有远程代码执行的利用方式。

**投毒风险：**
*   **代码分析：** POC代码的主要功能是利用目录遍历漏洞，通过构造特殊的HTTP请求，将命令注入到模板中执行。代码中包含绕过正斜杠过滤的逻辑，将 `/` 替换为 `\$(printf \$HOME)`。
*   **潜在风险：** 尽管POC代码的主要功能是漏洞利用，但仍存在一定的投毒风险：
    1.  **依赖性：** POC代码依赖于Python2，这本身可能不是一个直接的投毒，但使用过时的依赖可能引入安全风险。
    2.  **错误处理：** 代码中的异常处理部分相对简单，可能会隐藏一些错误或异常，导致利用过程中的意外行为。
    3.  **参数传递：** 代码中直接使用`raw_input()`获取用户输入的命令，未进行充分的输入验证和过滤，可能被利用执行恶意命令。通过修改`cmd`变量，可以执行任意命令，这本身就是漏洞利用的核心，但也为投毒提供了可能性。攻击者可能会伪装成漏洞研究人员，分享包含恶意命令的POC。
    4.  **模板注入：** 通过模板注入执行命令，如果模板引擎存在其他未知的漏洞，也可能被利用进行更深层次的攻击。

综合考虑，虽然POC的主要目的是为了利用漏洞，但由于用户输入未经过滤，以及对Python2的依赖，依旧存在一定的投毒风险。因此，投毒风险评估为10%。这10%主要来源于代码可能存在不明显的漏洞和依赖风险，以及攻击者可能利用用户输入命令进行投毒的场景。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者发送包含特殊构造的URL的HTTP GET请求，该URL包含目录遍历序列和模板注入代码。
2.  **绕过过滤：**  如果目标系统存在对特殊字符的过滤（如正斜杠），攻击者需要使用相应的绕过技术，例如使用`\$(printf \$HOME)`代替`/`。
3.  **命令注入：** 通过模板注入，将需要执行的命令注入到Citrix ADC或Gateway服务器的上下文中。
4.  **远程代码执行：**  服务器执行注入的命令，攻击者从而获得在服务器上执行任意代码的能力。

**项目地址:** [w4fz5uck5/CVE-2019-19781-CitrixRCE](https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #26

**来源**: [CVE-2019-19781-yukar1z0e_CVE-2019-19781.md](../2019/CVE-2019-19781-yukar1z0e_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的 URL 来读取服务器上的任意文件，甚至可能执行任意代码。提供的“漏洞利用代码” 实际上只是 Apache 2.0 许可证，本身不包含漏洞利用代码，因此无法直接评估其有效性和投毒风险。但是，搜索结果中指向的Packetstorm Security 上的链接表明存在公开的利用代码和利用方法。利用方式通常涉及构造包含“../”序列的URL，以绕过路径验证，访问受限目录之外的文件。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，以及大量关于其在野利用的报告，可以推断出漏洞利用的有效性较高。由于提供的代码是许可协议而非实际漏洞利用代码，因此投毒风险为0%。利用方式是通过构造恶意的HTTP请求，包含目录遍历的payload，发送到目标Citrix ADC或Gateway服务器，从而读取敏感文件或执行恶意代码。

**项目地址:** [yukar1z0e/CVE-2019-19781](https://github.com/yukar1z0e/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #27

**来源**: [CVE-2019-19781-zerobytesecure_CVE-2019-19781.md](../2019/CVE-2019-19781-zerobytesecure_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---



---

## POC #16

**来源**: [CVE-2019-19781-j81blog_ADC-19781.md](../2019/CVE-2019-19781-j81blog_ADC-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #17

**来源**: [CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md](../2019/CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到存在漏洞的Citrix ADC/Gateway服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞，未经身份验证的攻击者可利用此漏洞读取任意文件，甚至可以结合其他技术实现远程代码执行。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以进行如下分析：

1. **有效性：**
   根据搜索引擎结果（Rapid7, Palo Alto Networks, CISA 等）以及漏洞利用代码仓库的描述，该漏洞已被广泛利用，证明了POC的有效性。

2. **投毒风险：**
   提供的`shitrix.sh`脚本通过构造恶意请求头，利用目录遍历读取`/netscaler/portal/templates/`目录下的文件，并执行其中的代码。脚本包含如下操作：
    * 生成随机字符串作为文件名。
    * 对要执行的命令进行Base64编码和URL编码。
    * 使用`curl`发送POST和GET请求，其中包含了精心构造的`NSC_USER`头，利用了template injection的漏洞。
   该脚本本身的目的就是进行漏洞利用，风险主要来源于脚本本身，而非额外的投毒代码。但如果该代码仓库被恶意修改，或者攻击者使用该脚本执行恶意命令，则可能造成投毒。例如，使用该漏洞在目标系统上安装后门。由于脚本代码量不大，人工审核较为容易，故投毒风险较低，初步评估为1%。

3. **利用方式：**
   利用方式主要分为以下几个步骤：
    1.  **目录遍历：** 通过构造包含`../../`的路径，访问到`/netscaler/portal/templates/`目录下的任意文件。
    2.  **模板注入：**  通过`NSC_USER`请求头，向目标服务器注入恶意模板代码，这些代码会被服务器解析执行。
    3.  **远程代码执行：**  利用模板引擎的特性，执行任意系统命令。具体来说，`shitrix.sh`脚本首先将要执行的命令进行Base64编码，然后利用`echo`和`b64decode`命令解码并执行。
    4.  **具体实现：** 脚本通过构造恶意请求，将命令注入到模板中，并通过curl发送请求。服务器在处理请求时，会解析模板并执行其中的命令，从而实现远程代码执行。

4.  **排序优先级：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jamesjguthrie/Shitrix-CVE-2019-19781](https://github.com/jamesjguthrie/Shitrix-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #18

**来源**: [CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md](../2019/CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #19

**来源**: [CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC)和Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。未经身份验证的攻击者可以通过构造特殊的URL，利用此漏洞读取服务器上的任意文件，甚至执行任意代码。搜索引擎结果和漏洞库信息都表明该漏洞的CVSS评分很高，并且已被广泛利用。

**有效性：**
根据搜索结果，该漏洞已被积极利用。多个安全厂商（如Rapid7, Palo Alto Networks, Mandiant/FireEye）都发布了相关的分析报告和检测工具。因此，可以判断存在有效的POC代码。

**投毒风险：**
提供的漏洞利用代码（FAQ.md）实际上是FireEye发布的IOC扫描工具的说明文档，用于检测是否已经遭受CVE-2019-19781漏洞的攻击，而不是漏洞利用代码本身。这个仓库本身是一个安全工具，可以检测已经发生的安全事件。存在投毒的可能性比较小。但依旧不能排除作者在该工具的更新中加入恶意代码的可能，因此投毒风险为10%。

**利用方式：**
1.  **目录遍历：** 攻击者发送包含恶意构造的URL的HTTP请求到目标Citrix ADC或Gateway设备。
2.  **文件读取：** 利用目录遍历漏洞，攻击者可以读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
3.  **远程代码执行：** 结合其他漏洞或者通过上传恶意文件，攻击者可以在服务器上执行任意代码，完全控制系统。

综上，CVE-2019-19781是一个严重的安全漏洞，需要及时修补。尽管提供的代码片段是检测工具，但实际环境中存在大量可用的POC代码，使得漏洞利用变得容易。务必使用官方补丁或缓解措施进行修复。

**项目地址:** [mandiant/ioc-scanner-CVE-2019-19781](https://github.com/mandiant/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #20

**来源**: [CVE-2019-19781-mpgn_CVE-2019-19781.md](../2019/CVE-2019-19781-mpgn_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #21

**来源**: [CVE-2019-19781-nmanzi_webcvescanner.md](../2019/CVE-2019-19781-nmanzi_webcvescanner.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至可能导致远程代码执行。搜索结果表明，该漏洞在野外被广泛利用，并被用于传播恶意软件。提供的漏洞利用代码仅为GNU GPL许可协议文本，并非实际的漏洞利用代码，因此无法判断漏洞利用代码的有效性。但考虑到漏洞的严重性和广泛的利用情况，可以认为有效的POC是存在的。

**有效性：**根据搜索结果，该漏洞存在有效的POC，且已被广泛利用。

**投毒风险：**提供的代码为GNU GPL许可协议，因此投毒风险为0%。实际利用时需要其他exp，需注意exp的来源是否安全可靠。

**利用方式：**攻击者发送包含特殊构造的目录遍历序列的HTTP请求到Citrix ADC或Gateway服务器。如果服务器未正确验证请求中的路径，则会允许攻击者访问受限目录之外的文件。该漏洞可以结合其他漏洞，例如上传漏洞，实现远程代码执行。

**项目地址:** [nmanzi/webcvescanner](https://github.com/nmanzi/webcvescanner)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #22

**来源**: [CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md](../2019/CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #23

**来源**: [CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md](../2019/CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #24

**来源**: [CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md](../2019/CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md)

## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #25

**来源**: [CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md](../2019/CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞。攻击者可以利用此漏洞读取任意文件或执行任意命令，从而完全控制受影响的系统。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断提供的POC代码是有效的。搜索结果中多个链接提到该漏洞在野外被积极利用，并且有远程代码执行的利用方式。

**投毒风险：**
*   **代码分析：** POC代码的主要功能是利用目录遍历漏洞，通过构造特殊的HTTP请求，将命令注入到模板中执行。代码中包含绕过正斜杠过滤的逻辑，将 `/` 替换为 `\$(printf \$HOME)`。
*   **潜在风险：** 尽管POC代码的主要功能是漏洞利用，但仍存在一定的投毒风险：
    1.  **依赖性：** POC代码依赖于Python2，这本身可能不是一个直接的投毒，但使用过时的依赖可能引入安全风险。
    2.  **错误处理：** 代码中的异常处理部分相对简单，可能会隐藏一些错误或异常，导致利用过程中的意外行为。
    3.  **参数传递：** 代码中直接使用`raw_input()`获取用户输入的命令，未进行充分的输入验证和过滤，可能被利用执行恶意命令。通过修改`cmd`变量，可以执行任意命令，这本身就是漏洞利用的核心，但也为投毒提供了可能性。攻击者可能会伪装成漏洞研究人员，分享包含恶意命令的POC。
    4.  **模板注入：** 通过模板注入执行命令，如果模板引擎存在其他未知的漏洞，也可能被利用进行更深层次的攻击。

综合考虑，虽然POC的主要目的是为了利用漏洞，但由于用户输入未经过滤，以及对Python2的依赖，依旧存在一定的投毒风险。因此，投毒风险评估为10%。这10%主要来源于代码可能存在不明显的漏洞和依赖风险，以及攻击者可能利用用户输入命令进行投毒的场景。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者发送包含特殊构造的URL的HTTP GET请求，该URL包含目录遍历序列和模板注入代码。
2.  **绕过过滤：**  如果目标系统存在对特殊字符的过滤（如正斜杠），攻击者需要使用相应的绕过技术，例如使用`\$(printf \$HOME)`代替`/`。
3.  **命令注入：** 通过模板注入，将需要执行的命令注入到Citrix ADC或Gateway服务器的上下文中。
4.  **远程代码执行：**  服务器执行注入的命令，攻击者从而获得在服务器上执行任意代码的能力。

**项目地址:** [w4fz5uck5/CVE-2019-19781-CitrixRCE](https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #26

**来源**: [CVE-2019-19781-yukar1z0e_CVE-2019-19781.md](../2019/CVE-2019-19781-yukar1z0e_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的 URL 来读取服务器上的任意文件，甚至可能执行任意代码。提供的“漏洞利用代码” 实际上只是 Apache 2.0 许可证，本身不包含漏洞利用代码，因此无法直接评估其有效性和投毒风险。但是，搜索结果中指向的Packetstorm Security 上的链接表明存在公开的利用代码和利用方法。利用方式通常涉及构造包含“../”序列的URL，以绕过路径验证，访问受限目录之外的文件。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，以及大量关于其在野利用的报告，可以推断出漏洞利用的有效性较高。由于提供的代码是许可协议而非实际漏洞利用代码，因此投毒风险为0%。利用方式是通过构造恶意的HTTP请求，包含目录遍历的payload，发送到目标Citrix ADC或Gateway服务器，从而读取敏感文件或执行恶意代码。

**项目地址:** [yukar1z0e/CVE-2019-19781](https://github.com/yukar1z0e/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #27

**来源**: [CVE-2019-19781-zerobytesecure_CVE-2019-19781.md](../2019/CVE-2019-19781-zerobytesecure_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---



---

## POC #16

**来源**: [CVE-2019-19781-j81blog_ADC-19781.md](../2019/CVE-2019-19781-j81blog_ADC-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取任意文件，甚至可能导致远程代码执行。多个安全报告表明该漏洞被积极利用。提供的PowerShell脚本`/tmp/1ca772ac3b5318a387b164f39cf30188/ADC-19781.psm1` 看起来是一个用于连接和身份验证的模块，实现了忽略SSL证书的功能，并封装了连接到Citrix ADC设备的逻辑。它本身不是漏洞利用代码，而是用于与Citrix ADC建立连接的辅助工具。 真正的漏洞利用代码会利用目录遍历读取敏感文件或者写入恶意文件达到RCE的目的。因此，单独使用该脚本并不能直接利用该漏洞，但它是漏洞利用链中的一环。投毒风险评估：该脚本本身功能是用于连接ADC，不包含恶意代码。但由于其用于漏洞利用的辅助，因此如果被恶意修改，例如修改ManagementURL地址，可能导致连接到恶意的钓鱼服务器。因此，存在一定的投毒风险，约10%。利用方式：攻击者通常首先利用目录遍历漏洞读取敏感文件，例如包含配置信息的`/etc/passwd`。然后，他们可能会上传恶意文件到目标服务器，例如Web shell，并通过目录遍历漏洞访问该文件，从而执行任意代码。该脚本是连接ADC设备的辅助工具，可能被用于攻击过程中的身份验证环节。

**项目地址:** [j81blog/ADC-19781](https://github.com/j81blog/ADC-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #17

**来源**: [CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md](../2019/CVE-2019-19781-jamesjguthrie_Shitrix-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致远程代码执行和敏感信息泄露

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问到存在漏洞的Citrix ADC/Gateway服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞，未经身份验证的攻击者可利用此漏洞读取任意文件，甚至可以结合其他技术实现远程代码执行。根据漏洞库信息、搜索引擎结果和提供的POC代码，可以进行如下分析：

1. **有效性：**
   根据搜索引擎结果（Rapid7, Palo Alto Networks, CISA 等）以及漏洞利用代码仓库的描述，该漏洞已被广泛利用，证明了POC的有效性。

2. **投毒风险：**
   提供的`shitrix.sh`脚本通过构造恶意请求头，利用目录遍历读取`/netscaler/portal/templates/`目录下的文件，并执行其中的代码。脚本包含如下操作：
    * 生成随机字符串作为文件名。
    * 对要执行的命令进行Base64编码和URL编码。
    * 使用`curl`发送POST和GET请求，其中包含了精心构造的`NSC_USER`头，利用了template injection的漏洞。
   该脚本本身的目的就是进行漏洞利用，风险主要来源于脚本本身，而非额外的投毒代码。但如果该代码仓库被恶意修改，或者攻击者使用该脚本执行恶意命令，则可能造成投毒。例如，使用该漏洞在目标系统上安装后门。由于脚本代码量不大，人工审核较为容易，故投毒风险较低，初步评估为1%。

3. **利用方式：**
   利用方式主要分为以下几个步骤：
    1.  **目录遍历：** 通过构造包含`../../`的路径，访问到`/netscaler/portal/templates/`目录下的任意文件。
    2.  **模板注入：**  通过`NSC_USER`请求头，向目标服务器注入恶意模板代码，这些代码会被服务器解析执行。
    3.  **远程代码执行：**  利用模板引擎的特性，执行任意系统命令。具体来说，`shitrix.sh`脚本首先将要执行的命令进行Base64编码，然后利用`echo`和`b64decode`命令解码并执行。
    4.  **具体实现：** 脚本通过构造恶意请求，将命令注入到模板中，并通过curl发送请求。服务器在处理请求时，会解析模板并执行其中的命令，从而实现远程代码执行。

4.  **排序优先级：** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息


**项目地址:** [jamesjguthrie/Shitrix-CVE-2019-19781](https://github.com/jamesjguthrie/Shitrix-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #18

**来源**: [CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md](../2019/CVE-2019-19781-k-fire_CVE-2019-19781-exploit.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #19

**来源**: [CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md](../2019/CVE-2019-19781-mandiant_ioc-scanner-CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC)和Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。未经身份验证的攻击者可以通过构造特殊的URL，利用此漏洞读取服务器上的任意文件，甚至执行任意代码。搜索引擎结果和漏洞库信息都表明该漏洞的CVSS评分很高，并且已被广泛利用。

**有效性：**
根据搜索结果，该漏洞已被积极利用。多个安全厂商（如Rapid7, Palo Alto Networks, Mandiant/FireEye）都发布了相关的分析报告和检测工具。因此，可以判断存在有效的POC代码。

**投毒风险：**
提供的漏洞利用代码（FAQ.md）实际上是FireEye发布的IOC扫描工具的说明文档，用于检测是否已经遭受CVE-2019-19781漏洞的攻击，而不是漏洞利用代码本身。这个仓库本身是一个安全工具，可以检测已经发生的安全事件。存在投毒的可能性比较小。但依旧不能排除作者在该工具的更新中加入恶意代码的可能，因此投毒风险为10%。

**利用方式：**
1.  **目录遍历：** 攻击者发送包含恶意构造的URL的HTTP请求到目标Citrix ADC或Gateway设备。
2.  **文件读取：** 利用目录遍历漏洞，攻击者可以读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
3.  **远程代码执行：** 结合其他漏洞或者通过上传恶意文件，攻击者可以在服务器上执行任意代码，完全控制系统。

综上，CVE-2019-19781是一个严重的安全漏洞，需要及时修补。尽管提供的代码片段是检测工具，但实际环境中存在大量可用的POC代码，使得漏洞利用变得容易。务必使用官方补丁或缓解措施进行修复。

**项目地址:** [mandiant/ioc-scanner-CVE-2019-19781](https://github.com/mandiant/ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #20

**来源**: [CVE-2019-19781-mpgn_CVE-2019-19781.md](../2019/CVE-2019-19781-mpgn_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC and Gateway Directory Traversal / RCE

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统必须运行受影响版本的Citrix ADC或Gateway，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于 Citrix Application Delivery Controller (ADC) 和 Gateway 的多个版本中。该漏洞允许未经身份验证的远程攻击者通过目录遍历漏洞执行任意代码。利用方式是发送特制的HTTP请求到目标服务器的`/vpn/../vpns/portal/scripts/newbm.pl`路径，通过`NSC_USER` header 和 `url` data 构造恶意的目录遍历和模板注入，将包含恶意代码的xml文件写入服务器。然后，通过 GET 请求访问该 XML 文件触发恶意代码执行。提供的 POC 代码通过发送包含命令的请求，然后检索执行结果来利用此漏洞。该POC脚本通过随机生成XML文件名，避免了文件覆盖风险。readme.md 文件中包含验证漏洞是否存在的方法，以及修复建议。 漏洞利用代码本身没有明显的投毒迹象，但恶意攻击者可能会修改该脚本添加后门代码，此仓库存在较低投毒风险。

**项目地址:** [mpgn/CVE-2019-19781](https://github.com/mpgn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #21

**来源**: [CVE-2019-19781-nmanzi_webcvescanner.md](../2019/CVE-2019-19781-nmanzi_webcvescanner.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至可能导致远程代码执行。搜索结果表明，该漏洞在野外被广泛利用，并被用于传播恶意软件。提供的漏洞利用代码仅为GNU GPL许可协议文本，并非实际的漏洞利用代码，因此无法判断漏洞利用代码的有效性。但考虑到漏洞的严重性和广泛的利用情况，可以认为有效的POC是存在的。

**有效性：**根据搜索结果，该漏洞存在有效的POC，且已被广泛利用。

**投毒风险：**提供的代码为GNU GPL许可协议，因此投毒风险为0%。实际利用时需要其他exp，需注意exp的来源是否安全可靠。

**利用方式：**攻击者发送包含特殊构造的目录遍历序列的HTTP请求到Citrix ADC或Gateway服务器。如果服务器未正确验证请求中的路径，则会允许攻击者访问受限目录之外的文件。该漏洞可以结合其他漏洞，例如上传漏洞，实现远程代码执行。

**项目地址:** [nmanzi/webcvescanner](https://github.com/nmanzi/webcvescanner)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #22

**来源**: [CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md](../2019/CVE-2019-19781-onSec-fr_CVE-2019-19781-Forensic.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #23

**来源**: [CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md](../2019/CVE-2019-19781-pwn3z_CVE-2019-19781-Citrix.md)

## CVE-2019-19781-Citrix ADC/Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是Citrix ADC和Gateway产品中的一个目录遍历漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者通过构造特殊的URL，读取服务器上的任意文件，甚至结合其他攻击手段实现远程代码执行。\n\n**POC有效性分析：**\n提供的POC代码是一个Bash脚本，它通过`curl`命令尝试访问目标Citrix服务器上的`smb.conf`文件。具体来说，它会从`hosts`文件中读取目标IP地址或域名，然后构造包含目录遍历的URL：`https://{}/vpn/js/../../vpns/cfg/smb.conf`。如果服务器存在漏洞，并且成功读取到`smb.conf`文件中的`lmhosts`字符串，则判断目标服务器存在漏洞。该POC代码通过检查返回的内容是否包含`lmhosts`来验证漏洞的存在，较为简单直接，可以有效检测漏洞。\n\n**投毒风险分析：**\n该脚本本身功能较为简单，主要就是利用curl发送一个http请求，然后grep结果判断是否存在lmhosts,该脚本本身的投毒风险较低。虽然从`hosts`文件读取目标，存在替换`hosts`文件进行批量投毒的可能性，但是可能性很小。分析认为投毒风险约为5%。\n\n**漏洞利用方式：**\n利用方式是通过构造包含`../`的URL，绕过服务器的文件访问限制，访问到受保护的目录或文件。例如，攻击者可以使用类似于以下的URL来读取服务器上的敏感文件：\n`https://<目标服务器>/vpn/js/../../../../etc/passwd`\n\n根据搜索结果，这个漏洞被广泛利用，可能被用于安装恶意软件（例如NOTROBIN）。一些分析报告也指出，该漏洞经常与其他漏洞结合使用，以实现远程代码执行。通过目录遍历读取敏感文件后，攻击者可以进一步利用其他漏洞来执行恶意代码。

**项目地址:** [pwn3z/CVE-2019-19781-Citrix](https://github.com/pwn3z/CVE-2019-19781-Citrix)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #24

**来源**: [CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md](../2019/CVE-2019-19781-qiong-qi_CVE-2019-19781-poc.md)

## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #25

**来源**: [CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md](../2019/CVE-2019-19781-w4fz5uck5_CVE-2019-19781-CitrixRCE.md)

## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞。攻击者可以利用此漏洞读取任意文件或执行任意命令，从而完全控制受影响的系统。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断提供的POC代码是有效的。搜索结果中多个链接提到该漏洞在野外被积极利用，并且有远程代码执行的利用方式。

**投毒风险：**
*   **代码分析：** POC代码的主要功能是利用目录遍历漏洞，通过构造特殊的HTTP请求，将命令注入到模板中执行。代码中包含绕过正斜杠过滤的逻辑，将 `/` 替换为 `\$(printf \$HOME)`。
*   **潜在风险：** 尽管POC代码的主要功能是漏洞利用，但仍存在一定的投毒风险：
    1.  **依赖性：** POC代码依赖于Python2，这本身可能不是一个直接的投毒，但使用过时的依赖可能引入安全风险。
    2.  **错误处理：** 代码中的异常处理部分相对简单，可能会隐藏一些错误或异常，导致利用过程中的意外行为。
    3.  **参数传递：** 代码中直接使用`raw_input()`获取用户输入的命令，未进行充分的输入验证和过滤，可能被利用执行恶意命令。通过修改`cmd`变量，可以执行任意命令，这本身就是漏洞利用的核心，但也为投毒提供了可能性。攻击者可能会伪装成漏洞研究人员，分享包含恶意命令的POC。
    4.  **模板注入：** 通过模板注入执行命令，如果模板引擎存在其他未知的漏洞，也可能被利用进行更深层次的攻击。

综合考虑，虽然POC的主要目的是为了利用漏洞，但由于用户输入未经过滤，以及对Python2的依赖，依旧存在一定的投毒风险。因此，投毒风险评估为10%。这10%主要来源于代码可能存在不明显的漏洞和依赖风险，以及攻击者可能利用用户输入命令进行投毒的场景。

**利用方式：**
1.  **构造恶意HTTP请求：** 攻击者发送包含特殊构造的URL的HTTP GET请求，该URL包含目录遍历序列和模板注入代码。
2.  **绕过过滤：**  如果目标系统存在对特殊字符的过滤（如正斜杠），攻击者需要使用相应的绕过技术，例如使用`\$(printf \$HOME)`代替`/`。
3.  **命令注入：** 通过模板注入，将需要执行的命令注入到Citrix ADC或Gateway服务器的上下文中。
4.  **远程代码执行：**  服务器执行注入的命令，攻击者从而获得在服务器上执行任意代码的能力。

**项目地址:** [w4fz5uck5/CVE-2019-19781-CitrixRCE](https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #26

**来源**: [CVE-2019-19781-yukar1z0e_CVE-2019-19781.md](../2019/CVE-2019-19781-yukar1z0e_CVE-2019-19781.md)

## CVE-2019-19781-Citrix ADC and Gateway-目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者通过构造特殊的 URL 来读取服务器上的任意文件，甚至可能执行任意代码。提供的“漏洞利用代码” 实际上只是 Apache 2.0 许可证，本身不包含漏洞利用代码，因此无法直接评估其有效性和投毒风险。但是，搜索结果中指向的Packetstorm Security 上的链接表明存在公开的利用代码和利用方法。利用方式通常涉及构造包含“../”序列的URL，以绕过路径验证，访问受限目录之外的文件。考虑到CISA已将此漏洞加入已知被利用的漏洞目录，以及大量关于其在野利用的报告，可以推断出漏洞利用的有效性较高。由于提供的代码是许可协议而非实际漏洞利用代码，因此投毒风险为0%。利用方式是通过构造恶意的HTTP请求，包含目录遍历的payload，发送到目标Citrix ADC或Gateway服务器，从而读取敏感文件或执行恶意代码。

**项目地址:** [yukar1z0e/CVE-2019-19781](https://github.com/yukar1z0e/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

## POC #27

**来源**: [CVE-2019-19781-zerobytesecure_CVE-2019-19781.md](../2019/CVE-2019-19781-zerobytesecure_CVE-2019-19781.md)

## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)

---

