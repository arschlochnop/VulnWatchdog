# CVE-2019-0708

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md)

## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #2

**来源**: [CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md](../2019/CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未授权的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，这是一个高危漏洞，影响多个版本的Windows操作系统。Packetstorm Security等网站上存在相关的利用代码，表明漏洞的可利用性较高。Unit 42的研究表明，可以通过不同的RDP PDU组合来实现漏洞利用。给定的漏洞利用代码`exploit.py` 目前为空，只有`import sys`语句，**因此没有任何实际的漏洞利用逻辑。这意味着它目前是无效的，并且高度怀疑是占位符或者诱饵，存在极高的投毒风险。**真正的漏洞利用通常涉及构造特定的RDP数据包，触发目标系统上的内存错误（例如，use-after-free）。由于代码不完整，无法确定具体的利用方式，但总体思路是利用RDP协议的缺陷，在内核层面执行恶意代码。

**利用方式总结：**
1.  攻击者通过RDP协议与目标系统建立连接。
2.  攻击者构造包含恶意代码的RDP数据包。
3.  目标系统解析RDP数据包时触发漏洞，导致恶意代码在内核中执行。

由于`exploit.py`内容为空，判定为投毒代码的风险极高。

**项目地址:** [CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit](https://github.com/CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #3

**来源**: [CVE-2019-0708-CircuitSoul_CVE-2019-0708.md](../2019/CVE-2019-0708-CircuitSoul_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #4

**来源**: [CVE-2019-0708-Cyb0r9_ispy.md](../2019/CVE-2019-0708-Cyb0r9_ispy.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，未经身份验证的攻击者可以利用RDP发送特制请求在目标系统上执行任意代码。

**影响版本:** Windows 7 for 32-bit Systems Service Pack 1, Windows 7 for x64-based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Core installation), Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1, Windows Server 2008 for 32-bit Systems Service Pack 2 (Core installation), Windows Server 2008 for Itanium-Based Systems Service Pack 2, Windows Server 2008 for 32-bit Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2 (Core installation)

**利用条件:** 目标系统开启RDP服务，攻击者能够通过网络连接到目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft Windows Remote Desktop Services中的远程代码执行漏洞。未经身份验证的攻击者通过RDP协议发送特制请求，可以在目标系统上执行任意代码。该漏洞影响多个版本的Windows，包括Windows 7和Windows Server 2008。

**有效性：**
根据提供的漏洞信息和搜索结果，存在可利用的POC代码。多个安全研究团队和个人已经发布了利用该漏洞的PoC，证明了其可利用性。

**投毒风险：**
提供的漏洞利用代码仅为GNU Lesser General Public License，不包含任何可执行代码，因此可以判断投毒风险非常低。但是，在实际使用漏洞利用代码时，从不可信的来源获取的PoC可能包含恶意代码，因此下载和使用之前必须进行代码审计。

**利用方式：**
1.  **RDP连接：** 攻击者首先需要通过RDP协议连接到目标系统。
2.  **构造恶意请求：** 攻击者需要构造一个特殊的RDP请求，该请求会触发RDP服务中的漏洞。
3.  **代码执行：** 当目标系统处理该恶意请求时，漏洞会被触发，允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   及时安装Microsoft发布的针对CVE-2019-0708的补丁。
*   如果无法及时安装补丁，可以禁用RDP服务或限制RDP服务的访问。
*   启用网络级别身份验证（NLA），虽然不能完全阻止攻击，但可以增加攻击难度。

**项目地址:** [Cyb0r9/ispy](https://github.com/Cyb0r9/ispy)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #5

**来源**: [CVE-2019-0708-Ekultek_BlueKeep.md](../2019/CVE-2019-0708-Ekultek_BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #6

**来源**: [CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md](../2019/CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md)

# CVE-2019-0708

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md)

## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #2

**来源**: [CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md](../2019/CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未授权的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，这是一个高危漏洞，影响多个版本的Windows操作系统。Packetstorm Security等网站上存在相关的利用代码，表明漏洞的可利用性较高。Unit 42的研究表明，可以通过不同的RDP PDU组合来实现漏洞利用。给定的漏洞利用代码`exploit.py` 目前为空，只有`import sys`语句，**因此没有任何实际的漏洞利用逻辑。这意味着它目前是无效的，并且高度怀疑是占位符或者诱饵，存在极高的投毒风险。**真正的漏洞利用通常涉及构造特定的RDP数据包，触发目标系统上的内存错误（例如，use-after-free）。由于代码不完整，无法确定具体的利用方式，但总体思路是利用RDP协议的缺陷，在内核层面执行恶意代码。

**利用方式总结：**
1.  攻击者通过RDP协议与目标系统建立连接。
2.  攻击者构造包含恶意代码的RDP数据包。
3.  目标系统解析RDP数据包时触发漏洞，导致恶意代码在内核中执行。

由于`exploit.py`内容为空，判定为投毒代码的风险极高。

**项目地址:** [CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit](https://github.com/CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #3

**来源**: [CVE-2019-0708-CircuitSoul_CVE-2019-0708.md](../2019/CVE-2019-0708-CircuitSoul_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #4

**来源**: [CVE-2019-0708-Cyb0r9_ispy.md](../2019/CVE-2019-0708-Cyb0r9_ispy.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，未经身份验证的攻击者可以利用RDP发送特制请求在目标系统上执行任意代码。

**影响版本:** Windows 7 for 32-bit Systems Service Pack 1, Windows 7 for x64-based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Core installation), Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1, Windows Server 2008 for 32-bit Systems Service Pack 2 (Core installation), Windows Server 2008 for Itanium-Based Systems Service Pack 2, Windows Server 2008 for 32-bit Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2 (Core installation)

**利用条件:** 目标系统开启RDP服务，攻击者能够通过网络连接到目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft Windows Remote Desktop Services中的远程代码执行漏洞。未经身份验证的攻击者通过RDP协议发送特制请求，可以在目标系统上执行任意代码。该漏洞影响多个版本的Windows，包括Windows 7和Windows Server 2008。

**有效性：**
根据提供的漏洞信息和搜索结果，存在可利用的POC代码。多个安全研究团队和个人已经发布了利用该漏洞的PoC，证明了其可利用性。

**投毒风险：**
提供的漏洞利用代码仅为GNU Lesser General Public License，不包含任何可执行代码，因此可以判断投毒风险非常低。但是，在实际使用漏洞利用代码时，从不可信的来源获取的PoC可能包含恶意代码，因此下载和使用之前必须进行代码审计。

**利用方式：**
1.  **RDP连接：** 攻击者首先需要通过RDP协议连接到目标系统。
2.  **构造恶意请求：** 攻击者需要构造一个特殊的RDP请求，该请求会触发RDP服务中的漏洞。
3.  **代码执行：** 当目标系统处理该恶意请求时，漏洞会被触发，允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   及时安装Microsoft发布的针对CVE-2019-0708的补丁。
*   如果无法及时安装补丁，可以禁用RDP服务或限制RDP服务的访问。
*   启用网络级别身份验证（NLA），虽然不能完全阻止攻击，但可以增加攻击难度。

**项目地址:** [Cyb0r9/ispy](https://github.com/Cyb0r9/ispy)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #5

**来源**: [CVE-2019-0708-Ekultek_BlueKeep.md](../2019/CVE-2019-0708-Ekultek_BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #6

**来源**: [CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md](../2019/CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md)

# CVE-2019-0708

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md)

## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #2

**来源**: [CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md](../2019/CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未授权的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，这是一个高危漏洞，影响多个版本的Windows操作系统。Packetstorm Security等网站上存在相关的利用代码，表明漏洞的可利用性较高。Unit 42的研究表明，可以通过不同的RDP PDU组合来实现漏洞利用。给定的漏洞利用代码`exploit.py` 目前为空，只有`import sys`语句，**因此没有任何实际的漏洞利用逻辑。这意味着它目前是无效的，并且高度怀疑是占位符或者诱饵，存在极高的投毒风险。**真正的漏洞利用通常涉及构造特定的RDP数据包，触发目标系统上的内存错误（例如，use-after-free）。由于代码不完整，无法确定具体的利用方式，但总体思路是利用RDP协议的缺陷，在内核层面执行恶意代码。

**利用方式总结：**
1.  攻击者通过RDP协议与目标系统建立连接。
2.  攻击者构造包含恶意代码的RDP数据包。
3.  目标系统解析RDP数据包时触发漏洞，导致恶意代码在内核中执行。

由于`exploit.py`内容为空，判定为投毒代码的风险极高。

**项目地址:** [CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit](https://github.com/CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #3

**来源**: [CVE-2019-0708-CircuitSoul_CVE-2019-0708.md](../2019/CVE-2019-0708-CircuitSoul_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #4

**来源**: [CVE-2019-0708-Cyb0r9_ispy.md](../2019/CVE-2019-0708-Cyb0r9_ispy.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，未经身份验证的攻击者可以利用RDP发送特制请求在目标系统上执行任意代码。

**影响版本:** Windows 7 for 32-bit Systems Service Pack 1, Windows 7 for x64-based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Core installation), Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1, Windows Server 2008 for 32-bit Systems Service Pack 2 (Core installation), Windows Server 2008 for Itanium-Based Systems Service Pack 2, Windows Server 2008 for 32-bit Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2 (Core installation)

**利用条件:** 目标系统开启RDP服务，攻击者能够通过网络连接到目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft Windows Remote Desktop Services中的远程代码执行漏洞。未经身份验证的攻击者通过RDP协议发送特制请求，可以在目标系统上执行任意代码。该漏洞影响多个版本的Windows，包括Windows 7和Windows Server 2008。

**有效性：**
根据提供的漏洞信息和搜索结果，存在可利用的POC代码。多个安全研究团队和个人已经发布了利用该漏洞的PoC，证明了其可利用性。

**投毒风险：**
提供的漏洞利用代码仅为GNU Lesser General Public License，不包含任何可执行代码，因此可以判断投毒风险非常低。但是，在实际使用漏洞利用代码时，从不可信的来源获取的PoC可能包含恶意代码，因此下载和使用之前必须进行代码审计。

**利用方式：**
1.  **RDP连接：** 攻击者首先需要通过RDP协议连接到目标系统。
2.  **构造恶意请求：** 攻击者需要构造一个特殊的RDP请求，该请求会触发RDP服务中的漏洞。
3.  **代码执行：** 当目标系统处理该恶意请求时，漏洞会被触发，允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   及时安装Microsoft发布的针对CVE-2019-0708的补丁。
*   如果无法及时安装补丁，可以禁用RDP服务或限制RDP服务的访问。
*   启用网络级别身份验证（NLA），虽然不能完全阻止攻击，但可以增加攻击难度。

**项目地址:** [Cyb0r9/ispy](https://github.com/Cyb0r9/ispy)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #5

**来源**: [CVE-2019-0708-Ekultek_BlueKeep.md](../2019/CVE-2019-0708-Ekultek_BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #6

**来源**: [CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md](../2019/CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md)

# CVE-2019-0708

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md)

## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #2

**来源**: [CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md](../2019/CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未授权的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，这是一个高危漏洞，影响多个版本的Windows操作系统。Packetstorm Security等网站上存在相关的利用代码，表明漏洞的可利用性较高。Unit 42的研究表明，可以通过不同的RDP PDU组合来实现漏洞利用。给定的漏洞利用代码`exploit.py` 目前为空，只有`import sys`语句，**因此没有任何实际的漏洞利用逻辑。这意味着它目前是无效的，并且高度怀疑是占位符或者诱饵，存在极高的投毒风险。**真正的漏洞利用通常涉及构造特定的RDP数据包，触发目标系统上的内存错误（例如，use-after-free）。由于代码不完整，无法确定具体的利用方式，但总体思路是利用RDP协议的缺陷，在内核层面执行恶意代码。

**利用方式总结：**
1.  攻击者通过RDP协议与目标系统建立连接。
2.  攻击者构造包含恶意代码的RDP数据包。
3.  目标系统解析RDP数据包时触发漏洞，导致恶意代码在内核中执行。

由于`exploit.py`内容为空，判定为投毒代码的风险极高。

**项目地址:** [CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit](https://github.com/CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #3

**来源**: [CVE-2019-0708-CircuitSoul_CVE-2019-0708.md](../2019/CVE-2019-0708-CircuitSoul_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #4

**来源**: [CVE-2019-0708-Cyb0r9_ispy.md](../2019/CVE-2019-0708-Cyb0r9_ispy.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，未经身份验证的攻击者可以利用RDP发送特制请求在目标系统上执行任意代码。

**影响版本:** Windows 7 for 32-bit Systems Service Pack 1, Windows 7 for x64-based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Core installation), Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1, Windows Server 2008 for 32-bit Systems Service Pack 2 (Core installation), Windows Server 2008 for Itanium-Based Systems Service Pack 2, Windows Server 2008 for 32-bit Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2 (Core installation)

**利用条件:** 目标系统开启RDP服务，攻击者能够通过网络连接到目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft Windows Remote Desktop Services中的远程代码执行漏洞。未经身份验证的攻击者通过RDP协议发送特制请求，可以在目标系统上执行任意代码。该漏洞影响多个版本的Windows，包括Windows 7和Windows Server 2008。

**有效性：**
根据提供的漏洞信息和搜索结果，存在可利用的POC代码。多个安全研究团队和个人已经发布了利用该漏洞的PoC，证明了其可利用性。

**投毒风险：**
提供的漏洞利用代码仅为GNU Lesser General Public License，不包含任何可执行代码，因此可以判断投毒风险非常低。但是，在实际使用漏洞利用代码时，从不可信的来源获取的PoC可能包含恶意代码，因此下载和使用之前必须进行代码审计。

**利用方式：**
1.  **RDP连接：** 攻击者首先需要通过RDP协议连接到目标系统。
2.  **构造恶意请求：** 攻击者需要构造一个特殊的RDP请求，该请求会触发RDP服务中的漏洞。
3.  **代码执行：** 当目标系统处理该恶意请求时，漏洞会被触发，允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   及时安装Microsoft发布的针对CVE-2019-0708的补丁。
*   如果无法及时安装补丁，可以禁用RDP服务或限制RDP服务的访问。
*   启用网络级别身份验证（NLA），虽然不能完全阻止攻击，但可以增加攻击难度。

**项目地址:** [Cyb0r9/ispy](https://github.com/Cyb0r9/ispy)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #5

**来源**: [CVE-2019-0708-Ekultek_BlueKeep.md](../2019/CVE-2019-0708-Ekultek_BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #6

**来源**: [CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md](../2019/CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md)

# CVE-2019-0708

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md)

## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #2

**来源**: [CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md](../2019/CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未授权的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，这是一个高危漏洞，影响多个版本的Windows操作系统。Packetstorm Security等网站上存在相关的利用代码，表明漏洞的可利用性较高。Unit 42的研究表明，可以通过不同的RDP PDU组合来实现漏洞利用。给定的漏洞利用代码`exploit.py` 目前为空，只有`import sys`语句，**因此没有任何实际的漏洞利用逻辑。这意味着它目前是无效的，并且高度怀疑是占位符或者诱饵，存在极高的投毒风险。**真正的漏洞利用通常涉及构造特定的RDP数据包，触发目标系统上的内存错误（例如，use-after-free）。由于代码不完整，无法确定具体的利用方式，但总体思路是利用RDP协议的缺陷，在内核层面执行恶意代码。

**利用方式总结：**
1.  攻击者通过RDP协议与目标系统建立连接。
2.  攻击者构造包含恶意代码的RDP数据包。
3.  目标系统解析RDP数据包时触发漏洞，导致恶意代码在内核中执行。

由于`exploit.py`内容为空，判定为投毒代码的风险极高。

**项目地址:** [CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit](https://github.com/CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #3

**来源**: [CVE-2019-0708-CircuitSoul_CVE-2019-0708.md](../2019/CVE-2019-0708-CircuitSoul_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #4

**来源**: [CVE-2019-0708-Cyb0r9_ispy.md](../2019/CVE-2019-0708-Cyb0r9_ispy.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，未经身份验证的攻击者可以利用RDP发送特制请求在目标系统上执行任意代码。

**影响版本:** Windows 7 for 32-bit Systems Service Pack 1, Windows 7 for x64-based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Core installation), Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1, Windows Server 2008 for 32-bit Systems Service Pack 2 (Core installation), Windows Server 2008 for Itanium-Based Systems Service Pack 2, Windows Server 2008 for 32-bit Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2 (Core installation)

**利用条件:** 目标系统开启RDP服务，攻击者能够通过网络连接到目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft Windows Remote Desktop Services中的远程代码执行漏洞。未经身份验证的攻击者通过RDP协议发送特制请求，可以在目标系统上执行任意代码。该漏洞影响多个版本的Windows，包括Windows 7和Windows Server 2008。

**有效性：**
根据提供的漏洞信息和搜索结果，存在可利用的POC代码。多个安全研究团队和个人已经发布了利用该漏洞的PoC，证明了其可利用性。

**投毒风险：**
提供的漏洞利用代码仅为GNU Lesser General Public License，不包含任何可执行代码，因此可以判断投毒风险非常低。但是，在实际使用漏洞利用代码时，从不可信的来源获取的PoC可能包含恶意代码，因此下载和使用之前必须进行代码审计。

**利用方式：**
1.  **RDP连接：** 攻击者首先需要通过RDP协议连接到目标系统。
2.  **构造恶意请求：** 攻击者需要构造一个特殊的RDP请求，该请求会触发RDP服务中的漏洞。
3.  **代码执行：** 当目标系统处理该恶意请求时，漏洞会被触发，允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   及时安装Microsoft发布的针对CVE-2019-0708的补丁。
*   如果无法及时安装补丁，可以禁用RDP服务或限制RDP服务的访问。
*   启用网络级别身份验证（NLA），虽然不能完全阻止攻击，但可以增加攻击难度。

**项目地址:** [Cyb0r9/ispy](https://github.com/Cyb0r9/ispy)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #5

**来源**: [CVE-2019-0708-Ekultek_BlueKeep.md](../2019/CVE-2019-0708-Ekultek_BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #6

**来源**: [CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md](../2019/CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md)

# CVE-2019-0708

> 📦 该CVE有 **23** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-AaronCaiii_CVE-2019-0708-POC.md)

## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #2

**来源**: [CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md](../2019/CVE-2019-0708-CPT-Jack-A-Castle_Haruster-CVE-2019-0708-Exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未授权的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，这是一个高危漏洞，影响多个版本的Windows操作系统。Packetstorm Security等网站上存在相关的利用代码，表明漏洞的可利用性较高。Unit 42的研究表明，可以通过不同的RDP PDU组合来实现漏洞利用。给定的漏洞利用代码`exploit.py` 目前为空，只有`import sys`语句，**因此没有任何实际的漏洞利用逻辑。这意味着它目前是无效的，并且高度怀疑是占位符或者诱饵，存在极高的投毒风险。**真正的漏洞利用通常涉及构造特定的RDP数据包，触发目标系统上的内存错误（例如，use-after-free）。由于代码不完整，无法确定具体的利用方式，但总体思路是利用RDP协议的缺陷，在内核层面执行恶意代码。

**利用方式总结：**
1.  攻击者通过RDP协议与目标系统建立连接。
2.  攻击者构造包含恶意代码的RDP数据包。
3.  目标系统解析RDP数据包时触发漏洞，导致恶意代码在内核中执行。

由于`exploit.py`内容为空，判定为投毒代码的风险极高。

**项目地址:** [CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit](https://github.com/CPT-Jack-A-Castle/Haruster-CVE-2019-0708-Exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #3

**来源**: [CVE-2019-0708-CircuitSoul_CVE-2019-0708.md](../2019/CVE-2019-0708-CircuitSoul_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows XP, Windows Server 2003

**利用条件:** 目标系统开启RDP服务 (3389端口)且未安装补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性：**
提供的POC代码 `poc.py` 尝试通过构造特定的RDP数据包触发漏洞。根据漏洞库信息和搜索结果，此漏洞POC曾经被广泛研究和利用，所以具备一定的有效性，但成功利用可能需要根据目标系统的具体环境进行调整，例如偏移地址等。

**投毒风险：**
分析`poc.py`代码，发现一些可疑字符串。如`buf2`变量，包含“you play basketball like caixukun”的字符串，`sc`变量包含“mshta vbscr”，表明作者可能插入了一些后门代码进行恶意利用，结合`README.md`中提及支持的操作系统版本，初步判断该POC存在一定的投毒风险，风险比例约为10%。因为该漏洞本身就是RCE，直接利用执行shellcode更为常见，加入mshta这种方式，容易被检测。

**利用方式：**
1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP数据包，该数据包包含精心构造的恶意负载，利用通道分配表(Channel ID)中的Use-After-Free漏洞。
3.  目标系统的RDP服务处理恶意数据包时，触发Use-After-Free漏洞，导致服务崩溃或允许攻击者执行任意代码。
4.  攻击者可以使用此漏洞安装恶意软件、修改数据或执行其他恶意操作。

**项目地址:** [CircuitSoul/CVE-2019-0708](https://github.com/CircuitSoul/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #4

**来源**: [CVE-2019-0708-Cyb0r9_ispy.md](../2019/CVE-2019-0708-Cyb0r9_ispy.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，未经身份验证的攻击者可以利用RDP发送特制请求在目标系统上执行任意代码。

**影响版本:** Windows 7 for 32-bit Systems Service Pack 1, Windows 7 for x64-based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Core installation), Windows Server 2008 R2 for Itanium-Based Systems Service Pack 1, Windows Server 2008 R2 for x64-based Systems Service Pack 1, Windows Server 2008 for 32-bit Systems Service Pack 2 (Core installation), Windows Server 2008 for Itanium-Based Systems Service Pack 2, Windows Server 2008 for 32-bit Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2, Windows Server 2008 for x64-based Systems Service Pack 2 (Core installation)

**利用条件:** 目标系统开启RDP服务，攻击者能够通过网络连接到目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft Windows Remote Desktop Services中的远程代码执行漏洞。未经身份验证的攻击者通过RDP协议发送特制请求，可以在目标系统上执行任意代码。该漏洞影响多个版本的Windows，包括Windows 7和Windows Server 2008。

**有效性：**
根据提供的漏洞信息和搜索结果，存在可利用的POC代码。多个安全研究团队和个人已经发布了利用该漏洞的PoC，证明了其可利用性。

**投毒风险：**
提供的漏洞利用代码仅为GNU Lesser General Public License，不包含任何可执行代码，因此可以判断投毒风险非常低。但是，在实际使用漏洞利用代码时，从不可信的来源获取的PoC可能包含恶意代码，因此下载和使用之前必须进行代码审计。

**利用方式：**
1.  **RDP连接：** 攻击者首先需要通过RDP协议连接到目标系统。
2.  **构造恶意请求：** 攻击者需要构造一个特殊的RDP请求，该请求会触发RDP服务中的漏洞。
3.  **代码执行：** 当目标系统处理该恶意请求时，漏洞会被触发，允许攻击者在目标系统上执行任意代码。

**缓解措施：**
*   及时安装Microsoft发布的针对CVE-2019-0708的补丁。
*   如果无法及时安装补丁，可以禁用RDP服务或限制RDP服务的访问。
*   启用网络级别身份验证（NLA），虽然不能完全阻止攻击，但可以增加攻击难度。

**项目地址:** [Cyb0r9/ispy](https://github.com/Cyb0r9/ispy)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #5

**来源**: [CVE-2019-0708-Ekultek_BlueKeep.md](../2019/CVE-2019-0708-Ekultek_BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #6

**来源**: [CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md](../2019/CVE-2019-0708-Pa55w0rd_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1等

**利用条件:** 目标系统开启RDP服务 (默认端口3389)，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而远程执行任意代码。根据漏洞库信息，该漏洞影响包括Windows 7 SP1、Windows Server 2008 SP2和Windows Server 2008 R2 SP1等多个版本。搜索结果表明该漏洞影响范围广且危害严重，存在多个可用的利用代码。

提供的漏洞利用代码包含一个Python脚本（`cve-2019-0708_v1.py`）和一个360 RDP漏洞无损扫描器（`0708detector.exe`）。该脚本使用`0708detector.exe`进行批量扫描，判断目标主机是否存在CVE-2019-0708漏洞。脚本首先通过telnet判断目标端口3389是否开放，然后调用360的扫描器进行检测。脚本支持单个IP、CIDR格式的IP段以及IP地址文件作为目标。

**利用方式：**

1.  使用Python脚本 `cve-2019-0708_v1.py`，指定目标IP地址或IP地址列表文件。
2.  脚本首先尝试通过Telnet连接目标主机的3389端口，判断RDP服务是否开启。
3.  如果端口开放，脚本会调用360无损扫描器`0708detector.exe`对目标主机进行漏洞检测。
4.  扫描器返回结果，脚本会判断目标主机是否存在CVE-2019-0708漏洞，并将结果输出到屏幕和`result.txt`文件中。
5.  还可以使用Metasploit的 auxiliary/scanner/rdp/cve_2019_0708_bluekeep 模块进行检测。

**有效性：**

提供的POC代码，尤其是360的扫描器，主要用于检测漏洞的存在，而不是直接进行利用。根据搜索结果，存在其他可用于实际利用该漏洞的代码，但这里提供的代码主要是为了确认目标是否易受攻击。因此，该POC代码的有效性在于其检测能力。

**投毒风险：**

投毒风险较低，约为5%。

*   Python脚本 `cve-2019-0708_v1.py` 代码较为简单，主要功能是调用外部程序，没有明显的恶意代码。
*   `0708detector.exe` 是360公司提供的扫描器，虽然需要信任第三方提供的二进制文件，但根据描述其为无损扫描器，理论上不会对系统造成破坏。但仍存在被篡改的风险。建议校验MD5和SHA256值。
*   脚本中subprocess.getoutput可能存在命令注入风险，但结合脚本逻辑，风险较低。
*   脚本中没有发现明显的恶意代码，但仍需谨慎使用，避免在生产环境中直接运行未经验证的POC代码。

**项目地址:** [Pa55w0rd/CVE-2019-0708](https://github.com/Pa55w0rd/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #7

**来源**: [CVE-2019-0708-RICSecLab_CVE-2019-0708.md](../2019/CVE-2019-0708-RICSecLab_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows 7, Windows Server 2008等受影响版本

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而触发漏洞并执行任意代码。该漏洞是一个“Use-After-Free”漏洞。从搜索引擎结果和漏洞库信息来看，已经存在可用的PoC代码。提供的漏洞利用代码只是Apache 2.0许可协议，并非实际的漏洞利用代码，所以无法判断其有效性。该文件仅为许可协议，不包含任何可执行代码，因此可以判断该文件不存在投毒风险。利用方式主要通过构造恶意的RDP请求，触发目标系统中的内存错误（Use-After-Free），进而实现任意代码执行。根据CISA的已知被利用漏洞目录，该漏洞已经被积极利用。

**漏洞利用方式：**

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发目标系统中的Use-After-Free漏洞。
3.  攻击者利用漏洞在目标系统上执行任意代码，实现远程控制。

由于提供的代码仅为 LICENSE 文件，并未包含任何攻击代码，因此投毒风险为0%。

**项目地址:** [RICSecLab/CVE-2019-0708](https://github.com/RICSecLab/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #8

**来源**: [CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md](../2019/CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #9

**来源**: [CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #10

**来源**: [CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md](../2019/CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统启用RDP，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制请求来利用此漏洞。漏洞存在于处理RDP连接的`Remote Desktop Services` (以前称为 `Terminal Services`) 中。成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，存在公开可用的PoC代码，表明该漏洞可以被成功利用。

**投毒风险：** 提供的代码片段是GNU通用公共许可证，不包含任何可执行代码，因此投毒风险为0%。完整的PoC代码可能包含恶意载荷，但仅凭许可证内容无法判断。

**利用方式：**
1.  攻击者需要找到一个启用RDP但未打补丁的Windows系统。
2.  攻击者使用特定的RDP客户端或自定义脚本，发送精心构造的RDP请求到目标系统。
3.  这些特制的请求会触发远程桌面服务中的漏洞，导致内存破坏（Use-After-Free）。
4.  攻击者利用内存破坏漏洞执行任意代码，从而完全控制目标系统。Unit 42的文章 (https://unit42.paloaltonetworks.com/cve-2019-0708-bluekeep/)  中提及了利用`Refresh Rect PDU` 和 `RDPDR Client Name Request PDU` 结合实现RCE。

多个搜索结果都指向了BlueKeep的利用和缓解措施，确认了漏洞的存在和危害。

**项目地址:** [algo7/bluekeep_CVE-2019-0708_poc_to_exploit](https://github.com/algo7/bluekeep_CVE-2019-0708_poc_to_exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #11

**来源**: [CVE-2019-0708-andripwn_CVE-2019-0708.md](../2019/CVE-2019-0708-andripwn_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #12

**来源**: [CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #13

**来源**: [CVE-2019-0708-davidfortytwo_bluekeep.md](../2019/CVE-2019-0708-davidfortytwo_bluekeep.md)

## CVE-2019-0708-Windows RDP 远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。根据漏洞库信息和搜索结果，存在公开可用的漏洞利用代码。提供的代码片段是GNU通用公共许可证，并非漏洞利用代码本身。因此，需要进一步搜索和确认具体的漏洞利用代码。根据搜索结果，Unit 42的文章详细描述了如何利用此漏洞，并且Packet Storm Security也提供了相关的PoC代码，从而验证了漏洞的有效性。虽然漏洞本身具有极高的危害性，但目前提供的代码片段仅为许可证文件，因此投毒风险为0%。利用方式通常涉及构建包含恶意RDP PDU的特殊数据包，通过RDP协议发送到目标系统，触发目标系统的内存破坏，从而实现远程代码执行。

**有效性:** 高，存在公开可用的PoC。
**投毒风险:** 0%，提供的代码片段为GNU通用公共许可证。
**利用方式:** 通过RDP协议发送特制的请求，触发目标系统的内存破坏，执行任意代码。

**项目地址:** [davidfortytwo/bluekeep](https://github.com/davidfortytwo/bluekeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #14

**来源**: [CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md](../2019/CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md)

## CVE-2019-0708 - BlueKeep RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致完全控制目标系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且攻击者能够建立RDP连接（无需身份验证）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码段只是许可证），可以确认该漏洞的POC是存在的，并且已经被广泛研究和利用。搜索结果中多个链接指向了BlueKeep漏洞的利用分析和缓解措施。

**投毒风险：**
提供的漏洞利用代码仅包含 Academic Free License (“AFL”) v. 3.0 许可协议，没有发现任何恶意代码。因此，投毒风险评估为0%。需要注意的是，完整的漏洞利用代码未提供，不能排除在真实的漏洞利用代码中存在投毒的可能。

**利用方式：**
根据漏洞信息和搜索结果，BlueKeep漏洞的利用方式如下：
1.  攻击者与目标系统建立RDP连接。
2.  攻击者发送特制的RDP请求，触发RDP服务中的漏洞。
3.  该漏洞是一个use-after-free漏洞，允许攻击者在内核模式下执行任意代码。
4.  攻击者可以利用该漏洞安装恶意软件、窃取敏感数据或进行其他恶意活动。

多个搜索结果表明，该漏洞可以使用多种不同的RDP PDU（协议数据单元）组合利用，例如 Refresh Rect PDU 和 RDPDR Client Name Request PDU。 Unit 42 的博客文章对多种利用方式进行了详细分析。

**项目地址:** [go-bi/CVE-2019-0708-EXP-Windows](https://github.com/go-bi/CVE-2019-0708-EXP-Windows)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #15

**来源**: [CVE-2019-0708-hualy13_CVE-2019-0708-Check.md](../2019/CVE-2019-0708-hualy13_CVE-2019-0708-Check.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #16

**来源**: [CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md)

## CVE-2019-0708-Windows-RDP远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁。攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）。未经身份验证的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而执行任意代码。漏洞的根源在于`Use-After-Free`，攻击者可以通过精心构造的RDP数据包，触发对已释放内存的访问，进而控制程序流程。提供的Python POC代码首先使用`zlib`和`base64`进行解码，这增加了代码混淆的难度，也增加了投毒的可能性。虽然代码的主要目的是利用BlueKeep漏洞，但解压缩后的代码可能包含后门或者其他恶意代码，虽然可能性较低（10%），但是需要进一步分析，才能完全确定。根据搜索结果，该漏洞已经被广泛研究和利用，存在多种利用方法，包括结合`Refresh Rect PDU`和`RDPDR Client Name Request PDU`进行RCE。漏洞影响的系统包括Windows 7 SP1和Windows Server 2008等版本，需要及时安装补丁。

**项目地址:** [isabelacostaz/CVE-2019-0708-POC](https://github.com/isabelacostaz/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #17

**来源**: [CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md](../2019/CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于微软远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2019-0708 是一个严重的安全漏洞，并且存在公开可用的漏洞利用代码。搜索结果中来自 Palo Alto Networks Unit 42 的报告详细介绍了利用该漏洞的三种方法，表明该漏洞的利用是可行的。CISA 将此漏洞列入已知被利用的漏洞目录中，进一步证明了其有效性。

**投毒风险：**
提供的 POC 代码 `MS12-002-POC.py` 似乎是 CVE-2019-0708 漏洞的早期尝试利用，可能不是最可靠的版本。代码中包含大量的硬编码数据包，这在一定程度上限制了其通用性。此外，代码包含一个变量 `sc` 包含 shellcode，该 shellcode 最终执行 `mshta vbscript`，显示一个消息框。如果作者的目的是创建具有恶意目的的PoC(投毒代码)，而不是漏洞利用验证，该消息框可以被替换为更危险的操作，如执行任意命令或下载恶意软件。
尽管消息框看起来是良性的，但它仍然可能被用来掩盖恶意行为。通过结合网络信息检索，发现此PoC来源于 k8gege，是一个比较早期但是仍然有效的PoC，可以认定投毒风险较低。

根据代码分析来看, 代码比较老旧, 具有一定的投毒风险(比如将 messagebox 修改为执行恶意代码), 但是可能性较小，风险评估为 10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  **连接目标 RDP 服务：** 攻击者首先需要通过 RDP 协议连接到目标系统。
2.  **发送特制请求：** 攻击者构造包含恶意数据的 RDP 请求，这些请求会触发目标系统上的内存损坏或利用漏洞。
3.  **执行任意代码：** 如果漏洞利用成功，攻击者就可以在目标系统上执行任意代码，从而获得系统控制权。

`MS12-002-POC.py` 代码的利用方式如下：
1.  **建立 Socket 连接：** 使用 Python 的 `socket` 库建立与目标主机 RDP 端口（默认为 3389）的 TCP 连接。
2.  **发送恶意 RDP 数据包：** 将预先构造的恶意 RDP 数据包（存储在变量 `buf` 中）发送到目标主机。
3.  **触发漏洞：** 恶意数据包的发送会触发目标系统 RDP 服务中的漏洞，导致代码执行。

需要注意的是，成功利用此漏洞可能需要根据目标系统的具体环境进行调整，例如操作系统版本和已安装的补丁。

**项目地址:** [lisinan988/CVE-2019-0708-scan](https://github.com/lisinan988/CVE-2019-0708-scan)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #18

**来源**: [CVE-2019-0708-nochemax_bLuEkEeP-GUI.md](../2019/CVE-2019-0708-nochemax_bLuEkEeP-GUI.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #19

**来源**: [CVE-2019-0708-offensity_CVE-2019-0708.md](../2019/CVE-2019-0708-offensity_CVE-2019-0708.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。漏洞的根本原因是use-after-free。根据搜索结果，该漏洞影响Windows 7、Windows Server 2008 和 Windows Server 2008 R2。有很多公开可用的PoC代码，表明该漏洞容易被利用。

提供的漏洞利用代码只是一个Apache License 2.0的文本，没有任何实际的利用代码。因此，我们无法通过分析该代码来确认漏洞利用的有效性。不过，根据漏洞库信息和搜索结果，该漏洞已被广泛研究并存在可用的利用代码。

由于提供的代码仅仅是license文件，因此其中不存在投毒代码。

利用方式：
1.  攻击者使用RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**项目地址:** [offensity/CVE-2019-0708](https://github.com/offensity/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #20

**来源**: [CVE-2019-0708-pywc_CVE-2019-0708.md](../2019/CVE-2019-0708-pywc_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可远程代码执行，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（3389端口），且未安装相应补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于 Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 连接发送特制请求来触发此漏洞，从而在目标系统上执行任意代码。

**有效性评估：**

提供的`poc.py`代码看起来是一个利用 CVE-2019-0708 漏洞的 PoC（概念验证）脚本。它包含建立 RDP 连接并发送恶意数据包所需的步骤，例如 X.224 连接请求和 MCS 连接初始 PDU。 根据搜索引擎结果，存在多个关于 BlueKeep 的利用方法，该 PoC 尝试触发漏洞以导致蓝屏死机 (BSOD)。

**投毒风险评估：**

分析了提供的 PoC 代码，发现以下风险点，但不能完全确定为投毒：

1.  **依赖 OpenSSL 库：** PoC 使用 OpenSSL 库进行 TLS 握手。虽然 OpenSSL 是一个常用的库，但也可能存在潜在的漏洞或配置问题，攻击者可以利用这些问题在受害者系统上执行恶意代码。但是，正常的TLS链接也依赖于此。
2.  **异常处理不足：** PoC 中的异常处理可能不足，未能充分处理连接错误、数据接收错误或 TLS 握手失败等情况。这可能导致 PoC 在某些情况下崩溃，或在受害者系统上留下不稳定的状态。
3.  **目的单一：** 该POC目标为BSOD，若修改为植入后门等恶意代码，则更具危害性，应关注后续利用。

考虑到以上风险点以及PoC的复杂性，我给予10%的投毒风险评估。

**漏洞利用方式分析：**

1.  **RDP 连接初始化：** PoC 首先建立与目标系统的 RDP 连接。这涉及发送 X.224 连接请求 PDU 并执行 TLS 握手。
2.  **MCS 连接建立：** 建立 TLS 连接后，PoC 发送 MCS 连接初始 PDU 以启动 MCS 连接。
3.  **触发漏洞：** PoC 的目标是发送精心构造的 RDP 数据包，以触发漏洞，可能是一个 use-after-free 漏洞。根据PacketstormSecurity的信息，存在针对此漏洞的Use-After-Free的EXP。
4.  **远程代码执行 (RCE)：** 成功利用此漏洞会导致在目标系统上执行任意代码。攻击者可以利用此漏洞来安装恶意软件、窃取敏感数据或完全控制受感染的系统。

需要注意的是，成功利用 CVE-2019-0708 需要对 RDP 协议和漏洞的内部工作原理有深入的了解。PoC 代码可能需要进行修改才能在不同的目标系统上可靠地工作。

**项目地址:** [pywc/CVE-2019-0708](https://github.com/pywc/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #21

**来源**: [CVE-2019-0708-tranqtruong_Detect-BlueKeep.md](../2019/CVE-2019-0708-tranqtruong_Detect-BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #22

**来源**: [CVE-2019-0708-umarfarook882_CVE-2019-0708.md](../2019/CVE-2019-0708-umarfarook882_CVE-2019-0708.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #23

**来源**: [CVE-2019-0708-worawit_CVE-2019-0708.md](../2019/CVE-2019-0708-worawit_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 严重，可能导致未经身份验证的远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁，攻击者需要能够通过网络访问RDP端口（默认3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，对此漏洞进行分析如下：

**有效性：**
提供的POC代码（/tmp/17697ac0c48fcbdf2173a35ac144de87/NOTE.md）描述了针对CVE-2019-0708 (BlueKeep) 在Windows 7 和 Windows Server 2008上的利用方法。搜索引擎结果也显示存在可利用的POC。漏洞利用代码的分析表明，它针对RDP服务的Use-After-Free漏洞，通过操纵信道数据（特别是MS_T120信道）来控制RIP (Instruction Pointer)，从而实现代码执行。结合漏洞库信息，可以判断该POC具有较高的有效性，能够在未经身份验证的情况下远程执行代码。

**投毒风险：**
代码仓库中存在投毒代码的可能性评估为10%。分析主要基于提供的`NOTE.md`文件，该文件仅描述了漏洞利用的技术细节，没有发现任何恶意代码或后门。漏洞利用的核心在于利用RDP协议本身的缺陷来执行代码。因此，该仓库更大的风险是代码可靠性，而不是恶意投毒。更复杂的投毒可能存在其他文件中，此处无法进行全面分析。

**利用方式：**
1.  **目标确认：** 确认目标系统运行的是受影响的Windows版本 (Windows 7, Windows Server 2008)。
2.  **RDP端口探测：**  扫描目标系统的3389端口，确定RDP服务是否开启。
3.  **非分页池喷射：** 使用 RDPSND, RDPDR, REFRESH_RECT 信道进行非分页池喷射。
4.  **触发Use-After-Free：**  发送特制的RDP请求到MS_T120信道，触发Use-After-Free漏洞，释放信道。
5.  **内存布局控制：** 通过发送大量数据到特定信道（如RDPSND或RDPDR）来控制非分页内存池的布局。
6.  **RIP控制：**  通过构造信道数据，覆盖`pdata`指针，使其指向恶意代码，最终通过间接调用指令`call [reg]`控制RIP，执行恶意代码。
7.  **Shellcode执行：**  将shellcode注入到非分页内存池中，并通过上述RIP控制流程来执行shellcode，实现远程代码执行。

**项目地址:** [worawit/CVE-2019-0708](https://github.com/worawit/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---



---

## POC #7

**来源**: [CVE-2019-0708-RICSecLab_CVE-2019-0708.md](../2019/CVE-2019-0708-RICSecLab_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows 7, Windows Server 2008等受影响版本

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而触发漏洞并执行任意代码。该漏洞是一个“Use-After-Free”漏洞。从搜索引擎结果和漏洞库信息来看，已经存在可用的PoC代码。提供的漏洞利用代码只是Apache 2.0许可协议，并非实际的漏洞利用代码，所以无法判断其有效性。该文件仅为许可协议，不包含任何可执行代码，因此可以判断该文件不存在投毒风险。利用方式主要通过构造恶意的RDP请求，触发目标系统中的内存错误（Use-After-Free），进而实现任意代码执行。根据CISA的已知被利用漏洞目录，该漏洞已经被积极利用。

**漏洞利用方式：**

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发目标系统中的Use-After-Free漏洞。
3.  攻击者利用漏洞在目标系统上执行任意代码，实现远程控制。

由于提供的代码仅为 LICENSE 文件，并未包含任何攻击代码，因此投毒风险为0%。

**项目地址:** [RICSecLab/CVE-2019-0708](https://github.com/RICSecLab/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #8

**来源**: [CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md](../2019/CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #9

**来源**: [CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #10

**来源**: [CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md](../2019/CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统启用RDP，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制请求来利用此漏洞。漏洞存在于处理RDP连接的`Remote Desktop Services` (以前称为 `Terminal Services`) 中。成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，存在公开可用的PoC代码，表明该漏洞可以被成功利用。

**投毒风险：** 提供的代码片段是GNU通用公共许可证，不包含任何可执行代码，因此投毒风险为0%。完整的PoC代码可能包含恶意载荷，但仅凭许可证内容无法判断。

**利用方式：**
1.  攻击者需要找到一个启用RDP但未打补丁的Windows系统。
2.  攻击者使用特定的RDP客户端或自定义脚本，发送精心构造的RDP请求到目标系统。
3.  这些特制的请求会触发远程桌面服务中的漏洞，导致内存破坏（Use-After-Free）。
4.  攻击者利用内存破坏漏洞执行任意代码，从而完全控制目标系统。Unit 42的文章 (https://unit42.paloaltonetworks.com/cve-2019-0708-bluekeep/)  中提及了利用`Refresh Rect PDU` 和 `RDPDR Client Name Request PDU` 结合实现RCE。

多个搜索结果都指向了BlueKeep的利用和缓解措施，确认了漏洞的存在和危害。

**项目地址:** [algo7/bluekeep_CVE-2019-0708_poc_to_exploit](https://github.com/algo7/bluekeep_CVE-2019-0708_poc_to_exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #11

**来源**: [CVE-2019-0708-andripwn_CVE-2019-0708.md](../2019/CVE-2019-0708-andripwn_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #12

**来源**: [CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #13

**来源**: [CVE-2019-0708-davidfortytwo_bluekeep.md](../2019/CVE-2019-0708-davidfortytwo_bluekeep.md)

## CVE-2019-0708-Windows RDP 远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。根据漏洞库信息和搜索结果，存在公开可用的漏洞利用代码。提供的代码片段是GNU通用公共许可证，并非漏洞利用代码本身。因此，需要进一步搜索和确认具体的漏洞利用代码。根据搜索结果，Unit 42的文章详细描述了如何利用此漏洞，并且Packet Storm Security也提供了相关的PoC代码，从而验证了漏洞的有效性。虽然漏洞本身具有极高的危害性，但目前提供的代码片段仅为许可证文件，因此投毒风险为0%。利用方式通常涉及构建包含恶意RDP PDU的特殊数据包，通过RDP协议发送到目标系统，触发目标系统的内存破坏，从而实现远程代码执行。

**有效性:** 高，存在公开可用的PoC。
**投毒风险:** 0%，提供的代码片段为GNU通用公共许可证。
**利用方式:** 通过RDP协议发送特制的请求，触发目标系统的内存破坏，执行任意代码。

**项目地址:** [davidfortytwo/bluekeep](https://github.com/davidfortytwo/bluekeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #14

**来源**: [CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md](../2019/CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md)

## CVE-2019-0708 - BlueKeep RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致完全控制目标系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且攻击者能够建立RDP连接（无需身份验证）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码段只是许可证），可以确认该漏洞的POC是存在的，并且已经被广泛研究和利用。搜索结果中多个链接指向了BlueKeep漏洞的利用分析和缓解措施。

**投毒风险：**
提供的漏洞利用代码仅包含 Academic Free License (“AFL”) v. 3.0 许可协议，没有发现任何恶意代码。因此，投毒风险评估为0%。需要注意的是，完整的漏洞利用代码未提供，不能排除在真实的漏洞利用代码中存在投毒的可能。

**利用方式：**
根据漏洞信息和搜索结果，BlueKeep漏洞的利用方式如下：
1.  攻击者与目标系统建立RDP连接。
2.  攻击者发送特制的RDP请求，触发RDP服务中的漏洞。
3.  该漏洞是一个use-after-free漏洞，允许攻击者在内核模式下执行任意代码。
4.  攻击者可以利用该漏洞安装恶意软件、窃取敏感数据或进行其他恶意活动。

多个搜索结果表明，该漏洞可以使用多种不同的RDP PDU（协议数据单元）组合利用，例如 Refresh Rect PDU 和 RDPDR Client Name Request PDU。 Unit 42 的博客文章对多种利用方式进行了详细分析。

**项目地址:** [go-bi/CVE-2019-0708-EXP-Windows](https://github.com/go-bi/CVE-2019-0708-EXP-Windows)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #15

**来源**: [CVE-2019-0708-hualy13_CVE-2019-0708-Check.md](../2019/CVE-2019-0708-hualy13_CVE-2019-0708-Check.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #16

**来源**: [CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md)

## CVE-2019-0708-Windows-RDP远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁。攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）。未经身份验证的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而执行任意代码。漏洞的根源在于`Use-After-Free`，攻击者可以通过精心构造的RDP数据包，触发对已释放内存的访问，进而控制程序流程。提供的Python POC代码首先使用`zlib`和`base64`进行解码，这增加了代码混淆的难度，也增加了投毒的可能性。虽然代码的主要目的是利用BlueKeep漏洞，但解压缩后的代码可能包含后门或者其他恶意代码，虽然可能性较低（10%），但是需要进一步分析，才能完全确定。根据搜索结果，该漏洞已经被广泛研究和利用，存在多种利用方法，包括结合`Refresh Rect PDU`和`RDPDR Client Name Request PDU`进行RCE。漏洞影响的系统包括Windows 7 SP1和Windows Server 2008等版本，需要及时安装补丁。

**项目地址:** [isabelacostaz/CVE-2019-0708-POC](https://github.com/isabelacostaz/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #17

**来源**: [CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md](../2019/CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于微软远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2019-0708 是一个严重的安全漏洞，并且存在公开可用的漏洞利用代码。搜索结果中来自 Palo Alto Networks Unit 42 的报告详细介绍了利用该漏洞的三种方法，表明该漏洞的利用是可行的。CISA 将此漏洞列入已知被利用的漏洞目录中，进一步证明了其有效性。

**投毒风险：**
提供的 POC 代码 `MS12-002-POC.py` 似乎是 CVE-2019-0708 漏洞的早期尝试利用，可能不是最可靠的版本。代码中包含大量的硬编码数据包，这在一定程度上限制了其通用性。此外，代码包含一个变量 `sc` 包含 shellcode，该 shellcode 最终执行 `mshta vbscript`，显示一个消息框。如果作者的目的是创建具有恶意目的的PoC(投毒代码)，而不是漏洞利用验证，该消息框可以被替换为更危险的操作，如执行任意命令或下载恶意软件。
尽管消息框看起来是良性的，但它仍然可能被用来掩盖恶意行为。通过结合网络信息检索，发现此PoC来源于 k8gege，是一个比较早期但是仍然有效的PoC，可以认定投毒风险较低。

根据代码分析来看, 代码比较老旧, 具有一定的投毒风险(比如将 messagebox 修改为执行恶意代码), 但是可能性较小，风险评估为 10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  **连接目标 RDP 服务：** 攻击者首先需要通过 RDP 协议连接到目标系统。
2.  **发送特制请求：** 攻击者构造包含恶意数据的 RDP 请求，这些请求会触发目标系统上的内存损坏或利用漏洞。
3.  **执行任意代码：** 如果漏洞利用成功，攻击者就可以在目标系统上执行任意代码，从而获得系统控制权。

`MS12-002-POC.py` 代码的利用方式如下：
1.  **建立 Socket 连接：** 使用 Python 的 `socket` 库建立与目标主机 RDP 端口（默认为 3389）的 TCP 连接。
2.  **发送恶意 RDP 数据包：** 将预先构造的恶意 RDP 数据包（存储在变量 `buf` 中）发送到目标主机。
3.  **触发漏洞：** 恶意数据包的发送会触发目标系统 RDP 服务中的漏洞，导致代码执行。

需要注意的是，成功利用此漏洞可能需要根据目标系统的具体环境进行调整，例如操作系统版本和已安装的补丁。

**项目地址:** [lisinan988/CVE-2019-0708-scan](https://github.com/lisinan988/CVE-2019-0708-scan)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #18

**来源**: [CVE-2019-0708-nochemax_bLuEkEeP-GUI.md](../2019/CVE-2019-0708-nochemax_bLuEkEeP-GUI.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #19

**来源**: [CVE-2019-0708-offensity_CVE-2019-0708.md](../2019/CVE-2019-0708-offensity_CVE-2019-0708.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。漏洞的根本原因是use-after-free。根据搜索结果，该漏洞影响Windows 7、Windows Server 2008 和 Windows Server 2008 R2。有很多公开可用的PoC代码，表明该漏洞容易被利用。

提供的漏洞利用代码只是一个Apache License 2.0的文本，没有任何实际的利用代码。因此，我们无法通过分析该代码来确认漏洞利用的有效性。不过，根据漏洞库信息和搜索结果，该漏洞已被广泛研究并存在可用的利用代码。

由于提供的代码仅仅是license文件，因此其中不存在投毒代码。

利用方式：
1.  攻击者使用RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**项目地址:** [offensity/CVE-2019-0708](https://github.com/offensity/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #20

**来源**: [CVE-2019-0708-pywc_CVE-2019-0708.md](../2019/CVE-2019-0708-pywc_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可远程代码执行，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（3389端口），且未安装相应补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于 Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 连接发送特制请求来触发此漏洞，从而在目标系统上执行任意代码。

**有效性评估：**

提供的`poc.py`代码看起来是一个利用 CVE-2019-0708 漏洞的 PoC（概念验证）脚本。它包含建立 RDP 连接并发送恶意数据包所需的步骤，例如 X.224 连接请求和 MCS 连接初始 PDU。 根据搜索引擎结果，存在多个关于 BlueKeep 的利用方法，该 PoC 尝试触发漏洞以导致蓝屏死机 (BSOD)。

**投毒风险评估：**

分析了提供的 PoC 代码，发现以下风险点，但不能完全确定为投毒：

1.  **依赖 OpenSSL 库：** PoC 使用 OpenSSL 库进行 TLS 握手。虽然 OpenSSL 是一个常用的库，但也可能存在潜在的漏洞或配置问题，攻击者可以利用这些问题在受害者系统上执行恶意代码。但是，正常的TLS链接也依赖于此。
2.  **异常处理不足：** PoC 中的异常处理可能不足，未能充分处理连接错误、数据接收错误或 TLS 握手失败等情况。这可能导致 PoC 在某些情况下崩溃，或在受害者系统上留下不稳定的状态。
3.  **目的单一：** 该POC目标为BSOD，若修改为植入后门等恶意代码，则更具危害性，应关注后续利用。

考虑到以上风险点以及PoC的复杂性，我给予10%的投毒风险评估。

**漏洞利用方式分析：**

1.  **RDP 连接初始化：** PoC 首先建立与目标系统的 RDP 连接。这涉及发送 X.224 连接请求 PDU 并执行 TLS 握手。
2.  **MCS 连接建立：** 建立 TLS 连接后，PoC 发送 MCS 连接初始 PDU 以启动 MCS 连接。
3.  **触发漏洞：** PoC 的目标是发送精心构造的 RDP 数据包，以触发漏洞，可能是一个 use-after-free 漏洞。根据PacketstormSecurity的信息，存在针对此漏洞的Use-After-Free的EXP。
4.  **远程代码执行 (RCE)：** 成功利用此漏洞会导致在目标系统上执行任意代码。攻击者可以利用此漏洞来安装恶意软件、窃取敏感数据或完全控制受感染的系统。

需要注意的是，成功利用 CVE-2019-0708 需要对 RDP 协议和漏洞的内部工作原理有深入的了解。PoC 代码可能需要进行修改才能在不同的目标系统上可靠地工作。

**项目地址:** [pywc/CVE-2019-0708](https://github.com/pywc/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #21

**来源**: [CVE-2019-0708-tranqtruong_Detect-BlueKeep.md](../2019/CVE-2019-0708-tranqtruong_Detect-BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #22

**来源**: [CVE-2019-0708-umarfarook882_CVE-2019-0708.md](../2019/CVE-2019-0708-umarfarook882_CVE-2019-0708.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #23

**来源**: [CVE-2019-0708-worawit_CVE-2019-0708.md](../2019/CVE-2019-0708-worawit_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 严重，可能导致未经身份验证的远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁，攻击者需要能够通过网络访问RDP端口（默认3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，对此漏洞进行分析如下：

**有效性：**
提供的POC代码（/tmp/17697ac0c48fcbdf2173a35ac144de87/NOTE.md）描述了针对CVE-2019-0708 (BlueKeep) 在Windows 7 和 Windows Server 2008上的利用方法。搜索引擎结果也显示存在可利用的POC。漏洞利用代码的分析表明，它针对RDP服务的Use-After-Free漏洞，通过操纵信道数据（特别是MS_T120信道）来控制RIP (Instruction Pointer)，从而实现代码执行。结合漏洞库信息，可以判断该POC具有较高的有效性，能够在未经身份验证的情况下远程执行代码。

**投毒风险：**
代码仓库中存在投毒代码的可能性评估为10%。分析主要基于提供的`NOTE.md`文件，该文件仅描述了漏洞利用的技术细节，没有发现任何恶意代码或后门。漏洞利用的核心在于利用RDP协议本身的缺陷来执行代码。因此，该仓库更大的风险是代码可靠性，而不是恶意投毒。更复杂的投毒可能存在其他文件中，此处无法进行全面分析。

**利用方式：**
1.  **目标确认：** 确认目标系统运行的是受影响的Windows版本 (Windows 7, Windows Server 2008)。
2.  **RDP端口探测：**  扫描目标系统的3389端口，确定RDP服务是否开启。
3.  **非分页池喷射：** 使用 RDPSND, RDPDR, REFRESH_RECT 信道进行非分页池喷射。
4.  **触发Use-After-Free：**  发送特制的RDP请求到MS_T120信道，触发Use-After-Free漏洞，释放信道。
5.  **内存布局控制：** 通过发送大量数据到特定信道（如RDPSND或RDPDR）来控制非分页内存池的布局。
6.  **RIP控制：**  通过构造信道数据，覆盖`pdata`指针，使其指向恶意代码，最终通过间接调用指令`call [reg]`控制RIP，执行恶意代码。
7.  **Shellcode执行：**  将shellcode注入到非分页内存池中，并通过上述RIP控制流程来执行shellcode，实现远程代码执行。

**项目地址:** [worawit/CVE-2019-0708](https://github.com/worawit/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---



---

## POC #7

**来源**: [CVE-2019-0708-RICSecLab_CVE-2019-0708.md](../2019/CVE-2019-0708-RICSecLab_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows 7, Windows Server 2008等受影响版本

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而触发漏洞并执行任意代码。该漏洞是一个“Use-After-Free”漏洞。从搜索引擎结果和漏洞库信息来看，已经存在可用的PoC代码。提供的漏洞利用代码只是Apache 2.0许可协议，并非实际的漏洞利用代码，所以无法判断其有效性。该文件仅为许可协议，不包含任何可执行代码，因此可以判断该文件不存在投毒风险。利用方式主要通过构造恶意的RDP请求，触发目标系统中的内存错误（Use-After-Free），进而实现任意代码执行。根据CISA的已知被利用漏洞目录，该漏洞已经被积极利用。

**漏洞利用方式：**

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发目标系统中的Use-After-Free漏洞。
3.  攻击者利用漏洞在目标系统上执行任意代码，实现远程控制。

由于提供的代码仅为 LICENSE 文件，并未包含任何攻击代码，因此投毒风险为0%。

**项目地址:** [RICSecLab/CVE-2019-0708](https://github.com/RICSecLab/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #8

**来源**: [CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md](../2019/CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #9

**来源**: [CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #10

**来源**: [CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md](../2019/CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统启用RDP，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制请求来利用此漏洞。漏洞存在于处理RDP连接的`Remote Desktop Services` (以前称为 `Terminal Services`) 中。成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，存在公开可用的PoC代码，表明该漏洞可以被成功利用。

**投毒风险：** 提供的代码片段是GNU通用公共许可证，不包含任何可执行代码，因此投毒风险为0%。完整的PoC代码可能包含恶意载荷，但仅凭许可证内容无法判断。

**利用方式：**
1.  攻击者需要找到一个启用RDP但未打补丁的Windows系统。
2.  攻击者使用特定的RDP客户端或自定义脚本，发送精心构造的RDP请求到目标系统。
3.  这些特制的请求会触发远程桌面服务中的漏洞，导致内存破坏（Use-After-Free）。
4.  攻击者利用内存破坏漏洞执行任意代码，从而完全控制目标系统。Unit 42的文章 (https://unit42.paloaltonetworks.com/cve-2019-0708-bluekeep/)  中提及了利用`Refresh Rect PDU` 和 `RDPDR Client Name Request PDU` 结合实现RCE。

多个搜索结果都指向了BlueKeep的利用和缓解措施，确认了漏洞的存在和危害。

**项目地址:** [algo7/bluekeep_CVE-2019-0708_poc_to_exploit](https://github.com/algo7/bluekeep_CVE-2019-0708_poc_to_exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #11

**来源**: [CVE-2019-0708-andripwn_CVE-2019-0708.md](../2019/CVE-2019-0708-andripwn_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #12

**来源**: [CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #13

**来源**: [CVE-2019-0708-davidfortytwo_bluekeep.md](../2019/CVE-2019-0708-davidfortytwo_bluekeep.md)

## CVE-2019-0708-Windows RDP 远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。根据漏洞库信息和搜索结果，存在公开可用的漏洞利用代码。提供的代码片段是GNU通用公共许可证，并非漏洞利用代码本身。因此，需要进一步搜索和确认具体的漏洞利用代码。根据搜索结果，Unit 42的文章详细描述了如何利用此漏洞，并且Packet Storm Security也提供了相关的PoC代码，从而验证了漏洞的有效性。虽然漏洞本身具有极高的危害性，但目前提供的代码片段仅为许可证文件，因此投毒风险为0%。利用方式通常涉及构建包含恶意RDP PDU的特殊数据包，通过RDP协议发送到目标系统，触发目标系统的内存破坏，从而实现远程代码执行。

**有效性:** 高，存在公开可用的PoC。
**投毒风险:** 0%，提供的代码片段为GNU通用公共许可证。
**利用方式:** 通过RDP协议发送特制的请求，触发目标系统的内存破坏，执行任意代码。

**项目地址:** [davidfortytwo/bluekeep](https://github.com/davidfortytwo/bluekeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #14

**来源**: [CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md](../2019/CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md)

## CVE-2019-0708 - BlueKeep RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致完全控制目标系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且攻击者能够建立RDP连接（无需身份验证）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码段只是许可证），可以确认该漏洞的POC是存在的，并且已经被广泛研究和利用。搜索结果中多个链接指向了BlueKeep漏洞的利用分析和缓解措施。

**投毒风险：**
提供的漏洞利用代码仅包含 Academic Free License (“AFL”) v. 3.0 许可协议，没有发现任何恶意代码。因此，投毒风险评估为0%。需要注意的是，完整的漏洞利用代码未提供，不能排除在真实的漏洞利用代码中存在投毒的可能。

**利用方式：**
根据漏洞信息和搜索结果，BlueKeep漏洞的利用方式如下：
1.  攻击者与目标系统建立RDP连接。
2.  攻击者发送特制的RDP请求，触发RDP服务中的漏洞。
3.  该漏洞是一个use-after-free漏洞，允许攻击者在内核模式下执行任意代码。
4.  攻击者可以利用该漏洞安装恶意软件、窃取敏感数据或进行其他恶意活动。

多个搜索结果表明，该漏洞可以使用多种不同的RDP PDU（协议数据单元）组合利用，例如 Refresh Rect PDU 和 RDPDR Client Name Request PDU。 Unit 42 的博客文章对多种利用方式进行了详细分析。

**项目地址:** [go-bi/CVE-2019-0708-EXP-Windows](https://github.com/go-bi/CVE-2019-0708-EXP-Windows)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #15

**来源**: [CVE-2019-0708-hualy13_CVE-2019-0708-Check.md](../2019/CVE-2019-0708-hualy13_CVE-2019-0708-Check.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #16

**来源**: [CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md)

## CVE-2019-0708-Windows-RDP远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁。攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）。未经身份验证的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而执行任意代码。漏洞的根源在于`Use-After-Free`，攻击者可以通过精心构造的RDP数据包，触发对已释放内存的访问，进而控制程序流程。提供的Python POC代码首先使用`zlib`和`base64`进行解码，这增加了代码混淆的难度，也增加了投毒的可能性。虽然代码的主要目的是利用BlueKeep漏洞，但解压缩后的代码可能包含后门或者其他恶意代码，虽然可能性较低（10%），但是需要进一步分析，才能完全确定。根据搜索结果，该漏洞已经被广泛研究和利用，存在多种利用方法，包括结合`Refresh Rect PDU`和`RDPDR Client Name Request PDU`进行RCE。漏洞影响的系统包括Windows 7 SP1和Windows Server 2008等版本，需要及时安装补丁。

**项目地址:** [isabelacostaz/CVE-2019-0708-POC](https://github.com/isabelacostaz/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #17

**来源**: [CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md](../2019/CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于微软远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2019-0708 是一个严重的安全漏洞，并且存在公开可用的漏洞利用代码。搜索结果中来自 Palo Alto Networks Unit 42 的报告详细介绍了利用该漏洞的三种方法，表明该漏洞的利用是可行的。CISA 将此漏洞列入已知被利用的漏洞目录中，进一步证明了其有效性。

**投毒风险：**
提供的 POC 代码 `MS12-002-POC.py` 似乎是 CVE-2019-0708 漏洞的早期尝试利用，可能不是最可靠的版本。代码中包含大量的硬编码数据包，这在一定程度上限制了其通用性。此外，代码包含一个变量 `sc` 包含 shellcode，该 shellcode 最终执行 `mshta vbscript`，显示一个消息框。如果作者的目的是创建具有恶意目的的PoC(投毒代码)，而不是漏洞利用验证，该消息框可以被替换为更危险的操作，如执行任意命令或下载恶意软件。
尽管消息框看起来是良性的，但它仍然可能被用来掩盖恶意行为。通过结合网络信息检索，发现此PoC来源于 k8gege，是一个比较早期但是仍然有效的PoC，可以认定投毒风险较低。

根据代码分析来看, 代码比较老旧, 具有一定的投毒风险(比如将 messagebox 修改为执行恶意代码), 但是可能性较小，风险评估为 10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  **连接目标 RDP 服务：** 攻击者首先需要通过 RDP 协议连接到目标系统。
2.  **发送特制请求：** 攻击者构造包含恶意数据的 RDP 请求，这些请求会触发目标系统上的内存损坏或利用漏洞。
3.  **执行任意代码：** 如果漏洞利用成功，攻击者就可以在目标系统上执行任意代码，从而获得系统控制权。

`MS12-002-POC.py` 代码的利用方式如下：
1.  **建立 Socket 连接：** 使用 Python 的 `socket` 库建立与目标主机 RDP 端口（默认为 3389）的 TCP 连接。
2.  **发送恶意 RDP 数据包：** 将预先构造的恶意 RDP 数据包（存储在变量 `buf` 中）发送到目标主机。
3.  **触发漏洞：** 恶意数据包的发送会触发目标系统 RDP 服务中的漏洞，导致代码执行。

需要注意的是，成功利用此漏洞可能需要根据目标系统的具体环境进行调整，例如操作系统版本和已安装的补丁。

**项目地址:** [lisinan988/CVE-2019-0708-scan](https://github.com/lisinan988/CVE-2019-0708-scan)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #18

**来源**: [CVE-2019-0708-nochemax_bLuEkEeP-GUI.md](../2019/CVE-2019-0708-nochemax_bLuEkEeP-GUI.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #19

**来源**: [CVE-2019-0708-offensity_CVE-2019-0708.md](../2019/CVE-2019-0708-offensity_CVE-2019-0708.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。漏洞的根本原因是use-after-free。根据搜索结果，该漏洞影响Windows 7、Windows Server 2008 和 Windows Server 2008 R2。有很多公开可用的PoC代码，表明该漏洞容易被利用。

提供的漏洞利用代码只是一个Apache License 2.0的文本，没有任何实际的利用代码。因此，我们无法通过分析该代码来确认漏洞利用的有效性。不过，根据漏洞库信息和搜索结果，该漏洞已被广泛研究并存在可用的利用代码。

由于提供的代码仅仅是license文件，因此其中不存在投毒代码。

利用方式：
1.  攻击者使用RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**项目地址:** [offensity/CVE-2019-0708](https://github.com/offensity/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #20

**来源**: [CVE-2019-0708-pywc_CVE-2019-0708.md](../2019/CVE-2019-0708-pywc_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可远程代码执行，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（3389端口），且未安装相应补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于 Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 连接发送特制请求来触发此漏洞，从而在目标系统上执行任意代码。

**有效性评估：**

提供的`poc.py`代码看起来是一个利用 CVE-2019-0708 漏洞的 PoC（概念验证）脚本。它包含建立 RDP 连接并发送恶意数据包所需的步骤，例如 X.224 连接请求和 MCS 连接初始 PDU。 根据搜索引擎结果，存在多个关于 BlueKeep 的利用方法，该 PoC 尝试触发漏洞以导致蓝屏死机 (BSOD)。

**投毒风险评估：**

分析了提供的 PoC 代码，发现以下风险点，但不能完全确定为投毒：

1.  **依赖 OpenSSL 库：** PoC 使用 OpenSSL 库进行 TLS 握手。虽然 OpenSSL 是一个常用的库，但也可能存在潜在的漏洞或配置问题，攻击者可以利用这些问题在受害者系统上执行恶意代码。但是，正常的TLS链接也依赖于此。
2.  **异常处理不足：** PoC 中的异常处理可能不足，未能充分处理连接错误、数据接收错误或 TLS 握手失败等情况。这可能导致 PoC 在某些情况下崩溃，或在受害者系统上留下不稳定的状态。
3.  **目的单一：** 该POC目标为BSOD，若修改为植入后门等恶意代码，则更具危害性，应关注后续利用。

考虑到以上风险点以及PoC的复杂性，我给予10%的投毒风险评估。

**漏洞利用方式分析：**

1.  **RDP 连接初始化：** PoC 首先建立与目标系统的 RDP 连接。这涉及发送 X.224 连接请求 PDU 并执行 TLS 握手。
2.  **MCS 连接建立：** 建立 TLS 连接后，PoC 发送 MCS 连接初始 PDU 以启动 MCS 连接。
3.  **触发漏洞：** PoC 的目标是发送精心构造的 RDP 数据包，以触发漏洞，可能是一个 use-after-free 漏洞。根据PacketstormSecurity的信息，存在针对此漏洞的Use-After-Free的EXP。
4.  **远程代码执行 (RCE)：** 成功利用此漏洞会导致在目标系统上执行任意代码。攻击者可以利用此漏洞来安装恶意软件、窃取敏感数据或完全控制受感染的系统。

需要注意的是，成功利用 CVE-2019-0708 需要对 RDP 协议和漏洞的内部工作原理有深入的了解。PoC 代码可能需要进行修改才能在不同的目标系统上可靠地工作。

**项目地址:** [pywc/CVE-2019-0708](https://github.com/pywc/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #21

**来源**: [CVE-2019-0708-tranqtruong_Detect-BlueKeep.md](../2019/CVE-2019-0708-tranqtruong_Detect-BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #22

**来源**: [CVE-2019-0708-umarfarook882_CVE-2019-0708.md](../2019/CVE-2019-0708-umarfarook882_CVE-2019-0708.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #23

**来源**: [CVE-2019-0708-worawit_CVE-2019-0708.md](../2019/CVE-2019-0708-worawit_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 严重，可能导致未经身份验证的远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁，攻击者需要能够通过网络访问RDP端口（默认3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，对此漏洞进行分析如下：

**有效性：**
提供的POC代码（/tmp/17697ac0c48fcbdf2173a35ac144de87/NOTE.md）描述了针对CVE-2019-0708 (BlueKeep) 在Windows 7 和 Windows Server 2008上的利用方法。搜索引擎结果也显示存在可利用的POC。漏洞利用代码的分析表明，它针对RDP服务的Use-After-Free漏洞，通过操纵信道数据（特别是MS_T120信道）来控制RIP (Instruction Pointer)，从而实现代码执行。结合漏洞库信息，可以判断该POC具有较高的有效性，能够在未经身份验证的情况下远程执行代码。

**投毒风险：**
代码仓库中存在投毒代码的可能性评估为10%。分析主要基于提供的`NOTE.md`文件，该文件仅描述了漏洞利用的技术细节，没有发现任何恶意代码或后门。漏洞利用的核心在于利用RDP协议本身的缺陷来执行代码。因此，该仓库更大的风险是代码可靠性，而不是恶意投毒。更复杂的投毒可能存在其他文件中，此处无法进行全面分析。

**利用方式：**
1.  **目标确认：** 确认目标系统运行的是受影响的Windows版本 (Windows 7, Windows Server 2008)。
2.  **RDP端口探测：**  扫描目标系统的3389端口，确定RDP服务是否开启。
3.  **非分页池喷射：** 使用 RDPSND, RDPDR, REFRESH_RECT 信道进行非分页池喷射。
4.  **触发Use-After-Free：**  发送特制的RDP请求到MS_T120信道，触发Use-After-Free漏洞，释放信道。
5.  **内存布局控制：** 通过发送大量数据到特定信道（如RDPSND或RDPDR）来控制非分页内存池的布局。
6.  **RIP控制：**  通过构造信道数据，覆盖`pdata`指针，使其指向恶意代码，最终通过间接调用指令`call [reg]`控制RIP，执行恶意代码。
7.  **Shellcode执行：**  将shellcode注入到非分页内存池中，并通过上述RIP控制流程来执行shellcode，实现远程代码执行。

**项目地址:** [worawit/CVE-2019-0708](https://github.com/worawit/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---



---

## POC #7

**来源**: [CVE-2019-0708-RICSecLab_CVE-2019-0708.md](../2019/CVE-2019-0708-RICSecLab_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows 7, Windows Server 2008等受影响版本

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而触发漏洞并执行任意代码。该漏洞是一个“Use-After-Free”漏洞。从搜索引擎结果和漏洞库信息来看，已经存在可用的PoC代码。提供的漏洞利用代码只是Apache 2.0许可协议，并非实际的漏洞利用代码，所以无法判断其有效性。该文件仅为许可协议，不包含任何可执行代码，因此可以判断该文件不存在投毒风险。利用方式主要通过构造恶意的RDP请求，触发目标系统中的内存错误（Use-After-Free），进而实现任意代码执行。根据CISA的已知被利用漏洞目录，该漏洞已经被积极利用。

**漏洞利用方式：**

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发目标系统中的Use-After-Free漏洞。
3.  攻击者利用漏洞在目标系统上执行任意代码，实现远程控制。

由于提供的代码仅为 LICENSE 文件，并未包含任何攻击代码，因此投毒风险为0%。

**项目地址:** [RICSecLab/CVE-2019-0708](https://github.com/RICSecLab/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #8

**来源**: [CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md](../2019/CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #9

**来源**: [CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #10

**来源**: [CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md](../2019/CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统启用RDP，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制请求来利用此漏洞。漏洞存在于处理RDP连接的`Remote Desktop Services` (以前称为 `Terminal Services`) 中。成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，存在公开可用的PoC代码，表明该漏洞可以被成功利用。

**投毒风险：** 提供的代码片段是GNU通用公共许可证，不包含任何可执行代码，因此投毒风险为0%。完整的PoC代码可能包含恶意载荷，但仅凭许可证内容无法判断。

**利用方式：**
1.  攻击者需要找到一个启用RDP但未打补丁的Windows系统。
2.  攻击者使用特定的RDP客户端或自定义脚本，发送精心构造的RDP请求到目标系统。
3.  这些特制的请求会触发远程桌面服务中的漏洞，导致内存破坏（Use-After-Free）。
4.  攻击者利用内存破坏漏洞执行任意代码，从而完全控制目标系统。Unit 42的文章 (https://unit42.paloaltonetworks.com/cve-2019-0708-bluekeep/)  中提及了利用`Refresh Rect PDU` 和 `RDPDR Client Name Request PDU` 结合实现RCE。

多个搜索结果都指向了BlueKeep的利用和缓解措施，确认了漏洞的存在和危害。

**项目地址:** [algo7/bluekeep_CVE-2019-0708_poc_to_exploit](https://github.com/algo7/bluekeep_CVE-2019-0708_poc_to_exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #11

**来源**: [CVE-2019-0708-andripwn_CVE-2019-0708.md](../2019/CVE-2019-0708-andripwn_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #12

**来源**: [CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #13

**来源**: [CVE-2019-0708-davidfortytwo_bluekeep.md](../2019/CVE-2019-0708-davidfortytwo_bluekeep.md)

## CVE-2019-0708-Windows RDP 远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。根据漏洞库信息和搜索结果，存在公开可用的漏洞利用代码。提供的代码片段是GNU通用公共许可证，并非漏洞利用代码本身。因此，需要进一步搜索和确认具体的漏洞利用代码。根据搜索结果，Unit 42的文章详细描述了如何利用此漏洞，并且Packet Storm Security也提供了相关的PoC代码，从而验证了漏洞的有效性。虽然漏洞本身具有极高的危害性，但目前提供的代码片段仅为许可证文件，因此投毒风险为0%。利用方式通常涉及构建包含恶意RDP PDU的特殊数据包，通过RDP协议发送到目标系统，触发目标系统的内存破坏，从而实现远程代码执行。

**有效性:** 高，存在公开可用的PoC。
**投毒风险:** 0%，提供的代码片段为GNU通用公共许可证。
**利用方式:** 通过RDP协议发送特制的请求，触发目标系统的内存破坏，执行任意代码。

**项目地址:** [davidfortytwo/bluekeep](https://github.com/davidfortytwo/bluekeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #14

**来源**: [CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md](../2019/CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md)

## CVE-2019-0708 - BlueKeep RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致完全控制目标系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且攻击者能够建立RDP连接（无需身份验证）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码段只是许可证），可以确认该漏洞的POC是存在的，并且已经被广泛研究和利用。搜索结果中多个链接指向了BlueKeep漏洞的利用分析和缓解措施。

**投毒风险：**
提供的漏洞利用代码仅包含 Academic Free License (“AFL”) v. 3.0 许可协议，没有发现任何恶意代码。因此，投毒风险评估为0%。需要注意的是，完整的漏洞利用代码未提供，不能排除在真实的漏洞利用代码中存在投毒的可能。

**利用方式：**
根据漏洞信息和搜索结果，BlueKeep漏洞的利用方式如下：
1.  攻击者与目标系统建立RDP连接。
2.  攻击者发送特制的RDP请求，触发RDP服务中的漏洞。
3.  该漏洞是一个use-after-free漏洞，允许攻击者在内核模式下执行任意代码。
4.  攻击者可以利用该漏洞安装恶意软件、窃取敏感数据或进行其他恶意活动。

多个搜索结果表明，该漏洞可以使用多种不同的RDP PDU（协议数据单元）组合利用，例如 Refresh Rect PDU 和 RDPDR Client Name Request PDU。 Unit 42 的博客文章对多种利用方式进行了详细分析。

**项目地址:** [go-bi/CVE-2019-0708-EXP-Windows](https://github.com/go-bi/CVE-2019-0708-EXP-Windows)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #15

**来源**: [CVE-2019-0708-hualy13_CVE-2019-0708-Check.md](../2019/CVE-2019-0708-hualy13_CVE-2019-0708-Check.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #16

**来源**: [CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md)

## CVE-2019-0708-Windows-RDP远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁。攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）。未经身份验证的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而执行任意代码。漏洞的根源在于`Use-After-Free`，攻击者可以通过精心构造的RDP数据包，触发对已释放内存的访问，进而控制程序流程。提供的Python POC代码首先使用`zlib`和`base64`进行解码，这增加了代码混淆的难度，也增加了投毒的可能性。虽然代码的主要目的是利用BlueKeep漏洞，但解压缩后的代码可能包含后门或者其他恶意代码，虽然可能性较低（10%），但是需要进一步分析，才能完全确定。根据搜索结果，该漏洞已经被广泛研究和利用，存在多种利用方法，包括结合`Refresh Rect PDU`和`RDPDR Client Name Request PDU`进行RCE。漏洞影响的系统包括Windows 7 SP1和Windows Server 2008等版本，需要及时安装补丁。

**项目地址:** [isabelacostaz/CVE-2019-0708-POC](https://github.com/isabelacostaz/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #17

**来源**: [CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md](../2019/CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于微软远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2019-0708 是一个严重的安全漏洞，并且存在公开可用的漏洞利用代码。搜索结果中来自 Palo Alto Networks Unit 42 的报告详细介绍了利用该漏洞的三种方法，表明该漏洞的利用是可行的。CISA 将此漏洞列入已知被利用的漏洞目录中，进一步证明了其有效性。

**投毒风险：**
提供的 POC 代码 `MS12-002-POC.py` 似乎是 CVE-2019-0708 漏洞的早期尝试利用，可能不是最可靠的版本。代码中包含大量的硬编码数据包，这在一定程度上限制了其通用性。此外，代码包含一个变量 `sc` 包含 shellcode，该 shellcode 最终执行 `mshta vbscript`，显示一个消息框。如果作者的目的是创建具有恶意目的的PoC(投毒代码)，而不是漏洞利用验证，该消息框可以被替换为更危险的操作，如执行任意命令或下载恶意软件。
尽管消息框看起来是良性的，但它仍然可能被用来掩盖恶意行为。通过结合网络信息检索，发现此PoC来源于 k8gege，是一个比较早期但是仍然有效的PoC，可以认定投毒风险较低。

根据代码分析来看, 代码比较老旧, 具有一定的投毒风险(比如将 messagebox 修改为执行恶意代码), 但是可能性较小，风险评估为 10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  **连接目标 RDP 服务：** 攻击者首先需要通过 RDP 协议连接到目标系统。
2.  **发送特制请求：** 攻击者构造包含恶意数据的 RDP 请求，这些请求会触发目标系统上的内存损坏或利用漏洞。
3.  **执行任意代码：** 如果漏洞利用成功，攻击者就可以在目标系统上执行任意代码，从而获得系统控制权。

`MS12-002-POC.py` 代码的利用方式如下：
1.  **建立 Socket 连接：** 使用 Python 的 `socket` 库建立与目标主机 RDP 端口（默认为 3389）的 TCP 连接。
2.  **发送恶意 RDP 数据包：** 将预先构造的恶意 RDP 数据包（存储在变量 `buf` 中）发送到目标主机。
3.  **触发漏洞：** 恶意数据包的发送会触发目标系统 RDP 服务中的漏洞，导致代码执行。

需要注意的是，成功利用此漏洞可能需要根据目标系统的具体环境进行调整，例如操作系统版本和已安装的补丁。

**项目地址:** [lisinan988/CVE-2019-0708-scan](https://github.com/lisinan988/CVE-2019-0708-scan)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #18

**来源**: [CVE-2019-0708-nochemax_bLuEkEeP-GUI.md](../2019/CVE-2019-0708-nochemax_bLuEkEeP-GUI.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #19

**来源**: [CVE-2019-0708-offensity_CVE-2019-0708.md](../2019/CVE-2019-0708-offensity_CVE-2019-0708.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。漏洞的根本原因是use-after-free。根据搜索结果，该漏洞影响Windows 7、Windows Server 2008 和 Windows Server 2008 R2。有很多公开可用的PoC代码，表明该漏洞容易被利用。

提供的漏洞利用代码只是一个Apache License 2.0的文本，没有任何实际的利用代码。因此，我们无法通过分析该代码来确认漏洞利用的有效性。不过，根据漏洞库信息和搜索结果，该漏洞已被广泛研究并存在可用的利用代码。

由于提供的代码仅仅是license文件，因此其中不存在投毒代码。

利用方式：
1.  攻击者使用RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**项目地址:** [offensity/CVE-2019-0708](https://github.com/offensity/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #20

**来源**: [CVE-2019-0708-pywc_CVE-2019-0708.md](../2019/CVE-2019-0708-pywc_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可远程代码执行，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（3389端口），且未安装相应补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于 Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 连接发送特制请求来触发此漏洞，从而在目标系统上执行任意代码。

**有效性评估：**

提供的`poc.py`代码看起来是一个利用 CVE-2019-0708 漏洞的 PoC（概念验证）脚本。它包含建立 RDP 连接并发送恶意数据包所需的步骤，例如 X.224 连接请求和 MCS 连接初始 PDU。 根据搜索引擎结果，存在多个关于 BlueKeep 的利用方法，该 PoC 尝试触发漏洞以导致蓝屏死机 (BSOD)。

**投毒风险评估：**

分析了提供的 PoC 代码，发现以下风险点，但不能完全确定为投毒：

1.  **依赖 OpenSSL 库：** PoC 使用 OpenSSL 库进行 TLS 握手。虽然 OpenSSL 是一个常用的库，但也可能存在潜在的漏洞或配置问题，攻击者可以利用这些问题在受害者系统上执行恶意代码。但是，正常的TLS链接也依赖于此。
2.  **异常处理不足：** PoC 中的异常处理可能不足，未能充分处理连接错误、数据接收错误或 TLS 握手失败等情况。这可能导致 PoC 在某些情况下崩溃，或在受害者系统上留下不稳定的状态。
3.  **目的单一：** 该POC目标为BSOD，若修改为植入后门等恶意代码，则更具危害性，应关注后续利用。

考虑到以上风险点以及PoC的复杂性，我给予10%的投毒风险评估。

**漏洞利用方式分析：**

1.  **RDP 连接初始化：** PoC 首先建立与目标系统的 RDP 连接。这涉及发送 X.224 连接请求 PDU 并执行 TLS 握手。
2.  **MCS 连接建立：** 建立 TLS 连接后，PoC 发送 MCS 连接初始 PDU 以启动 MCS 连接。
3.  **触发漏洞：** PoC 的目标是发送精心构造的 RDP 数据包，以触发漏洞，可能是一个 use-after-free 漏洞。根据PacketstormSecurity的信息，存在针对此漏洞的Use-After-Free的EXP。
4.  **远程代码执行 (RCE)：** 成功利用此漏洞会导致在目标系统上执行任意代码。攻击者可以利用此漏洞来安装恶意软件、窃取敏感数据或完全控制受感染的系统。

需要注意的是，成功利用 CVE-2019-0708 需要对 RDP 协议和漏洞的内部工作原理有深入的了解。PoC 代码可能需要进行修改才能在不同的目标系统上可靠地工作。

**项目地址:** [pywc/CVE-2019-0708](https://github.com/pywc/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #21

**来源**: [CVE-2019-0708-tranqtruong_Detect-BlueKeep.md](../2019/CVE-2019-0708-tranqtruong_Detect-BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #22

**来源**: [CVE-2019-0708-umarfarook882_CVE-2019-0708.md](../2019/CVE-2019-0708-umarfarook882_CVE-2019-0708.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #23

**来源**: [CVE-2019-0708-worawit_CVE-2019-0708.md](../2019/CVE-2019-0708-worawit_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 严重，可能导致未经身份验证的远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁，攻击者需要能够通过网络访问RDP端口（默认3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，对此漏洞进行分析如下：

**有效性：**
提供的POC代码（/tmp/17697ac0c48fcbdf2173a35ac144de87/NOTE.md）描述了针对CVE-2019-0708 (BlueKeep) 在Windows 7 和 Windows Server 2008上的利用方法。搜索引擎结果也显示存在可利用的POC。漏洞利用代码的分析表明，它针对RDP服务的Use-After-Free漏洞，通过操纵信道数据（特别是MS_T120信道）来控制RIP (Instruction Pointer)，从而实现代码执行。结合漏洞库信息，可以判断该POC具有较高的有效性，能够在未经身份验证的情况下远程执行代码。

**投毒风险：**
代码仓库中存在投毒代码的可能性评估为10%。分析主要基于提供的`NOTE.md`文件，该文件仅描述了漏洞利用的技术细节，没有发现任何恶意代码或后门。漏洞利用的核心在于利用RDP协议本身的缺陷来执行代码。因此，该仓库更大的风险是代码可靠性，而不是恶意投毒。更复杂的投毒可能存在其他文件中，此处无法进行全面分析。

**利用方式：**
1.  **目标确认：** 确认目标系统运行的是受影响的Windows版本 (Windows 7, Windows Server 2008)。
2.  **RDP端口探测：**  扫描目标系统的3389端口，确定RDP服务是否开启。
3.  **非分页池喷射：** 使用 RDPSND, RDPDR, REFRESH_RECT 信道进行非分页池喷射。
4.  **触发Use-After-Free：**  发送特制的RDP请求到MS_T120信道，触发Use-After-Free漏洞，释放信道。
5.  **内存布局控制：** 通过发送大量数据到特定信道（如RDPSND或RDPDR）来控制非分页内存池的布局。
6.  **RIP控制：**  通过构造信道数据，覆盖`pdata`指针，使其指向恶意代码，最终通过间接调用指令`call [reg]`控制RIP，执行恶意代码。
7.  **Shellcode执行：**  将shellcode注入到非分页内存池中，并通过上述RIP控制流程来执行shellcode，实现远程代码执行。

**项目地址:** [worawit/CVE-2019-0708](https://github.com/worawit/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---



---

## POC #7

**来源**: [CVE-2019-0708-RICSecLab_CVE-2019-0708.md](../2019/CVE-2019-0708-RICSecLab_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows 7, Windows Server 2008等受影响版本

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而触发漏洞并执行任意代码。该漏洞是一个“Use-After-Free”漏洞。从搜索引擎结果和漏洞库信息来看，已经存在可用的PoC代码。提供的漏洞利用代码只是Apache 2.0许可协议，并非实际的漏洞利用代码，所以无法判断其有效性。该文件仅为许可协议，不包含任何可执行代码，因此可以判断该文件不存在投毒风险。利用方式主要通过构造恶意的RDP请求，触发目标系统中的内存错误（Use-After-Free），进而实现任意代码执行。根据CISA的已知被利用漏洞目录，该漏洞已经被积极利用。

**漏洞利用方式：**

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发目标系统中的Use-After-Free漏洞。
3.  攻击者利用漏洞在目标系统上执行任意代码，实现远程控制。

由于提供的代码仅为 LICENSE 文件，并未包含任何攻击代码，因此投毒风险为0%。

**项目地址:** [RICSecLab/CVE-2019-0708](https://github.com/RICSecLab/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #8

**来源**: [CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md](../2019/CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #9

**来源**: [CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #10

**来源**: [CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md](../2019/CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统启用RDP，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制请求来利用此漏洞。漏洞存在于处理RDP连接的`Remote Desktop Services` (以前称为 `Terminal Services`) 中。成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，存在公开可用的PoC代码，表明该漏洞可以被成功利用。

**投毒风险：** 提供的代码片段是GNU通用公共许可证，不包含任何可执行代码，因此投毒风险为0%。完整的PoC代码可能包含恶意载荷，但仅凭许可证内容无法判断。

**利用方式：**
1.  攻击者需要找到一个启用RDP但未打补丁的Windows系统。
2.  攻击者使用特定的RDP客户端或自定义脚本，发送精心构造的RDP请求到目标系统。
3.  这些特制的请求会触发远程桌面服务中的漏洞，导致内存破坏（Use-After-Free）。
4.  攻击者利用内存破坏漏洞执行任意代码，从而完全控制目标系统。Unit 42的文章 (https://unit42.paloaltonetworks.com/cve-2019-0708-bluekeep/)  中提及了利用`Refresh Rect PDU` 和 `RDPDR Client Name Request PDU` 结合实现RCE。

多个搜索结果都指向了BlueKeep的利用和缓解措施，确认了漏洞的存在和危害。

**项目地址:** [algo7/bluekeep_CVE-2019-0708_poc_to_exploit](https://github.com/algo7/bluekeep_CVE-2019-0708_poc_to_exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #11

**来源**: [CVE-2019-0708-andripwn_CVE-2019-0708.md](../2019/CVE-2019-0708-andripwn_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #12

**来源**: [CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #13

**来源**: [CVE-2019-0708-davidfortytwo_bluekeep.md](../2019/CVE-2019-0708-davidfortytwo_bluekeep.md)

## CVE-2019-0708-Windows RDP 远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。根据漏洞库信息和搜索结果，存在公开可用的漏洞利用代码。提供的代码片段是GNU通用公共许可证，并非漏洞利用代码本身。因此，需要进一步搜索和确认具体的漏洞利用代码。根据搜索结果，Unit 42的文章详细描述了如何利用此漏洞，并且Packet Storm Security也提供了相关的PoC代码，从而验证了漏洞的有效性。虽然漏洞本身具有极高的危害性，但目前提供的代码片段仅为许可证文件，因此投毒风险为0%。利用方式通常涉及构建包含恶意RDP PDU的特殊数据包，通过RDP协议发送到目标系统，触发目标系统的内存破坏，从而实现远程代码执行。

**有效性:** 高，存在公开可用的PoC。
**投毒风险:** 0%，提供的代码片段为GNU通用公共许可证。
**利用方式:** 通过RDP协议发送特制的请求，触发目标系统的内存破坏，执行任意代码。

**项目地址:** [davidfortytwo/bluekeep](https://github.com/davidfortytwo/bluekeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #14

**来源**: [CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md](../2019/CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md)

## CVE-2019-0708 - BlueKeep RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致完全控制目标系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且攻击者能够建立RDP连接（无需身份验证）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码段只是许可证），可以确认该漏洞的POC是存在的，并且已经被广泛研究和利用。搜索结果中多个链接指向了BlueKeep漏洞的利用分析和缓解措施。

**投毒风险：**
提供的漏洞利用代码仅包含 Academic Free License (“AFL”) v. 3.0 许可协议，没有发现任何恶意代码。因此，投毒风险评估为0%。需要注意的是，完整的漏洞利用代码未提供，不能排除在真实的漏洞利用代码中存在投毒的可能。

**利用方式：**
根据漏洞信息和搜索结果，BlueKeep漏洞的利用方式如下：
1.  攻击者与目标系统建立RDP连接。
2.  攻击者发送特制的RDP请求，触发RDP服务中的漏洞。
3.  该漏洞是一个use-after-free漏洞，允许攻击者在内核模式下执行任意代码。
4.  攻击者可以利用该漏洞安装恶意软件、窃取敏感数据或进行其他恶意活动。

多个搜索结果表明，该漏洞可以使用多种不同的RDP PDU（协议数据单元）组合利用，例如 Refresh Rect PDU 和 RDPDR Client Name Request PDU。 Unit 42 的博客文章对多种利用方式进行了详细分析。

**项目地址:** [go-bi/CVE-2019-0708-EXP-Windows](https://github.com/go-bi/CVE-2019-0708-EXP-Windows)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #15

**来源**: [CVE-2019-0708-hualy13_CVE-2019-0708-Check.md](../2019/CVE-2019-0708-hualy13_CVE-2019-0708-Check.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #16

**来源**: [CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md)

## CVE-2019-0708-Windows-RDP远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁。攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）。未经身份验证的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而执行任意代码。漏洞的根源在于`Use-After-Free`，攻击者可以通过精心构造的RDP数据包，触发对已释放内存的访问，进而控制程序流程。提供的Python POC代码首先使用`zlib`和`base64`进行解码，这增加了代码混淆的难度，也增加了投毒的可能性。虽然代码的主要目的是利用BlueKeep漏洞，但解压缩后的代码可能包含后门或者其他恶意代码，虽然可能性较低（10%），但是需要进一步分析，才能完全确定。根据搜索结果，该漏洞已经被广泛研究和利用，存在多种利用方法，包括结合`Refresh Rect PDU`和`RDPDR Client Name Request PDU`进行RCE。漏洞影响的系统包括Windows 7 SP1和Windows Server 2008等版本，需要及时安装补丁。

**项目地址:** [isabelacostaz/CVE-2019-0708-POC](https://github.com/isabelacostaz/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #17

**来源**: [CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md](../2019/CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于微软远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2019-0708 是一个严重的安全漏洞，并且存在公开可用的漏洞利用代码。搜索结果中来自 Palo Alto Networks Unit 42 的报告详细介绍了利用该漏洞的三种方法，表明该漏洞的利用是可行的。CISA 将此漏洞列入已知被利用的漏洞目录中，进一步证明了其有效性。

**投毒风险：**
提供的 POC 代码 `MS12-002-POC.py` 似乎是 CVE-2019-0708 漏洞的早期尝试利用，可能不是最可靠的版本。代码中包含大量的硬编码数据包，这在一定程度上限制了其通用性。此外，代码包含一个变量 `sc` 包含 shellcode，该 shellcode 最终执行 `mshta vbscript`，显示一个消息框。如果作者的目的是创建具有恶意目的的PoC(投毒代码)，而不是漏洞利用验证，该消息框可以被替换为更危险的操作，如执行任意命令或下载恶意软件。
尽管消息框看起来是良性的，但它仍然可能被用来掩盖恶意行为。通过结合网络信息检索，发现此PoC来源于 k8gege，是一个比较早期但是仍然有效的PoC，可以认定投毒风险较低。

根据代码分析来看, 代码比较老旧, 具有一定的投毒风险(比如将 messagebox 修改为执行恶意代码), 但是可能性较小，风险评估为 10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  **连接目标 RDP 服务：** 攻击者首先需要通过 RDP 协议连接到目标系统。
2.  **发送特制请求：** 攻击者构造包含恶意数据的 RDP 请求，这些请求会触发目标系统上的内存损坏或利用漏洞。
3.  **执行任意代码：** 如果漏洞利用成功，攻击者就可以在目标系统上执行任意代码，从而获得系统控制权。

`MS12-002-POC.py` 代码的利用方式如下：
1.  **建立 Socket 连接：** 使用 Python 的 `socket` 库建立与目标主机 RDP 端口（默认为 3389）的 TCP 连接。
2.  **发送恶意 RDP 数据包：** 将预先构造的恶意 RDP 数据包（存储在变量 `buf` 中）发送到目标主机。
3.  **触发漏洞：** 恶意数据包的发送会触发目标系统 RDP 服务中的漏洞，导致代码执行。

需要注意的是，成功利用此漏洞可能需要根据目标系统的具体环境进行调整，例如操作系统版本和已安装的补丁。

**项目地址:** [lisinan988/CVE-2019-0708-scan](https://github.com/lisinan988/CVE-2019-0708-scan)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #18

**来源**: [CVE-2019-0708-nochemax_bLuEkEeP-GUI.md](../2019/CVE-2019-0708-nochemax_bLuEkEeP-GUI.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #19

**来源**: [CVE-2019-0708-offensity_CVE-2019-0708.md](../2019/CVE-2019-0708-offensity_CVE-2019-0708.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。漏洞的根本原因是use-after-free。根据搜索结果，该漏洞影响Windows 7、Windows Server 2008 和 Windows Server 2008 R2。有很多公开可用的PoC代码，表明该漏洞容易被利用。

提供的漏洞利用代码只是一个Apache License 2.0的文本，没有任何实际的利用代码。因此，我们无法通过分析该代码来确认漏洞利用的有效性。不过，根据漏洞库信息和搜索结果，该漏洞已被广泛研究并存在可用的利用代码。

由于提供的代码仅仅是license文件，因此其中不存在投毒代码。

利用方式：
1.  攻击者使用RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**项目地址:** [offensity/CVE-2019-0708](https://github.com/offensity/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #20

**来源**: [CVE-2019-0708-pywc_CVE-2019-0708.md](../2019/CVE-2019-0708-pywc_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可远程代码执行，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（3389端口），且未安装相应补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于 Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 连接发送特制请求来触发此漏洞，从而在目标系统上执行任意代码。

**有效性评估：**

提供的`poc.py`代码看起来是一个利用 CVE-2019-0708 漏洞的 PoC（概念验证）脚本。它包含建立 RDP 连接并发送恶意数据包所需的步骤，例如 X.224 连接请求和 MCS 连接初始 PDU。 根据搜索引擎结果，存在多个关于 BlueKeep 的利用方法，该 PoC 尝试触发漏洞以导致蓝屏死机 (BSOD)。

**投毒风险评估：**

分析了提供的 PoC 代码，发现以下风险点，但不能完全确定为投毒：

1.  **依赖 OpenSSL 库：** PoC 使用 OpenSSL 库进行 TLS 握手。虽然 OpenSSL 是一个常用的库，但也可能存在潜在的漏洞或配置问题，攻击者可以利用这些问题在受害者系统上执行恶意代码。但是，正常的TLS链接也依赖于此。
2.  **异常处理不足：** PoC 中的异常处理可能不足，未能充分处理连接错误、数据接收错误或 TLS 握手失败等情况。这可能导致 PoC 在某些情况下崩溃，或在受害者系统上留下不稳定的状态。
3.  **目的单一：** 该POC目标为BSOD，若修改为植入后门等恶意代码，则更具危害性，应关注后续利用。

考虑到以上风险点以及PoC的复杂性，我给予10%的投毒风险评估。

**漏洞利用方式分析：**

1.  **RDP 连接初始化：** PoC 首先建立与目标系统的 RDP 连接。这涉及发送 X.224 连接请求 PDU 并执行 TLS 握手。
2.  **MCS 连接建立：** 建立 TLS 连接后，PoC 发送 MCS 连接初始 PDU 以启动 MCS 连接。
3.  **触发漏洞：** PoC 的目标是发送精心构造的 RDP 数据包，以触发漏洞，可能是一个 use-after-free 漏洞。根据PacketstormSecurity的信息，存在针对此漏洞的Use-After-Free的EXP。
4.  **远程代码执行 (RCE)：** 成功利用此漏洞会导致在目标系统上执行任意代码。攻击者可以利用此漏洞来安装恶意软件、窃取敏感数据或完全控制受感染的系统。

需要注意的是，成功利用 CVE-2019-0708 需要对 RDP 协议和漏洞的内部工作原理有深入的了解。PoC 代码可能需要进行修改才能在不同的目标系统上可靠地工作。

**项目地址:** [pywc/CVE-2019-0708](https://github.com/pywc/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #21

**来源**: [CVE-2019-0708-tranqtruong_Detect-BlueKeep.md](../2019/CVE-2019-0708-tranqtruong_Detect-BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #22

**来源**: [CVE-2019-0708-umarfarook882_CVE-2019-0708.md](../2019/CVE-2019-0708-umarfarook882_CVE-2019-0708.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #23

**来源**: [CVE-2019-0708-worawit_CVE-2019-0708.md](../2019/CVE-2019-0708-worawit_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 严重，可能导致未经身份验证的远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁，攻击者需要能够通过网络访问RDP端口（默认3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，对此漏洞进行分析如下：

**有效性：**
提供的POC代码（/tmp/17697ac0c48fcbdf2173a35ac144de87/NOTE.md）描述了针对CVE-2019-0708 (BlueKeep) 在Windows 7 和 Windows Server 2008上的利用方法。搜索引擎结果也显示存在可利用的POC。漏洞利用代码的分析表明，它针对RDP服务的Use-After-Free漏洞，通过操纵信道数据（特别是MS_T120信道）来控制RIP (Instruction Pointer)，从而实现代码执行。结合漏洞库信息，可以判断该POC具有较高的有效性，能够在未经身份验证的情况下远程执行代码。

**投毒风险：**
代码仓库中存在投毒代码的可能性评估为10%。分析主要基于提供的`NOTE.md`文件，该文件仅描述了漏洞利用的技术细节，没有发现任何恶意代码或后门。漏洞利用的核心在于利用RDP协议本身的缺陷来执行代码。因此，该仓库更大的风险是代码可靠性，而不是恶意投毒。更复杂的投毒可能存在其他文件中，此处无法进行全面分析。

**利用方式：**
1.  **目标确认：** 确认目标系统运行的是受影响的Windows版本 (Windows 7, Windows Server 2008)。
2.  **RDP端口探测：**  扫描目标系统的3389端口，确定RDP服务是否开启。
3.  **非分页池喷射：** 使用 RDPSND, RDPDR, REFRESH_RECT 信道进行非分页池喷射。
4.  **触发Use-After-Free：**  发送特制的RDP请求到MS_T120信道，触发Use-After-Free漏洞，释放信道。
5.  **内存布局控制：** 通过发送大量数据到特定信道（如RDPSND或RDPDR）来控制非分页内存池的布局。
6.  **RIP控制：**  通过构造信道数据，覆盖`pdata`指针，使其指向恶意代码，最终通过间接调用指令`call [reg]`控制RIP，执行恶意代码。
7.  **Shellcode执行：**  将shellcode注入到非分页内存池中，并通过上述RIP控制流程来执行shellcode，实现远程代码执行。

**项目地址:** [worawit/CVE-2019-0708](https://github.com/worawit/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---



---

## POC #7

**来源**: [CVE-2019-0708-RICSecLab_CVE-2019-0708.md](../2019/CVE-2019-0708-RICSecLab_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** Windows 7, Windows Server 2008等受影响版本

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而触发漏洞并执行任意代码。该漏洞是一个“Use-After-Free”漏洞。从搜索引擎结果和漏洞库信息来看，已经存在可用的PoC代码。提供的漏洞利用代码只是Apache 2.0许可协议，并非实际的漏洞利用代码，所以无法判断其有效性。该文件仅为许可协议，不包含任何可执行代码，因此可以判断该文件不存在投毒风险。利用方式主要通过构造恶意的RDP请求，触发目标系统中的内存错误（Use-After-Free），进而实现任意代码执行。根据CISA的已知被利用漏洞目录，该漏洞已经被积极利用。

**漏洞利用方式：**

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发目标系统中的Use-After-Free漏洞。
3.  攻击者利用漏洞在目标系统上执行任意代码，实现远程控制。

由于提供的代码仅为 LICENSE 文件，并未包含任何攻击代码，因此投毒风险为0%。

**项目地址:** [RICSecLab/CVE-2019-0708](https://github.com/RICSecLab/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #8

**来源**: [CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md](../2019/CVE-2019-0708-Ravaan21_Bluekeep-Hunter.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #9

**来源**: [CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-adyanamul_Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #10

**来源**: [CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md](../2019/CVE-2019-0708-algo7_bluekeep_CVE-2019-0708_poc_to_exploit.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，允许未经身份验证的攻击者远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统启用RDP，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制请求来利用此漏洞。漏洞存在于处理RDP连接的`Remote Desktop Services` (以前称为 `Terminal Services`) 中。成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，存在公开可用的PoC代码，表明该漏洞可以被成功利用。

**投毒风险：** 提供的代码片段是GNU通用公共许可证，不包含任何可执行代码，因此投毒风险为0%。完整的PoC代码可能包含恶意载荷，但仅凭许可证内容无法判断。

**利用方式：**
1.  攻击者需要找到一个启用RDP但未打补丁的Windows系统。
2.  攻击者使用特定的RDP客户端或自定义脚本，发送精心构造的RDP请求到目标系统。
3.  这些特制的请求会触发远程桌面服务中的漏洞，导致内存破坏（Use-After-Free）。
4.  攻击者利用内存破坏漏洞执行任意代码，从而完全控制目标系统。Unit 42的文章 (https://unit42.paloaltonetworks.com/cve-2019-0708-bluekeep/)  中提及了利用`Refresh Rect PDU` 和 `RDPDR Client Name Request PDU` 结合实现RCE。

多个搜索结果都指向了BlueKeep的利用和缓解措施，确认了漏洞的存在和危害。

**项目地址:** [algo7/bluekeep_CVE-2019-0708_poc_to_exploit](https://github.com/algo7/bluekeep_CVE-2019-0708_poc_to_exploit)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #11

**来源**: [CVE-2019-0708-andripwn_CVE-2019-0708.md](../2019/CVE-2019-0708-andripwn_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #12

**来源**: [CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md](../2019/CVE-2019-0708-at0mik_CVE-2019-0708-PoC.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #13

**来源**: [CVE-2019-0708-davidfortytwo_bluekeep.md](../2019/CVE-2019-0708-davidfortytwo_bluekeep.md)

## CVE-2019-0708-Windows RDP 远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。根据漏洞库信息和搜索结果，存在公开可用的漏洞利用代码。提供的代码片段是GNU通用公共许可证，并非漏洞利用代码本身。因此，需要进一步搜索和确认具体的漏洞利用代码。根据搜索结果，Unit 42的文章详细描述了如何利用此漏洞，并且Packet Storm Security也提供了相关的PoC代码，从而验证了漏洞的有效性。虽然漏洞本身具有极高的危害性，但目前提供的代码片段仅为许可证文件，因此投毒风险为0%。利用方式通常涉及构建包含恶意RDP PDU的特殊数据包，通过RDP协议发送到目标系统，触发目标系统的内存破坏，从而实现远程代码执行。

**有效性:** 高，存在公开可用的PoC。
**投毒风险:** 0%，提供的代码片段为GNU通用公共许可证。
**利用方式:** 通过RDP协议发送特制的请求，触发目标系统的内存破坏，执行任意代码。

**项目地址:** [davidfortytwo/bluekeep](https://github.com/davidfortytwo/bluekeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #14

**来源**: [CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md](../2019/CVE-2019-0708-go-bi_CVE-2019-0708-EXP-Windows.md)

## CVE-2019-0708 - BlueKeep RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致完全控制目标系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且攻击者能够建立RDP连接（无需身份验证）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码（虽然提供的代码段只是许可证），可以确认该漏洞的POC是存在的，并且已经被广泛研究和利用。搜索结果中多个链接指向了BlueKeep漏洞的利用分析和缓解措施。

**投毒风险：**
提供的漏洞利用代码仅包含 Academic Free License (“AFL”) v. 3.0 许可协议，没有发现任何恶意代码。因此，投毒风险评估为0%。需要注意的是，完整的漏洞利用代码未提供，不能排除在真实的漏洞利用代码中存在投毒的可能。

**利用方式：**
根据漏洞信息和搜索结果，BlueKeep漏洞的利用方式如下：
1.  攻击者与目标系统建立RDP连接。
2.  攻击者发送特制的RDP请求，触发RDP服务中的漏洞。
3.  该漏洞是一个use-after-free漏洞，允许攻击者在内核模式下执行任意代码。
4.  攻击者可以利用该漏洞安装恶意软件、窃取敏感数据或进行其他恶意活动。

多个搜索结果表明，该漏洞可以使用多种不同的RDP PDU（协议数据单元）组合利用，例如 Refresh Rect PDU 和 RDPDR Client Name Request PDU。 Unit 42 的博客文章对多种利用方式进行了详细分析。

**项目地址:** [go-bi/CVE-2019-0708-EXP-Windows](https://github.com/go-bi/CVE-2019-0708-EXP-Windows)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #15

**来源**: [CVE-2019-0708-hualy13_CVE-2019-0708-Check.md](../2019/CVE-2019-0708-hualy13_CVE-2019-0708-Check.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #16

**来源**: [CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md](../2019/CVE-2019-0708-isabelacostaz_CVE-2019-0708-POC.md)

## CVE-2019-0708-Windows-RDP远程代码执行

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁。攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）。未经身份验证的攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而执行任意代码。漏洞的根源在于`Use-After-Free`，攻击者可以通过精心构造的RDP数据包，触发对已释放内存的访问，进而控制程序流程。提供的Python POC代码首先使用`zlib`和`base64`进行解码，这增加了代码混淆的难度，也增加了投毒的可能性。虽然代码的主要目的是利用BlueKeep漏洞，但解压缩后的代码可能包含后门或者其他恶意代码，虽然可能性较低（10%），但是需要进一步分析，才能完全确定。根据搜索结果，该漏洞已经被广泛研究和利用，存在多种利用方法，包括结合`Refresh Rect PDU`和`RDPDR Client Name Request PDU`进行RCE。漏洞影响的系统包括Windows 7 SP1和Windows Server 2008等版本，需要及时安装补丁。

**项目地址:** [isabelacostaz/CVE-2019-0708-POC](https://github.com/isabelacostaz/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #17

**来源**: [CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md](../2019/CVE-2019-0708-lisinan988_CVE-2019-0708-scan.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于微软远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2019-0708 是一个严重的安全漏洞，并且存在公开可用的漏洞利用代码。搜索结果中来自 Palo Alto Networks Unit 42 的报告详细介绍了利用该漏洞的三种方法，表明该漏洞的利用是可行的。CISA 将此漏洞列入已知被利用的漏洞目录中，进一步证明了其有效性。

**投毒风险：**
提供的 POC 代码 `MS12-002-POC.py` 似乎是 CVE-2019-0708 漏洞的早期尝试利用，可能不是最可靠的版本。代码中包含大量的硬编码数据包，这在一定程度上限制了其通用性。此外，代码包含一个变量 `sc` 包含 shellcode，该 shellcode 最终执行 `mshta vbscript`，显示一个消息框。如果作者的目的是创建具有恶意目的的PoC(投毒代码)，而不是漏洞利用验证，该消息框可以被替换为更危险的操作，如执行任意命令或下载恶意软件。
尽管消息框看起来是良性的，但它仍然可能被用来掩盖恶意行为。通过结合网络信息检索，发现此PoC来源于 k8gege，是一个比较早期但是仍然有效的PoC，可以认定投毒风险较低。

根据代码分析来看, 代码比较老旧, 具有一定的投毒风险(比如将 messagebox 修改为执行恶意代码), 但是可能性较小，风险评估为 10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  **连接目标 RDP 服务：** 攻击者首先需要通过 RDP 协议连接到目标系统。
2.  **发送特制请求：** 攻击者构造包含恶意数据的 RDP 请求，这些请求会触发目标系统上的内存损坏或利用漏洞。
3.  **执行任意代码：** 如果漏洞利用成功，攻击者就可以在目标系统上执行任意代码，从而获得系统控制权。

`MS12-002-POC.py` 代码的利用方式如下：
1.  **建立 Socket 连接：** 使用 Python 的 `socket` 库建立与目标主机 RDP 端口（默认为 3389）的 TCP 连接。
2.  **发送恶意 RDP 数据包：** 将预先构造的恶意 RDP 数据包（存储在变量 `buf` 中）发送到目标主机。
3.  **触发漏洞：** 恶意数据包的发送会触发目标系统 RDP 服务中的漏洞，导致代码执行。

需要注意的是，成功利用此漏洞可能需要根据目标系统的具体环境进行调整，例如操作系统版本和已安装的补丁。

**项目地址:** [lisinan988/CVE-2019-0708-scan](https://github.com/lisinan988/CVE-2019-0708-scan)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #18

**来源**: [CVE-2019-0708-nochemax_bLuEkEeP-GUI.md](../2019/CVE-2019-0708-nochemax_bLuEkEeP-GUI.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** 受影响版本包括Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2, Windows XP, Windows Server 2003

**利用条件:** 目标系统需要启用RDP服务，攻击者需要能够通过网络访问RDP端口 (默认3389)

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，成功利用可能导致攻击者在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本。提供的漏洞利用代码 `bLuEkEeP-GUI` 旨在测试和利用此漏洞，主要利用了 use-after-free 类型的内存错误。

**漏洞利用方式分析：**
1.  **RDP协议交互：** 攻击者利用RDP协议与目标系统建立连接。
2.  **构造恶意请求：** 攻击者发送精心设计的RDP请求，触发目标系统RDP服务中的漏洞。
3.  **内存破坏：** 恶意请求导致RDP服务中的内存管理出现错误，例如use-after-free。
4.  **代码执行：** 攻击者利用内存破坏漏洞来执行任意代码，从而完全控制目标系统。

**代码分析和投毒风险：**
提供的Python代码(`bleukeep.py`) 看起来是用于自动化漏洞利用过程的GUI工具。它包含以下功能：
*   **IP地址发现：** `ver_ip()` 函数使用 `netdiscover` 工具扫描网络中的IP地址。
*   **配置：** `configuracion()` 函数允许用户指定目标IP地址和端口。
*   **漏洞扫描：** `comprobacion_explotacion()` 函数使用 Metasploit 的 `auxiliary/scanner/rdp/cve_2019_0708_bluekeep` 模块来检测目标系统是否存在漏洞。`exploid.rc`配置文件的生成逻辑存在问题，直接字符串拼接的方式容易引入shell命令注入等问题
*   **漏洞利用：** `ataque()` 函数使用 `PoC.py` 脚本来执行漏洞利用。存在直接执行脚本的方式，无法有效判断`PoC.py`是否安全。

代码中存在一些可疑之处，增加了投毒风险：
*  大量调用os.system，并且缺少输入验证，存在命令注入风险。
*   `ataque()` 函数直接执行PoC.py,增加了后门风险

考虑到以上因素，以及`bLuEkEeP-GUI`作者免责声明,判断仓库中存在潜在的投毒代码概率为60%。建议在使用前仔细审查代码。

**项目地址:** [nochemax/bLuEkEeP-GUI](https://github.com/nochemax/bLuEkEeP-GUI)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #19

**来源**: [CVE-2019-0708-offensity_CVE-2019-0708.md](../2019/CVE-2019-0708-offensity_CVE-2019-0708.md)

## CVE-2019-0708-Remote Desktop Services Remote Code Execution Vulnerability (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未安装相应补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。漏洞的根本原因是use-after-free。根据搜索结果，该漏洞影响Windows 7、Windows Server 2008 和 Windows Server 2008 R2。有很多公开可用的PoC代码，表明该漏洞容易被利用。

提供的漏洞利用代码只是一个Apache License 2.0的文本，没有任何实际的利用代码。因此，我们无法通过分析该代码来确认漏洞利用的有效性。不过，根据漏洞库信息和搜索结果，该漏洞已被广泛研究并存在可用的利用代码。

由于提供的代码仅仅是license文件，因此其中不存在投毒代码。

利用方式：
1.  攻击者使用RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**项目地址:** [offensity/CVE-2019-0708](https://github.com/offensity/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #20

**来源**: [CVE-2019-0708-pywc_CVE-2019-0708.md](../2019/CVE-2019-0708-pywc_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可远程代码执行，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（3389端口），且未安装相应补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708 (BlueKeep) 是一个存在于 Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 连接发送特制请求来触发此漏洞，从而在目标系统上执行任意代码。

**有效性评估：**

提供的`poc.py`代码看起来是一个利用 CVE-2019-0708 漏洞的 PoC（概念验证）脚本。它包含建立 RDP 连接并发送恶意数据包所需的步骤，例如 X.224 连接请求和 MCS 连接初始 PDU。 根据搜索引擎结果，存在多个关于 BlueKeep 的利用方法，该 PoC 尝试触发漏洞以导致蓝屏死机 (BSOD)。

**投毒风险评估：**

分析了提供的 PoC 代码，发现以下风险点，但不能完全确定为投毒：

1.  **依赖 OpenSSL 库：** PoC 使用 OpenSSL 库进行 TLS 握手。虽然 OpenSSL 是一个常用的库，但也可能存在潜在的漏洞或配置问题，攻击者可以利用这些问题在受害者系统上执行恶意代码。但是，正常的TLS链接也依赖于此。
2.  **异常处理不足：** PoC 中的异常处理可能不足，未能充分处理连接错误、数据接收错误或 TLS 握手失败等情况。这可能导致 PoC 在某些情况下崩溃，或在受害者系统上留下不稳定的状态。
3.  **目的单一：** 该POC目标为BSOD，若修改为植入后门等恶意代码，则更具危害性，应关注后续利用。

考虑到以上风险点以及PoC的复杂性，我给予10%的投毒风险评估。

**漏洞利用方式分析：**

1.  **RDP 连接初始化：** PoC 首先建立与目标系统的 RDP 连接。这涉及发送 X.224 连接请求 PDU 并执行 TLS 握手。
2.  **MCS 连接建立：** 建立 TLS 连接后，PoC 发送 MCS 连接初始 PDU 以启动 MCS 连接。
3.  **触发漏洞：** PoC 的目标是发送精心构造的 RDP 数据包，以触发漏洞，可能是一个 use-after-free 漏洞。根据PacketstormSecurity的信息，存在针对此漏洞的Use-After-Free的EXP。
4.  **远程代码执行 (RCE)：** 成功利用此漏洞会导致在目标系统上执行任意代码。攻击者可以利用此漏洞来安装恶意软件、窃取敏感数据或完全控制受感染的系统。

需要注意的是，成功利用 CVE-2019-0708 需要对 RDP 协议和漏洞的内部工作原理有深入的了解。PoC 代码可能需要进行修改才能在不同的目标系统上可靠地工作。

**项目地址:** [pywc/CVE-2019-0708](https://github.com/pywc/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #21

**来源**: [CVE-2019-0708-tranqtruong_Detect-BlueKeep.md](../2019/CVE-2019-0708-tranqtruong_Detect-BlueKeep.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务（默认端口3389），且未安装CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接并发送特制的请求来利用此漏洞。成功利用可能导致攻击者在目标系统上执行任意代码。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是一个高危漏洞，并且存在公开可用的漏洞利用代码（如Packet Storm上的资源）。提供的Python脚本 (Detect_BlueKeep.py) 旨在**检测**易受攻击的系统，**而非直接利用**漏洞。它通过捕获RDP流量并分析数据包来检测潜在的BlueKeep漏洞利用尝试。该脚本通过分析RDP连接的cookie信息，以及TCP窗口状态来检测异常行为，并将其记录在bluekeep.log文件中。因此，提供的POC代码本身**不具备**直接利用漏洞的能力，但能够辅助漏洞检测和分析。

**投毒风险：** 提供的Python脚本主要用于网络流量分析和潜在漏洞的检测，本身不包含明显的恶意代码。然而，任何从不可信来源下载的代码都存在潜在的投毒风险。仔细审查代码，特别注意以下方面：

*   **网络连接：** 脚本是否尝试连接到任何外部服务器？
*   **文件操作：** 脚本是否写入任何文件？如果写入，文件内容是否可控？
*   **系统命令执行：** 脚本是否执行任何系统命令？
*   **依赖项：** 脚本依赖的pyshark和keyboard库是否存在潜在的恶意版本？

尽管该脚本的功能相对明确，但不能完全排除作者隐藏恶意代码的可能性。例如，脚本可能在特定条件下执行额外的代码，或者在日志文件中记录敏感信息。因此，我估计投毒风险为 5%，主要是考虑到代码需要root权限运行，并且依赖的库存在潜在风险。

**利用方式：** BlueKeep漏洞的利用方式通常涉及以下步骤：

1.  **RDP连接：** 攻击者与目标系统建立RDP连接（端口3389）。
2.  **发送特制请求：** 攻击者发送包含精心构造数据的RDP请求。这些请求利用了RDP协议中的一个“use-after-free”漏洞。
3.  **代码执行：** 通过精心构造的请求，攻击者能够在目标系统上执行任意代码，通常以SYSTEM权限运行。

搜索结果提供了关于BlueKeep漏洞的分析和利用的更多信息，例如Unit 42的文章讨论了多种利用BlueKeep在内核写入数据的方法。这些资源可以帮助理解漏洞的底层机制，以及如何开发和部署漏洞利用程序。

**项目地址:** [tranqtruong/Detect-BlueKeep](https://github.com/tranqtruong/Detect-BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #22

**来源**: [CVE-2019-0708-umarfarook882_CVE-2019-0708.md](../2019/CVE-2019-0708-umarfarook882_CVE-2019-0708.md)

## CVE-2019-0708 - BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Remote Desktop Services (RDP)

**危害等级:** 严重，未经身份验证的攻击者可以通过 RDP 发送特制请求来执行任意代码。

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统需要启用 RDP 服务且未打补丁，攻击者需要能够通过网络连接到目标系统的 RDP 端口（默认 3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为 BlueKeep，是一个存在于 Microsoft Windows 远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过 RDP 发送特制请求来利用此漏洞，成功利用可能允许攻击者在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞是一个严重的安全问题，并且存在公开可用的漏洞利用代码。多个来源（包括 CISA 的已知被利用漏洞目录）确认此漏洞已被积极利用。提供的漏洞利用代码（`cve_2019_0708_bluekeep.py`）本身是一个扫描器 PoC，用于检测目标系统是否存在此漏洞。README.md 提到作者编写扫描器的目的是为了理解 RDP 连接序列和数据包，最终目标是编写实际的利用代码。

根据README.md的内容作者实现了crash，并提供了Demo视频，表明存在可利用性。

**投毒风险评估：**

提供的代码片段（`cve_2019_0708_bluekeep.py`）是一个扫描器，主要功能是检测漏洞是否存在。从代码内容来看，它构建并发送 RDP 数据包，然后根据服务器的响应来判断是否存在漏洞。尽管此PoC本身不包含恶意代码，但仍然存在一定的风险。

1.  **依赖项风险：**`cve_2019_0708_bluekeep.py`脚本依赖于`Crypto.Cipher`，使用`pip install pycryptodome`进行安装，如果安装源被篡改，则可能导致安装恶意代码。
2.  **替换风险：**存在攻击者替换整个代码库的风险，例如上传包含恶意后门的修改版本。

考虑到以上因素，代码仓库存在潜在的投毒风险，但不高, 这里给到10%的投毒可能性评估。

**利用方式分析：**

1.  **RDP 连接：** 攻击者首先需要与目标系统建立 RDP 连接。由于此漏洞是未经身份验证的，因此攻击者不需要有效的用户名和密码。
2.  **特制请求：** 攻击者需要构造并发送特制的 RDP 请求，这些请求会触发目标系统中的漏洞。具体而言，利用涉及到操纵 RDP 协议中的某些字段，以触发 use-after-free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。这通常涉及在内核模式下执行 shellcode，从而获得对系统的完全控制权。

**总结：**

CVE-2019-0708 是一个严重的远程代码执行漏洞，存在公开可用的漏洞利用代码。虽然提供的代码片段是一个扫描器 PoC，不直接包含恶意代码，但是存在一定的投毒风险。利用方式涉及构造和发送特制的 RDP 请求以触发漏洞，并在目标系统上执行任意代码。 由于该漏洞影响广泛，利用难度相对较低，因此建议尽快修补受影响的系统。

**项目地址:** [umarfarook882/CVE-2019-0708](https://github.com/umarfarook882/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

## POC #23

**来源**: [CVE-2019-0708-worawit_CVE-2019-0708.md](../2019/CVE-2019-0708-worawit_CVE-2019-0708.md)

## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 严重，可能导致未经身份验证的远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1

**利用条件:** 目标系统开启RDP服务，且未打CVE-2019-0708补丁，攻击者需要能够通过网络访问RDP端口（默认3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，对此漏洞进行分析如下：

**有效性：**
提供的POC代码（/tmp/17697ac0c48fcbdf2173a35ac144de87/NOTE.md）描述了针对CVE-2019-0708 (BlueKeep) 在Windows 7 和 Windows Server 2008上的利用方法。搜索引擎结果也显示存在可利用的POC。漏洞利用代码的分析表明，它针对RDP服务的Use-After-Free漏洞，通过操纵信道数据（特别是MS_T120信道）来控制RIP (Instruction Pointer)，从而实现代码执行。结合漏洞库信息，可以判断该POC具有较高的有效性，能够在未经身份验证的情况下远程执行代码。

**投毒风险：**
代码仓库中存在投毒代码的可能性评估为10%。分析主要基于提供的`NOTE.md`文件，该文件仅描述了漏洞利用的技术细节，没有发现任何恶意代码或后门。漏洞利用的核心在于利用RDP协议本身的缺陷来执行代码。因此，该仓库更大的风险是代码可靠性，而不是恶意投毒。更复杂的投毒可能存在其他文件中，此处无法进行全面分析。

**利用方式：**
1.  **目标确认：** 确认目标系统运行的是受影响的Windows版本 (Windows 7, Windows Server 2008)。
2.  **RDP端口探测：**  扫描目标系统的3389端口，确定RDP服务是否开启。
3.  **非分页池喷射：** 使用 RDPSND, RDPDR, REFRESH_RECT 信道进行非分页池喷射。
4.  **触发Use-After-Free：**  发送特制的RDP请求到MS_T120信道，触发Use-After-Free漏洞，释放信道。
5.  **内存布局控制：** 通过发送大量数据到特定信道（如RDPSND或RDPDR）来控制非分页内存池的布局。
6.  **RIP控制：**  通过构造信道数据，覆盖`pdata`指针，使其指向恶意代码，最终通过间接调用指令`call [reg]`控制RIP，执行恶意代码。
7.  **Shellcode执行：**  将shellcode注入到非分页内存池中，并通过上述RIP控制流程来执行shellcode，实现远程代码执行。

**项目地址:** [worawit/CVE-2019-0708](https://github.com/worawit/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)

---

