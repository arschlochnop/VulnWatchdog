## CVE-2019-11043 - PHP-FPM 远程代码执行(RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 受特定配置影响，具体版本未明确说明，通常是 Nginx + PHP-FPM 的组合

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，允许攻击者发送特制的请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于 Nginx + PHP-FPM 的特定配置中。该漏洞源于 PHP-FPM 在处理路径时存在缺陷，攻击者可以通过构造恶意请求，绕过安全检查，从而执行任意代码。从搜索结果和POC代码来看，该漏洞利用较为成熟，存在公开的POC，可以相对容易地复现。POC代码展示了如何利用该漏洞，通过发送特制的请求，在目标服务器上执行任意代码。利用步骤通常包括：1. 搭建存在漏洞的 Nginx + PHP-FPM 环境。2. 构造包含恶意代码的 HTTP 请求，该请求需要满足特定的格式，以便绕过 PHP-FPM 的安全检查。3. 将构造的请求发送到目标服务器。4. 如果漏洞利用成功，恶意代码将在目标服务器上执行。根据POC的描述，攻击者可以利用此漏洞建立反向隧道，从而实现持久控制。例如，可以使用 SSH 反向隧道将目标服务器的端口映射到攻击者的服务器，从而允许攻击者远程访问目标服务器。也可以使用 PHP 编写的反向 shell 实现持久控制。POC有效性分析：该漏洞的POC已经公开，并且在多个漏洞复现环境中得到了验证，证明该漏洞是真实存在的，并且可以被成功利用。通过分析POC代码，可以发现攻击者是如何构造恶意请求的，以及如何绕过 PHP-FPM 的安全检查的。该漏洞的成功利用依赖于特定的 Nginx + PHP-FPM 配置，因此在实际环境中，并非所有的 Nginx + PHP-FPM 服务器都存在该漏洞。然而，由于 Nginx + PHP-FPM 是一种常见的 Web 服务器配置，因此该漏洞的影响范围仍然很大。投毒风险分析：该漏洞的POC代码主要用于漏洞验证和安全研究，本身不包含恶意代码。然而，如果攻击者将恶意代码嵌入到 POC 中，并将其传播到互联网上，那么可能会存在一定的投毒风险。例如，攻击者可以将恶意代码嵌入到 HTTP 请求中，或者嵌入到 PHP 脚本中。一旦受害者运行了包含恶意代码的 POC，恶意代码将在受害者的服务器上执行，从而导致安全问题。尽管存在一定的投毒风险，但由于该漏洞的POC代码相对复杂，需要一定的技术背景才能理解和修改，因此投毒风险相对较低。此外，安全研究人员通常会对公开的POC进行安全分析，从而降低投毒风险。该POC主要通过构造特殊格式的HTTP请求，触发PHP-FPM的漏洞，实现代码执行。本身代码逻辑不复杂，主要依赖于HTTP请求的构造。因此，投毒风险较低。存在的风险点是，使用者可能在验证漏洞时，直接将恶意代码写入POC中，导致被他人利用。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043
