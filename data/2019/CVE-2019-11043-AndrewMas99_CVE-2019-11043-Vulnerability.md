## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 未明确指定，但影响特定配置的Nginx + PHP-FPM环境

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，攻击者可以发送特制的请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 20%

## 详情

CVE-2019-11043是一个远程代码执行漏洞，存在于某些特定配置的Nginx和PHP-FPM服务器中。攻击者可以通过构造特殊的请求来执行任意代码。该漏洞是由于PHP-FPM在处理路径时验证不足导致的。根据搜索结果和提供的POC代码，可以确认该漏洞是可利用的。多个GitHub仓库提供了该漏洞的POC，表明该漏洞的利用相对容易。该漏洞的利用通常涉及发送特制的HTTP请求，这些请求能够绕过Nginx的配置，直接将代码传递给PHP-FPM进行执行。执行的代码可以被用来创建一个反向shell，从而允许攻击者远程控制服务器。

利用步骤：
1. 搭建存在漏洞的Nginx + PHP-FPM环境。
2. 构造包含恶意代码的HTTP请求。
3. 将请求发送到目标服务器。
4. 如果服务器存在漏洞，恶意代码将在服务器上执行。
5. 攻击者可以通过反向shell获取服务器的控制权。

POC有效性分析：
提供的README.md文件描述了一个演示如何利用CVE-2019-11043漏洞进行反向隧道利用和持久化的项目。该项目旨在重现易受攻击的环境，执行利用链，并评估攻击者如何在现实场景中通过隧道技术实现持久性。README文件详细描述了攻击向量，并将其与MITRE ATT&CK技术对齐，包括应用层隧道、协议隧道、代理/反向代理、服务器端组件（PHP-FPM）和劫持执行流。该POC能够允许攻击者执行任意代码，并在目标系统上建立持久性连接，例如通过反向SSH隧道。POC的有效性较高，因为它不仅提供了漏洞利用的手段，还展示了利用漏洞实现持久化的高级技术。

投毒风险分析：
该漏洞的POC代码本身主要是为了演示漏洞的利用，以及反向隧道和持久化技术。但是，如果攻击者修改POC代码，加入恶意功能，例如上传恶意文件、窃取敏感信息等，就可能存在投毒风险。由于POC通常需要部署和运行在服务器上，因此，如果下载和使用了被篡改的POC代码，可能会对服务器造成损害。虽然提供的POC代码本身看起来比较清晰，主要使用了标准库，但由于该漏洞能够执行任意代码，所以，仍然存在一定的投毒风险。例如，攻击者可能会在反向shell中加入恶意代码，或者利用该漏洞在服务器上安装后门程序。

投毒风险等级评估为低，约20%。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043
