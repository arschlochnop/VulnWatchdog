## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 受特定配置影响，具体版本需分析Nginx+PHP-FPM配置

**利用条件:** 需要特定的Nginx + PHP-FPM配置

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个远程代码执行漏洞，存在于某些特定配置的Nginx和PHP-FPM服务器中。由于PHP-FPM在处理路径时的验证不足，攻击者可以构造特制的请求，从而在目标服务器上执行任意代码。漏洞主要出现在使用了不安全的fastcgi_split_path_info配置的Nginx服务器上。攻击者通过发送畸形的URL，可以绕过Nginx对PHP文件的检查，将恶意代码传递给PHP-FPM执行，从而实现远程代码执行。

POC有效性分析：
根据搜索结果和POC代码，该漏洞存在可利用性，已经有公开可用的POC代码，如GitHub上的theMiddleBlue/CVE-2019-11043项目，以及vulhub也提供了复现环境。该POC能够通过构造特殊的URL来触发漏洞，在目标服务器上执行任意代码，甚至反弹shell。

利用步骤：
1. 搭建存在漏洞的Nginx + PHP-FPM环境，即配置不安全的fastcgi_split_path_info。
2. 使用POC脚本，构造包含恶意代码的URL。
3. 将构造的URL发送到目标服务器。
4. 如果目标服务器存在漏洞，则恶意代码将在服务器上执行。

投毒风险分析：
该漏洞的POC代码主要用于验证漏洞的存在和进行渗透测试，本身的代码逻辑较为清晰，主要功能是构造畸形的URL并发送到目标服务器，以触发远程代码执行漏洞。因此，直接投毒的可能性较低。但存在以下潜在风险：
1. 攻击者可能修改POC代码，在利用成功后植入后门或恶意软件，实现持久控制。
2. 部分POC可能包含下载恶意文件的功能，如果下载源被篡改，则可能引入恶意代码。
3. 利用该漏洞进行攻击时，可能会在目标服务器上留下痕迹，攻击者可能伪造日志或删除关键文件，以逃避检测。
4. 该漏洞的利用需要特定的Nginx+PHP-FPM配置，攻击者可能利用社会工程学或其他漏洞获取配置信息，从而提高攻击成功率。
5. 尽管POC代码本身可能不包含恶意行为，但如果攻击者将其集成到自动化攻击工具中，可能会导致大规模的攻击事件。此外，如果攻击者将POC代码与恶意软件捆绑在一起，可能会诱骗用户下载和执行，从而实现投毒。

综合来看，CVE-2019-11043漏洞的投毒风险较低，但仍需保持警惕，加强对POC代码的审查和安全防护措施的部署。该漏洞的投毒风险大约为10%。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** None
