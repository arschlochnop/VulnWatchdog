## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 特定配置的 Nginx + PHP-FPM

**利用条件:** 需要特定配置的 Nginx + PHP-FPM，向Nginx + PHP-FPM的服务器发送特制请求

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个远程代码执行漏洞，存在于某些特定配置的 Nginx + PHP-FPM 服务器上。攻击者可以通过发送特制的请求来执行任意代码。根据搜索结果和提供的POC代码，可以确认该漏洞是可利用的。POC代码是一个Python脚本，它通过设置一个特殊的User-Agent头来发送请求，该请求会导致PHP-FPM执行任意代码。利用步骤如下：

1.  确定目标服务器是否使用了受影响的 Nginx + PHP-FPM 配置。
2.  运行提供的 Python POC 脚本，并指定目标 URL 作为参数。
3.  脚本将提示输入要执行的命令。
4.  输入命令后，脚本将发送带有特制 User-Agent 头的请求。
5.  PHP-FPM 将执行该命令，并将结果返回。
6.  脚本将打印命令的输出结果。

POC有效性分析：提供的POC脚本非常简单，易于使用，且利用了漏洞的根本原因。通过修改User-Agent头，可以绕过某些安全检查，从而执行任意代码。多个搜索结果表明，该漏洞已被广泛研究和利用，并且存在多个可用的POC。

投毒风险分析：该POC的投毒风险较低。该脚本主要使用标准Python库（requests），并且没有发现任何混淆或恶意代码。该脚本的目的是发送一个带有特殊构造的HTTP头的请求，这个请求本身并不会对系统造成直接损害。 然而，由于该POC允许攻击者在目标服务器上执行任意代码，因此存在潜在的风险。如果攻击者使用该POC来上传恶意文件或执行其他恶意操作，则可能会对目标系统造成严重损害。此外，如果攻击者修改了POC代码，并添加了恶意功能，则可能会增加投毒风险。例如，攻击者可以添加代码来收集系统信息或安装后门程序。总的来说，该POC的投毒风险较低，但仍需谨慎使用，并确保从可信来源获取代码。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043
