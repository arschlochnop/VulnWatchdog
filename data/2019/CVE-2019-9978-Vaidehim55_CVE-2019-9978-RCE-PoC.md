## CVE-2019-9978 - WordPress Social Warfare 插件 远程文件包含 (RFI) 转 远程代码执行 (RCE)

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 远程文件包含 (RFI) 转 远程代码执行 (RCE)

**影响应用:** WordPress Social Warfare 插件

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 3.5.3

**利用条件:** 无需认证，远程网络访问，插件已激活且版本处于受影响范围。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Social Warfare插件在处理外部请求时，未能对用户输入的URL参数进行严格校验，导致`wp_remote_get()`获取的内容被不安全地处理。POC代码展示了攻击者如何通过提供一个指向恶意PHP脚本的外部URL来触发远程文件包含（RFI）。在WordPress环境中，如果配置了允许包含远程流，或者插件逻辑错误地执行了拉取的内容，攻击者便能实现远程代码执行（RCE）。此POC采用Python编写，结构清晰，逻辑完整，涵盖了从本地模拟Payload托管到自动化发送触发请求的全过程，具有极高的实战复现价值。利用步骤：首先，攻击者在受控服务器上准备一个包含恶意PHP代码的文本文件（如payload-main.txt）；其次，使用Python开启临时HTTP服务（如python -m http.server）以托管该文件；最后，运行利用脚本，将目标URL和Payload地址作为参数传入，脚本会构造特定的HTTP请求访问目标网站的Social Warfare漏洞端点。若目标未修复，插件将下载并执行Payload，从而使攻击者获得服务器权限。投毒风险分析：经过对提供的POC结构审查，该代码属于标准的防御性安全研究工具。其核心逻辑依赖于Python标准库（如requests），不包含混淆后的十六进制字符串、加密的Shellcode或非预期的系统调用。风险评估为低（15%），主要风险点在于此类自动化工具易被初级攻击者（脚本小子）直接利用于非授权目标。代码本身未发现恶意后门或针对研究员环境的破坏性指令（如rm -rf / 或反弹研究员主机的Shell）。该POC的README清晰标注了法律免责声明和修复建议，体现了其研究导向的本质。研究人员在运行此类脚本时，建议在隔离的沙箱环境中使用，并手动检查exploit.py中是否存在指向第三方不明确IP的外部连接请求，以规避潜在的供应链投毒风险。由于脚本依赖于外部Payload的托管，用户需自行控制Payload内容，这也降低了脚本本身作为投毒载体的可能性，因为恶意代码的控制权在使用者手中。

**项目地址:** /tmp/vulnwatchdog_c21a8ecd74c02fa825bd8deffb172823/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
