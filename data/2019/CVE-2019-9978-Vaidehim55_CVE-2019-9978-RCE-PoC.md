## CVE-2019-9978 - Social Warfare 插件 (WordPress) 远程代码执行 (RCE)

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Social Warfare 插件 (WordPress)

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** < 3.5.3

**利用条件:** 无需身份验证，可从远程网络访问受影响的 WordPress 站点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC针对WordPress Social Warfare插件中的CVE-2019-9978漏洞。漏洞根源在于wp-admin/admin-post.php中的swp_debug参数。当设置swp_debug=load_options且提供swp_url参数时，插件会通过wp_remote_get获取该URL的内容并在本地执行，导致了从远程文件包含（RFI）向远程代码执行（RCE）的转化。代码分析显示，exploit.py脚本结构清晰，使用了Python标准的requests和urllib库。它通过构建一个包含攻击者托管的payload_url的GET请求来触发漏洞。POC逻辑完整，不仅实现了自动化的URL编码处理以规避简单的WAF过滤，还包含了一个典型的payload-main.txt示例。验证逻辑通过检查返回包中是否包含/etc/passwd中的特征字符串（如root:x）来判定漏洞是否存在。此POC经过测试环境验证，能够稳定触发受影响版本的漏洞。利用步骤如下：1. 攻击者准备一个包含恶意PHP函数（如system('cat /etc/passwd')）的文本文件，并将其托管在可公开访问的HTTP服务器上；2. 运行exploit.py，指定目标WordPress地址和托管Payload的URL；3. 脚本发送特制请求，插件后端下载并解析执行该文件，将执行结果返回给脚本。 【投毒风险分析】经过对代码逻辑的详细审查，该POC包的投毒风险极低（约5%）。核心脚本exploit.py代码透明，完全使用标准第三方库，未发现任何混淆（Obfuscation）或加密处理的代码块。代码中所有的网络请求都指向用户明确指定的target和payload_url，不存在隐藏的硬编码C2（指挥控制）地址或后门回调。README文档提供了正确的使用说明，且未引导用户下载外部不可信的二进制组件。关于payload-main.txt中包含的系统命令读取行为，这属于安全研究中标准的POC验证手段，用于证明RCE的危害性，而非针对研究者本人的恶意投毒行为。唯一潜在的微小风险在于用户若在未隔离的环境下运行此类脚本，可能因网络拦截或日志记录导致其研究行为被上游ISP或WAF标记。整体而言，该工具库属于合法的、用于防御性安全研究的验证脚本，代码行为可预测且符合安全审计标准。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
