## CVE-2019-9978 - WordPress Social Warfare Plugin RCE/RFI

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/RFI

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 3.5.3

**利用条件:** 无需认证，目标安装了受影响版本的插件且外部网络可访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该CVE-2019-9978的Proof of Concept（POC）代码展现了高度的有效性与实战参考价值。此漏洞源于WordPress的Social Warfare插件在处理‘swp_debug’参数时存在逻辑漏洞，允许攻击者通过‘swp_url’参数引入外部恶意脚本。分析提供的Python脚本可以看到，其核心逻辑是通过向‘/wp-admin/admin-post.php’发送带有特定参数的GET请求。该脚本能够自动化完成RFI（远程文件包含）到RCE（远程代码执行）的转化。在Payload分析中，使用了‘system('cat /etc/passwd/')’作为验证指令，这在类Unix系统中是标准的无害化漏洞验证方式。由于该漏洞无需任何身份验证（Unauthenticated），攻击者只需定位到安装了对应插件的站点即可直接触发代码执行，因此利用门槛极低，威胁极大。该POC代码逻辑清晰，使用了标准的requests库，具备良好的健壮性和易用性，能够准确验证目标环境是否存在该高危漏洞。【利用步骤】1. 准备攻击负载文件（如payload-main.txt），内容包含PHP执行函数。2. 在攻击者可控的服务器上启动HTTP服务（如使用python3 -m http.server 8000）以托管该负载。3. 运行提供的Python脚本：python3 exploit.py <目标URL> <负载文件的远程URL>。4. 脚本会请求wp-admin/admin-post.php，将swp_debug设置为load_options，并将swp_url指向攻击者的远程负载。5. 目标服务器下载并解析该负载，执行其中的PHP代码（如cat /etc/passwd），并将执行结果返回给脚本。【投毒风险分析】经过对该POC源码的深度安全审查，其投毒风险处于低水平（约10%）。代码主要使用了Python的requests和sys标准模块，未发现任何混淆处理、Base64编码的隐藏Payload或第三方恶意库引用。脚本的通信目标明确指向用户输入的target和payload_url，不存在向第三方异常C2服务器回传数据的行为。虽然在描述中提到了‘c21a8ecd...’等哈希路径，但这是本地文件系统的审计路径，并非代码逻辑中的隐蔽行为。主要的风险点在于此类自动化工具一旦被非授权人员获取，可能被直接用于非法扫描。此外，POC中对响应内容的判断逻辑（查找'root:x'）属于典型的漏洞存活性探测，不具备破坏性。然而，用户在下载此类工具时仍需警惕克隆的仓库是否被篡改添加了额外的后门，但在本次提供的代码样本中，逻辑透明，未见任何针对安全研究员主机的恶意窃密行为或破坏性逻辑。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
