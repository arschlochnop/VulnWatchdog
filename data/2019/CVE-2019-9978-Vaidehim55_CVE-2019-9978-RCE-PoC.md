## CVE-2019-9978 - WordPress Social Warfare 插件 RCE/RFI/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/RFI/XSS

**影响应用:** WordPress Social Warfare 插件

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 3.5.3

**利用条件:** 插件已激活且版本低于3.5.3，目标系统需允许远程文件包含(RFI)或在处理特定参数时未对输入进行过滤。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞源于WordPress Social Warfare插件在处理'swp_debug'参数及相关设置加载逻辑时存在缺陷。根据提供的README信息，该POC旨在展示如何通过远程文件包含（RFI）链条实现远程代码执行（RCE）。该漏洞的根源在于插件在调试模式下会尝试获取远程服务器上的配置文件或脚本，如果攻击者能够控制URL参数（如通过'swp_url'或类似的包含注入点），则可以将恶意PHP脚本引入WordPress环境。虽然提供的输入仅为README摘要，但其明确指出了从RFI到RCE的攻击流，这与公开已知的CVE-2019-9978漏洞机理一致。有效性方面，此类POC通常只需要通过构造特定的HTTP GET或POST请求即可触发。利用步骤：首先，攻击者需寻找安装了Social Warfare 3.5.3以下版本的WordPress站点；其次，在攻击者控制的服务器上托管一个包含恶意代码的文本文件（例如包含system()函数的php脚本）；接着，构造请求访问目标站点，利用swp_debug=load_options及swp_url参数指向恶意托管文件；最后，插件解析并执行该远程文件，从而在目标服务器上执行任意系统命令。投毒风险分析：该POC在README阶段表现出较低的直接投毒风险，因为它主要作为研究和文档说明存在。然而，作为安全研究员必须关注其潜在的次生风险。由于此类RCE漏洞极具破坏力，公开的Python实现脚本若未经过严格审查，可能包含恶意混淆。在常见的GitHub投毒案例中，这类POC项目往往会夹杂隐蔽的Base64编码字符串或混淆过的网络请求，用于在攻击者执行PoC时反向泄露其本地主机的环境变量（如AWS凭证、SSH Key等）。本项目目前仅见README，尚未发现明显的恶意Payload植入，但在实际下载和执行.py脚本前，必须检查代码中是否存在通过requests、urllib等库向非目标IP发送异常流量的行为。考虑到该漏洞较旧且相关脚本多被黑产用于扫射，建议在完全隔离的沙箱环境中进行验证，以防POC本身被二次修改为僵尸网络下载器。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
