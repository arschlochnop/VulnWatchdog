## CVE-2019-9978 - WordPress Social Warfare Plugin RCE/RFI/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/RFI/XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 3.5.3

**利用条件:** 无需认证，远程网络访问，插件处于启用状态且版本低于3.5.3

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对WordPress Social Warfare插件中存在的严重漏洞CVE-2019-9978进行了复现。该漏洞的核心在于`swp_debug=load_options`与`swp_url`参数组合使用时，程序未对远程URL内容进行充分过滤，导致远程文件包含（RFI）。通过分析提供的代码，`exploit.py`使用Python的requests库向`admin-post.php`发起GET请求，传递特定的调试参数。POC中配套的`payload-main.txt`包含PHP系统调用代码`system('cat /etc/passwd/')`，当服务器后端解析此包含文件时，会直接在服务器权限下执行任意系统命令。此利用脚本逻辑清晰，结构简单，且直接通过检测响应中是否包含`root:x`来判断利用是否成功，具有极高的实战有效性和可靠性。由于该漏洞无需任何身份验证（Unauthenticated），攻击者只需定位到安装了受影响插件的WordPress站点即可实施攻击，风险极高。利用步骤：1. 在攻击者控制的服务器上准备一个文本文件（如payload-main.txt），内容为欲执行的PHP代码，包裹在pre标签内；2. 使用Python内置HTTP服务器或其他Web服务器托管此文件，确保目标服务器可访问；3. 运行`exploit.py`脚本，参数分别为目标WordPress站点的根目录URL和托管载荷的完整链接；4. 脚本将构造一个包含`swp_debug=load_options`和`swp_url`参数的GET请求；5. 观察控制台输出，若返回`/etc/passwd`内容，则说明RCE执行成功。投毒风险分析：经过对提供的`exploit.py`源码进行深度防御性审计，该代码库的投毒风险处于较低水平（15%）。脚本主要使用了标准的requests和sys库，没有发现经过混淆的Base64编码字符串、动态代码执行（如exec/eval）或隐藏的系统调用。其核心逻辑仅限于向指定URL发送HTTP请求并打印回显结果。代码中没有发现任何试图窃取执行者环境凭据、扫描本地内网或建立反向Shell给第三方服务器的恶意行为。唯一的潜在风险点在于用户在使用此类POC时，往往会从第三方不可信源下载配套的载荷文件。虽然本示例中的`payload-main.txt`仅为简单的系统查看命令，但在实际威胁情报场景中，若载荷文件中被替换为复杂的Webshell或勒索软件脚本，则会对目标系统造成实质性破坏。此外，如果该脚本被集成到自动化扫描器中，可能会触发防御系统的误报或被恶意篡改用于非授权目的。总体而言，该代码片段本身作为安全研究工具是透明且安全的，其主要风险源于使用者对Payload内容的控制以及对脚本来源的信任程度。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978-RCE-PoC) (模拟路径)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
