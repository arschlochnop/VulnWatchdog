# CVE-2019-10219

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md)

# CVE-2019-10219

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md)

# CVE-2019-10219

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md)

# CVE-2019-10219

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md)

# CVE-2019-10219

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md)

# CVE-2019-10219

> ğŸ“¦ è¯¥CVEæœ‰ **2** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final.md)

## CVE-2019-10219 - Hibernate-Validator SafeHtml XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** è·¨ç«™è„šæœ¬ (XSS)

**å½±å“åº”ç”¨:** Hibernate-Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²æˆ–æ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final, 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨Hibernate-Validatorçš„SafeHtmléªŒè¯å™¨ï¼Œå¹¶ä¸”ç”¨æˆ·å¯æ§çš„è¾“å…¥ä¼šç»è¿‡æ­¤éªŒè¯å™¨å¹¶æœ€ç»ˆåœ¨Webé¡µé¢ä¸Šæ˜¾ç¤ºã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-10219 å­˜åœ¨äº Hibernate-Validator ä¸­ï¼Œå…·ä½“æ¥è¯´æ˜¯ SafeHtml éªŒè¯å™¨æœªèƒ½æ­£ç¡®æ¸…ç†åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ã€‚è¿™å…è®¸æ”»å‡»è€…æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœï¼Œä»¥åŠå­˜åœ¨çš„PoCä»£ç ï¼ˆé“¾æ¥ï¼šhttps://github.com/poc-effectiveness/PoCAdaptation/tree/main/Adapted/CVE-2019-10219 å’Œ https://github.com/poc-effectiveness/PoCAdaptation/tree/main/Origin/CVE-2019-10219/exploitï¼‰ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ç‰‡æ®µä¸»è¦æ˜¯Hibernate Validatorçš„è´¡çŒ®æŒ‡å—å’ŒREADMEæ–‡ä»¶ï¼Œçœ‹èµ·æ¥ä¸åƒæ˜¯æ¶æ„ä»£ç ã€‚è™½ä¸æ’é™¤ä»“åº“å…¶ä»–éƒ¨åˆ†å­˜åœ¨æ¶æ„ä»£ç çš„å¯èƒ½æ€§ï¼Œä½†ä»…å‡­å½“å‰ä¿¡æ¯åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚éœ€è¿›ä¸€æ­¥å®¡æŸ¥æ•´ä¸ªä»“åº“ä»¥ç¡®å®šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„è¾“å…¥ï¼Œç»•è¿‡ SafeHtml éªŒè¯å™¨çš„æ¸…ç†ï¼Œå°†æ¶æ„è„šæœ¬æ³¨å…¥åˆ° Web é¡µé¢ä¸­ã€‚å½“ç”¨æˆ·è®¿é—®åŒ…å«æ­¤æ¶æ„è„šæœ¬çš„é¡µé¢æ—¶ï¼Œè„šæœ¬å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œï¼Œå¯èƒ½å¯¼è‡´ cookie çªƒå–ã€ä¼šè¯åŠ«æŒæˆ–é¡µé¢é‡å®šå‘ç­‰æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6-0-17-Final)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---

## POC #2

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md)

## CVE-2019-10219-Hibernate-Validator-XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** Hibernate Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²å’Œæ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final æˆ– 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Hibernate Validatorç‰ˆæœ¬ï¼Œä¸”å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹å¹¶é€šè¿‡SafeHtmléªŒè¯å™¨è¿›è¡Œå¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-10219 æ¼æ´å­˜åœ¨äº Hibernate Validator ä¸­ï¼Œç”±äº `SafeHtml` éªŒè¯å™¨æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ï¼Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤æ¶æ„çš„ HTML payload ç»•è¿‡éªŒè¯ï¼Œå¹¶åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šé¦–å…ˆåº”ç”¨ç¨‹åºéœ€ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Hibernate Validatorï¼Œå…¶æ¬¡æ”»å‡»è€…éœ€æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `@SafeHtml` æ³¨è§£çš„å­—æ®µï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„ payloadï¼Œä¾‹å¦‚ `<!--<script>alert("XSS")</script>-->`ã€‚ç”±äºæä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯å…³äºè´¡çŒ®æŒ‡å—å’Œé¡¹ç›®è¯´æ˜ï¼Œç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç å¹¶ä¸å­˜åœ¨äºè¿™äº›æ–‡ä»¶ä¸­ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»æœ‰å¯èƒ½åœ¨è´¡çŒ®çš„ä»£ç ä¸­å­˜åœ¨æ¶æ„æ³¨å…¥ï¼Œé£é™©å¤§çº¦ä¸º10%ã€‚

æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Hibernate Validatorï¼Œä»¥åŠæ˜¯å¦å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹ï¼Œå¹¶ä½¿ç”¨äº†`@SafeHtml`æ³¨è§£è¿›è¡ŒéªŒè¯ã€‚

æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œå¹¶å½±å“å¤šä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬Oracle WebLogicå’ŒIBM TRIRIGAã€‚


**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---



---

## POC #2

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md)

## CVE-2019-10219-Hibernate-Validator-XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** Hibernate Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²å’Œæ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final æˆ– 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Hibernate Validatorç‰ˆæœ¬ï¼Œä¸”å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹å¹¶é€šè¿‡SafeHtmléªŒè¯å™¨è¿›è¡Œå¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-10219 æ¼æ´å­˜åœ¨äº Hibernate Validator ä¸­ï¼Œç”±äº `SafeHtml` éªŒè¯å™¨æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ï¼Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤æ¶æ„çš„ HTML payload ç»•è¿‡éªŒè¯ï¼Œå¹¶åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šé¦–å…ˆåº”ç”¨ç¨‹åºéœ€ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Hibernate Validatorï¼Œå…¶æ¬¡æ”»å‡»è€…éœ€æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `@SafeHtml` æ³¨è§£çš„å­—æ®µï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„ payloadï¼Œä¾‹å¦‚ `<!--<script>alert("XSS")</script>-->`ã€‚ç”±äºæä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯å…³äºè´¡çŒ®æŒ‡å—å’Œé¡¹ç›®è¯´æ˜ï¼Œç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç å¹¶ä¸å­˜åœ¨äºè¿™äº›æ–‡ä»¶ä¸­ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»æœ‰å¯èƒ½åœ¨è´¡çŒ®çš„ä»£ç ä¸­å­˜åœ¨æ¶æ„æ³¨å…¥ï¼Œé£é™©å¤§çº¦ä¸º10%ã€‚

æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Hibernate Validatorï¼Œä»¥åŠæ˜¯å¦å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹ï¼Œå¹¶ä½¿ç”¨äº†`@SafeHtml`æ³¨è§£è¿›è¡ŒéªŒè¯ã€‚

æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œå¹¶å½±å“å¤šä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬Oracle WebLogicå’ŒIBM TRIRIGAã€‚


**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---



---

## POC #2

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md)

## CVE-2019-10219-Hibernate-Validator-XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** Hibernate Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²å’Œæ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final æˆ– 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Hibernate Validatorç‰ˆæœ¬ï¼Œä¸”å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹å¹¶é€šè¿‡SafeHtmléªŒè¯å™¨è¿›è¡Œå¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-10219 æ¼æ´å­˜åœ¨äº Hibernate Validator ä¸­ï¼Œç”±äº `SafeHtml` éªŒè¯å™¨æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ï¼Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤æ¶æ„çš„ HTML payload ç»•è¿‡éªŒè¯ï¼Œå¹¶åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šé¦–å…ˆåº”ç”¨ç¨‹åºéœ€ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Hibernate Validatorï¼Œå…¶æ¬¡æ”»å‡»è€…éœ€æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `@SafeHtml` æ³¨è§£çš„å­—æ®µï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„ payloadï¼Œä¾‹å¦‚ `<!--<script>alert("XSS")</script>-->`ã€‚ç”±äºæä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯å…³äºè´¡çŒ®æŒ‡å—å’Œé¡¹ç›®è¯´æ˜ï¼Œç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç å¹¶ä¸å­˜åœ¨äºè¿™äº›æ–‡ä»¶ä¸­ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»æœ‰å¯èƒ½åœ¨è´¡çŒ®çš„ä»£ç ä¸­å­˜åœ¨æ¶æ„æ³¨å…¥ï¼Œé£é™©å¤§çº¦ä¸º10%ã€‚

æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Hibernate Validatorï¼Œä»¥åŠæ˜¯å¦å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹ï¼Œå¹¶ä½¿ç”¨äº†`@SafeHtml`æ³¨è§£è¿›è¡ŒéªŒè¯ã€‚

æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œå¹¶å½±å“å¤šä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬Oracle WebLogicå’ŒIBM TRIRIGAã€‚


**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---



---

## POC #2

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md)

## CVE-2019-10219-Hibernate-Validator-XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** Hibernate Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²å’Œæ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final æˆ– 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Hibernate Validatorç‰ˆæœ¬ï¼Œä¸”å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹å¹¶é€šè¿‡SafeHtmléªŒè¯å™¨è¿›è¡Œå¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-10219 æ¼æ´å­˜åœ¨äº Hibernate Validator ä¸­ï¼Œç”±äº `SafeHtml` éªŒè¯å™¨æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ï¼Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤æ¶æ„çš„ HTML payload ç»•è¿‡éªŒè¯ï¼Œå¹¶åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šé¦–å…ˆåº”ç”¨ç¨‹åºéœ€ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Hibernate Validatorï¼Œå…¶æ¬¡æ”»å‡»è€…éœ€æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `@SafeHtml` æ³¨è§£çš„å­—æ®µï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„ payloadï¼Œä¾‹å¦‚ `<!--<script>alert("XSS")</script>-->`ã€‚ç”±äºæä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯å…³äºè´¡çŒ®æŒ‡å—å’Œé¡¹ç›®è¯´æ˜ï¼Œç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç å¹¶ä¸å­˜åœ¨äºè¿™äº›æ–‡ä»¶ä¸­ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»æœ‰å¯èƒ½åœ¨è´¡çŒ®çš„ä»£ç ä¸­å­˜åœ¨æ¶æ„æ³¨å…¥ï¼Œé£é™©å¤§çº¦ä¸º10%ã€‚

æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Hibernate Validatorï¼Œä»¥åŠæ˜¯å¦å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹ï¼Œå¹¶ä½¿ç”¨äº†`@SafeHtml`æ³¨è§£è¿›è¡ŒéªŒè¯ã€‚

æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œå¹¶å½±å“å¤šä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬Oracle WebLogicå’ŒIBM TRIRIGAã€‚


**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---



---

## POC #2

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md)

## CVE-2019-10219-Hibernate-Validator-XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** Hibernate Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²å’Œæ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final æˆ– 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Hibernate Validatorç‰ˆæœ¬ï¼Œä¸”å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹å¹¶é€šè¿‡SafeHtmléªŒè¯å™¨è¿›è¡Œå¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-10219 æ¼æ´å­˜åœ¨äº Hibernate Validator ä¸­ï¼Œç”±äº `SafeHtml` éªŒè¯å™¨æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ï¼Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤æ¶æ„çš„ HTML payload ç»•è¿‡éªŒè¯ï¼Œå¹¶åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šé¦–å…ˆåº”ç”¨ç¨‹åºéœ€ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Hibernate Validatorï¼Œå…¶æ¬¡æ”»å‡»è€…éœ€æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `@SafeHtml` æ³¨è§£çš„å­—æ®µï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„ payloadï¼Œä¾‹å¦‚ `<!--<script>alert("XSS")</script>-->`ã€‚ç”±äºæä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯å…³äºè´¡çŒ®æŒ‡å—å’Œé¡¹ç›®è¯´æ˜ï¼Œç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç å¹¶ä¸å­˜åœ¨äºè¿™äº›æ–‡ä»¶ä¸­ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»æœ‰å¯èƒ½åœ¨è´¡çŒ®çš„ä»£ç ä¸­å­˜åœ¨æ¶æ„æ³¨å…¥ï¼Œé£é™©å¤§çº¦ä¸º10%ã€‚

æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Hibernate Validatorï¼Œä»¥åŠæ˜¯å¦å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹ï¼Œå¹¶ä½¿ç”¨äº†`@SafeHtml`æ³¨è§£è¿›è¡ŒéªŒè¯ã€‚

æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œå¹¶å½±å“å¤šä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬Oracle WebLogicå’ŒIBM TRIRIGAã€‚


**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---



---

## POC #2

**æ¥æº**: [CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md](../2019/CVE-2019-10219-shoucheng3_hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed.md)

## CVE-2019-10219-Hibernate-Validator-XSS

**æ¼æ´ç¼–å·:** CVE-2019-10219

**æ¼æ´ç±»å‹:** XSS

**å½±å“åº”ç”¨:** Hibernate Validator

**å±å®³ç­‰çº§:** ä¸­å±ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·ä¿¡æ¯æ³„éœ²å’Œæ¶æ„è„šæœ¬æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 6.0.0.Alpha1 <= version <= 6.0.17.Final æˆ– 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Hibernate Validatorç‰ˆæœ¬ï¼Œä¸”å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹å¹¶é€šè¿‡SafeHtmléªŒè¯å™¨è¿›è¡Œå¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2019-10219 æ¼æ´å­˜åœ¨äº Hibernate Validator ä¸­ï¼Œç”±äº `SafeHtml` éªŒè¯å™¨æœªèƒ½æ­£ç¡®åœ°è¿‡æ»¤åŒ…å«æ¶æ„ä»£ç çš„ HTML æ³¨é‡Šå’ŒæŒ‡ä»¤ï¼Œå¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤æ¶æ„çš„ HTML payload ç»•è¿‡éªŒè¯ï¼Œå¹¶åœ¨å—å®³è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œä»»æ„ JavaScript ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºï¼šé¦–å…ˆåº”ç”¨ç¨‹åºéœ€ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Hibernate Validatorï¼Œå…¶æ¬¡æ”»å‡»è€…éœ€æ‰¾åˆ°åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨äº† `@SafeHtml` æ³¨è§£çš„å­—æ®µï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„ HTML æ³¨é‡Šæˆ–æŒ‡ä»¤çš„ payloadï¼Œä¾‹å¦‚ `<!--<script>alert("XSS")</script>-->`ã€‚ç”±äºæä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯å…³äºè´¡çŒ®æŒ‡å—å’Œé¡¹ç›®è¯´æ˜ï¼Œç›´æ¥çš„æ¼æ´åˆ©ç”¨ä»£ç å¹¶ä¸å­˜åœ¨äºè¿™äº›æ–‡ä»¶ä¸­ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»æœ‰å¯èƒ½åœ¨è´¡çŒ®çš„ä»£ç ä¸­å­˜åœ¨æ¶æ„æ³¨å…¥ï¼Œé£é™©å¤§çº¦ä¸º10%ã€‚

æ¼æ´åˆ©ç”¨æœ‰æ•ˆæ€§å–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Hibernate Validatorï¼Œä»¥åŠæ˜¯å¦å…è®¸ç”¨æˆ·è¾“å…¥HTMLå†…å®¹ï¼Œå¹¶ä½¿ç”¨äº†`@SafeHtml`æ³¨è§£è¿›è¡ŒéªŒè¯ã€‚

æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªXSSæ¼æ´ï¼Œå¹¶å½±å“å¤šä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬Oracle WebLogicå’ŒIBM TRIRIGAã€‚


**é¡¹ç›®åœ°å€:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)

---

