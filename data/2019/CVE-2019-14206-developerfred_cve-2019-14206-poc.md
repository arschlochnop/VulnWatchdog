## CVE-2019-14206 - Adaptive Images for WordPress (Nevma) Arbitrary File Deletion (任意文件删除)

**漏洞编号:** CVE-2019-14206

**漏洞类型:** Arbitrary File Deletion (任意文件删除)

**影响应用:** Adaptive Images for WordPress (Nevma)

**危害等级:** High (高危)

**CVSS评分:** 6.5 (CVSS:3.x/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N)

**影响版本:** < 0.6.67

**利用条件:** 远程非授权访问，目标安装并启用了受影响版本的Adaptive Images插件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞源于Nevma开发的Adaptive Images for WordPress插件在处理用户输入时缺乏必要的安全过滤。在受影响的版本中，插件允许攻击者通过特定请求参数控制文件路径构造逻辑。具体而言，程序直接从`$_REQUEST['adaptive-images-settings']`获取配置，并未对解析后的路径进行严格的白名单校验或路径限制。核心代码中使用`unlink($cache_file)`函数执行删除操作，而`$cache_file`的构成包含了可控的`$request_uri`等变量。该POC提供了完整的自动化测试环境，包含Docker容器、Shell脚本以及基于YAML的Nuclei扫描模板。通过执行`docker-test.sh`，研究人员可以模拟受攻击环境，验证是否能够成功删除敏感文件如`wp-config.php`。POC包含了自动化的环境搭建脚本和结果验证环节（如检查文件是否被成功删除），在防御性测试中表现出极高的有效性和稳定性。利用步骤：1. 使用Docker部署包含漏洞版本的WordPress环境；2. 构造恶意的HTTP请求，将目标文件路径（如通过目录遍历跨越到根目录）注入到插件处理流程中；3. 触发unlink函数执行，导致目标文件被删除；4. 使用POC中的Nuclei模板进行扫描以确认漏洞存在。投毒风险分析：该POC项目主要由描述文件、Nuclei模板和基础Shell脚本组成。经过对脚本内容（如`docker-test.sh`和Nuclei YAML）的静态分析，未发现混淆代码、Base64加密的恶意Paylaod或异常的网络连接行为（除攻击目标外）。其功能逻辑清晰，主要集中在环境自动化拉取和本地验证。脚本中虽然执行了`chmod +x`和`cd`等操作，但均在项目目录内运行，未涉及提权或持久化驻留。项目提供的Nuclei模板遵循标准格式，无外部异常源下载。尽管风险较低，但在运行此类第三方提供的POC脚本时，仍建议在隔离的虚拟机或沙箱环境中执行，并仔细审核`docker-test.sh`中是否存在异常的curl/wget请求指向未知C2服务器。当前评估其为合法的漏洞复现项目，投毒风险极低，属于标准的安全研究资源。

**项目地址:** [https://github.com/vulnwatchdog/cve-2019-14206-poc](https://www.google.com/search?q=https://github.com/vulnwatchdog/cve-2019-14206-poc)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-14206](https://nvd.nist.gov/vuln/detail/CVE-2019-14206)
