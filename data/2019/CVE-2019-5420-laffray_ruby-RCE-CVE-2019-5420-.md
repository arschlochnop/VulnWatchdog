# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

# CVE-2019-5420

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md](../2019/CVE-2019-5420-AnasTaoutaou_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #2

**来源**: [CVE-2019-5420-Eremiel_CVE-2019-5420.md](../2019/CVE-2019-5420-Eremiel_CVE-2019-5420.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式，且能被公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 漏洞存在于 Rails 框架的开发模式下。由于在开发模式下，Rails 会自动生成一个 secret token，并且这个 token 的生成方式存在缺陷，攻击者可以猜测到该 token。

**利用方式：**

1.  **获取 Cookie:** 攻击者首先需要获取目标 Rails 应用的 Cookie。
2.  **猜测 Secret Token:**  攻击者使用应用名称（appname）通过MD5哈希和PBKDF2算法推导出密钥。
3.  **解密 Cookie:** 使用猜测到的 secret token 解密 Cookie，得到 session 数据。
4.  **篡改 Session:**  篡改 session 数据，例如将 `user_id` 修改为 `1`，从而冒充管理员或其他用户。
5.  **重新加密 Cookie:** 使用猜测到的 secret token 重新加密篡改后的 session 数据，生成新的 Cookie。
6.  **发送恶意 Cookie:** 将新的 Cookie 发送给目标 Rails 应用。

**POC 分析：**

提供的 Python 脚本 `cve-2019-5420.py` 实现了上述利用方式。脚本接收 Cookie 和应用名称作为参数，解密、篡改、重新加密 Cookie，并输出新的 Cookie。该脚本依赖 `Cryptodome` 库。

**投毒风险评估：**

该代码的主要功能是利用漏洞，本身不包含恶意后门代码。但是，存在极低的投毒风险（估计为5%），原因如下：

*   **依赖安装**: 攻击者可能会修改安装依赖（如`Cryptodome`），引入包含恶意代码的第三方库。
*   **代码执行**: 如果目标服务器直接执行未经审计的脚本，可能存在其他安全风险，但这不是脚本本身造成的。

**总结：**

该漏洞利用代码有效，攻击者可以利用它来篡改 session 数据，从而进行权限提升或其他恶意操作。但是，需要注意的是，该漏洞只存在于 Rails 应用的开发模式下，并且需要攻击者能够访问到目标应用。此外，代码中存在极低的投毒风险。建议在生产环境中禁用开发模式，并使用强密码作为 secret token。

**项目地址:** [Eremiel/CVE-2019-5420](https://github.com/Eremiel/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #3

**来源**: [CVE-2019-5420-PenTestical_CVE-2019-5420.md](../2019/CVE-2019-5420-PenTestical_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。漏洞原因是Rails在开发模式下使用自动生成的secret token，攻击者可以通过一定手段猜测该token。获取token后，攻击者可以构造恶意cookie，利用Rails内部机制执行任意代码。 

**有效性：**

根据漏洞信息、搜索结果和POC代码，可以判定该漏洞是有效的。POC代码（CVE-2019-5420.rb）提供了利用该漏洞提升用户权限的演示，通过修改cookie中的`user_id`字段，可以将用户权限提升至管理员权限。

**投毒风险：**

查看提供的代码，CVE-2019-5420.rb 主要逻辑为：

1.  解码cookie值。
2.  使用应用程序名称生成密钥。
3.  使用密钥和解码后的cookie解密数据。
4.  修改解密后的JSON数据中的`user_id`字段。
5.  使用新的`user_id`重新加密数据生成新的cookie。

README.md 文件描述了如何使用该脚本。

综合分析来看，该POC代码的功能明确，没有发现任何隐藏的恶意代码或后门。代码的目的是演示如何利用漏洞提升权限，而不是进行恶意攻击。因此，可以认为该仓库不存在投毒风险。

**利用方式：**

1.  **环境要求：** 目标Rails应用必须运行在开发模式下，因为开发模式下secret token更容易被猜测或泄露。
2.  **获取Cookie：** 攻击者需要获取目标用户的Cookie值。
3.  **获取/猜测应用名称：** 攻击者需要知道或者猜测Rails应用程序的名称，因为secret token的生成依赖于应用名称。 如果无法直接获取，可能需要进行爆破尝试。
4.  **运行POC代码：** 攻击者将Cookie值和应用名称代入POC代码（CVE-2019-5420.rb），运行脚本。
5.  **替换Cookie：** 脚本会生成一个新的Cookie，攻击者需要将浏览器中的Cookie替换为新生成的Cookie。
6.  **权限提升：** 刷新页面后，攻击者将拥有`user_id`对应用户的权限，例如管理员权限。

**总结：**

该漏洞利用的关键在于获取secret token。在开发模式下，Rails应用的secret token通常比较弱，容易被猜测。攻击者利用猜测的token，结合Rails的cookie加密机制，可以篡改cookie中的用户信息，从而提升权限，甚至执行任意代码。


**项目地址:** [PenTestical/CVE-2019-5420](https://github.com/PenTestical/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #4

**来源**: [CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md](../2019/CVE-2019-5420-WildWestCyberSecurity_cve-2019-5420-POC.md)

## CVE-2019-5420-Rails-RCE

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (Development Mode)

**利用条件:** Rails应用运行于开发模式，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个Rails框架在开发模式下的远程代码执行漏洞。攻击者可以猜测自动生成的开发模式secret token，并将其与其他Rails内部组件结合，从而提升权限至远程代码执行。

**有效性：**
提供的POC代码有效。它利用了ActiveSupport::MessageVerifier的反序列化漏洞，通过构造恶意的ERB对象，并将其包装在DeprecatedInstanceVariableProxy中，生成一个带有签名的payload。当易受攻击的Rails应用反序列化该payload时，会执行任意Ruby代码。

**投毒风险：**
该代码仓库主要包含漏洞利用的POC，旨在演示漏洞如何被利用。快速浏览LICENSE，README.md以及POC.rb文件，未发现存在恶意代码。POC代码逻辑合理，仅用于漏洞复现，风险较低。因此，投毒风险为0%。

**利用方式：**
1.  **获取目标应用的名称：**  POC脚本首先确定目标Rails应用的名称（`PentesterLab::Application`，可以修改）。
2.  **生成`secret_key_base`：**  使用目标应用名称的MD5哈希值作为`secret_key_base`。
3.  **派生`ActiveStorage`密钥：**  使用`ActiveSupport::KeyGenerator`从`secret_key_base`派生出`ActiveStorage`密钥。
4.  **创建`MessageVerifier`：**  使用派生的`ActiveStorage`密钥创建一个`ActiveSupport::MessageVerifier`实例。
5.  **构造恶意ERB对象：**  创建一个包含恶意Ruby代码的ERB对象。代码中执行了命令“`/usr/local/bin/score Pwned`”，可以替换为攻击者希望执行的任何命令。
6.  **包装ERB对象：**  将恶意的ERB对象包装在`ActiveSupport::Deprecation::DeprecatedInstanceVariableProxy`中，以绕过一些安全检查。
7.  **生成利用Token：**  使用`MessageVerifier`对包装后的对象进行签名，生成一个利用Token。
8.  **利用：**  将生成的Token发送到目标Rails应用。如果应用启用了开发模式，并且版本低于5.2.2.1或6.0.0.beta3，则在反序列化Token时将执行恶意代码。

**搜索引擎结果印证：** 搜索结果表明，该漏洞是真实存在的，并且已经被广泛研究。例如，PentesterLab提供了一个练习来学习如何利用该漏洞。


**项目地址:** [WildWestCyberSecurity/cve-2019-5420-POC](https://github.com/WildWestCyberSecurity/cve-2019-5420-POC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #5

**来源**: [CVE-2019-5420-cved-sources_cve-2019-5420.md](../2019/CVE-2019-5420-cved-sources_cve-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行于开发模式, 且攻击者能够猜测或获取到 development 模式下的 secret_key_base.

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5420 是一个 Rails 框架的远程代码执行漏洞，存在于开发模式下。攻击者可以通过猜测自动生成的 development 模式 secret token，然后结合其他 Rails 内部机制来执行任意代码。

**有效性：**

提供的 Dockerfile 和 Gemfile 看起来是有效的 POC 代码。Dockerfile 配置了一个包含 Rails 5.2.2 的 Ruby 环境，这是受漏洞影响的版本之一。它创建了一个新的 Rails 应用 `verifier_rce` 并设置了必要的依赖。该 POC 旨在模拟一个易受攻击的 Rails 开发环境，从而允许攻击者利用该漏洞。

**投毒风险：**

分析 POC 代码，发现投毒风险较低，约 5%。虽然代码本身旨在重现漏洞环境，但存在以下几点潜在的投毒可能：

*   **依赖风险：** Gemfile 中引入的 gems 可能会包含未知的安全问题或后门。尽管这些 gem 是 Rails 5.2.2 所需的，但我们仍需警惕供应链攻击。
*   **未明确删除测试代码/文件：** POC 代码可能包含一些用于验证漏洞的代码或文件，如果没有明确删除，可能会被误用。

总体来说，此 POC 的目的在于复现漏洞，而非恶意攻击。因此，其投毒风险较低。但仍然建议使用者仔细审查代码，确保没有隐藏的恶意行为。

**利用方式：**

1.  **目标识别：** 确定目标 Rails 应用是否运行在开发模式下。通常可以通过查看响应头或错误信息来判断。
2.  **secret_key_base 猜测/获取：** 尝试猜测或通过其他方式获取 development 模式下的 `secret_key_base`。由于开发模式下，`secret_key_base` 的生成通常不具备足够的随机性，因此存在被猜测的可能性。
3.  **构造恶意请求：** 利用获取到的 `secret_key_base`，构造包含恶意代码的请求。具体的构造方式会根据 Rails 内部机制有所不同，可能涉及到 session manipulation 或其他攻击向量。
4.  **执行任意代码：** 将恶意请求发送到目标服务器，导致服务器执行任意代码，从而获得服务器的控制权。

总的来说，漏洞利用的关键在于获取到 `secret_key_base`。成功获取后，攻击者就可以利用 Rails 内部机制来执行任意代码。

**项目地址:** [cved-sources/cve-2019-5420](https://github.com/cved-sources/cve-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #6

**来源**: [CVE-2019-5420-j4k0m_CVE-2019-5420.md](../2019/CVE-2019-5420-j4k0m_CVE-2019-5420.md)

## CVE-2019-5420 - Rails 开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (仅限开发模式)

**利用条件:** 目标Rails应用必须运行在开发模式下，且攻击者能够获取或猜测到应用名称，并能访问应用的网络端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 是一个存在于Rails框架中的远程代码执行漏洞。该漏洞只影响运行在开发模式下的Rails应用。攻击者可以通过以下步骤利用此漏洞：

1.  **猜测密钥:** 在开发模式下，Rails会自动生成一个secret token，用于加密session数据。此漏洞允许攻击者通过已知的信息（主要是应用程序的名称）来猜测该secret token。`exploit.py` 脚本演示了如何根据应用名称计算出可能的密钥。
2.  **解密 Session:** 获得secret token后，攻击者可以解密服务器的session数据。Rails使用AES-256-GCM加密session，只要知道了密钥，就能解密。
3.  **构造恶意Session:**  攻击者可以修改或构造恶意的session数据，然后使用猜测到的secret token进行加密。
4.  **利用恶意Session:** 将构造好的恶意session发送给服务器。如果服务器没有进行适当的验证，攻击者就可以利用这个session来执行任意代码。

**漏洞利用有效性:**
提供的POC代码 `exploit.py` 旨在帮助攻击者解密Rails应用程序的session，一旦密钥泄露（通过应用程序名称猜测），RCE的可能性非常高。

**投毒风险分析:**
虽然提供的代码看起来像是实现了Session解密和密钥生成的逻辑，但仍存在一定的投毒风险。风险点在于：
*   对 `backports.pbkdf2` 和 `pycryptodome` 的依赖，如果这些库被恶意篡改，可能导致安全问题。但这种风险属于供应链攻击范畴，而非代码本身携带恶意payload。
*   脚本本身并没有明显的恶意行为，例如反向shell或者信息收集。主要功能集中在密钥派生和Session解密上。
综合考虑，我评估投毒风险为 **10%**。主要风险来自于依赖库被篡改的可能性，而POC代码本身的行为相对明确。

**利用方式总结:**
1.  确定目标Rails应用是否运行在开发模式。
2.  确定目标Rails应用的应用名称。
3.  使用 `exploit.py` 脚本，输入应用名称，计算出可能的secret token。
4.  获取服务器的session cookie。
5.  将session cookie输入 `exploit.py` 脚本，解密session数据。
6.  构造恶意的session数据。
7.  使用secret token加密恶意的session数据。
8.  将恶意的session发送给服务器，尝试利用漏洞执行任意代码。

**项目地址:** [j4k0m/CVE-2019-5420](https://github.com/j4k0m/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #7

**来源**: [CVE-2019-5420-knqyf263_CVE-2019-5420.md](../2019/CVE-2019-5420-knqyf263_CVE-2019-5420.md)

## CVE-2019-5420-Rails开发模式远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (开发模式)

**利用条件:** Rails应用运行于开发模式，且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420是一个存在于Rails框架开发模式下的远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌，然后利用该令牌结合其他Rails内部机制，实现远程代码执行。漏洞影响Rails 5.2.2.1之前和6.0.0.beta3之前的版本。

**利用方式：**

1.  **猜测密钥：** 漏洞利用的关键在于猜测Rails应用在开发模式下自动生成的`secret_key_base`。由于生成算法的随机性不足，攻击者可以通过一些手段进行猜测。
2.  **构造恶意请求：** 成功获取`secret_key_base`后，攻击者可以构造一个包含恶意代码的请求，并使用该密钥对其进行签名。Rails应用在处理该请求时，会验证签名，如果验证通过，就会执行恶意代码。

**POC有效性：**

提供的Dockerfile、Gemfile等文件用于构建一个存在漏洞的Rails应用环境，方便漏洞验证。

提供的POC利用代码 `curl http://127.0.0.1:3000/rails/active_storage/disk/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHZPa0JCWTNScGRtVlRkWEJ3YjNKME9qcEVaWEJ5WldOaGRHbHZiam82UkdWd2NtVmpZWFJsWkVsdWMzUmhibU5sVm1GeWFXRmliR1ZRY205NGVRazZEa0JwYm5OMFlXNWpaVzg2Q0VWU1FnZzZDVUJ6Y21OSkloVmdkRzkxWTJnZ0wzUnRjQzl5WTJWZ0Jqb0dSVlE2RGtCbWFXeGxibUZ0WlVraUJqRUdPd2xVT2d4QWJHbHVaVzV2YVFZNkRFQnRaWFJvYjJRNkMzSmxjM1ZzZERvSlFIWmhja2tpREVCeVpYTjFiSFFHT3dsVU9oQkFaR1Z3Y21WallYUnZja2wxT2g5QlkzUnBkbVZUZFhCd2IzSjBPanBFWlhCeVpXTmhkR2x2YmdBR093bFUiLCJleHAiOm51bGwsInB1ciI6ImJsb2Jfa2V5In19--78c21ddf5ca4239d862118730069e04fbf38fd3d'/test` 看起来像是利用了Active Storage的某个功能点，结合猜测的密钥，最终触发命令执行。

根据提供的`README.md`，该POC执行`touch /tmp/rce`命令，如果执行成功，则表明漏洞利用成功。因此，该POC是有效的。

**投毒风险：**

查看提供的Dockerfile、Gemfile和LICENSE等文件，没有发现任何明显的恶意代码或后门。该漏洞本身是由于Rails开发模式下的安全配置不当造成的，POC代码只是利用了这一漏洞。`README.md` 提到 "For educational purposes only."，说明作者的意图是用于学习和研究，而不是恶意利用。因此，可以认为该代码存在投毒风险的概率很低，大约为0%。

**项目地址:** [knqyf263/CVE-2019-5420](https://github.com/knqyf263/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #8

**来源**: [CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md](../2019/CVE-2019-5420-laffray_ruby-RCE-CVE-2019-5420-.md)

## CVE-2019-5420 - Rails Development Mode 远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下，并且攻击者能够访问该应用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Rails 开发模式下，当 Rails 版本低于 5.2.2.1 或 6.0.0.beta3 时，攻击者可以猜测自动生成的开发模式 secret token。这个 secret token 可以与 Rails 内部机制结合，从而实现远程代码执行。

**漏洞利用方式：**

1.  **获取 Secret Key Base：** 攻击者需要首先获取到 Rails 应用的 `secret_key_base`。在开发模式下，这个密钥通常是基于应用名称生成的，因此相对容易猜测。PoC 代码中通过 `Digest::MD5.hexdigest(VerifierRce::Application.name)` 演示了如何计算 `secret_key_base`。
2.  **生成 ActiveStorage 密钥：** 使用 `secret_key_base` 和 `ActiveSupport::KeyGenerator` 生成用于 `ActiveStorage` 的密钥。
3.  **构建恶意 Payload：** 攻击者需要构建一个恶意 Ruby 对象，该对象在反序列化时会执行任意命令。PoC 中展示了利用 `system` 函数执行 shell 命令的方式。
4.  **利用 ActiveSupport::MessageVerifier 或 ActiveSupport::MessageEncryptor：** 使用生成的密钥，通过 `ActiveSupport::MessageVerifier` 或者 `ActiveSupport::MessageEncryptor` 对恶意对象进行签名，然后将签名后的数据作为参数传递给存在漏洞的路由（例如 `/rails/active_storage/disk/:encoded_key`）。
5.  **触发反序列化：** 当 Rails 应用接收到包含恶意签名的请求时，会使用 `Marshal.load` 对签名进行反序列化，从而执行攻击者注入的命令。

**投毒风险分析：**

PoC 代码主要用于演示漏洞的利用过程，本身并没有明显的恶意代码。风险点在于 Docker 镜像 `knqyf263/cve-2019-5420` 是否包含后门。该镜像由第三方提供，存在一定风险，建议在使用前进行安全审计。

`https://github.com/PenTestical/CVE-2019-5420` 这个仓库本身看起来是用于记录漏洞信息的，readme.md 中包含下载第三方docker镜像，存在第三方镜像投毒的风险。

**风险评估：**

*   POC的有效性高，因为漏洞原理清晰，且有相应的验证方法。
*   投毒风险评估为10%， 主要来自 docker 镜像，作者本身可能为了快速验证漏洞选择使用现成的镜像，这导致了存在一定的投毒风险。 另外一种风险是仓库中存在一些链接，这些链接可能存在风险。 实际投毒风险评估取决于对镜像的详细审计以及链接指向的安全性。

**项目地址:** [laffray/ruby-RCE-CVE-2019-5420-](https://github.com/laffray/ruby-RCE-CVE-2019-5420-)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---



---

## POC #9

**来源**: [CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md](../2019/CVE-2019-5420-mmeza-developer_CVE-2019-5420-RCE.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 5.2.2.1, < 6.0.0.beta3 (development mode)

**利用条件:** Rails 应用运行于开发模式，且攻击者可以访问该应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在 Rails 开发模式下执行远程代码。该漏洞的核心在于 Rails 在开发模式下自动生成的 secret_key_base 的随机性不足，使得攻击者可以通过爆破或已知模式猜测到该密钥。一旦 secret_key_base 被破解，攻击者就可以利用它来构造恶意 session cookie，从而利用 Marshal.load 反序列化漏洞执行任意代码。

**漏洞利用方式：**

1.  **密钥猜测/获取:**  由于开发模式下 secret_key_base 密钥生成方式不安全，尝试猜测或利用已知模式获取密钥。
2.  **构造恶意 Session:**  使用获取到的 secret_key_base，结合漏洞利用代码，生成包含恶意 Ruby 对象的序列化数据，然后对其进行加密和签名，形成恶意的 session cookie。
3.  **发送恶意 Cookie:**  将构造的恶意 session cookie 发送到 Rails 应用。
4.  **RCE:**  Rails 应用在处理恶意 cookie 时，会使用 Marshal.load 反序列化其中的 Ruby 对象，从而触发代码执行。

**POC 代码分析：**

提供的 Ruby 代码展示了漏洞利用的整个过程：

*   **getSessionKey:** 用于从credentials 文件中获取解密后的session key。credentials 文件包含了密钥相关的信息,如iv和tag等。
*   **cookie 解密:**  使用猜测或已知 secret_key_base 解密现有的 session cookie。
*   **构造 Payload:**  利用 `Gem::StubSpecification` 和 `Marshal.dump` 构造恶意 Ruby 对象，该对象在反序列化时会执行系统命令，POC中为`/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2`。
*   **加密 Payload:**  使用 secret_key_base 重新加密包含恶意对象的 session cookie。
*   **替换 Cookie:**  将生成的恶意 cookie 发送给目标 Rails 应用。

**投毒风险分析：**

该代码中主要的风险在于通过 `stub_specification.instance_variable_set(:@loaded_from, "|/usr/local/bin/score 1bde8715-5ddf-4f03-9c72-897348939e50 1>&2")` 设置的命令执行。这部分代码的目的是利用漏洞执行任意命令。这部分代码有可能是开发者为了测试漏洞而添加，但也有可能是恶意代码。由于无法确定 `/usr/local/bin/score` 的功能，因此存在一定的投毒风险。

**风险评估：**

*   **漏洞利用有效性：**  有效，只要目标 Rails 应用运行在开发模式，且密钥可以被猜测/获取，该 POC 就可以成功执行远程代码。
*   **投毒风险：**  存在一定的投毒风险，集中在 `/usr/local/bin/score` 命令的执行上。如果该命令是恶意的，则该 POC 代码可以被认为存在投毒。

由于无法直接验证 `/usr/local/bin/score` 的功能，我们将投毒风险评定为 10% 。这部分代码的存在使得利用过程具有不确定性，因为如果攻击者直接使用该 POC，可能会执行未知的恶意命令。

**项目地址:** [mmeza-developer/CVE-2019-5420-RCE](https://github.com/mmeza-developer/CVE-2019-5420-RCE)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #10

**来源**: [CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md](../2019/CVE-2019-5420-scumdestroy_CVE-2019-5420.rb.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.2.1, < 6.0.0.beta3

**利用条件:** Rails应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞允许攻击者在Rails应用处于开发模式时执行远程代码。这是因为开发模式下 Rails 自动生成的 secret token 容易被猜测。攻击者通过猜测到的 secret token，结合 Rails 内部机制，可以提升权限并执行任意代码。

**有效性：**
提供的PoC代码有效。它通过以下步骤利用漏洞：
1.  获取开发模式 Rails 应用的 cookie。
2.  使用应用的名称作为盐值，通过 MD5 哈希和 PKCS5 Key Derivation Function 2 (PBKDF2) 生成 secret key。
3.  解密 cookie 数据，然后反序列化。
4.  修改解密后的数据，比如修改 user_id 来提权。
5.  重新加密数据，生成新的 cookie。
6.  将新的 cookie 发送给服务器，从而以目标用户的身份进行操作。

**投毒风险：**
PoC 代码的投毒风险较低，大约为 10%。 风险点在于:
*   脚本要求用户手动插入目标Rails应用名称和Cookie, 这种用户交互降低了自动利用的风险，减少了大范围攻击的可能性。


**利用方式：**
1.  **目标环境确认:** 首先，确认目标 Rails 应用是否运行在开发模式下。这是漏洞利用的前提条件。
2.  **应用名称枚举:** 尝试枚举 Rails 应用的名称。PoC 代码中使用应用名称作为生成 secret key 的盐值。可以通过信息泄露、错误页面等方式获取应用名称。
3.  **Cookie捕获:** 获得目标 Rails 应用的 Cookie。这可以通过网络抓包或者浏览器开发者工具来获取。
4.  **Secret Key生成:** 使用提供的 Ruby 脚本，结合应用名称和默认的盐值生成 secret key。
5.  **Cookie解密和篡改:** 使用生成的 secret key 解密 Cookie，修改其中的用户 ID 或其他敏感信息。
6.  **Cookie重加密和发送:** 使用 secret key 重新加密 Cookie，然后将篡改后的 Cookie 发送给服务器。
7.  **权限提升:** 如果 Cookie 篡改成功，攻击者将以被篡改用户的身份登录，获得相应的权限。

**项目地址:** [scumdestroy/CVE-2019-5420.rb](https://github.com/scumdestroy/CVE-2019-5420.rb)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #11

**来源**: [CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md](../2019/CVE-2019-5420-sealldeveloper_CVE-2019-5420-PoC.md)

## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

## POC #12

**来源**: [CVE-2019-5420-trickstersec_CVE-2019-5420.md](../2019/CVE-2019-5420-trickstersec_CVE-2019-5420.md)

## CVE-2019-5420-Rails-远程代码执行

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <5.2.2.1, <6.0.0.beta3 (development mode)

**利用条件:** Rails应用运行在开发模式下，且攻击者可以访问应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5420 漏洞是Rails在开发模式下存在的一个远程代码执行漏洞。攻击者可以通过猜测自动生成的开发模式密钥令牌（secret token），然后结合其他Rails内部机制，提升权限并执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，此漏洞在特定条件下是有效的。提供的POC代码`exploit.rb` 旨在利用此漏洞。代码通过以下步骤工作：
1.  **解密Cookie：** 使用已知的或猜测的密钥解密Rails会话cookie。
2.  **篡改数据：** 在解密后的会话数据中，修改`user_id`等敏感信息，以达到权限提升的目的。
3.  **重新加密Cookie：** 使用相同的密钥和算法重新加密篡改后的会话数据，生成新的cookie。
4.  **URL编码：** 将新生成的cookie进行URL编码，以便在HTTP请求中使用。

通过替换用户的cookie，攻击者可以冒充其他用户（例如管理员）。

**投毒风险分析：**
POC代码本身的主要功能是利用已知的漏洞进行攻击，并非恶意代码。但代码中存在一些小的风险点：
1.  **硬编码的密钥推导：** 代码假设应用名为“PentesterLab::Application”，这是一种简化。如果实际应用名称不同，利用将会失败。但这并不构成投毒，而是一种对特定环境的依赖。
2.  **对特定库的依赖:** 代码依赖于`openssl`、`uri`、`base64`等库，如果这些库存在漏洞，可能会引入额外的风险。
3.  **缺乏输入验证：** 代码没有对输入数据进行严格的验证，如果攻击者能够控制输入，可能会导致其他问题。

总体来说，此仓库的投毒风险较低，约为10%。 主要风险来自于使用者在不了解代码的情况下，直接运行可能存在风险。 需要注意的是，在生产环境中使用此类POC代码进行测试可能会带来风险，建议在隔离环境中进行。

**利用方式：**
1.  **目标识别：** 确定运行在开发模式下的Rails应用，且版本在受影响范围内。
2.  **密钥猜测或获取：** 尝试猜测或通过其他方式获取开发模式下的secret token。在一些情况下，可以通过访问公开的仓库或者配置文件获取。
3.  **Cookie解密与篡改：** 使用POC代码解密现有的cookie，篡改其中的用户ID或其他敏感信息。
4.  **Cookie重新加密与替换：** 使用相同的密钥重新加密cookie，并替换用户浏览器中的cookie。
5.  **权限提升：** 通过篡改后的cookie，以其他用户的身份访问应用，实现权限提升或未授权访问。

**项目地址:** [trickstersec/CVE-2019-5420](https://github.com/trickstersec/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)

---

