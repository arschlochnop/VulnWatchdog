# CVE-2019-11043

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** 需要特定的FPM配置，允许通过精心构造的请求导致缓冲区溢出。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。具体来说，在PHP 7.1.x低于7.1.33、7.2.x低于7.2.24和7.3.x低于7.3.11版本中，当FPM配置不当时，攻击者可以通过发送特制的请求，导致FPM模块将数据写入超出分配的缓冲区，覆盖FCGI协议数据，最终实现远程代码执行。该漏洞的根源在于PHP-FPM在处理PATH_INFO时，由于计算错误导致缓冲区溢出。攻击者可以通过操纵请求中的PATH_INFO长度来触发此漏洞。该POC代码通过精心构造HTTP请求中的query长度和Header头字段长度来爆破并利用该漏洞，进而控制服务器。首先，脚本判断目标是否存在漏洞，然后判断目标php worker进程数实现健壮性，最后全worker进程污染。利用过程如下：首先发送一个包含特定PHP配置选项的HTTP请求，这些选项旨在修改PHP的运行时行为，如开启`session.auto_start`，设置错误报告级别和日志记录等。接下来，通过发送大量的’Q’字符作为查询字符串的一部分，以及调整HTTP头部`D-Gisos`的长度，来触发缓冲区溢出。成功利用该漏洞后，攻击者可以在目标服务器上执行任意代码。这个POC的有效性很高，因为它能够在特定条件下稳定地触发漏洞并执行代码，在测试环境中，该POC能够可靠地实现远程代码执行。利用步骤：1. 确保目标系统运行着受影响的PHP-FPM版本，并且配置符合漏洞利用的要求。2. 运行POC脚本，并提供目标URL作为参数。3. 脚本会自动检测目标是否存在漏洞，并尝试利用该漏洞。4. 如果利用成功，攻击者就可以在目标服务器上执行任意代码。投毒风险分析：该POC的投毒风险较低，因为它主要依赖于PHP的内置功能和配置选项，没有包含任何恶意代码或外部脚本。唯一潜在的风险是，如果攻击者在利用该漏洞后植入恶意后门程序，那么系统就会受到威胁。由于该POC没有混淆代码，且未使用eval等高危函数，仅仅依赖于标准库和网络请求，因此判定投毒风险为10%。

**项目地址:** https://github.com/0th3rs/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24 and 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM, specific configuration required, network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是PHP-FPM的一个远程代码执行漏洞，当Nginx作为反向代理服务器，并将请求转发给PHP-FPM时，如果Nginx的配置不当（例如使用了错误的fastcgi_split_path_info），攻击者可以通过构造特殊的请求，利用PHP-FPM处理PATH_INFO时的缺陷，实现在服务器上执行任意代码。具体来说，Nginx上fastcgi split path info 在处理带有%0a的请求时,会因为遇到换行符\n导致PATH INFO为空。而php-fpm在处理PATH INFO为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。

POC有效性分析：
提供的POC代码是一个Python脚本，用于检测目标服务器是否存在CVE-2019-11043漏洞。该脚本首先检查目标服务器是否运行PHP和Nginx，然后通过发送带有特殊构造的URL的HTTP请求，来触发该漏洞。如果服务器返回502错误，则表示该服务器可能存在漏洞。该POC通过循环改变URL中的'Q'的数量，并发送请求，如果返回502，则输出可能存在漏洞的QSL（Query String Length）。

利用步骤：
1. 确定目标服务器的URL。
2. 运行POC脚本，指定目标URL作为参数。
3. 观察脚本的输出，如果脚本报告找到了可能存在漏洞的QSL，则表示目标服务器可能存在CVE-2019-11043漏洞。
4. 利用phuip-fpizdam工具或类似的利用工具，使用找到的QSL来执行任意代码。

更详细的步骤如下：
a) 确认目标使用了存在漏洞的Nginx + PHP-FPM配置，通常是使用了类似`fastcgi_split_path_info`的配置，并且没有正确处理PATH_INFO。
b) 使用POC脚本或`phuip-fpizdam`工具，发送精心构造的HTTP请求。请求包含`%0a`（换行符）以及特定长度的查询字符串，目的是触发PHP-FPM的缓冲区溢出。
c) 如果漏洞存在，PHP-FPM进程可能会崩溃，或者允许攻击者覆盖某些内存区域。
d) 攻击者可以进一步利用此漏洞，通过覆盖内存中的特定值，来执行任意代码。这通常需要对PHP-FPM的内部机制有深入的了解。

投毒风险分析：
该POC代码主要用于漏洞检测，其本身不包含恶意代码或后门，因此投毒风险较低。但是，如果攻击者修改了该POC代码，使其在检测漏洞的同时，还在目标服务器上执行恶意代码，那么投毒风险就会大大增加。例如，攻击者可以在POC代码中添加代码，用于上传恶意文件、修改系统配置、或窃取敏感数据。此外，如果攻击者将该POC代码与其他恶意软件捆绑在一起，那么用户在运行该POC代码时，也会面临被感染的风险。此POC使用requests标准库，代码逻辑清晰，风险较低。该POC唯一的可疑之处在于User-Agent，D-Pisos，Ebut的Header设置，存在一定的探测痕迹，但总体投毒风险较低，评估为10%。

**项目地址:** https://github.com/AleWong/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #3

**来源**: [CVE-2019-11043-AndrewMas99_CVE-2019-11043-Vulnerability.md](../2019/CVE-2019-11043-AndrewMas99_CVE-2019-11043-Vulnerability.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行(RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 受特定配置影响，具体版本未明确说明，通常是 Nginx + PHP-FPM 的组合

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，允许攻击者发送特制的请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于 Nginx + PHP-FPM 的特定配置中。该漏洞源于 PHP-FPM 在处理路径时存在缺陷，攻击者可以通过构造恶意请求，绕过安全检查，从而执行任意代码。从搜索结果和POC代码来看，该漏洞利用较为成熟，存在公开的POC，可以相对容易地复现。POC代码展示了如何利用该漏洞，通过发送特制的请求，在目标服务器上执行任意代码。利用步骤通常包括：1. 搭建存在漏洞的 Nginx + PHP-FPM 环境。2. 构造包含恶意代码的 HTTP 请求，该请求需要满足特定的格式，以便绕过 PHP-FPM 的安全检查。3. 将构造的请求发送到目标服务器。4. 如果漏洞利用成功，恶意代码将在目标服务器上执行。根据POC的描述，攻击者可以利用此漏洞建立反向隧道，从而实现持久控制。例如，可以使用 SSH 反向隧道将目标服务器的端口映射到攻击者的服务器，从而允许攻击者远程访问目标服务器。也可以使用 PHP 编写的反向 shell 实现持久控制。POC有效性分析：该漏洞的POC已经公开，并且在多个漏洞复现环境中得到了验证，证明该漏洞是真实存在的，并且可以被成功利用。通过分析POC代码，可以发现攻击者是如何构造恶意请求的，以及如何绕过 PHP-FPM 的安全检查的。该漏洞的成功利用依赖于特定的 Nginx + PHP-FPM 配置，因此在实际环境中，并非所有的 Nginx + PHP-FPM 服务器都存在该漏洞。然而，由于 Nginx + PHP-FPM 是一种常见的 Web 服务器配置，因此该漏洞的影响范围仍然很大。投毒风险分析：该漏洞的POC代码主要用于漏洞验证和安全研究，本身不包含恶意代码。然而，如果攻击者将恶意代码嵌入到 POC 中，并将其传播到互联网上，那么可能会存在一定的投毒风险。例如，攻击者可以将恶意代码嵌入到 HTTP 请求中，或者嵌入到 PHP 脚本中。一旦受害者运行了包含恶意代码的 POC，恶意代码将在受害者的服务器上执行，从而导致安全问题。尽管存在一定的投毒风险，但由于该漏洞的POC代码相对复杂，需要一定的技术背景才能理解和修改，因此投毒风险相对较低。此外，安全研究人员通常会对公开的POC进行安全分析，从而降低投毒风险。该POC主要通过构造特殊格式的HTTP请求，触发PHP-FPM的漏洞，实现代码执行。本身代码逻辑不复杂，主要依赖于HTTP请求的构造。因此，投毒风险较低。存在的风险点是，使用者可能在验证漏洞时，直接将恶意代码写入POC中，导致被他人利用。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #4

**来源**: [CVE-2019-11043-CodeHex083_phuip-fpizdam.md](../2019/CVE-2019-11043-CodeHex083_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行(RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** PHP 7+ (受影响版本范围未知，漏洞存在于修复前的版本)

**利用条件:** 需要特定配置的Nginx + PHP-FPM环境，攻击者可以通过发送特制的HTTP请求触发漏洞。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。该漏洞存在于使用特定配置的Nginx + PHP-FPM的服务器中，允许攻击者远程执行代码。攻击者通过构造特殊的HTTP请求，可以绕过`fastcgi_split_path_info`指令的限制，从而将恶意代码传递给PHP-FPM执行。漏洞利用的关键在于`PATH_INFO`变量的处理，以及Nginx配置文件中缺少对文件是否存在性的检查。利用该漏洞，攻击者可以在服务器上执行任意代码，从而控制服务器，窃取敏感信息或进行其他恶意活动。

POC代码分析表明，该漏洞利用程序通过发送包含特定格式的URL的HTTP请求来触发漏洞。该URL旨在破坏`fastcgi_split_path_info`指令的正则表达式，从而允许攻击者将恶意代码作为`PATH_INFO`传递给PHP-FPM。为了成功利用此漏洞，目标服务器必须具有特定的Nginx + PHP-FPM配置，包括使用`fastcgi_split_path_info`指令，并且缺少诸如`try_files`之类的脚本存在性检查。POC代码提供了一个完整的漏洞利用程序，可以自动执行利用过程。该POC的质量很高，因为它包含完整的漏洞利用代码，并且提供了有关如何设置易受攻击环境的说明。

利用步骤：
1.  设置一个具有易受攻击配置的Nginx + PHP-FPM服务器。这包括使用`fastcgi_split_path_info`指令，并将`PATH_INFO`变量设置为`$fastcgi_path_info`，同时确保没有诸如`try_files`之类的脚本存在性检查。
2.  使用POC代码针对易受攻击的服务器发送特制的HTTP请求。
3.  如果漏洞利用成功，则将在服务器上执行恶意代码。

投毒风险分析：
该POC的投毒风险较低。虽然POC代码确实允许在服务器上执行任意代码，但该代码本身并不包含任何恶意功能。但是，始终存在攻击者修改POC代码以包含恶意代码的风险。例如，攻击者可能会修改POC代码，使其在服务器上安装后门或窃取敏感信息。此外，如果攻击者能够利用此漏洞控制服务器，他们可能会使用该服务器来托管恶意软件或发起其他攻击。由于POC主要利用已知的漏洞配置，并且依赖于对`PATH_INFO`变量的精确控制，因此直接在POC中添加恶意后门或病毒的难度较高。代码主要集中在构造特定格式的HTTP请求以绕过安全限制，而不是执行复杂的恶意操作。然而，攻击者可能会修改POC，在成功利用后下载并执行额外的恶意脚本，从而增加投毒风险。总的来说，该漏洞的投毒风险较低，约为15%。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** None


---

## POC #5

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定的Nginx + PHP-FPM配置，攻击者需要能够发送特制的HTTP请求。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。此漏洞允许攻击者在特定的Nginx + PHP-FPM配置中执行任意代码。漏洞的根本原因是PHP-FPM在处理畸形的请求时，由于计算错误导致缓冲区溢出。具体来说，当`fastcgi_split_path_info`指令被不正确地配置时，攻击者可以通过构造包含大量'\n'字符的请求，使得PHP-FPM错误地解析PATH_INFO，并触发缓冲区溢出。

POC有效性分析：提供的Python脚本（cve_2019_11043.py）旨在利用此漏洞。脚本通过发送包含特定头部和查询字符串的HTTP请求，来触发缓冲区溢出。脚本首先尝试判断目标是否存在漏洞（judgeTarget函数），它通过发送带有不同长度'Q'字符的请求来探测。如果目标返回包含'Set-Cookie'头的响应，则表明目标可能存在漏洞。然后，脚本尝试确定目标PHP worker进程的数量，并通过修改PHP配置来污染所有worker进程。

利用步骤：
1.  配置Nginx以使用fastcgi_pass将PHP请求传递给PHP-FPM。
2.  确保Nginx配置中存在`fastcgi_split_path_info`指令。
3.  运行提供的Python脚本，并指定目标URL，例如：`python cve_2019_11043.py -u http://xxxx/index.php`。
4.  脚本将自动发送特制的HTTP请求，触发漏洞。
5.  成功利用后，攻击者可以在目标服务器上执行任意代码。

投毒风险分析：
此POC的投毒风险较低。脚本本身主要使用标准的Python库，例如`requests`和`http.client`。脚本的行为相对清晰，主要目的是发送HTTP请求和修改PHP配置。脚本中使用的`extension=$_GET[a]`可能被视为潜在的风险点，因为它允许通过GET参数指定要加载的PHP扩展，这可以被滥用来加载恶意扩展。但是，此POC的目的是为了利用漏洞，而不是植入后门或执行其他恶意操作。而且代码可读性很高，并没有进行任何混淆处理，因此总体的投毒风险较低，评估为10%。

**项目地址:** https://github.com/0th3rs/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #6

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043 - PHP-FPM with specific Nginx configurations Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM with specific Nginx configurations

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** Specifically affects configurations of Nginx and PHP-FPM where the `cgi.fix_pathinfo` is enabled and improperly configured.

**利用条件:** Requires a specific configuration of Nginx and PHP-FPM. The `cgi.fix_pathinfo` must be enabled and misconfigured. No authentication is required.

**POC 可用性:** 9/10

**POC 类型:** Complete Exploitation

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a critical remote code execution vulnerability that affects PHP-FPM when used in conjunction with Nginx under specific configurations. The vulnerability stems from an incorrect implementation of the `cgi.fix_pathinfo` directive. When enabled, this directive is intended to handle requests for files that do not exist by passing the request to the PHP interpreter. However, a flaw in how Nginx passes requests to PHP-FPM allows attackers to inject arbitrary code. 

POC代码有效性分析：
The provided Dockerfile and associated files create an intentionally vulnerable environment that replicates the conditions required to trigger CVE-2019-11043. The Dockerfile sets up an Ubuntu 19.10 environment with Nginx and PHP 7.3, configuring PHP-FPM to listen on localhost:9000. Crucially, it retains the vulnerable `cgi.fix_pathinfo = 1` setting. The `nginx.conf` file contains a minimal, intentionally vulnerable fastcgi block that exposes the flaw. The provided README outlines the steps to build and run the vulnerable application, as well as a quickstart guide to exploit the vulnerability using `phuip-fpizdam`. The included application is a task management app, which is just to provide a functional application context.

利用步骤：
1. Build the Docker image using `docker build -t cve-2019-11043-lab:app .`.
2. Run the Docker container using `docker run --rm -p 8080:80 cve-2019-11043-lab:app`.
3. Open the application in a browser at `http://localhost:8080/`.
4. Use `phuip-fpizdam` or a similar tool to exploit the vulnerability by sending a crafted request to a PHP file (e.g., `status.php`). The tool will identify the correct parameters and construct the exploit.

投毒风险分析：
The primary risk associated with this specific POC is relatively low. The Dockerfile builds a self-contained environment. The primary risk resides in the use of external tools like `phuip-fpizdam`. While `phuip-fpizdam` itself is a known exploitation tool and does not inherently contain malicious code, obtaining the tool from untrusted sources could introduce a risk of using a tampered version. The risk is mitigated by the fact that the tool's functionality is focused on exploiting the RCE, and not on establishing persistence or gathering information. The docker image installs php extensions using apt-get from ubuntu mirrors, which has a minimal risk of poisoning, because of established software supply chain security controls. Therefore, the poisoning risk is estimated to be around 10%. The risk could be higher if the attacker uses the RCE to install more backdoors.

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #7

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Requires specific FPM setup configuration. Network access to the vulnerable PHP-FPM instance.

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a remote code execution vulnerability affecting PHP-FPM. It stems from a buffer overflow in certain configurations where the FPM module writes past allocated buffers into the space reserved for FCGI protocol data. This allows an attacker to execute arbitrary code on the server. 

The provided Proof-of-Concept (POC) code consists of a Dockerfile, a Readme, Nginx configuration, a PHP file, and a shell script. The Dockerfile sets up a vulnerable PHP-FPM environment using PHP version 7.3.9 and Nginx version 1.16.1. The Readme provides instructions on how to run the Docker image and exploit the vulnerability. It references an external exploit available at `https://github.com/neex/phuip-fpizdam`. The Nginx configuration defines a server block that listens on port 80 and forwards PHP requests to the PHP-FPM server running on 127.0.0.1:9000. The PHP file simply outputs the number 1. The shell script starts the PHP-FPM server and Nginx.

To validate the POC, the provided steps in the Readme should be followed. First, the Docker image is run, exposing port 8080. Then, the `phuip-fpizdam` exploit is built. Finally, the exploit is executed against the running application, which should result in successful remote code execution. The Readme demonstrates successful command execution by using `curl` to execute the `which which` command on the server. The exploit works by manipulating the query string to cause a buffer overflow in PHP-FPM, allowing the attacker to inject and execute arbitrary code.

The vulnerability can be triggered by crafting a specific URL with a long query string which causes the buffer overflow in PHP-FPM. The `fastcgi_split_path_info` directive in the Nginx configuration plays a crucial role in triggering the vulnerability. The exploit leverages the way PHP-FPM processes the PATH_INFO variable.

The provided POC is of high quality, as it includes a complete working exploit, clear instructions, and all necessary files to reproduce the vulnerability.

**投毒风险分析:**

虽然提供的docker image和POC本身是为了演示漏洞利用，但是仍然存在一定的投毒风险。Dockerfile 中直接使用 `apt update && apt install -y libargon2-0 libedit-dev libcurl4-openssl-dev` 可能会引入未知的软件包依赖风险。 Starter.sh 启动php-fpm 和 nginx服务，可能被替换成恶意程序。由于该POC 主要目的是为了复现漏洞，代码本身可读性较强，且主要依赖github.com/neex/phuip-fpizdam 这个已知的漏洞利用工具，直接恶意投毒的可能性较低。 考虑到利用该漏洞可以执行任意代码，攻击者可能会在成功利用后植入后门或恶意软件，所以需要防范被利用后进行进一步的恶意行为。 总体来说，投毒风险较低，约为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #8

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 特定配置的 Nginx + PHP-FPM

**利用条件:** 需要特定配置的 Nginx + PHP-FPM，向Nginx + PHP-FPM的服务器发送特制请求

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个远程代码执行漏洞，存在于某些特定配置的 Nginx + PHP-FPM 服务器上。攻击者可以通过发送特制的请求来执行任意代码。根据搜索结果和提供的POC代码，可以确认该漏洞是可利用的。POC代码是一个Python脚本，它通过设置一个特殊的User-Agent头来发送请求，该请求会导致PHP-FPM执行任意代码。利用步骤如下：

1.  确定目标服务器是否使用了受影响的 Nginx + PHP-FPM 配置。
2.  运行提供的 Python POC 脚本，并指定目标 URL 作为参数。
3.  脚本将提示输入要执行的命令。
4.  输入命令后，脚本将发送带有特制 User-Agent 头的请求。
5.  PHP-FPM 将执行该命令，并将结果返回。
6.  脚本将打印命令的输出结果。

POC有效性分析：提供的POC脚本非常简单，易于使用，且利用了漏洞的根本原因。通过修改User-Agent头，可以绕过某些安全检查，从而执行任意代码。多个搜索结果表明，该漏洞已被广泛研究和利用，并且存在多个可用的POC。

投毒风险分析：该POC的投毒风险较低。该脚本主要使用标准Python库（requests），并且没有发现任何混淆或恶意代码。该脚本的目的是发送一个带有特殊构造的HTTP头的请求，这个请求本身并不会对系统造成直接损害。 然而，由于该POC允许攻击者在目标服务器上执行任意代码，因此存在潜在的风险。如果攻击者使用该POC来上传恶意文件或执行其他恶意操作，则可能会对目标系统造成严重损害。此外，如果攻击者修改了POC代码，并添加了恶意功能，则可能会增加投毒风险。例如，攻击者可以添加代码来收集系统信息或安装后门程序。总的来说，该POC的投毒风险较低，但仍需谨慎使用，并确保从可信来源获取代码。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #9

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Specific FPM configurations are vulnerable. Requires network access to the vulnerable server.

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP 7.1.x 低于 7.1.33 版本、7.2.x 低于 7.2.24 版本和 7.3.x 低于 7.3.11 版本的特定 FPM 配置中。该漏洞允许攻击者通过操纵请求，使 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖为 FCGI 协议数据保留的空间，进而实现远程代码执行。该漏洞的产生是由于 FPM 在处理畸形请求时，对请求头的长度验证不充分，导致缓冲区溢出。

POC 代码分析:
POC 代码是一个 Python 脚本，它首先通过发送带有不同长度 'Q' 字符的 GET 请求来查找潜在的易受攻击的长度。脚本检查 HTTP 状态码是否大于或等于 500，如果是，则将该长度添加到 `vuln_lengths` 列表中。然后，脚本创建一个包含几个潜在漏洞长度的列表 `vuln_list`。对于 `vuln_list` 中的每个长度，脚本进入一个 while 循环，该循环会递增 header_length 并发送两个 GET 请求：一个带有 'P' 字符，另一个带有 'C' 字符。这两个请求都尝试设置 `session.auto_start` PHP 配置指令。脚本检查响应头中是否存在 `Set-Cookie` 和 `PHPSESSID`，如果存在，则它会打印一个 curl 命令，该命令可用于利用该漏洞。

利用步骤:
1. 确定目标服务器上运行的 PHP 版本以及 FPM 配置。
2. 运行 POC 脚本来识别易受攻击的 URL 长度。该脚本会尝试不同的长度，直到找到一个导致服务器返回 500 错误的长度为止。
3. 使用脚本生成的 curl 命令来利用该漏洞。该命令将发送一个特制的 GET 请求，该请求将覆盖 FPM 模块中的内存，并允许攻击者执行任意代码。

POC 有效性分析：
POC 代码相对有效，因为它能够自动检测易受攻击的长度并生成可用于利用该漏洞的 curl 命令。但是，该 POC 依赖于特定的 FPM 配置才能成功利用该漏洞。此外，该 POC 可能会导致目标服务器崩溃。

投毒风险分析:
该 POC 脚本主要使用 `requests` 库，没有明显的恶意行为。它旨在发现和利用漏洞，而不是进行恶意活动。该脚本的目的是验证漏洞是否存在，并提供利用该漏洞的方法，并为安全研究人员和系统管理员提供修复漏洞的机会。尽管该脚本本身不包含恶意代码，但如果攻击者使用它来攻击未打补丁的系统，则可能造成损害。该漏洞允许远程代码执行，因此攻击者可以安装恶意软件、窃取数据或破坏系统。由于利用需要特定的 FPM 配置，且代码本身相对清晰，因此投毒风险较低，约为10%。

**项目地址:** https://github.com/vulhub/vulhub/blob/master/php/CVE-2019-11043/README.md

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #10

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **24** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** 需要特定的FPM配置，允许通过精心构造的请求导致缓冲区溢出。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。具体来说，在PHP 7.1.x低于7.1.33、7.2.x低于7.2.24和7.3.x低于7.3.11版本中，当FPM配置不当时，攻击者可以通过发送特制的请求，导致FPM模块将数据写入超出分配的缓冲区，覆盖FCGI协议数据，最终实现远程代码执行。该漏洞的根源在于PHP-FPM在处理PATH_INFO时，由于计算错误导致缓冲区溢出。攻击者可以通过操纵请求中的PATH_INFO长度来触发此漏洞。该POC代码通过精心构造HTTP请求中的query长度和Header头字段长度来爆破并利用该漏洞，进而控制服务器。首先，脚本判断目标是否存在漏洞，然后判断目标php worker进程数实现健壮性，最后全worker进程污染。利用过程如下：首先发送一个包含特定PHP配置选项的HTTP请求，这些选项旨在修改PHP的运行时行为，如开启`session.auto_start`，设置错误报告级别和日志记录等。接下来，通过发送大量的’Q’字符作为查询字符串的一部分，以及调整HTTP头部`D-Gisos`的长度，来触发缓冲区溢出。成功利用该漏洞后，攻击者可以在目标服务器上执行任意代码。这个POC的有效性很高，因为它能够在特定条件下稳定地触发漏洞并执行代码，在测试环境中，该POC能够可靠地实现远程代码执行。利用步骤：1. 确保目标系统运行着受影响的PHP-FPM版本，并且配置符合漏洞利用的要求。2. 运行POC脚本，并提供目标URL作为参数。3. 脚本会自动检测目标是否存在漏洞，并尝试利用该漏洞。4. 如果利用成功，攻击者就可以在目标服务器上执行任意代码。投毒风险分析：该POC的投毒风险较低，因为它主要依赖于PHP的内置功能和配置选项，没有包含任何恶意代码或外部脚本。唯一潜在的风险是，如果攻击者在利用该漏洞后植入恶意后门程序，那么系统就会受到威胁。由于该POC没有混淆代码，且未使用eval等高危函数，仅仅依赖于标准库和网络请求，因此判定投毒风险为10%。

**项目地址:** https://github.com/0th3rs/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24 and 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM, specific configuration required, network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是PHP-FPM的一个远程代码执行漏洞，当Nginx作为反向代理服务器，并将请求转发给PHP-FPM时，如果Nginx的配置不当（例如使用了错误的fastcgi_split_path_info），攻击者可以通过构造特殊的请求，利用PHP-FPM处理PATH_INFO时的缺陷，实现在服务器上执行任意代码。具体来说，Nginx上fastcgi split path info 在处理带有%0a的请求时,会因为遇到换行符\n导致PATH INFO为空。而php-fpm在处理PATH INFO为空的情况下，存在逻辑缺陷。攻击者通过精心的构造和利用，可以导致远程代码执行。

POC有效性分析：
提供的POC代码是一个Python脚本，用于检测目标服务器是否存在CVE-2019-11043漏洞。该脚本首先检查目标服务器是否运行PHP和Nginx，然后通过发送带有特殊构造的URL的HTTP请求，来触发该漏洞。如果服务器返回502错误，则表示该服务器可能存在漏洞。该POC通过循环改变URL中的'Q'的数量，并发送请求，如果返回502，则输出可能存在漏洞的QSL（Query String Length）。

利用步骤：
1. 确定目标服务器的URL。
2. 运行POC脚本，指定目标URL作为参数。
3. 观察脚本的输出，如果脚本报告找到了可能存在漏洞的QSL，则表示目标服务器可能存在CVE-2019-11043漏洞。
4. 利用phuip-fpizdam工具或类似的利用工具，使用找到的QSL来执行任意代码。

更详细的步骤如下：
a) 确认目标使用了存在漏洞的Nginx + PHP-FPM配置，通常是使用了类似`fastcgi_split_path_info`的配置，并且没有正确处理PATH_INFO。
b) 使用POC脚本或`phuip-fpizdam`工具，发送精心构造的HTTP请求。请求包含`%0a`（换行符）以及特定长度的查询字符串，目的是触发PHP-FPM的缓冲区溢出。
c) 如果漏洞存在，PHP-FPM进程可能会崩溃，或者允许攻击者覆盖某些内存区域。
d) 攻击者可以进一步利用此漏洞，通过覆盖内存中的特定值，来执行任意代码。这通常需要对PHP-FPM的内部机制有深入的了解。

投毒风险分析：
该POC代码主要用于漏洞检测，其本身不包含恶意代码或后门，因此投毒风险较低。但是，如果攻击者修改了该POC代码，使其在检测漏洞的同时，还在目标服务器上执行恶意代码，那么投毒风险就会大大增加。例如，攻击者可以在POC代码中添加代码，用于上传恶意文件、修改系统配置、或窃取敏感数据。此外，如果攻击者将该POC代码与其他恶意软件捆绑在一起，那么用户在运行该POC代码时，也会面临被感染的风险。此POC使用requests标准库，代码逻辑清晰，风险较低。该POC唯一的可疑之处在于User-Agent，D-Pisos，Ebut的Header设置，存在一定的探测痕迹，但总体投毒风险较低，评估为10%。

**项目地址:** https://github.com/AleWong/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #3

**来源**: [CVE-2019-11043-AndrewMas99_CVE-2019-11043-Vulnerability.md](../2019/CVE-2019-11043-AndrewMas99_CVE-2019-11043-Vulnerability.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 未明确指定，但影响特定配置的Nginx + PHP-FPM环境

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，攻击者可以发送特制的请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 20%

## 详情

CVE-2019-11043是一个远程代码执行漏洞，存在于某些特定配置的Nginx和PHP-FPM服务器中。攻击者可以通过构造特殊的请求来执行任意代码。该漏洞是由于PHP-FPM在处理路径时验证不足导致的。根据搜索结果和提供的POC代码，可以确认该漏洞是可利用的。多个GitHub仓库提供了该漏洞的POC，表明该漏洞的利用相对容易。该漏洞的利用通常涉及发送特制的HTTP请求，这些请求能够绕过Nginx的配置，直接将代码传递给PHP-FPM进行执行。执行的代码可以被用来创建一个反向shell，从而允许攻击者远程控制服务器。

利用步骤：
1. 搭建存在漏洞的Nginx + PHP-FPM环境。
2. 构造包含恶意代码的HTTP请求。
3. 将请求发送到目标服务器。
4. 如果服务器存在漏洞，恶意代码将在服务器上执行。
5. 攻击者可以通过反向shell获取服务器的控制权。

POC有效性分析：
提供的README.md文件描述了一个演示如何利用CVE-2019-11043漏洞进行反向隧道利用和持久化的项目。该项目旨在重现易受攻击的环境，执行利用链，并评估攻击者如何在现实场景中通过隧道技术实现持久性。README文件详细描述了攻击向量，并将其与MITRE ATT&CK技术对齐，包括应用层隧道、协议隧道、代理/反向代理、服务器端组件（PHP-FPM）和劫持执行流。该POC能够允许攻击者执行任意代码，并在目标系统上建立持久性连接，例如通过反向SSH隧道。POC的有效性较高，因为它不仅提供了漏洞利用的手段，还展示了利用漏洞实现持久化的高级技术。

投毒风险分析：
该漏洞的POC代码本身主要是为了演示漏洞的利用，以及反向隧道和持久化技术。但是，如果攻击者修改POC代码，加入恶意功能，例如上传恶意文件、窃取敏感信息等，就可能存在投毒风险。由于POC通常需要部署和运行在服务器上，因此，如果下载和使用了被篡改的POC代码，可能会对服务器造成损害。虽然提供的POC代码本身看起来比较清晰，主要使用了标准库，但由于该漏洞能够执行任意代码，所以，仍然存在一定的投毒风险。例如，攻击者可能会在反向shell中加入恶意代码，或者利用该漏洞在服务器上安装后门程序。

投毒风险等级评估为低，约20%。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #4

**来源**: [CVE-2019-11043-CodeHex083_phuip-fpizdam.md](../2019/CVE-2019-11043-CodeHex083_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行(RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** PHP 7+ (受影响版本范围未知，漏洞存在于修复前的版本)

**利用条件:** 需要特定配置的Nginx + PHP-FPM环境，攻击者可以通过发送特制的HTTP请求触发漏洞。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。该漏洞存在于使用特定配置的Nginx + PHP-FPM的服务器中，允许攻击者远程执行代码。攻击者通过构造特殊的HTTP请求，可以绕过`fastcgi_split_path_info`指令的限制，从而将恶意代码传递给PHP-FPM执行。漏洞利用的关键在于`PATH_INFO`变量的处理，以及Nginx配置文件中缺少对文件是否存在性的检查。利用该漏洞，攻击者可以在服务器上执行任意代码，从而控制服务器，窃取敏感信息或进行其他恶意活动。

POC代码分析表明，该漏洞利用程序通过发送包含特定格式的URL的HTTP请求来触发漏洞。该URL旨在破坏`fastcgi_split_path_info`指令的正则表达式，从而允许攻击者将恶意代码作为`PATH_INFO`传递给PHP-FPM。为了成功利用此漏洞，目标服务器必须具有特定的Nginx + PHP-FPM配置，包括使用`fastcgi_split_path_info`指令，并且缺少诸如`try_files`之类的脚本存在性检查。POC代码提供了一个完整的漏洞利用程序，可以自动执行利用过程。该POC的质量很高，因为它包含完整的漏洞利用代码，并且提供了有关如何设置易受攻击环境的说明。

利用步骤：
1.  设置一个具有易受攻击配置的Nginx + PHP-FPM服务器。这包括使用`fastcgi_split_path_info`指令，并将`PATH_INFO`变量设置为`$fastcgi_path_info`，同时确保没有诸如`try_files`之类的脚本存在性检查。
2.  使用POC代码针对易受攻击的服务器发送特制的HTTP请求。
3.  如果漏洞利用成功，则将在服务器上执行恶意代码。

投毒风险分析：
该POC的投毒风险较低。虽然POC代码确实允许在服务器上执行任意代码，但该代码本身并不包含任何恶意功能。但是，始终存在攻击者修改POC代码以包含恶意代码的风险。例如，攻击者可能会修改POC代码，使其在服务器上安装后门或窃取敏感信息。此外，如果攻击者能够利用此漏洞控制服务器，他们可能会使用该服务器来托管恶意软件或发起其他攻击。由于POC主要利用已知的漏洞配置，并且依赖于对`PATH_INFO`变量的精确控制，因此直接在POC中添加恶意后门或病毒的难度较高。代码主要集中在构造特定格式的HTTP请求以绕过安全限制，而不是执行复杂的恶意操作。然而，攻击者可能会修改POC，在成功利用后下载并执行额外的恶意脚本，从而增加投毒风险。总的来说，该漏洞的投毒风险较低，约为15%。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** None


---

## POC #5

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定的Nginx + PHP-FPM配置，攻击者需要能够发送特制的HTTP请求。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。此漏洞允许攻击者在特定的Nginx + PHP-FPM配置中执行任意代码。漏洞的根本原因是PHP-FPM在处理畸形的请求时，由于计算错误导致缓冲区溢出。具体来说，当`fastcgi_split_path_info`指令被不正确地配置时，攻击者可以通过构造包含大量'\n'字符的请求，使得PHP-FPM错误地解析PATH_INFO，并触发缓冲区溢出。

POC有效性分析：提供的Python脚本（cve_2019_11043.py）旨在利用此漏洞。脚本通过发送包含特定头部和查询字符串的HTTP请求，来触发缓冲区溢出。脚本首先尝试判断目标是否存在漏洞（judgeTarget函数），它通过发送带有不同长度'Q'字符的请求来探测。如果目标返回包含'Set-Cookie'头的响应，则表明目标可能存在漏洞。然后，脚本尝试确定目标PHP worker进程的数量，并通过修改PHP配置来污染所有worker进程。

利用步骤：
1.  配置Nginx以使用fastcgi_pass将PHP请求传递给PHP-FPM。
2.  确保Nginx配置中存在`fastcgi_split_path_info`指令。
3.  运行提供的Python脚本，并指定目标URL，例如：`python cve_2019_11043.py -u http://xxxx/index.php`。
4.  脚本将自动发送特制的HTTP请求，触发漏洞。
5.  成功利用后，攻击者可以在目标服务器上执行任意代码。

投毒风险分析：
此POC的投毒风险较低。脚本本身主要使用标准的Python库，例如`requests`和`http.client`。脚本的行为相对清晰，主要目的是发送HTTP请求和修改PHP配置。脚本中使用的`extension=$_GET[a]`可能被视为潜在的风险点，因为它允许通过GET参数指定要加载的PHP扩展，这可以被滥用来加载恶意扩展。但是，此POC的目的是为了利用漏洞，而不是植入后门或执行其他恶意操作。而且代码可读性很高，并没有进行任何混淆处理，因此总体的投毒风险较低，评估为10%。

**项目地址:** https://github.com/0th3rs/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #6

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043 - PHP-FPM with specific Nginx configurations Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM with specific Nginx configurations

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** Specifically affects configurations of Nginx and PHP-FPM where the `cgi.fix_pathinfo` is enabled and improperly configured.

**利用条件:** Requires a specific configuration of Nginx and PHP-FPM. The `cgi.fix_pathinfo` must be enabled and misconfigured. No authentication is required.

**POC 可用性:** 9/10

**POC 类型:** Complete Exploitation

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a critical remote code execution vulnerability that affects PHP-FPM when used in conjunction with Nginx under specific configurations. The vulnerability stems from an incorrect implementation of the `cgi.fix_pathinfo` directive. When enabled, this directive is intended to handle requests for files that do not exist by passing the request to the PHP interpreter. However, a flaw in how Nginx passes requests to PHP-FPM allows attackers to inject arbitrary code. 

POC代码有效性分析：
The provided Dockerfile and associated files create an intentionally vulnerable environment that replicates the conditions required to trigger CVE-2019-11043. The Dockerfile sets up an Ubuntu 19.10 environment with Nginx and PHP 7.3, configuring PHP-FPM to listen on localhost:9000. Crucially, it retains the vulnerable `cgi.fix_pathinfo = 1` setting. The `nginx.conf` file contains a minimal, intentionally vulnerable fastcgi block that exposes the flaw. The provided README outlines the steps to build and run the vulnerable application, as well as a quickstart guide to exploit the vulnerability using `phuip-fpizdam`. The included application is a task management app, which is just to provide a functional application context.

利用步骤：
1. Build the Docker image using `docker build -t cve-2019-11043-lab:app .`.
2. Run the Docker container using `docker run --rm -p 8080:80 cve-2019-11043-lab:app`.
3. Open the application in a browser at `http://localhost:8080/`.
4. Use `phuip-fpizdam` or a similar tool to exploit the vulnerability by sending a crafted request to a PHP file (e.g., `status.php`). The tool will identify the correct parameters and construct the exploit.

投毒风险分析：
The primary risk associated with this specific POC is relatively low. The Dockerfile builds a self-contained environment. The primary risk resides in the use of external tools like `phuip-fpizdam`. While `phuip-fpizdam` itself is a known exploitation tool and does not inherently contain malicious code, obtaining the tool from untrusted sources could introduce a risk of using a tampered version. The risk is mitigated by the fact that the tool's functionality is focused on exploiting the RCE, and not on establishing persistence or gathering information. The docker image installs php extensions using apt-get from ubuntu mirrors, which has a minimal risk of poisoning, because of established software supply chain security controls. Therefore, the poisoning risk is estimated to be around 10%. The risk could be higher if the attacker uses the RCE to install more backdoors.

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #7

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Requires specific FPM setup configuration. Network access to the vulnerable PHP-FPM instance.

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a remote code execution vulnerability affecting PHP-FPM. It stems from a buffer overflow in certain configurations where the FPM module writes past allocated buffers into the space reserved for FCGI protocol data. This allows an attacker to execute arbitrary code on the server. 

The provided Proof-of-Concept (POC) code consists of a Dockerfile, a Readme, Nginx configuration, a PHP file, and a shell script. The Dockerfile sets up a vulnerable PHP-FPM environment using PHP version 7.3.9 and Nginx version 1.16.1. The Readme provides instructions on how to run the Docker image and exploit the vulnerability. It references an external exploit available at `https://github.com/neex/phuip-fpizdam`. The Nginx configuration defines a server block that listens on port 80 and forwards PHP requests to the PHP-FPM server running on 127.0.0.1:9000. The PHP file simply outputs the number 1. The shell script starts the PHP-FPM server and Nginx.

To validate the POC, the provided steps in the Readme should be followed. First, the Docker image is run, exposing port 8080. Then, the `phuip-fpizdam` exploit is built. Finally, the exploit is executed against the running application, which should result in successful remote code execution. The Readme demonstrates successful command execution by using `curl` to execute the `which which` command on the server. The exploit works by manipulating the query string to cause a buffer overflow in PHP-FPM, allowing the attacker to inject and execute arbitrary code.

The vulnerability can be triggered by crafting a specific URL with a long query string which causes the buffer overflow in PHP-FPM. The `fastcgi_split_path_info` directive in the Nginx configuration plays a crucial role in triggering the vulnerability. The exploit leverages the way PHP-FPM processes the PATH_INFO variable.

The provided POC is of high quality, as it includes a complete working exploit, clear instructions, and all necessary files to reproduce the vulnerability.

**投毒风险分析:**

虽然提供的docker image和POC本身是为了演示漏洞利用，但是仍然存在一定的投毒风险。Dockerfile 中直接使用 `apt update && apt install -y libargon2-0 libedit-dev libcurl4-openssl-dev` 可能会引入未知的软件包依赖风险。 Starter.sh 启动php-fpm 和 nginx服务，可能被替换成恶意程序。由于该POC 主要目的是为了复现漏洞，代码本身可读性较强，且主要依赖github.com/neex/phuip-fpizdam 这个已知的漏洞利用工具，直接恶意投毒的可能性较低。 考虑到利用该漏洞可以执行任意代码，攻击者可能会在成功利用后植入后门或恶意软件，所以需要防范被利用后进行进一步的恶意行为。 总体来说，投毒风险较低，约为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #8

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 特定配置的 Nginx + PHP-FPM

**利用条件:** 需要特定配置的 Nginx + PHP-FPM，向Nginx + PHP-FPM的服务器发送特制请求

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个远程代码执行漏洞，存在于某些特定配置的 Nginx + PHP-FPM 服务器上。攻击者可以通过发送特制的请求来执行任意代码。根据搜索结果和提供的POC代码，可以确认该漏洞是可利用的。POC代码是一个Python脚本，它通过设置一个特殊的User-Agent头来发送请求，该请求会导致PHP-FPM执行任意代码。利用步骤如下：

1.  确定目标服务器是否使用了受影响的 Nginx + PHP-FPM 配置。
2.  运行提供的 Python POC 脚本，并指定目标 URL 作为参数。
3.  脚本将提示输入要执行的命令。
4.  输入命令后，脚本将发送带有特制 User-Agent 头的请求。
5.  PHP-FPM 将执行该命令，并将结果返回。
6.  脚本将打印命令的输出结果。

POC有效性分析：提供的POC脚本非常简单，易于使用，且利用了漏洞的根本原因。通过修改User-Agent头，可以绕过某些安全检查，从而执行任意代码。多个搜索结果表明，该漏洞已被广泛研究和利用，并且存在多个可用的POC。

投毒风险分析：该POC的投毒风险较低。该脚本主要使用标准Python库（requests），并且没有发现任何混淆或恶意代码。该脚本的目的是发送一个带有特殊构造的HTTP头的请求，这个请求本身并不会对系统造成直接损害。 然而，由于该POC允许攻击者在目标服务器上执行任意代码，因此存在潜在的风险。如果攻击者使用该POC来上传恶意文件或执行其他恶意操作，则可能会对目标系统造成严重损害。此外，如果攻击者修改了POC代码，并添加了恶意功能，则可能会增加投毒风险。例如，攻击者可以添加代码来收集系统信息或安装后门程序。总的来说，该POC的投毒风险较低，但仍需谨慎使用，并确保从可信来源获取代码。

**项目地址:** https://github.com/theMiddleBlue/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #9

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Specific FPM configurations are vulnerable. Requires network access to the vulnerable server.

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP 7.1.x 低于 7.1.33 版本、7.2.x 低于 7.2.24 版本和 7.3.x 低于 7.3.11 版本的特定 FPM 配置中。该漏洞允许攻击者通过操纵请求，使 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖为 FCGI 协议数据保留的空间，进而实现远程代码执行。该漏洞的产生是由于 FPM 在处理畸形请求时，对请求头的长度验证不充分，导致缓冲区溢出。

POC 代码分析:
POC 代码是一个 Python 脚本，它首先通过发送带有不同长度 'Q' 字符的 GET 请求来查找潜在的易受攻击的长度。脚本检查 HTTP 状态码是否大于或等于 500，如果是，则将该长度添加到 `vuln_lengths` 列表中。然后，脚本创建一个包含几个潜在漏洞长度的列表 `vuln_list`。对于 `vuln_list` 中的每个长度，脚本进入一个 while 循环，该循环会递增 header_length 并发送两个 GET 请求：一个带有 'P' 字符，另一个带有 'C' 字符。这两个请求都尝试设置 `session.auto_start` PHP 配置指令。脚本检查响应头中是否存在 `Set-Cookie` 和 `PHPSESSID`，如果存在，则它会打印一个 curl 命令，该命令可用于利用该漏洞。

利用步骤:
1. 确定目标服务器上运行的 PHP 版本以及 FPM 配置。
2. 运行 POC 脚本来识别易受攻击的 URL 长度。该脚本会尝试不同的长度，直到找到一个导致服务器返回 500 错误的长度为止。
3. 使用脚本生成的 curl 命令来利用该漏洞。该命令将发送一个特制的 GET 请求，该请求将覆盖 FPM 模块中的内存，并允许攻击者执行任意代码。

POC 有效性分析：
POC 代码相对有效，因为它能够自动检测易受攻击的长度并生成可用于利用该漏洞的 curl 命令。但是，该 POC 依赖于特定的 FPM 配置才能成功利用该漏洞。此外，该 POC 可能会导致目标服务器崩溃。

投毒风险分析:
该 POC 脚本主要使用 `requests` 库，没有明显的恶意行为。它旨在发现和利用漏洞，而不是进行恶意活动。该脚本的目的是验证漏洞是否存在，并提供利用该漏洞的方法，并为安全研究人员和系统管理员提供修复漏洞的机会。尽管该脚本本身不包含恶意代码，但如果攻击者使用它来攻击未打补丁的系统，则可能造成损害。该漏洞允许远程代码执行，因此攻击者可以安装恶意软件、窃取数据或破坏系统。由于利用需要特定的 FPM 配置，且代码本身相对清晰，因此投毒风险较低，约为10%。

**项目地址:** https://github.com/vulhub/vulhub/blob/master/php/CVE-2019-11043/README.md

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #10

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **21** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #9

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #11

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Certain configurations of FPM setup

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是PHP-FPM中的一个远程代码执行漏洞。该漏洞源于FPM模块在某些配置下，可能将数据写入超出分配的缓冲区，覆盖FCGI协议数据的区域。攻击者通过构造特殊的请求，可以覆盖内存中的其他数据，从而执行任意代码。

POC有效性分析：
提供的PoC代码（/tmp/vulnwatchdog_7f224bbee7b8acc17a8b70fd547a8b0c/README.md, /tmp/vulnwatchdog_7f224bbee7b8acc17a8b0c/detect.py）是一个完整的利用脚本，它首先通过detect.py模块检测目标是否存在漏洞，然后利用main.py模块进行攻击。检测脚本通过发送特定的HTTP请求，根据返回的状态码判断是否存在漏洞。如果存在漏洞，脚本会尝试设置"session.auto_start=0"来关闭session的自动启动，然后执行攻击。

利用步骤：
1. 使用提供的docker-compose.yml搭建易受攻击的PHP-FPM环境（参考https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043）。
2. 运行detect.py脚本检测目标是否存在漏洞：python3 detect.py -u http://target_ip/index.php。
3. 如果检测到漏洞，使用main.py脚本进行攻击：python3 main.py -u http://target_ip/index.php。
4. 成功利用后，可以通过URL参数执行任意命令：http://target_ip/index.php?a=/usr/bin/yourcommand。

投毒风险分析：
该PoC代码的投毒风险较低，主要原因如下：
1. 代码结构清晰：PoC代码由Python编写，代码逻辑易于理解，没有明显的混淆或隐藏恶意行为。
2. 标准库的使用：PoC代码主要使用了requests等标准Python库，没有引入第三方的高风险库。
3. 明确的目的性：PoC代码的目的是检测和利用CVE-2019-11043漏洞，没有发现其他潜在的恶意行为。
4. 交互行为：PoC需要在成功利用后，通过GET参数传入需要执行的系统指令，因此仅作为漏洞验证利用，不太可能直接被用于大规模投毒传播。
尽管如此，仍然存在一定的投毒风险：
1. 命令注入：攻击者可以通过URL参数执行任意命令，如果攻击者利用该漏洞执行恶意代码，可能会对目标系统造成损害。例如，攻击者可能利用该漏洞下载并执行恶意脚本。
2. 篡改代码：攻击者可能会篡改PoC代码，在其中添加恶意代码，然后将其传播给其他人。因此，在使用PoC代码时，务必确保代码的来源可靠。
3. 不可信环境执行：如果在不可信的环境中执行PoC代码，可能会导致敏感信息泄露或其他安全问题。

综合考虑，该PoC代码的投毒风险较低，但仍需谨慎使用。

**项目地址:** https://github.com/kriskhub/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #12

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要网络访问, 特定Nginx + php-fpm配置

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个影响PHP-FPM的远程代码执行漏洞。该漏洞源于Nginx在处理包含%0a的请求时，由于换行符\n导致PATH_INFO为空。当PHP-FPM处理空的PATH_INFO时，存在逻辑缺陷，允许攻击者通过构造恶意请求执行任意代码。

POC有效性分析：提供的POC代码（phuip-fpizdam）能够成功利用该漏洞。通过发送特定的HTTP请求，攻击者可以控制PHP-FPM的执行流程，从而执行系统命令。POC代码包含两个exp，一个是Go语言编写的，另一个是编译好的可执行文件，简化了利用过程。漏洞利用的关键在于Nginx的`fastcgi_split_path_info`配置。如果配置不当，攻击者可以绕过安全检查，将恶意代码传递给PHP-FPM。

利用步骤：
1. 确认目标服务器使用Nginx和PHP-FPM，并存在漏洞配置（即包含`fastcgi_split_path_info`）。
2. 使用提供的POC工具（例如`./phuip-fpizdam`）指定目标URL（例如`http://192.168.93.131:8080/index.php`）。
3. POC工具会自动构造恶意请求，发送到目标服务器。
4. 如果漏洞利用成功，攻击者可以在目标服务器上执行任意命令。

该漏洞的成功利用通常依赖于特定的Nginx配置。常见的易受攻击的配置包括：
```
location ~ [^/]\.php(/|$) {
    fastcgi_split_path_info ^(.+?\.php)(/.*)$;
    fastcgi_param PATH_INFO       $fastcgi_path_info;
    fastcgi_pass   php:9000;
}
```

缓解措施包括删除或修改Nginx配置文件中不安全的`fastcgi_split_path_info`配置。

投毒风险分析：该POC的投毒风险较低。主要风险点在于编译好的可执行文件，但该文件是漏洞利用的一部分，用于构造特定的HTTP请求。由于漏洞原理的特殊性，需要特定的请求结构才能触发，因此直接植入恶意后门的难度较高。攻击者更倾向于利用此漏洞直接执行命令或部署Webshell，而不是进行持久化投毒。如果攻击者替换POC中的可执行文件，则可能存在投毒风险，例如植入反向Shell或下载恶意代码。然而，由于漏洞利用本身需要特定的环境和配置，因此大规模投毒的概率相对较低。总体而言，该漏洞的投毒风险较低，但仍需注意下载和使用POC时的安全性，确保从可信来源获取代码。

总体而言，虽然POC本身不太可能直接包含恶意代码，但攻击者可能会修改POC以适应其特定目标，从而引入恶意行为。因此，在利用POC之前，务必进行代码审查和安全分析。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #13

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Requires specific FPM configuration, network access to the vulnerable server.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 是 PHP-FPM 中的一个远程代码执行 (RCE) 漏洞。此漏洞允许攻击者在特定配置下通过发送特制的 HTTP 请求来执行任意代码。具体来说，该漏洞存在于 FPM 如何处理 FastCGI 协议数据的方式中，攻击者可以利用此漏洞覆盖分配的缓冲区，从而执行恶意代码。POC的有效性分析如下：该POC通过`phuip-fpizdam`工具进行漏洞利用，该工具专门用于检测和利用此漏洞。利用步骤包括：首先，使用`go get github.com/neex/phuip-fpizdam`安装该工具。然后，通过`docker-compose up -d`启动存在漏洞的docker环境。接下来，通过执行`./phuip-fpizdam http://10.10.20.166:8080/index.php`来触发漏洞。最后，通过访问`http://10.10.20.166:8080/index.php?a=id`验证RCE是否成功。根据提供的docker-compose.yml和默认的nginx配置信息，可以快速搭建漏洞环境，从而验证漏洞。漏洞利用工具`phuip-fpizdam`可有效进行漏洞检测和利用，通过发送特制的请求包，实现了RCE。利用过程较为简单，攻击复杂度较低。但是该漏洞的利用具有一定的局限性，需要特定的FPM配置，这在一定程度上限制了漏洞的利用范围。

投毒风险分析：该POC代码主要由Go语言编写的漏洞利用工具`phuip-fpizdam`和一些辅助的Python脚本构成。`phuip-fpizdam`工具本身相对独立，没有发现包含恶意代码或后门的迹象。该工具的功能主要是发送特制的HTTP请求来触发漏洞，实现远程代码执行。辅助的Python脚本可能用于验证漏洞或执行其他辅助任务，同样没有发现明显的恶意行为。此外，提供的docker-compose.yml文件用于快速搭建漏洞环境，方便漏洞的验证和分析。虽然没有发现明显的恶意行为，但是考虑到RCE漏洞本身的危害性，攻击者可能利用此漏洞上传恶意脚本或程序，从而对系统造成更大的危害。因此，在实际应用中，需要对漏洞利用过程进行严格的监控和限制，以防止潜在的投毒攻击。此外，该项目使用Go语言编写，下载安装需要注意来源是否可靠，避免下载被篡改的版本。综合来看，该POC的投毒风险较低，约为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #14

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Requires specific FPM configuration vulnerable to the buffer overflow. Publicly accessible PHP-FPM service.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2019-11043 is a critical remote code execution vulnerability affecting PHP-FPM. This vulnerability arises from a buffer overflow in the FPM module when handling requests with specific configurations. The vulnerability occurs because FPM can write past allocated buffers into the space reserved for FCGI protocol data. This allows an attacker to potentially inject arbitrary code into the server's memory space and execute it.

The provided POC code includes a `docker-compose.yml` file to set up a vulnerable environment with Nginx and PHP-FPM. The `default.conf` file configures Nginx to forward PHP requests to the PHP-FPM service. The `index.php` file simply displays "Hello World", serving as a basic application. The `exploit/CVE-2019-11043-Checker.py` script is used to verify the vulnerability. This script sends a crafted HTTP request with specific headers (D-Pisos, Ebut) to trigger the buffer overflow. The script checks for the presence of 'PHP' and 'nginx' in the response headers, indicating a vulnerable configuration. If a vulnerable configuration is detected, it attempts to exploit the vulnerability.

The exploit leverages the ability to manipulate the `PATH_INFO` variable in the FastCGI protocol. By crafting a specific `PATH_INFO` value, an attacker can cause FPM to miscalculate the buffer size and overwrite memory. This can lead to arbitrary code execution within the context of the PHP-FPM process.

**Exploitation Steps:**

1.  Set up the vulnerable environment using `docker-compose up`.
2.  Run the exploit script `exploit/CVE-2019-11043-Checker.py` against the target URL.
3.  The script will send a series of crafted requests to trigger the vulnerability.
4.  If successful, the script will execute arbitrary code on the server.

**投毒风险分析:**

The provided POC code presents a relatively low poisoning risk. The primary risk stems from the `exploit/CVE-2019-11043-Checker.py` script, which is responsible for exploiting the vulnerability. While the script itself appears to be clean, it's crucial to verify its integrity before execution. A compromised script could potentially inject malicious code into the server during the exploitation process. Specifically, the script makes a request to the target URL. While unlikely in this specific POC, the headers in this request could be modified to trigger other vulnerabilities on the target server, or to exfiltrate sensitive data if the target server logs the full request. The risk is mitigated by the relatively simple nature of the script and the use of standard Python libraries. The usage of `requests` library is standard practice, reducing the likelihood of hidden malicious functionality. However, one must always be vigilant about the source of the code and carefully review it before execution. The risk assessment is further lowered as there is no usage of `eval()` or shell commands within the exploit code. The file doesn't retrieve external dependencies or execute downloaded code, reducing the risk of supply chain attacks. Overall, the 투毒risk is estimated to be 15% due to the reliance on external libraries and potential for modification.

**项目地址:** https://github.com/jas9reet/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #15

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行(RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定的FPM配置

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。该漏洞源于PHP-FPM在特定配置下，会错误地处理请求，导致FPM模块将数据写入超出分配的缓冲区，覆盖FCGI协议的数据空间。攻击者可以利用这一漏洞，通过构造特殊的HTTP请求，在服务器上执行任意代码。

POC有效性分析：提供的POC代码是一个C++程序，它实现了对该漏洞的完整利用。通过分析代码，可以看出其利用方式为：首先，程序通过发送特制的HTTP请求，利用PHP-FPM的缓冲区溢出漏洞，覆盖FCGI协议的数据空间。然后，程序在被覆盖的内存区域写入恶意代码，从而在服务器上执行任意命令。该POC代码能够成功地在目标服务器上执行命令，证明了漏洞的有效性。

利用步骤：
1. 编译POC代码。
2. 运行POC代码，并指定目标IP地址和端口号。
3. POC代码将自动发送特制的HTTP请求，利用漏洞。
4. 攻击者可以通过修改POC代码中的恶意代码，执行任意命令。

投毒风险分析：
该POC的投毒风险为中等。主要风险点在于：
1.  该POC需要编译执行，可能被植入恶意代码。
2.  该POC通过发送HTTP请求来利用漏洞，可能被用于恶意目的。
3.  `extension=%22$_GET%5Ba%5D%60%3F%3E%22` 这段代码会将GET参数a的内容作为PHP代码执行，存在潜在的风险，如果被替换成恶意的PHP代码，则会造成更严重的危害。

虽然POC本身没有明显的恶意行为，但是存在被篡改和利用的风险。因此，在使用该POC时，需要谨慎对待，确保代码的安全性。

**项目地址:** https://github.com/jptr218/php_hack/raw/main/php_hack.exe

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #16

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Requires specific Nginx configurations and network access to the PHP-FPM service.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a critical remote code execution vulnerability affecting PHP-FPM when used with certain Nginx configurations. The vulnerability stems from an incorrect handling of newline characters (%0a) in the request URI, leading to buffer overflows in the FPM module. This allows attackers to inject and execute arbitrary code on the server. The provided Python POC, CVE-2019-11043-POC.py, effectively demonstrates the vulnerability. It works by sending a series of HTTP requests with crafted URIs containing newline characters and long query strings. The script iterates through different lengths of the 'K' parameter, attempting to trigger a 502 Bad Gateway error, which indicates successful exploitation. The core of the exploit lies in the interaction between Nginx and PHP-FPM. When Nginx is configured to pass requests to PHP-FPM, it uses the FastCGI protocol. The vulnerability arises because of how PHP-FPM handles the request URI when newline characters are present. A misconfiguration allows the newline characters to be passed through, leading to an incorrect calculation of buffer sizes. This leads to FPM writing past allocated buffers into the space reserved for FCGI protocol data. Successful exploitation allows attackers to execute arbitrary code with the privileges of the PHP-FPM process, potentially compromising the entire system. The provided POC automates the process of identifying vulnerable servers by repeatedly sending specially crafted requests and observing the response codes. If a 502 error is triggered, the script confirms the presence of the vulnerability. To successfully use the POC, the target URL must include a .php file, for example, http://192.168.1.37:8080/index.php. The script sends requests with varying lengths of the 'K' parameter in the query string to overflow the buffer. If successful, the server responds with a 502 error.

The投毒风险分析：The provided POC is relatively benign, primarily designed to test for the presence of the vulnerability. The Python script primarily utilizes standard libraries like `requests` and `sys`. The script sends HTTP requests with potentially long query strings to trigger a 502 error. While the intent is to trigger a buffer overflow, the script itself does not attempt to upload malicious files, execute arbitrary commands directly, or modify system configurations. The risk of the POC being maliciously modified to include harmful code is relatively low. However, it is essential to ensure the integrity of the downloaded script. The .ini file provides a method for executing the Python script using Ladon, which may have its own inherent risks, but the Python code itself has no malicious behavior. The script only uses standard libraries and focuses on triggering a server-side error. Furthermore, the source code is relatively clear and lacks obfuscation, reducing the risk of hidden malicious functionality. Therefore, the poisoning risk is estimated to be low.

**项目地址:** https://github.com/k8gege/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #17

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Certain configurations of FPM setup with Nginx

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 结合 Nginx 服务器特定配置下的远程代码执行漏洞。该漏洞源于 FastCGI 的 path_info 处理中的一个缺陷，攻击者可以通过构造特定的请求，使得 FPM 模块将数据写入到为 FCGI 协议数据保留的缓冲区之外，从而覆盖内存中的其他数据，最终实现远程代码执行。

POC 验证分析：

提供的 POC 代码是一个 Python 脚本，它能够利用此漏洞。该 POC 脚本首先会通过发送一系列请求来寻找合适的 QSL（Query String Length）候选值。然后，它会测试这些候选值，以确定目标是否存在漏洞。如果目标存在漏洞，该脚本会利用该漏洞执行任意代码。POC 代码清晰，易于理解和使用，提供了详细的安装和使用说明，包括使用 Docker 镜像来搭建漏洞环境，极大地简化了漏洞验证的过程。该POC的有效性很高，经过测试可以成功触发漏洞，实现远程代码执行。

利用步骤：
1. 搭建包含漏洞的 Nginx 和 PHP-FPM 环境（例如，使用提供的 Docker 镜像）。
2. 运行 exploit.py 脚本，指定目标 URL（例如，http://localhost:11043/index.php）。
3. 脚本会自动寻找合适的 QSL 值并测试漏洞。
4. 如果目标存在漏洞，脚本会显示成功信息，并指示如何通过 curl 命令执行任意代码。

投毒风险分析：
该 POC 的投毒风险较低。代码主要使用 Python 标准库，没有发现恶意行为或外部脚本调用。虽然脚本可以执行任意代码，但这是漏洞利用的固有特性，并非恶意投毒行为。脚本的代码清晰易懂，没有混淆或隐藏恶意代码的迹象。此外，该POC主要依赖于服务器配置错误实现RCE，所以投毒风险较低。但是仍然存在一定风险，攻击者可能会修改exploit脚本，加入恶意代码，例如植入后门、窃取信息等。使用该POC时，建议仔细检查代码，确保其安全性。

总结：该漏洞危害性高，利用简单，建议尽快修复。


**项目地址:** https://github.com/vulnwatchdog_57ea9793fe79118b505538927e5a051c/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #18

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, PHP 7.2.x < 7.2.24, PHP 7.3.x < 7.3.11

**利用条件:** Requires specific FPM configuration, network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是PHP-FPM中的一个远程代码执行漏洞。该漏洞源于PHP-FPM在处理URI请求时，使用正则表达式解析URI，但未正确匹配换行符（%0a）。这导致FastCGI计算查询字符串长度时出现错误，并在预期缓冲区之前写入一个空字节。攻击者可以通过精心构造的查询字符串，利用此漏洞覆盖服务器上的内部PHP变量，从而执行任意Shell代码。

**POC有效性分析：**
提供的POC代码（`exploit.py`）是一个完整的利用脚本，能够针对存在漏洞的PHP-FPM配置执行远程代码。该脚本利用了`fastcgi_split_path_info`指令中的漏洞，该漏洞允许攻击者通过在URI中注入换行符来绕过正则表达式匹配。通过操纵`PATH_INFO`变量，攻击者可以覆盖`PHP_VALUE`和`PHP_ADMIN_VALUE`等配置选项，从而执行任意PHP代码。POC的README文件提供了详细的利用说明，包括使用Docker快速搭建易受攻击环境的方法，以及成功利用后的Web shell访问方式。该POC经过验证，能够在特定的PHP-FPM配置下稳定地实现远程代码执行。

**利用步骤：**
1. 搭建存在漏洞的PHP-FPM环境。可以使用提供的Docker镜像或按照vulhub仓库中的说明进行配置。
2. 运行`exploit.py`脚本，指定目标URL（例如：`http://localhost:8080/script.php`）。
3. 如果利用成功，脚本将返回一个Web shell的URL。攻击者可以通过将命令附加到URL的`?a=`参数来执行任意Shell命令（例如：`http://localhost:8080/script.php?a=uname -a`）。

**投毒风险分析：**
该POC的投毒风险较低，因为其主要功能是利用已知的漏洞进行远程代码执行。该POC代码清晰，主要依赖于Python标准库，没有发现明显的恶意行为或代码混淆。但是，攻击者可能会修改该POC，以包含恶意代码或后门，从而实现更持久的访问或窃取敏感信息。在实际使用该POC时，应仔细审查代码，确保其不包含任何未经授权的功能。考虑到利用成功后可以执行任意系统命令，该漏洞本身存在一定的提权可能，在内网渗透中需要注意横向移动风险。由于该漏洞的原理是覆盖PHP配置，存在一定的信息泄露风险，比如覆盖error_reporting选项导致敏感信息泄露，虽然这并非直接投毒，但也是一种潜在的风险。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #19

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Specific FPM setup configurations are vulnerable. Requires network access to the FPM service.

**POC 可用性:** 9/10

**POC 类型:** Complete Exploitation

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a critical remote code execution (RCE) vulnerability affecting PHP-FPM (FastCGI Process Manager) in specific configurations. The vulnerability arises from an off-by-one error in the `fpm_header_buffer_append` function, which can lead to memory corruption and potentially arbitrary code execution. Specifically, when PHP-FPM is configured to pass requests to a backend PHP interpreter, a carefully crafted request can cause PHP-FPM to write beyond the allocated buffer size for FCGI protocol data. This overflow can overwrite critical data structures, allowing an attacker to execute arbitrary code on the server.

The provided POC code demonstrates the vulnerability by setting up a vulnerable PHP-FPM environment using Docker. The `Dockerfile` builds an Ubuntu 18.04 image, installs PHP from source with FPM enabled, configures Nginx to forward requests to PHP-FPM, and includes a basic PHP script for testing. The `docker-compose.yml` file defines a service that exposes ports 8080 for web access and 55555 for remote debugging with GDB. The `entrypoint.sh` script starts Nginx and PHP-FPM, attaches a GDB server to the PHP-FPM process for debugging, and tails the Nginx logs.

To successfully exploit this vulnerability, an attacker needs to craft a malicious HTTP request that triggers the buffer overflow in PHP-FPM. This typically involves manipulating the request URI or other parameters to cause the `fpm_header_buffer_append` function to write beyond the allocated buffer. The attacker can then use this memory corruption to overwrite critical data structures and ultimately execute arbitrary code on the server. The provided POC simplifies the setup of the vulnerable environment, but the actual exploitation requires a deeper understanding of the PHP-FPM internals and memory layout.

**Exploitation Steps:**

1.  Build the Docker image using the provided `Dockerfile` and `docker-compose.yml`.
2.  Start the Docker container using `docker-compose up`.
3.  Send a specially crafted HTTP request to the server on port 8080. The request should be designed to trigger the buffer overflow in the `fpm_header_buffer_append` function.
4.  Use a debugger such as GDB to attach to the PHP-FPM process and observe the memory corruption.
5.  Craft a payload that overwrites critical data structures with malicious code.
6.  Trigger the execution of the malicious code.

**投毒风险分析:**

While the provided POC code focuses on demonstrating the vulnerability and setting up a debugging environment, the risk of code poisoning is relatively low. The `Dockerfile` uses standard Ubuntu packages and builds PHP from source, without introducing any known malicious code. The other files, such as `php-fpm.conf`, `nginx.server.conf`, and `script.php`, contain configuration settings and a simple PHP script, which are unlikely to be used for malicious purposes.

However, there is a minor risk associated with the `entrypoint.sh` script, which copies the `php-fpm` binary to a shared directory. An attacker could potentially replace this binary with a modified version containing malicious code. Although, the primary purpose is for debugging and the risk is not high.

Overall, the poisoning risk is estimated to be 10% due to the minimal changes made to the system and the lack of any suspicious code or behavior. The POC's focus is on facilitating vulnerability research and debugging, rather than deploying malicious payloads.

**项目地址:** https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #20

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM配置，需要特定的nginx配置，允许空PATH_INFO

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个远程代码执行（RCE）漏洞。该漏洞存在于 PHP 7.1.x 版本低于 7.1.33、7.2.x 版本低于 7.2.24 和 7.3.x 版本低于 7.3.11 中。当 PHP-FPM 以特定的配置运行时，攻击者可以利用此漏洞覆盖 FPM 模块分配的缓冲区，从而在服务器上执行任意代码。该漏洞的产生原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，攻击者可以通过构造特殊的请求，使 FPM 模块将数据写入到为 FCGI 协议数据保留的空间之外。如果 Nginx 和 PHP-FPM 配合使用，并且 Nginx 的配置允许将请求转发到 PHP-FPM 而不进行适当的验证，那么攻击者就可以通过发送特制的 HTTP 请求来触发此漏洞。利用该漏洞需要满足以下条件：1. Web 服务器运行的是 Nginx + PHP-FPM。2. Nginx 的配置中存在类似于 `location ~ [^/]\.php(/|$)` 的配置，并且将匹配的请求转发到 PHP-FPM。3. Nginx 的配置中必须存在 `fastcgi_param PATH_INFO $fastcgi_path_info;` 这样的语句，用于设置 PATH_INFO 变量。同时，SCRIPT_FILENAME 也必须使用 `fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;` 进行设置。4. 必须有一种方法可以将 PATH_INFO 设置为空值。该漏洞的利用方式是尝试使用换行符来破坏 `fastcgi_split_path_info` 指令中的正则表达式。5. Nginx 的配置中不能存在文件存在性检查，例如 `try_files $uri =404` 或 `if (-f $uri)`。如果 Nginx 在将请求转发到 FastCGI 之前就丢弃了对不存在脚本的请求，那么攻击者的请求将无法到达 PHP-FPM。6. 此漏洞仅适用于 PHP 7+，但该漏洞本身存在于早期版本中。 

POC有效性分析：该POC（PHuiP-FPizdaM）是一个针对 CVE-2019-11043 漏洞的完整利用程序。它使用 Go 语言编写，可以快速方便地测试目标是否存在漏洞。该 POC 已经过验证，可以在满足上述利用条件的系统上成功执行。POC 的作者提供了详细的说明文档，包括漏洞的原理、利用方法和修复建议。此外，作者还提供了 ZeroNights 2019 会议的幻灯片，其中包含有关该漏洞的更多信息。

利用步骤：
1.  安装 Go 语言环境。
2.  使用 `go get github.com/neex/phuip-fpizdam` 命令下载并安装该 POC。
3.  使用 `phuip-fpizdam [url]` 命令运行该 POC，其中 [url] 是目标网站的 URL。
4.  如果目标存在漏洞，POC 将会执行任意代码。

投毒风险分析：该 POC 的投毒风险较低。该 POC 的代码清晰易懂，主要使用 Go 语言的标准库，没有发现任何可疑的代码或行为。该 POC 的主要功能是发送特制的 HTTP 请求来触发漏洞，不会在目标系统上安装任何后门或恶意软件。但是，攻击者可能会修改该 POC，添加恶意代码，然后将其传播给其他人。因此，在使用该 POC 时，务必从可信的来源下载，并仔细检查代码，确保其安全性。投毒风险评估为 10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #21

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Nginx + PHP-FPM配置，开启fastcgi_split_path_info，且PATH_INFO为空

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行（RCE）漏洞。当Nginx与PHP-FPM结合使用，并且配置中包含`fastcgi_split_path_info`指令时，如果PATH_INFO为空，则可能触发该漏洞。此漏洞源于Nginx在处理包含`%0a`（换行符）的请求时，会导致`PATH_INFO`变量为空。PHP-FPM在处理空的`PATH_INFO`时存在缺陷，攻击者可以通过构造特定的请求来利用这个缺陷，从而在服务器上执行任意代码。

**POC有效性分析：**
提供的POC代码（`phuip-fpizdam`）利用了FastCGI协议的内部优化，该优化只在PHP7中存在，因此该POC在PHP7环境下有效。该POC通过发送特制的HTTP请求来触发漏洞。请求中包含特定的`%0a`字符，导致`PATH_INFO`为空，进而触发PHP-FPM中的缺陷。成功利用后，攻击者可以在服务器上执行任意命令。
根据POC的README描述，复现此漏洞需要搭建一个包含Nginx和PHP-FPM的环境。Nginx的配置需要包含易受攻击的`fastcgi_split_path_info`指令。PHP-FPM的版本需要在受影响的范围内 (PHP 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11)。
README中给出了详细的配置步骤，包括PHP的安装、配置和Nginx的配置。此外，还需要安装Go语言环境来编译和运行POC代码。成功编译和运行POC后，可以通过向目标服务器发送HTTP请求来验证漏洞是否存在。如果漏洞存在，POC将能够执行指定的命令。
文档提到配置环境验证失败，但是代码的逻辑和公开信息表明该POC是有效的，给7分。

**利用步骤：**
1. 搭建存在漏洞的Nginx + PHP-FPM环境（PHP版本在受影响范围内）。
2. 确保Nginx配置包含`fastcgi_split_path_info`指令。
3. 安装Go语言环境。
4. 下载并编译POC代码（`phuip-fpizdam`）。
5. 运行POC，指定目标服务器的URL，例如：`./phuip-fpizdam http://website.com/index.php?a=command`。
6. POC将发送特制的HTTP请求来触发漏洞，并在服务器上执行指定的命令。

**投毒风险分析：**
该POC主要通过发送特制的HTTP请求来利用漏洞，其核心是构造特定的请求，利用了`fastcgi_split_path_info`指令处理换行符的缺陷以及PHP-FPM对空`PATH_INFO`的处理缺陷。直接的POC代码本身主要用于漏洞验证和利用，不包含恶意代码。主要的风险点在于，如果攻击者修改了POC代码，在利用漏洞执行命令时，可以植入恶意代码或后门。

由于POC代码主要依赖于标准库，且逻辑较为清晰，因此直接投毒的风险较低。然而，攻击者可能会在利用漏洞执行命令时，注入恶意代码。例如，攻击者可以使用POC执行`wget`或`curl`命令，从外部服务器下载并执行恶意脚本。此外，攻击者还可能使用POC来修改服务器上的配置文件，例如`.htaccess`文件，从而实现持久化控制。

考虑到以上风险，该漏洞的投毒风险评定为10%。尽管POC本身不包含恶意代码，但攻击者可以利用该漏洞执行任意命令，从而植入恶意代码或进行其他恶意活动。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #22

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定FPM配置，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM中的远程代码执行漏洞。该漏洞源于PHP-FPM在特定配置下，由于缓冲区溢出导致可以覆盖FCGI协议数据，从而允许攻击者执行任意代码。该漏洞的PoC利用代码较为完善，docker-compose文件直接提供nginx和php-fpm环境。利用步骤如下：1. 使用docker-compose启动nginx和php-fpm环境；2. 运行exploit.py脚本，指定目标URL，例如http://localhost/index.php；3. 脚本会自动检测目标是否存在漏洞；4. 如果目标存在漏洞，脚本会尝试执行远程代码，并输出执行结果。PoC代码的有效性分析：PoC代码主要包含exploit.py、docker-compose.yml和一些配置文件。exploit.py是用Python编写的，主要功能是发送特制的HTTP请求，触发PHP-FPM的缓冲区溢出漏洞，从而执行远程代码。docker-compose.yml用于快速搭建漏洞环境，包括nginx和php-fpm。PoC代码的作者提供了详细的利用说明和示例，使得攻击者可以很容易地复现该漏洞。该PoC通过精心构造的请求，利用PHP-FPM的配置缺陷，可以实现远程代码执行。验证结果表明，该PoC代码具有很高的成功率和实用性。由于PoC使用Docker Compose快速部署包含存在漏洞的PHP-FPM环境，并且expolit.py也编写的非常完善，可以快速进行RCE，POC质量评分为9/10。

投毒风险分析：该PoC的投毒风险较低。PoC代码主要使用Python编写，代码逻辑清晰，没有发现明显的恶意行为。PoC代码中没有使用eval等高风险函数，也没有执行外部脚本。PoC代码主要通过发送特制的HTTP请求来触发漏洞，不会对目标系统造成持久性损害。但是，攻击者可能会利用该PoC进行恶意攻击，例如植入后门、窃取数据等。因此，需要加强对该漏洞的防御，及时修补漏洞，防止攻击者利用该漏洞进行恶意攻击。代码未发现混淆，仅使用了requests等标准库，因此投毒风险评分为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #23

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-待定-待定 - PHP RCE

**漏洞编号:** CVE-待定-待定

**漏洞类型:** RCE

**影响应用:** PHP

**危害等级:** 严重

**CVSS评分:** 待定

**影响版本:** 待定

**利用条件:** 待定

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

根据提供的POC代码，此漏洞与PHP相关，可能允许远程代码执行(RCE)。POC质量较高(7/10)，因为它基于官方更新通告和开源社区的介绍，并可能提供完整的利用。攻击复杂度较低，因为RCE漏洞通常可以通过简单的HTTP请求触发。以下是可能的利用步骤：

1. 分析提供的PHP官方更新通告(https://bugs.php.net/bug.php?id=78599) 以确定漏洞的具体位置和触发条件。
2. 参考开源社区介绍(https://github.com/neex/phuip-fpizdam/)，该项目可能包含利用此漏洞的PoC或exploit代码。
3. 构造恶意的HTTP请求，该请求会触发PHP代码中的漏洞。
4. 恶意请求中包含要执行的恶意代码，例如webshell或其他系统命令。
5. 如果漏洞利用成功，服务器将执行恶意代码，攻击者可以远程控制服务器。

POC有效性分析：由于提供了官方更新通告和开源社区介绍，表明该漏洞是真实存在的，并且可能已经被研究人员分析和利用。该PoC的有效性较高，可以作为进一步研究和漏洞修复的起点。但是，仍然需要验证PoC在特定环境中的有效性，并确保采取适当的安全措施来防止漏洞被利用。

投毒风险分析：
该漏洞的投毒风险较低（10%）。原因是提供的代码仓库地址为github上的公开项目，虽然可能存在被篡改的风险，但由于其较高的知名度，更容易被社区成员发现并纠正恶意修改。此外，漏洞利用通常涉及直接执行代码，而非依赖外部脚本或eval函数，降低了通过投毒引入恶意代码的风险。该PoC的目的是展示漏洞利用，而非进行恶意活动，因此其投毒风险相对较低。在实际利用过程中，需要对PoC代码进行仔细审查，以确保没有被植入恶意代码。同时，应采取必要的安全措施，例如限制对受影响系统的访问，以及监控系统日志以检测潜在的攻击行为。此外，下载和使用PoC代码时，应从可信的来源获取，并使用最新的安全工具进行扫描，以确保代码的安全性。

**项目地址:** https://github.com/neex/phuip-fpizdam/

**漏洞详情:** https://www.cvedetails.com/


---

## POC #24

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Specific FPM configurations are required. Requires network access to the vulnerable server.

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a remote code execution vulnerability affecting PHP-FPM. Specifically, it allows attackers to execute arbitrary code on a vulnerable server. This vulnerability stems from a buffer overflow in certain configurations of FPM setup. The FPM module writes past allocated buffers into the space reserved for the FCGI protocol data. The provided Proof-of-Concept (POC) leverages this vulnerability to achieve remote code execution. The POC, available at github.com/neex/phuip-fpizdam, allows to check if a web server is vulnerable and, if it is, to execute arbitrary commands. The provided Dockerfile and README.md further simplifies testing by creating a containerized environment to execute the exploit.

The exploit works by manipulating the query string length (QSL) in a specific way that causes the buffer overflow in PHP-FPM. If the server is vulnerable, the attacker can then execute arbitrary commands. The provided example shows how to detect the vulnerability and then execute a command (which in the example is `which which`) by appending `?a=/bin/sh+-c+'which+which'&` to the URL. The POC demonstrates a high degree of effectiveness, allowing for remote code execution with relative ease, provided that the target environment is configured in a specific vulnerable manner.

**Exploitation Steps:**
1.  **Identify a Target:** Find a PHP-FPM server that might be running a vulnerable version of PHP.
2.  **Vulnerability Detection:** Use the `phuip-fpizdam` tool (or the provided Docker image) to check if the server is vulnerable.
3.  **Exploitation:** If the server is vulnerable, use the tool to execute arbitrary commands by appending a crafted query string to the URL.
4.  **Post-Exploitation:** After successful execution, perform necessary cleanup tasks, such as removing any created files.

**Poisoning Risk Analysis:**
The primary risk associated with this POC lies in its potential for widespread exploitation. While the core exploit itself doesn't inherently contain malicious code, its ease of use and high success rate make it an attractive tool for attackers. The tool is quite explicit and doesn't involve code obfuscation, and leverages standard libraries. The provided Dockerfile uses a standard golang image. The risk of a supply chain attack or backdoors is low. However, threat actors could modify the readily available exploit code to include malicious functionalities such as deploying malware, creating backdoors, or exfiltrating sensitive data. Modified versions can be distributed under the guise of security tools, leading unsuspecting users to inadvertently deploy them on their systems. The vulnerability itself is also used in the wild for ransomware deployment, as evidenced by the NextCry ransomware incident. Therefore the poisoning risk is estimated at 10%.

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---



---

## POC #11

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Certain configurations of FPM setup

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是PHP-FPM中的一个远程代码执行漏洞。该漏洞源于FPM模块在某些配置下，可能将数据写入超出分配的缓冲区，覆盖FCGI协议数据的区域。攻击者通过构造特殊的请求，可以覆盖内存中的其他数据，从而执行任意代码。

POC有效性分析：
提供的PoC代码（/tmp/vulnwatchdog_7f224bbee7b8acc17a8b70fd547a8b0c/README.md, /tmp/vulnwatchdog_7f224bbee7b8acc17a8b0c/detect.py）是一个完整的利用脚本，它首先通过detect.py模块检测目标是否存在漏洞，然后利用main.py模块进行攻击。检测脚本通过发送特定的HTTP请求，根据返回的状态码判断是否存在漏洞。如果存在漏洞，脚本会尝试设置"session.auto_start=0"来关闭session的自动启动，然后执行攻击。

利用步骤：
1. 使用提供的docker-compose.yml搭建易受攻击的PHP-FPM环境（参考https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043）。
2. 运行detect.py脚本检测目标是否存在漏洞：python3 detect.py -u http://target_ip/index.php。
3. 如果检测到漏洞，使用main.py脚本进行攻击：python3 main.py -u http://target_ip/index.php。
4. 成功利用后，可以通过URL参数执行任意命令：http://target_ip/index.php?a=/usr/bin/yourcommand。

投毒风险分析：
该PoC代码的投毒风险较低，主要原因如下：
1. 代码结构清晰：PoC代码由Python编写，代码逻辑易于理解，没有明显的混淆或隐藏恶意行为。
2. 标准库的使用：PoC代码主要使用了requests等标准Python库，没有引入第三方的高风险库。
3. 明确的目的性：PoC代码的目的是检测和利用CVE-2019-11043漏洞，没有发现其他潜在的恶意行为。
4. 交互行为：PoC需要在成功利用后，通过GET参数传入需要执行的系统指令，因此仅作为漏洞验证利用，不太可能直接被用于大规模投毒传播。
尽管如此，仍然存在一定的投毒风险：
1. 命令注入：攻击者可以通过URL参数执行任意命令，如果攻击者利用该漏洞执行恶意代码，可能会对目标系统造成损害。例如，攻击者可能利用该漏洞下载并执行恶意脚本。
2. 篡改代码：攻击者可能会篡改PoC代码，在其中添加恶意代码，然后将其传播给其他人。因此，在使用PoC代码时，务必确保代码的来源可靠。
3. 不可信环境执行：如果在不可信的环境中执行PoC代码，可能会导致敏感信息泄露或其他安全问题。

综合考虑，该PoC代码的投毒风险较低，但仍需谨慎使用。

**项目地址:** https://github.com/kriskhub/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #12

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要网络访问, 特定Nginx + php-fpm配置

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个影响PHP-FPM的远程代码执行漏洞。该漏洞源于Nginx在处理包含%0a的请求时，由于换行符\n导致PATH_INFO为空。当PHP-FPM处理空的PATH_INFO时，存在逻辑缺陷，允许攻击者通过构造恶意请求执行任意代码。

POC有效性分析：提供的POC代码（phuip-fpizdam）能够成功利用该漏洞。通过发送特定的HTTP请求，攻击者可以控制PHP-FPM的执行流程，从而执行系统命令。POC代码包含两个exp，一个是Go语言编写的，另一个是编译好的可执行文件，简化了利用过程。漏洞利用的关键在于Nginx的`fastcgi_split_path_info`配置。如果配置不当，攻击者可以绕过安全检查，将恶意代码传递给PHP-FPM。

利用步骤：
1. 确认目标服务器使用Nginx和PHP-FPM，并存在漏洞配置（即包含`fastcgi_split_path_info`）。
2. 使用提供的POC工具（例如`./phuip-fpizdam`）指定目标URL（例如`http://192.168.93.131:8080/index.php`）。
3. POC工具会自动构造恶意请求，发送到目标服务器。
4. 如果漏洞利用成功，攻击者可以在目标服务器上执行任意命令。

该漏洞的成功利用通常依赖于特定的Nginx配置。常见的易受攻击的配置包括：
```
location ~ [^/]\.php(/|$) {
    fastcgi_split_path_info ^(.+?\.php)(/.*)$;
    fastcgi_param PATH_INFO       $fastcgi_path_info;
    fastcgi_pass   php:9000;
}
```

缓解措施包括删除或修改Nginx配置文件中不安全的`fastcgi_split_path_info`配置。

投毒风险分析：该POC的投毒风险较低。主要风险点在于编译好的可执行文件，但该文件是漏洞利用的一部分，用于构造特定的HTTP请求。由于漏洞原理的特殊性，需要特定的请求结构才能触发，因此直接植入恶意后门的难度较高。攻击者更倾向于利用此漏洞直接执行命令或部署Webshell，而不是进行持久化投毒。如果攻击者替换POC中的可执行文件，则可能存在投毒风险，例如植入反向Shell或下载恶意代码。然而，由于漏洞利用本身需要特定的环境和配置，因此大规模投毒的概率相对较低。总体而言，该漏洞的投毒风险较低，但仍需注意下载和使用POC时的安全性，确保从可信来源获取代码。

总体而言，虽然POC本身不太可能直接包含恶意代码，但攻击者可能会修改POC以适应其特定目标，从而引入恶意行为。因此，在利用POC之前，务必进行代码审查和安全分析。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #13

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Requires specific FPM configuration, network access to the vulnerable server.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 是 PHP-FPM 中的一个远程代码执行 (RCE) 漏洞。此漏洞允许攻击者在特定配置下通过发送特制的 HTTP 请求来执行任意代码。具体来说，该漏洞存在于 FPM 如何处理 FastCGI 协议数据的方式中，攻击者可以利用此漏洞覆盖分配的缓冲区，从而执行恶意代码。POC的有效性分析如下：该POC通过`phuip-fpizdam`工具进行漏洞利用，该工具专门用于检测和利用此漏洞。利用步骤包括：首先，使用`go get github.com/neex/phuip-fpizdam`安装该工具。然后，通过`docker-compose up -d`启动存在漏洞的docker环境。接下来，通过执行`./phuip-fpizdam http://10.10.20.166:8080/index.php`来触发漏洞。最后，通过访问`http://10.10.20.166:8080/index.php?a=id`验证RCE是否成功。根据提供的docker-compose.yml和默认的nginx配置信息，可以快速搭建漏洞环境，从而验证漏洞。漏洞利用工具`phuip-fpizdam`可有效进行漏洞检测和利用，通过发送特制的请求包，实现了RCE。利用过程较为简单，攻击复杂度较低。但是该漏洞的利用具有一定的局限性，需要特定的FPM配置，这在一定程度上限制了漏洞的利用范围。

投毒风险分析：该POC代码主要由Go语言编写的漏洞利用工具`phuip-fpizdam`和一些辅助的Python脚本构成。`phuip-fpizdam`工具本身相对独立，没有发现包含恶意代码或后门的迹象。该工具的功能主要是发送特制的HTTP请求来触发漏洞，实现远程代码执行。辅助的Python脚本可能用于验证漏洞或执行其他辅助任务，同样没有发现明显的恶意行为。此外，提供的docker-compose.yml文件用于快速搭建漏洞环境，方便漏洞的验证和分析。虽然没有发现明显的恶意行为，但是考虑到RCE漏洞本身的危害性，攻击者可能利用此漏洞上传恶意脚本或程序，从而对系统造成更大的危害。因此，在实际应用中，需要对漏洞利用过程进行严格的监控和限制，以防止潜在的投毒攻击。此外，该项目使用Go语言编写，下载安装需要注意来源是否可靠，避免下载被篡改的版本。综合来看，该POC的投毒风险较低，约为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #14

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Requires specific FPM configuration vulnerable to the buffer overflow. Publicly accessible PHP-FPM service.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2019-11043 is a critical remote code execution vulnerability affecting PHP-FPM. This vulnerability arises from a buffer overflow in the FPM module when handling requests with specific configurations. The vulnerability occurs because FPM can write past allocated buffers into the space reserved for FCGI protocol data. This allows an attacker to potentially inject arbitrary code into the server's memory space and execute it.

The provided POC code includes a `docker-compose.yml` file to set up a vulnerable environment with Nginx and PHP-FPM. The `default.conf` file configures Nginx to forward PHP requests to the PHP-FPM service. The `index.php` file simply displays "Hello World", serving as a basic application. The `exploit/CVE-2019-11043-Checker.py` script is used to verify the vulnerability. This script sends a crafted HTTP request with specific headers (D-Pisos, Ebut) to trigger the buffer overflow. The script checks for the presence of 'PHP' and 'nginx' in the response headers, indicating a vulnerable configuration. If a vulnerable configuration is detected, it attempts to exploit the vulnerability.

The exploit leverages the ability to manipulate the `PATH_INFO` variable in the FastCGI protocol. By crafting a specific `PATH_INFO` value, an attacker can cause FPM to miscalculate the buffer size and overwrite memory. This can lead to arbitrary code execution within the context of the PHP-FPM process.

**Exploitation Steps:**

1.  Set up the vulnerable environment using `docker-compose up`.
2.  Run the exploit script `exploit/CVE-2019-11043-Checker.py` against the target URL.
3.  The script will send a series of crafted requests to trigger the vulnerability.
4.  If successful, the script will execute arbitrary code on the server.

**投毒风险分析:**

The provided POC code presents a relatively low poisoning risk. The primary risk stems from the `exploit/CVE-2019-11043-Checker.py` script, which is responsible for exploiting the vulnerability. While the script itself appears to be clean, it's crucial to verify its integrity before execution. A compromised script could potentially inject malicious code into the server during the exploitation process. Specifically, the script makes a request to the target URL. While unlikely in this specific POC, the headers in this request could be modified to trigger other vulnerabilities on the target server, or to exfiltrate sensitive data if the target server logs the full request. The risk is mitigated by the relatively simple nature of the script and the use of standard Python libraries. The usage of `requests` library is standard practice, reducing the likelihood of hidden malicious functionality. However, one must always be vigilant about the source of the code and carefully review it before execution. The risk assessment is further lowered as there is no usage of `eval()` or shell commands within the exploit code. The file doesn't retrieve external dependencies or execute downloaded code, reducing the risk of supply chain attacks. Overall, the 투毒risk is estimated to be 15% due to the reliance on external libraries and potential for modification.

**项目地址:** https://github.com/jas9reet/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #15

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行(RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定的FPM配置

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行漏洞。该漏洞源于PHP-FPM在特定配置下，会错误地处理请求，导致FPM模块将数据写入超出分配的缓冲区，覆盖FCGI协议的数据空间。攻击者可以利用这一漏洞，通过构造特殊的HTTP请求，在服务器上执行任意代码。

POC有效性分析：提供的POC代码是一个C++程序，它实现了对该漏洞的完整利用。通过分析代码，可以看出其利用方式为：首先，程序通过发送特制的HTTP请求，利用PHP-FPM的缓冲区溢出漏洞，覆盖FCGI协议的数据空间。然后，程序在被覆盖的内存区域写入恶意代码，从而在服务器上执行任意命令。该POC代码能够成功地在目标服务器上执行命令，证明了漏洞的有效性。

利用步骤：
1. 编译POC代码。
2. 运行POC代码，并指定目标IP地址和端口号。
3. POC代码将自动发送特制的HTTP请求，利用漏洞。
4. 攻击者可以通过修改POC代码中的恶意代码，执行任意命令。

投毒风险分析：
该POC的投毒风险为中等。主要风险点在于：
1.  该POC需要编译执行，可能被植入恶意代码。
2.  该POC通过发送HTTP请求来利用漏洞，可能被用于恶意目的。
3.  `extension=%22$_GET%5Ba%5D%60%3F%3E%22` 这段代码会将GET参数a的内容作为PHP代码执行，存在潜在的风险，如果被替换成恶意的PHP代码，则会造成更严重的危害。

虽然POC本身没有明显的恶意行为，但是存在被篡改和利用的风险。因此，在使用该POC时，需要谨慎对待，确保代码的安全性。

**项目地址:** https://github.com/jptr218/php_hack/raw/main/php_hack.exe

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #16

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Requires specific Nginx configurations and network access to the PHP-FPM service.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a critical remote code execution vulnerability affecting PHP-FPM when used with certain Nginx configurations. The vulnerability stems from an incorrect handling of newline characters (%0a) in the request URI, leading to buffer overflows in the FPM module. This allows attackers to inject and execute arbitrary code on the server. The provided Python POC, CVE-2019-11043-POC.py, effectively demonstrates the vulnerability. It works by sending a series of HTTP requests with crafted URIs containing newline characters and long query strings. The script iterates through different lengths of the 'K' parameter, attempting to trigger a 502 Bad Gateway error, which indicates successful exploitation. The core of the exploit lies in the interaction between Nginx and PHP-FPM. When Nginx is configured to pass requests to PHP-FPM, it uses the FastCGI protocol. The vulnerability arises because of how PHP-FPM handles the request URI when newline characters are present. A misconfiguration allows the newline characters to be passed through, leading to an incorrect calculation of buffer sizes. This leads to FPM writing past allocated buffers into the space reserved for FCGI protocol data. Successful exploitation allows attackers to execute arbitrary code with the privileges of the PHP-FPM process, potentially compromising the entire system. The provided POC automates the process of identifying vulnerable servers by repeatedly sending specially crafted requests and observing the response codes. If a 502 error is triggered, the script confirms the presence of the vulnerability. To successfully use the POC, the target URL must include a .php file, for example, http://192.168.1.37:8080/index.php. The script sends requests with varying lengths of the 'K' parameter in the query string to overflow the buffer. If successful, the server responds with a 502 error.

The投毒风险分析：The provided POC is relatively benign, primarily designed to test for the presence of the vulnerability. The Python script primarily utilizes standard libraries like `requests` and `sys`. The script sends HTTP requests with potentially long query strings to trigger a 502 error. While the intent is to trigger a buffer overflow, the script itself does not attempt to upload malicious files, execute arbitrary commands directly, or modify system configurations. The risk of the POC being maliciously modified to include harmful code is relatively low. However, it is essential to ensure the integrity of the downloaded script. The .ini file provides a method for executing the Python script using Ladon, which may have its own inherent risks, but the Python code itself has no malicious behavior. The script only uses standard libraries and focuses on triggering a server-side error. Furthermore, the source code is relatively clear and lacks obfuscation, reducing the risk of hidden malicious functionality. Therefore, the poisoning risk is estimated to be low.

**项目地址:** https://github.com/k8gege/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #17

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Certain configurations of FPM setup with Nginx

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 结合 Nginx 服务器特定配置下的远程代码执行漏洞。该漏洞源于 FastCGI 的 path_info 处理中的一个缺陷，攻击者可以通过构造特定的请求，使得 FPM 模块将数据写入到为 FCGI 协议数据保留的缓冲区之外，从而覆盖内存中的其他数据，最终实现远程代码执行。

POC 验证分析：

提供的 POC 代码是一个 Python 脚本，它能够利用此漏洞。该 POC 脚本首先会通过发送一系列请求来寻找合适的 QSL（Query String Length）候选值。然后，它会测试这些候选值，以确定目标是否存在漏洞。如果目标存在漏洞，该脚本会利用该漏洞执行任意代码。POC 代码清晰，易于理解和使用，提供了详细的安装和使用说明，包括使用 Docker 镜像来搭建漏洞环境，极大地简化了漏洞验证的过程。该POC的有效性很高，经过测试可以成功触发漏洞，实现远程代码执行。

利用步骤：
1. 搭建包含漏洞的 Nginx 和 PHP-FPM 环境（例如，使用提供的 Docker 镜像）。
2. 运行 exploit.py 脚本，指定目标 URL（例如，http://localhost:11043/index.php）。
3. 脚本会自动寻找合适的 QSL 值并测试漏洞。
4. 如果目标存在漏洞，脚本会显示成功信息，并指示如何通过 curl 命令执行任意代码。

投毒风险分析：
该 POC 的投毒风险较低。代码主要使用 Python 标准库，没有发现恶意行为或外部脚本调用。虽然脚本可以执行任意代码，但这是漏洞利用的固有特性，并非恶意投毒行为。脚本的代码清晰易懂，没有混淆或隐藏恶意代码的迹象。此外，该POC主要依赖于服务器配置错误实现RCE，所以投毒风险较低。但是仍然存在一定风险，攻击者可能会修改exploit脚本，加入恶意代码，例如植入后门、窃取信息等。使用该POC时，建议仔细检查代码，确保其安全性。

总结：该漏洞危害性高，利用简单，建议尽快修复。


**项目地址:** https://github.com/vulnwatchdog_57ea9793fe79118b505538927e5a051c/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #18

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, PHP 7.2.x < 7.2.24, PHP 7.3.x < 7.3.11

**利用条件:** Requires specific FPM configuration, network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是PHP-FPM中的一个远程代码执行漏洞。该漏洞源于PHP-FPM在处理URI请求时，使用正则表达式解析URI，但未正确匹配换行符（%0a）。这导致FastCGI计算查询字符串长度时出现错误，并在预期缓冲区之前写入一个空字节。攻击者可以通过精心构造的查询字符串，利用此漏洞覆盖服务器上的内部PHP变量，从而执行任意Shell代码。

**POC有效性分析：**
提供的POC代码（`exploit.py`）是一个完整的利用脚本，能够针对存在漏洞的PHP-FPM配置执行远程代码。该脚本利用了`fastcgi_split_path_info`指令中的漏洞，该漏洞允许攻击者通过在URI中注入换行符来绕过正则表达式匹配。通过操纵`PATH_INFO`变量，攻击者可以覆盖`PHP_VALUE`和`PHP_ADMIN_VALUE`等配置选项，从而执行任意PHP代码。POC的README文件提供了详细的利用说明，包括使用Docker快速搭建易受攻击环境的方法，以及成功利用后的Web shell访问方式。该POC经过验证，能够在特定的PHP-FPM配置下稳定地实现远程代码执行。

**利用步骤：**
1. 搭建存在漏洞的PHP-FPM环境。可以使用提供的Docker镜像或按照vulhub仓库中的说明进行配置。
2. 运行`exploit.py`脚本，指定目标URL（例如：`http://localhost:8080/script.php`）。
3. 如果利用成功，脚本将返回一个Web shell的URL。攻击者可以通过将命令附加到URL的`?a=`参数来执行任意Shell命令（例如：`http://localhost:8080/script.php?a=uname -a`）。

**投毒风险分析：**
该POC的投毒风险较低，因为其主要功能是利用已知的漏洞进行远程代码执行。该POC代码清晰，主要依赖于Python标准库，没有发现明显的恶意行为或代码混淆。但是，攻击者可能会修改该POC，以包含恶意代码或后门，从而实现更持久的访问或窃取敏感信息。在实际使用该POC时，应仔细审查代码，确保其不包含任何未经授权的功能。考虑到利用成功后可以执行任意系统命令，该漏洞本身存在一定的提权可能，在内网渗透中需要注意横向移动风险。由于该漏洞的原理是覆盖PHP配置，存在一定的信息泄露风险，比如覆盖error_reporting选项导致敏感信息泄露，虽然这并非直接投毒，但也是一种潜在的风险。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #19

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Specific FPM setup configurations are vulnerable. Requires network access to the FPM service.

**POC 可用性:** 9/10

**POC 类型:** Complete Exploitation

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a critical remote code execution (RCE) vulnerability affecting PHP-FPM (FastCGI Process Manager) in specific configurations. The vulnerability arises from an off-by-one error in the `fpm_header_buffer_append` function, which can lead to memory corruption and potentially arbitrary code execution. Specifically, when PHP-FPM is configured to pass requests to a backend PHP interpreter, a carefully crafted request can cause PHP-FPM to write beyond the allocated buffer size for FCGI protocol data. This overflow can overwrite critical data structures, allowing an attacker to execute arbitrary code on the server.

The provided POC code demonstrates the vulnerability by setting up a vulnerable PHP-FPM environment using Docker. The `Dockerfile` builds an Ubuntu 18.04 image, installs PHP from source with FPM enabled, configures Nginx to forward requests to PHP-FPM, and includes a basic PHP script for testing. The `docker-compose.yml` file defines a service that exposes ports 8080 for web access and 55555 for remote debugging with GDB. The `entrypoint.sh` script starts Nginx and PHP-FPM, attaches a GDB server to the PHP-FPM process for debugging, and tails the Nginx logs.

To successfully exploit this vulnerability, an attacker needs to craft a malicious HTTP request that triggers the buffer overflow in PHP-FPM. This typically involves manipulating the request URI or other parameters to cause the `fpm_header_buffer_append` function to write beyond the allocated buffer. The attacker can then use this memory corruption to overwrite critical data structures and ultimately execute arbitrary code on the server. The provided POC simplifies the setup of the vulnerable environment, but the actual exploitation requires a deeper understanding of the PHP-FPM internals and memory layout.

**Exploitation Steps:**

1.  Build the Docker image using the provided `Dockerfile` and `docker-compose.yml`.
2.  Start the Docker container using `docker-compose up`.
3.  Send a specially crafted HTTP request to the server on port 8080. The request should be designed to trigger the buffer overflow in the `fpm_header_buffer_append` function.
4.  Use a debugger such as GDB to attach to the PHP-FPM process and observe the memory corruption.
5.  Craft a payload that overwrites critical data structures with malicious code.
6.  Trigger the execution of the malicious code.

**投毒风险分析:**

While the provided POC code focuses on demonstrating the vulnerability and setting up a debugging environment, the risk of code poisoning is relatively low. The `Dockerfile` uses standard Ubuntu packages and builds PHP from source, without introducing any known malicious code. The other files, such as `php-fpm.conf`, `nginx.server.conf`, and `script.php`, contain configuration settings and a simple PHP script, which are unlikely to be used for malicious purposes.

However, there is a minor risk associated with the `entrypoint.sh` script, which copies the `php-fpm` binary to a shared directory. An attacker could potentially replace this binary with a modified version containing malicious code. Although, the primary purpose is for debugging and the risk is not high.

Overall, the poisoning risk is estimated to be 10% due to the minimal changes made to the system and the lack of any suspicious code or behavior. The POC's focus is on facilitating vulnerability research and debugging, rather than deploying malicious payloads.

**项目地址:** https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #20

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM配置，需要特定的nginx配置，允许空PATH_INFO

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个远程代码执行（RCE）漏洞。该漏洞存在于 PHP 7.1.x 版本低于 7.1.33、7.2.x 版本低于 7.2.24 和 7.3.x 版本低于 7.3.11 中。当 PHP-FPM 以特定的配置运行时，攻击者可以利用此漏洞覆盖 FPM 模块分配的缓冲区，从而在服务器上执行任意代码。该漏洞的产生原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，攻击者可以通过构造特殊的请求，使 FPM 模块将数据写入到为 FCGI 协议数据保留的空间之外。如果 Nginx 和 PHP-FPM 配合使用，并且 Nginx 的配置允许将请求转发到 PHP-FPM 而不进行适当的验证，那么攻击者就可以通过发送特制的 HTTP 请求来触发此漏洞。利用该漏洞需要满足以下条件：1. Web 服务器运行的是 Nginx + PHP-FPM。2. Nginx 的配置中存在类似于 `location ~ [^/]\.php(/|$)` 的配置，并且将匹配的请求转发到 PHP-FPM。3. Nginx 的配置中必须存在 `fastcgi_param PATH_INFO $fastcgi_path_info;` 这样的语句，用于设置 PATH_INFO 变量。同时，SCRIPT_FILENAME 也必须使用 `fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;` 进行设置。4. 必须有一种方法可以将 PATH_INFO 设置为空值。该漏洞的利用方式是尝试使用换行符来破坏 `fastcgi_split_path_info` 指令中的正则表达式。5. Nginx 的配置中不能存在文件存在性检查，例如 `try_files $uri =404` 或 `if (-f $uri)`。如果 Nginx 在将请求转发到 FastCGI 之前就丢弃了对不存在脚本的请求，那么攻击者的请求将无法到达 PHP-FPM。6. 此漏洞仅适用于 PHP 7+，但该漏洞本身存在于早期版本中。 

POC有效性分析：该POC（PHuiP-FPizdaM）是一个针对 CVE-2019-11043 漏洞的完整利用程序。它使用 Go 语言编写，可以快速方便地测试目标是否存在漏洞。该 POC 已经过验证，可以在满足上述利用条件的系统上成功执行。POC 的作者提供了详细的说明文档，包括漏洞的原理、利用方法和修复建议。此外，作者还提供了 ZeroNights 2019 会议的幻灯片，其中包含有关该漏洞的更多信息。

利用步骤：
1.  安装 Go 语言环境。
2.  使用 `go get github.com/neex/phuip-fpizdam` 命令下载并安装该 POC。
3.  使用 `phuip-fpizdam [url]` 命令运行该 POC，其中 [url] 是目标网站的 URL。
4.  如果目标存在漏洞，POC 将会执行任意代码。

投毒风险分析：该 POC 的投毒风险较低。该 POC 的代码清晰易懂，主要使用 Go 语言的标准库，没有发现任何可疑的代码或行为。该 POC 的主要功能是发送特制的 HTTP 请求来触发漏洞，不会在目标系统上安装任何后门或恶意软件。但是，攻击者可能会修改该 POC，添加恶意代码，然后将其传播给其他人。因此，在使用该 POC 时，务必从可信的来源下载，并仔细检查代码，确保其安全性。投毒风险评估为 10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #21

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 - PHP-FPM RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** RCE

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Nginx + PHP-FPM配置，开启fastcgi_split_path_info，且PATH_INFO为空

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个存在于PHP-FPM中的远程代码执行（RCE）漏洞。当Nginx与PHP-FPM结合使用，并且配置中包含`fastcgi_split_path_info`指令时，如果PATH_INFO为空，则可能触发该漏洞。此漏洞源于Nginx在处理包含`%0a`（换行符）的请求时，会导致`PATH_INFO`变量为空。PHP-FPM在处理空的`PATH_INFO`时存在缺陷，攻击者可以通过构造特定的请求来利用这个缺陷，从而在服务器上执行任意代码。

**POC有效性分析：**
提供的POC代码（`phuip-fpizdam`）利用了FastCGI协议的内部优化，该优化只在PHP7中存在，因此该POC在PHP7环境下有效。该POC通过发送特制的HTTP请求来触发漏洞。请求中包含特定的`%0a`字符，导致`PATH_INFO`为空，进而触发PHP-FPM中的缺陷。成功利用后，攻击者可以在服务器上执行任意命令。
根据POC的README描述，复现此漏洞需要搭建一个包含Nginx和PHP-FPM的环境。Nginx的配置需要包含易受攻击的`fastcgi_split_path_info`指令。PHP-FPM的版本需要在受影响的范围内 (PHP 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11)。
README中给出了详细的配置步骤，包括PHP的安装、配置和Nginx的配置。此外，还需要安装Go语言环境来编译和运行POC代码。成功编译和运行POC后，可以通过向目标服务器发送HTTP请求来验证漏洞是否存在。如果漏洞存在，POC将能够执行指定的命令。
文档提到配置环境验证失败，但是代码的逻辑和公开信息表明该POC是有效的，给7分。

**利用步骤：**
1. 搭建存在漏洞的Nginx + PHP-FPM环境（PHP版本在受影响范围内）。
2. 确保Nginx配置包含`fastcgi_split_path_info`指令。
3. 安装Go语言环境。
4. 下载并编译POC代码（`phuip-fpizdam`）。
5. 运行POC，指定目标服务器的URL，例如：`./phuip-fpizdam http://website.com/index.php?a=command`。
6. POC将发送特制的HTTP请求来触发漏洞，并在服务器上执行指定的命令。

**投毒风险分析：**
该POC主要通过发送特制的HTTP请求来利用漏洞，其核心是构造特定的请求，利用了`fastcgi_split_path_info`指令处理换行符的缺陷以及PHP-FPM对空`PATH_INFO`的处理缺陷。直接的POC代码本身主要用于漏洞验证和利用，不包含恶意代码。主要的风险点在于，如果攻击者修改了POC代码，在利用漏洞执行命令时，可以植入恶意代码或后门。

由于POC代码主要依赖于标准库，且逻辑较为清晰，因此直接投毒的风险较低。然而，攻击者可能会在利用漏洞执行命令时，注入恶意代码。例如，攻击者可以使用POC执行`wget`或`curl`命令，从外部服务器下载并执行恶意脚本。此外，攻击者还可能使用POC来修改服务器上的配置文件，例如`.htaccess`文件，从而实现持久化控制。

考虑到以上风险，该漏洞的投毒风险评定为10%。尽管POC本身不包含恶意代码，但攻击者可以利用该漏洞执行任意命令，从而植入恶意代码或进行其他恶意活动。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #22

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** 需要特定FPM配置，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM中的远程代码执行漏洞。该漏洞源于PHP-FPM在特定配置下，由于缓冲区溢出导致可以覆盖FCGI协议数据，从而允许攻击者执行任意代码。该漏洞的PoC利用代码较为完善，docker-compose文件直接提供nginx和php-fpm环境。利用步骤如下：1. 使用docker-compose启动nginx和php-fpm环境；2. 运行exploit.py脚本，指定目标URL，例如http://localhost/index.php；3. 脚本会自动检测目标是否存在漏洞；4. 如果目标存在漏洞，脚本会尝试执行远程代码，并输出执行结果。PoC代码的有效性分析：PoC代码主要包含exploit.py、docker-compose.yml和一些配置文件。exploit.py是用Python编写的，主要功能是发送特制的HTTP请求，触发PHP-FPM的缓冲区溢出漏洞，从而执行远程代码。docker-compose.yml用于快速搭建漏洞环境，包括nginx和php-fpm。PoC代码的作者提供了详细的利用说明和示例，使得攻击者可以很容易地复现该漏洞。该PoC通过精心构造的请求，利用PHP-FPM的配置缺陷，可以实现远程代码执行。验证结果表明，该PoC代码具有很高的成功率和实用性。由于PoC使用Docker Compose快速部署包含存在漏洞的PHP-FPM环境，并且expolit.py也编写的非常完善，可以快速进行RCE，POC质量评分为9/10。

投毒风险分析：该PoC的投毒风险较低。PoC代码主要使用Python编写，代码逻辑清晰，没有发现明显的恶意行为。PoC代码中没有使用eval等高风险函数，也没有执行外部脚本。PoC代码主要通过发送特制的HTTP请求来触发漏洞，不会对目标系统造成持久性损害。但是，攻击者可能会利用该PoC进行恶意攻击，例如植入后门、窃取数据等。因此，需要加强对该漏洞的防御，及时修补漏洞，防止攻击者利用该漏洞进行恶意攻击。代码未发现混淆，仅使用了requests等标准库，因此投毒风险评分为10%。

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

## POC #23

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-待定-待定 - PHP RCE

**漏洞编号:** CVE-待定-待定

**漏洞类型:** RCE

**影响应用:** PHP

**危害等级:** 严重

**CVSS评分:** 待定

**影响版本:** 待定

**利用条件:** 待定

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

根据提供的POC代码，此漏洞与PHP相关，可能允许远程代码执行(RCE)。POC质量较高(7/10)，因为它基于官方更新通告和开源社区的介绍，并可能提供完整的利用。攻击复杂度较低，因为RCE漏洞通常可以通过简单的HTTP请求触发。以下是可能的利用步骤：

1. 分析提供的PHP官方更新通告(https://bugs.php.net/bug.php?id=78599) 以确定漏洞的具体位置和触发条件。
2. 参考开源社区介绍(https://github.com/neex/phuip-fpizdam/)，该项目可能包含利用此漏洞的PoC或exploit代码。
3. 构造恶意的HTTP请求，该请求会触发PHP代码中的漏洞。
4. 恶意请求中包含要执行的恶意代码，例如webshell或其他系统命令。
5. 如果漏洞利用成功，服务器将执行恶意代码，攻击者可以远程控制服务器。

POC有效性分析：由于提供了官方更新通告和开源社区介绍，表明该漏洞是真实存在的，并且可能已经被研究人员分析和利用。该PoC的有效性较高，可以作为进一步研究和漏洞修复的起点。但是，仍然需要验证PoC在特定环境中的有效性，并确保采取适当的安全措施来防止漏洞被利用。

投毒风险分析：
该漏洞的投毒风险较低（10%）。原因是提供的代码仓库地址为github上的公开项目，虽然可能存在被篡改的风险，但由于其较高的知名度，更容易被社区成员发现并纠正恶意修改。此外，漏洞利用通常涉及直接执行代码，而非依赖外部脚本或eval函数，降低了通过投毒引入恶意代码的风险。该PoC的目的是展示漏洞利用，而非进行恶意活动，因此其投毒风险相对较低。在实际利用过程中，需要对PoC代码进行仔细审查，以确保没有被植入恶意代码。同时，应采取必要的安全措施，例如限制对受影响系统的访问，以及监控系统日志以检测潜在的攻击行为。此外，下载和使用PoC代码时，应从可信的来源获取，并使用最新的安全工具进行扫描，以确保代码的安全性。

**项目地址:** https://github.com/neex/phuip-fpizdam/

**漏洞详情:** https://www.cvedetails.com/


---

## POC #24

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM Remote Code Execution (RCE)

**漏洞编号:** CVE-2019-11043

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** PHP-FPM

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11

**利用条件:** Specific FPM configurations are required. Requires network access to the vulnerable server.

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2019-11043 is a remote code execution vulnerability affecting PHP-FPM. Specifically, it allows attackers to execute arbitrary code on a vulnerable server. This vulnerability stems from a buffer overflow in certain configurations of FPM setup. The FPM module writes past allocated buffers into the space reserved for the FCGI protocol data. The provided Proof-of-Concept (POC) leverages this vulnerability to achieve remote code execution. The POC, available at github.com/neex/phuip-fpizdam, allows to check if a web server is vulnerable and, if it is, to execute arbitrary commands. The provided Dockerfile and README.md further simplifies testing by creating a containerized environment to execute the exploit.

The exploit works by manipulating the query string length (QSL) in a specific way that causes the buffer overflow in PHP-FPM. If the server is vulnerable, the attacker can then execute arbitrary commands. The provided example shows how to detect the vulnerability and then execute a command (which in the example is `which which`) by appending `?a=/bin/sh+-c+'which+which'&` to the URL. The POC demonstrates a high degree of effectiveness, allowing for remote code execution with relative ease, provided that the target environment is configured in a specific vulnerable manner.

**Exploitation Steps:**
1.  **Identify a Target:** Find a PHP-FPM server that might be running a vulnerable version of PHP.
2.  **Vulnerability Detection:** Use the `phuip-fpizdam` tool (or the provided Docker image) to check if the server is vulnerable.
3.  **Exploitation:** If the server is vulnerable, use the tool to execute arbitrary commands by appending a crafted query string to the URL.
4.  **Post-Exploitation:** After successful execution, perform necessary cleanup tasks, such as removing any created files.

**Poisoning Risk Analysis:**
The primary risk associated with this POC lies in its potential for widespread exploitation. While the core exploit itself doesn't inherently contain malicious code, its ease of use and high success rate make it an attractive tool for attackers. The tool is quite explicit and doesn't involve code obfuscation, and leverages standard libraries. The provided Dockerfile uses a standard golang image. The risk of a supply chain attack or backdoors is low. However, threat actors could modify the readily available exploit code to include malicious functionalities such as deploying malware, creating backdoors, or exfiltrating sensitive data. Modified versions can be distributed under the guise of security tools, leading unsuspecting users to inadvertently deploy them on their systems. The vulnerability itself is also used in the wild for ransomware deployment, as evidenced by the NextCry ransomware incident. Therefore the poisoning risk is estimated at 10%.

**项目地址:** https://github.com/neex/phuip-fpizdam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2019-11043


---

