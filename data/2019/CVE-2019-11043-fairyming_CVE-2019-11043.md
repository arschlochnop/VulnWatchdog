# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

# CVE-2019-11043

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md](../2019/CVE-2019-11043-0th3rs-Security-Team_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端服务器，配置不当，将请求传递给 PHP-FPM。配置中需要包含 `fastcgi_split_path_info` 和不恰当的 `PATH_INFO` / `PATH_TRANSLATED` 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，起因是 PHP-FPM 在处理 `PATH_INFO` 环境变量时存在缺陷，如果 Nginx 配置不当，攻击者可以利用这个漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者需要找到一个启用了 PHP-FPM 并且 Nginx 配置存在漏洞的服务器。 关键配置是 `fastcgi_split_path_info`，它用于分割 URL，将一部分作为文件名，另一部分作为 `PATH_INFO`。
2.  利用 `cve_2019_11043.py` 脚本，首先判断目标是否存在漏洞。脚本通过修改 HTTP Header `D-Gisos` 和构造特定的 URL，爆破 query长度和Header头字段长度,检查 `session.auto_start` 是否被设置。如果目标存在漏洞，服务器会返回 `Set-Cookie` 头。
3.  然后脚本会确定目标 PHP worker 进程的数量，从而实现全 worker 进程污染，增强漏洞利用的稳定性。
4.  脚本通过构造特定的 `PHP_VALUE` 参数来修改 PHP 的配置。关键配置包括 `error_reporting`，`short_open_tag`，`html_errors`，`log_errors`，`error_log`，`include_path`， `output_handler`，`extension_dir`， 和 `extension`。
5.  `extension=$_GET[a]`允许执行任意代码，通过GET参数传递命令。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。该漏洞已经被广泛研究，并且存在公开可用的利用代码。

**投毒风险：**

该 POC 代码存在一定的投毒风险。`cve_2019_11043.py` 脚本中的利用链 (orange_chain) ，通过修改 PHP 配置，最终目的是允许通过 GET 参数执行任意代码。理论上，可以修改配置，写入恶意代码到服务器的文件中，比如木马文件。虽然当前脚本中的利用链看起来是为了执行命令，但攻击者可以修改利用链，达到植入后门的目的。

`print('Example: {}?a=%0asleep+5%0a'.format(target))`  这行代码提供了如何执行命令的示例。攻击者可以利用这个机制执行更隐蔽的恶意操作。

考虑到可能通过修改利用链进行投毒，投毒风险大约为 10%。大部分代码是用于漏洞利用，少部分存在恶意利用的可能性。

**项目地址:** [0th3rs-Security-Team/CVE-2019-11043](https://github.com/0th3rs-Security-Team/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #2

**来源**: [CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md](../2019/CVE-2019-11043-AleWong_PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 配置不当，启用 php-fpm，且使用 fastcgi_split_path_info 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下存在的远程代码执行漏洞。当 Nginx 未正确配置，特别是使用了 `fastcgi_split_path_info` 指令时，攻击者可以通过在 URL 中注入换行符（%0a）来绕过路径检查，导致 PATH_INFO 为空。PHP-FPM 处理 PATH_INFO 为空的逻辑存在缺陷，使得攻击者可以通过精心构造的请求，覆盖 FPM 模块分配的缓冲区，最终实现远程代码执行。

**利用方式：**

1.  **利用条件确认：** 目标服务器必须同时满足以下条件：
    *   运行 Nginx 作为 Web 服务器。
    *   使用 PHP-FPM 处理 PHP 请求。
    *   Nginx 配置文件中存在 `fastcgi_split_path_info` 指令。
    *   使用的 PHP 版本在受影响范围内 (PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11)。
2.  **QSL（Query String Length）探测：** 通过发送包含大量 "Q" 字符的请求，找到能使服务器返回 502 错误的 QSL 值。这个值是成功利用漏洞的关键参数。
3.  **漏洞利用：** 使用找到的 QSL 值构造恶意请求，该请求会触发缓冲区溢出，允许攻击者执行任意代码。

**有效性：**

提供的 POC 代码 (CVE-2019-11043.py) 主要用于检测漏洞是否存在，它通过发送不同长度的请求，检查服务器是否返回 502 错误。如果服务器返回 502，则表明可能存在漏洞，并给出可能的 QSL 值。根据搜索结果和漏洞信息，这个POC的检测部分是有效的。

**投毒风险：**

提供的 POC 代码相对简单，主要功能是漏洞检测。代码中包含一些不友好的HTTP头，如`'D-Pisos': '8=D'`和`'Ebut': 'mamku tvoyu'`，但并未发现明显的恶意代码或后门。`README.md`文件提供了使用`phuip-fpizdam`工具进行漏洞检测和利用的指导。虽然直接投毒风险较低，但需要注意的是，利用该漏洞执行任意代码本身就存在极高的安全风险。用户在使用POC进行验证时，应该在隔离环境中进行，并严格控制利用过程，以防被恶意利用。投毒风险评估为10%，主要是考虑到利用该漏洞的最终目的是远程代码执行，而执行的代码内容完全由攻击者控制，存在极大的潜在风险。



**项目地址:** [AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-](https://github.com/AleWong/PHP-FPM-Remote-Code-Execution-Vulnerability-CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #3

**来源**: [CVE-2019-11043-MRdoulestar_CVE-2019-11043.md](../2019/CVE-2019-11043-MRdoulestar_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用不正确的 Nginx 配置 (如 `fastcgi_split_path_info`)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个存在于 PHP-FPM 中的漏洞，当 PHP-FPM 运行在 Nginx 服务器上并且配置不正确时，可能导致远程代码执行。该漏洞源于 `env_path_info` 的一个下溢错误。攻击者可以通过构造特殊的 URL，利用该漏洞覆盖 FPM 进程中的内存，从而执行任意代码。

**有效性：**
根据提供的漏洞库信息、搜索结果和 POC 代码，该漏洞的 POC 代码有效。许多安全研究人员和厂商都确认了该漏洞的存在，并且已经发布了相应的补丁和修复方案。

**投毒风险：**
虽然提供的 POC 代码看起来是用于漏洞利用，但仍存在一定的投毒风险。风险点在于，攻击者可能修改 POC 代码，在成功利用漏洞后植入恶意后门或执行其他恶意行为。例如，在利用成功后，修改服务器配置文件、安装恶意软件等。POC 代码中存在多处调用 `requests.get()` 方法，攻击者可以在这些地方加入恶意请求或执行恶意代码。此外，利用成功后`print('Example: {}?a=%0asleep+5%0a'.format(target))`提示可以执行任意代码,如果攻击者修改这段代码植入恶意脚本,会造成投毒行为.综上，判定存在10%的投毒风险。

**利用方式：**
1.  **环境准备：** 目标系统需要运行存在漏洞的 PHP-FPM 版本，并且 Nginx 配置存在缺陷（使用了 `fastcgi_split_path_info` 等配置）。
2.  **漏洞检测：** 使用提供的 POC 脚本，通过发送特制的 HTTP 请求来判断目标系统是否存在漏洞。POC 脚本会尝试覆盖 `session.auto_start` 的值，如果请求返回包含 `Set-Cookie` 头部，则说明目标系统可能存在漏洞。
3.  **参数爆破：** 爆破 query 长度和 Header 头字段长度。
4.  **内存覆盖：**  通过精心构造的 HTTP 请求，利用下溢漏洞覆盖 FPM 进程中的内存，从而修改 PHP 的配置选项（例如 `error_log`、`include_path` 等）。
5.  **代码执行：**  通过修改 PHP 配置选项，将恶意代码写入到日志文件中，并通过 `auto_prepend_file` 或其他方式包含该日志文件，从而执行任意代码。
6.  **反弹shell/执行命令:**  通过`$_GET[a]` 参数,执行代码反弹shell或者执行特定命令.

**总结：**
CVE-2019-11043 是一个高危漏洞，攻击者可以利用该漏洞远程控制服务器。为了避免该漏洞带来的风险，建议及时升级 PHP 版本，并检查 Nginx 配置，避免使用不安全的配置选项。

**项目地址:** [MRdoulestar/CVE-2019-11043](https://github.com/MRdoulestar/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #4

**来源**: [CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md](../2019/CVE-2019-11043-a1ex-var1amov_ctf-cve-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，fastcgi_split_path_info配置，未做文件存在性检查 (try_files)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，影响使用 Nginx 和 PHP-FPM 的特定配置。漏洞源于 PHP-FPM 在处理 PATH_INFO 时的缓冲区下溢，攻击者可以通过特制的 URL 导致 FPM 模块将数据写入超出已分配缓冲区的空间，从而覆盖 FCGI 协议数据，最终导致远程代码执行。

**有效性:**

提供的 Dockerfile 和相关文件构成了一个可复现漏洞的实验环境。Dockerfile 明确配置了 vulnerable 的 Nginx 和 PHP-FPM 环境，包括指定版本的 Ubuntu、PHP 以及必要的配置，例如 `fastcgi_split_path_info`。`nginx.conf` 文件中注释掉的 `try_files` 检查是触发漏洞的关键。因此，提供的 PoC 代码是有效的，可以用于复现和利用该漏洞。

**投毒风险:**

评估投毒风险较低，约为 5%。理由如下：

*   **Dockerfile 内容明确:** Dockerfile 的指令清晰，主要用于构建漏洞环境，没有发现恶意代码或后门。使用了 `old-releases.ubuntu.com` 仅为了保证指定PHP版本安装。
*   **Nginx 配置简单:** `nginx.conf` 文件的配置主要用于暴露漏洞点，没有发现隐藏的恶意配置。
*   **应用代码量少:** 提供的`app/`和`public/`目录中的代码主要是演示用的task management app，代码量少，易于审计，没有发现可疑代码。`auth.php` 甚至是不完整的。
*   **`README.md`:** 提供了漏洞利用的快速上手方式，鼓励用户使用 `phuip-fpizdam` 工具，并未诱导用户执行任何恶意操作。

虽然整体风险较低，但是仍需谨慎。理论上作者可能在`app/`或者`public/`目录下的应用代码中插入后门，但需要进一步审计代码才能确认，从整体代码结构看，这种可能性较小。因此，将投毒风险评估为5%。

**利用方式:**

1.  **环境搭建:** 使用提供的 Dockerfile 构建包含漏洞的 Nginx + PHP-FPM 环境。
2.  **触发漏洞:** 通过构造特殊的 URL（通常包含 `%00` 或其他特殊字符）发送到目标服务器。这个 URL 的目的是触发 PHP-FPM 在处理 `PATH_INFO` 时的缓冲区下溢。
3.  **代码执行:** 如果漏洞成功触发，攻击者可以利用缓冲区溢出覆盖 FCGI 协议数据，从而修改 PHP-FPM 的行为，并最终执行任意代码。
4.  **利用工具:** 可以使用 `phuip-fpizdam` 工具自动化检测和利用该漏洞。该工具可以自动检测目标服务器的配置参数，并生成相应的 Payload，从而简化漏洞利用过程。

**重要提示:**

*   此漏洞利用需要在特定 Nginx + PHP-FPM 配置下才能成功。
*   务必在受控环境中进行测试，切勿在生产环境中进行未授权的漏洞利用。

**项目地址:** [a1ex-var1amov/ctf-cve-2019-11043](https://github.com/a1ex-var1amov/ctf-cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #5

**来源**: [CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md](../2019/CVE-2019-11043-akamajoris_CVE-2019-11043-Docker.md)

## CVE-2019-11043-PHP-FPM-RCE

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置不正确 (PATH_INFO)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 远程代码执行漏洞，存在于特定版本的 PHP-FPM 中，当与 Nginx 配合使用时，如果 Nginx 配置不当，攻击者可以通过构造恶意的请求，利用 env_path_info 的 underflow 漏洞，覆盖 FPM 缓冲区，从而执行任意代码。

**有效性：**
提供的 POC 代码有效。该代码提供了一个 Docker 镜像，其中包含一个易受攻击的 PHP-FPM 版本和 Nginx。它还提供了使用 `phuip-fpizdam` 工具进行漏洞利用的示例。该工具可以自动检测漏洞并执行命令。

**投毒风险：**
该仓库中可能存在一定的投毒风险（大约10%）。
1.  Dockerfile 中的 `RUN /bin/bash`  虽然不是直接的投毒代码，但可能允许构建者在镜像中包含恶意软件或后门。不过，这里只是为了构建镜像，风险较低。
2.  starter.sh 脚本启动 php-fpm 和 nginx。虽然脚本本身没有明显的恶意代码，但如果 php-fpm 或 nginx 的配置被恶意修改，则可能导致安全问题。镜像中 `default.conf` 的内容就是关键，该文件定义了Nginx的配置，是否容易受到攻击取决于该配置。如果该配置本身就是为了复现漏洞而设计的，那么即使利用成功，也不能算作投毒。

总的来说，该镜像的投毒风险较低。作者主要提供了复现漏洞的环境，目的是为了方便漏洞研究和利用。

**利用方式：**
1.  攻击者需要向目标服务器发送特制的 HTTP 请求。
2.  该请求必须包含一个精心构造的 `PATH_INFO`，以触发 PHP-FPM 的缓冲区下溢。
3.  缓冲区下溢允许攻击者覆盖 FPM 进程内存中的 FCGI 协议数据。
4.  通过覆盖 FCGI 数据，攻击者可以控制 PHP-FPM 执行任意代码。通常，攻击者会执行系统命令，从而获得服务器的控制权。

**需要注意的是，该漏洞利用需要特定的 Nginx 配置才能成功。** Nginx 需要将请求传递给 PHP-FPM，并且需要正确地设置 `PATH_INFO` 参数。如果 Nginx 配置不当，例如没有正确地验证文件是否存在，则可能导致此漏洞。

**项目地址:** [akamajoris/CVE-2019-11043-Docker](https://github.com/akamajoris/CVE-2019-11043-Docker)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #6

**来源**: [CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md](../2019/CVE-2019-11043-bayazid-bit_CVE-2019-11043-.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理。存在 try_files 或 if (-f $uri) 等检查文件存在的配置绕过。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，影响特定版本的 PHP。该漏洞是由于 PHP-FPM 在处理 `env_path_info` 时存在 underflow 缺陷，导致可以覆盖 FPM 分配的缓冲区，从而实现远程代码执行。

**有效性：**
提供的 POC 代码尝试通过修改 User-Agent 头来执行系统命令。根据漏洞信息和搜索结果，攻击并非通过 User-Agent 头，而是需要特定的 URL 构造来触发，因此提供的 POC **可能无效**，需要进行适配或修改。

**投毒风险：**
该 POC 脚本本身非常简单，只包含发送 HTTP 请求并打印响应的功能。其中 `User-Agentt` 的拼写错误可能是一个隐藏的混淆手段，但总体来看，**投毒风险较低**。主要是代码结构简单。投毒风险评估为10%。

**利用方式：**
利用方式总结如下：
1.  目标系统必须使用 Nginx 作为前端服务器，并且启用了 PHP-FPM。
2.  Nginx 的配置需要存在缺陷，例如没有正确检查文件是否存在就将请求传递给 PHP-FPM。
3.  攻击者通过构造特殊的 URL，利用 `env_path_info` underflow 漏洞覆盖 FPM 缓冲区。
4.  攻击者在覆盖的缓冲区中注入恶意代码，从而实现远程代码执行。 这种利用方式需要精确控制 URL 的长度和注入的数据，因此具有一定的复杂性。

**项目地址:** [bayazid-bit/CVE-2019-11043-](https://github.com/bayazid-bit/CVE-2019-11043-)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #7

**来源**: [CVE-2019-11043-corifeo_CVE-2019-11043.md](../2019/CVE-2019-11043-corifeo_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要PHP-FPM以特定配置运行在Nginx服务器上，且Nginx配置不正确，未检查文件是否存在就传递给PHP-FPM。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM中的缓冲区下溢漏洞，当PHP-FPM以特定配置运行在Nginx服务器上时，可能导致远程代码执行。漏洞的根本原因在于`env_path_info`的处理。如果Nginx配置不正确，未对请求的文件进行存在性检查就传递给PHP-FPM，攻击者可以利用该漏洞覆盖FCGI协议数据，从而实现RCE。提供的POC代码通过构造特殊的URL和Header，尝试触发缓冲区下溢，并利用`session.auto_start`来执行PHP代码。 

**有效性：** 根据漏洞信息和搜索结果，提供的POC代码（`CVE-2019-11043.py`）是有效的，可以利用该漏洞在满足特定条件的环境中实现远程代码执行。多个搜索结果提到了该漏洞的严重性，并提供了利用分析和缓解措施。

**投毒风险：** 分析了提供的POC代码（`CVE-2019-11043.py`和`README.md`），没有发现作者隐藏的恶意或投毒代码。代码的目的是利用漏洞进行远程代码执行测试。因此投毒风险为0%。

**利用方式：**

1.  **确定目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为Web服务器。
2.  **Nginx配置检查：** 检查Nginx的配置，确认是否会将不存在的文件传递给PHP-FPM处理，这是漏洞利用的前提。
3.  **查找合适的URL长度：** POC代码首先会探测可能存在漏洞的URL长度，通过发送带有特定长度`Q`参数的请求，判断服务器的响应状态。
4.  **覆盖FCGI协议数据：**  利用缓冲区下溢漏洞，覆盖FCGI协议数据，尤其是控制`PHP_VALUE`参数。
5.  **设置`session.auto_start`：** 通过`PHP_VALUE`设置`session.auto_start=1`，使PHP自动启动session，并执行session数据中的PHP代码。
6.  **发送恶意请求：** 发送包含恶意PHP代码的请求，例如写入Web Shell或执行系统命令。
7.  **执行RCE：**  成功利用后，攻击者可以在服务器上执行任意代码。

**项目地址:** [corifeo/CVE-2019-11043](https://github.com/corifeo/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #8

**来源**: [CVE-2019-11043-fairyming_CVE-2019-11043.md](../2019/CVE-2019-11043-fairyming_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM (与 Nginx 结合)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，且配置不当，将请求传递给 PHP-FPM。nginx配置不当，没有检查文件是否存在

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定配置下（通常与 Nginx 一起使用）由于 env_path_info 处理不当造成的缓冲区下溢漏洞。当 Nginx 没有正确配置以检查文件是否存在的情况下，攻击者可以通过构造特定的 URL，利用该漏洞向 PHP-FPM 发送恶意的 query string length（QSL）值和 D-Pisos header。这些值导致缓冲区下溢，允许攻击者覆盖 FCGI 协议数据，进而执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的 PoC 代码，该漏洞利用是有效的。搜索结果中多个链接（例如，Trend Micro, NVD, Qualys, Tenable, Orange Tsai 的博客）都确认了该漏洞的存在和可利用性。提供的 PoC 代码似乎旨在自动化利用此漏洞的过程，包括查找正确的 QSL 和 pisos 值，然后发送恶意请求。

**投毒风险：**
该仓库可能存在轻微的投毒风险，概率估计为 10%。风险主要来自以下几个方面：
1.  **依赖关系：** PoC 使用了`pocsuite`框架，这本身需要安装额外的依赖。 虽然pocsuite本身是一个漏洞利用框架，降低了其被投毒的可能性。但是，不排除引入的依赖项可能存在潜在的恶意代码或后门。
2.  **复杂性：** 该漏洞的利用过程较为复杂，涉及多个步骤，包括探测、参数调整和攻击执行。攻击者可能在这些步骤中插入难以察觉的恶意代码。
3.  **模糊处理：** 虽然代码本身相对清晰，但一些变量名（例如 `D-Pisos`）和注释可能包含不明显的恶意行为。

需要注意的是，这里指的是代码本身被植入恶意代码的可能性。PoC 本身的目的就是为了利用漏洞，因此它必然会包含一些“恶意”的操作，但这些操作是为了验证漏洞，而不是为了进行投毒。

**利用方式：**
1.  **探测目标环境：** PoC 首先尝试确定目标 PHP-FPM 服务的状态码，建立基线。
2.  **查找合适的 QSL 值：** 通过发送带有不同长度 query string 的请求，PoC 尝试找到导致状态码改变的 QSL 值。这些值是潜在的攻击参数。
3.  **Sanity Check:** PoC 通过发送大量请求来验证目标是否容易被攻击，以此来保证后续利用的成功率
4.  **确定 pisos 值：** 通过 socket 连接，PoC 发送构造的 HTTP 请求，该请求包含精心设计的 `D-Pisos` header。不同的 pisos 值会导致不同的内存覆盖效果。PoC 尝试不同的 pisos 值，直到成功设置 `session.auto_start` 并获取 PHPSESSID。
5.  **远程代码执行：** 一旦找到正确的 QSL 和 pisos 值，攻击者就可以利用缓冲区下溢覆盖 FCGI 协议数据，设置 `session.auto_start=1` 或者其他php配置，进而执行任意代码。


**项目地址:** [fairyming/CVE-2019-11043](https://github.com/fairyming/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---



---

## POC #9

**来源**: [CVE-2019-11043-huowen_CVE-2019-11043.md](../2019/CVE-2019-11043-huowen_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx作为前端服务器，配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞。该漏洞存在于当Nginx作为前端服务器时，如果配置不当，攻击者可以通过构造特殊的请求，利用PHP-FPM中的缓冲区溢出漏洞，覆盖FCGI协议数据，从而执行任意代码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。漏洞库信息中明确指出该漏洞可以导致远程代码执行，并给出了github链接（https://github.com/neex/phuip-fpizdam）包含利用代码。搜索引擎结果也确认了该漏洞的存在和利用方式，并指出受影响的版本和配置。

提供的POC代码`main.py`通过调用`detect.py`来检测目标是否存在漏洞，并自动计算利用所需的参数。 如果成功检测到漏洞，将允许执行任意命令。

**投毒风险：**

分析POC代码后，投毒风险较低，约为10%。 风险主要来自以下几个方面：

1.  **依赖风险：** 代码依赖`requests`库，如果requests库被篡改，可能引入恶意代码。
2.  **命令执行风险：** 成功利用漏洞后，可以通过`?a=/usr/bin/yourcommand`执行命令，如果执行恶意命令，可能对系统造成危害。**（但这属于漏洞本身利用的范畴，而非代码投毒）**
3.  **临时文件：** 代码会在`/tmp/`目录下创建临时文件（例如`/tmp/a`），尽管代码中尝试清理，但可能存在清理不彻底的情况。

综上，虽然存在一定的风险，但主要集中在使用漏洞利用后的命令执行方面，POC代码本身的投毒风险较低。

**利用方式：**

利用该漏洞的步骤如下：

1.  **环境确认：** 确保目标系统运行着受影响版本的PHP-FPM，并使用Nginx作为前端服务器。
2.  **漏洞检测：** 运行`main.py -u <目标URL>`，POC会自动检测目标是否存在漏洞，并计算利用所需的参数 (QueryStringLength和PisosLength)。
3.  **参数配置：** POC自动修改`session.auto_start`的值，为利用做准备。
4.  **命令执行：**  如果检测成功，可以通过在URL中添加`?a=<命令>`来执行任意命令。例如 `?a=/usr/bin/id`。
5.  **清理：** 利用完毕后,POC会尝试清理临时文件，但建议手动检查/tmp目录，确保没有残留文件。

**项目地址:** [huowen/CVE-2019-11043](https://github.com/huowen/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #10

**来源**: [CVE-2019-11043-ianxtianxt_CVE-2019-11043.md](../2019/CVE-2019-11043-ianxtianxt_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM，配置中包含 `fastcgi_split_path_info` 且未正确配置 `try_files` 或 `if (-f $uri)`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下的远程代码执行漏洞。当 Nginx 使用 `fastcgi_split_path_info` 指令分割 URI 时，如果 URI 中包含 \n (%0a) 字符，可能导致 `PATH_INFO` 为空。PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在逻辑缺陷，允许攻击者通过精心构造的请求，覆盖 FCGI 协议数据，进而执行任意代码。

**漏洞利用方式：**

1.  攻击者发送包含 %0a 字符的恶意 HTTP 请求，例如 `index.php%0a`。
2.  Nginx 使用 `fastcgi_split_path_info` 指令分割 URI，导致 `PATH_INFO` 为空。
3.  PHP-FPM 在处理 `PATH_INFO` 为空的情况时，发生缓冲区溢出，覆盖 FCGI 协议数据。
4.  攻击者通过覆盖的 FCGI 数据，可以控制 PHP-FPM 的行为，例如执行系统命令。

**有效性：**

提供的 POC 代码（`phuip-fpizdam`）是有效的。它利用了上述漏洞，可以在满足条件的 Nginx + PHP-FPM 环境中实现远程代码执行。

**投毒风险：**

README.md描述了漏洞原理和修复方法，`./phuip-fpizdam http://192.168.93.131:8080/index.php`命令是正常的漏洞利用方式。内涵两个exp一个是go语言，另一个是编译好的exp，说明作者提供了源码，风险较低。仍然存在一定的投毒风险，因为编译好的二进制文件可能包含未公开的恶意行为。因此，保守估计投毒风险为10%。攻击者可能会在编译好的 exp 中添加后门，例如反弹 shell 或植入恶意代码。用户在使用时，最好自行编译go源码。

**项目地址:** [ianxtianxt/CVE-2019-11043](https://github.com/ianxtianxt/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #11

**来源**: [CVE-2019-11043-jas502n_CVE-2019-11043.md](../2019/CVE-2019-11043-jas502n_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致远程代码执行

**影响应用:** PHP-FPM (搭配 Nginx)

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，将请求传递给 PHP-FPM 处理；Nginx 配置不当，未对请求的文件进行有效性检查（如`try_files $uri =404`）；目标使用了受影响的 PHP 版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 存在于 PHP-FPM 中，当与 Nginx 配合使用时，不正确的配置会导致缓冲区下溢，从而允许远程代码执行。攻击者可以构造特定的请求，利用 env_path_info 的处理缺陷，导致 FPM 模块将数据写入为 FCGI 协议数据保留的空间之外，造成内存破坏，最终执行任意代码。

**有效性评估：**
提供的 POC 代码（`phuip-fpizdam`）是一个已知的、公开可用的漏洞利用工具，专门用于攻击 CVE-2019-11043。从 README.md 可以看出，该工具使用 Go 语言编写，可以直接编译使用，或者使用 Docker 部署测试环境。文档中展示了工具的安装、使用方法和效果，可以验证漏洞的存在，因此 POC 代码有效。

**投毒风险分析：**
该仓库主要包含以下内容：
1.  `phuip-fpizdam` 工具的安装和使用说明。
2.  使用 Docker 搭建漏洞环境的示例。
3.  一个简单的 PHP 脚本（index.php）用于测试。
4.  一个 `php-rce-check.py` 脚本，用于检测目标是否易受攻击。

虽然该仓库本身是为了复现和利用漏洞，但不能完全排除投毒的风险。其中`php-rce-check.py`脚本通过构造特殊请求，检测服务器是否存在漏洞，存在一定风险，可能服务器信息泄露。虽然整体投毒概率较低，但仍应保持警惕，尤其是在生产环境中使用这些代码时。考虑到该漏洞的利用已经有较为成熟的工具，因此恶意作者在其中隐藏恶意代码的可能性相对较小。风险评估占比为10%。

**利用方式：**
1.  **环境准备：**搭建存在漏洞的 PHP-FPM 和 Nginx 环境。
2.  **检测：** 使用 `php-rce-check.py` 脚本或 `phuip-fpizdam` 工具的 `--only-qsl` 选项检测目标是否易受攻击。
3.  **利用：** 如果目标存在漏洞，使用 `phuip-fpizdam` 工具发送特制的 HTTP 请求，利用缓冲区溢出执行任意代码。
4.  **反弹 Shell：** 在成功执行代码后，通常会反弹一个 shell，从而控制服务器。

整个漏洞利用的关键在于构造特殊的请求，触发 PHP-FPM 的缓冲区溢出。

**项目地址:** [jas502n/CVE-2019-11043](https://github.com/jas502n/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #12

**来源**: [CVE-2019-11043-jas9reet_CVE-2019-11043.md](../2019/CVE-2019-11043-jas9reet_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx + PHP-FPM，特定配置。 主要是nginx没有校验文件是否存在就传递给了php-fpm处理。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，存在于特定配置下的 Nginx + PHP-FPM 环境中。漏洞原因是 PHP-FPM 在处理 PATH_INFO 时存在缺陷，导致可以覆盖FCGI协议的数据，利用方法如下：

1.  **漏洞原理：** PHP-FPM 在处理 `PATH_INFO` 时，如果 Nginx 配置不当，会将 URL 中多余的部分作为 `PATH_INFO` 传递给 PHP-FPM。攻击者可以构造恶意的 `PATH_INFO`，触发 PHP-FPM 的缓冲区下溢漏洞，覆盖 FCGI 协议的数据，最终导致远程代码执行。

2.  **漏洞影响：**  受影响的版本包括 PHP 7.1.x (低于 7.1.33), 7.2.x (低于 7.2.24), 和 7.3.x (低于 7.3.11)。该漏洞需要特定的 Nginx + PHP-FPM 配置才能触发，即 Nginx 没有对请求的文件进行严格的校验，直接将请求传递给 PHP-FPM 处理。

3.  **漏洞利用：**
    a.  **环境搭建：** 使用 `docker-compose.yml` 文件搭建漏洞环境，其中包括 Nginx 和 PHP-FPM。
    b.  **漏洞验证：** 使用 `CVE-2019-11043-Checker.py` 脚本验证目标是否存在漏洞。该脚本通过发送带有特殊构造的 `PATH_INFO` 的 HTTP 请求，检测服务器是否返回 502 错误。如果返回 502 错误，则可能存在漏洞。
    c.  **漏洞利用：** 实际利用需要进一步构造特定的 payload 以实现远程代码执行，这部分代码未包含在提供的文件中，但可以参考 `https://github.com/neex/phuip-fpizdam`。

4.  **投毒风险分析：**
    a.  `README.md`、`default.conf`、`docker-compose.yml`、`www/index.php` 这些文件主要是环境搭建和简单的页面展示，没有发现恶意代码。
    b.  `exploit/CVE-2019-11043-Checker.py` 脚本的功能是检测漏洞是否存在，没有发现后门或者恶意代码，但是存在被滥用的风险，被攻击者用以探测内网。
    c.  综合来看，该仓库的投毒风险较低，脚本本身只是漏洞检测工具，但是从长远来看，存在被攻击者利用的风险。

5.  **结论：**  提供的 POC 代码可以有效检测漏洞是否存在。投毒风险较低，脚本本身不包含恶意代码，但存在被滥用的可能性。利用方式为构造恶意的 PATH_INFO，触发 PHP-FPM 的缓冲区下溢漏洞，实现远程代码执行。

**项目地址:** [jas9reet/CVE-2019-11043](https://github.com/jas9reet/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #13

**来源**: [CVE-2019-11043-jptr218_php_hack.md](../2019/CVE-2019-11043-jptr218_php_hack.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** PHP-FPM 使用 Nginx，且 Nginx 配置不当。攻击者需要能够发送特制的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞，它源于 PHP-FPM 在处理 `env_path_info` 时的 underflow 缺陷。该漏洞仅影响使用 Nginx 作为反向代理且配置不当的 PHP-FPM 环境。攻击者通过构造特定的 URL，可以导致 FPM 模块写入超出分配缓冲区的数据，覆盖 FCGI 协议数据，从而实现远程代码执行。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否使用了 Nginx + PHP-FPM 架构，并且存在漏洞。
2.  通过发送包含特殊构造的 PATH_INFO 的 HTTP 请求，触发 PHP-FPM 的 underflow 漏洞。
3.  攻击者可以控制写入的数据，覆盖 FCGI 协议数据，进而执行任意 PHP 代码，最终控制服务器。

**POC 分析：**

提供的 POC 代码是一个 C++ 程序，用于自动化 CVE-2019-11043 的利用过程。该程序首先确定目标服务器的 QSL (Query String Length) 和 header length，然后发送一系列包含恶意 PHP 配置指令的 HTTP 请求，这些配置指令会将任意代码写入 error log 文件，然后通过 extension 加载执行 error log 的方式执行代码。

**投毒风险分析：**

尽管代码本身实现了漏洞利用，但是`php_hack.exe`是一个二进制文件，存在被替换成恶意文件的风险，如果原作者提供了其他恶意链接，存在比较大的投毒风险。代码中通过`extension=%22$_GET%5Ba%5D%60%3F%3E%22`设置，使得攻击者可以通过GET参数a执行任意代码，存在后门， 但是这是漏洞验证的必然步骤，不能算是仓库作者植入的投毒代码。基于此, 判定仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [jptr218/php_hack](https://github.com/jptr218/php_hack)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #14

**来源**: [CVE-2019-11043-k8gege_CVE-2019-11043.md](../2019/CVE-2019-11043-k8gege_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要nginx作为前端，并且配置不当，将请求传递给PHP-FPM

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-11043是一个PHP-FPM的远程代码执行漏洞，当PHP-FPM与Nginx配合使用时，如果Nginx配置不当，攻击者可以通过构造特定的URL，利用env_path_info的underflow缺陷，覆盖FPM模块的内存，从而执行任意代码。

**有效性：**
提供的POC代码看起来是有效的。POC通过发送包含\n的特殊构造的URL，并尝试不同的K长度，来触发502错误，如果成功触发，则表明存在CVE-2019-11043漏洞。

**投毒风险：**
分析提供的文件，包括Python脚本（CVE-2019-11043-POC.py）、配置文件（CVE-2019-11043_POC.ini）、LICENSE和README.md，没有发现任何明显的恶意代码或后门。该Python脚本主要是用于检测目标URL是否存在CVE-2019-11043漏洞，其行为符合漏洞利用的预期。因此，评估认为该仓库中作者隐藏投毒代码的风险较低，为0%。

**利用方式：**
利用方式如下：
1.  **目标环境：** 目标服务器必须运行PHP-FPM，并且使用Nginx作为前端。
2.  **错误配置：** Nginx必须存在配置错误，即将URI传递给PHP-FPM，而不是首先检查文件是否存在（例如，缺少`try_files $uri =404;`指令）。
3.  **构造Payload：** 攻击者构造包含换行符（%0a）的特定URL，例如`url + "/PHP%0Ais_poc_thistiest_lang.php?" + "K" * i`，其中`i`是精心选择的长度。
4.  **触发Underflow：** 构造的URL会触发`env_path_info`的underflow，导致PHP-FPM覆盖其内部数据结构。
5.  **远程代码执行：** 通过覆盖特定的内存区域，攻击者可以控制PHP-FPM的行为，最终执行任意代码。

**总结：** 该漏洞允许未经身份验证的远程攻击者在目标服务器上执行任意代码，前提是目标服务器满足特定的配置要求。

**项目地址:** [k8gege/CVE-2019-11043](https://github.com/k8gege/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #15

**来源**: [CVE-2019-11043-kriskhub_CVE-2019-11043.md](../2019/CVE-2019-11043-kriskhub_CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM 配置，且 Nginx 配置中存在 fastcgi_split_path_info 指令，未对文件存在性进行校验。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 在特定 Nginx 配置下由于 env_path_info 处理不当导致的缓冲区下溢漏洞，可以造成远程代码执行。

**漏洞有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确认此漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞存在远程代码执行的可能，并链接到了 `https://github.com/neex/phuip-fpizdam`，该链接指向的正是可以利用此漏洞的exploit。
搜索引擎结果也显示了该漏洞可以导致远程代码执行，并且在野利用已经存在。
提供的漏洞利用代码包含 Docker 镜像配置（nginx@latest, php-fpm@7.2.10）和 Python 脚本，并且提供了详细的利用方法和分析，进一步证实了该漏洞利用代码的有效性。

**投毒风险：**
分析POC代码，发现投毒的风险较低，约为 5%。主要考虑以下几点：
1.  **代码功能明确：**  Python 脚本的主要功能是发送特制的 HTTP 请求，利用 PHP-FPM 的漏洞执行代码。虽然执行恶意代码是既定的，但脚本本身没有明显的隐藏恶意行为。
2.  **公开的利用方式：**  该漏洞的利用方法和原理已经被广泛公开，如果代码中存在隐藏的恶意行为，很容易被发现。
3.  **依赖 Docker 环境：**  POC 需要在特定的 Docker 环境下运行，这增加了攻击者修改 Dockerfile 或其他配置以进行投毒的难度。
4. 少量风险来源于依赖的docker镜像，理论上存在被投毒的可能性。

**利用方式：**
1.  **触发缓冲区下溢：**  攻击者通过构造包含换行符（`%0A`）的 URL，绕过 `fastcgi_split_path_info` 指令的正则匹配，导致 `PATH_INFO` 为空。
2.  **控制 `path_info` 指针：** 通过精心构造 URL 的长度，攻击者可以使 `path_info` 指针指向 `_fcgi_data_seg` 结构体的起始位置。
3.  **覆盖 FCGI 变量：**  通过向 `path_info` 写入数据，覆盖 `_fcgi_data_seg` 结构体，包括其他 FastCGI 变量。
4.  **伪造 `PHP_VALUE`：**  攻击者可以伪造 `PHP_VALUE` FCGI 变量，设置恶意的 PHP 配置选项。
5.  **远程代码执行：** 通过设置 `PHP_VALUE` 中的配置选项，如 `allow_url_include` 和 `auto_prepend_file`，攻击者可以包含远程文件，最终实现远程代码执行。

简单来说, Nginx将请求传递给PHP-FPM, 由于Nginx配置不当, 允许攻击者通过特定格式的URL触发PHP-FPM的缓冲区溢出, 覆盖内存中的数据, 从而执行任意代码.

**项目地址:** [kriskhub/CVE-2019-11043](https://github.com/kriskhub/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #16

**来源**: [CVE-2019-11043-lindemer_CVE-2019-11043.md](../2019/CVE-2019-11043-lindemer_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx 作为前端，配置不当，将请求传递给 PHP-FPM 处理

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞。当 Nginx 配置不正确时，恶意请求可以通过 FastCGI 协议发送给 PHP-FPM。漏洞的根本原因是 PHP-FPM 在处理包含换行符的 URI 时，`path_info` 长度计算错误，导致缓冲区下溢。攻击者可以通过精心构造的 URI，覆盖 FastCGI 内部的数据结构，例如环境变量。通过覆盖环境变量，攻击者可以插入任意 PHP 变量，最终实现远程代码执行。

**利用方式：**

1.  利用 Nginx 配置不当，允许恶意请求传递给 PHP-FPM。
2.  构造包含换行符（`%0a`）的 URI，触发 `path_info` 长度计算错误。
3.  通过控制 URI 的长度，精确地覆盖 FastCGI 内部的数据结构，例如 `SCRIPT_FILENAME`。
4.  覆盖 `SCRIPT_FILENAME` 为恶意 PHP 代码，或使用其他方法执行任意代码。
5.  发送请求，触发恶意代码执行。

**有效性：**

提供的漏洞利用代码是有效的，它复现了该漏洞，并允许远程代码执行。

**投毒风险：**

该仓库中存在一定投毒风险，但概率较低。风险点在于 exploit.py 可能被修改,加入恶意代码. 通过review README.md,发现漏洞原理分析比较清晰,且给出了其他学习资料链接,具有参考价值. 综合评估,投毒风险为 10%。

**项目地址:** [lindemer/CVE-2019-11043](https://github.com/lindemer/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #17

**来源**: [CVE-2019-11043-moniik_CVE-2019-11043_env.md](../2019/CVE-2019-11043-moniik_CVE-2019-11043_env.md)

## CVE-2019-11043 PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区下溢

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，特别是 `fastcgi_split_path_info` 和 `PATH_INFO` 的使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的 Dockerfile 等文件，该漏洞 (CVE-2019-11043) 是 PHP-FPM 中的一个缓冲区下溢漏洞，可能导致远程代码执行。该漏洞影响特定版本的 PHP-FPM，并且需要 Nginx 的配合，特别是涉及到 `fastcgi_split_path_info` 和 `PATH_INFO` 的配置。漏洞的根源在于 PHP-FPM 在处理 `PATH_INFO` 时，可能计算错误，导致缓冲区下溢。 

**有效性：**
提供的 Dockerfile 和相关配置文件旨在搭建一个易于调试的漏洞环境。`docker-compose.yml` 允许通过端口 8080 访问 Nginx，通过 55555 端口使用 GDB 调试 PHP-FPM。 `entrypoint.sh` 启动 Nginx 和 PHP-FPM，并使用 GDB 附加到 PHP-FPM 进程，便于进行调试和漏洞利用验证。整体上是为了复现漏洞，利用的有效性很高。

**投毒风险：**
分析提供的文件，并未发现明显的恶意代码。`script.php` 只是简单地输出 `$_SERVER` 变量，用于调试和验证配置。`nginx.server.conf` 是标准的 Nginx 配置文件，用于将 PHP 请求转发到 PHP-FPM。 `php-fpm.conf` 是 PHP-FPM 的配置文件，配置了错误日志和进程管理。`README.md`只是一个简单的描述文件,`share/blank`是一个空文件,没有实际作用.Dockerfile 只是构建漏洞环境。因此，投毒的可能性较低，但是仍需谨慎，因为在构建复杂环境时，可能会引入不易察觉的恶意代码，所以投毒风险评估为10%。

**利用方式：**
利用方式主要围绕控制`PATH_INFO`变量。攻击者通过构造特殊的 URL，可以触发 PHP-FPM 中的缓冲区下溢，覆盖 FCGI 协议数据。进一步地，攻击者可以利用此覆盖来执行任意代码。 具体利用涉及对 Nginx 配置和 PHP-FPM 内部机制的深入理解。 通常，利用需要精心构造的 URL，利用 `fastcgi_split_path_info` 指令分割 URL，并控制 `PATH_INFO` 的值，以触发缓冲区下溢。参考[https://github.com/neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam), 该项目提供了具体的利用代码。


**项目地址:** [moniik/CVE-2019-11043_env](https://github.com/moniik/CVE-2019-11043_env)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #18

**来源**: [CVE-2019-11043-neex_phuip-fpizdam.md](../2019/CVE-2019-11043-neex_phuip-fpizdam.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx + PHP-FPM 配置，且 Nginx 配置不当（如缺少 try_files 检查）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当与 Nginx 结合使用时，如果 Nginx 配置不正确，可能导致远程代码执行。具体来说，该漏洞是由于 `env_path_info` 处理中的 underflow 导致的。攻击者可以通过构造特定的请求，利用 `fastcgi_split_path_info` 指令中的正则表达式缺陷，使得 `PATH_INFO` 变量为空，触发缓冲区溢出，覆盖 FCGI 协议数据，最终实现远程代码执行。

**漏洞利用方式：**

1.  利用 `fastcgi_split_path_info` 的缺陷，通过在 URL 中注入换行符等字符，使 `PATH_INFO` 为空。
2.  利用缓冲区溢出覆盖 FCGI 协议数据，修改 PHP 配置，例如设置 `session.auto_start=0`。
3.  通过 `?a=<command>` 方式执行任意命令。

**关于投毒风险：**

查看提供的 exploit 代码仓库 `https://github.com/neex/phuip-fpizdam`，其中包含 Go 语言编写的漏洞利用程序。虽然该代码已经公开，且被广泛使用，但仍然存在一定的投毒风险。例如，攻击者可能修改该代码，添加恶意功能，例如植入后门、窃取敏感信息等。考虑到该漏洞利用的复杂性，以及对目标环境的特殊要求，投毒风险评估为10%。

**项目地址:** [neex/phuip-fpizdam](https://github.com/neex/phuip-fpizdam)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #19

**来源**: [CVE-2019-11043-shadow-horse_cve-2019-11043.md](../2019/CVE-2019-11043-shadow-horse_cve-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行漏洞

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** Nginx + PHP-FPM配置，存在fastcgi_split_path_info指令，缺少文件存在性检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 是一个 PHP-FPM 的远程代码执行漏洞。当 Nginx 配置不当时，攻击者可以通过发送特制的请求，利用 PHP-FPM 中的缓冲区溢出漏洞，执行任意代码。

**漏洞原理：**

该漏洞的核心在于 `fastcgi_split_path_info` 指令在处理包含换行符（`%0a`）的请求时，会导致 `PATH_INFO` 变量为空。而 PHP-FPM 在处理 `PATH_INFO` 为空的情况时存在缺陷，导致可以覆盖 FCGI 协议数据，从而实现远程代码执行。

**漏洞利用方式：**

1.  攻击者构造包含换行符的恶意 URL，例如 `index.php%0a`。
2.  Nginx 将该请求传递给 PHP-FPM。
3.  PHP-FPM 处理该请求时，由于 `PATH_INFO` 为空，触发漏洞。
4.  攻击者通过精心构造的请求数据，覆盖 FCGI 协议数据，执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的 POC 代码是有效的。该漏洞已经被公开利用，并且在某些特定配置下很容易被触发。

**投毒风险：**

该 POC 的主要功能是利用漏洞执行命令，本身不包含恶意代码。但考虑到代码的复杂性，以及攻击者可能修改代码以达到恶意目的，存在一定的投毒风险。初步评估投毒风险为10%。

**利用方式总结：**

该漏洞的利用方式是构造包含换行符的恶意 URL，触发 PHP-FPM 中的缓冲区溢出漏洞，覆盖 FCGI 协议数据，从而执行任意代码。利用条件是 Nginx + PHP-FPM 配置，存在 `fastcgi_split_path_info` 指令，并且缺少文件存在性检查，例如缺少 `try_files` 指令。


**项目地址:** [shadow-horse/cve-2019-11043](https://github.com/shadow-horse/cve-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #20

**来源**: [CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md](../2019/CVE-2019-11043-theMiddleBlue_CVE-2019-11043.md)

## CVE-2019-11043 - PHP-FPM 远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出

**影响应用:** PHP-FPM (结合 Nginx)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要 Nginx 作为前端，配置不当，将请求传递给 PHP-FPM，并存在 `env_path_info` 下溢漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是一个 PHP-FPM 的缓冲区溢出漏洞，存在于 `fpm_main.c` 文件中的 `env_path_info` 处理逻辑中。当 Nginx 配置不正确时，攻击者可以利用此漏洞实现远程代码执行。

**利用方式：**

1.  **构造恶意请求：** 攻击者通过构造特殊的 URL，利用 `env_path_info` 下溢漏洞。
2.  **缓冲区溢出：**  精心设计的请求会导致 PHP-FPM 在处理 FastCGI 协议数据时，写入超出分配缓冲区范围的数据。
3.  **远程代码执行：** 通过溢出，覆盖 FCGI 协议数据，进而控制 PHP-FPM 进程，执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的 POC 代码，可以确认该漏洞是真实存在的，并且存在可利用的 POC 代码。多个安全厂商和研究人员都对此漏洞进行了分析和复现。

提供的 POC 代码 `exploit.py` 主要步骤如下：

1.  **探测 QSL (Query String Length)：** 脚本首先通过发送一系列不同长度的请求，探测能够触发 500 错误（服务器内部错误）的 QSL 范围。这是为了找到合适的请求长度，以便利用缓冲区溢出漏洞。
2.  **利用漏洞设置 PHP 配置：** 一旦找到合适的 QSL，脚本就会发送带有 `PHP_VALUE` 的请求，尝试修改 PHP 的配置选项，例如 `session.auto_start`。这是利用该漏洞的关键步骤，攻击者通过覆盖某些变量，最终可以执行任意 PHP 代码。
3.  **远程代码执行：** 在成功设置 PHP 配置后，攻击者可以利用修改后的配置执行任意命令。POC 代码中使用了 `extension` 设置来执行命令。

**投毒风险评估：**

分析 POC 代码后，发现存在一定的投毒风险，约 10%。风险主要体现在：

1.  **隐蔽的 PHP 设置：** POC 利用了 `PHP_VALUE` 来修改 PHP 的配置，这些配置可能包含一些隐蔽的后门，例如设置 `auto_prepend_file` 或 `auto_append_file` 来包含恶意代码。
2.  **依赖外部资源：** 虽然 POC 没有直接包含恶意代码，但是它可能会依赖服务器上的其他文件或资源，这些文件或资源可能被替换为恶意代码。
3.  **复杂逻辑：** POC 的代码逻辑比较复杂，攻击者可能会在其中插入一些难以察觉的恶意代码，例如在 `requests.get` 中添加一些额外的参数或头部，将敏感数据发送到远程服务器。

**总体评估：**

该漏洞的利用难度较高，需要对 Nginx 和 PHP-FPM 的配置以及 FastCGI 协议有一定的了解。但是，一旦成功利用，攻击者可以完全控制服务器，造成严重的危害。

**防范建议：**

1.  **升级 PHP 版本：** 升级到不受此漏洞影响的 PHP 版本。
2.  **正确配置 Nginx：** 确保 Nginx 配置正确，防止将恶意请求传递给 PHP-FPM。可以使用 `try_files` 或 `if (-f $uri)` 等指令来检查目标文件是否存在。
3.  **WAF 防护：** 使用 Web 应用防火墙 (WAF) 来检测和阻止利用此漏洞的攻击。

**项目地址:** [theMiddleBlue/CVE-2019-11043](https://github.com/theMiddleBlue/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #21

**来源**: [CVE-2019-11043-tinker-li_CVE-2019-11043.md](../2019/CVE-2019-11043-tinker-li_CVE-2019-11043.md)

## CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 缓冲区溢出导致的远程代码执行

**影响应用:** PHP-FPM (与 Nginx 配合使用)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHP 7.1.x (< 7.1.33), 7.2.x (< 7.2.24), 7.3.x (< 7.3.11)

**利用条件:** 需要特定的 Nginx + PHP-FPM 配置，即存在 'try_files $uri =404' 或 'if (-f $uri)' 的错误配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞是 PHP-FPM 中的一个缓冲区下溢漏洞，当 PHP-FPM 与 Nginx 配合使用，并且 Nginx 配置不当（例如，未使用 `try_files` 指令正确检查文件是否存在）时，攻击者可以通过构造恶意的请求，导致 PHP-FPM 在写入 FCGI 协议数据时超出分配的缓冲区，从而可能实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响特定版本的 PHP-FPM。漏洞利用代码 `https://github.com/neex/phuip-fpizdam/` 是公开可用的，证明了漏洞的可利用性。大量搜索结果也验证了此漏洞的存在和危害。

**投毒风险：**
提供的漏洞利用代码仅包含官方更新通告和开源社区介绍的链接，本身不包含任何可疑代码。但是，任何时候使用第三方提供的利用代码都存在潜在风险，例如，攻击者可能在代码中植入后门。因此，存在一定的投毒风险，粗略估计大约为10%。使用前应仔细审查代码。

**利用方式：**
1.  **目标确认：** 确定目标服务器运行着受影响版本的 PHP-FPM，并且使用了存在缺陷的 Nginx 配置。
2.  **构造恶意请求：** 攻击者构造包含特定长度查询字符串的 URL，利用 PHP-FPM 的 `env_path_info` 处理过程中的下溢漏洞。
3.  **缓冲区溢出：**  通过精心设计的请求，覆盖 FCGI 协议数据，控制部分 FPM 进程的内存。
4.  **远程代码执行：**  最终目标是利用内存覆盖，执行任意代码，从而控制服务器。具体方法可能包括覆盖关键函数指针等。
5.  **phuip-fpizdam工具:** `phuip-fpizdam`工具可以自动化构造恶意请求，并尝试利用该漏洞。

**项目地址:** [tinker-li/CVE-2019-11043](https://github.com/tinker-li/CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

## POC #22

**来源**: [CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md](../2019/CVE-2019-11043-ypereirareis_docker-CVE-2019-11043.md)

## CVE-2019-11043 PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043

**漏洞类型:** 远程代码执行

**影响应用:** PHP-FPM

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11

**利用条件:** Nginx配置不当，将请求传递给存在漏洞的PHP-FPM实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-11043 漏洞存在于 PHP-FPM 中，当 PHP-FPM 与 Nginx 结合使用且 Nginx 配置不正确时，可能导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码（Dockerfile），可以判断该漏洞的POC代码是有效的。漏洞利用代码中的Dockerfile构建了一个包含`phuip-fpizdam`工具的Docker镜像，该工具专门用于检测和利用 CVE-2019-11043 漏洞。

**投毒风险：**
Dockerfile 本身仅仅是用于安装和运行已知的漏洞利用工具，没有发现作者隐藏的恶意代码。
`phuip-fpizdam` 工具的目的是检测目标是否存在漏洞，并尝试利用它来执行命令。该工具本身可能会对目标系统造成损害，但这不属于投毒行为，而是漏洞利用的正常结果。
`tests.sh`文件用于构建和运行 docker 镜像，没有发现额外的恶意行为。
虽然该工具本身可能存在其他未知的安全问题，但就当前提供的代码来看，投毒风险较低, 评估为10%。这个风险评估主要基于以下几点：
1. Dockerfile 包含了从外部仓库下载代码的操作 (`go get github.com/neex/phuip-fpizdam`)，如果该仓库被篡改，可能导致镜像中包含恶意代码。
2. `phuip-fpizdam` 工具本身的代码没有进行详细审查，可能存在未知的漏洞或后门。

**利用方式：**
利用方式主要通过构造畸形的请求，触发 PHP-FPM 中的 env_path_info 下溢漏洞。具体步骤如下：
1.  构造特殊的URL，导致 `env_path_info` 的长度计算错误，从而发生缓冲区下溢。
2.  缓冲区下溢允许攻击者覆盖 FPM 分配的内存，包括 FCGI 协议数据。
3.  通过覆盖 FCGI 协议数据，可以修改请求的处理方式，例如，设置 `php.ini` 中的配置选项，从而允许执行任意代码。
4.  攻击者可以通过在 URL 中附加参数来执行系统命令，例如 `?a=/bin/sh+-c+'whoami'`。工具会自动检测QSL参数并攻击，或者可以通过手动指定参数。

**总结：**
CVE-2019-11043 是一个严重的安全漏洞，攻击者可以在未经授权的情况下远程执行代码。由于漏洞利用的复杂性（需要特定的 Nginx 和 PHP-FPM 配置），攻击难度为高。

**项目地址:** [ypereirareis/docker-CVE-2019-11043](https://github.com/ypereirareis/docker-CVE-2019-11043)

**漏洞详情:** [CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

---

