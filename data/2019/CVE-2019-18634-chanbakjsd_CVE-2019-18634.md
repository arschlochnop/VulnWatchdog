## CVE-2019-18634 - Sudo 栈缓冲区溢出 (Stack-based Buffer Overflow)

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出 (Stack-based Buffer Overflow)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.8.26 之前的版本

**利用条件:** 需要在 /etc/sudoers 配置文件中启用 pwfeedback 选项

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC项目提供了一个完整的自动化复现环境。通过Dockerfile构建了一个基于Ubuntu 20.04的镜像，并手动编译安装了存在漏洞的Sudo 1.8.25版本。项目的核心逻辑在于利用pwfeedback选项开启时，sudo在处理用户输入（特别是tgetpass函数）时对输入长度校验不足的缺陷。提供的develop.sh脚本展示了通过objdump工具自动定位关键内存地址（如buf、user_details、tgetpass_flags、signo）的过程，这是构造溢出Payload的关键步骤。这种通过自动化脚本动态搜索偏移量的方法，极大提高了POC在不同编译环境下的成功率和鲁棒性。通过溢出缓冲区，攻击者可以覆盖user_details等结构体，进而实现从普通用户到root用户的权限提升。该POC逻辑清晰，复现路径完整，对于防御性安全研究具有极高的参考价值。【利用步骤】1. 使用提供的develop.sh脚本构建Docker镜像，该脚本会自动下载源码、编译并安装受影响的Sudo版本。2. 构建过程中，脚本会通过objdump分析生成的sudo二进制文件，提取溢出所需的关键内存地址。3. 启动并进入Docker容器，使用低权限用户登录（如项目设置的user用户）。4. 执行exploit.py（或对应的sudo_sudo脚本），该脚本会根据提取的地址构造精心构造的长字符串作为输入。5. 当sudo处理该输入时，由于pwfeedback开启，多余的输入将溢出栈缓冲区并覆盖关键控制变量。6. 成功执行后，攻击者将获得一个具有root权限的shell环境。【投毒风险分析】经详细审计，该POC项目的源代码透明度高，投毒风险极低。Dockerfile和develop.sh脚本均使用了官方或可信的源（如sudo.ws官方下载地址）。代码中未发现任何经过混淆（Obfuscation）的处理，所有操作逻辑如文件复制、编译命令、内存地址提取均直接可见。虽然涉及权限提升，但其行为完全局限在Docker容器内部，且目的是为了验证特定的CVE漏洞。脚本中未包含任何向外部服务器发送敏感数据（如反弹Shell、凭证窃取）的指令，也未发现恶意利用eval函数或隐藏的二进制执行文件。作为典型的防御性研究代码，它侧重于漏洞机制的解释和环境的模拟，而非恶意传播。组织在下载使用时，仍建议遵循最小权限原则，在隔离的沙箱或虚拟机环境中运行构建脚本，以规避任何潜在的安全意外。

**项目地址:** [https://www.sudo.ws/security/advisories/pwfeedback/](https://www.sudo.ws/security/advisories/pwfeedback/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)
