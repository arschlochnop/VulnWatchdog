# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

# CVE-2019-9193

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2019-9193-A0be_CVE-2019-9193.md](../2019/CVE-2019-9193-A0be_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #2

**来源**: [CVE-2019-9193-AxthonyV_CVE-2019-9193.md](../2019/CVE-2019-9193-AxthonyV_CVE-2019-9193.md)

## CVE-2019-9193-PostgreSQL-RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.7

**利用条件:** 需要PostgreSQL数据库的账号密码，并具有执行`COPY FROM PROGRAM`的权限(默认superuser或者pg_execute_server_program组的成员)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 允许攻击者通过 `COPY TO/FROM PROGRAM` 函数在数据库服务器上执行任意代码。虽然PostgreSQL官方认为这不是一个漏洞，而是一个功能，但攻击者可以利用此功能在服务器上执行操作系统命令。PoC代码通过连接到目标PostgreSQL数据库，创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行指定的系统命令，并将结果存储在临时表中。最后，PoC代码检索并打印命令的结果，并删除临时表。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，PoC代码是有效的。搜索引擎结果中多个链接都指向了该漏洞的利用方法，并且给出了相应的PoC。提供的PoC代码也实现了利用该漏洞执行任意命令的功能。

**投毒风险：**
该PoC代码主要功能是执行命令，没有明显的恶意代码。PoC 使用了 `argparse` 来解析参数，可以灵活地指定目标IP、端口、数据库、用户名、密码和要执行的命令。PoC创建临时表并删除，操作较为规矩，隐藏恶意代码的空间较小。PoC本身结构简单，功能明确，虽然存在很小的投毒可能性，但是整体风险不高。

**利用方式：**
1.  **身份验证：** 攻击者需要拥有PostgreSQL数据库的有效账号和密码。
2.  **权限判断：** 攻击者需要拥有执行`COPY FROM PROGRAM`的权限，该权限默认只赋予superuser或者`pg_execute_server_program`组的成员。
3.  **命令执行：** 攻击者使用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。PoC代码使用 `psycopg2` 库连接到 PostgreSQL 数据库，构造恶意的SQL语句，利用 `COPY FROM PROGRAM` 执行系统命令。
4.  **结果获取：** 攻击者通过查询临时表，获取命令执行的结果。
5.  **清理现场：** 攻击者删除临时表，清理操作痕迹。

**项目地址:** [AxthonyV/CVE-2019-9193](https://github.com/AxthonyV/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #3

**来源**: [CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md](../2019/CVE-2019-9193-Cheryanika_CVE-2019-9193---Postgresql---RCE.md)

## CVE-2019-9193 - PostgreSQL 远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可执行任意系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，且数据库用户拥有足够权限（如postgres用户或者属于pg_execute_server_program组的用户）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 漏洞是 PostgreSQL 9.3 到 11.7 版本中 'COPY TO/FROM PROGRAM' 功能的一个问题。该功能允许超级用户和 'pg_execute_server_program' 组中的用户在数据库服务器的操作系统用户上下文中执行任意代码。提供的 Python 脚本 `CVE-2019-9193.py` 旨在利用此漏洞。利用方式如下：

1.  **连接数据库：** 脚本首先尝试使用提供的凭据（IP地址、端口、数据库名称、用户名和密码）连接到 PostgreSQL 数据库。
2.  **版本检查：** 连接成功后，脚本会查询 PostgreSQL 的版本。如果版本在易受攻击的范围内（9.3 到 11.7），则继续执行。
3.  **命令执行：** 脚本创建一个随机名称的临时表，然后使用 `COPY ... FROM PROGRAM` 命令执行用户提供的系统命令。命令的输出存储在这个临时表中。
4.  **结果获取：** 脚本从临时表中读取命令的输出，并将其打印到控制台。
5.  **清理：** 最后，脚本删除创建的临时表。

**有效性：**
提供的PoC代码是有效的，因为它利用了 `COPY FROM PROGRAM` 功能来执行任意系统命令。如果目标PostgreSQL数据库的版本在9.3到11.7之间，并且提供了有效的数据库凭据，则该脚本应该能够成功执行命令。

**投毒风险：**
该脚本没有明显的投毒行为。该脚本的主要功能是执行用户提供的命令，并没有发现任何隐藏或恶意的功能。代码虽然可能被滥用，但代码本身的设计目的不是为了投毒。因此，风险评估为0%。代码执行的是用户传入的参数，如果用户传入的参数是恶意代码，那属于用户自己投毒，而非代码本身。

**利用方式总结：**
1.  获得目标 PostgreSQL 数据库的访问权限（有效的用户名和密码）。
2.  确保目标数据库版本在 9.3 到 11.7 之间。
3.  使用 `COPY FROM PROGRAM` 功能执行任意系统命令。

**项目地址:** [Cheryanika/CVE-2019-9193---Postgresql---RCE](https://github.com/Cheryanika/CVE-2019-9193---Postgresql---RCE)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #4

**来源**: [CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md](../2019/CVE-2019-9193-b4keSn4ke_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 - 12.3

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，以及'pg_execute_server_program'组权限（默认情况下superuser拥有）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193允许经过身份验证的攻击者在PostgreSQL服务器上执行任意代码。漏洞存在于 'COPY TO/FROM PROGRAM' 功能中。攻击者可以使用有效的数据库凭据连接到PostgreSQL数据库，然后利用'COPY FROM PROGRAM'语句执行操作系统命令。由于PostgreSQL服务器以操作系统用户的身份运行，因此执行的命令将具有与PostgreSQL服务器相同的权限。 

**有效性：**

提供的PoC代码（cve-2019-9193.py）使用psycopg2库连接到PostgreSQL数据库，检查PostgreSQL版本，然后使用'COPY ... FROM PROGRAM'语句执行提供的系统命令。该代码会创建一个临时表，使用COPY命令将命令的输出写入表中，然后查询表并删除该表。提供的README.md 文件也提供了利用示例，表明该漏洞PoC可用。

**投毒风险：**

检查提供的PoC代码，未发现明显的投毒代码。该代码仅利用了PostgreSQL的'COPY FROM PROGRAM'功能来执行命令。代码的逻辑是连接到数据库，执行命令，获取结果，然后清理。没有发现任何尝试安装后门、修改系统文件或其他恶意行为。因此，投毒风险较低（0%）。

**利用方式：**

1.  攻击者需要有效的PostgreSQL数据库用户名和密码。
2.  攻击者使用psycopg2或其他PostgreSQL客户端连接到目标数据库服务器。
3.  攻击者执行'COPY table FROM PROGRAM 'command''语句，其中'command'是要执行的操作系统命令。
4.  PostgreSQL服务器执行该命令并将结果存储到指定的表中（如果适用）。
5.  攻击者查询该表以获取命令的输出。
6.  攻击者删除该表。

**项目地址:** [b4keSn4ke/CVE-2019-9193](https://github.com/b4keSn4ke/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---



---

## POC #5

**来源**: [CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md](../2019/CVE-2019-9193-chromanite_CVE-2019-9193-PostgreSQL-9.3-11.7.md)

## CVE-2019-9193-PostgreSQL-远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，允许经过身份验证的用户执行任意操作系统命令

**影响版本:** 9.3 - 11.7

**利用条件:** 需要有效的PostgreSQL数据库用户名和密码，且目标数据库开启了`COPY TO/FROM PROGRAM`功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。`COPY TO/FROM PROGRAM` 功能允许超级用户以及 'pg_execute_server_program' 组中的用户，以数据库操作系统用户的身份执行任意代码。提供的漏洞利用代码 `cve-2019–9193.py` 实现了利用该漏洞的 PoC。该 PoC 脚本接受数据库的 IP 地址、端口、数据库名称、用户名、密码和连接超时等参数。它首先连接到数据库，然后检查 PostgreSQL 的版本，确认其是否位于易受攻击的范围内 (9.3 - 11.7)。如果版本易受攻击，脚本将进入一个循环，允许用户输入要执行的操作系统命令。该脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。然后从临时表中读取结果并打印到控制台。最后删除临时表。

**有效性：** 提供的 PoC 代码有效，因为它直接利用了 `COPY FROM PROGRAM` 功能来执行操作系统命令。

**投毒风险：** 考虑到这是一个已知的 CVE 的 PoC，其主要功能是利用漏洞，因此投毒的可能性较低。但是，任何代码都存在潜在的风险。为了降低风险，必须仔细审计提供的脚本。此脚本的投毒风险预估为5%。潜在的风险可能在于作者修改了原始利用代码，在执行目标命令前后偷偷执行其他操作, 例如反弹shell或植入后门。在实际环境中应当仔细审计和测试.

**利用方式：** 该漏洞的利用方式如下：
1.  使用提供的 PoC 脚本连接到目标 PostgreSQL 数据库。
2.  脚本会验证 PostgreSQL 的版本是否在易受攻击的范围内。
3.  如果版本易受攻击，则脚本会允许用户输入要执行的操作系统命令。
4.  脚本使用 `COPY table FROM PROGRAM 'command'` 构造恶意的 SQL 查询，执行操作系统命令并将结果存储在临时表中。
5.  脚本从临时表中读取结果并打印到控制台。
6.  最后，脚本删除临时表。

**项目地址:** [chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7](https://github.com/chromanite/CVE-2019-9193-PostgreSQL-9.3-11.7)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #6

**来源**: [CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md](../2019/CVE-2019-9193-corsisechero_CVE-2019-9193byVulHub.md)

## CVE-2019-9193-PostgreSQL-命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3-11.2

**利用条件:** 需要具有PostgreSQL的管理员权限或pg_execute_server_program组的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9193允许拥有`COPY TO/FROM PROGRAM`权限（通常是超级用户或`pg_execute_server_program`组的成员）的用户执行任意操作系统命令。漏洞利用方式是利用`COPY FROM PROGRAM`功能，该功能允许PostgreSQL从一个外部程序读取数据并将其导入到数据库表中。攻击者可以构造恶意的`COPY FROM PROGRAM`语句，使其执行任意的系统命令。根据搜索引擎结果和漏洞库信息，该漏洞存在争议，PostgreSQL团队认为这不是一个安全漏洞，因为`COPY TO/FROM PROGRAM`的功能就是这样设计的，但它确实可以被滥用来执行命令。提供的POC代码描述了如何利用这个功能执行`id`命令。投毒风险较低，因为该漏洞利用的是PostgreSQL的内置功能，作者很难在提供的POC代码中隐藏恶意代码。虽然理论上可以将要执行的命令替换为恶意命令，但在当前的上下文中没有发现此类迹象。`docker-compose.yml`文件只是为了方便搭建测试环境，本身不包含恶意代码。

根据漏洞库信息，即使是超级用户也可以不通过`COPY FROM PROGRAM`执行命令。但通过`COPY FROM PROGRAM`，普通用户如果拥有了`pg_execute_server_program`的权限组，也可以进行提权。

由于postgresql团队不认为这是漏洞，所以修复方案就是不要给普通用户赋予`pg_execute_server_program`权限，使用户无法使用`COPY TO/FROM PROGRAM`执行命令。

**项目地址:** [corsisechero/CVE-2019-9193byVulHub](https://github.com/corsisechero/CVE-2019-9193byVulHub)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #7

**来源**: [CVE-2019-9193-geniuszly_CVE-2019-9193.md](../2019/CVE-2019-9193-geniuszly_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 认证后的任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭证（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有足够权限的用户（默认情况下是超级用户，或者`pg_execute_server_program`组的成员）在数据库服务器的操作系统上以数据库服务器用户的身份执行任意代码。这是通过 `COPY TO/FROM PROGRAM` 功能实现的。提供的PoC代码利用了这一功能。

**有效性评估：**
PoC代码通过以下步骤来利用漏洞：
1.  连接到PostgreSQL数据库。
2.  检查PostgreSQL的版本，确认它是否在易受攻击的范围内（9.3到11.2）。
3.  创建一个临时表。
4.  使用 `COPY table_name FROM PROGRAM 'command'` 语法执行指定的操作系统命令。命令的结果被写入临时表。
5.  从临时表中读取命令的输出。
6.  删除临时表。

该PoC代码是有效的，因为它利用了PostgreSQL的内置功能来执行操作系统命令。 需要注意的是，这个利用需要数据库的有效凭据。

**投毒风险评估：**
PoC代码本身**没有**明显的投毒风险。该代码的主要功能是利用已知的PostgreSQL漏洞来执行任意命令。它并没有包含任何会损害系统或泄露信息的恶意代码。也没有发现作者有意隐藏后门或者其他恶意功能。

**利用方式：**
1.  **前提条件：** 攻击者需要具有有效的PostgreSQL用户凭证，并且该用户需要拥有执行 `COPY TO/FROM PROGRAM` 命令的权限（通常是超级用户或者属于 `pg_execute_server_program` 组的用户）。
2.  **漏洞利用：** 攻击者使用 `COPY table_name FROM PROGRAM 'command'` 命令来执行任意操作系统命令。`command` 是攻击者希望执行的命令。 
3.  **影响：** 成功的利用会导致攻击者以运行PostgreSQL服务器的操作系统用户的身份执行任意代码，从而可能完全控制服务器。

**项目地址:** [geniuszly/CVE-2019-9193](https://github.com/geniuszly/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #8

**来源**: [CVE-2019-9193-jhnhnck_CVE-2019-9193.md](../2019/CVE-2019-9193-jhnhnck_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 9.3-11.2 任意命令执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意命令执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许已认证的用户执行任意操作系统命令

**影响版本:** 9.3 <= version <= 11.2

**利用条件:** 需要有效的PostgreSQL用户凭据，并且用户需要具有足够的权限或者属于'pg_execute_server_program'组

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许具有足够权限（如超级用户或属于 pg_execute_server_program 组的用户）的已认证用户，通过 `COPY TO/FROM PROGRAM` 功能执行任意操作系统命令。该漏洞利用方式是利用 PostgreSQL 的 `COPY FROM PROGRAM` 功能，该功能允许数据库服务器执行操作系统命令并将结果导入到表中。攻击者可以创建一个临时表，然后使用 `COPY FROM PROGRAM` 执行恶意命令，并将命令结果存储到临时表中，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息和POC代码，此漏洞利用是有效的。POC代码通过 `psycopg2` 库连接到目标 PostgreSQL 数据库，然后创建一个临时表，并使用 `COPY FROM PROGRAM` 执行用户指定的命令。命令执行结果会被读取并输出，然后删除临时表。

**投毒风险评估：**

该POC代码文件列表中包含两个文件 `GenPostgresRCEExploit.py` 和 `LICENSE`，检查 `GenPostgresRCEExploit.py` 中的代码，没有发现任何明显的恶意代码或后门。所有操作都与漏洞利用相关，目的是执行给定的系统命令。`LICENSE` 文件是一个标准的MIT许可证文件。

因此，评估的投毒风险为 0%。

**利用方式总结：**

1.  使用有效的 PostgreSQL 用户凭据连接到目标数据库。
2.  检查 PostgreSQL 版本是否在受影响的范围内 (9.3 <= version <= 11.2)。
3.  创建一个临时表。
4.  利用 `COPY FROM PROGRAM` 功能执行任意操作系统命令，并将结果存储到临时表中。
5.  从临时表中读取命令执行结果。
6.  删除临时表。

**项目地址:** [jhnhnck/CVE-2019-9193](https://github.com/jhnhnck/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #9

**来源**: [CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md](../2019/CVE-2019-9193-netw0rk7_CVE-2019-9193-Home-Lab.md)

## CVE-2019-9193 - PostgreSQL COPY FROM PROGRAM RCE

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 - 11.2

**利用条件:** 需要数据库的身份验证，且用户需要是超级用户或具有 pg_execute_server_program 角色。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9193 漏洞存在于 PostgreSQL 9.3 到 11.2 版本中。该漏洞允许超级用户或具有 `pg_execute_server_program` 角色的用户通过 `COPY FROM PROGRAM` 命令执行任意操作系统命令。提供的 Dockerfile 构建了一个包含易受攻击 PostgreSQL 版本的环境，并提供了一个简单的利用链。利用方式包括：

1.  连接到 PostgreSQL 数据库，使用提供的用户名和密码。
2.  创建一个用于存储命令输出的表。
3.  使用 `COPY cmd_exec FROM PROGRAM '<command>'` 命令执行操作系统命令，并将结果存储到创建的表中。
4.  查询该表以查看命令的输出。

**有效性：**  提供的 POC 代码有效。它提供了一个可重现的漏洞环境和明确的利用步骤。

**投毒风险：**  虽然 Dockerfile 构建了易受攻击的环境，但其中存在轻微的投毒风险。风险点在于 `entrypoint.sh` 脚本，需要进一步审查以确保其中没有隐藏的恶意行为。

**利用方式：**  攻击者通过身份验证后，利用 `COPY FROM PROGRAM` 命令执行任意操作系统命令。这允许他们读取文件、修改系统设置，甚至完全控制服务器。

**总结:** 这是一个高危漏洞，利用方式简单，只需几条 SQL 命令即可实现远程命令执行。建议尽快升级 PostgreSQL 版本或采取缓解措施，例如限制 `pg_execute_server_program` 角色，或禁用 `COPY PROGRAM` 功能。

**项目地址:** [netw0rk7/CVE-2019-9193-Home-Lab](https://github.com/netw0rk7/CVE-2019-9193-Home-Lab)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #10

**来源**: [CVE-2019-9193-paulotrindadec_CVE-2019-9193.md](../2019/CVE-2019-9193-paulotrindadec_CVE-2019-9193.md)

## CVE-2019-9193 - PostgreSQL Authenticated Remote Code Execution

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，允许认证用户以数据库服务器操作系统的用户身份执行任意代码。

**影响版本:** 9.3 through 11.2（据漏洞库信息，POC测试版本为9.6.1）

**利用条件:** 需要PostgreSQL数据库的有效用户凭证（默认用户 postgres:postgres），且用户具有足够权限（默认安装通常满足）。需要数据库端口开放且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(或者说特性)存在于PostgreSQL的`COPY TO/FROM PROGRAM` 功能中。拥有superuser权限或属于`pg_execute_server_program`组的用户可以通过该功能执行操作系统命令。提供的`exploit.py`脚本通过以下步骤利用该特性：

1.  **连接数据库:** 使用提供的用户名、密码、IP地址和端口连接到目标PostgreSQL数据库。
2.  **创建函数和触发器:**
    *   删除可能存在的旧表`triggeroffsec`，函数`triggeroffsecexeccmd`，表`triggeroffsecsource`，以及触发器`shoottriggeroffsecexeccmd`，以确保利用环境的干净。
    *   创建一个表`triggeroffsec`，用于存储命令执行的结果。
    *   创建一个名为`triggeroffsecexeccmd`的PL/pgSQL函数，该函数使用`COPY triggeroffsec (cmdout) FROM PROGRAM`语句执行指定的操作系统命令。命令来自脚本的`-c`参数。
    *   创建一个表`triggeroffsecsource`，作为触发器的源表。
    *   创建一个触发器`shoottriggeroffsecexeccmd`，该触发器在`triggeroffsecsource`表插入数据后被触发，从而执行`triggeroffsecexeccmd`函数。
3.  **触发命令执行:** 向`triggeroffsecsource`表插入一条数据，触发`shoottriggeroffsecexeccmd`触发器，从而执行`triggeroffsecexeccmd`函数，执行预设的命令。
4.  **获取结果:**  从`triggeroffsec`表中查询命令执行的结果并输出。
5.  **清理:**  脚本虽然尝试删除创建的表和函数，但`DROP FUNCTION ... CASCADE`命令的使用意在处理依赖关系，确保清理干净。

**有效性评估：**

该POC代码有效，因为它直接利用了PostgreSQL的`COPY TO/FROM PROGRAM`功能来执行操作系统命令。  尽管PostgreSQL官方不认为这是一个安全漏洞，但在默认配置下，它允许经过身份验证的用户执行任意代码，因此在安全角度上是高危的。

**投毒风险评估：**

经分析，提供的POC代码中**没有**发现明显的投毒代码。 代码逻辑清晰，主要目的是利用`COPY FROM PROGRAM`功能执行命令，没有发现任何额外的不良行为，例如修改系统文件、安装后门、或者向外部服务器发送数据等。

**利用方式总结：**

该漏洞利用方式涉及在PostgreSQL数据库中创建自定义函数和触发器，从而在数据库操作时执行操作系统命令。攻击者需要有效的数据库凭据，然后构造特定的SQL语句来利用`COPY FROM PROGRAM`功能执行任意命令。这种利用方式相对隐蔽，因为命令执行发生在数据库服务器的操作系统层面，不容易被传统的Web应用防火墙或入侵检测系统发现。

**项目地址:** [paulotrindadec/CVE-2019-9193](https://github.com/paulotrindadec/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

## POC #11

**来源**: [CVE-2019-9193-wkjung0624_cve-2019-9193.md](../2019/CVE-2019-9193-wkjung0624_cve-2019-9193.md)

## CVE-2019-9193 - PostgreSQL 任意代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 任意代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 9.3 <= 版本 <= 11.2

**利用条件:** 需要具有superuser权限或属于pg_execute_server_program组的用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9193 允许拥有superuser权限或属于`pg_execute_server_program`组的用户通过 `COPY TO/FROM PROGRAM` 功能执行任意代码。提供的POC代码 `portgres_rce.py` 利用了这一漏洞，通过创建一个反向shell连接到攻击者控制的机器。该脚本首先建立一个监听特定端口的TCP服务器，然后通过PostgreSQL的 `COPY FROM PROGRAM` 命令执行一段Perl代码，该Perl代码会尝试连接到攻击者机器的监听端口，从而建立反向shell。 

**有效性分析：**
POC代码利用了PostgreSQL的 `COPY FROM PROGRAM` 功能，该功能允许执行操作系统命令。只要满足superuser或pg_execute_server_program权限要求，POC代码就能有效执行任意命令，从而验证漏洞的有效性。

**投毒风险分析：**
该代码的目的是利用漏洞，创建一个反向shell连接，以便控制受害者系统。该脚本从功能上来说,符合漏洞验证的需求,没有发现植入恶意代码的痕迹，投毒风险为0%。 

**利用方式：**
1.  攻击者需要拥有 PostgreSQL 数据库的superuser权限或者属于`pg_execute_server_program`用户组.
2.  攻击者运行提供的`portgres_rce.py`脚本，输入PostgreSQL服务器的IP地址和端口，以及攻击者监听的IP地址和端口。
3.  脚本通过`psycopg2`库连接到PostgreSQL数据库。
4.  脚本构造一系列SQL命令，包括创建临时表`RCE_BASE`，然后使用`COPY RCE_BASE FROM PROGRAM`执行Perl反向shell代码。Perl代码会连接到攻击者指定的IP地址和端口。
5.  攻击者机器上运行的TCP服务器接受连接，从而建立反向shell。攻击者可以输入命令并执行。
6.  最后删除临时表 `RCE_BASE`。


**项目地址:** [wkjung0624/cve-2019-9193](https://github.com/wkjung0624/cve-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)

---

