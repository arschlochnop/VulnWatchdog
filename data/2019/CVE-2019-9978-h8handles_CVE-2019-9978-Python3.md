## CVE-2019-9978 - Social Warfare 插件 (WordPress) RCE (远程代码执行)

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Social Warfare 插件 (WordPress)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 3.5.2

**利用条件:** 无需身份验证，目标服务器必须安装受影响版本的Social Warfare插件，且PHP配置允许远程URL包含（或插件逻辑允许加载外部配置）。

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本POC是一个将原始Python 2脚本迁移至Python 3的实现，其核心逻辑非常直接且具备高度的有效性。它利用了Social Warfare插件中wp-admin/admin-post.php处理swp_debug参数时的逻辑缺陷。当攻击者传入swp_debug=load_options并配合swp_url指向一个恶意的远程配置文件（通常是包含PHP代码的文本文件）时，插件会尝试加载并处理该URL的内容。由于缺乏对URL来源的严格校验，这导致了典型的远程文件包含或不安全的反序列化/执行路径。代码中使用requests.get发起简单的HTTP GET请求，通过检查返回码是否为500来初步判断利用情况。虽然代码结构简单，但它准确捕捉到了漏洞触发的参数组合，对于安全研究人员验证环境漏洞具有极高的实用价值。利用步骤：1. 攻击者首先需要在自己控制的服务器上托管一个包含恶意Payload的文本文件（例如payload.txt），内容通常为执行系统命令的PHP代码。2. 攻击者修改exploit.py中的host变量为目标WordPress站点的URL。3. 修改path变量中的swp_url参数，使其指向攻击者托管的恶意payload.txt地址。4. 执行python3 exploit.py，脚本将向目标路径发送构造好的GET请求。5. 插件后端接收到请求后，通过load_options逻辑下载并解析远程Payload，从而在服务器上下文执行任意命令。投毒风险分析：该POC的投毒风险处于较低水平（约15%）。从代码审计的角度看，exploit.py使用了标准的requests库，没有引入复杂的第三方依赖或经过混淆的二进制包。代码逻辑透明，所有变量（如host, path）均以明文形式定义，方便使用者进行静态审查。风险点主要在于：第一，该脚本旨在诱导用户访问特定的外部IP（如代码中硬编码的192.168.45.189），虽然这在POC中通常作为占位符，但如果用户在未审查的情况下盲目运行，可能会与不可信的外部服务器建立连接。第二，脚本中存在对返回内容的split和print操作，如果远程服务器返回精心构造的超大数据包或特殊转义字符，可能导致本地终端环境出现异常。不过，由于没有发现典型的恶意后门逻辑（如反向Shell到攻击者机器、读取本地敏感文件等），其作为防御性研究工具是相对安全的。建议用户在使用时务必在隔离的实验环境下运行，并手动替换所有硬编码的IP地址为本地靶机地址。

**项目地址:** [https://github.com/h8handles/CVE-2019-9978-Python3](https://github.com/h8handles/CVE-2019-9978-Python3)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
