## CVE-2019-18634 - Sudo 缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.8.26之前的版本

**利用条件:** 在 /etc/sudoers 中启用了 'pwfeedback' 选项

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：本漏洞源于Sudo在处理密码输入反馈时的逻辑缺陷。当/etc/sudoers中开启了pwfeedback选项时，Sudo会在用户输入密码时打印星号。由于在从标准输入读取数据到缓冲区时缺乏边界检查，攻击者可以通过构造超长的输入流来触发缓冲区溢出。根据POC代码显示，通过简单的Perl脚本构造特定长度的字符串（如100个'A'后跟空字符，重复50次）并传递给sudo，可以引发段错误（Segmentation Fault），这证明了程序控制流已被破坏。高质量的POC通常包含利用这一溢出点覆盖返回地址或函数指针的指令，从而在提权后获取root shell。此漏洞在Linux Mint和Elementary OS等默认开启pwfeedback的发行版中极具威胁，因为攻击者无需高权限即可触发此路径。利用步骤：首先，攻击者需通过SSH或本地终端登录系统；其次，通过'sudo -V'确认版本低于1.8.26，并通过'sudo -l'或直接观察输入密码时是否显示星号来确认pwfeedback是否启用；然后，从Exploit-DB等来源下载C语言编写的利用程序进行编译；最后，执行编译后的二进制文件，脚本将自动溢出缓冲区并尝试通过覆写内存布局来生成一个具有root权限的shell。投毒风险分析：经过对公开POC代码及README描述的分析，该代码库展示了清晰的逻辑结构，主要包含测试用例说明、漏洞触发原理和GitHub项目引用。POC的核心部分是标准的缓冲区溢出测试向量（Perl命令行），不包含任何混淆代码、外部加密下载或非必要的系统调用。代码中提到的链接指向公认的安全平台Exploit-DB，未发现恶意后门植入或信息窃取行为。尽管在安全研究中需警惕此类提权POC可能被二次封装为自动化攻击工具，但就目前分析的原始数据而言，该POC属于纯粹的技术验证和教育目的。唯一的风险点在于部分预编译的二进制文件可能被替换，但该项目主要提供的是源代码和README指引，投毒风险评级极低。防御建议是立即将Sudo更新至最新版本，或在sudoers配置文件中禁用pwfeedback选项以消除攻击面。

**项目地址:** [https://github.com/CyrusRazavi/CVE-2019-18634-](https://www.google.com/search?q=https://github.com/CyrusRazavi/CVE-2019-18634-)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2019-18634](https://nvd.nist.gov/vuln/detail/cve-2019-18634)
