# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md](../2019/CVE-2019-7214-Drew-Alleman_CVE-2019-7214.md)

# CVE-2019-7214

> ğŸ“¦ è¯¥CVEæœ‰ **3** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #2

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---



---

## POC #2

**æ¥æº**: [CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md](../2019/CVE-2019-7214-ElusiveHacker_CVE-2019-7214.md)

## CVE-2019-7214-SmarterMail-ååºåˆ—åŒ–RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç«¯å£17001å¯è®¿é—®ï¼ˆé»˜è®¤é…ç½®ä¸‹ä¸å¯è¿œç¨‹è®¿é—®ï¼ŒBuild 6985åä¿®å¤ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214æ˜¯SmarterMail 16.xç‰ˆæœ¬Build 6985ä¹‹å‰çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ï¼ˆå¦‚æœå¯è®¿é—®ï¼‰å‘é€ç‰¹åˆ¶çš„åºåˆ—åŒ–æ•°æ®ï¼Œæ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¼æ´åˆ©ç”¨ä¾èµ–äº.NETååºåˆ—åŒ–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„PowerShellå‘½ä»¤ä½œä¸ºpayloadï¼Œå¹¶é€šè¿‡åºåˆ—åŒ–æ–¹å¼ä¼ é€’ç»™SmarterMailæœåŠ¡å™¨ã€‚æä¾›çš„PoCä»£ç ï¼ˆCVE-2019-7214.pyï¼‰æ„é€ äº†è¿™æ ·çš„payloadï¼Œå…¶ä¸­åŒ…å«äº†base64ç¼–ç çš„PowerShellåå‘shellå‘½ä»¤ã€‚  

**æœ‰æ•ˆæ€§:**  æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥POCä»£ç æœ‰æ•ˆã€‚å¤šä¸ªæ¥æºè¡¨æ˜å­˜åœ¨å¯åˆ©ç”¨çš„PoCï¼Œå¹¶ä¸”æä¾›çš„ä»£ç æœ¬èº«ä¹Ÿå®ç°äº†åˆ©ç”¨è¿‡ç¨‹ã€‚

**æŠ•æ¯’é£é™©:** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
1.  **ä»£ç æ¥æºï¼š** ä»£ç æ¥è‡ªå¤šä¸ªä½œè€…ï¼Œç»è¿‡äº†ElusiveHackerä¿®æ”¹ï¼Œä½†ä¸»è¦é€»è¾‘æ˜¯Soroush Daliliçš„ã€‚åŸå§‹ä½œè€…çš„ä¿¡èª‰éœ€è¦è¯„ä¼°ï¼Œä½†NCC Groupä¹Ÿå‘å¸ƒäº†ç›¸å…³çš„æŠ€æœ¯æŠ¥å‘Šï¼Œä½è¯äº†æ¼æ´çš„å­˜åœ¨ã€‚
2.  **ä»£ç å†…å®¹ï¼š** ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆå’Œå‘é€Payloadï¼ŒPayloadæœ¬èº«åŒ…å«åå‘shellçš„PowerShellå‘½ä»¤ã€‚è™½ç„¶åå‘shellæœ¬èº«æœ‰é£é™©ï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œä¸å±äºæŠ•æ¯’ã€‚
3.  **é…ç½®å‚æ•°ï¼š**  ä»£ç ä¸­éœ€è¦é…ç½®`LHOST`å’Œ`LPORT`ï¼Œè¿™æ˜¯åå‘è¿æ¥çš„åœ°å€ï¼Œå¦‚æœæ”»å‡»è€…ä¸å°å¿ƒä½¿ç”¨äº†é”™è¯¯çš„é…ç½®ï¼Œå¯èƒ½å¯¼è‡´è¿æ¥åˆ°æ¶æ„çš„æœåŠ¡å™¨ï¼Œå­˜åœ¨è¢«ååˆ¶çš„é£é™©ã€‚ä½†è¿™ä¸å±äºä»£ç æœ¬èº«çš„æŠ•æ¯’ã€‚
4. **README.mdæ–‡ä»¶ï¼š** READMEæ–‡ä»¶è¯´æ˜äº†å¦‚ä½•é…ç½®å’Œä½¿ç”¨è¯¥PoCï¼Œå…¶ä¸­æåˆ°äº†hostnameè§£æã€ç«¯å£é…ç½®ä»¥åŠä½¿ç”¨Netcatç›‘å¬ç­‰æ­¥éª¤ã€‚å®ƒå¯¹ç¯å¢ƒæ­å»ºå’Œè¿è¡Œæä¾›äº†æŒ‡å¼•ï¼Œå¹¶æ— æ¶æ„æ“ä½œã€‚

ä¸»è¦çš„æŠ•æ¯’é£é™©åœ¨äºï¼Œå¦‚æœæ”»å‡»è€…ä¸‹è½½äº†è¯¥POCï¼Œå¹¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¯èƒ½è¢«å…¶ä»–äººæˆªè·åå‘shellè¿æ¥ï¼Œä»è€Œå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æƒé™è¢«çªƒå–ã€‚å› æ­¤,ä¸èƒ½å®Œå…¨æ’é™¤æ”»å‡»è€…åœ¨æ‰˜ç®¡çš„æœåŠ¡å™¨ä¸Šï¼Œæ•è·åå‘shellé“¾æ¥ã€‚

**åˆ©ç”¨æ–¹å¼:**  
1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š**  ç¡®è®¤SmarterMailç‰ˆæœ¬ä½äºBuild 6985ã€‚
2.  **ç¡®è®¤ç«¯å£å¯è®¿é—®ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£å¯ä»¥é€šè¿‡ç½‘ç»œè®¿é—®ã€‚
3.  **é…ç½®PoCï¼š** ä¿®æ”¹PoCä»£ç ä¸­çš„`HOSTNAME`ã€`LHOST`å’Œ`LPORT`å‚æ•°ï¼Œåˆ†åˆ«è®¾ç½®ä¸ºç›®æ ‡ä¸»æœºåã€æ”»å‡»è€…IPåœ°å€å’Œç›‘å¬ç«¯å£ã€‚
4.  **è¿è¡ŒPoCï¼š** è¿è¡ŒPoCä»£ç ï¼Œå‘é€åºåˆ—åŒ–çš„Payloadã€‚
5.  **ç›‘å¬è¿æ¥ï¼š** åœ¨æ”»å‡»è€…æœºå™¨ä¸Šä½¿ç”¨Netcatæˆ–å…¶ä»–å·¥å…·ç›‘å¬æŒ‡å®šçš„ç«¯å£ã€‚
6.  **è·å–Shellï¼š** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå°†åœ¨æ”»å‡»è€…æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªæ¥è‡ªç›®æ ‡æœåŠ¡å™¨çš„PowerShell Shellã€‚

**é¡¹ç›®åœ°å€:** [ElusiveHacker/CVE-2019-7214](https://github.com/ElusiveHacker/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #3

**æ¥æº**: [CVE-2019-7214-andyfeili_-CVE-2019-7214.md](../2019/CVE-2019-7214-andyfeili_-CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET ååºåˆ—åŒ–

**å½±å“åº”ç”¨:** SmarterTools SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** 16.x before build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“çš„SmarterMailç‰ˆæœ¬ï¼Œä¸”17001ç«¯å£å¯è®¿é—®ï¼ˆé»˜è®¤æƒ…å†µä¸‹åœ¨Build 6985è¡¥ä¸åä¸å¯è¿œç¨‹è®¿é—®ï¼‰ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¯¥æ¼æ´å…è®¸æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ .NET remoting ç«¯ç‚¹ï¼ˆ17001ç«¯å£ï¼‰å‘é€æ¶æ„åºåˆ—åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„ POC ä»£ç æ˜¯ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒåˆ©ç”¨äº† .NET ååºåˆ—åŒ–æ¼æ´ã€‚è„šæœ¬é¦–å…ˆå®šä¹‰äº†ç›®æ ‡ä¸»æœºã€ç«¯å£ï¼Œæ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€ç«¯å£ï¼Œç„¶åæ„é€ ä¸€ä¸ªåŒ…å« PowerShell åå‘ Shell å‘½ä»¤çš„ Payloadã€‚è¯¥ Payload ä½¿ç”¨ `System.Collections.Generic.SortedSet` å¯¹è±¡ï¼Œæ”»å‡»è€…ä½¿ç”¨powershellæ‰§è¡Œæ¶æ„ä»£ç ï¼Œå¹¶å°†å…¶base64ç¼–ç åæ’å…¥Payloadï¼Œåˆ©ç”¨æ–¹å¼è¾ƒä¸ºç›´æ¥ï¼Œå¤§æ¦‚ç‡æœ‰æ•ˆã€‚Exploit-DBä¸Šä¹Ÿæœ‰ç›¸å…³åˆ©ç”¨ä»£ç ï¼ˆ[webpage 4]ï¼‰ã€‚

**æŠ•æ¯’é£é™©:** ç»åˆ†æï¼ŒPOCä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®ç°åå‘shellã€‚è™½ç„¶ä»£ç ä¸­åŒ…å«åå‘shellï¼Œä½†è¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¿…è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶éæ¶æ„æŠ•æ¯’ã€‚Payload ä½¿ç”¨ PowerShell ä¸‹è½½å¹¶æ‰§è¡ŒæŒ‡å®š URL ä¸Šçš„è„šæœ¬ï¼Œè¿™éƒ¨åˆ†å¦‚æœ URL è¢«ç¯¡æ”¹ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œç›®å‰ä»£ç ä¸­URLå‚æ•°ç”±æ”»å‡»è€…æŒ‡å®šã€‚è„šæœ¬çš„æ•´ä½“ç»“æ„å’Œé€»è¾‘ä¸å·²çŸ¥çš„ CVE-2019-7214 åˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚æŠ•æ¯’é£é™©ä¸»è¦å­˜åœ¨äºç”¨æˆ·å¦‚æœç›´æ¥ä½¿ç”¨è¯¥è„šæœ¬ï¼Œè€Œæ²¡æœ‰å®¡æŸ¥å…¶ä¸­çš„åå‘Shellåœ°å€ï¼Œå¯èƒ½ä¼šè¢«å…¶ä»–äººåˆ©ç”¨ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  **ç¡®å®šç›®æ ‡:** æ‰¾åˆ°è¿è¡Œ SmarterMail 16.x build 6985 ä¹‹å‰ç‰ˆæœ¬çš„æœåŠ¡å™¨ï¼Œå¹¶ç¡®è®¤17001ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚
2.  **é…ç½®æ”»å‡»æœº:** å‡†å¤‡ä¸€å°æ”»å‡»æœºï¼Œé…ç½®ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰ã€‚
3.  **ä¿®æ”¹POCä»£ç :** ä¿®æ”¹POCä»£ç ä¸­çš„ HOST (ç›®æ ‡æœåŠ¡å™¨IPåœ°å€), LHOST(æ”»å‡»æœºIP), PORT(Smartermailçš„17001ç«¯å£) å’Œ LPORT(æ”»å‡»æœºç›‘å¬ç«¯å£) çš„å‚æ•°ã€‚
4.  **è¿è¡ŒPOCä»£ç :** æ‰§è¡ŒPythonè„šæœ¬ï¼Œå°†æ¶æ„åºåˆ—åŒ–æ•°æ®å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„17001ç«¯å£ã€‚
5.  **è·å–Shell:** å¦‚æœæ¼æ´åˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»æœºå°†æ”¶åˆ°ä¸€ä¸ªåå‘Shellï¼Œæ”»å‡»è€…å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [andyfeili/-CVE-2019-7214](https://github.com/andyfeili/-CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

## POC #4

**æ¥æº**: [CVE-2019-7214-devzspy_CVE-2019-7214.md](../2019/CVE-2019-7214-devzspy_CVE-2019-7214.md)

## CVE-2019-7214 - SmarterMail Deserialization RCE

**æ¼æ´ç¼–å·:** CVE-2019-7214

**æ¼æ´ç±»å‹:** .NET Deserialization Remote Code Execution

**å½±å“åº”ç”¨:** SmarterMail

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < Build 6985

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡ŒSmarterMail 16.xï¼Œä¸”17001ç«¯å£å¯¹å¤–å¼€æ”¾ï¼ˆé»˜è®¤build 6985åå·²å…³é—­ï¼‰ã€‚æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿå‘17001ç«¯å£å‘é€è¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2019-7214 æ¼æ´å­˜åœ¨äº SmarterTools SmarterMail 16.x build 6985 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ã€‚è¿™æ˜¯ä¸€ä¸ª .NET ååºåˆ—åŒ–æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡ 17001 ç«¯å£å‘æœåŠ¡å™¨å‘é€æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®ï¼Œä»è€Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªæ¥æºç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶ä¸” exploit-db ä¸Šä¹Ÿå­˜åœ¨ç›¸å…³çš„åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python ä»£ç  `cve-2019-7214.py` çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  æ„é€ ä¸€ä¸ªåŒ…å«åµŒå…¥å¼ PowerShell å‘½ä»¤çš„ .NET ååºåˆ—åŒ– payloadã€‚
2.  PowerShell å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ª TCP åå‘ shell è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ LHOST å’Œ LPORTã€‚
3.  å°† payload å‘é€åˆ°ç›®æ ‡ SmarterMail æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚

ä»£ç ä¸­åŒ…å«çš„ PowerShell è„šæœ¬ä¼šè¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„ IP åœ°å€å’Œç«¯å£ï¼Œæ‰§è¡Œæ¥æ”¶åˆ°çš„å‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ã€‚ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥åœ¨åå‘shellæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå±å®³æå¤§ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¼æ´æœ¬èº«å°±æ˜¯æ‰§è¡Œä»»æ„ä»£ç ï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨è€…æ˜ç¡®çŸ¥é“æ­£åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ‰§è¡Œå‘½ä»¤ï¼Œå°†åå‘shellè¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå®ƒå°±ä¸æ˜¯åé—¨æˆ–æŠ•æ¯’ä»£ç ã€‚
README.md æç¤ºç”¨æˆ·æŸäº› POC å¯èƒ½éœ€è¦ä¿®æ”¹ï¼Œä¹Ÿå±äºæ­£å¸¸æƒ…å†µã€‚

ä½†ä¾æ—§å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚ï¼š

*   **éšè—çš„è¿œç¨‹åŒ…å«ï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è¿œç¨‹åŒ…å«æ¶æ„ä»£ç çš„è¯­å¥ï¼Œä½†ä»æä¾›çš„ä»£ç ç‰‡æ®µä¸­æœªå‘ç°ã€‚
*   **å¾®å¦™çš„å‚æ•°ç¯¡æ”¹ï¼š** æ”»å‡»è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä¿®æ”¹äº† LHOST/LPORTï¼Œå¯¼è‡´ shell è¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚

å› æ­¤ï¼Œç»¼åˆæ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ç‰ˆæœ¬ï¼š** ç¡®è®¤ç›®æ ‡æœåŠ¡å™¨è¿è¡Œçš„ SmarterMail ç‰ˆæœ¬ä½äº build 6985ã€‚
2.  **æ£€æŸ¥ç«¯å£å¯è¾¾æ€§ï¼š** ç¡®ä¿å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 17001 ç«¯å£ã€‚
3.  **é…ç½®æ”»å‡»æœºï¼š** è®¾ç½®æ”»å‡»æœºçš„ç›‘å¬ç«¯å£ï¼ˆLPORTï¼‰å’Œ IP åœ°å€ï¼ˆLHOSTï¼‰ã€‚
4.  **ä¿®æ”¹å¹¶è¿è¡ŒExploit** ä¿®æ”¹expä¸­çš„HOST,LHOST,PORT,LPORT,ç”ŸæˆPayloadå¹¶ä¸”è¿›è¡Œå‘é€.
5.  **æ‰§è¡Œ PowerShell å‘½ä»¤ï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œå¯ä»¥åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ PowerShell å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [devzspy/CVE-2019-7214](https://github.com/devzspy/CVE-2019-7214)

**æ¼æ´è¯¦æƒ…:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)

---

