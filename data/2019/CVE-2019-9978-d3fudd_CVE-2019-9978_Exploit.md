## CVE-2019-9978 - Social Warfare 插件 (WordPress) RCE/存储型XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/存储型XSS

**影响应用:** Social Warfare 插件 (WordPress)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** < 3.5.3

**利用条件:** 无需认证，目标服务器需能访问攻击者托管的恶意配置文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2019-9978 是一个存在于 WordPress Social Warfare 插件 3.5.3 之前版本中的严重漏洞。该漏洞源于对 `swp_debug` 参数的处理不当，允许攻击者通过 `admin-post.php` 接口触发 `load_options` 动作。其核心问题在于 `swp_url` 参数未经过滤即可指向外部服务器，导致远程文件包含 (RFI) 效应。在该漏洞的 POC 中，攻击者可以诱导受影响的服务器加载并解析一个恶意托管的 PHP 代码片段，从而在目标系统上实现远程代码执行 (RCE) 或执行跨站脚本 (XSS) 攻击。利用步骤如下：首先，攻击者在本地创建一个包含 PHP 执行代码的文件（如本例中的 backdoor.php），该文件通常包含 `system()` 或 `eval()` 函数以执行任意命令。接着，攻击者使用 Python 等工具开启一个临时的 Web 服务（如 python3 -m http.server 80）来托管该文件。最后，攻击者向目标 WordPress 站点的 `/wp-admin/admin-post.php` 发送带有 `swp_debug=load_options` 和 `swp_url=攻击者IP/backdoor.php` 参数的恶意 HTTP 请求。由于插件逻辑会读取并处理该 URL 指向的内容，导致代码在服务器上下文执行。POC 有效性分析显示，该脚本逻辑严密，通过 base64 编码命令解决了特殊字符传输问题，并使用 curl 直接触发利用链，是一个高度可用的攻击模型。投毒风险分析：该 POC 代码表现出极高的透明度和低毒性。在分析其 `exploit.sh` 内容时，可以发现其逻辑完全符合防御性安全研究的规范。首先，其生成的 `backdoor.php` 文件是透明的，明确使用了 `system(base64_decode($_GET[cmd]))`，这属于标准的漏洞验证逻辑，而非隐蔽的后门程序。其次，脚本中没有出现任何针对研究者本机的恶意操作，如尝试读取攻击者本机的 `/etc/shadow` 或执行反弹 shell 到第三方地址。所有的操作（如删除 `resposta.txt` 和 `backdoor.php`）都是为了清理痕迹。唯一的低度风险点在于使用 curl 下载外部资源时，如果攻击者修改了下载源，可能导致非预期行为。但就目前提供的代码而言，该 POC 是安全的，主要用于安全人员进行合法的渗透测试和漏洞验证。代码清晰，未经过混淆处理，符合安全社区对开源 POC 的安全预期，投毒风险评估为 10%。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2019-9978](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2019-9978)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
