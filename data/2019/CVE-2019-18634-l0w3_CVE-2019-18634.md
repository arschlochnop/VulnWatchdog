## CVE-2019-18634 - Sudo BSS缓冲区溢出

**漏洞编号:** CVE-2019-18634

**漏洞类型:** BSS缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.8.26

**利用条件:** 必须在 /etc/sudoers 中启用 pwfeedback 选项

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：根据提供的代码片段和README分析，该POC旨在演示Sudo在pwfeedback启用时的BSS缓冲区溢出漏洞。核心问题在于getln()函数中，当读取到sudo_term_kill字符（通常为\0）且反馈机制开启时，如果write操作失败，代码逻辑会导致缓冲区指针cp未递减，但left计数器被重置为bufsiz。这允许攻击者输入超过预分配缓冲区大小的数据，从而覆盖BSS段中的后续数据结构。虽然POC提供了详细的原理说明和触发逻辑，但输入数据在Trigger部分被截断，未能展示完整的溢出载荷生成过程，因此其作为完整利用程序的即用性较低，主要用于安全审计和教学演示。利用步骤：首先，研究员需确认目标系统的/etc/sudoers文件中是否包含'Defaults pwfeedback'配置。接着，通过非终端（non-tty）方式运行sudo，使得sudo_term_kill变量初始化为0。攻击者构造特定的Payload，包含大量的\0字符以触发写入失败路径，并填充特定长度的数据以覆盖BSS段中的敏感标志位或函数指针。最后，利用被篡改的程序逻辑绕过密码验证，获取root权限。投毒风险分析：该POC项目主要由技术文档、源码分析和基本的Trigger逻辑组成，目前显示的代码符合标准安全研究规范。README中明确指出该视频和代码仅用于教育目的（For Education purposes）。代码段使用了标准的C语言IO函数（read, write）和Sudo内部函数，没有发现混淆代码、外部恶意域名连接或非法二进制Payload植入。由于其主要内容是基于对已知Sudo源码的补丁分析和原理讲解，不具备自动化的恶意行为特征。风险点仅在于其提供的低权限提权思路可能被攻击者直接套用，但在当前代码结构下，其作为投毒媒介的可能性极低，属于低风险等级。

**项目地址:** /tmp/vulnwatchdog_dc56f079f65d80812f243dcb713a7f45/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/cve-2019-18634](https://nvd.nist.gov/vuln/detail/cve-2019-18634)
