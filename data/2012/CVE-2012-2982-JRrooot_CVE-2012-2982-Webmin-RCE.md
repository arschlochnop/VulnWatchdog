## CVE-2012-2982 - Webmin 远程代码执行 (RCE)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Webmin

**危害等级:** 高危 (Critical)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (核心评分: 9.0)

**影响版本:** Webmin 版本 <= 1.580

**利用条件:** 需要有效的 Webmin 用户凭据（已认证用户），且该用户拥有访问 File Manager 模块的权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞存在于 Webmin 1.580 的 file/show.cgi 组件中，主要原因是后端对用户提交的文件路径参数缺乏有效的过滤。攻击者可以通过在文件名中注入管道符（|）来逃逸原本的逻辑，直接在系统 shell 中执行任意命令。此提供的 Python POC 代码逻辑非常清晰且具有高度实效性。脚本首先模拟登录流程，利用 requests 库向 session_login.cgi 发送 POST 请求。如果登录成功并获取了 sid（Session ID）Cookie，则说明验证通过。随后，脚本会构造一个包含恶意 Payload 的 URL，利用管道符将 args.command 注入到 show.cgi 的处理逻辑中。由于 Webmin 通常以 root 权限运行，注入的命令将直接以 root 身份执行。此 POC 代码结构规范，使用了 argparse 处理命令行输入，使用了 secrets 和 string 库生成随机字符（用于绕过一些简单的检测或创建临时标记），是一个非常成熟且危险的自动化利用工具。利用步骤：1. 确认目标 Webmin 版本为 1.580 且开启了 File Manager 模块。2. 准备有效的登录凭据。3. 运行脚本并指定 target、username、password 及需要执行的 command（如: 'cat /etc/shadow' 或 'whoami'）。4. 脚本通过 session_login.cgi 获取 sid。5. 脚本向 /file/show.cgi 发送带有注入指令的 GET 请求。6. 观察返回结果以确认命令执行情况。投毒风险分析：该 POC 代码表现出极低的投毒风险（约10%）。代码逻辑公开透明，使用了 Python 的标准库（requests, argparse, secrets），没有发现任何经过混淆（Obfuscation）的二进制数据、Base64 加密的可疑载荷或恶意的 eval() 函数调用。代码中产生的随机字符生成器 ran() 属于正常的安全编码习惯，用于确保 Payload 的唯一性或绕过简单的缓存限制。脚本中没有发现向攻击者控制的第三方服务器（C2）发送敏感信息（如获取到的 sid 或 target 密码）的逻辑。唯一需要关注的是，这类利用脚本如果从不可信的 GitHub 仓库下载，攻击者可能会修改 POST 请求的部分，在受害者不知情的情况下将窃取的凭据发送到外部日志服务器。但基于当前代码段的审查，该版本是纯粹的防御性研究工具，代码清晰且符合安全研究员编写习惯，不存在恶意投毒特征。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2012-2982-Webmin-RCE](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2012-2982-Webmin-RCE)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
