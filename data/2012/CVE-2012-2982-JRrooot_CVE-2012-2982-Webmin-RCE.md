## CVE-2012-2982 - Webmin RCE (远程代码执行)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Webmin

**危害等级:** 高危 (Critical)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (暂估 9.0)

**影响版本:** Webmin 1.580 及其更早版本

**利用条件:** 需要有效凭证（已认证的用户），且该用户需拥有访问文件管理器（File Manager）模块的权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞源于Webmin 1.580版本中/file/show.cgi组件对用户输入处理不当。通过分析提供的Python POC代码，可见攻击者通过向该组件发送包含特殊管道符号（|）的精心构造的URL请求，可以逃逸正常的逻辑并注入任意OS命令。POC代码结构清晰，利用requests库模拟登录过程获取Session，随后通过构造GET/POST请求触发漏洞。该利用脚本具备自动登录、Payload注入和结果获取的闭环功能，在具备凭证的前提下，成功率极高且具备直接获取root权限的能力。代码实现上使用了argparse进行参数化管理，逻辑符合标准安全研究工具的规范。利用步骤：1. 获取目标Webmin服务器的URL、具有权限的用户名和密码。2. 运行POC脚本，通过-u和-p参数提供凭证，通过-c指定待执行的系统命令（如'id'或'whoami'）。3. 脚本首先向/session_login.cgi发送POST请求进行认证并获取Cookie。4. 利用获取的Session Cookie，向/file/show.cgi发送包含注入Payload的请求，Payload通过管道符劫持后端shell执行。5. 脚本输出命令执行的结果。投毒风险分析：该POC代码表现出极低的投毒风险。首先，其引用的库均为Python标准库（sys, argparse, string, secrets）或广泛使用的第三方库（requests），未见加载任何闭环二进制文件或远程恶意Shellcode。其次，代码逻辑透明，从参数解析、认证到漏洞触发，每一步都有明确的逻辑说明，没有发现混淆（Obfuscation）或Base64加密的异常Payload。脚本中生成的随机字符串仅用于会话管理或参数填充，未发现外发敏感数据到非目标服务器的行为。由于该POC代码来自于已知的安全实验平台（TryHackMe）相关教程，其设计初衷是教育与防御演示。分析人员在使用时应注意，虽然此脚本本身安全，但应避免在非受控环境下运行未经审计的此类利用工具，以防脚本被后续修改者植入反弹Shell等恶意后门。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_5f92cc0fbdeed202aa50c7846721ae63/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
