## CVE-2012-2982 - Webmin RCE (远程代码执行)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Webmin

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (评分: 9.0)

**影响版本:** Webmin 1.580 及以下版本

**利用条件:** 需要有效的 Webmin 用户凭据（具有文件管理器访问权限），并可进行网络访问。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于 Webmin 1.580 的 file/show.cgi 组件中。通过分析提供的 Python 代码，其利用逻辑非常清晰且直接。首先，POC 通过向 session_login.cgi 发送 POST 请求进行身份验证，并获取会话 Cookie (sid)。随后，它利用 show.cgi 脚本对用户输入清理不足的缺陷，通过构造包含管道符（|）的特殊参数来实现命令注入。在 Webmin 的后端逻辑中，该参数会被传递给 shell 命令执行。由于 Webmin 通常以 root 权限运行，注入的指令将获得系统最高权限。该 POC 脚本编写规范，使用了 requests 库进行 HTTP 交互，逻辑链条从登录到命令执行非常完整，具有极高的实战有效性和可靠性。利用步骤：1. 攻击者获取目标 Webmin 实例的 URL 以及一组有效的登录凭据。2. 运行 Python 脚本，指定目标 URL、用户名、密码以及待执行的系统命令。3. 脚本首先模拟登录过程，捕获服务器返回的身份验证 Cookie。4. 脚本构造一个指向 /file/show.cgi 的 GET 或 POST 请求，在请求参数中注入类似 '| id' 的 Payload。5. 目标服务器解析请求并执行管道符后的命令。6. 脚本捕获并输出服务器返回的执行结果。投毒风险分析：该 POC 代码的投毒风险极低（约 5%）。通过审查 webmin.py 的代码片段，可以发现其采用了标准的 Python 安全研究库（requests, argparse, secrets），代码结构透明且不包含任何形式的混淆或加密。代码逻辑仅限于建立会话和发送特定的注入 Payload，没有发现任何尝试连接攻击者控制的外部服务器（C2）、下载恶意脚本、或修改本地主机文件的隐蔽操作。此外，代码中的 'secrets' 模块仅用于生成随机字符串，属于正常的开发实践。代码中未发现 eval() 等高风险函数，且变量命名具有描述性。对于防御者而言，此 POC 是一个纯粹的教育和验证工具。虽然脚本本身安全，但在实际环境中使用时仍需注意，确保是在受控且获得授权的环境下运行，避免因执行具有破坏性的注入指令（如 rm -rf）而导致目标系统损坏。

**项目地址:** 内部研究用例 (Based on TryHackMe environment)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
