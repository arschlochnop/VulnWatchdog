## CVE-2012-2982 - Webmin 远程代码执行 (RCE) / 命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程代码执行 (RCE) / 命令注入

**影响应用:** Webmin

**危害等级:** 高 (High)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (9.0)

**影响版本:** Webmin 1.590 及更早版本（特别是 1.580 确认受影响）

**利用条件:** 需要远程网络访问、有效的 Webmin 认证凭据、目标开启 /file/show.cgi 组件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC代码旨在复现 Webmin 1.580 版本中 /file/show.cgi 组件存在的任意命令执行漏洞。该漏洞源于对用户输入的文件路径参数处理不当，允许经过身份验证的用户利用 shell 元字符注入并执行任意系统命令。通过对代码段的深入分析，该 POC 使用 Python 编写，依赖于常见的 requests 和 argparse 库。其逻辑结构严谨：首先通过 `get_args` 获取目标、端口、凭据及待执行指令；随后在 `validate_args` 中标准化 URL；核心逻辑在 `run` 函数中，通过 `login` 获取 Session 会话，最后调用 `execute_command`（虽然代码片段在 login 处截断，但根据已知利用载荷推断，通常是通过在文件名后附加管道符或分号来实现注入）。此 POC 相比原始的 Metasploit 模块具有更高的灵活性，且不依赖大型渗透框架，其实战有效性极高，能够直接将受害者的 Webmin 权限转化为系统 shell 权限，在 legacy 系统的渗透测试中极具价值。

【利用步骤】1. 确定目标主机的 Webmin 版本是否在 1.590 以下（1.580 为典型受影响版本）。2. 准备有效的 Webmin 登录凭据（用户名和密码）。3. 准备 Python 3 运行环境并安装 requests 库。4. 执行 POC 命令：`python3 CVE-2012-2982.py -t <IP> -p 10000 -U <USER> -P <PASS> -c 'id'`。5. 观察输出结果，若成功，终端将回显命令执行结果（如 uid=0(root)）。该利用过程虽然需要认证，但在存在弱口令或凭据泄露的情况下，能够瞬间控制整台服务器。

【投毒风险分析】该 POC 代码具有较低的投毒风险（约 10%）。代码逻辑透明，使用了标准的 Python 库，未观察到任何代码混淆或加密处理。所有的网络请求均指向用户通过命令行参数指定的 `--target`。分析代码的初始化部分，未发现存在向外部 C2 服务器发送数据的逻辑，也未发现隐蔽的二次 Payload 下载行为。常见的 POC 投毒手法通常会在隐蔽处添加 `base64.b64decode(...).decode()` 并执行 `eval()`，或是在 `requests.post` 中秘密包含当前执行者的环境信息，但在本 POC 的现有片段中，均表现为标准的开发模式。脚本中唯一的外部交互是与目标 Webmin 服务器进行的认证和利用尝试。作为防御方，仍建议在隔离的沙箱环境运行此类从 GitHub 获取的脚本，并检查截断部分是否包含非预期的 `os.system` 调用，以防针对安全研究员的后门植入。

**项目地址:** [https://github.com/JohnHammond/CVE-2012-2982](https://github.com/JohnHammond/CVE-2012-2982)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
