## CVE-2012-2982 - Webmin 远程命令执行 (RCE)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Webmin

**危害等级:** CRITICAL

**CVSS评分:** 9.3 (CVSS:2.0/AV:N/AC:M/Au:N/C:C/I:C/A:C)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要具有 Webmin 登录权限的有效凭据（authenticated remote users）

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：本POC针对的是经典的Webmin历史漏洞CVE-2012-2982。该漏洞源于file/show.cgi组件在处理路径名时未能正确过滤无效字符，导致通过特定的路径构造可以绕过安全限制并执行系统命令。从提供的代码结构来看，这是一个基于Java Maven构建的项目。README中提到的执行流程是通过Maven进行打包后运行JAR文件。然而，提供的POC片段并不完整，仅展示了项目的pom.xml和README基础信息，缺乏核心的Exploit类实现代码。目前的POM文件配置了args4j、Lombok和maven-assembly-plugin，这表明开发者意图创建一个带有命令行参数处理的独立可执行工具。由于缺失了实际触发漏洞的Payload构造逻辑（如针对/file/show.cgi?bin/sh等路径的构造），该POC在当前状态下无法直接使用，仅具备项目脚手架功能。对于研究人员而言，需要自行补全HTTP请求发送逻辑和特定字符序列的注入载荷。利用步骤：1. 确认目标Webmin版本是否低于或等于1.590。2. 获取一组有效的Webmin登录账号与密码。3. 登录后访问file/show.cgi接口。4. 在路径参数中构造包含管道符或反引号的恶意载荷。5. 观察系统命令执行结果。投毒风险分析：该POC的投毒风险评级为低（15%）。分析依据如下：首先，项目结构采用了标准的Maven布局，依赖库（args4j, lombok）均为合规的开源库，未发现恶意第三方依赖。其次，在pom.xml中未发现自定义的生命周期钩子（如maven-antrun-plugin或在编译阶段执行脚本的配置），这降低了在构建过程中被植入恶意代码的概率。然而，存在一定的‘假POC’风险：由于关键的Exploit源代码未在预览中展示，攻击者可能在未披露的Main.java中集成恶意后门逻辑，例如在执行Exploit的同时反弹Shell到攻击者服务器，或者窃取本地Maven仓库的凭据。此外，利用Java编写此类利用工具较为臃肿，通常此类老旧漏洞多见于Python脚本，这种‘重型’Java封装有时被用作掩盖恶意行为的手段。建议研究人员在本地运行前，务必审阅src/main/java/main/Main.java的源代码，并严格检查是否包含System.getProperty等敏感环境信息读取或非目标IP的Socket连接。

**项目地址:** 本地文件路径: /tmp/vulnwatchdog_7d8b2850a84e4c0e9b1530ea15f32088/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
