## CVE-2012-2982 - Webmin 命令注入/RCE

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入/RCE

**影响应用:** Webmin

**危害等级:** 高危 (High)

**CVSS评分:** 9.0 (CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要有效的用户认证凭证，且具有访问 file/show.cgi 的权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对Webmin 1.590版本中的/file/show.cgi路径处理漏洞进行了实现。漏洞的核心原因在于程序未对文件名路径中的非法字符（如管道符 '|') 进行充分过滤。分析POC代码发现，其利用逻辑清晰：首先通过POST请求模拟登录session_login.cgi以获取有效的sid（Session ID）。成功获取sid后，POC构造了一个包含恶意Base64或直接命令的URL，格式为 /file/show.cgi/bin/{随机字符串}|{payload}|。通过管道符，攻击者可以将原本应作为文件路径处理的输入重定向到shell执行。该脚本使用Python的requests库，并硬编码了反弹shell（Reverse Shell）的Bash命令作为Payload。从技术角度看，此POC能够稳定触发漏洞，且代码逻辑与Metasploit中的经典模块（exploit/unix/webapp/webmin_show_cgi_exec）原理一致。利用步骤：1. 获取目标主机的IP和Webmin运行端口（默认10000）。2. 修改POC中的RHOST、LHOST、LPORT以及有效的Webmin登录凭证（user1/1user）。3. 在本地攻击机开启监听端口（如nc -lvnp 4444）。4. 运行Python脚本。脚本将自动完成登录、提取sid并发送构造好的恶意路径请求。5. 目标服务器解析非法路径并执行管道符后的命令，从而回连反弹shell。投毒风险分析：该POC代码具有较低的投毒风险。首先，代码结构非常直观，使用了标准的Python库（requests, random, string），没有引入复杂的混淆或加壳技术。唯一的外部依赖是'art'库，这通常用于生成ASCII Banner，不属于恶意组件。其次，核心Payload部分明确指向了用户定义的LHOST和LPORT，并未发现隐藏的远程指令下载（如curl/wget外部脚本）或敏感数据外发至非目标服务器的行为。其反弹shell代码是典型的安全研究用途。然而，风险点在于'art'库的导入及后续环境的自动化执行。在实际防御中，建议研究员在沙箱环境中运行此类POC。尽管目前此特定脚本表现为纯粹的漏洞验证工具，但防御人员仍需警惕此类脚本被恶意修改。由于该漏洞年代久远，当前公开的POC多用于教学和CTF环境，本代码来源标注为TryHackMe，信誉度相对较高，未发现投毒后门。

**项目地址:** [https://github.com/webmin/webmin/commit/1f1411fe7404ec3ac03e803cfa7e01515e71a213](https://github.com/webmin/webmin/commit/1f1411fe7404ec3ac03e803cfa7e01515e71a213)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
