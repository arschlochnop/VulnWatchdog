## CVE-2012-2982 - Webmin 远程代码执行 (RCE) / 命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程代码执行 (RCE) / 命令注入

**影响应用:** Webmin

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要有效的 Webmin 登录凭证（认证后利用），并且能够访问 file/show.cgi 接口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC使用Rust语言实现，针对Webmin 1.590版本中file/show.cgi组件存在的命令注入漏洞进行利用。漏洞根源在于程序未能正确过滤路径名中的非法字符，允许经过身份验证的用户注入并执行任意系统命令。此POC项目结构完整，包含了Cargo.toml依赖配置、参数处理（args.rs）以及核心利用逻辑（exploit.rs）。其功能设计非常专业，不仅提供了自动化的HTTP认证过程，还集成了一个默认的Netcat监听器来接收反弹Shell。通过rand库生成的随机字符串用于混淆攻击向量，增强了在某些简单防御环境下的渗透成功率。代码使用了reqwest进行同步阻塞式网络通信，逻辑清晰，易于安全人员审计。利用步骤：1. 准备一台装有Rust环境的攻击机。2. 获取目标Webmin服务器的合法用户名和密码。3. 执行命令 'cargo run -- <rhost> <lhost> <user> <pass>'。4. POC会首先尝试登录Webmin获取会话Cookie。5. 随后构造包含恶意路径名的请求发往/file/show.cgi，路径中嵌入了Bash反弹Shell指令。6. POC默认会在本地1337端口启动监听，等待目标服务器连接回连，从而获得系统控制权。投毒风险分析：经过对源码的深度扫描，该POC项目投毒风险极低。其Cargo.toml依赖项均为Rust社区标准库（rand, clap, reqwest），未发现引用可疑的第三方包或私有仓库。在src/args.rs中，参数解析逻辑纯粹，无隐藏的后门触发开关。README文档详尽地说明了脚本来源于TryHackMe的安全教育练习，具有明确的合规教育背景。核心利用代码逻辑中，网络行为严格限定在与目标服务器（rhost）的交互以及本地监听（lhost）上，未发现向第三方服务器发送敏感凭证（如Webmin账号密码）的隐蔽外发连接。代码未进行任何形式的混淆或加密处理，开发者身份公开，且项目托管在主流开源平台。唯一的潜在风险在于自动化执行Netcat监听的操作，但这属于渗透测试工具的常规辅助功能，而非恶意投毒行为。总体评估，此代码是安全研究和防御性测试的高质量参考实现，不含恶意软件特征。

**项目地址:** [https://github.com/0xTas/CVE-2012-2982](https://github.com/0xTas/CVE-2012-2982)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
