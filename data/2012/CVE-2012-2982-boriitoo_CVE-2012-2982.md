## CVE-2012-2982 - Webmin 命令注入/RCE

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入/RCE

**影响应用:** Webmin

**危害等级:** 高危

**CVSS评分:** 9.3 (CVSS:2.0/AV:N/AC:M/Au:N/C:C/I:C/A:C)

**影响版本:** Webmin <= 1.590

**利用条件:** 需要有效的用户认证凭证

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：本POC（Main.java）是一个基于Java编写的初步验证脚本。它利用OkHttp库模拟用户向Webmin的/session_login.cgi发送登录请求。根据搜索结果4（CVE-2012-2982）的定义，该漏洞存在于file/show.cgi组件中，攻击者通过在路径名中输入无效字符可导致任意命令执行。然而，当前提供的POC代码仅实现了登录认证阶段（login方法），尝试获取Session Cookie。其逻辑极其简化，并未包含触发漏洞的核心Payload（即针对show.cgi的命令注入部分）。代码中硬编码了用户名'user1'和密码'1user'，这在实际环境中通常无效。因此，该POC目前仅能作为自动化登录过程的参考，并不具备完整的漏洞利用能力，需进一步扩充针对/file/show.cgi?file=/..的恶意请求构造方可生效。利用步骤：1. 环境准备：部署Webmin 1.590或更早版本；2. 获取凭证：获取一个有效的Webmin登录账号；3. 运行脚本：通过命令行参数-url指定目标地址，脚本将尝试获取登录Cookie；4. 手动利用：在获取Cookie后，需手动构造类似/file/show.cgi?file=|id的请求以触发代码执行。投毒风险分析：该代码片段具有极低的投毒风险（评估为5%）。首先，代码逻辑高度透明，主要依赖标准的开源库如jcommander和okhttp，未发现任何反射调用、动态字节码加载或混淆行为。其次，代码中没有尝试访问系统敏感路径、下载外部脚本或建立反弹连接的逻辑。虽然脚本包含了一个简单的登录尝试，但这属于合法的POC功能测试范畴。代码中唯一的硬编码凭证（user1/1user）更像是测试占位符而非恶意后门。分析结果显示，该POC属于典型的安全研究人员编写的半成品工具，未见恶意意图或供应链攻击特征，但在使用时应注意遵守目标系统的授权策略，避免非授权的暴力破解行为。

**项目地址:** [https://github.com/JohnHammond/CVE-2012-2982-Webmin-RCE](https://www.google.com/search?q=https://github.com/JohnHammond/CVE-2012-2982-Webmin-RCE)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
