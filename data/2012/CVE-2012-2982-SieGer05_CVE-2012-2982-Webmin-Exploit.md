## CVE-2012-2982 - Webmin 远程命令执行 (RCE) / 命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行 (RCE) / 命令注入

**影响应用:** Webmin

**危害等级:** 高危

**CVSS评分:** 9.0 (CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C)

**影响版本:** 1.590及更早版本

**利用条件:** 需要有效的Webmin登录凭据（即使是低权限用户）；必须能够访问File Manager（文件管理器）模块。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对Webmin 1.590版本中/file/show.cgi接口的命令注入漏洞进行了完整实现。漏洞的核心在于程序在处理文件路径时未能正确过滤Shell元字符（如管道符'|'），导致经过身份验证的用户可以向系统注入并执行任意命令。此POC逻辑清晰，包含了完整的攻击链路：首先通过requests库模拟登录以获取有效的sid和会话Cookie，随后构造包含特定Payload的GET/POST请求访问show.cgi。POC中提到的随机文件名生成技术不仅能提高利用成功率，还能在一定程度上避开基于文件名的简单IDS检测。其Payload支持反弹Shell，具有极高的实战价值，对于安全研究人员验证受影响环境的脆弱性非常有效。利用步骤：1. 准备Python 3环境并安装requests库。2. 获取目标Webmin服务器的IP地址及一组可用的登录凭据。3. 修改脚本中的LHOST（攻击者IP）和LPORT（监听端口）。4. 在攻击机启动监听程序（如nc -lvnp 4444）。5. 执行脚本：python3 exploit.py <target_IP>。脚本会自动完成认证、提取Session并发送带有管道符的Payload。投毒风险分析：该POC代码本身结构清晰，主要使用了Python标准库和requests库，未发现明显的恶意混淆或加密Payload。风险点主要在于：其一，由于该漏洞年代久远且知名度高，公开的POC往往被脚本小子直接套用，存在攻击者将该POC封装成‘一键漏洞检测工具’并在其中植入二段木马的风险；其二，虽然代码中提到的随机化路径是为了绕过WAF，但在不受控的情况下运行该类脚本，其内置的反弹Shell地址（如10.21.48.124）若被硬编码为恶意地址，则可能导致执行者机器被反向控制。经静态检查，当前提供的README和脚本框架逻辑属于合法的安全研究范畴，没有发现主动外连控制服务器（C2）的行为，投毒风险评定为15%（属于正常安全工具的合规风险范围）。

**项目地址:** /tmp/vulnwatchdog_f437bf96f6c24afd9bc62369c85b182a/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
