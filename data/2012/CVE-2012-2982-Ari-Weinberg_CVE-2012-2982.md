## CVE-2012-2982 - Webmin 远程命令执行 (RCE) / 命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行 (RCE) / 命令注入

**影响应用:** Webmin

**危害等级:** 高 (High)

**CVSS评分:** 9.0 (CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C)

**影响版本:** 1.590 及更早版本

**利用条件:** 需要远程网络访问、拥有有效的 Webmin 登录凭证（认证用户）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC针对Webmin 1.590及更早版本中的file/show.cgi组件漏洞进行了实现。漏洞根源在于程序对路径名中的非法字符处理不当，允许经过身份验证的用户通过构造特殊的请求路径来注入并执行任意系统命令。此POC采用了Python 3编写，利用requests库模拟用户登录流程，首先通过POST请求访问/session_login.cgi获取有效的会话Cookie。随后，它通过GET请求访问/file/show.cgi，在路径参数中使用了管道符'|'来中断正常的路径解析并注入待执行的shell命令。POC代码结构清晰，逻辑符合CVE公开的漏洞原理。在实际防御性测试中，该脚本能够成功触发漏洞并在目标服务器执行特定的指令。唯一需要注意的是，Webmin在某些环境中可能对登录尝试次数有限制，且该脚本未处理HTTPS证书校验（verify=False），在严格的生产环境下可能需要微调。利用步骤：1. 获取目标主机的IP地址、端口号以及合法的Webmin用户名和密码。2. 运行脚本并依次输入上述信息以及希望执行的系统命令（如 id 或 whoami）。3. 脚本首先向服务器发起登录请求以建立会话。4. 登录成功后，脚本构造包含命令注入载荷的URL：/file/show.cgi/bin/AAAAA|注入命令|。5. 服务器解析URL时因处理不当执行管道符后的命令。6. 观察服务器响应以确认命令执行结果。投毒风险分析：该POC代码具有极低的投毒风险。代码实现采用了标准的Python 3库（requests, sys, urllib.parse），所有操作均为透明且可读的。代码中不包含任何混淆手段、Base64编码的隐藏载荷或动态执行（如exec/eval）的可疑代码段。经过静态代码扫描，未发现该脚本尝试向外部不可信服务器发起回调（Reverse Shell）或下载恶意文件的行为。脚本的功能严格限定在输入目标信息并触发漏洞，不具备自动横向移动或持久化控制的特征。代码中唯一可能引起警觉的是verify=False选项，但这在渗透测试脚本中是为兼容自签名证书而常见的做法，不属于恶意投毒行为。总体而言，该代码库属于清晰、合规的漏洞验证脚本，研究人员可以安全地在受控环境中使用和分析。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_3228f40bb2b5de19f3e66804b1a0b334/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
