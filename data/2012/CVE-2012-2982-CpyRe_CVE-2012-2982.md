## CVE-2012-2982 - Webmin RCE/命令注入

**漏洞编号:** CVE-2012-2982

**漏洞类型:** RCE/命令注入

**影响应用:** Webmin

**危害等级:** 高危

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (9.0)

**影响版本:** 1.590及更早版本

**利用条件:** 需要远程认证(已知用户名和密码)、网络可达

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该POC针对Webmin 1.590版本中的file/show.cgi组件漏洞编写。漏洞核心在于该组件未对路径名中的特殊字符进行严格过滤，允许攻击者通过注入‘|’（管道符）来截断原有命令并执行任意系统命令。所提供的Python脚本展示了完整的利用流程：首先，脚本通过模拟POST请求登录‘/session_login.cgi’以获取有效的会话SID（Cookie），这符合漏洞利用需要认证的前提条件。随后，脚本构建了一个包含Base64编码的反弹Shell有效载荷。利用步骤如下：1. 环境准备，攻击者需在本地监听特定端口（如使用nc）。2. 身份验证，脚本通过hardcoded或参数输入的凭据登录Webmin后台。3. 触发漏洞，脚本向‘/file/show.cgi’发送构造好的请求，路径中包含随机字符及管道符衔接的Bash命令。4. 权限维持，利用Bash重定向或Python Subprocess建立反向连接。该POC逻辑清晰，利用标准Requests库实现，具有较高的实战成功率。投毒风险分析：经过对提供的exp.py和subprocess-exp.py代码进行详细审计，未发现明显的恶意投毒行为。脚本中虽然使用了base64、subprocess和socket模块，但其用途均明确服务于反弹Shell（Reverse Shell）的构建，这是安全研究中验证RCE漏洞的标准做法。代码未见混淆处理，所有逻辑均为透明可见。外部依赖项（requirements.txt）中列出的均为Python标准库或常用的第三方库（requests），未见指向恶意镜像源或下载执行不明二进制文件的指令。尽管如此，使用者仍应注意代码中的硬编码登录凭据（user1/1user），这在不同目标的实战中需根据实际情况修改。由于代码结构简单且未使用加密混淆，判定投毒风险为极低（10%），主要风险点在于其作为攻击工具的本质属性而非代码本身携带后门。

**项目地址:** [https://github.com/CpyRe/CVE-2012-2982](https://www.google.com/search?q=https://github.com/CpyRe/CVE-2012-2982)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
