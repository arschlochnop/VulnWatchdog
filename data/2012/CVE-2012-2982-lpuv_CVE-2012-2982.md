## CVE-2012-2982 - Webmin 命令注入/RCE

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入/RCE

**影响应用:** Webmin

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (10.0)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要有效的 Webmin 登录凭据（用户名和密码），且目标系统上启用了 /file/show.cgi 模块。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该POC脚本是针对Webmin 1.590版本中存在的老牌RCE漏洞CVE-2012-2982的高质量实现。其核心原理是利用/file/show.cgi在处理路径名时对特殊字符（管道符|）过滤不严，导致攻击者可以通过构造恶意路径来注入任意系统命令。该POC采用了模块化设计，包含登录验证和利用两个阶段。首先，脚本模拟用户登录以获取有效的会话ID（sid），这是利用该漏洞的前提。随后，它构造了一个包含反弹Shell命令（Bash -i方式）的恶意URL。由于代码中使用了secrets库生成随机字符串并正确处理了HTTP会话，其实践有效性极高。该POC能够稳定地在实验室环境下复现漏洞并获取反弹Shell。利用步骤：1. 准备一台具有公网IP或与目标网络互通的监听机，使用nc等工具监听指定端口。2. 获取目标Webmin服务器的有效账号密码。3. 运行此Python脚本，参数格式为：python exploit.py <目标IP:端口> <用户名> <密码> <反弹IP> <反弹端口>。4. 脚本将首先向session_login.cgi发送POST请求获取sid。5. 成功后，脚本向/file/show.cgi发送带有命令注入载荷的GET请求。6. 目标服务器执行载荷，将Shell反弹至监听机。投毒风险分析：该脚本的投毒风险极低（约10%）。经过详细的代码审计，发现脚本逻辑清晰，仅依赖标准的Python三方库如requests，未引用任何来源不明的外部二进制文件或混淆脚本。虽然脚本执行的是具有攻击性的反弹Shell操作，但这属于漏洞验证（PoC）和利用（Exploit）的预期行为，不应被视为恶意投毒。脚本中唯一涉及外部连接的部分是向目标发送请求以及定义反弹Shell的目标地址，这些均由用户通过命令行参数手动输入。代码未发现任何隐藏的自启动项、文件加密行为、或向非用户指定地址外传敏感数据的逻辑。其随机字符串生成逻辑（generate_random_string）是为了规避简单的路径检测，属于常规对抗手段。整体而言，该代码是一个透明、学术化且具有防御研究价值的漏洞利用示例，但在生产环境下载使用时仍建议在隔离的沙箱中执行，以防止由于脚本被二次修改而引入的潜在威胁。

**项目地址:** [https://github.com/JohnHammond/CVE-2012-2982](https://github.com/JohnHammond/CVE-2012-2982)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
