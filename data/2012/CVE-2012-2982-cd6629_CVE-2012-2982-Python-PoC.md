## CVE-2012-2982 - Webmin 远程命令执行 (RCE)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Webmin

**危害等级:** 高危

**CVSS评分:** 9.0 (CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要远程身份验证（获取有效凭证）、网络可达性（需访问Webmin管理端口，通常为10000）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：该POC是针对CVE-2012-2982的Python重写版，源自经典的Metasploit模块。漏洞根源在于Webmin的file/show.cgi组件在处理路径名时未能正确过滤无效字符，导致攻击者可以通过特定的路径构造执行任意系统命令。此Python脚本通过requests库模拟登录流程，首先向/session_login.cgi发送POST请求以获取有效的sid会话Cookie。一旦认证成功，脚本会调用payload函数。payload函数通过Base64编码一段Python反弹Shell脚本，随后利用目标服务器上的python环境解压并执行。此脚本逻辑严密，包含随机字符串生成（rand函数）以增加隐蔽性，并能够通过socket直接建立反向连接。经分析，其利用逻辑与Webmin 1.580/1.590的历史漏洞完全匹配，具备极高的利用成功率，且相比Ruby编写的Metasploit模块更易于在轻量化环境中使用。利用步骤：1. 攻击者需获取目标Webmin实例的合法登录凭证（如agent47:videogamer124）。2. 在攻击机上开启监听端口（如nc -nlvp 4445）。3. 修改脚本中的lhost和lport变量为攻击机IP和端口。4. 运行脚本，脚本将自动完成登录、获取Session ID、构造恶意路径请求并触发命令执行。5. 目标服务器回连攻击机，获得root权限Shell。投毒风险分析：该代码片段透明度极高，属于典型的安全研究及OSCP学习用途脚本。代码逻辑清晰，使用了标准的Python库如requests、socket、base64和secrets，未发现任何混淆处理。投毒风险极低的主要原因有：首先，脚本明确标注了参考来源和修改目的（从Metasploit转换）；其次，代码中没有发现任何外部未授权的HTTP请求或DNS外泄行为，所有通信均限定在攻击者定义的lhost范围内；再次，Base64编码的部分经解码后确认为标准的反弹Shell代码，不包含隐藏的恶意负载或针对执行机（攻击者机器）的破坏指令。代码中硬编码的凭证仅为示例，不会导致针对攻击者的反向控制。总体而言，该POC是一个纯粹的渗透测试工具，安全性评估为低风险，但在生产环境下载时仍建议在隔离沙箱中审阅代码逻辑，以防后续维护者注入恶意更新。

**项目地址:** [https://tryhackme.com/room/gamezone](https://tryhackme.com/room/gamezone)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
