## CVE-2012-2982 - Webmin 远程命令执行 (RCE)

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** Webmin

**危害等级:** 高 (High)

**CVSS评分:** CVSS:2.0/AV:N/AC:L/Au:S/C:C/I:C/A:C (核心分值: 9.0)

**影响版本:** Webmin 1.590 及更早版本

**利用条件:** 需要有效的 Webmin 登录凭据（认证后利用）

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Webmin 的 /file/show.cgi 组件中，主要由于对路径名中的无效字符（管道符 '|'）处理不当，导致经过身份验证的用户可以注入并执行任意系统命令。提供的 POC 代码逻辑清晰，首先通过 POST 请求提交用户名和密码访问 /session_login.cgi 以获取会话 ID（sid）。获取 sid 后，POC 构造了一个包含攻击载荷的特殊 URL，格式为 '/file/show.cgi/bin/[随机字符]|[命令]|'。在代码中，payload 使用了 Bash 反弹 Shell 脚本。经过分析，该 POC 的利用链完整，涵盖了从身份验证到触发执行的关键步骤。只要提供的登录凭证正确，且目标版本在受影响范围内，该脚本具有较高的成功执行概率。然而，代码中存在一些硬编码的登录信息（如 user1/1user），在实际测试中需要根据目标环境动态调整输入参数。利用步骤：1. 确认目标主机运行的是 1.590 或更低版本的 Webmin。2. 获取有效的登录凭据。3. 运行 Python 脚本，输入目标 IP、端口、攻击者监听 IP 和端口。4. 脚本会自动进行登录并提取会话 Cookie。5. 脚本构造包含管道符和反弹 Shell 命令的恶意路径请求。6. 目标服务器执行该路径，从而在攻击者监听端口上触发反弹 Shell。投毒风险分析：该 POC 代码主要依赖 Python 的标准库 requests、string 和 secrets，未发现引用可疑的第三方恶意包。代码逻辑完全透明，所有的网络请求均指向用户定义的目标 IP。在风险评估中，虽然 POC 涉及到了 Shell 命令的执行，但这属于漏洞验证的必要组成部分，并非针对攻击者本人的后门。唯一潜在的风险点在于用户输入环节，若在不受信任的环境下运行该脚本，需注意输入参数的合法性。整体来看，该代码没有进行混淆处理，没有加密的二进制载荷，也没有尝试连接已知的恶意 C2 服务器。代码中的变量命名和逻辑流符合安全研究工具的标准，投毒风险处于较低水平（约 15%），主要风险源于 POC 本身具有攻击性，需在受控环境下操作以防误伤。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_1035fa30f28fdb7ab968b051ef456b0e/CVE-2012-2982.py

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)
